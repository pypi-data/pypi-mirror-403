[project]
name = "julax"
version = "0.0.6"
description = "Just Layers over JAX"
readme = "README.md"
authors = [
    { name = "Jun Tian", email = "tianjun.cpp@gmail.com" }
]
requires-python = ">=3.12"
dependencies = [
    "einops>=0.8.1",
    "grain>=0.2.12",
    "humanize>=4.13.0",
    "jax>=0.7.2",
    "optax>=0.2.6",
    "orbax-checkpoint>=0.11.25",
    "plum-dispatch>=2.5.8",
    "pydantic>=2.12.0",
]

[project.scripts]
julax = "julax:main"

[build-system]
requires = ["hatchling"]
build-backend = "hatchling.build"

[project.optional-dependencies]
tpu = [
    "jax[tpu]>=0.7.2",
]

[tool.ruff.lint]
ignore = ["E741", "F811"]

[[tool.uv.index]]
url = "https://mirrors.tuna.tsinghua.edu.cn/pypi/web/simple"
default = true

[tool.uv.workspace]
members = [
    "examples/01_mnist",
    "examples/02_mini_transformer",
    "examples/03_Llama_3.2_1B",
    ".",
]

[dependency-groups]
dev = [
    "ipython>=9.9.0",
    "pytest>=8.4.2",
    "tensorboard>=2.20.0",
    "xprof>=2.21.4",
]
