

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>WebSocket API &mdash; weex-client 0.2.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />

  
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=938c9ccc"></script>
      <script src="../_static/doctools.js?v=9bcbadda"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            weex-client
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <!-- Local TOC -->
              <div class="local-toc"><ul>
<li><a class="reference internal" href="#">WebSocket API</a><ul>
<li><a class="reference internal" href="#weex_client.websocket.WeexWebSocketClient"><code class="docutils literal notranslate"><span class="pre">WeexWebSocketClient</span></code></a><ul>
<li><a class="reference internal" href="#weex_client.websocket.WeexWebSocketClient.PUBLIC_ENDPOINT"><code class="docutils literal notranslate"><span class="pre">WeexWebSocketClient.PUBLIC_ENDPOINT</span></code></a></li>
<li><a class="reference internal" href="#weex_client.websocket.WeexWebSocketClient.PRIVATE_ENDPOINT"><code class="docutils literal notranslate"><span class="pre">WeexWebSocketClient.PRIVATE_ENDPOINT</span></code></a></li>
<li><a class="reference internal" href="#weex_client.websocket.WeexWebSocketClient.__init__"><code class="docutils literal notranslate"><span class="pre">WeexWebSocketClient.__init__()</span></code></a></li>
<li><a class="reference internal" href="#weex_client.websocket.WeexWebSocketClient.__aenter__"><code class="docutils literal notranslate"><span class="pre">WeexWebSocketClient.__aenter__()</span></code></a></li>
<li><a class="reference internal" href="#weex_client.websocket.WeexWebSocketClient.__aexit__"><code class="docutils literal notranslate"><span class="pre">WeexWebSocketClient.__aexit__()</span></code></a></li>
<li><a class="reference internal" href="#weex_client.websocket.WeexWebSocketClient.connect"><code class="docutils literal notranslate"><span class="pre">WeexWebSocketClient.connect()</span></code></a></li>
<li><a class="reference internal" href="#weex_client.websocket.WeexWebSocketClient.disconnect"><code class="docutils literal notranslate"><span class="pre">WeexWebSocketClient.disconnect()</span></code></a></li>
<li><a class="reference internal" href="#weex_client.websocket.WeexWebSocketClient.reconnect"><code class="docutils literal notranslate"><span class="pre">WeexWebSocketClient.reconnect()</span></code></a></li>
<li><a class="reference internal" href="#weex_client.websocket.WeexWebSocketClient.add_message_handler"><code class="docutils literal notranslate"><span class="pre">WeexWebSocketClient.add_message_handler()</span></code></a></li>
<li><a class="reference internal" href="#weex_client.websocket.WeexWebSocketClient.remove_message_handler"><code class="docutils literal notranslate"><span class="pre">WeexWebSocketClient.remove_message_handler()</span></code></a></li>
<li><a class="reference internal" href="#weex_client.websocket.WeexWebSocketClient.send_pong"><code class="docutils literal notranslate"><span class="pre">WeexWebSocketClient.send_pong()</span></code></a></li>
<li><a class="reference internal" href="#weex_client.websocket.WeexWebSocketClient.send_message"><code class="docutils literal notranslate"><span class="pre">WeexWebSocketClient.send_message()</span></code></a></li>
<li><a class="reference internal" href="#weex_client.websocket.WeexWebSocketClient.subscribe"><code class="docutils literal notranslate"><span class="pre">WeexWebSocketClient.subscribe()</span></code></a></li>
<li><a class="reference internal" href="#weex_client.websocket.WeexWebSocketClient.unsubscribe"><code class="docutils literal notranslate"><span class="pre">WeexWebSocketClient.unsubscribe()</span></code></a></li>
<li><a class="reference internal" href="#weex_client.websocket.WeexWebSocketClient.stream_tickers"><code class="docutils literal notranslate"><span class="pre">WeexWebSocketClient.stream_tickers()</span></code></a></li>
<li><a class="reference internal" href="#weex_client.websocket.WeexWebSocketClient.stream_order_book"><code class="docutils literal notranslate"><span class="pre">WeexWebSocketClient.stream_order_book()</span></code></a></li>
<li><a class="reference internal" href="#weex_client.websocket.WeexWebSocketClient.stream_trades"><code class="docutils literal notranslate"><span class="pre">WeexWebSocketClient.stream_trades()</span></code></a></li>
<li><a class="reference internal" href="#weex_client.websocket.WeexWebSocketClient.close"><code class="docutils literal notranslate"><span class="pre">WeexWebSocketClient.close()</span></code></a></li>
<li><a class="reference internal" href="#weex_client.websocket.WeexWebSocketClient.is_connected"><code class="docutils literal notranslate"><span class="pre">WeexWebSocketClient.is_connected</span></code></a></li>
<li><a class="reference internal" href="#weex_client.websocket.WeexWebSocketClient.subscriptions"><code class="docutils literal notranslate"><span class="pre">WeexWebSocketClient.subscriptions</span></code></a></li>
<li><a class="reference internal" href="#weex_client.websocket.WeexWebSocketClient.connection_attempts"><code class="docutils literal notranslate"><span class="pre">WeexWebSocketClient.connection_attempts</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#public-channel-streaming">Public Channel Streaming</a><ul>
<li><a class="reference internal" href="#id0"><code class="docutils literal notranslate"><span class="pre">WeexWebSocketClient.stream_tickers()</span></code></a></li>
<li><a class="reference internal" href="#id1"><code class="docutils literal notranslate"><span class="pre">WeexWebSocketClient.stream_order_book()</span></code></a></li>
<li><a class="reference internal" href="#id2"><code class="docutils literal notranslate"><span class="pre">WeexWebSocketClient.stream_trades()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#private-channel-streaming">Private Channel Streaming</a></li>
<li><a class="reference internal" href="#connection-management">Connection Management</a><ul>
<li><a class="reference internal" href="#id3"><code class="docutils literal notranslate"><span class="pre">WeexWebSocketClient.connect()</span></code></a></li>
<li><a class="reference internal" href="#id4"><code class="docutils literal notranslate"><span class="pre">WeexWebSocketClient.disconnect()</span></code></a></li>
<li><a class="reference internal" href="#id5"><code class="docutils literal notranslate"><span class="pre">WeexWebSocketClient.is_connected()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#context-manager">Context Manager</a></li>
<li><a class="reference internal" href="#basic-usage-examples">Basic Usage Examples</a><ul>
<li><a class="reference internal" href="#real-time-market-monitoring">Real-time Market Monitoring</a></li>
<li><a class="reference internal" href="#order-book-monitoring">Order Book Monitoring</a></li>
<li><a class="reference internal" href="#trade-stream-monitoring">Trade Stream Monitoring</a></li>
</ul>
</li>
<li><a class="reference internal" href="#private-data-streaming">Private Data Streaming</a><ul>
<li><a class="reference internal" href="#account-updates">Account Updates</a></li>
<li><a class="reference internal" href="#position-monitoring">Position Monitoring</a></li>
<li><a class="reference internal" href="#order-updates">Order Updates</a></li>
</ul>
</li>
<li><a class="reference internal" href="#advanced-streaming-patterns">Advanced Streaming Patterns</a><ul>
<li><a class="reference internal" href="#multi-symbol-monitoring">Multi-Symbol Monitoring</a></li>
<li><a class="reference internal" href="#real-time-analysis">Real-time Analysis</a></li>
<li><a class="reference internal" href="#risk-management-integration">Risk Management Integration</a></li>
</ul>
</li>
<li><a class="reference internal" href="#paper-trading-with-websocket">Paper Trading with WebSocket</a><ul>
<li><a class="reference internal" href="#paper-trading-engine">Paper Trading Engine</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id6">Connection Management</a><ul>
<li><a class="reference internal" href="#error-handling-and-reconnection">Error Handling and Reconnection</a></li>
<li><a class="reference internal" href="#message-filtering-and-processing">Message Filtering and Processing</a></li>
</ul>
</li>
<li><a class="reference internal" href="#performance-optimization">Performance Optimization</a><ul>
<li><a class="reference internal" href="#memory-management">Memory Management</a></li>
<li><a class="reference internal" href="#batch-processing">Batch Processing</a></li>
</ul>
</li>
<li><a class="reference internal" href="#common-websocket-patterns">Common WebSocket Patterns</a><ul>
<li><a class="reference internal" href="#heartbeat-and-health-checks">Heartbeat and Health Checks</a></li>
<li><a class="reference internal" href="#data-storage">Data Storage</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">weex-client</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">WebSocket API</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/api/websocket.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="websocket-api">
<h1>WebSocket API<a class="headerlink" href="#websocket-api" title="Link to this heading"></a></h1>
<p>The <code class="docutils literal notranslate"><span class="pre">WeexWebSocketClient</span></code> provides real-time streaming capabilities for market data and private account updates, perfect for live trading and monitoring applications.</p>
<dl class="py class">
<dt class="sig sig-object py" id="weex_client.websocket.WeexWebSocketClient">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">weex_client.websocket.</span></span><span class="sig-name descname"><span class="pre">WeexWebSocketClient</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_retries</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">backoff_base</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">backoff_max</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">30.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ping_interval</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">20.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ping_timeout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/weex_client/websocket.html#WeexWebSocketClient"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#weex_client.websocket.WeexWebSocketClient" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Modern async WebSocket client for Weex API.</p>
<p>Features:
- Async context manager support
- Auto-reconnection with exponential backoff
- Message handlers with pattern matching
- Connection health monitoring
- Rate limit detection
- Structured logging
- Python 3.14 TaskGroup for concurrent operations</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="weex_client.websocket.WeexWebSocketClient.PUBLIC_ENDPOINT">
<span class="sig-name descname"><span class="pre">PUBLIC_ENDPOINT</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'wss://ws-contract.weex.com/v2/ws/public'</span></em><a class="headerlink" href="#weex_client.websocket.WeexWebSocketClient.PUBLIC_ENDPOINT" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="weex_client.websocket.WeexWebSocketClient.PRIVATE_ENDPOINT">
<span class="sig-name descname"><span class="pre">PRIVATE_ENDPOINT</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'wss://ws-contract.weex.com/v2/ws/private'</span></em><a class="headerlink" href="#weex_client.websocket.WeexWebSocketClient.PRIVATE_ENDPOINT" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="weex_client.websocket.WeexWebSocketClient.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_retries</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">backoff_base</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">backoff_max</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">30.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ping_interval</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">20.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ping_timeout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/weex_client/websocket.html#WeexWebSocketClient.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#weex_client.websocket.WeexWebSocketClient.__init__" title="Link to this definition"></a></dt>
<dd><p>Initialize WebSocket client.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>config</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference internal" href="config.html#weex_client.config.WeexConfig" title="weex_client.config.WeexConfig"><code class="xref py py-class docutils literal notranslate"><span class="pre">weex_client.config.WeexConfig</span></code></a></span>) – WeexConfig instance</p></li>
<li><p><strong>max_retries</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a></span>) – Maximum reconnection attempts</p></li>
<li><p><strong>backoff_base</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a></span>) – Base backoff delay for reconnection</p></li>
<li><p><strong>backoff_max</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a></span>) – Maximum backoff delay</p></li>
<li><p><strong>ping_interval</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a></span>) – Interval for sending pings</p></li>
<li><p><strong>ping_timeout</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a></span>) – Timeout for ping responses</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="weex_client.websocket.WeexWebSocketClient.__aenter__">
<em class="property"><span class="k"><span class="pre">async</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">__aenter__</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/weex_client/websocket.html#WeexWebSocketClient.__aenter__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#weex_client.websocket.WeexWebSocketClient.__aenter__" title="Link to this definition"></a></dt>
<dd><p>Async context manager entry.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="weex_client.websocket.WeexWebSocketClient.__aexit__">
<em class="property"><span class="k"><span class="pre">async</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">__aexit__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">exc_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tb</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/weex_client/websocket.html#WeexWebSocketClient.__aexit__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#weex_client.websocket.WeexWebSocketClient.__aexit__" title="Link to this definition"></a></dt>
<dd><p>Async context manager exit.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="weex_client.websocket.WeexWebSocketClient.connect">
<em class="property"><span class="k"><span class="pre">async</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">connect</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">private</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/weex_client/websocket.html#WeexWebSocketClient.connect"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#weex_client.websocket.WeexWebSocketClient.connect" title="Link to this definition"></a></dt>
<dd><p>Connect to WebSocket server.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>private</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a></span>) – Whether to connect to private channel</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="weex_client.websocket.WeexWebSocketClient.disconnect">
<em class="property"><span class="k"><span class="pre">async</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">disconnect</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/weex_client/websocket.html#WeexWebSocketClient.disconnect"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#weex_client.websocket.WeexWebSocketClient.disconnect" title="Link to this definition"></a></dt>
<dd><p>Disconnect from WebSocket server.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="weex_client.websocket.WeexWebSocketClient.reconnect">
<em class="property"><span class="k"><span class="pre">async</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">reconnect</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">private</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/weex_client/websocket.html#WeexWebSocketClient.reconnect"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#weex_client.websocket.WeexWebSocketClient.reconnect" title="Link to this definition"></a></dt>
<dd><p>Reconnect to WebSocket server with backoff.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="weex_client.websocket.WeexWebSocketClient.add_message_handler">
<span class="sig-name descname"><span class="pre">add_message_handler</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">channel</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">handler</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/weex_client/websocket.html#WeexWebSocketClient.add_message_handler"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#weex_client.websocket.WeexWebSocketClient.add_message_handler" title="Link to this definition"></a></dt>
<dd><p>Add message handler for specific channel.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="weex_client.websocket.WeexWebSocketClient.remove_message_handler">
<span class="sig-name descname"><span class="pre">remove_message_handler</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">channel</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">handler</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/weex_client/websocket.html#WeexWebSocketClient.remove_message_handler"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#weex_client.websocket.WeexWebSocketClient.remove_message_handler" title="Link to this definition"></a></dt>
<dd><p>Remove message handler for specific channel.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="weex_client.websocket.WeexWebSocketClient.send_pong">
<em class="property"><span class="k"><span class="pre">async</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">send_pong</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">timestamp</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/weex_client/websocket.html#WeexWebSocketClient.send_pong"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#weex_client.websocket.WeexWebSocketClient.send_pong" title="Link to this definition"></a></dt>
<dd><p>Send pong response.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="weex_client.websocket.WeexWebSocketClient.send_message">
<em class="property"><span class="k"><span class="pre">async</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">send_message</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">message</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/weex_client/websocket.html#WeexWebSocketClient.send_message"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#weex_client.websocket.WeexWebSocketClient.send_message" title="Link to this definition"></a></dt>
<dd><p>Send message to WebSocket server.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="weex_client.websocket.WeexWebSocketClient.subscribe">
<em class="property"><span class="k"><span class="pre">async</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">subscribe</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">channel</span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">symbol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">params</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/weex_client/websocket.html#WeexWebSocketClient.subscribe"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#weex_client.websocket.WeexWebSocketClient.subscribe" title="Link to this definition"></a></dt>
<dd><p>Subscribe to a channel.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>channel</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a></span>) – Channel name (e.g., ‘tickers’, ‘orderbook’, ‘trades’)</p></li>
<li><p><strong>symbol</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">weex_client.types.TypeAliasType</span></code> | <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a></span>) – Trading symbol (if applicable)</p></li>
<li><p><strong>**params</strong> – Additional subscription parameters</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="weex_client.websocket.WeexWebSocketClient.unsubscribe">
<em class="property"><span class="k"><span class="pre">async</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">unsubscribe</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">channel</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/weex_client/websocket.html#WeexWebSocketClient.unsubscribe"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#weex_client.websocket.WeexWebSocketClient.unsubscribe" title="Link to this definition"></a></dt>
<dd><p>Unsubscribe from a channel.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>channel</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a></span>) – Channel name</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="weex_client.websocket.WeexWebSocketClient.stream_tickers">
<em class="property"><span class="k"><span class="pre">async</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">stream_tickers</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">symbols</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/weex_client/websocket.html#WeexWebSocketClient.stream_tickers"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#weex_client.websocket.WeexWebSocketClient.stream_tickers" title="Link to this definition"></a></dt>
<dd><p>Stream ticker data as async generator.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>symbols</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code></a>[<code class="xref py py-class docutils literal notranslate"><span class="pre">weex_client.types.TypeAliasType</span></code>] | <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a></span>) – List of symbols to subscribe to (None for all)</p>
</dd>
<dt class="field-even">Yields<span class="colon">:</span></dt>
<dd class="field-even"><p><em>WebSocketMessage</em> – Ticker update messages</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="weex_client.websocket.WeexWebSocketClient.stream_order_book">
<em class="property"><span class="k"><span class="pre">async</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">stream_order_book</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">symbol</span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">level</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/weex_client/websocket.html#WeexWebSocketClient.stream_order_book"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#weex_client.websocket.WeexWebSocketClient.stream_order_book" title="Link to this definition"></a></dt>
<dd><p>Stream order book data as async generator.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>symbol</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">weex_client.types.TypeAliasType</span></code></span>) – Trading symbol</p></li>
<li><p><strong>level</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a></span>) – Order book depth level</p></li>
</ul>
</dd>
<dt class="field-even">Yields<span class="colon">:</span></dt>
<dd class="field-even"><p><em>WebSocketMessage</em> – Order book update messages</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="weex_client.websocket.WeexWebSocketClient.stream_trades">
<em class="property"><span class="k"><span class="pre">async</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">stream_trades</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">symbol</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/weex_client/websocket.html#WeexWebSocketClient.stream_trades"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#weex_client.websocket.WeexWebSocketClient.stream_trades" title="Link to this definition"></a></dt>
<dd><p>Stream trade data as async generator.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>symbol</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">weex_client.types.TypeAliasType</span></code></span>) – Trading symbol</p>
</dd>
<dt class="field-even">Yields<span class="colon">:</span></dt>
<dd class="field-even"><p><em>WebSocketMessage</em> – Trade update messages</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="weex_client.websocket.WeexWebSocketClient.close">
<em class="property"><span class="k"><span class="pre">async</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">close</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/weex_client/websocket.html#WeexWebSocketClient.close"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#weex_client.websocket.WeexWebSocketClient.close" title="Link to this definition"></a></dt>
<dd><p>Close the WebSocket client and cleanup resources.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="weex_client.websocket.WeexWebSocketClient.is_connected">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">is_connected</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><span class="pre">bool</span></a></em><a class="headerlink" href="#weex_client.websocket.WeexWebSocketClient.is_connected" title="Link to this definition"></a></dt>
<dd><p>Check if WebSocket is connected.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="weex_client.websocket.WeexWebSocketClient.subscriptions">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">subscriptions</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#set" title="(in Python v3.14)"><span class="pre">set</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#weex_client.websocket.WeexWebSocketClient.subscriptions" title="Link to this definition"></a></dt>
<dd><p>Get current subscriptions.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="weex_client.websocket.WeexWebSocketClient.connection_attempts">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">connection_attempts</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></em><a class="headerlink" href="#weex_client.websocket.WeexWebSocketClient.connection_attempts" title="Link to this definition"></a></dt>
<dd><p>Get number of connection attempts.</p>
</dd></dl>

</dd></dl>

<section id="public-channel-streaming">
<h2>Public Channel Streaming<a class="headerlink" href="#public-channel-streaming" title="Link to this heading"></a></h2>
<dl class="py method">
<dt class="sig sig-object py" id="id0">
<em class="property"><span class="k"><span class="pre">async</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">WeexWebSocketClient.</span></span><span class="sig-name descname"><span class="pre">stream_tickers</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">symbols</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/weex_client/websocket.html#WeexWebSocketClient.stream_tickers"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id0" title="Link to this definition"></a></dt>
<dd><p>Stream ticker data as async generator.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>symbols</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code></a>[<code class="xref py py-class docutils literal notranslate"><span class="pre">weex_client.types.TypeAliasType</span></code>] | <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a></span>) – List of symbols to subscribe to (None for all)</p>
</dd>
<dt class="field-even">Yields<span class="colon">:</span></dt>
<dd class="field-even"><p><em>WebSocketMessage</em> – Ticker update messages</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id1">
<em class="property"><span class="k"><span class="pre">async</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">WeexWebSocketClient.</span></span><span class="sig-name descname"><span class="pre">stream_order_book</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">symbol</span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">level</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/weex_client/websocket.html#WeexWebSocketClient.stream_order_book"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id1" title="Link to this definition"></a></dt>
<dd><p>Stream order book data as async generator.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>symbol</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">weex_client.types.TypeAliasType</span></code></span>) – Trading symbol</p></li>
<li><p><strong>level</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a></span>) – Order book depth level</p></li>
</ul>
</dd>
<dt class="field-even">Yields<span class="colon">:</span></dt>
<dd class="field-even"><p><em>WebSocketMessage</em> – Order book update messages</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id2">
<em class="property"><span class="k"><span class="pre">async</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">WeexWebSocketClient.</span></span><span class="sig-name descname"><span class="pre">stream_trades</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">symbol</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/weex_client/websocket.html#WeexWebSocketClient.stream_trades"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id2" title="Link to this definition"></a></dt>
<dd><p>Stream trade data as async generator.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>symbol</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">weex_client.types.TypeAliasType</span></code></span>) – Trading symbol</p>
</dd>
<dt class="field-even">Yields<span class="colon">:</span></dt>
<dd class="field-even"><p><em>WebSocketMessage</em> – Trade update messages</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="private-channel-streaming">
<h2>Private Channel Streaming<a class="headerlink" href="#private-channel-streaming" title="Link to this heading"></a></h2>
</section>
<section id="connection-management">
<h2>Connection Management<a class="headerlink" href="#connection-management" title="Link to this heading"></a></h2>
<dl class="py method">
<dt class="sig sig-object py" id="id3">
<em class="property"><span class="k"><span class="pre">async</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">WeexWebSocketClient.</span></span><span class="sig-name descname"><span class="pre">connect</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">private</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/weex_client/websocket.html#WeexWebSocketClient.connect"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id3" title="Link to this definition"></a></dt>
<dd><p>Connect to WebSocket server.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>private</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a></span>) – Whether to connect to private channel</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id4">
<em class="property"><span class="k"><span class="pre">async</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">WeexWebSocketClient.</span></span><span class="sig-name descname"><span class="pre">disconnect</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/weex_client/websocket.html#WeexWebSocketClient.disconnect"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id4" title="Link to this definition"></a></dt>
<dd><p>Disconnect from WebSocket server.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id5">
<span class="sig-prename descclassname"><span class="pre">WeexWebSocketClient.</span></span><span class="sig-name descname"><span class="pre">is_connected</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#id5" title="Link to this definition"></a></dt>
<dd><p>Check if WebSocket is connected.</p>
</dd></dl>

</section>
<section id="context-manager">
<h2>Context Manager<a class="headerlink" href="#context-manager" title="Link to this heading"></a></h2>
<p>The WebSocket client implements async context manager for automatic resource management:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">asyncio</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">weex_client</span><span class="w"> </span><span class="kn">import</span> <span class="n">WeexWebSocketClient</span><span class="p">,</span> <span class="n">WeexConfig</span>

<span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">websocket_example</span><span class="p">():</span>
    <span class="n">config</span> <span class="o">=</span> <span class="n">WeexConfig</span><span class="o">.</span><span class="n">from_env</span><span class="p">()</span>

    <span class="k">async</span> <span class="k">with</span> <span class="n">WeexWebSocketClient</span><span class="p">(</span><span class="n">config</span><span class="p">)</span> <span class="k">as</span> <span class="n">ws_client</span><span class="p">:</span>
        <span class="c1"># Client automatically connects and manages resources</span>
        <span class="k">async</span> <span class="k">for</span> <span class="n">message</span> <span class="ow">in</span> <span class="n">ws_client</span><span class="o">.</span><span class="n">stream_tickers</span><span class="p">([</span><span class="s2">&quot;BTCUSDT&quot;</span><span class="p">]):</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Ticker: </span><span class="si">{</span><span class="n">message</span><span class="o">.</span><span class="n">data</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="c1"># Client automatically disconnects when exiting context</span>
</pre></div>
</div>
</section>
<section id="basic-usage-examples">
<h2>Basic Usage Examples<a class="headerlink" href="#basic-usage-examples" title="Link to this heading"></a></h2>
<section id="real-time-market-monitoring">
<h3>Real-time Market Monitoring<a class="headerlink" href="#real-time-market-monitoring" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">monitor_market</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Monitor real-time market data&quot;&quot;&quot;</span>
    <span class="n">config</span> <span class="o">=</span> <span class="n">WeexConfig</span><span class="o">.</span><span class="n">from_env</span><span class="p">()</span>

    <span class="k">async</span> <span class="k">with</span> <span class="n">WeexWebSocketClient</span><span class="p">(</span><span class="n">config</span><span class="p">)</span> <span class="k">as</span> <span class="n">ws_client</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;📊 Monitoring BTC/USDT...&quot;</span><span class="p">)</span>

        <span class="k">async</span> <span class="k">for</span> <span class="n">ticker_message</span> <span class="ow">in</span> <span class="n">ws_client</span><span class="o">.</span><span class="n">stream_tickers</span><span class="p">([</span><span class="s2">&quot;BTCUSDT&quot;</span><span class="p">]):</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">ticker_message</span><span class="o">.</span><span class="n">data</span>
            <span class="n">timestamp</span> <span class="o">=</span> <span class="n">ticker_message</span><span class="o">.</span><span class="n">timestamp</span>

            <span class="n">price</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;last&quot;</span><span class="p">,</span> <span class="s2">&quot;N/A&quot;</span><span class="p">)</span>
            <span class="n">volume</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;volume&quot;</span><span class="p">,</span> <span class="s2">&quot;N/A&quot;</span><span class="p">)</span>
            <span class="n">change</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;change&quot;</span><span class="p">,</span> <span class="s2">&quot;N/A&quot;</span><span class="p">)</span>

            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">timestamp</span><span class="si">}</span><span class="s2">: BTC/USDT = $</span><span class="si">{</span><span class="n">price</span><span class="si">}</span><span class="s2"> | Volume: </span><span class="si">{</span><span class="n">volume</span><span class="si">}</span><span class="s2"> | Change: </span><span class="si">{</span><span class="n">change</span><span class="si">}</span><span class="s2">%&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="order-book-monitoring">
<h3>Order Book Monitoring<a class="headerlink" href="#order-book-monitoring" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">monitor_order_book</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Monitor real-time order book&quot;&quot;&quot;</span>
    <span class="n">config</span> <span class="o">=</span> <span class="n">WeexConfig</span><span class="o">.</span><span class="n">from_env</span><span class="p">()</span>

    <span class="k">async</span> <span class="k">with</span> <span class="n">WeexWebSocketClient</span><span class="p">(</span><span class="n">config</span><span class="p">)</span> <span class="k">as</span> <span class="n">ws_client</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;📈 Monitoring BTC/USDT order book...&quot;</span><span class="p">)</span>

        <span class="k">async</span> <span class="k">for</span> <span class="n">book_message</span> <span class="ow">in</span> <span class="n">ws_client</span><span class="o">.</span><span class="n">stream_order_book</span><span class="p">(</span><span class="s2">&quot;BTCUSDT&quot;</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="mi">5</span><span class="p">):</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">book_message</span><span class="o">.</span><span class="n">data</span>

            <span class="n">bids</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;bids&quot;</span><span class="p">,</span> <span class="p">[])[:</span><span class="mi">3</span><span class="p">]</span>  <span class="c1"># Top 3 bids</span>
            <span class="n">asks</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;asks&quot;</span><span class="p">,</span> <span class="p">[])[:</span><span class="mi">3</span><span class="p">]</span>  <span class="c1"># Top 3 asks</span>

            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">📊 Order Book Snapshot:&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Bids:&quot;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">price</span><span class="p">,</span> <span class="n">size</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">bids</span><span class="p">,</span> <span class="mi">1</span><span class="p">):</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  </span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">. $</span><span class="si">{</span><span class="n">price</span><span class="si">}</span><span class="s2"> - </span><span class="si">{</span><span class="n">size</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Asks:&quot;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">price</span><span class="p">,</span> <span class="n">size</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">asks</span><span class="p">,</span> <span class="mi">1</span><span class="p">):</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  </span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">. $</span><span class="si">{</span><span class="n">price</span><span class="si">}</span><span class="s2"> - </span><span class="si">{</span><span class="n">size</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="trade-stream-monitoring">
<h3>Trade Stream Monitoring<a class="headerlink" href="#trade-stream-monitoring" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">monitor_trades</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Monitor real-time trades&quot;&quot;&quot;</span>
    <span class="n">config</span> <span class="o">=</span> <span class="n">WeexConfig</span><span class="o">.</span><span class="n">from_env</span><span class="p">()</span>

    <span class="k">async</span> <span class="k">with</span> <span class="n">WeexWebSocketClient</span><span class="p">(</span><span class="n">config</span><span class="p">)</span> <span class="k">as</span> <span class="n">ws_client</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;💰 Monitoring BTC/USDT trades...&quot;</span><span class="p">)</span>

        <span class="k">async</span> <span class="k">for</span> <span class="n">trade_message</span> <span class="ow">in</span> <span class="n">ws_client</span><span class="o">.</span><span class="n">stream_trades</span><span class="p">(</span><span class="s2">&quot;BTCUSDT&quot;</span><span class="p">):</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">trade_message</span><span class="o">.</span><span class="n">data</span>
            <span class="n">timestamp</span> <span class="o">=</span> <span class="n">trade_message</span><span class="o">.</span><span class="n">timestamp</span>

            <span class="n">price</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;price&quot;</span><span class="p">,</span> <span class="s2">&quot;N/A&quot;</span><span class="p">)</span>
            <span class="n">size</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;size&quot;</span><span class="p">,</span> <span class="s2">&quot;N/A&quot;</span><span class="p">)</span>
            <span class="n">side</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;side&quot;</span><span class="p">,</span> <span class="s2">&quot;N/A&quot;</span><span class="p">)</span>

            <span class="n">side_emoji</span> <span class="o">=</span> <span class="s2">&quot;🟢&quot;</span> <span class="k">if</span> <span class="n">side</span> <span class="o">==</span> <span class="s2">&quot;buy&quot;</span> <span class="k">else</span> <span class="s2">&quot;🔴&quot;</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">timestamp</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">side_emoji</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">size</span><span class="si">}</span><span class="s2"> BTC @ $</span><span class="si">{</span><span class="n">price</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>
<section id="private-data-streaming">
<h2>Private Data Streaming<a class="headerlink" href="#private-data-streaming" title="Link to this heading"></a></h2>
<section id="account-updates">
<h3>Account Updates<a class="headerlink" href="#account-updates" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">monitor_account</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Monitor real-time account updates&quot;&quot;&quot;</span>
    <span class="n">config</span> <span class="o">=</span> <span class="n">WeexConfig</span><span class="o">.</span><span class="n">from_env</span><span class="p">()</span>

    <span class="k">async</span> <span class="k">with</span> <span class="n">WeexWebSocketClient</span><span class="p">(</span><span class="n">config</span><span class="p">)</span> <span class="k">as</span> <span class="n">ws_client</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;💼 Monitoring account updates...&quot;</span><span class="p">)</span>

        <span class="k">async</span> <span class="k">for</span> <span class="n">account_message</span> <span class="ow">in</span> <span class="n">ws_client</span><span class="o">.</span><span class="n">stream_account</span><span class="p">():</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">account_message</span><span class="o">.</span><span class="n">data</span>
            <span class="n">timestamp</span> <span class="o">=</span> <span class="n">account_message</span><span class="o">.</span><span class="n">timestamp</span>

            <span class="n">balance</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;balance&quot;</span><span class="p">,</span> <span class="s2">&quot;N/A&quot;</span><span class="p">)</span>
            <span class="n">available</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;available&quot;</span><span class="p">,</span> <span class="s2">&quot;N/A&quot;</span><span class="p">)</span>
            <span class="n">frozen</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;frozen&quot;</span><span class="p">,</span> <span class="s2">&quot;N/A&quot;</span><span class="p">)</span>

            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">timestamp</span><span class="si">}</span><span class="s2">: Balance: </span><span class="si">{</span><span class="n">balance</span><span class="si">}</span><span class="s2"> | Available: </span><span class="si">{</span><span class="n">available</span><span class="si">}</span><span class="s2"> | Frozen: </span><span class="si">{</span><span class="n">frozen</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="position-monitoring">
<h3>Position Monitoring<a class="headerlink" href="#position-monitoring" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">monitor_positions</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Monitor real-time position updates&quot;&quot;&quot;</span>
    <span class="n">config</span> <span class="o">=</span> <span class="n">WeexConfig</span><span class="o">.</span><span class="n">from_env</span><span class="p">()</span>

    <span class="k">async</span> <span class="k">with</span> <span class="n">WeexWebSocketClient</span><span class="p">(</span><span class="n">config</span><span class="p">)</span> <span class="k">as</span> <span class="n">ws_client</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;📊 Monitoring positions...&quot;</span><span class="p">)</span>

        <span class="k">async</span> <span class="k">for</span> <span class="n">position_message</span> <span class="ow">in</span> <span class="n">ws_client</span><span class="o">.</span><span class="n">stream_positions</span><span class="p">():</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">position_message</span><span class="o">.</span><span class="n">data</span>
            <span class="n">timestamp</span> <span class="o">=</span> <span class="n">position_message</span><span class="o">.</span><span class="n">timestamp</span>

            <span class="n">symbol</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;symbol&quot;</span><span class="p">,</span> <span class="s2">&quot;N/A&quot;</span><span class="p">)</span>
            <span class="n">size</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;size&quot;</span><span class="p">,</span> <span class="s2">&quot;N/A&quot;</span><span class="p">)</span>
            <span class="n">side</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;side&quot;</span><span class="p">,</span> <span class="s2">&quot;N/A&quot;</span><span class="p">)</span>
            <span class="n">pnl</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;unrealized_pnl&quot;</span><span class="p">,</span> <span class="s2">&quot;N/A&quot;</span><span class="p">)</span>

            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">timestamp</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">symbol</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">side</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">size</span><span class="si">}</span><span class="s2"> | PnL: </span><span class="si">{</span><span class="n">pnl</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="order-updates">
<h3>Order Updates<a class="headerlink" href="#order-updates" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">monitor_orders</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Monitor real-time order updates&quot;&quot;&quot;</span>
    <span class="n">config</span> <span class="o">=</span> <span class="n">WeexConfig</span><span class="o">.</span><span class="n">from_env</span><span class="p">()</span>

    <span class="k">async</span> <span class="k">with</span> <span class="n">WeexWebSocketClient</span><span class="p">(</span><span class="n">config</span><span class="p">)</span> <span class="k">as</span> <span class="n">ws_client</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;📋 Monitoring orders...&quot;</span><span class="p">)</span>

        <span class="k">async</span> <span class="k">for</span> <span class="n">order_message</span> <span class="ow">in</span> <span class="n">ws_client</span><span class="o">.</span><span class="n">stream_orders</span><span class="p">():</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">order_message</span><span class="o">.</span><span class="n">data</span>
            <span class="n">timestamp</span> <span class="o">=</span> <span class="n">order_message</span><span class="o">.</span><span class="n">timestamp</span>

            <span class="n">order_id</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;order_id&quot;</span><span class="p">,</span> <span class="s2">&quot;N/A&quot;</span><span class="p">)</span>
            <span class="n">status</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;status&quot;</span><span class="p">,</span> <span class="s2">&quot;N/A&quot;</span><span class="p">)</span>
            <span class="n">symbol</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;symbol&quot;</span><span class="p">,</span> <span class="s2">&quot;N/A&quot;</span><span class="p">)</span>
            <span class="n">size</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;size&quot;</span><span class="p">,</span> <span class="s2">&quot;N/A&quot;</span><span class="p">)</span>

            <span class="n">status_emoji</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s2">&quot;new&quot;</span><span class="p">:</span> <span class="s2">&quot;🆕&quot;</span><span class="p">,</span>
                <span class="s2">&quot;partially_filled&quot;</span><span class="p">:</span> <span class="s2">&quot;⚡&quot;</span><span class="p">,</span>
                <span class="s2">&quot;filled&quot;</span><span class="p">:</span> <span class="s2">&quot;✅&quot;</span><span class="p">,</span>
                <span class="s2">&quot;canceled&quot;</span><span class="p">:</span> <span class="s2">&quot;❌&quot;</span><span class="p">,</span>
                <span class="s2">&quot;rejected&quot;</span><span class="p">:</span> <span class="s2">&quot;🚫&quot;</span>
            <span class="p">}</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">status</span><span class="p">,</span> <span class="s2">&quot;❓&quot;</span><span class="p">)</span>

            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">timestamp</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">status_emoji</span><span class="si">}</span><span class="s2"> Order </span><span class="si">{</span><span class="n">order_id</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">symbol</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">size</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="n">status</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>
<section id="advanced-streaming-patterns">
<h2>Advanced Streaming Patterns<a class="headerlink" href="#advanced-streaming-patterns" title="Link to this heading"></a></h2>
<section id="multi-symbol-monitoring">
<h3>Multi-Symbol Monitoring<a class="headerlink" href="#multi-symbol-monitoring" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">monitor_multiple_symbols</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Monitor multiple symbols simultaneously&quot;&quot;&quot;</span>
    <span class="n">config</span> <span class="o">=</span> <span class="n">WeexConfig</span><span class="o">.</span><span class="n">from_env</span><span class="p">()</span>
    <span class="n">symbols</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;BTCUSDT&quot;</span><span class="p">,</span> <span class="s2">&quot;ETHUSDT&quot;</span><span class="p">,</span> <span class="s2">&quot;ADAUSDT&quot;</span><span class="p">]</span>

    <span class="k">async</span> <span class="k">with</span> <span class="n">WeexWebSocketClient</span><span class="p">(</span><span class="n">config</span><span class="p">)</span> <span class="k">as</span> <span class="n">ws_client</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;📊 Monitoring </span><span class="si">{</span><span class="n">symbols</span><span class="si">}</span><span class="s2">...&quot;</span><span class="p">)</span>

        <span class="c1"># Create tasks for each symbol</span>
        <span class="k">async</span> <span class="k">with</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">TaskGroup</span><span class="p">()</span> <span class="k">as</span> <span class="n">tg</span><span class="p">:</span>
            <span class="n">tasks</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">symbol</span> <span class="ow">in</span> <span class="n">symbols</span><span class="p">:</span>
                <span class="n">task</span> <span class="o">=</span> <span class="n">tg</span><span class="o">.</span><span class="n">create_task</span><span class="p">(</span>
                    <span class="n">monitor_symbol</span><span class="p">(</span><span class="n">ws_client</span><span class="p">,</span> <span class="n">symbol</span><span class="p">)</span>
                <span class="p">)</span>
                <span class="n">tasks</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">task</span><span class="p">)</span>

            <span class="c1"># All symbol monitoring runs concurrently</span>

<span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">monitor_symbol</span><span class="p">(</span><span class="n">ws_client</span><span class="p">,</span> <span class="n">symbol</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Monitor a single symbol&quot;&quot;&quot;</span>
    <span class="k">async</span> <span class="k">for</span> <span class="n">ticker_message</span> <span class="ow">in</span> <span class="n">ws_client</span><span class="o">.</span><span class="n">stream_tickers</span><span class="p">([</span><span class="n">symbol</span><span class="p">]):</span>
        <span class="n">price</span> <span class="o">=</span> <span class="n">ticker_message</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;last&quot;</span><span class="p">,</span> <span class="s2">&quot;N/A&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">symbol</span><span class="si">}</span><span class="s2">: $</span><span class="si">{</span><span class="n">price</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="real-time-analysis">
<h3>Real-time Analysis<a class="headerlink" href="#real-time-analysis" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">real_time_analysis</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Perform real-time analysis on stream data&quot;&quot;&quot;</span>
    <span class="n">config</span> <span class="o">=</span> <span class="n">WeexConfig</span><span class="o">.</span><span class="n">from_env</span><span class="p">()</span>

    <span class="k">async</span> <span class="k">with</span> <span class="n">WeexWebSocketClient</span><span class="p">(</span><span class="n">config</span><span class="p">)</span> <span class="k">as</span> <span class="n">ws_client</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;📊 Starting real-time analysis...&quot;</span><span class="p">)</span>

        <span class="n">price_history</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">moving_avg_period</span> <span class="o">=</span> <span class="mi">20</span>

        <span class="k">async</span> <span class="k">for</span> <span class="n">ticker_message</span> <span class="ow">in</span> <span class="n">ws_client</span><span class="o">.</span><span class="n">stream_tickers</span><span class="p">([</span><span class="s2">&quot;BTCUSDT&quot;</span><span class="p">]):</span>
            <span class="n">price</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">ticker_message</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;last&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
            <span class="n">timestamp</span> <span class="o">=</span> <span class="n">ticker_message</span><span class="o">.</span><span class="n">timestamp</span>

            <span class="n">price_history</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">price</span><span class="p">)</span>

            <span class="c1"># Keep only recent history</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">price_history</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">moving_avg_period</span><span class="p">:</span>
                <span class="n">price_history</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

            <span class="c1"># Calculate moving average</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">price_history</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="n">moving_avg_period</span><span class="p">:</span>
                <span class="n">moving_avg</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">price_history</span><span class="p">)</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">price_history</span><span class="p">)</span>

                <span class="c1"># Simple trading signal</span>
                <span class="k">if</span> <span class="n">price</span> <span class="o">&gt;</span> <span class="n">moving_avg</span> <span class="o">*</span> <span class="mf">1.02</span><span class="p">:</span>  <span class="c1"># 2% above MA</span>
                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">timestamp</span><span class="si">}</span><span class="s2">: 📈 BUY signal - Price: $</span><span class="si">{</span><span class="n">price</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">, MA: $</span><span class="si">{</span><span class="n">moving_avg</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">price</span> <span class="o">&lt;</span> <span class="n">moving_avg</span> <span class="o">*</span> <span class="mf">0.98</span><span class="p">:</span>  <span class="c1"># 2% below MA</span>
                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">timestamp</span><span class="si">}</span><span class="s2">: 📉 SELL signal - Price: $</span><span class="si">{</span><span class="n">price</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">, MA: $</span><span class="si">{</span><span class="n">moving_avg</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">timestamp</span><span class="si">}</span><span class="s2">: 📊 HOLD - Price: $</span><span class="si">{</span><span class="n">price</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">, MA: $</span><span class="si">{</span><span class="n">moving_avg</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="risk-management-integration">
<h3>Risk Management Integration<a class="headerlink" href="#risk-management-integration" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">risk_monitored_trading</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Real-time risk monitoring with WebSocket&quot;&quot;&quot;</span>
    <span class="n">config</span> <span class="o">=</span> <span class="n">WeexConfig</span><span class="o">.</span><span class="n">from_env</span><span class="p">()</span>

    <span class="k">async</span> <span class="k">with</span> <span class="n">WeexWebSocketClient</span><span class="p">(</span><span class="n">config</span><span class="p">)</span> <span class="k">as</span> <span class="n">ws_client</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;🛡️ Starting risk-monitored trading...&quot;</span><span class="p">)</span>

        <span class="n">risk_limits</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;max_position_size&quot;</span><span class="p">:</span> <span class="mi">1000</span><span class="p">,</span>  <span class="c1"># USD</span>
            <span class="s2">&quot;max_daily_loss&quot;</span><span class="p">:</span> <span class="mi">100</span><span class="p">,</span>      <span class="c1"># USD</span>
            <span class="s2">&quot;max_drawdown&quot;</span><span class="p">:</span> <span class="mf">0.1</span>         <span class="c1"># 10%</span>
        <span class="p">}</span>

        <span class="n">current_positions</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">daily_pnl</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">starting_balance</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="c1"># Monitor positions for risk breaches</span>
        <span class="k">async</span> <span class="k">for</span> <span class="n">position_message</span> <span class="ow">in</span> <span class="n">ws_client</span><span class="o">.</span><span class="n">stream_positions</span><span class="p">():</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">position_message</span><span class="o">.</span><span class="n">data</span>
            <span class="n">symbol</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;symbol&quot;</span><span class="p">)</span>
            <span class="n">size</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;size&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
            <span class="n">pnl</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;unrealized_pnl&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>

            <span class="n">current_positions</span><span class="p">[</span><span class="n">symbol</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;size&quot;</span><span class="p">:</span> <span class="n">size</span><span class="p">,</span> <span class="s2">&quot;pnl&quot;</span><span class="p">:</span> <span class="n">pnl</span><span class="p">}</span>

            <span class="c1"># Check position size limits</span>
            <span class="n">current_exposure</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span>
                <span class="nb">abs</span><span class="p">(</span><span class="n">pos</span><span class="p">[</span><span class="s2">&quot;size&quot;</span><span class="p">])</span> <span class="o">*</span> <span class="n">get_current_price</span><span class="p">(</span><span class="n">symbol</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">symbol</span><span class="p">,</span> <span class="n">pos</span> <span class="ow">in</span> <span class="n">current_positions</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
            <span class="p">)</span>

            <span class="k">if</span> <span class="n">current_exposure</span> <span class="o">&gt;</span> <span class="n">risk_limits</span><span class="p">[</span><span class="s2">&quot;max_position_size&quot;</span><span class="p">]:</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;🚨 POSITION SIZE LIMIT BREACHED: $</span><span class="si">{</span><span class="n">current_exposure</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="k">await</span> <span class="n">emergency_reduce_positions</span><span class="p">()</span>

            <span class="c1"># Check daily loss limits</span>
            <span class="n">total_pnl</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">pos</span><span class="p">[</span><span class="s2">&quot;pnl&quot;</span><span class="p">]</span> <span class="k">for</span> <span class="n">pos</span> <span class="ow">in</span> <span class="n">current_positions</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
            <span class="k">if</span> <span class="n">total_pnl</span> <span class="o">&lt;</span> <span class="o">-</span><span class="n">risk_limits</span><span class="p">[</span><span class="s2">&quot;max_daily_loss&quot;</span><span class="p">]:</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;🚨 DAILY LOSS LIMIT BREACHED: $</span><span class="si">{</span><span class="n">total_pnl</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="k">await</span> <span class="n">emergency_close_all_positions</span><span class="p">()</span>
</pre></div>
</div>
</section>
</section>
<section id="paper-trading-with-websocket">
<h2>Paper Trading with WebSocket<a class="headerlink" href="#paper-trading-with-websocket" title="Link to this heading"></a></h2>
<section id="paper-trading-engine">
<h3>Paper Trading Engine<a class="headerlink" href="#paper-trading-engine" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">PaperTradingEngine</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">initial_balance</span><span class="o">=</span><span class="mi">10000</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">balance</span> <span class="o">=</span> <span class="n">initial_balance</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">positions</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">orders</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">trades</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">trade_id</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">simulate_trading</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">config</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Run paper trading simulation with real market data&quot;&quot;&quot;</span>
        <span class="k">async</span> <span class="k">with</span> <span class="n">WeexWebSocketClient</span><span class="p">(</span><span class="n">config</span><span class="p">)</span> <span class="k">as</span> <span class="n">ws_client</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;🎯 Starting paper trading simulation...&quot;</span><span class="p">)</span>

            <span class="k">async</span> <span class="k">for</span> <span class="n">ticker_message</span> <span class="ow">in</span> <span class="n">ws_client</span><span class="o">.</span><span class="n">stream_tickers</span><span class="p">([</span><span class="s2">&quot;BTCUSDT&quot;</span><span class="p">]):</span>
                <span class="n">price</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">ticker_message</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;last&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
                <span class="n">timestamp</span> <span class="o">=</span> <span class="n">ticker_message</span><span class="o">.</span><span class="n">timestamp</span>

                <span class="c1"># Simple trading logic</span>
                <span class="n">signal</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">generate_signal</span><span class="p">(</span><span class="n">price</span><span class="p">)</span>

                <span class="k">if</span> <span class="n">signal</span> <span class="o">==</span> <span class="s2">&quot;buy&quot;</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">balance</span> <span class="o">&gt;</span> <span class="mi">100</span><span class="p">:</span>
                    <span class="c1"># Buy 1% of balance</span>
                    <span class="n">order_size</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">balance</span> <span class="o">*</span> <span class="mf">0.01</span> <span class="o">/</span> <span class="n">price</span>
                    <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">execute_buy</span><span class="p">(</span><span class="n">price</span><span class="p">,</span> <span class="n">order_size</span><span class="p">,</span> <span class="n">timestamp</span><span class="p">)</span>

                <span class="k">elif</span> <span class="n">signal</span> <span class="o">==</span> <span class="s2">&quot;sell&quot;</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">has_position</span><span class="p">(</span><span class="s2">&quot;BTCUSDT&quot;</span><span class="p">):</span>
                    <span class="c1"># Sell all BTC</span>
                    <span class="n">position_size</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">positions</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;BTCUSDT&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
                    <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">execute_sell</span><span class="p">(</span><span class="n">price</span><span class="p">,</span> <span class="n">position_size</span><span class="p">,</span> <span class="n">timestamp</span><span class="p">)</span>

                <span class="c1"># Print portfolio status</span>
                <span class="n">portfolio_value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calculate_portfolio_value</span><span class="p">(</span><span class="n">price</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">timestamp</span><span class="si">}</span><span class="s2">: Portfolio: $</span><span class="si">{</span><span class="n">portfolio_value</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> | Balance: $</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">balance</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">generate_signal</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">price</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Simple trading signal generator&quot;&quot;&quot;</span>
        <span class="c1"># Implement your trading logic here</span>
        <span class="c1"># This is just a placeholder</span>
        <span class="kn">import</span><span class="w"> </span><span class="nn">random</span>
        <span class="k">return</span> <span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">([</span><span class="s2">&quot;buy&quot;</span><span class="p">,</span> <span class="s2">&quot;sell&quot;</span><span class="p">,</span> <span class="s2">&quot;hold&quot;</span><span class="p">])</span>

    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">execute_buy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">price</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="n">timestamp</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Execute buy order in paper trading&quot;&quot;&quot;</span>
        <span class="n">cost</span> <span class="o">=</span> <span class="n">price</span> <span class="o">*</span> <span class="n">size</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">balance</span> <span class="o">-=</span> <span class="n">cost</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">positions</span><span class="p">[</span><span class="s2">&quot;BTCUSDT&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">positions</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;BTCUSDT&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="n">size</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">trade_id</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">trades</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
            <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">trade_id</span><span class="p">,</span>
            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;buy&quot;</span><span class="p">,</span>
            <span class="s2">&quot;price&quot;</span><span class="p">:</span> <span class="n">price</span><span class="p">,</span>
            <span class="s2">&quot;size&quot;</span><span class="p">:</span> <span class="n">size</span><span class="p">,</span>
            <span class="s2">&quot;cost&quot;</span><span class="p">:</span> <span class="n">cost</span><span class="p">,</span>
            <span class="s2">&quot;timestamp&quot;</span><span class="p">:</span> <span class="n">timestamp</span>
        <span class="p">})</span>

        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;🟢 BUY: </span><span class="si">{</span><span class="n">size</span><span class="si">:</span><span class="s2">.6f</span><span class="si">}</span><span class="s2"> BTC @ $</span><span class="si">{</span><span class="n">price</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> (Cost: $</span><span class="si">{</span><span class="n">cost</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">execute_sell</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">price</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="n">timestamp</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Execute sell order in paper trading&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">size</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">positions</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;BTCUSDT&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">):</span>
            <span class="n">size</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">positions</span><span class="p">[</span><span class="s2">&quot;BTCUSDT&quot;</span><span class="p">]</span>

        <span class="n">revenue</span> <span class="o">=</span> <span class="n">price</span> <span class="o">*</span> <span class="n">size</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">balance</span> <span class="o">+=</span> <span class="n">revenue</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">positions</span><span class="p">[</span><span class="s2">&quot;BTCUSDT&quot;</span><span class="p">]</span> <span class="o">-=</span> <span class="n">size</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">trade_id</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">trades</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
            <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">trade_id</span><span class="p">,</span>
            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;sell&quot;</span><span class="p">,</span>
            <span class="s2">&quot;price&quot;</span><span class="p">:</span> <span class="n">price</span><span class="p">,</span>
            <span class="s2">&quot;size&quot;</span><span class="p">:</span> <span class="n">size</span><span class="p">,</span>
            <span class="s2">&quot;revenue&quot;</span><span class="p">:</span> <span class="n">revenue</span><span class="p">,</span>
            <span class="s2">&quot;timestamp&quot;</span><span class="p">:</span> <span class="n">timestamp</span>
        <span class="p">})</span>

        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;🔴 SELL: </span><span class="si">{</span><span class="n">size</span><span class="si">:</span><span class="s2">.6f</span><span class="si">}</span><span class="s2"> BTC @ $</span><span class="si">{</span><span class="n">price</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> (Revenue: $</span><span class="si">{</span><span class="n">revenue</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">calculate_portfolio_value</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">current_price</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Calculate total portfolio value&quot;&quot;&quot;</span>
        <span class="n">btc_value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">positions</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;BTCUSDT&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">*</span> <span class="n">current_price</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">balance</span> <span class="o">+</span> <span class="n">btc_value</span>

<span class="c1"># Usage</span>
<span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">run_paper_trading</span><span class="p">():</span>
    <span class="n">config</span> <span class="o">=</span> <span class="n">WeexConfig</span><span class="o">.</span><span class="n">from_env</span><span class="p">()</span>
    <span class="n">engine</span> <span class="o">=</span> <span class="n">PaperTradingEngine</span><span class="p">(</span><span class="n">initial_balance</span><span class="o">=</span><span class="mi">10000</span><span class="p">)</span>
    <span class="k">await</span> <span class="n">engine</span><span class="o">.</span><span class="n">simulate_trading</span><span class="p">(</span><span class="n">config</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>
<section id="id6">
<h2>Connection Management<a class="headerlink" href="#id6" title="Link to this heading"></a></h2>
<section id="error-handling-and-reconnection">
<h3>Error Handling and Reconnection<a class="headerlink" href="#error-handling-and-reconnection" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">robust_websocket_client</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;WebSocket client with robust error handling&quot;&quot;&quot;</span>
    <span class="n">config</span> <span class="o">=</span> <span class="n">WeexConfig</span><span class="o">.</span><span class="n">from_env</span><span class="p">()</span>

    <span class="n">max_reconnect_attempts</span> <span class="o">=</span> <span class="mi">5</span>
    <span class="n">reconnect_delay</span> <span class="o">=</span> <span class="mi">5</span>  <span class="c1"># seconds</span>

    <span class="k">for</span> <span class="n">attempt</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">max_reconnect_attempts</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">async</span> <span class="k">with</span> <span class="n">WeexWebSocketClient</span><span class="p">(</span><span class="n">config</span><span class="p">)</span> <span class="k">as</span> <span class="n">ws_client</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;🔌 Connected (attempt </span><span class="si">{</span><span class="n">attempt</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>

                <span class="k">async</span> <span class="k">for</span> <span class="n">ticker_message</span> <span class="ow">in</span> <span class="n">ws_client</span><span class="o">.</span><span class="n">stream_tickers</span><span class="p">([</span><span class="s2">&quot;BTCUSDT&quot;</span><span class="p">]):</span>
                    <span class="n">price</span> <span class="o">=</span> <span class="n">ticker_message</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;last&quot;</span><span class="p">)</span>
                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Price: $</span><span class="si">{</span><span class="n">price</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;❌ Connection error: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">attempt</span> <span class="o">&lt;</span> <span class="n">max_reconnect_attempts</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;🔄 Reconnecting in </span><span class="si">{</span><span class="n">reconnect_delay</span><span class="si">}</span><span class="s2"> seconds...&quot;</span><span class="p">)</span>
                <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="n">reconnect_delay</span><span class="p">)</span>
                <span class="c1"># Increase delay for next attempt</span>
                <span class="n">reconnect_delay</span> <span class="o">*=</span> <span class="mi">2</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;💥 Max reconnection attempts reached&quot;</span><span class="p">)</span>
                <span class="k">raise</span>
</pre></div>
</div>
</section>
<section id="message-filtering-and-processing">
<h3>Message Filtering and Processing<a class="headerlink" href="#message-filtering-and-processing" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">filtered_streaming</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Process only relevant messages&quot;&quot;&quot;</span>
    <span class="n">config</span> <span class="o">=</span> <span class="n">WeexConfig</span><span class="o">.</span><span class="n">from_env</span><span class="p">()</span>

    <span class="k">async</span> <span class="k">with</span> <span class="n">WeexWebSocketClient</span><span class="p">(</span><span class="n">config</span><span class="p">)</span> <span class="k">as</span> <span class="n">ws_client</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;📊 Starting filtered streaming...&quot;</span><span class="p">)</span>

        <span class="k">async</span> <span class="k">for</span> <span class="n">ticker_message</span> <span class="ow">in</span> <span class="n">ws_client</span><span class="o">.</span><span class="n">stream_tickers</span><span class="p">([</span><span class="s2">&quot;BTCUSDT&quot;</span><span class="p">]):</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">ticker_message</span><span class="o">.</span><span class="n">data</span>

            <span class="c1"># Filter by price changes &gt; 0.1%</span>
            <span class="n">price_change</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;change&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
            <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">price_change</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">0.1</span><span class="p">:</span>
                <span class="n">price</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;last&quot;</span><span class="p">,</span> <span class="s2">&quot;N/A&quot;</span><span class="p">)</span>
                <span class="n">volume</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;volume&quot;</span><span class="p">,</span> <span class="s2">&quot;N/A&quot;</span><span class="p">)</span>

                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;📈 Significant move: </span><span class="si">{</span><span class="n">price_change</span><span class="si">}</span><span class="s2">% | Price: $</span><span class="si">{</span><span class="n">price</span><span class="si">}</span><span class="s2"> | Volume: </span><span class="si">{</span><span class="n">volume</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>
<section id="performance-optimization">
<h2>Performance Optimization<a class="headerlink" href="#performance-optimization" title="Link to this heading"></a></h2>
<section id="memory-management">
<h3>Memory Management<a class="headerlink" href="#memory-management" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">memory_efficient_streaming</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Stream without accumulating data in memory&quot;&quot;&quot;</span>
    <span class="n">config</span> <span class="o">=</span> <span class="n">WeexConfig</span><span class="o">.</span><span class="n">from_env</span><span class="p">()</span>

    <span class="k">async</span> <span class="k">with</span> <span class="n">WeexWebSocketClient</span><span class="p">(</span><span class="n">config</span><span class="p">)</span> <span class="k">as</span> <span class="n">ws_client</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;📊 Memory-efficient streaming...&quot;</span><span class="p">)</span>

        <span class="k">async</span> <span class="k">for</span> <span class="n">ticker_message</span> <span class="ow">in</span> <span class="n">ws_client</span><span class="o">.</span><span class="n">stream_tickers</span><span class="p">([</span><span class="s2">&quot;BTCUSDT&quot;</span><span class="p">]):</span>
            <span class="c1"># Process data immediately, don&#39;t store it</span>
            <span class="n">price</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">ticker_message</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;last&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>

            <span class="c1"># Only keep what you need</span>
            <span class="k">if</span> <span class="n">price</span> <span class="o">&gt;</span> <span class="mi">50000</span><span class="p">:</span>  <span class="c1"># Example filter</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;High price alert: $</span><span class="si">{</span><span class="n">price</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

            <span class="c1"># No accumulation - memory stays constant</span>
</pre></div>
</div>
</section>
<section id="batch-processing">
<h3>Batch Processing<a class="headerlink" href="#batch-processing" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">batch_stream_processing</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Process messages in batches for efficiency&quot;&quot;&quot;</span>
    <span class="n">config</span> <span class="o">=</span> <span class="n">WeexConfig</span><span class="o">.</span><span class="n">from_env</span><span class="p">()</span>

    <span class="k">async</span> <span class="k">with</span> <span class="n">WeexWebSocketClient</span><span class="p">(</span><span class="n">config</span><span class="p">)</span> <span class="k">as</span> <span class="n">ws_client</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;📊 Batch processing...&quot;</span><span class="p">)</span>

        <span class="n">batch_size</span> <span class="o">=</span> <span class="mi">10</span>
        <span class="n">batch</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">async</span> <span class="k">for</span> <span class="n">ticker_message</span> <span class="ow">in</span> <span class="n">ws_client</span><span class="o">.</span><span class="n">stream_tickers</span><span class="p">([</span><span class="s2">&quot;BTCUSDT&quot;</span><span class="p">]):</span>
            <span class="n">batch</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ticker_message</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>

            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">batch</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="n">batch_size</span><span class="p">:</span>
                <span class="c1"># Process batch</span>
                <span class="k">await</span> <span class="n">process_ticker_batch</span><span class="p">(</span><span class="n">batch</span><span class="p">)</span>
                <span class="n">batch</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># Clear batch</span>

        <span class="c1"># Process remaining messages</span>
        <span class="k">if</span> <span class="n">batch</span><span class="p">:</span>
            <span class="k">await</span> <span class="n">process_ticker_batch</span><span class="p">(</span><span class="n">batch</span><span class="p">)</span>

<span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">process_ticker_batch</span><span class="p">(</span><span class="n">ticker_batch</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Process a batch of ticker messages&quot;&quot;&quot;</span>
    <span class="n">prices</span> <span class="o">=</span> <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;last&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">ticker_batch</span><span class="p">]</span>
    <span class="n">avg_price</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">prices</span><span class="p">)</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">prices</span><span class="p">)</span>
    <span class="n">max_price</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">prices</span><span class="p">)</span>
    <span class="n">min_price</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">prices</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Batch: Avg: $</span><span class="si">{</span><span class="n">avg_price</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> | Max: $</span><span class="si">{</span><span class="n">max_price</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> | Min: $</span><span class="si">{</span><span class="n">min_price</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>
<section id="common-websocket-patterns">
<h2>Common WebSocket Patterns<a class="headerlink" href="#common-websocket-patterns" title="Link to this heading"></a></h2>
<section id="heartbeat-and-health-checks">
<h3>Heartbeat and Health Checks<a class="headerlink" href="#heartbeat-and-health-checks" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">websocket_with_heartbeat</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;WebSocket client with heartbeat monitoring&quot;&quot;&quot;</span>
    <span class="n">config</span> <span class="o">=</span> <span class="n">WeexConfig</span><span class="o">.</span><span class="n">from_env</span><span class="p">()</span>

    <span class="k">async</span> <span class="k">with</span> <span class="n">WeexWebSocketClient</span><span class="p">(</span><span class="n">config</span><span class="p">)</span> <span class="k">as</span> <span class="n">ws_client</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;💓 Starting heartbeat...&quot;</span><span class="p">)</span>

        <span class="n">last_message_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
        <span class="n">heartbeat_interval</span> <span class="o">=</span> <span class="mi">30</span>  <span class="c1"># seconds</span>

        <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">heartbeat_checker</span><span class="p">():</span>
            <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
                <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="n">heartbeat_interval</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">last_message_time</span> <span class="o">&gt;</span> <span class="n">heartbeat_interval</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;💔 No messages received - potential connection issue&quot;</span><span class="p">)</span>

        <span class="n">heartbeat_task</span> <span class="o">=</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">create_task</span><span class="p">(</span><span class="n">heartbeat_checker</span><span class="p">())</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="k">async</span> <span class="k">for</span> <span class="n">ticker_message</span> <span class="ow">in</span> <span class="n">ws_client</span><span class="o">.</span><span class="n">stream_tickers</span><span class="p">([</span><span class="s2">&quot;BTCUSDT&quot;</span><span class="p">]):</span>
                <span class="n">last_message_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;💓 Message received: </span><span class="si">{</span><span class="n">ticker_message</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;last&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="k">finally</span><span class="p">:</span>
            <span class="n">heartbeat_task</span><span class="o">.</span><span class="n">cancel</span><span class="p">()</span>
</pre></div>
</div>
</section>
<section id="data-storage">
<h3>Data Storage<a class="headerlink" href="#data-storage" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">aiosqlite</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">json</span>

<span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">store_stream_data</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Store WebSocket data to database&quot;&quot;&quot;</span>
    <span class="n">config</span> <span class="o">=</span> <span class="n">WeexConfig</span><span class="o">.</span><span class="n">from_env</span><span class="p">()</span>

    <span class="k">async</span> <span class="k">with</span> <span class="n">WeexWebSocketClient</span><span class="p">(</span><span class="n">config</span><span class="p">)</span> <span class="k">as</span> <span class="n">ws_client</span><span class="p">:</span>
        <span class="k">async</span> <span class="k">with</span> <span class="n">aiosqlite</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s2">&quot;ticker_data.db&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">db</span><span class="p">:</span>
            <span class="k">await</span> <span class="n">db</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">                CREATE TABLE IF NOT EXISTS tickers (</span>
<span class="s2">                    timestamp REAL,</span>
<span class="s2">                    symbol TEXT,</span>
<span class="s2">                    price REAL,</span>
<span class="s2">                    volume REAL,</span>
<span class="s2">                    change REAL</span>
<span class="s2">                )</span>
<span class="s2">            &quot;&quot;&quot;</span><span class="p">)</span>

            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;💾 Storing ticker data...&quot;</span><span class="p">)</span>

            <span class="k">async</span> <span class="k">for</span> <span class="n">ticker_message</span> <span class="ow">in</span> <span class="n">ws_client</span><span class="o">.</span><span class="n">stream_tickers</span><span class="p">([</span><span class="s2">&quot;BTCUSDT&quot;</span><span class="p">]):</span>
                <span class="n">data</span> <span class="o">=</span> <span class="n">ticker_message</span><span class="o">.</span><span class="n">data</span>
                <span class="n">timestamp</span> <span class="o">=</span> <span class="n">ticker_message</span><span class="o">.</span><span class="n">timestamp</span>

                <span class="k">await</span> <span class="n">db</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">                    INSERT INTO tickers (timestamp, symbol, price, volume, change)</span>
<span class="s2">                    VALUES (?, ?, ?, ?, ?)</span>
<span class="s2">                &quot;&quot;&quot;</span><span class="p">,</span> <span class="p">(</span>
                    <span class="n">timestamp</span><span class="p">,</span>
                    <span class="s2">&quot;BTCUSDT&quot;</span><span class="p">,</span>
                    <span class="nb">float</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;last&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)),</span>
                    <span class="nb">float</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;volume&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)),</span>
                    <span class="nb">float</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;change&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
                <span class="p">))</span>

                <span class="k">await</span> <span class="n">db</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</pre></div>
</div>
</section>
</section>
</section>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, Weex Client Contributors.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>