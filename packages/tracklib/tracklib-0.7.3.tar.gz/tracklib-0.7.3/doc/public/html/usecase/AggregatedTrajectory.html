
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Aggregated Trajectory: position errors and shape deviation &#8212; TrackLib 1.0 documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=3ee479438cf8b5e0d341" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=3ee479438cf8b5e0d341" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=3ee479438cf8b5e0d341" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=3ee479438cf8b5e0d341" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../_static/nbsphinx-code-cells.css?v=2aa19091" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=3ee479438cf8b5e0d341" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=3ee479438cf8b5e0d341" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=3ee479438cf8b5e0d341"></script>

    <script src="../_static/documentation_options.js?v=f2a433a1"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'usecase/AggregatedTrajectory';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="prev" title="Different stops detection methods" href="StopPoints.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/TracklibLogo.png" class="logo__image only-light" alt="TrackLib 1.0 documentation - Home"/>
    <script>document.write(`<img src="../_static/TracklibLogo.png" class="logo__image only-dark" alt="TrackLib 1.0 documentation - Home"/>`);</script>
  
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav class="navbar-nav">
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item pst-header-nav-item">
  <a class="nav-link nav-internal" href="../started/index.html">
    Getting Started
  </a>
</li>


<li class="nav-item pst-header-nav-item">
  <a class="nav-link nav-internal" href="../userguide/gallery.html">
    Quick Examples
  </a>
</li>


<li class="nav-item pst-header-nav-item current active">
  <a class="nav-link nav-internal" href="index.html">
    Use Cases
  </a>
</li>

  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script>
        </div>
      
      
        <div class="navbar-item">

<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script></div>
      
        <div class="navbar-item"><ul class="navbar-icon-links navbar-nav"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/umrlastig/tracklib" title="GitHub" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fa-brands fa-square-github fa-lg" aria-hidden="true"></i></span>
            <span class="sr-only">GitHub</span></a>
        </li>
</ul></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script>
    </div>
  

  
    <button class="sidebar-toggle secondary-toggle" aria-label="On this page">
      <span class="fa-solid fa-outdent"></span>
    </button>
  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item">
<nav class="navbar-nav">
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item pst-header-nav-item">
  <a class="nav-link nav-internal" href="../started/index.html">
    Getting Started
  </a>
</li>


<li class="nav-item pst-header-nav-item">
  <a class="nav-link nav-internal" href="../userguide/gallery.html">
    Quick Examples
  </a>
</li>


<li class="nav-item pst-header-nav-item current active">
  <a class="nav-link nav-internal" href="index.html">
    Use Cases
  </a>
</li>

  </ul>
</nav></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">

<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script></div>
        
          <div class="navbar-item"><ul class="navbar-icon-links navbar-nav"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/umrlastig/tracklib" title="GitHub" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fa-brands fa-square-github fa-lg" aria-hidden="true"></i></span>
            <span class="sr-only">GitHub</span></a>
        </li>
</ul></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
<nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="Quickstart.html">A quickstart guide to the Tracklib library</a></li>
<li class="toctree-l1"><a class="reference internal" href="Summarize.html">Summarize GPS information in a regular grid</a></li>
<li class="toctree-l1"><a class="reference internal" href="Switchbacks.html">Switchbacks identification</a></li>
<li class="toctree-l1"><a class="reference internal" href="KalmanFiltering.html">Kalman filtering</a></li>
<li class="toctree-l1"><a class="reference internal" href="StopPoints.html">Different stops detection methods</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Aggregated Trajectory: position errors and shape deviation</a></li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">



<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="index.html" class="nav-link">Use Cases</a></li>
    
    <li class="breadcrumb-item active" aria-current="page">Aggregated...</li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="Aggregated-Trajectory:-position-errors-and-shape-deviation">
<h1>Aggregated Trajectory: position errors and shape deviation<a class="headerlink" href="#Aggregated-Trajectory:-position-errors-and-shape-deviation" title="Link to this heading">#</a></h1>
<p>In this tutorial, we will examine the aggregation of trajectories using two matching distances: the Fréchet distance and the DTW-L2 distance, and thus see its ability to reconstruct accurately the common path followed by all the individual sample trajectories by comparing the position errors and the shape deviation.</p>
<p>Our experiment will be conducted in four steps: 1. Step 1: creating a synthetically reference track considered as the ground truth track, 2. Step 2: creating a set of simulated tracks from the reference track, 3. Step 3: computing the aggregation track from the set previously constructed (step 2), 4. Step 4: the error (position and shape) between the estimated and ground truth track is then evaluated.</p>
<p>This tutorial is based on the work presented in [1 SIGSPATIAL 2024]</p>
<div class="alert alert-block alert-info"><p>References:</p>
<ul><li><p>[1 SIGSPATIAL 2024] TODO</p>
</li><li><p>[Ripley (2009)] - Ripley, B.D., 2009. Stochastic simulation. vol. 316. Hoboken, NJ: John Wiley &amp; Sons.</p>
</li><li><p>[Ménéroux (2022)] - Méneroux, Y., Maidaneh Abdi, I., Le Guilcher, A., &amp; Olteanu-Raimond, A. M. (2022). Is the radial distance really a distance? An analysis of its properties and interest for the matching of polygon features. International Journal of Geographical Information Science, 37(2), 438–475. <a class="reference external" href="https://doi.org/10.1080/13658816.2022.2123487">https://doi.org/10.1080/13658816.2022.2123487</a></p>
</li></ul></div><section id="As-usual,-let’s-start-by-defining-our-environment">
<h2>As usual, let’s start by defining our environment<a class="headerlink" href="#As-usual,-let’s-start-by-defining-our-environment" title="Link to this heading">#</a></h2>
<p>1/ The first task is <strong>only useful for the online notebook</strong> and import the local tracklib code source. This script is not necessary if tracklib is installed from PyPI.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">os.path</span>
<span class="kn">import</span> <span class="nn">sys</span>

<span class="c1">#-------------------------------------------------------</span>
<span class="c1"># Import de tracklib</span>
<span class="n">module_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s1">&#39;../../..&#39;</span><span class="p">))</span>
<span class="k">if</span> <span class="n">module_path</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="p">:</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">module_path</span><span class="p">)</span>

<span class="kn">import</span> <span class="nn">tracklib</span> <span class="k">as</span> <span class="nn">tkl</span>
<br/></pre></div>
</div>
</div>
<p>2/ The following imports are <strong>necessary</strong> for the tutorial.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">csv</span>
<span class="kn">import</span> <span class="nn">math</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="c1"># For</span>
<span class="kn">from</span> <span class="nn">random</span> <span class="kn">import</span> <span class="n">randint</span>

<span class="c1"># For plotting</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">import</span> <span class="n">cm</span>
</pre></div>
</div>
</div>
<p>3/ Let’s define a function to plot results: (i) visualizeAggTraj: display the track reference and aggregated tracks</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">color</span> <span class="o">=</span> <span class="n">cm</span><span class="o">.</span><span class="n">rainbow</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>

<span class="k">def</span> <span class="nf">visualizeAggTraj</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">N</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">track</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">tracks</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot2grid</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span><span class="n">N</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">i</span><span class="p">))</span>

    <span class="k">if</span> <span class="n">tracks</span> <span class="o">!=</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">tracks</span><span class="p">,</span> <span class="n">tkl</span><span class="o">.</span><span class="n">TrackCollection</span><span class="p">):</span>
        <span class="k">for</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">tracks</span><span class="p">):</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">getX</span><span class="p">(),</span> <span class="n">t</span><span class="o">.</span><span class="n">getY</span><span class="p">(),</span> <span class="n">c</span><span class="o">=</span><span class="n">color</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>

    <span class="k">if</span> <span class="n">tracks</span> <span class="o">!=</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">tracks</span><span class="p">,</span> <span class="n">tkl</span><span class="o">.</span><span class="n">Track</span><span class="p">):</span>
        <span class="n">central</span> <span class="o">=</span> <span class="n">tracks</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">central</span><span class="o">.</span><span class="n">getX</span><span class="p">(),</span> <span class="n">central</span><span class="o">.</span><span class="n">getY</span><span class="p">(),</span> <span class="s1">&#39;c-&#39;</span><span class="p">)</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">track</span><span class="o">.</span><span class="n">getX</span><span class="p">(),</span> <span class="n">track</span><span class="o">.</span><span class="n">getY</span><span class="p">(),</span> <span class="s1">&#39;k-&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">title</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">([])</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">([])</span>
</pre></div>
</div>
</div>
</section>
<section id="Step-1:-Create-reference-tracks">
<h2>Step 1: Create reference tracks<a class="headerlink" href="#Step-1:-Create-reference-tracks" title="Link to this heading">#</a></h2>
<p>For this experimentation, we will examine the trajectory aggregation process for different types of paths to be reconstructed. In the context of mountain hiking, we identified three characteristic path shapes: nearly straight segments, moderately sinuosity road segments, and a zigzagging path composed of a series of switchbacks. To maintain shape consistency throughout the entire road segment, the generated trajectories have a length of approximately 300 meters.</p>
<p>This three commonly mountain path shapes correspond to the reference tracks.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tkl</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">123</span><span class="p">)</span>

<span class="n">SHAPES</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Almost straight&#39;</span><span class="p">,</span> <span class="s1">&#39;Moderate sinuosity&#39;</span><span class="p">,</span> <span class="s1">&#39;Switchbacks&#39;</span><span class="p">]</span>

<span class="c1"># ----------------------------------------------------------</span>
<span class="c1"># Generate the path &#39;Almost straight&#39;</span>
<span class="n">sentier1</span> <span class="o">=</span> <span class="n">tkl</span><span class="o">.</span><span class="n">generate</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="mi">10</span><span class="p">)[::</span><span class="mi">3</span><span class="p">]</span>
<span class="n">sentier1</span><span class="o">.</span><span class="n">scale</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>

<span class="c1"># ----------------------------------------------------------</span>
<span class="n">sentier2</span> <span class="o">=</span> <span class="n">tkl</span><span class="o">.</span><span class="n">generate</span><span class="p">(</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="mi">10</span><span class="p">)[::</span><span class="mi">3</span><span class="p">]</span>
<span class="n">sentier2</span><span class="o">.</span><span class="n">scale</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>

<span class="c1"># ----------------------------------------------------------</span>
<span class="n">base_lacets</span> <span class="o">=</span> <span class="n">tkl</span><span class="o">.</span><span class="n">generate</span><span class="p">(</span><span class="mf">0.4</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">sentier3</span> <span class="o">=</span> <span class="n">tkl</span><span class="o">.</span><span class="n">noise</span><span class="p">(</span><span class="n">base_lacets</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="n">tkl</span><span class="o">.</span><span class="n">SincKernel</span><span class="p">(</span><span class="mi">20</span><span class="p">),</span>
                    <span class="n">direction</span><span class="o">=</span><span class="n">tkl</span><span class="o">.</span><span class="n">MODE_DIRECTION_ORTHO</span><span class="p">)[::</span><span class="mi">3</span><span class="p">]</span>
<span class="n">sentier3</span><span class="o">.</span><span class="n">scale</span><span class="p">(</span><span class="mf">2.5</span><span class="p">)</span>

<span class="c1"># ----------------------------------------------------------</span>
<span class="n">sentiers</span> <span class="o">=</span> <span class="p">[</span><span class="n">sentier1</span><span class="p">,</span> <span class="n">sentier2</span><span class="p">,</span> <span class="n">sentier3</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">sentier1</span><span class="o">.</span><span class="n">length</span><span class="p">(),</span> <span class="mi">2</span><span class="p">),</span> <span class="s1">&#39;m&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">sentier2</span><span class="o">.</span><span class="n">length</span><span class="p">(),</span> <span class="mi">2</span><span class="p">),</span> <span class="s1">&#39;m&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">sentier3</span><span class="o">.</span><span class="n">length</span><span class="p">(),</span> <span class="mi">2</span><span class="p">),</span> <span class="s1">&#39;m&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Generated track from 05/02/2042 00:44:56 to 05/02/2042 01:44:56 [360 pts, 64.1m]
Generated track from 10/10/1982 08:02:44 to 10/10/1982 09:02:44 [360 pts, 297.54m]
Generated track from 25/11/2004 23:29:18 to 26/11/2004 00:29:18 [360 pts, 79.85m]
502.22 m
538.28 m
523.73 m
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># ----------------------------------------------------------</span>
<span class="c1"># Plot</span>
<span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">top</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">wspace</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">hspace</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>

<span class="n">visualizeAggTraj</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">track</span><span class="o">=</span><span class="n">sentier1</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Almost straight&#39;</span><span class="p">)</span>
<span class="n">visualizeAggTraj</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">track</span><span class="o">=</span><span class="n">sentier2</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Moderate sinuosity&#39;</span><span class="p">)</span>
<span class="n">visualizeAggTraj</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">track</span><span class="o">=</span><span class="n">sentier3</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Switchbacks&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/usecase_AggregatedTrajectory_9_1.png" src="../_images/usecase_AggregatedTrajectory_9_1.png" />
</div>
</div>
</section>
<section id="Step-2:-Create-sets-of-simulated-GNSS-trajectories">
<h2>Step 2: Create sets of simulated GNSS trajectories<a class="headerlink" href="#Step-2:-Create-sets-of-simulated-GNSS-trajectories" title="Link to this heading">#</a></h2>
<p>Now that we have our three reference trajectories, we want to create three sets of N simulated GNSS trajectories from them.</p>
<p>To generate realistic noise, we used an approach described in [Ripley (2009)] and also employed in [Ménéroux (2022)]:</p>
<p>With a random generator, we sampled <span class="math notranslate nohighlight">\(N\)</span> i.i.d. unit-variance and zero-mean gaussian values, compiled in a vector <span class="math notranslate nohighlight">\(\mathbf{x}\)</span>. It can easily be shown that, for any positive-definite matrix <span class="math notranslate nohighlight">\(\mathbf{\Sigma} \in \mathbb{R}^{n \times n}\)</span>, the random vector <span class="math notranslate nohighlight">\(\mathbf{y} = \mathbf{Ax}\)</span> where <span class="math notranslate nohighlight">\(\mathbf{A}\)</span> is a Cholesky factor of <span class="math notranslate nohighlight">\(\mathbf{\Sigma}\)</span>, is a realization of a correlated random vector <span class="math notranslate nohighlight">\(\mathbf{Y}\)</span> having covariance matrix <span class="math notranslate nohighlight">\(\Sigma\)</span>. The covariance
matrix <span class="math notranslate nohighlight">\(\mathbf{\Sigma}\)</span> is formed with a (stationary) covariance kernel with three parameters:</p>
<ul class="simple">
<li><p>The <strong>type of kernel</strong>: exponential, gaussian, and triangular models are used.</p></li>
<li><p>The <strong>amplitude</strong> of noise: is between 0 and 5 meters, as it is quite uncommon to find building databases with more than 5 m error amplitude. If necessary, the output tables could be extended to handle large errors.</p></li>
<li><p>The correlation <strong>scope</strong> of the noise which roughly speaking describes how far apart two errors would remain correlated (in both amplitude and direction): between 1 m (white noise) and 1000 m (global translation).</p></li>
</ul>
<p>In tracklib, you have to create a Kernel and use the noise method on a track:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">amp</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">scope</span> <span class="o">=</span> <span class="mi">20</span>
<span class="n">kernel</span> <span class="o">=</span> <span class="n">GaussianKernel</span><span class="p">(</span><span class="n">scope</span><span class="p">)</span>              <span class="c1"># GaussianKernel</span>
<span class="c1"># kernel = ExponentialKernel(scope)         # ExponentialKernel</span>
<span class="c1"># kernel = TriangularKernel(scope)          # TriangularKernel</span>
<span class="n">tracks</span><span class="o">.</span><span class="n">noise</span><span class="p">(</span><span class="n">amp</span><span class="p">,</span> <span class="n">kernel</span><span class="p">)</span>
</pre></div>
</div>
<p>Trajectories have been generated with:</p>
<ul class="simple">
<li><p>a noise generated with a 50 m range Gaussian Process and with a 50 cm-amplitude for referencement error</p></li>
<li><p>completed by a noise generated with a 5 m-amplitude exponential covariance process (GPS error) with a 20 m correlation scope</p></li>
<li><p>and completed by 1 m white noise process (vibrations, electronic noise, etc.)</p></li>
</ul>
<p>Which gives:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">tracks</span><span class="o">.</span><span class="n">noise</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">tkl</span><span class="o">.</span><span class="n">GaussianKernel</span><span class="p">(</span><span class="mi">100</span><span class="p">))</span>
<span class="n">tracks</span><span class="o">.</span><span class="n">noise</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">tkl</span><span class="o">.</span><span class="n">ExponentialKernel</span><span class="p">(</span><span class="mi">50</span><span class="p">))</span>
<span class="n">tracks</span><span class="o">.</span><span class="n">noise</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">tkl</span><span class="o">.</span><span class="n">DiracKernel</span><span class="p">())</span>
</pre></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">N</span> <span class="o">=</span> <span class="mi">50</span>

<span class="c1"># ----------------------------------------------------------</span>
<span class="c1"># Generate &#39;Almost straight&#39;</span>
<span class="n">tracks1</span> <span class="o">=</span> <span class="n">tkl</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">TrackCollection</span><span class="p">([</span><span class="n">sentier1</span><span class="p">]</span><span class="o">*</span><span class="n">N</span><span class="p">)</span>
<span class="n">tracks1</span><span class="o">.</span><span class="n">noise</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">tkl</span><span class="o">.</span><span class="n">GaussianKernel</span><span class="p">(</span><span class="mi">50</span><span class="p">))</span>
<span class="n">tracks1</span><span class="o">.</span><span class="n">noise</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">tkl</span><span class="o">.</span><span class="n">ExponentialKernel</span><span class="p">(</span><span class="mi">20</span><span class="p">))</span>
<span class="n">tracks1</span><span class="o">.</span><span class="n">noise</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">tkl</span><span class="o">.</span><span class="n">DiracKernel</span><span class="p">())</span>

<span class="c1"># ----------------------------------------------------------</span>
<span class="c1"># Generate &#39;Moderate sinuosity&#39;</span>
<span class="n">tracks2</span> <span class="o">=</span> <span class="n">tkl</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">TrackCollection</span><span class="p">([</span><span class="n">sentier2</span><span class="p">]</span><span class="o">*</span><span class="n">N</span><span class="p">)</span>
<span class="n">tracks2</span><span class="o">.</span><span class="n">noise</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">tkl</span><span class="o">.</span><span class="n">GaussianKernel</span><span class="p">(</span><span class="mi">50</span><span class="p">))</span>
<span class="n">tracks2</span><span class="o">.</span><span class="n">noise</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">tkl</span><span class="o">.</span><span class="n">ExponentialKernel</span><span class="p">(</span><span class="mi">20</span><span class="p">))</span>
<span class="n">tracks2</span><span class="o">.</span><span class="n">noise</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">tkl</span><span class="o">.</span><span class="n">DiracKernel</span><span class="p">())</span>

<span class="c1"># ----------------------------------------------------------</span>
<span class="c1"># Generate &#39;Switchbacks&#39;</span>
<span class="n">tracks3</span> <span class="o">=</span> <span class="n">tkl</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">TrackCollection</span><span class="p">([</span><span class="n">sentier3</span><span class="p">]</span><span class="o">*</span><span class="n">N</span><span class="p">)</span>
<span class="n">tracks3</span><span class="o">.</span><span class="n">noise</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">tkl</span><span class="o">.</span><span class="n">GaussianKernel</span><span class="p">(</span><span class="mi">50</span><span class="p">))</span>
<span class="n">tracks3</span><span class="o">.</span><span class="n">noise</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">tkl</span><span class="o">.</span><span class="n">ExponentialKernel</span><span class="p">(</span><span class="mi">20</span><span class="p">))</span>
<span class="n">tracks3</span><span class="o">.</span><span class="n">noise</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">tkl</span><span class="o">.</span><span class="n">DiracKernel</span><span class="p">())</span>
<br/></pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># ----------------------------------------------------------</span>
<span class="c1"># Visualize one realistic noise track</span>
<span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">top</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">wspace</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">hspace</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">visualizeAggTraj</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">N</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">track</span><span class="o">=</span><span class="n">sentier1</span><span class="p">,</span> <span class="n">tracks</span><span class="o">=</span><span class="n">tracks1</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">],</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Almost straight&#39;</span><span class="p">)</span>
<span class="n">visualizeAggTraj</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">N</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">track</span><span class="o">=</span><span class="n">sentier2</span><span class="p">,</span> <span class="n">tracks</span><span class="o">=</span><span class="n">tracks2</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">],</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Moderate sinuosity&#39;</span><span class="p">)</span>
<span class="n">visualizeAggTraj</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">N</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">track</span><span class="o">=</span><span class="n">sentier3</span><span class="p">,</span> <span class="n">tracks</span><span class="o">=</span><span class="n">tracks3</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">],</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Switchbacks&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;A realistic noise applied in the three path shapes&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/usecase_AggregatedTrajectory_12_1.png" src="../_images/usecase_AggregatedTrajectory_12_1.png" />
</div>
</div>
</section>
<section id="Step-3:-Compute-aggregated-trajectory">
<h2>Step 3: Compute aggregated trajectory<a class="headerlink" href="#Step-3:-Compute-aggregated-trajectory" title="Link to this heading">#</a></h2>
<p>We have two evaluations to do: compute the aggregated trajectory with Frechet distance and with <span class="math notranslate nohighlight">\(L_2\)</span> distance.</p>
<p>Each one is conducted as follows: we generate <span class="math notranslate nohighlight">\(N'\)</span> random noisy traces, with <span class="math notranslate nohighlight">\(N' \in [1, E]\)</span> and <span class="math notranslate nohighlight">\(E \le N\)</span>. For each generation, we are going to compare the agregated trajectory against the reference track (<em>i.e.</em> the ground truth).</p>
<p>The computations took a lot of time !</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">E</span> <span class="o">=</span> <span class="mi">20</span>
<span class="n">FRECHET</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Almost straight&#39;</span><span class="p">:</span> <span class="n">tkl</span><span class="o">.</span><span class="n">TrackCollection</span><span class="p">(),</span> <span class="s1">&#39;Moderate sinuosity&#39;</span><span class="p">:</span> <span class="n">tkl</span><span class="o">.</span><span class="n">TrackCollection</span><span class="p">(),</span> <span class="s1">&#39;Switchbacks&#39;</span><span class="p">:</span> <span class="n">tkl</span><span class="o">.</span><span class="n">TrackCollection</span><span class="p">()}</span>
<span class="n">DTW</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Almost straight&#39;</span><span class="p">:</span> <span class="n">tkl</span><span class="o">.</span><span class="n">TrackCollection</span><span class="p">(),</span> <span class="s1">&#39;Moderate sinuosity&#39;</span><span class="p">:</span> <span class="n">tkl</span><span class="o">.</span><span class="n">TrackCollection</span><span class="p">(),</span> <span class="s1">&#39;Switchbacks&#39;</span><span class="p">:</span> <span class="n">tkl</span><span class="o">.</span><span class="n">TrackCollection</span><span class="p">()}</span>

<span class="n">represent_method</span> <span class="o">=</span> <span class="n">tkl</span><span class="o">.</span><span class="n">MODE_REP_BARYCENTRE</span>
<span class="n">agg_method</span> <span class="o">=</span> <span class="n">tkl</span><span class="o">.</span><span class="n">MODE_AGG_MEDIAN</span>
<span class="n">constraint</span> <span class="o">=</span> <span class="kc">False</span>
<span class="n">master</span> <span class="o">=</span> <span class="n">tkl</span><span class="o">.</span><span class="n">MODE_MASTER_MEDIAN_LEN</span>
<span class="n">itermax</span> <span class="o">=</span> <span class="mi">15</span>

<span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">E</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
    <span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;Sample size: &#39;</span><span class="p">,</span> <span class="n">s</span><span class="p">)</span>
    <span class="c1"># create set</span>
    <span class="n">TAB</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
    <span class="k">while</span> <span class="nb">len</span><span class="p">(</span><span class="n">TAB</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">s</span><span class="p">:</span>
        <span class="n">n</span> <span class="o">=</span> <span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">TAB</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>

    <span class="n">sets1</span> <span class="o">=</span> <span class="n">tkl</span><span class="o">.</span><span class="n">TrackCollection</span><span class="p">()</span>
    <span class="n">sets2</span> <span class="o">=</span> <span class="n">tkl</span><span class="o">.</span><span class="n">TrackCollection</span><span class="p">()</span>
    <span class="n">sets3</span> <span class="o">=</span> <span class="n">tkl</span><span class="o">.</span><span class="n">TrackCollection</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="n">TAB</span><span class="p">:</span>
        <span class="n">sets1</span><span class="o">.</span><span class="n">addTrack</span><span class="p">(</span><span class="n">tracks1</span><span class="p">[</span><span class="n">idx</span><span class="p">])</span>
        <span class="n">sets2</span><span class="o">.</span><span class="n">addTrack</span><span class="p">(</span><span class="n">tracks2</span><span class="p">[</span><span class="n">idx</span><span class="p">])</span>
        <span class="n">sets3</span><span class="o">.</span><span class="n">addTrack</span><span class="p">(</span><span class="n">tracks3</span><span class="p">[</span><span class="n">idx</span><span class="p">])</span>

    <span class="c1"># ---------------------------------------------------------------------------</span>
    <span class="c1"># Fréchet</span>
    <span class="n">p</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="s1">&#39;inf&#39;</span><span class="p">)</span>
    <span class="n">mode</span> <span class="o">=</span> <span class="n">tkl</span><span class="o">.</span><span class="n">MODE_MATCHING_FRECHET</span>
    <span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;    FRECHET&#39;</span><span class="p">)</span>

    <span class="n">central1</span> <span class="o">=</span> <span class="n">tkl</span><span class="o">.</span><span class="n">fusion</span><span class="p">(</span><span class="n">sets1</span><span class="p">,</span> <span class="n">master</span><span class="o">=</span><span class="n">master</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="n">mode</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="n">p</span><span class="p">,</span> <span class="n">represent_method</span><span class="o">=</span><span class="n">represent_method</span><span class="p">,</span>  <span class="n">agg_method</span><span class="o">=</span><span class="n">agg_method</span><span class="p">,</span>
                         <span class="n">constraint</span><span class="o">=</span><span class="n">constraint</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">iter_max</span> <span class="o">=</span> <span class="n">itermax</span><span class="p">)</span>
    <span class="n">FRECHET</span><span class="p">[</span><span class="s1">&#39;Almost straight&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">addTrack</span><span class="p">(</span><span class="n">central1</span><span class="p">)</span>

    <span class="n">central2</span> <span class="o">=</span> <span class="n">tkl</span><span class="o">.</span><span class="n">fusion</span><span class="p">(</span><span class="n">sets2</span><span class="p">,</span> <span class="n">master</span><span class="o">=</span><span class="n">master</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="n">mode</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="n">p</span><span class="p">,</span> <span class="n">represent_method</span><span class="o">=</span><span class="n">represent_method</span><span class="p">,</span>  <span class="n">agg_method</span><span class="o">=</span><span class="n">agg_method</span><span class="p">,</span>
                         <span class="n">constraint</span><span class="o">=</span><span class="n">constraint</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">iter_max</span> <span class="o">=</span> <span class="n">itermax</span><span class="p">)</span>
    <span class="n">FRECHET</span><span class="p">[</span><span class="s1">&#39;Moderate sinuosity&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">addTrack</span><span class="p">(</span><span class="n">central2</span><span class="p">)</span>

    <span class="n">central3</span> <span class="o">=</span> <span class="n">tkl</span><span class="o">.</span><span class="n">fusion</span><span class="p">(</span><span class="n">sets3</span><span class="p">,</span> <span class="n">master</span><span class="o">=</span><span class="n">master</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="n">mode</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="n">p</span><span class="p">,</span> <span class="n">represent_method</span><span class="o">=</span><span class="n">represent_method</span><span class="p">,</span>  <span class="n">agg_method</span><span class="o">=</span><span class="n">agg_method</span><span class="p">,</span>
                         <span class="n">constraint</span><span class="o">=</span><span class="n">constraint</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">iter_max</span> <span class="o">=</span> <span class="n">itermax</span><span class="p">)</span>
    <span class="n">FRECHET</span><span class="p">[</span><span class="s1">&#39;Switchbacks&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">addTrack</span><span class="p">(</span><span class="n">central3</span><span class="p">)</span>

    <span class="c1"># ---------------------------------------------------------------------------</span>
    <span class="c1"># DTW</span>
    <span class="n">p</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="n">mode</span> <span class="o">=</span> <span class="n">tkl</span><span class="o">.</span><span class="n">MODE_MATCHING_DTW</span>
    <span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;    DTW&#39;</span><span class="p">)</span>

    <span class="n">central1</span> <span class="o">=</span> <span class="n">tkl</span><span class="o">.</span><span class="n">fusion</span><span class="p">(</span><span class="n">sets1</span><span class="p">,</span> <span class="n">master</span><span class="o">=</span><span class="n">master</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="n">mode</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="n">p</span><span class="p">,</span> <span class="n">represent_method</span><span class="o">=</span><span class="n">represent_method</span><span class="p">,</span>  <span class="n">agg_method</span><span class="o">=</span><span class="n">agg_method</span><span class="p">,</span>
                         <span class="n">constraint</span><span class="o">=</span><span class="n">constraint</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">iter_max</span> <span class="o">=</span> <span class="n">itermax</span><span class="p">)</span>
    <span class="n">DTW</span><span class="p">[</span><span class="s1">&#39;Almost straight&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">addTrack</span><span class="p">(</span><span class="n">central1</span><span class="p">)</span>

    <span class="n">central2</span> <span class="o">=</span> <span class="n">tkl</span><span class="o">.</span><span class="n">fusion</span><span class="p">(</span><span class="n">sets2</span><span class="p">,</span> <span class="n">master</span><span class="o">=</span><span class="n">master</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="n">mode</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="n">p</span><span class="p">,</span> <span class="n">represent_method</span><span class="o">=</span><span class="n">represent_method</span><span class="p">,</span>  <span class="n">agg_method</span><span class="o">=</span><span class="n">agg_method</span><span class="p">,</span>
                         <span class="n">constraint</span><span class="o">=</span><span class="n">constraint</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">iter_max</span> <span class="o">=</span> <span class="n">itermax</span><span class="p">)</span>
    <span class="n">DTW</span><span class="p">[</span><span class="s1">&#39;Moderate sinuosity&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">addTrack</span><span class="p">(</span><span class="n">central2</span><span class="p">)</span>

    <span class="n">central3</span> <span class="o">=</span> <span class="n">tkl</span><span class="o">.</span><span class="n">fusion</span><span class="p">(</span><span class="n">sets3</span><span class="p">,</span> <span class="n">master</span><span class="o">=</span><span class="n">master</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="n">mode</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="n">p</span><span class="p">,</span> <span class="n">represent_method</span><span class="o">=</span><span class="n">represent_method</span><span class="p">,</span>  <span class="n">agg_method</span><span class="o">=</span><span class="n">agg_method</span><span class="p">,</span>
                         <span class="n">constraint</span><span class="o">=</span><span class="n">constraint</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">iter_max</span> <span class="o">=</span> <span class="n">itermax</span><span class="p">)</span>
    <span class="n">DTW</span><span class="p">[</span><span class="s1">&#39;Switchbacks&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">addTrack</span><span class="p">(</span><span class="n">central3</span><span class="p">)</span>
<br/><br/></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Sample size:  1
    FRECHET
    DTW
WARNING: TRAJECTORY FUSION HAS NOT CONVERGED (#ITER = 15 - CV = 0.011198651436051836)
Sample size:  2
    FRECHET
    DTW
Sample size:  3
    FRECHET
WARNING: TRAJECTORY FUSION HAS NOT CONVERGED (#ITER = 15 - CV = 0.5614655106326288)
    DTW
Sample size:  4
    FRECHET
WARNING: TRAJECTORY FUSION HAS NOT CONVERGED (#ITER = 15 - CV = 0.0016083932966432476)
    DTW
Sample size:  5
    FRECHET
WARNING: TRAJECTORY FUSION HAS NOT CONVERGED (#ITER = 15 - CV = 0.5202396735991299)
WARNING: TRAJECTORY FUSION HAS NOT CONVERGED (#ITER = 15 - CV = 0.0078455794677473)
    DTW
Sample size:  6
    FRECHET
WARNING: TRAJECTORY FUSION HAS NOT CONVERGED (#ITER = 15 - CV = 0.34890678946885384)
    DTW
Sample size:  7
    FRECHET
WARNING: TRAJECTORY FUSION HAS NOT CONVERGED (#ITER = 15 - CV = 0.3808974809043013)
WARNING: TRAJECTORY FUSION HAS NOT CONVERGED (#ITER = 15 - CV = 0.18061162487346355)
WARNING: TRAJECTORY FUSION HAS NOT CONVERGED (#ITER = 15 - CV = 0.7132671023921043)
    DTW
Sample size:  8
    FRECHET
WARNING: TRAJECTORY FUSION HAS NOT CONVERGED (#ITER = 15 - CV = 0.43373421020726965)
WARNING: TRAJECTORY FUSION HAS NOT CONVERGED (#ITER = 15 - CV = 0.28755689791998357)
WARNING: TRAJECTORY FUSION HAS NOT CONVERGED (#ITER = 15 - CV = 0.5570206540115176)
    DTW
Sample size:  9
    FRECHET
WARNING: TRAJECTORY FUSION HAS NOT CONVERGED (#ITER = 15 - CV = 0.5403723739655647)
WARNING: TRAJECTORY FUSION HAS NOT CONVERGED (#ITER = 15 - CV = 0.14073407302744725)
WARNING: TRAJECTORY FUSION HAS NOT CONVERGED (#ITER = 15 - CV = 0.522565049482862)
    DTW
Sample size:  10
    FRECHET
WARNING: TRAJECTORY FUSION HAS NOT CONVERGED (#ITER = 15 - CV = 0.27629012399375186)
WARNING: TRAJECTORY FUSION HAS NOT CONVERGED (#ITER = 15 - CV = 0.462752635727296)
    DTW
Sample size:  11
    FRECHET
WARNING: TRAJECTORY FUSION HAS NOT CONVERGED (#ITER = 15 - CV = 0.31701651756979243)
WARNING: TRAJECTORY FUSION HAS NOT CONVERGED (#ITER = 15 - CV = 0.5956418558767445)
    DTW
Sample size:  12
    FRECHET
WARNING: TRAJECTORY FUSION HAS NOT CONVERGED (#ITER = 15 - CV = 0.33557487971935174)
WARNING: TRAJECTORY FUSION HAS NOT CONVERGED (#ITER = 15 - CV = 0.5553610627042874)
WARNING: TRAJECTORY FUSION HAS NOT CONVERGED (#ITER = 15 - CV = 0.9418472824374541)
    DTW
WARNING: TRAJECTORY FUSION HAS NOT CONVERGED (#ITER = 15 - CV = 0.024012249123143384)
Sample size:  13
    FRECHET
WARNING: TRAJECTORY FUSION HAS NOT CONVERGED (#ITER = 15 - CV = 0.47049293200846193)
    DTW
WARNING: TRAJECTORY FUSION HAS NOT CONVERGED (#ITER = 15 - CV = 0.0037039686918909354)
WARNING: TRAJECTORY FUSION HAS NOT CONVERGED (#ITER = 15 - CV = 0.0020273592388316527)
WARNING: TRAJECTORY FUSION HAS NOT CONVERGED (#ITER = 15 - CV = 0.02718411231672197)
Sample size:  14
    FRECHET
WARNING: TRAJECTORY FUSION HAS NOT CONVERGED (#ITER = 15 - CV = 0.4549873844053189)
WARNING: TRAJECTORY FUSION HAS NOT CONVERGED (#ITER = 15 - CV = 0.2519345099039173)
WARNING: TRAJECTORY FUSION HAS NOT CONVERGED (#ITER = 15 - CV = 0.18086662623158994)
    DTW
Sample size:  15
    FRECHET
WARNING: TRAJECTORY FUSION HAS NOT CONVERGED (#ITER = 15 - CV = 0.26074900624923786)
WARNING: TRAJECTORY FUSION HAS NOT CONVERGED (#ITER = 15 - CV = 0.23383492052503477)
WARNING: TRAJECTORY FUSION HAS NOT CONVERGED (#ITER = 15 - CV = 0.19015423586919164)
    DTW
Sample size:  16
    FRECHET
WARNING: TRAJECTORY FUSION HAS NOT CONVERGED (#ITER = 15 - CV = 0.04089818268788508)
WARNING: TRAJECTORY FUSION HAS NOT CONVERGED (#ITER = 15 - CV = 0.3901694439729381)
WARNING: TRAJECTORY FUSION HAS NOT CONVERGED (#ITER = 15 - CV = 0.7049574774604248)
    DTW
Sample size:  17
    FRECHET
WARNING: TRAJECTORY FUSION HAS NOT CONVERGED (#ITER = 15 - CV = 0.24007209057552412)
WARNING: TRAJECTORY FUSION HAS NOT CONVERGED (#ITER = 15 - CV = 0.014175845948179895)
WARNING: TRAJECTORY FUSION HAS NOT CONVERGED (#ITER = 15 - CV = 0.48649742507264815)
    DTW
Sample size:  18
    FRECHET
WARNING: TRAJECTORY FUSION HAS NOT CONVERGED (#ITER = 15 - CV = 0.3597041273396209)
WARNING: TRAJECTORY FUSION HAS NOT CONVERGED (#ITER = 15 - CV = 0.017351158341751886)
WARNING: TRAJECTORY FUSION HAS NOT CONVERGED (#ITER = 15 - CV = 0.09969327110924221)
    DTW
Sample size:  19
    FRECHET
WARNING: TRAJECTORY FUSION HAS NOT CONVERGED (#ITER = 15 - CV = 0.3561464844409972)
WARNING: TRAJECTORY FUSION HAS NOT CONVERGED (#ITER = 15 - CV = 0.27415351690020784)
WARNING: TRAJECTORY FUSION HAS NOT CONVERGED (#ITER = 15 - CV = 0.1275775865170243)
    DTW
Sample size:  20
    FRECHET
WARNING: TRAJECTORY FUSION HAS NOT CONVERGED (#ITER = 15 - CV = 0.6075859218828924)
WARNING: TRAJECTORY FUSION HAS NOT CONVERGED (#ITER = 15 - CV = 0.15868771609948992)
WARNING: TRAJECTORY FUSION HAS NOT CONVERGED (#ITER = 15 - CV = 0.3956991194035766)
    DTW
</pre></div></div>
</div>
<p>The figure presents all aggregated trajectory for <span class="math notranslate nohighlight">\(N'\)</span> = 3, 20</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">T</span> <span class="o">=</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">20</span><span class="p">]</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">top</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">wspace</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">hspace</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">T</span><span class="p">)):</span>
    <span class="k">for</span> <span class="n">s</span><span class="p">,</span> <span class="n">title</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">SHAPES</span><span class="p">):</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot2grid</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">T</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">SHAPES</span><span class="p">)),</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">s</span><span class="p">))</span>

        <span class="n">c</span> <span class="o">=</span> <span class="n">FRECHET</span><span class="p">[</span><span class="n">title</span><span class="p">][</span><span class="n">i</span><span class="p">]</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">getX</span><span class="p">(),</span> <span class="n">c</span><span class="o">.</span><span class="n">getY</span><span class="p">(),</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Fréchet&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;mediumturquoise&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">2.0</span><span class="p">)</span>
        <span class="n">c</span> <span class="o">=</span> <span class="n">DTW</span><span class="p">[</span><span class="n">title</span><span class="p">][</span><span class="n">i</span><span class="p">]</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">getX</span><span class="p">(),</span> <span class="n">c</span><span class="o">.</span><span class="n">getY</span><span class="p">(),</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;DTW&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;deeppink&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">2.0</span><span class="p">)</span>

        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">sentiers</span><span class="p">[</span><span class="n">s</span><span class="p">]</span><span class="o">.</span><span class="n">getX</span><span class="p">(),</span> <span class="n">sentiers</span><span class="p">[</span><span class="n">s</span><span class="p">]</span><span class="o">.</span><span class="n">getY</span><span class="p">(),</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;path&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;darkgrey&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
        <span class="n">title</span> <span class="o">=</span> <span class="n">title</span> <span class="o">+</span> <span class="s2">&quot;, N&#39;=&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">T</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/usecase_AggregatedTrajectory_16_0.png" src="../_images/usecase_AggregatedTrajectory_16_0.png" />
</div>
</div>
</section>
<section id="Step-4:-Evaluate-error-between-the-aggregated-and-ground-truth-track">
<h2>Step 4: Evaluate error between the aggregated and ground truth track<a class="headerlink" href="#Step-4:-Evaluate-error-between-the-aggregated-and-ground-truth-track" title="Link to this heading">#</a></h2>
<section id="Position-error-measurement">
<h3>Position error measurement<a class="headerlink" href="#Position-error-measurement" title="Link to this heading">#</a></h3>
<p>We compute the distance <span class="math notranslate nohighlight">\(pointwise L_2\)</span> (<em>Root Mean Square Error</em>) by finely resampling both the aggregated and ground truth trajectories from 120 to 1,000 points, ensuring one point every 30 cm over 300 meters.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">rmse</span><span class="p">(</span><span class="n">central</span><span class="p">,</span> <span class="n">sentier</span><span class="p">):</span>
    <span class="n">central</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="n">npts</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">sentier</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="n">npts</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">m</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">sentier</span><span class="o">.</span><span class="n">size</span><span class="p">(),</span> <span class="n">central</span><span class="o">.</span><span class="n">size</span><span class="p">())</span>

    <span class="c1"># compute the distance NearestNeighbour</span>
    <span class="k">return</span> <span class="n">tkl</span><span class="o">.</span><span class="n">compare</span><span class="p">(</span><span class="n">central</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">m</span><span class="p">],</span> <span class="n">sentier</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">m</span><span class="p">],</span> <span class="n">tkl</span><span class="o">.</span><span class="n">MODE_COMPARISON_POINTWISE</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

<span class="n">TSS</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">T1F</span><span class="o">=</span><span class="p">[];</span> <span class="n">T2F</span><span class="o">=</span><span class="p">[];</span> <span class="n">T3F</span><span class="o">=</span><span class="p">[]</span>
<span class="n">T1D</span><span class="o">=</span><span class="p">[];</span> <span class="n">T2D</span><span class="o">=</span><span class="p">[];</span> <span class="n">T3D</span><span class="o">=</span><span class="p">[]</span>
<span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">E</span><span class="p">):</span>
    <span class="n">TSS</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">s</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">T1F</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rmse</span><span class="p">(</span><span class="n">FRECHET</span><span class="p">[</span><span class="s1">&#39;Almost straight&#39;</span><span class="p">][</span><span class="n">s</span><span class="p">],</span> <span class="n">sentier1</span><span class="p">))</span>
    <span class="n">T2F</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rmse</span><span class="p">(</span><span class="n">FRECHET</span><span class="p">[</span><span class="s1">&#39;Moderate sinuosity&#39;</span><span class="p">][</span><span class="n">s</span><span class="p">],</span> <span class="n">sentier2</span><span class="p">))</span>
    <span class="n">T3F</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rmse</span><span class="p">(</span><span class="n">FRECHET</span><span class="p">[</span><span class="s1">&#39;Switchbacks&#39;</span><span class="p">][</span><span class="n">s</span><span class="p">],</span> <span class="n">sentier3</span><span class="p">))</span>
    <span class="n">T1D</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rmse</span><span class="p">(</span><span class="n">DTW</span><span class="p">[</span><span class="s1">&#39;Almost straight&#39;</span><span class="p">][</span><span class="n">s</span><span class="p">],</span> <span class="n">sentier1</span><span class="p">))</span>
    <span class="n">T2D</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rmse</span><span class="p">(</span><span class="n">DTW</span><span class="p">[</span><span class="s1">&#39;Moderate sinuosity&#39;</span><span class="p">][</span><span class="n">s</span><span class="p">],</span> <span class="n">sentier2</span><span class="p">))</span>
    <span class="n">T3D</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rmse</span><span class="p">(</span><span class="n">DTW</span><span class="p">[</span><span class="s1">&#39;Switchbacks&#39;</span><span class="p">][</span><span class="n">s</span><span class="p">],</span> <span class="n">sentier3</span><span class="p">))</span>


<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">top</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">wspace</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">hspace</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>

<span class="n">ax1</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot2grid</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">TSS</span><span class="p">,</span> <span class="n">T1D</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Fréchet&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;mediumturquoise&quot;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">TSS</span><span class="p">,</span> <span class="n">T1F</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;DTW&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;deeppink&quot;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;sample size&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;RMSE&quot;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Almost straight&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="n">ax2</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot2grid</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">TSS</span><span class="p">,</span> <span class="n">T2D</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Fréchet&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;mediumturquoise&quot;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">TSS</span><span class="p">,</span> <span class="n">T2F</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;DTW&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;deeppink&quot;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;sample size&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;RMSE&quot;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Moderate sinuosity&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="n">ax3</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot2grid</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">TSS</span><span class="p">,</span> <span class="n">T3D</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Fréchet&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;mediumturquoise&quot;</span><span class="p">)</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">TSS</span><span class="p">,</span> <span class="n">T3F</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;DTW&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;deeppink&quot;</span><span class="p">)</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;sample size&#39;</span><span class="p">)</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;RMSE&quot;</span><span class="p">)</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Switchbacks&#39;</span><span class="p">)</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/usecase_AggregatedTrajectory_19_0.png" src="../_images/usecase_AggregatedTrajectory_19_0.png" />
</div>
</div>
</section>
<section id="Shape-deviation-measurement">
<h3>Shape deviation measurement<a class="headerlink" href="#Shape-deviation-measurement" title="Link to this heading">#</a></h3>
<p>Let’s start by aligning the aggregated track with the reference track to abstract away from position issues. Then, we finely resample both the aggregated and ground truth trajectories from 120 to 1,000 points, ensuring one point every 30 cm over 300 meters. Finally, we compute the distance <em>NearestNeighbour</em> for all positions to estimate shape deviation.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">shapeDeviationMeasure</span><span class="p">(</span><span class="n">central</span><span class="p">,</span> <span class="n">sentier</span><span class="p">):</span>
    <span class="c1"># Align the aggregated track with the reference track</span>
    <span class="n">tkl</span><span class="o">.</span><span class="n">mapping</span><span class="o">.</span><span class="n">mapOn</span><span class="p">(</span><span class="n">central</span><span class="p">,</span> <span class="n">sentier</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="c1"># resample to 1000 points</span>
    <span class="n">central</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="n">npts</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">sentier</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="n">npts</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

    <span class="c1"># compute the distance NearestNeighbour</span>
    <span class="k">return</span> <span class="n">tkl</span><span class="o">.</span><span class="n">compare</span><span class="p">(</span><span class="n">central</span><span class="p">,</span> <span class="n">sentier</span><span class="p">,</span> <span class="n">tkl</span><span class="o">.</span><span class="n">MODE_COMPARISON_NN</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>


<span class="n">TSS</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">T1F</span><span class="o">=</span><span class="p">[];</span> <span class="n">T2F</span><span class="o">=</span><span class="p">[];</span> <span class="n">T3F</span><span class="o">=</span><span class="p">[]</span>
<span class="n">T1D</span><span class="o">=</span><span class="p">[];</span> <span class="n">T2D</span><span class="o">=</span><span class="p">[];</span> <span class="n">T3D</span><span class="o">=</span><span class="p">[]</span>
<span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">E</span><span class="p">):</span>
    <span class="n">TSS</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">s</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">T1F</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">shapeDeviationMeasure</span><span class="p">(</span><span class="n">FRECHET</span><span class="p">[</span><span class="s1">&#39;Almost straight&#39;</span><span class="p">][</span><span class="n">s</span><span class="p">],</span> <span class="n">sentier1</span><span class="p">))</span>
    <span class="n">T2F</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">shapeDeviationMeasure</span><span class="p">(</span><span class="n">FRECHET</span><span class="p">[</span><span class="s1">&#39;Moderate sinuosity&#39;</span><span class="p">][</span><span class="n">s</span><span class="p">],</span> <span class="n">sentier2</span><span class="p">))</span>
    <span class="n">T3F</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">shapeDeviationMeasure</span><span class="p">(</span><span class="n">FRECHET</span><span class="p">[</span><span class="s1">&#39;Switchbacks&#39;</span><span class="p">][</span><span class="n">s</span><span class="p">],</span> <span class="n">sentier3</span><span class="p">))</span>
    <span class="n">T1D</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">shapeDeviationMeasure</span><span class="p">(</span><span class="n">DTW</span><span class="p">[</span><span class="s1">&#39;Almost straight&#39;</span><span class="p">][</span><span class="n">s</span><span class="p">],</span> <span class="n">sentier1</span><span class="p">))</span>
    <span class="n">T2D</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">shapeDeviationMeasure</span><span class="p">(</span><span class="n">DTW</span><span class="p">[</span><span class="s1">&#39;Moderate sinuosity&#39;</span><span class="p">][</span><span class="n">s</span><span class="p">],</span> <span class="n">sentier2</span><span class="p">))</span>
    <span class="n">T3D</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">shapeDeviationMeasure</span><span class="p">(</span><span class="n">DTW</span><span class="p">[</span><span class="s1">&#39;Switchbacks&#39;</span><span class="p">][</span><span class="n">s</span><span class="p">],</span> <span class="n">sentier3</span><span class="p">))</span>


<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">top</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">wspace</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">hspace</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>

<span class="n">ax1</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot2grid</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">TSS</span><span class="p">,</span> <span class="n">T1D</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Fréchet&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;mediumturquoise&quot;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">TSS</span><span class="p">,</span> <span class="n">T1F</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;DTW&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;deeppink&quot;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;sample size&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Nearest Neighbor distance (m)&quot;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Almost straight&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="n">ax2</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot2grid</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">TSS</span><span class="p">,</span> <span class="n">T2D</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Fréchet&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;mediumturquoise&quot;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">TSS</span><span class="p">,</span> <span class="n">T2F</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;DTW&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;deeppink&quot;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;sample size&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Nearest Neighbor distance (m)&quot;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Moderate sinuosity&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="n">ax3</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot2grid</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">TSS</span><span class="p">,</span> <span class="n">T3D</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Fréchet&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;mediumturquoise&quot;</span><span class="p">)</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">TSS</span><span class="p">,</span> <span class="n">T3F</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;DTW&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;deeppink&quot;</span><span class="p">)</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;sample size&#39;</span><span class="p">)</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Nearest Neighbor distance (m)&quot;</span><span class="p">)</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Switchbacks&#39;</span><span class="p">)</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/usecase_AggregatedTrajectory_21_0.png" src="../_images/usecase_AggregatedTrajectory_21_0.png" />
</div>
</div>
</section>
</section>
<section id="To-add-to-the-gallery">
<h2>To add to the gallery<a class="headerlink" href="#To-add-to-the-gallery" title="Link to this heading">#</a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[25]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">color</span> <span class="o">=</span> <span class="n">cm</span><span class="o">.</span><span class="n">rainbow</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">50</span><span class="p">))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">15</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">top</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">wspace</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">hspace</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>

<span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot2grid</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">sentier1</span><span class="o">.</span><span class="n">getX</span><span class="p">(),</span> <span class="n">sentier1</span><span class="o">.</span><span class="n">getY</span><span class="p">(),</span> <span class="s1">&#39;c-&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Almost straight - raw data&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">);</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>

<span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot2grid</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">sentier2</span><span class="o">.</span><span class="n">getX</span><span class="p">(),</span> <span class="n">sentier2</span><span class="o">.</span><span class="n">getY</span><span class="p">(),</span> <span class="s1">&#39;c-&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Moderate sinuosity - raw data&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>

<span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot2grid</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">sentier3</span><span class="o">.</span><span class="n">getX</span><span class="p">(),</span> <span class="n">sentier3</span><span class="o">.</span><span class="n">getY</span><span class="p">(),</span> <span class="s1">&#39;c-&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Switchbacks - raw data&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>

<span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot2grid</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">sentier1</span><span class="o">.</span><span class="n">getX</span><span class="p">(),</span> <span class="n">sentier1</span><span class="o">.</span><span class="n">getY</span><span class="p">(),</span> <span class="s1">&#39;c-&#39;</span><span class="p">)</span>
<span class="k">for</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">tracks1</span><span class="p">):</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">getX</span><span class="p">(),</span> <span class="n">t</span><span class="o">.</span><span class="n">getY</span><span class="p">(),</span> <span class="n">c</span><span class="o">=</span><span class="n">color</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    <span class="k">if</span> <span class="n">i</span> <span class="o">&gt;</span> <span class="mi">5</span><span class="p">:</span>
        <span class="k">break</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Almost straight - realistic traks&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>

<span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot2grid</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">sentier2</span><span class="o">.</span><span class="n">getX</span><span class="p">(),</span> <span class="n">sentier2</span><span class="o">.</span><span class="n">getY</span><span class="p">(),</span> <span class="s1">&#39;c-&#39;</span><span class="p">)</span>
<span class="k">for</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">tracks2</span><span class="p">):</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">getX</span><span class="p">(),</span> <span class="n">t</span><span class="o">.</span><span class="n">getY</span><span class="p">(),</span> <span class="n">c</span><span class="o">=</span><span class="n">color</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    <span class="k">if</span> <span class="n">i</span> <span class="o">&gt;</span> <span class="mi">5</span><span class="p">:</span>
        <span class="k">break</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Moderate sinuosity - realistic traks&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>

<span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot2grid</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">sentier3</span><span class="o">.</span><span class="n">getX</span><span class="p">(),</span> <span class="n">sentier3</span><span class="o">.</span><span class="n">getY</span><span class="p">(),</span> <span class="s1">&#39;c-&#39;</span><span class="p">)</span>
<span class="k">for</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">tracks3</span><span class="p">):</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">getX</span><span class="p">(),</span> <span class="n">t</span><span class="o">.</span><span class="n">getY</span><span class="p">(),</span> <span class="n">c</span><span class="o">=</span><span class="n">color</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    <span class="k">if</span> <span class="n">i</span> <span class="o">&gt;</span> <span class="mi">5</span><span class="p">:</span>
        <span class="k">break</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Switchbacks - realistic traks&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>

<span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot2grid</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span>
<span class="n">c</span> <span class="o">=</span> <span class="n">FRECHET</span><span class="p">[</span><span class="s1">&#39;Almost straight&#39;</span><span class="p">][</span><span class="mi">10</span><span class="p">]</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">getX</span><span class="p">(),</span> <span class="n">c</span><span class="o">.</span><span class="n">getY</span><span class="p">(),</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Fréchet&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;tab:red&quot;</span><span class="p">)</span>
<span class="n">c</span> <span class="o">=</span> <span class="n">DTW</span><span class="p">[</span><span class="s1">&#39;Almost straight&#39;</span><span class="p">][</span><span class="mi">10</span><span class="p">]</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">getX</span><span class="p">(),</span> <span class="n">c</span><span class="o">.</span><span class="n">getY</span><span class="p">(),</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;DTW&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;tab:blue&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">sentier1</span><span class="o">.</span><span class="n">getX</span><span class="p">(),</span> <span class="n">sentier1</span><span class="o">.</span><span class="n">getY</span><span class="p">(),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;darkgrey&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;path&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;Almost straight, aggregated track 10&quot;</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>

<span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot2grid</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
<span class="n">c</span> <span class="o">=</span> <span class="n">FRECHET</span><span class="p">[</span><span class="s1">&#39;Moderate sinuosity&#39;</span><span class="p">][</span><span class="mi">10</span><span class="p">]</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">getX</span><span class="p">(),</span> <span class="n">c</span><span class="o">.</span><span class="n">getY</span><span class="p">(),</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Fréchet&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;tab:red&quot;</span><span class="p">)</span>
<span class="n">c</span> <span class="o">=</span> <span class="n">DTW</span><span class="p">[</span><span class="s1">&#39;Moderate sinuosity&#39;</span><span class="p">][</span><span class="mi">10</span><span class="p">]</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">getX</span><span class="p">(),</span> <span class="n">c</span><span class="o">.</span><span class="n">getY</span><span class="p">(),</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;DTW&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;tab:blue&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">sentier2</span><span class="o">.</span><span class="n">getX</span><span class="p">(),</span> <span class="n">sentier2</span><span class="o">.</span><span class="n">getY</span><span class="p">(),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;darkgrey&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;path&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;Moderate sinuosity, aggregated track 10&quot;</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>

<span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot2grid</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
<span class="n">c</span> <span class="o">=</span> <span class="n">FRECHET</span><span class="p">[</span><span class="s1">&#39;Switchbacks&#39;</span><span class="p">][</span><span class="mi">10</span><span class="p">]</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">getX</span><span class="p">(),</span> <span class="n">c</span><span class="o">.</span><span class="n">getY</span><span class="p">(),</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Fréchet&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;tab:red&quot;</span><span class="p">)</span>
<span class="n">c</span> <span class="o">=</span> <span class="n">DTW</span><span class="p">[</span><span class="s1">&#39;Switchbacks&#39;</span><span class="p">][</span><span class="mi">10</span><span class="p">]</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">getX</span><span class="p">(),</span> <span class="n">c</span><span class="o">.</span><span class="n">getY</span><span class="p">(),</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;DTW&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;tab:blue&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">sentier3</span><span class="o">.</span><span class="n">getX</span><span class="p">(),</span> <span class="n">sentier3</span><span class="o">.</span><span class="n">getY</span><span class="p">(),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;darkgrey&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;path&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;Switchbacks, aggregated track 10&quot;</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/usecase_AggregatedTrajectory_23_0.png" src="../_images/usecase_AggregatedTrajectory_23_0.png" />
</div>
</div>
</section>
</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="StopPoints.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Different stops detection methods</p>
      </div>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#As-usual,-let’s-start-by-defining-our-environment">As usual, let’s start by defining our environment</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Step-1:-Create-reference-tracks">Step 1: Create reference tracks</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Step-2:-Create-sets-of-simulated-GNSS-trajectories">Step 2: Create sets of simulated GNSS trajectories</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Step-3:-Compute-aggregated-trajectory">Step 3: Compute aggregated trajectory</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Step-4:-Evaluate-error-between-the-aggregated-and-ground-truth-track">Step 4: Evaluate error between the aggregated and ground truth track</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#Position-error-measurement">Position error measurement</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#Shape-deviation-measurement">Shape deviation measurement</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#To-add-to-the-gallery">To add to the gallery</a></li>
</ul>
  </nav></div>

  <div class="sidebar-secondary-item">

  <div class="tocsection sourcelink">
    <a href="../_sources/usecase/AggregatedTrajectory.ipynb.txt">
      <i class="fa-solid fa-file-lines"></i> Show Source
    </a>
  </div>
</div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=3ee479438cf8b5e0d341"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=3ee479438cf8b5e0d341"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      © Copyright 2024, LASTIG lab, French National Institute of Geographic and Forest Information.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 7.3.7.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.15.3.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>