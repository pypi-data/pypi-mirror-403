Metadata-Version: 2.4
Name: tsqueue
Version: 0.3.0
Summary: Thread-safe queue ultra simple pour Python
Author: Nytrox
License: MIT
Project-URL: Homepage, https://github.com/Nytrox-d3v/tsqueue
Keywords: thread-safe,queue,python,tsqueue
Classifier: Programming Language :: Python :: 3
Classifier: License :: OSI Approved :: MIT License
Classifier: Operating System :: OS Independent
Requires-Python: >=3.9
Description-Content-Type: text/markdown
License-File: LICENSE
Dynamic: license-file

# TSQueue

<div align="center">

![PyPI - Version](https://img.shields.io/pypi/v/tsqueue?style=for-the-badge&logo=pypi&logoColor=white)
![PyPI - Python Version](https://img.shields.io/pypi/pyversions/tsqueue?style=for-the-badge&logo=python&logoColor=white)
![PyPI - License](https://img.shields.io/pypi/l/tsqueue?style=for-the-badge)
![PyPI - Downloads](https://img.shields.io/pypi/dm/tsqueue?style=for-the-badge&logo=pypi&logoColor=white)

**Une collection de queues thread-safe ultra simples mais puissantes pour Python**

[Installation](#installation) ‚Ä¢
[Queues Disponibles](#-queues-disponibles) ‚Ä¢
[Exemples](#-exemples) ‚Ä¢
[API](#-api-compl√®te) ‚Ä¢
[Contribuer](#-contribuer)

</div>

---

## üéØ Pourquoi TSQueue ?

TSQueue est une biblioth√®que de queues thread-safe con√ßue pour √™tre **simple √† utiliser** mais **incroyablement puissante**. Que tu aies besoin d'une queue basique, asynchrone, persistante ou avec priorit√©s, TSQueue a ce qu'il te faut.

### ‚ú® Caract√©ristiques

- üîí **Thread-safe par d√©faut** - Aucune gestion manuelle des locks
- ü™∂ **Ultra l√©ger** - Z√©ro d√©pendance externe
- üöÄ **4 types de queues** - Choisir celle qui correspond √† tes besoins
- üìû **Syst√®me de callbacks** - R√©agir aux √©v√©nements de la queue
- üíæ **Persistance** - Sauvegarder et charger tes queues
- ‚ö° **Support asyncio** - Pour les applications asynchrones
- üéØ **Priorit√©s** - G√©rer l'ordre de traitement
- üîÑ **It√©rateurs** - Parcourir facilement les queues

---

## üì¶ Installation

```bash
pip install tsqueue
```

**Pr√©requis:** Python ‚â• 3.9

---

## üóÇÔ∏è Queues Disponibles

### 1. **TSQueue** - La Queue Classique üîµ
Queue thread-safe de base avec callbacks et m√©thodes utiles.

```python
from tsqueue import TSQueue

q = TSQueue()
q.push("hello")
print(q.pop())  # "hello"
```

### 2. **AsyncQueue** - Pour Asyncio ‚ö°
Queue asynchrone parfaite pour les applications async/await.

```python
from tsqueue import AsyncQueue
import asyncio

async def main():
    q = AsyncQueue()
    await q.push("async hello")
    print(await q.pop())

asyncio.run(main())
```

### 3. **PersistentQueue** - Sauvegarde Automatique üíæ
Queue qui persiste sur disque (JSON ou Pickle).

```python
from tsqueue import PersistentQueue

# Sauvegarde automatique
q = PersistentQueue("data.json", auto_save=True)
q.push({"user": "Alice", "score": 100})
# Automatiquement sauvegard√© dans data.json !
```

### 4. **PriorityQueue** - Gestion des Priorit√©s üéØ
Queue avec syst√®me de priorit√©s (plus petit = plus prioritaire).

```python
from tsqueue import PriorityQueue

q = PriorityQueue()
q.push("normal", priority=5)
q.push("urgent!", priority=1)
q.push("basse", priority=10)

print(q.pop())  # "urgent!" (priorit√© 1)
```

---

## üöÄ Exemples

### Exemple 1: Callbacks sur TSQueue

```python
from tsqueue import TSQueue

def on_item_added(item):
    print(f"‚úÖ Nouvel item: {item}")

q = TSQueue()
q.on_push(on_item_added)

q.push("Hello")    # Affiche: ‚úÖ Nouvel item: Hello
q.push("World")    # Affiche: ‚úÖ Nouvel item: World
```

### Exemple 2: AsyncQueue avec Callbacks Async

```python
from tsqueue import AsyncQueue
import asyncio

async def log_async(item):
    await asyncio.sleep(0.1)  # Traitement async
    print(f"üì¶ Trait√©: {item}")

async def main():
    q = AsyncQueue()
    q.on_push(log_async)
    
    await q.push("Task 1")
    await q.push("Task 2")
    
    # It√©rateur asynchrone
    async for item in q:
        print(f"R√©cup√©r√©: {item}")

asyncio.run(main())
```

### Exemple 3: PersistentQueue - Reprendre apr√®s un Crash

```python
from tsqueue import PersistentQueue

# Premier run
q = PersistentQueue("tasks.json", format="json")
q.push({"task": "finish_project", "priority": "high"})
q.push({"task": "write_tests", "priority": "medium"})
q.save()

# Apr√®s red√©marrage de l'app...
q2 = PersistentQueue("tasks.json")
# La queue est automatiquement recharg√©e !
print(q2.pop())  # {"task": "finish_project", ...}
```

### Exemple 4: PriorityQueue - System de T√¢ches

```python
from tsqueue import PriorityQueue
import threading

def worker(q):
    while True:
        try:
            task, priority = q.pop_with_priority(timeout=1.0)
            print(f"üî® Traitement (priorit√© {priority}): {task}")
        except:
            break

q = PriorityQueue()

# Ajouter des t√¢ches avec diff√©rentes priorit√©s
q.push("Email marketing", priority=10)
q.push("Bug critique production", priority=1)
q.push("Mise √† jour docs", priority=5)
q.push("Security patch", priority=2)

# Les workers traiteront dans l'ordre: bug critique, security, docs, email
threads = [threading.Thread(target=worker, args=(q,)) for _ in range(2)]
for t in threads:
    t.start()
for t in threads:
    t.join()
```

### Exemple 5: Peek et It√©ration

```python
from tsqueue import TSQueue

q = TSQueue()
q.push(1)
q.push(2)
q.push(3)

# Regarder sans retirer
print(q.peek())  # 1
print(q.size())  # 3 (toujours l√†)

# It√©ration (consomme la queue)
for item in q:
    print(item)  # 1, 2, 3

print(q.empty())  # True
```

### Exemple 6: Context Manager avec PersistentQueue

```python
from tsqueue import PersistentQueue

# Sauvegarde automatique √† la sortie
with PersistentQueue("data.pkl", format="pickle") as q:
    q.push({"data": "important"})
    q.push([1, 2, 3, 4])
    # Automatiquement sauvegard√© en sortant du with !
```

---

## üìñ API Compl√®te

### TSQueue

#### M√©thodes de Base
- `push(item)` - Ajoute un √©l√©ment
- `pop(block=True, timeout=None)` - R√©cup√®re un √©l√©ment
- `peek(block=True, timeout=None)` - Regarde sans retirer
- `empty()` - V√©rifie si vide
- `size()` - Nombre d'√©l√©ments
- `clear()` - Vide la queue

#### Callbacks
- `on_push(callback)` - Enregistre un callback
- `remove_callback(callback)` - Retire un callback
- `clear_callbacks()` - Retire tous les callbacks

#### Magic Methods
- `__iter__()` - Support de l'it√©ration
- `__len__()` - Support de `len(q)`
- `__bool__()` - Support de `if q:`

### AsyncQueue

M√™mes m√©thodes que TSQueue mais en async:
- `await push(item)`
- `await pop(timeout=None)`
- `await peek()`
- `await clear()`
- `async for item in queue:` - It√©ration async

### PersistentQueue

H√©rite de TSQueue + m√©thodes de persistance:
- `__init__(filepath, maxsize=0, format="json", auto_save=False, auto_save_interval=10)`
- `save()` - Sauvegarde manuelle
- `load()` - Charge depuis le fichier
- `delete_file()` - Supprime le fichier de sauvegarde

**Formats support√©s:** `"json"` ou `"pickle"`

### PriorityQueue

- `push(item, priority=5)` - Ajoute avec priorit√©
- `pop()` - R√©cup√®re l'item le plus prioritaire
- `pop_with_priority()` - R√©cup√®re `(item, priority)`
- `peek_with_priority()` - Regarde avec priorit√©
- Callbacks re√ßoivent `(item, priority)`

---

## üß™ Tests

Pour tester localement:

```bash
python test.py
```

---

## ü§ù Contribuer

Les contributions sont les bienvenues ! N'h√©site pas √†:

1. Fork le projet
2. Cr√©er une branche (`git checkout -b feature/amelioration`)
3. Commit tes changements (`git commit -m 'Ajout fonctionnalit√©'`)
4. Push sur la branche (`git push origin feature/amelioration`)
5. Ouvrir une Pull Request

---

## üìù Changelog

### v0.3.0
- ‚ú® Ajout de `AsyncQueue` pour asyncio
- ‚ú® Ajout de `PersistentQueue` avec sauvegarde JSON/Pickle
- ‚ú® Ajout de `PriorityQueue` avec syst√®me de priorit√©s
- üéØ Syst√®me de callbacks pour toutes les queues
- üîÑ Support des it√©rateurs
- üìö Documentation compl√®te avec exemples

### v0.2.0
- Am√©lioration de la documentation
- Ajout d'exemples d'utilisation

### v0.1.0
- Version initiale
- Fonctionnalit√©s de base: push, pop, empty, size

---

## üí° Cas d'Usage

### Web Scraping
```python
q = PersistentQueue("urls.json", auto_save=True)
# Continue le scraping m√™me apr√®s un crash
```

### Task Queue avec Priorit√©s
```python
q = PriorityQueue()
q.push("critical_bug", priority=1)
q.push("feature_request", priority=10)
```

### Async Workers
```python
queue = AsyncQueue()
# Parfait pour FastAPI, aiohttp, etc.
```

### Event Processing
```python
q = TSQueue()
q.on_push(lambda event: logging.info(f"Event: {event}"))
```

---

## üìÑ Licence

Ce projet est sous licence MIT - voir le fichier [LICENSE](LICENSE) pour plus de d√©tails.

---

## üîó Liens

- **GitHub**: [Nytrox-d3v/tsqueue](https://github.com/Nytrox-d3v/tsqueue)
- **PyPI**: [pypi.org/project/tsqueue](https://pypi.org/project/tsqueue/)
- **Issues**: [GitHub Issues](https://github.com/Nytrox-d3v/tsqueue/issues)
- **Documentation**: [Voir README](https://github.com/Nytrox-d3v/tsqueue#readme)

---

<div align="center">

Fait avec ‚ù§Ô∏è par [Nytrox](https://github.com/Nytrox-d3v)

‚≠ê **N'oublie pas de star le repo si tu trouves ce projet utile !** ‚≠ê

</div>
