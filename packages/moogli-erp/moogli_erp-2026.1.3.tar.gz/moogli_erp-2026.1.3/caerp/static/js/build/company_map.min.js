(()=>{"use strict";var e,t,n,r={7040:(e,t,n)=>{var r=n(750),a=n(5458),o=n(641),i=n(953),l=n(33),u=n(136),c=n(296),s=n(467),p=n(4756),f=n.n(p),d=(n(2696),n(6935)),v=n.n(d),m=n(7659),h=n.n(m);const b=n.p+"5a6cdb62371f4bc880e3e24e76589b1f.css";var _={};_.insert=h().bind(null,"head"),v()(b,_);var g=n(3481),y=n.n(g),k=n(8061),C=n(6902),F=n(5979),A=n(5467),R=n(4365),w=n(7546),E={key:0};const L={__name:"TextWithBr",props:{text:{type:String,required:!0}},setup:function(e){var t=e,n=(0,o.EW)(function(){return t.text.split("\n")});return function(e,t){return(0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(n.value,function(e,t,r){return(0,o.uX)(),(0,o.CE)(o.FK,null,[(0,o.eW)((0,l.v_)(e)+" ",1),r<n.value.length?((0,o.uX)(),(0,o.CE)("br",E)):(0,o.Q3)("v-if",!0)],64)}),256)}}};var x={key:0},S={style:{width:"100%",height:"70vh"},class:"toggle"},O={key:0},X={class:"contacts"},j={key:0},P=["href"],T={key:1},W={key:0},I={key:1},K={class:"contacts"},q={key:0},U=["href"],Q={key:1},B=["href"],M={key:2},N=["href"],$={class:"users"},D={key:0,class:"user_avatar photo"},G=["src","alt"],Y={key:1,class:"user_avatar"};const z={__name:"CompanyMap",props:{companiesUrl:{type:String,required:!0},extraPlacesUrl:{type:String,required:!0}},setup:function(e){return(0,s.A)(f().mark(function t(){var n,r,a,u,p,d,v,m,h,b,_,g,E,z,H;return f().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return v=(0,i.KR)(!0),m=(0,i.KR)({}),h=(0,i.KR)(new(y().Bounds)),b=(0,A.i)(),_=(0,i.KR)(),g=(0,i.KR)(),E=(0,i.KR)(),z=e,H=function(e){var t=e.getBounds();h.value.isValid()?h.value.extend(t):h.value=t},n=(0,o.E)(function(){return b.loadConst("config")}),r=(0,c.A)(n,2),p=r[0],d=r[1],t.next=1,p;case 1:return p=t.sent,d(),m.value=p,a=(0,o.E)(function(){return Promise.allSettled([R.A.get(z.companiesUrl),R.A.get(z.extraPlacesUrl)]).then(function(e){var t=(0,c.A)(e,2),n=t[0],r=t[1];"fulfilled"==n.status&&n.value&&(_.value=n.value),"fulfilled"==r.status&&r.value&&(g.value=r.value),v.value=!1})}),u=(0,c.A)(a,2),p=u[0],d=u[1],t.next=2,p;case 2:return d(),(0,o.nT)((0,s.A)(f().mark(function e(){return f().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=1,R.A.get(z.companiesUrl);case 1:_.value=e.sent;case 2:case"end":return e.stop()}},e)}))),t.abrupt("return",function(e,t){return(0,o.uX)(),(0,o.CE)(o.FK,null,[v.value?((0,o.uX)(),(0,o.CE)("div",x,"Chargement…")):(0,o.Q3)("v-if",!0),(0,o.Lk)("div",S,[(0,o.bF)((0,i.R1)(k.Do),{ref:"map",center:[47.21297,-1.55104],zoom:18,bounds:h.value},{default:(0,o.k6)(function(){return[(0,o.bF)((0,i.R1)(k.qh),{position:"topright",collapsed:!1}),(0,o.bF)((0,i.R1)(k.a),{url:m.value.leaflet_layer_url,attribution:'© Contributeur·ices <a target="_blank" href="http://osm.org/copyright">OpenStreetMap</a>'},null,8,["url"]),(0,o.bF)((0,i.R1)(k.qR),{name:"Lieux ressources",key:"places","layer-type":"overlay",onReady:H},{default:(0,o.k6)(function(){return[g.value?((0,o.uX)(!0),(0,o.CE)(o.FK,{key:0},(0,o.pI)(g.value.features,function(e){return(0,o.uX)(),(0,o.Wv)((0,i.R1)(k.li),{"lat-lng":(0,i.R1)(y()).GeoJSON.coordsToLatLng(e.geometry.coordinates)},{default:(0,o.k6)(function(){return[(0,o.bF)((0,i.R1)(k.up),null,{default:(0,o.k6)(function(){return[(0,o.bF)(F.A,{name:"location-star","css-class":"map_location favourite",alt:e.properties.name},null,8,["alt"])]}),_:2},1024),(0,o.bF)((0,i.R1)(k.nA),null,{default:(0,o.k6)(function(){return[(0,o.Lk)("div",null,[(0,o.Lk)("p",null,[(0,o.Lk)("strong",null,(0,l.v_)(e.properties.name),1)]),e.properties.description?((0,o.uX)(),(0,o.CE)("p",O,[(0,o.bF)(L,{text:e.properties.description},null,8,["text"])])):(0,o.Q3)("v-if",!0),(0,o.Lk)("ul",X,[e.properties.website?((0,o.uX)(),(0,o.CE)("li",j,[(0,o.Lk)("a",{href:e.properties.website},[(0,o.bF)(F.A,{name:"globe",alt:"Site web",title:"Site web"}),(0,o.eW)(" "+(0,l.v_)(e.properties.website),1)],8,P)])):(0,o.Q3)("v-if",!0),e.properties.contact?((0,o.uX)(),(0,o.CE)("li",T,[(0,o.bF)(F.A,{name:"user",alt:""}),(0,o.eW)(" Contact : "+(0,l.v_)(e.properties.contact),1)])):(0,o.Q3)("v-if",!0)])])]}),_:2},1024)]}),_:2},1032,["lat-lng"])}),256)):(0,o.Q3)("v-if",!0)]}),_:1}),(0,o.bF)((0,i.R1)(C._),{name:"Enseignes et entrepreneur·euses",key:"companies","layer-type":"overlay",onReady:H},{default:(0,o.k6)(function(){return[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(_.value.features,function(e){return(0,o.uX)(),(0,o.Wv)((0,i.R1)(k.li),{"lat-lng":(0,i.R1)(y()).GeoJSON.coordsToLatLng(e.geometry.coordinates),onPopupopen:function(t){return E.value=e.properties.id}},{default:(0,o.k6)(function(){return[(0,o.bF)((0,i.R1)(k.up),null,{default:(0,o.k6)(function(){return[(0,o.bF)(F.A,{name:"location-dot","css-class":"map_location",alt:e.properties.name},null,8,["alt"])]}),_:2},1024),(0,o.bF)((0,i.R1)(k.nA),null,{default:(0,o.k6)(function(){return[(0,o.Lk)("div",null,[(0,o.Lk)("p",null,[(0,o.Lk)("strong",null,(0,l.v_)(e.properties.name),1)]),e.properties.goal?((0,o.uX)(),(0,o.CE)("p",W,[(0,o.Lk)("em",null,(0,l.v_)(e.properties.goal),1)])):(0,o.Q3)("v-if",!0),e.properties.activities_labels.length>0?((0,o.uX)(),(0,o.CE)("p",I,(0,l.v_)(e.properties.activities_labels.join(", ")),1)):(0,o.Q3)("v-if",!0),(0,o.Lk)("ul",K,[e.properties.phone?((0,o.uX)(),(0,o.CE)("li",q,[(0,o.Lk)("a",{href:"tel:".concat(e.properties.phone)},[(0,o.bF)(F.A,{name:"phone",alt:"Téléphone",title:"Téléphone"}),(0,o.eW)(" "+(0,l.v_)(e.properties.phone),1)],8,U)])):(0,o.Q3)("v-if",!0),e.properties.mobile?((0,o.uX)(),(0,o.CE)("li",Q,[(0,o.Lk)("a",{href:"tel:".concat(e.properties.mobile)},[(0,o.bF)(F.A,{name:"mobile-alt",title:"Téléphone portable",alt:"Téléphone portable"}),(0,o.eW)(" "+(0,l.v_)(e.properties.mobile),1)],8,B)])):(0,o.Q3)("v-if",!0),e.properties.email?((0,o.uX)(),(0,o.CE)("li",M,[(0,o.Lk)("a",{href:"mailto:".concat(e.properties.email)},[(0,o.bF)(F.A,{name:"envelope",title:"E-mail",alt:"E-mail"}),(0,o.eW)(" "+(0,l.v_)(e.properties.email),1)],8,N)])):(0,o.Q3)("v-if",!0)]),(0,o.Lk)("ul",$,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(e.properties.users_gallery,function(t){return(0,o.uX)(),(0,o.CE)("li",null,[(0,o.Q3)("\n                         Renders only if the API gives us a logo\n                         + lazy-loading of logos to avoid mass-loading them on page startup.\n                    "),t.logo_url&&E.value===e.properties.id?((0,o.uX)(),(0,o.CE)("span",D,[(0,o.Lk)("img",{src:t.logo_url,alt:t.fullname,width:"48",height:"48"},null,8,G)])):((0,o.uX)(),(0,o.CE)("span",Y,[(0,o.bF)(w.A,{name:"user"})])),(0,o.Lk)("span",null,(0,l.v_)(t.fullname),1)])}),256))])])]}),_:2},1024)]}),_:2},1032,["lat-lng","onPopupopen"])}),256))]}),_:1})]}),_:1},8,["bounds"])])],64)});case 3:case"end":return t.stop()}},t)}))()}};var H={class:"nav nav-tabs",role:"tablist"},J={class:"tab-content content"},V={id:"list-container",class:"tab-pane fade in active",role:"tabpanel"},Z=["href"];const ee={__name:"TabHeader",props:{href:{type:String,default:"#"},active:{type:Boolean,default:!1}},setup:function(e){return function(t,n){return(0,o.uX)(),(0,o.CE)("li",{role:"presentation",class:(0,l.C4)(e.active?"active":"")},[(0,o.Lk)("a",{href:e.href,role:"tab"},[(0,o.RG)(t.$slots,"default")],8,Z)],2)}}},te=(0,o.pM)({components:{IconSpan:F.A,TabHeader:ee,Icon:w.A}}),ne=(0,n(6262).A)(te,[["render",function(e,t,n,r,a,i){return(0,o.uX)(),(0,o.CE)(o.FK,null,[(0,o.Lk)("ul",H,[(0,o.RG)(e.$slots,"headers")]),(0,o.Lk)("div",J,[(0,o.Lk)("div",V,[(0,o.RG)(e.$slots,"panels")])])],64)}]]);var re=n(4965);const ae={__name:"App",setup:function(e){var t=(0,u.Dn)(),n=((0,re.rd)(),(0,re.lq)()),r="/api/v1/companies.geojson?"+["id","name","phone","email","mobile","goal","activities_labels","logo_id","users_gallery"].map(function(e){return"fields=".concat(e)}).join("&"),c=(0,i.KR)(r);return(0,o.wB)(function(){return n.query},function(e){var t=new URLSearchParams(e).toString();c.value="".concat(r,"&").concat(t)}),function(e,n){var r=(0,o.g2)("RouterView");return(0,o.uX)(),(0,o.CE)(o.FK,null,[((0,o.uX)(),(0,o.Wv)(o.tY,null,{fallback:(0,o.k6)(function(){return(0,a.A)(n[0]||(n[0]=[(0,o.eW)("Chargement…",-1)]))}),default:(0,o.k6)(function(){return[(0,o.bF)(r,{name:"CompanyURLSearchFilters"},{default:(0,o.k6)(function(e){var t=e.Component;return[((0,o.uX)(),(0,o.Wv)((0,o.$y)(t)))]}),_:1})]}),_:1})),((0,o.uX)(),(0,o.Wv)(o.tY,null,{fallback:(0,o.k6)(function(){return(0,a.A)(n[2]||(n[2]=[(0,o.eW)(" Chargement...",-1)]))}),default:(0,o.k6)(function(){return[(0,o.bF)(ne,null,{headers:(0,o.k6)(function(){return[(0,o.bF)(ee,{href:(0,i.R1)(t).tab_url},{default:(0,o.k6)(function(){return[(0,o.bF)(F.A,{name:"list",alt:""}),(0,o.eW)(" "+(0,l.v_)((0,i.R1)(t).tab_title),1)]}),_:1},8,["href"]),(0,o.bF)(ee,{active:""},{default:(0,o.k6)(function(){return[(0,o.bF)(F.A,{name:"map-location-dot",alt:""}),n[1]||(n[1]=(0,o.eW)(" Carte des enseignes ",-1))]}),_:1})]}),panels:(0,o.k6)(function(){return[(0,o.bF)(z,{companiesUrl:c.value,extraPlacesUrl:"/public/cae_places.geojson"},null,8,["companiesUrl"])]}),_:1})]}),_:1}))],64)}}},oe=ae;var ie=n(7431),le=n(8483),ue=n(4456),ce={class:"collapsible search_filters expanded"},se={class:"collapse_title"},pe=["id","aria-expanded","title","aria-label"],fe=["id","aria-labelledby","hidden"];const de={__name:"CollapsibleSearchFilters",props:{title:{required:!0,type:String},initialCollapsedState:{type:Boolean,default:!1},initialFilters:{type:Object,default:{}}},emits:["applyFilters"],setup:function(e,t){var n=t.emit,a=e,u=(0,i.KR)(a.initialCollapsedState),c=(0,r.NF)("accordionPanel"),s=(0,r.NF)("accordionTitle"),p=function(){return u.value=!u.value},f=(0,o.EW)(function(){return u.value?"Afficher les champs de recherche":"Masquer les champs de recherche"}),d=n,v=Object.assign({},a.initialFilters),m=function(e){return v[e.target.name]=e.target.value},h=function(e){e.preventDefault(),d("applyFilters",v)};return(0,o.wB)(function(){return a.initialFilters},function(){return Object.assign(v,a.initialFilters)}),function(t,n){return(0,o.uX)(),(0,o.CE)("div",ce,[(0,o.Lk)("h2",se,[(0,o.Lk)("a",{href:"#",id:(0,i.R1)(s),"aria-expanded":!u.value,accesskey:"R",title:f.value,"aria-label":f.value,onClick:p},[(0,o.bF)(F.A,{name:"search",alt:""}),(0,o.eW)(" "+(0,l.v_)(e.title)+" ",1),(0,o.bF)(w.A,{class:"arrow",name:"chevron-down"})],8,pe)]),(0,o.Lk)("div",{class:"collapse_content",id:(0,i.R1)(c),"aria-labelledby":(0,i.R1)(s),hidden:u.value},[(0,o.Lk)("div",null,[(0,o.Lk)("form",{id:"search_form",class:"form-search form-inline",onChange:m,onSubmit:h},[(0,o.RG)(t.$slots,"default"),(0,o.Lk)("div",null,[(0,o.bF)(ue.A,{css:"btn-primary",icon:"search",buttonType:"submit",title:"Lancer la recherche avec ces critères",label:"Lancer la recherche avec ces critères"})])],32)])],8,fe)])}}};var ve=n(810),me=n(3454),he=n(4590),be=n(294),_e=(0,me.A)("company"),ge=((0,me.A)("companyList"),["id","goal","name","activities","email","phone","mobile","address","zip_code","city","country","latitude","longitude","logo","logo_id","cgv","header","header_id","decimal_to_display","internal","code_compta","general_customer_account","general_expense_account","third_party_customer_account","general_supplier_account","third_party_supplier_account","internalgeneral_customer_account","internalthird_party_customer_account","internalgeneral_supplier_account","internalthird_party_supplier_account","contribution","internalcontribution","insurance","internalinsurance","RIB","IBAN","antenne_id","follower_id","smtp_configuration","use_margin_rate_in_catalog","margin_rate","general_overhead"]);(0,ve.nY)("company",{state:function(){return{loading:!0,error:!1,collection:[],collectionMetaData:{},companyId:null,item:{}}},actions:{setCurrentCompanyId:function(e){this.companyId=e},loadCompanies:function(e){var t=this;return(0,s.A)(f().mark(function n(){return f().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return t.loading=!0,n.abrupt("return",be.A.companies.getCompanies(e).then(function(n){var r;return e.pageOptions&&2==n.length?(t.collectionMetaData=n[0],r=n[1]):r=n,t.loading=!1,t.error="",t.collection=r,r}).catch(t.handleError));case 1:case"end":return n.stop()}},n)}))()},loadCompany:function(){var e=arguments,t=this;return(0,s.A)(f().mark(function n(){var r,a;return f().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(null===(a=e.length>1&&void 0!==e[1]?e[1]:null)&&(a=ge),r=(r=e.length>0&&void 0!==e[0]?e[0]:null)||t.companyId){n.next=1;break}throw Error("no Id provided");case 1:return t.loading=!0,n.abrupt("return",be.A.companies.load(r,a).then(function(e){return t.loading=!1,t.error=!1,t.item=e,e}).catch(t.handleError));case 2:case"end":return n.stop()}},n)}))()},handleError:function(e){var t=this;return(0,s.A)(f().mark(function n(){return f().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return t.loading=!1,t.error=e,n.abrupt("return",Promise.reject(e));case 1:case"end":return n.stop()}},n)}))()},saveCompany:function(e){var t=this;return(0,s.A)(f().mark(function n(){var r;return f().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!(r=t.companyId||e.id)){n.next=1;break}return n.abrupt("return",be.A.companies.update(e,r));case 1:return n.abrupt("return",t.createCompany(e));case 2:case"end":return n.stop()}},n)}))()},createCompany:function(e){return(0,s.A)(f().mark(function t(){return f().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.id){t.next=1;break}throw Error("Company already exists (has an id)");case 1:return t.abrupt("return",be.A.companies.create(e));case 2:case"end":return t.stop()}},t)}))()}},getters:(0,he.Q)("company")});var ye=[{path:"/companies_map",components:{CompanyURLSearchFilters:{__name:"CompanyUrlSearchFilters",setup:function(e){return(0,s.A)(f().mark(function e(){var t,n,r,a,l,u,s,p,d;return f().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return l=(0,re.rd)(),u=(0,re.lq)(),s=_e(),p=function(e){l.push({path:"/companies_map",query:e})},s.setUrl("/api/v1/companies.geojson?form_config=1"),t=(0,o.E)(function(){return s.loadConfig()}),n=(0,c.A)(t,2),r=n[0],a=n[1],e.next=1,r;case 1:return a(),d=s.getOptions("activities"),e.abrupt("return",function(e,t){return(0,o.uX)(),(0,o.Wv)(de,{title:"Recherche",onApplyFilters:p,initialFilters:(0,i.R1)(u).query},{default:(0,o.k6)(function(){return[(0,o.bF)(ie.A,{label:"Nom, enseigne, activité",name:"search",value:(0,i.R1)(u).query.search},null,8,["value"]),(0,o.bF)(le.A,{label:"Type d'activité",name:"activity_id",options:(0,i.R1)(d),value:(0,i.R1)(u).query.activity_id,"add-default":"","default-option":{id:"",label:"- Tous les types d'activité -"}},null,8,["options","value"]),(0,o.bF)(ie.A,{label:"Code postal",name:"postcode",value:(0,i.R1)(u).query.postcode},null,8,["value"])]}),_:1},8,["initialFilters"])});case 2:case"end":return e.stop()}},e)}))()}}}}];(0,r.Yk)(oe,"vue-app",ye)}},a={};function o(e){var t=a[e];if(void 0!==t)return t.exports;var n=a[e]={id:e,loaded:!1,exports:{}};return r[e].call(n.exports,n,n.exports,o),n.loaded=!0,n.exports}o.m=r,e=[],o.O=(t,n,r,a)=>{if(!n){var i=1/0;for(s=0;s<e.length;s++){for(var[n,r,a]=e[s],l=!0,u=0;u<n.length;u++)(!1&a||i>=a)&&Object.keys(o.O).every(e=>o.O[e](n[u]))?n.splice(u--,1):(l=!1,a<i&&(i=a));if(l){e.splice(s--,1);var c=r();void 0!==c&&(t=c)}}return t}a=a||0;for(var s=e.length;s>0&&e[s-1][2]>a;s--)e[s]=e[s-1];e[s]=[n,r,a]},o.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return o.d(t,{a:t}),t},n=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__,o.t=function(e,r){if(1&r&&(e=this(e)),8&r)return e;if("object"==typeof e&&e){if(4&r&&e.__esModule)return e;if(16&r&&"function"==typeof e.then)return e}var a=Object.create(null);o.r(a);var i={};t=t||[null,n({}),n([]),n(n)];for(var l=2&r&&e;"object"==typeof l&&!~t.indexOf(l);l=n(l))Object.getOwnPropertyNames(l).forEach(t=>i[t]=()=>e[t]);return i.default=()=>e,o.d(a,i),a},o.d=(e,t)=>{for(var n in t)o.o(t,n)&&!o.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},o.e=()=>Promise.resolve(),o.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),o.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),o.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.nmd=e=>(e.paths=[],e.children||(e.children=[]),e),o.j=503,(()=>{var e;o.g.importScripts&&(e=o.g.location+"");var t=o.g.document;if(!e&&t&&(t.currentScript&&"SCRIPT"===t.currentScript.tagName.toUpperCase()&&(e=t.currentScript.src),!e)){var n=t.getElementsByTagName("script");if(n.length)for(var r=n.length-1;r>-1&&(!e||!/^http(s?):/.test(e));)e=n[r--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),o.p=e})(),(()=>{var e={503:0};o.O.j=t=>0===e[t];var t=(t,n)=>{var r,a,[i,l,u]=n,c=0;if(i.some(t=>0!==e[t])){for(r in l)o.o(l,r)&&(o.m[r]=l[r]);if(u)var s=u(o)}for(t&&t(n);c<i.length;c++)a=i[c],o.o(e,a)&&e[a]&&e[a][0](),e[a]=0;return o.O(s)},n=self.webpackChunkenDI=self.webpackChunkenDI||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})(),o.nc=void 0;var i=o.O(void 0,[534],()=>o(7040));i=o.O(i)})();