(()=>{"use strict";var t,n,e,o={7511:(t,n,e)=>{var o=e(750),i=e(5458),r=e(641),a=e(953),c=e(33),l=e(3115),u=e(810),s=e(296),f=e(467),p=e(4756),d=e.n(p),v=e(294);function m(t,n){return{markRead:(o=(0,f.A)(d().mark(function t(n){var e;return d().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=1,v.A.notifications.markRead(n);case 1:this.collection=this.collection.filter(function(t){return t.id!==n.id}),this.collectionMetaData.total_entries-=1,t.next=3;break;case 2:throw t.prev=2,e=t.catch(0),new Error(e);case 3:case"end":return t.stop()}},t,this,[[0,2]])})),function(t){return o.apply(this,arguments)}),postPone:(e=(0,f.A)(d().mark(function t(n){var e;return d().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=1,v.A.notifications.postPone(n);case 1:this.collection=this.collection.filter(function(t){return t.id!==n.id}),this.collectionMetaData.total_entries-=1,t.next=3;break;case 2:throw t.prev=2,e=t.catch(0),new Error(e);case 3:case"end":return t.stop()}},t,this,[[0,2]])})),function(t){return e.apply(this,arguments)}),handleError:function(t){var n=this;return(0,f.A)(d().mark(function e(){return d().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n.loading=!1,n.error=t,e.abrupt("return",t);case 1:case"end":return e.stop()}},e)}))()},loadChannel:function(){var t=arguments,e=this;return(0,f.A)(d().mark(function o(){var i,r,a,c;return d().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return i=t.length>0&&void 0!==t[0]?t[0]:5,console.log("Calling loadChannel"),e.loading=!0,o.prev=1,o.next=2,v.A.notifications.loadCollection({fields:["title","body"],related:[],pageOptions:{items_per_page:i,page:0},filters:{channel:n}});case 2:r=o.sent,a=(0,s.A)(r,2),e.collectionMetaData=a[0],e.collection=a[1],e.loading=!1,e.error="",o.next=4;break;case 3:throw o.prev=3,c=o.catch(1),new Error(c);case 4:case"end":return o.stop()}},o,null,[[1,3]])}))()}};var e,o}var k=function(t,n){return(0,u.nY)(t,{state:function(){return{loading:!0,error:!1,collection:[],collectionMetaData:{total_entries:0}}},actions:m(0,n),getters:{notificationCount:function(t){return t.collectionMetaData.total_entries}}})},h=k("notification-message","message"),b=k("notification-header_message","header_message"),_=k("notification-alert","alert"),g=e(7546),y=e(5979),C=["innerHTML"],M=["innerHTML"];const w={__name:"Notification",props:{notification:Object},emits:["mark_read","postpone"],setup:function(t,n){var e=n.emit,o=t,i=e,l={success:"check",valid:"check-circle",error:"exclamation-triangle",invalid:"times-circle",caution:"exclamation-triangle",neutral:"info-circle",calendar:"calendar-alt"}[o.notification.status_type]||"info-circle",u={success:"success",valid:"success",error:"invalid",caution:"caution",neutral:"neutral",calendar:"neutral"}[o.notification.status_type]||"neutral",s=function(){i("postpone",o.notification)},f=function(){i("mark_read",o.notification)};return function(n,e){return(0,r.uX)(),(0,r.CE)("li",{"aria-hidden":"false",class:(0,c.C4)((0,a.R1)(u))},[(0,r.bF)(y.A,{name:(0,a.R1)(l),alt:""},null,8,["name"]),(0,r.Lk)("div",null,[(0,r.Lk)("h4",{class:"text",innerHTML:t.notification.title},null,8,C),(0,r.Lk)("div",{class:"text",innerHTML:t.notification.body},null,8,M)]),(0,r.Lk)("button",{class:"icon unstyled close",title:"Fermer cette notification","aria-label":"Fermer cette notification",onClick:f},[(0,r.bF)(g.A,{name:"times"})]),(0,r.Lk)("button",{class:"icon unstyled repeat",title:"Répéter cette notification dans 7 jours","aria-label":"Répéter cette notification dans 7 jours",onClick:s},[(0,r.bF)(g.A,{name:"clock"})])],2)}}};var A={class:"notifications"},L={key:0,class:"text_more"};const R={__name:"NotificationList",props:{notifications:Array,notificationCount:Number},emits:["showAll","mark_read","postpone"],setup:function(t,n){var e=n.emit,o=t,i=e,l=Math.max(o.notificationCount-5,0),u="... et ".concat(l," autres notifications"),s=function(){return i("showAll"),!1};return function(n,e){return(0,r.uX)(),(0,r.CE)("ul",A,[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(t.notifications.slice(0,(0,a.R1)(5)),function(t){return(0,r.uX)(),(0,r.Wv)(w,{key:t.id,notification:t,onMark_read:function(t){return n.$emit("mark_read",t)},onPostpone:function(t){return n.$emit("postpone",t)}},null,8,["notification","onMark_read","onPostpone"])}),128)),(0,a.R1)(l)?((0,r.uX)(),(0,r.CE)("li",L,[(0,r.Lk)("div",null,[(0,r.Lk)("small",null,(0,c.v_)(u)),e[0]||(e[0]=(0,r.Lk)("br",null,null,-1)),(0,r.Lk)("a",{href:"javascript:void(0);",onClick:s},"Voir toutes les notifications")])])):(0,r.Q3)("v-if",!0)])}}};var P=e(5796),x={class:"notifications"};const O={__name:"NotificationModal",emits:["close","mark_read","postpone"],setup:function(t,n){return(0,f.A)(d().mark(function t(){var e,o,i,f,p,v,m,k,b,_,g,y;return d().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return i=n.emit,v=i,m=h(),(k=(0,u.bP)(m)).collectionMetaData,b=k.collection,_=(0,a.KR)(null),(0,l.X2F)(_,function(t){v("close")}),g=function(t){v("mark_read",t)},y=function(t){v("postpone",t)},e=(0,r.E)(function(){return m.loadChannel(1e3)}),o=(0,s.A)(e,2),f=o[0],p=o[1],t.next=1,f;case 1:return p(),t.abrupt("return",function(t,n){return(0,r.uX)(),(0,r.Wv)(P.A,{onClose:n[1]||(n[1]=function(n){return t.$emit("close")}),ref_key:"modalTarget",ref:_},{header:(0,r.k6)(function(){return[(0,r.eW)((0,c.v_)((0,a.R1)(b).length)+" Notifications",1)]}),body:(0,r.k6)(function(){return[(0,r.Lk)("ul",x,[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)((0,a.R1)(b),function(t){return(0,r.uX)(),(0,r.Wv)(w,{key:t.id,notification:t,onMark_read:function(){return g(t)},onPostpone:function(){return y(t)}},null,8,["notification","onMark_read","onPostpone"])}),128))])]}),footer:(0,r.k6)(function(){return[(0,r.Lk)("button",{type:"button",onClick:n[0]||(n[0]=function(n){return t.$emit("close")}),title:"Fermer cette fenêtre","aria-label":"Fermer cette fenêtre"}," Fermer ")]}),_:1},512)});case 2:case"end":return t.stop()}},t)}))()}};var j={class:"notification_counter"},F=["title","aria-label","disabled"],E={key:0,class:"bubble"};const X={__name:"NotificationListComponent",setup:function(t){var n=h(),e=(0,u.bP)(n),o=(e.collectionMetaData,e.collection),i=n.loadChannel,s=n.markRead,f=n.postPone,p=(0,r.EW)(function(){return o.value?"Afficher ".concat(o.value.length," notifications"):"Aucune notification"}),d=(0,a.KR)(!1),v=(0,a.KR)(!1);function m(){d.value=!d.value}function k(){console.log("Showing the popup with all notifications"),v.value=!0,d.value=!1}function b(){v.value=!1,d.value=!1}var _=(0,a.KR)(null);(0,l.X2F)(_,function(t){d&&(v.value||(d.value=!1))});var y=function(t){s(t)},C=function(t){f(t)};return i(5),function(t,e){return(0,r.uX)(),(0,r.CE)(r.FK,null,[(0,r.Lk)("div",j,[((0,r.uX)(),(0,r.CE)("button",{class:"icon unstyled",title:(0,a.R1)(p),"aria-label":(0,a.R1)(p),onClick:m,disabled:!(0,a.R1)(n).notificationCount,key:(0,a.R1)(n).notificationCount},[(0,r.bF)(g.A,{name:"bell"}),(0,a.R1)(n).notificationCount>0?((0,r.uX)(),(0,r.CE)("span",E,(0,c.v_)((0,a.R1)(n).notificationCount),1)):(0,r.Q3)("v-if",!0)],8,F))]),d.value?((0,r.uX)(),(0,r.Wv)(R,{key:0,notifications:(0,a.R1)(o),notificationCount:(0,a.R1)(n).notificationCount,onShowAll:k,onMark_read:y,onPostpone:C,ref_key:"dropDownTarget",ref:_},null,8,["notifications","notificationCount"])):(0,r.Q3)("v-if",!0),v.value?((0,r.uX)(),(0,r.Wv)(O,{key:1,ref:"alertTarget",onClose:b,onMark_read:y,onPostpone:C},null,512)):(0,r.Q3)("v-if",!0)],64)}}},T={__name:"MessageApp",setup:function(t){return function(t,n){return(0,r.uX)(),(0,r.Wv)(r.tY,null,{fallback:(0,r.k6)(function(){return(0,i.A)(n[0]||(n[0]=[(0,r.eW)(" Chargement... ",-1)]))}),default:(0,r.k6)(function(){return[(0,r.bF)(X)]}),_:1})}}};var W=["innerHTML"],D=["innerHTML"];const S={__name:"NotificationModal",props:{notification:Object},emits:["postpone","mark_read"],setup:function(t,n){return n.emit,function(n,e){return(0,r.uX)(),(0,r.Wv)(P.A,{onClose:e[2]||(e[2]=function(e){return n.$emit("mark_read",t.notification)})},{header:(0,r.k6)(function(){return[(0,r.Lk)("span",{innerHTML:t.notification.title},null,8,W)]}),body:(0,r.k6)(function(){return[(0,r.Lk)("span",{innerHTML:t.notification.body},null,8,D)]}),footer:(0,r.k6)(function(){return[(0,r.Lk)("button",{type:"button",class:"btn btn-primary",onClick:e[0]||(e[0]=function(e){return n.$emit("mark_read",t.notification)}),title:"Fermer cette fenêtre","aria-label":"Fermer cette fenêtre"}," Fermer "),(0,r.Lk)("button",{type:"button",class:"btn btn-secondary",onClick:e[1]||(e[1]=function(e){return n.$emit("postpone",t.notification)}),title:"Me le rappeler plus tard","aria-label":"Me le rappeler plus tard"}," Plus tard ")]}),_:1})}}},N={__name:"AlertApp",setup:function(t){var n=_(),e=(0,u.bP)(n),o=e.collectionMetaData,i=e.collection,c=function(t){n.markRead(t).then(function(){return n.loadChannel(1)})},l=function(t){n.postPone(t).then(function(){return n.loadChannel(1)})};return n.loadChannel(1),function(t,n){return(0,a.R1)(o).total_entries?((0,r.uX)(),(0,r.Wv)(S,{key:0,notification:(0,a.R1)(i)[0],onMark_read:c,onPostpone:l},null,8,["notification"])):(0,r.Q3)("v-if",!0)}}};var $={class:"notification"},H={class:"alert alert-warning align_center"};const K={__name:"Notification",props:{notification:Object},emits:["mark_read"],setup:function(t,n){n.emit;var e=t,o=e.notification.title+"<br />"+e.notification.body;return function(n,e){return(0,r.uX)(),(0,r.CE)("div",$,[(0,r.Lk)("div",H,[(0,r.bF)(y.A,{name:"exclamation-triangle",alt:"Attention : "}),(0,r.Lk)("div",null,[(0,r.Lk)("strong",{innerHTML:o})]),(0,r.Lk)("button",{type:"button",class:"icon only unstyled close",title:"Masquer ce message","aria-label":"Masquer ce message",onClick:e[0]||(e[0]=function(e){return n.$emit("mark_read",t.notification)})},[(0,r.bF)(g.A,{name:"times"})])])])}}},Q={__name:"HeaderMessageApp",setup:function(t){var n=b(),e=(0,u.bP)(n),o=e.collectionMetaData,i=e.collection,c=function(t){n.markRead(t).then(function(){return n.loadChannel(1)})};n.loadChannel(1);var l=(0,r.EW)(function(){return i.value[0]});return function(t,n){return(0,a.R1)(o).total_entries&&!t.loading?((0,r.uX)(),(0,r.Wv)(K,{key:0,notification:l.value,onMark_read:c},null,8,["notification"])):(0,r.Q3)("v-if",!0)}}};(0,o.Yk)(T,"vue-notification-message-app"),(0,o.Yk)(N,"vue-notification-alert-app"),(0,o.Yk)(Q,"vue-notification-header_message-app")}},i={};function r(t){var n=i[t];if(void 0!==n)return n.exports;var e=i[t]={id:t,loaded:!1,exports:{}};return o[t].call(e.exports,e,e.exports,r),e.loaded=!0,e.exports}r.m=o,t=[],r.O=(n,e,o,i)=>{if(!e){var a=1/0;for(s=0;s<t.length;s++){for(var[e,o,i]=t[s],c=!0,l=0;l<e.length;l++)(!1&i||a>=i)&&Object.keys(r.O).every(t=>r.O[t](e[l]))?e.splice(l--,1):(c=!1,i<a&&(a=i));if(c){t.splice(s--,1);var u=o();void 0!==u&&(n=u)}}return n}i=i||0;for(var s=t.length;s>0&&t[s-1][2]>i;s--)t[s]=t[s-1];t[s]=[e,o,i]},r.n=t=>{var n=t&&t.__esModule?()=>t.default:()=>t;return r.d(n,{a:n}),n},e=Object.getPrototypeOf?t=>Object.getPrototypeOf(t):t=>t.__proto__,r.t=function(t,o){if(1&o&&(t=this(t)),8&o)return t;if("object"==typeof t&&t){if(4&o&&t.__esModule)return t;if(16&o&&"function"==typeof t.then)return t}var i=Object.create(null);r.r(i);var a={};n=n||[null,e({}),e([]),e(e)];for(var c=2&o&&t;"object"==typeof c&&!~n.indexOf(c);c=e(c))Object.getOwnPropertyNames(c).forEach(n=>a[n]=()=>t[n]);return a.default=()=>t,r.d(i,a),i},r.d=(t,n)=>{for(var e in n)r.o(n,e)&&!r.o(t,e)&&Object.defineProperty(t,e,{enumerable:!0,get:n[e]})},r.e=()=>Promise.resolve(),r.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),r.o=(t,n)=>Object.prototype.hasOwnProperty.call(t,n),r.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.nmd=t=>(t.paths=[],t.children||(t.children=[]),t),r.j=602,(()=>{var t;r.g.importScripts&&(t=r.g.location+"");var n=r.g.document;if(!t&&n&&(n.currentScript&&"SCRIPT"===n.currentScript.tagName.toUpperCase()&&(t=n.currentScript.src),!t)){var e=n.getElementsByTagName("script");if(e.length)for(var o=e.length-1;o>-1&&(!t||!/^http(s?):/.test(t));)t=e[o--].src}if(!t)throw new Error("Automatic publicPath is not supported in this browser");t=t.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),r.p=t})(),(()=>{var t={602:0};r.O.j=n=>0===t[n];var n=(n,e)=>{var o,i,[a,c,l]=e,u=0;if(a.some(n=>0!==t[n])){for(o in c)r.o(c,o)&&(r.m[o]=c[o]);if(l)var s=l(r)}for(n&&n(e);u<a.length;u++)i=a[u],r.o(t,i)&&t[i]&&t[i][0](),t[i]=0;return r.O(s)},e=self.webpackChunkenDI=self.webpackChunkenDI||[];e.forEach(n.bind(null,0)),e.push=n.bind(null,e.push.bind(e))})(),r.nc=void 0;var a=r.O(void 0,[534],()=>r(7511));a=r.O(a)})();