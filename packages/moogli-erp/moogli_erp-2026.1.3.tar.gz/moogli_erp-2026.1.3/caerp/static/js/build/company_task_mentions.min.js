(()=>{"use strict";var e,n,t,r={6041:(e,n,t)=>{var r=t(750),o=t(5458),u=t(641),i=t(953),a=t(136),l=t(296),c=t(467),s=t(4756),p=t.n(s),f=t(810),d=t(294),v=(0,t(3454).A)("configurable_option"),m=(0,f.nY)("configurable_option",function(){var e=(0,i.KR)(!0),n=(0,i.KR)(null),t=(0,i.KR)({}),r=(0,i.KR)([]),o=(0,i.KR)({});function u(){return(u=(0,c.A)(p().mark(function e(n){return p().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:d.A.configurable_option.setCollectionUrl(n),a();case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)}function a(){return l.apply(this,arguments)}function l(){return l=(0,c.A)(p().mark(function n(){var t,u,i=arguments;return p().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return t=i.length>0&&void 0!==i[0]?i[0]:{},n.next=1,d.A.configurable_option.loadCollection(t);case 1:u=n.sent,r.value=u.items,o.value=u.metadata,e.value=!1;case 2:case"end":return n.stop()}},n)})),l.apply(this,arguments)}function s(){return(s=(0,c.A)(p().mark(function e(r){return p().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n.value=r,null===r&&(t.value={});case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)}function f(){return f=(0,c.A)(p().mark(function r(){var o,u,i=arguments;return p().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return(o=i.length>0&&void 0!==i[0]?i[0]:null)||(o=n.value),r.next=1,d.A.configurable_option.load(o);case 1:u=r.sent,t.value=u,e.value=!1;case 2:case"end":return r.stop()}},r)})),f.apply(this,arguments)}function v(e){return m.apply(this,arguments)}function m(){return(m=(0,c.A)(p().mark(function e(n){return p().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=1,d.A.configurable_option.create(n);case 1:return t.value=e.sent,e.next=2,a();case 2:return e.abrupt("return",t.value);case 3:case"end":return e.stop()}},e)}))).apply(this,arguments)}function b(e){return h.apply(this,arguments)}function h(){return h=(0,c.A)(p().mark(function e(n){var r,o=arguments;return p().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=o.length>1&&void 0!==o[1]?o[1]:null,e.next=1,d.A.configurable_option.update(n,r);case 1:return t.value=e.sent,e.next=2,a();case 2:return e.abrupt("return",t.value);case 3:case"end":return e.stop()}},e)})),h.apply(this,arguments)}function y(){return y=(0,c.A)(p().mark(function e(n){var t,r=arguments;return p().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=r.length>1&&void 0!==r[1]?r[1]:null,n.id||t){e.next=1;break}return e.abrupt("return",v(n));case 1:return e.abrupt("return",b(n,t));case 2:case"end":return e.stop()}},e)})),y.apply(this,arguments)}function g(){return(g=(0,c.A)(p().mark(function e(n){return p().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=1,d.A.configurable_option.delete(n);case 1:return e.next=2,a();case 2:case"end":return e.stop()}},e)}))).apply(this,arguments)}return{loading:e,currentOptionId:n,currentOption:t,optionCollection:r,optionCollectionMeta:o,setInitialValues:function(e){return u.apply(this,arguments)},setOptionId:function(e){return s.apply(this,arguments)},loadOption:function(){return f.apply(this,arguments)},deleteOption:function(e){return g.apply(this,arguments)},save:function(e){return y.apply(this,arguments)}}}),b=t(7437),h=t(33),y=t(1268),g=t(920),k=t(7431),w=t(7987),_={class:"deformFormFieldset"},A={class:"deformFormFieldset"},O={class:"btn-group"},C=["disabled"];const x={__name:"CompanyTaskMentionForm",props:{isEdit:{type:Boolean,default:!1},option:{type:Object,default:null},layout:{type:Object,default:b.A}},emits:["saved","cancel","error"],setup:function(e,n){var t=n.emit,r=e,o=t,a=m(),l=v().getSchema("default"),c=(0,g.cp)(l),s=(0,g.rV)(c);Object.assign(s,r.option);var p=(0,y.mN)({validationSchema:c,initialValues:s}),f=(p.values,p.handleSubmit),d=p.isSubmitting,b=f((0,g.FP)(o,a.save),(0,g.WS)(o)),x=function(){return o("cancel")},S=function(e){return(0,g.Nw)(c,e)};return function(n,t){return(0,u.uX)(),(0,u.Wv)((0,u.$y)(e.layout),{onSubmitForm:(0,i.R1)(b),onClose:x},{title:(0,u.k6)(function(){return[e.isEdit?((0,u.uX)(),(0,u.CE)(u.FK,{key:0},[(0,u.eW)(" Modifier une mention ")],64)):((0,u.uX)(),(0,u.CE)(u.FK,{key:1},[(0,u.eW)(" Ajouter une mention ")],64))]}),fields:(0,u.k6)(function(){return[(0,u.Lk)("fieldset",_,[(0,u.bF)(k.A,(0,h._B)((0,u.Ng)(S("label"))),null,16),(0,u.bF)(k.A,(0,h._B)((0,u.Ng)(S("help_text"))),null,16)]),(0,u.Lk)("fieldset",A,[t[1]||(t[1]=(0,u.Lk)("legend",null,"Sortie PDF",-1)),(0,u.bF)(k.A,(0,h._B)((0,u.Ng)(S("title"))),null,16),(0,u.bF)(w.A,(0,h._B)((0,u.Ng)(S("full_text"))),null,16)])]}),buttons:(0,u.k6)(function(){return[(0,u.Lk)("div",O,[(0,u.Lk)("button",{id:"deformsubmit",name:"submit",type:"submit",class:"btn btn-primary",value:"submit",disabled:(0,i.R1)(d)},(0,h.v_)(e.isEdit?"Modifier":"Valider"),9,C),(0,u.Lk)("button",{id:"deformcancel",name:"cancel",type:"button",class:"btn btn-default",onClick:t[0]||(t[0]=function(){return o("cancel")})}," Annuler ")])]}),_:1},40,["onSubmitForm"])}}};var S={key:0};const F={__name:"CompanyTaskMentionFormComponent",props:{optionId:{type:Number||null,default:null},layout:{type:Object,default:b.A}},emits:["saved","cancel"],setup:function(e,n){return(0,c.A)(p().mark(function t(){var r,o,a,s,d,b,h,y,g,k,w,_,A,O,C,F;return p().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return F=function(){console.log("Cancel Option add/edit"),h("cancel")},C=function(e){h("saved",e)},a=n.emit,h=a,y=!!(b=e).optionId,g=(0,i.KR)(!0),k=m(),w=v(),_=function(){var e=(0,c.A)(p().mark(function e(){var n;return p().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n=[w.loadConfig()],y?n.push(k.loadOption(b.optionId)):n.push(k.setOptionId(null)),Promise.all(n).then(function(){return g.value=!1});case 1:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}(),A=(0,f.bP)(k),O=A.currentOption,r=(0,u.E)(function(){return _()}),o=(0,l.A)(r,2),s=o[0],d=o[1],t.next=1,s;case 1:return d(),t.abrupt("return",function(n,t){return g.value?((0,u.uX)(),(0,u.CE)("div",S,"Chargement des informations")):((0,u.uX)(),(0,u.Wv)(x,{key:1,option:(0,i.R1)(O),layout:e.layout,onSaved:C,onCancel:F},null,8,["option","layout"]))});case 2:case"end":return t.stop()}},t)}))()}};var j=t(1275);const P=t(1289).A;var R=t(5861);const L=[{name:"label",title:"Libellé",cellComponent:(0,i.IG)(R.A),css:"col_text"},{name:"title",title:"Titre à afficher dans le PDF",cellComponent:(0,i.IG)(R.A),css:"col_text",componentOptions:{defaultValue:"-"}}];var E=t(4456),I=(t(7546),{class:"limited_width width60"}),M={class:"col_actions width_two"},K={class:"btn-group"};const N={__name:"CompanyTaskMentionComponent",props:{url:{type:String,required:!0},formConfigUrl:{type:String,required:!0}},setup:function(e){return(0,c.A)(p().mark(function n(){var t,r,o,a,s,d,b,h,y,g,k,w,_,A,O,C,x,S;return p().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return A=function(){return(A=(0,c.A)(p().mark(function e(){var n,t;return p().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=y.setInitialValues(s.url),t=g.loadConfig(),e.next=1,Promise.all([n,t]);case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)},_=function(){return A.apply(this,arguments)},s=e,d=(0,i.KR)(!1),b=(0,i.KR)(null),h=(0,i.KR)({columnsDef:L,columns:L.map(function(e){return e.name})}),y=m(),(g=v()).setUrl(s.formConfigUrl),k=(0,f.bP)(y),w=k.optionCollection,O=function(){d.value=!0},C=function(e){d.value=!0,b.value=e},x=function(){d.value=!1,b.value=null},S=function(e){console.log("Save option",e),d.value=!1,b.value=null},t=(0,u.E)(function(){return _()}),r=(0,l.A)(t,2),o=r[0],a=r[1],n.next=1,o;case 1:return a(),n.abrupt("return",function(e,n){return(0,u.uX)(),(0,u.CE)("div",I,[n[0]||(n[0]=(0,u.Lk)("div",{class:"alert alert-info"},[(0,u.eW)(" Vous pouvez configurer ici des mentions spécifiques qui vous seront proposées lorsque vous éditez des devis ou des factures."),(0,u.Lk)("br"),(0,u.eW)(" Celles-ci apparaîtront alors dans les fichiers PDF sous la forme de cadres en dessous des prestations. ")],-1)),n[1]||(n[1]=(0,u.Lk)("h2",null,"Liste des mentions",-1)),(0,u.bF)(P,{items:(0,i.R1)(w),params:h.value},{rowActions:(0,u.k6)(function(e){var n=e.item;return[(0,u.Lk)("td",M,[(0,u.Lk)("div",K,[(0,u.bF)(E.A,{"show-label":!1,icon:"pen",label:"Modifier",title:"Ouvrir le formulaire de modification de l'élément",onClick:function(){return C(n.id)}},null,8,["onClick"]),(0,u.bF)(E.A,{"show-label":!1,icon:"trash-alt",css:"negative",label:"Supprimer",title:"Supprimer l'élément",onClick:function(){return(0,i.R1)(y).deleteOption(n.id)}},null,8,["onClick"])])])]}),_:1},8,["items","params"]),(0,u.bF)(E.A,{icon:"plus",label:"Ajouter un élément",onClick:O,"show-label":!0}),(0,u.Q3)(" Formulaire d'ajout / Modification d'un élément "),d.value?((0,u.uX)(),(0,u.Wv)(F,{key:0,"option-id":b.value,layout:j.A,onCancel:x,onSaved:S},null,8,["option-id"])):(0,u.Q3)("v-if",!0)])});case 2:case"end":return n.stop()}},n)}))()}},T={__name:"App",setup:function(e){var n=(0,a.Dn)(),t=function(){window.location.replace("/companies/"+n.company_id)},r=function(){n.come_from?window.location.replace(n.come_from):window.location.href=n.context_url.replace("/api/v1/","/")};return function(e,a){return(0,u.uX)(),(0,u.Wv)(u.tY,null,{fallback:(0,u.k6)(function(){return(0,o.A)(a[0]||(a[0]=[(0,u.eW)(" Chargement... ",-1)]))}),default:(0,u.k6)(function(){return[(0,u.Lk)("div",null,[(0,u.bF)(N,{url:(0,i.R1)(n).context_url,"form-config-url":(0,i.R1)(n).form_config_url,onOnSave:t,onOnCancel:r},null,8,["url","form-config-url"])])]}),_:1})}}};(0,r.Yk)(T)},5861:(e,n,t)=>{t.d(n,{A:()=>r});const r=t(9329).A}},o={};function u(e){var n=o[e];if(void 0!==n)return n.exports;var t=o[e]={id:e,loaded:!1,exports:{}};return r[e].call(t.exports,t,t.exports,u),t.loaded=!0,t.exports}u.m=r,e=[],u.O=(n,t,r,o)=>{if(!t){var i=1/0;for(s=0;s<e.length;s++){for(var[t,r,o]=e[s],a=!0,l=0;l<t.length;l++)(!1&o||i>=o)&&Object.keys(u.O).every(e=>u.O[e](t[l]))?t.splice(l--,1):(a=!1,o<i&&(i=o));if(a){e.splice(s--,1);var c=r();void 0!==c&&(n=c)}}return n}o=o||0;for(var s=e.length;s>0&&e[s-1][2]>o;s--)e[s]=e[s-1];e[s]=[t,r,o]},u.n=e=>{var n=e&&e.__esModule?()=>e.default:()=>e;return u.d(n,{a:n}),n},t=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__,u.t=function(e,r){if(1&r&&(e=this(e)),8&r)return e;if("object"==typeof e&&e){if(4&r&&e.__esModule)return e;if(16&r&&"function"==typeof e.then)return e}var o=Object.create(null);u.r(o);var i={};n=n||[null,t({}),t([]),t(t)];for(var a=2&r&&e;"object"==typeof a&&!~n.indexOf(a);a=t(a))Object.getOwnPropertyNames(a).forEach(n=>i[n]=()=>e[n]);return i.default=()=>e,u.d(o,i),o},u.d=(e,n)=>{for(var t in n)u.o(n,t)&&!u.o(e,t)&&Object.defineProperty(e,t,{enumerable:!0,get:n[t]})},u.e=()=>Promise.resolve(),u.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),u.o=(e,n)=>Object.prototype.hasOwnProperty.call(e,n),u.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},u.nmd=e=>(e.paths=[],e.children||(e.children=[]),e),u.j=350,(()=>{var e;u.g.importScripts&&(e=u.g.location+"");var n=u.g.document;if(!e&&n&&(n.currentScript&&"SCRIPT"===n.currentScript.tagName.toUpperCase()&&(e=n.currentScript.src),!e)){var t=n.getElementsByTagName("script");if(t.length)for(var r=t.length-1;r>-1&&(!e||!/^http(s?):/.test(e));)e=t[r--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),u.p=e})(),(()=>{var e={350:0};u.O.j=n=>0===e[n];var n=(n,t)=>{var r,o,[i,a,l]=t,c=0;if(i.some(n=>0!==e[n])){for(r in a)u.o(a,r)&&(u.m[r]=a[r]);if(l)var s=l(u)}for(n&&n(t);c<i.length;c++)o=i[c],u.o(e,o)&&e[o]&&e[o][0](),e[o]=0;return u.O(s)},t=self.webpackChunkenDI=self.webpackChunkenDI||[];t.forEach(n.bind(null,0)),t.push=n.bind(null,t.push.bind(t))})(),u.nc=void 0;var i=u.O(void 0,[534],()=>u(6041));i=u.O(i)})();