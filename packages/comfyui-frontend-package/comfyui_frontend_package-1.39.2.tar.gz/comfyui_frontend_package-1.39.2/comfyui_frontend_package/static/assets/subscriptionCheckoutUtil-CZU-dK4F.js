import{i as e,n as t}from"./rolldown-runtime-BKYq3fBv.js";import{on as n,sn as r}from"./api-Dwy4NIr-.js";import{r as i,s as a}from"./i18n-iveDrznX.js";import{Bo as o,Ho as s,Ro as c,Vo as l,zo as u}from"./dialogService-BJDTj7su.js";async function performSubscriptionCheckout(e,t,n=!0){if(!r)return;let{getFirebaseAuthHeader:i}=o(),s=await i();if(!s)throw new c(a(`toastMessages.userNotAuthenticated`));let u=getCheckoutTier(e,t),d=await fetch(`${l()}/customers/cloud-subscription-checkout/${u}`,{method:`POST`,headers:{...s,"Content-Type":`application/json`}});if(!d.ok){let e=`Failed to initiate checkout`;try{e=(await d.json()).message||e}catch{try{e=await d.text()||`HTTP ${d.status} ${d.statusText}`}catch{e=`HTTP ${d.status} ${d.statusText}`}}throw new c(a(`toastMessages.failedToInitiateSubscription`,{error:e}))}let f=await d.json();f.checkout_url&&(n?window.open(f.checkout_url,`_blank`):globalThis.location.href=f.checkout_url)}var getCheckoutTier,d=t((()=>{s(),i(),n(),u(),getCheckoutTier=(e,t)=>t===`yearly`?`${e}-yearly`:e}));export{performSubscriptionCheckout as n,d as t};
//# sourceMappingURL=subscriptionCheckoutUtil-CZU-dK4F.js.map