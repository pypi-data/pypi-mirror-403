import{i as e,n as t}from"./rolldown-runtime-BKYq3fBv.js";import{$n as n,Cr as r,En as i,Gn as a,Ir as o,Jt as ee,Mn as s,Nn as c,Or as te,Qn as l,Rr as u,Tn as d,Tr as f,Un as ne,Xn as p,Xr as m,Zn as h,_n as g,_t as _,ai as v,an as y,ar as b,er as x,g as S,h as C,ir as w,jn as re,lt as T,on as ie,qt as E,si as ae,sr as D,ui as O,ut as oe,vn as se,vt as k,zr as ce}from"./vendor-primevue-Cg-HmKZY.js";import{ot as le,st as ue}from"./vendor-other-BQ5HftVH.js";import{n as de,t as A}from"./Button-B4OHW57I.js";import{n as j,t as M,w as N,y as P}from"./PanelTemplate-B87Qym7Z.js";import{Co as F,Da as I,Ea as L,Eo as R,So as z,To as B,wo as V,xo as fe}from"./dialogService-BJDTj7su.js";import{n as pe,t as me}from"./_plugin-vue_export-helper-Ckv1EJQX.js";import{n as he,t as ge}from"./keybindingService-azBNra8Y.js";var H,U,W=t((()=>{c(),C(),H={key:0,class:`px-2`},U=D({__name:`KeyComboDisplay`,props:{keyCombo:{},isModified:{type:Boolean,default:!1}},setup(e){let t=p(()=>e.keyCombo.getKeySequences());return(e,i)=>(r(),x(`span`,null,[(r(!0),x(a,null,f(t.value,(i,o)=>(r(),x(a,{key:o},[b(v(S),{severity:e.isModified?`info`:`secondary`},{default:u(()=>[w(O(i),1)]),_:2},1032,[`severity`]),o<t.value.length-1?(r(),x(`span`,H,`+`)):n(``,!0)],64))),128))]))}})})),G,_e=t((()=>{W(),W(),G=U})),K,q,J,Y,X,Z=t((()=>{c(),s(),_(),T(),E(),y(),g(),C(),d(),le(),I(),de(),ge(),fe(),B(),P(),j(),_e(),K={class:`actions invisible flex flex-row`},q=[`title`],J={key:1},Y={class:`overflow-hidden text-ellipsis`},X=D({__name:`KeybindingPanel`,setup(e){let t=m({global:{value:``,matchMode:re.CONTAINS}}),a=R(),s=he(),c=z(),{t:d}=ue(),f=p(()=>Object.values(c.commands).map(e=>({id:e.id,label:d(`commands.${N(e.id)}.label`,e.label??``),keybinding:a.getKeybindingByCommandId(e.id),source:e.source}))),g=m(null),_=m(!1),y=m(null),C=m(null),T=m(null),E=p(()=>!C.value||C.value.keybinding?.combo?.equals(y.value)||!y.value?null:a.getKeybinding(y.value));function editKeybinding(e){C.value=e,y.value=e.keybinding?e.keybinding.combo:null,_.value=!0}o(()=>{_.value&&setTimeout(()=>{T.value?.$el?.focus()},300)});async function removeKeybinding(e){e.keybinding&&(a.unsetKeybinding(e.keybinding),await s.persistUserKeybindings())}async function captureKeybinding(e){if(!e.shiftKey&&!e.altKey&&!e.ctrlKey&&!e.metaKey)switch(e.key){case`Escape`:cancelEdit();return;case`Enter`:await saveKeybinding();return}y.value=F.fromEvent(e)}function cancelEdit(){_.value=!1,C.value=null,y.value=null}async function saveKeybinding(){C.value&&y.value&&a.updateKeybindingOnCommand(new V({commandId:C.value.id,combo:y.value}))&&await s.persistUserKeybindings(),cancelEdit()}async function resetKeybinding(e){a.resetKeybindingForCommand(e.id)?await s.persistUserKeybindings():console.warn(`No changes made when resetting keybinding for command: ${e.id}`)}let D=i();async function resetAllKeybindings(){a.resetAllKeybindings(),await s.persistUserKeybindings(),D.add({severity:`info`,summary:`Info`,detail:`All keybindings reset`,life:3e3})}return(e,i)=>{let o=te(`tooltip`);return r(),l(M,{value:`Keybinding`,class:`keybinding-panel`},{header:u(()=>[b(L,{modelValue:t.value.global.value,"onUpdate:modelValue":i[0]||=e=>t.value.global.value=e,placeholder:e.$t(`g.searchKeybindings`)+`...`},null,8,[`modelValue`,`placeholder`])]),default:u(()=>[b(v(oe),{selection:g.value,"onUpdate:selection":i[1]||=e=>g.value=e,value:f.value,"global-filter-fields":[`id`,`label`],filters:t.value,"selection-mode":`single`,"striped-rows":``,pt:{header:`px-0`},onRowDblclick:i[2]||=e=>editKeybinding(e.data)},{default:u(()=>[b(v(k),{field:`actions`,header:``},{body:u(t=>[h(`div`,K,[b(A,{variant:`textonly`,size:`icon`,"aria-label":e.$t(`g.edit`),onClick:e=>editKeybinding(t.data)},{default:u(()=>i[4]||=[h(`i`,{class:`pi pi-pencil`},null,-1)]),_:2},1032,[`aria-label`,`onClick`]),b(A,{variant:`textonly`,size:`icon`,"aria-label":e.$t(`g.reset`),disabled:!v(a).isCommandKeybindingModified(t.data.id),onClick:e=>resetKeybinding(t.data)},{default:u(()=>i[5]||=[h(`i`,{class:`pi pi-replay`},null,-1)]),_:2},1032,[`aria-label`,`disabled`,`onClick`]),b(A,{variant:`textonly`,size:`icon`,"aria-label":e.$t(`g.delete`),disabled:!t.data.keybinding,onClick:e=>removeKeybinding(t.data)},{default:u(()=>i[6]||=[h(`i`,{class:`pi pi-trash`},null,-1)]),_:2},1032,[`aria-label`,`disabled`,`onClick`])])]),_:1}),b(v(k),{field:`id`,header:e.$t(`g.command`),sortable:``,class:`max-w-64 2xl:max-w-full`},{body:u(e=>[h(`div`,{class:`truncate`,title:e.data.id},O(e.data.label),9,q)]),_:1},8,[`header`]),b(v(k),{field:`keybinding`,header:e.$t(`g.keybinding`)},{body:u(e=>[e.data.keybinding?(r(),l(G,{key:0,"key-combo":e.data.keybinding.combo,"is-modified":v(a).isCommandKeybindingModified(e.data.id)},null,8,[`key-combo`,`is-modified`])):(r(),x(`span`,J,`-`))]),_:1},8,[`header`]),b(v(k),{field:`source`,header:e.$t(`g.source`)},{body:u(e=>[h(`span`,Y,O(e.data.source||`-`),1)]),_:1},8,[`header`])]),_:1},8,[`selection`,`value`,`filters`]),b(v(ee),{visible:_.value,"onUpdate:visible":i[3]||=e=>_.value=e,class:`min-w-96`,modal:``,header:C.value?.label,onHide:cancelEdit},{footer:u(()=>[b(A,{variant:E.value?`destructive`:`primary`,autofocus:``,onClick:saveKeybinding},{default:u(()=>[h(`i`,{class:ae(E.value?`pi pi-pencil`:`pi pi-check`)},null,2),w(` `+O(E.value?e.$t(`g.overwrite`):e.$t(`g.save`)),1)]),_:1},8,[`variant`])]),default:u(()=>[h(`div`,null,[b(v(ie),{ref_key:`keybindingInput`,ref:T,class:`mb-2 text-center`,"model-value":y.value?.toString()??``,placeholder:e.$t(`g.pressKeysForNewBinding`),autocomplete:`off`,fluid:``,onKeydown:ne(captureKeybinding,[`stop`,`prevent`])},null,8,[`model-value`,`placeholder`]),E.value?(r(),l(v(se),{key:0,severity:`warn`},{default:u(()=>[w(O(e.$t(`g.keybindingAlreadyExists`))+` `,1),b(v(S),{severity:`secondary`,value:E.value.commandId},null,8,[`value`])]),_:1})):n(``,!0)])]),_:1},8,[`visible`,`header`]),ce((r(),l(A,{class:`mt-4 w-full`,variant:`destructive-textonly`,onClick:resetAllKeybindings},{default:u(()=>[i[7]||=h(`i`,{class:`pi pi-replay`},null,-1),w(` `+O(e.$t(`g.resetAll`)),1)]),_:1})),[[o,e.$t(`g.resetAllKeybindingsTooltip`)]])]),_:1})}}})})),Q=t((()=>{})),$;t((()=>{Z(),Z(),Q(),pe(),$=me(X,[[`__scopeId`,`data-v-06049058`]])}))();export{$ as default};
//# sourceMappingURL=KeybindingPanel-BWVYKqGa.js.map