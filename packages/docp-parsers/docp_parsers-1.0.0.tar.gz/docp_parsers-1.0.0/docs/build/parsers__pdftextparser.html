

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Base (Private) Module: parsers/_pdftextparser.py &mdash; docp-parsers - v1.0.0 Documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=03e43079" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
      <link rel="stylesheet" type="text/css" href="_static/css/s5defs-rules.css?v=0345028d" />

  
      <script src="_static/jquery.js?v=5d32c60e"></script>
      <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="_static/documentation_options.js?v=a12e3537"></script>
      <script src="_static/doctools.js?v=9bcbadda"></script>
      <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
      <script src="_static/clipboard.min.js?v=a7894cd8"></script>
      <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Base (Private) Module: parsers/_pptxbaseparser.py" href="parsers__pptxbaseparser.html" />
    <link rel="prev" title="Base (Private) Module: parsers/_pdftableparser.py" href="parsers__pdftableparser.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            docp-parsers
              <img src="_static/s3dev_tri_white_sm.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="library.html">Library API Documentation</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="library.html#use-cases">Use Cases</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="library.html#module-documentation">Module Documentation</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="parsers_pdfparser.html">Module: parsers/pdfparser.py</a></li>
<li class="toctree-l3"><a class="reference internal" href="parsers_pptxparser.html">Module: parsers/pptxparser.py</a></li>
<li class="toctree-l3"><a class="reference internal" href="objects_pdfobject.html">Module: objects/pdfobject.py</a></li>
<li class="toctree-l3"><a class="reference internal" href="objects_pptxobject.html">Module: objects/pptxobject.py</a></li>
<li class="toctree-l3"><a class="reference internal" href="parsers_putilities.html">Module: parsers/putilities.py</a></li>
<li class="toctree-l3"><a class="reference internal" href="objects__docbaseobject.html">Base (Private) Module: objects/_docbaseobject.py</a></li>
<li class="toctree-l3"><a class="reference internal" href="objects__pageobject.html">Base (Private) Module: objects/_pageobject.py</a></li>
<li class="toctree-l3"><a class="reference internal" href="objects__slideobject.html">Base (Private) Module: objects/_slideobject.py</a></li>
<li class="toctree-l3"><a class="reference internal" href="parsers__pdfbaseparser.html">Base (Private) Module: parsers/_pdfbaseparser.py</a></li>
<li class="toctree-l3"><a class="reference internal" href="parsers__pdftableparser.html">Base (Private) Module: parsers/_pdftableparser.py</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Base (Private) Module: parsers/_pdftextparser.py</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#docp_parsers.parsers._pdftextparser._PDFTextParser"><code class="docutils literal notranslate"><span class="pre">_PDFTextParser</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="parsers__pptxbaseparser.html">Base (Private) Module: parsers/_pptxbaseparser.py</a></li>
<li class="toctree-l3"><a class="reference internal" href="parsers__pptxtextparser.html">Base (Private) Module: parsers/_pptxtextparser.py</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="changelog.html">Change Log</a></li>
<li class="toctree-l1"><a class="reference internal" href="contact.html">Contact Us</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">docp-parsers</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="library.html">Library API Documentation</a></li>
      <li class="breadcrumb-item active">Base (Private) Module: parsers/_pdftextparser.py</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="module-docp_parsers.parsers._pdftextparser">
<span id="base-private-module-parsers-pdftextparser-py"></span><h1>Base (Private) Module: parsers/_pdftextparser.py<a class="headerlink" href="#module-docp_parsers.parsers._pdftextparser" title="Link to this heading"></a></h1>
<dl class="field-list simple">
<dt class="field-odd">Purpose<span class="colon">:</span></dt>
<dd class="field-odd"><p>This module provides the logic for parsing text from a PDF
document.</p>
</dd>
<dt class="field-even">Platform<span class="colon">:</span></dt>
<dd class="field-even"><p>Linux/Windows | Python 3.11+</p>
</dd>
<dt class="field-odd">Developer<span class="colon">:</span></dt>
<dd class="field-odd"><p>J Berendt</p>
</dd>
<dt class="field-even">Email<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="mailto:development&#37;&#52;&#48;s3dev&#46;uk">development<span>&#64;</span>s3dev<span>&#46;</span>uk</a></p>
</dd>
</dl>
<div class="admonition attention">
<p class="admonition-title">Attention</p>
<p>This module is <em>not</em> designed to be interacted with
directly, only via the appropriate interface class(es).</p>
<p>Rather, please create an instance of a PDF document parsing
object using the following:</p>
<blockquote>
<div><ul class="simple">
<li><p><a class="reference internal" href="parsers_pdfparser.html#docp_parsers.parsers.pdfparser.PDFParser" title="docp_parsers.parsers.pdfparser.PDFParser"><code class="xref py py-class docutils literal notranslate"><span class="pre">PDFParser</span></code></a></p></li>
</ul>
</div></blockquote>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><strong>Multi-processing</strong></p>
<p>Text extraction through multi-processing has been tested and
is not feasible due to an error indicating
the <code class="docutils literal notranslate"><span class="pre">pdfplumber.page.Page</span></code> object can not be pickled. This
object was being passed into the extraction method as the
object contains the <code class="xref py py-func docutils literal notranslate"><span class="pre">extract_text()</span></code> function.</p>
<p>Additionally, multi-threading has also been tested and
it was determined to be too complex and inefficient. This was
tested using the <code class="docutils literal notranslate"><span class="pre">concurrent.futures.ThreadPoolExecutor</span></code>
class and two documents, 14 and 92 pages; the timings are
shown below. The multi-threaded approach took longer to
process and added unnecessary complexity to the code base.
As a side-effect, the pages are processed and stored out of
order which would require a re-order, adding more complexity.</p>
<p>It has therefore been determined that this module will remain
single-threaded.</p>
<p><strong>Multi-Thread Timings</strong></p>
<blockquote>
<div><ul class="simple">
<li><p><strong>Single-threaded:</strong></p>
<ul>
<li><p>14 page document: ~2 seconds</p></li>
<li><p>92 page document: ~32 seconds</p></li>
</ul>
</li>
<li><p><strong>Multi-threaded:</strong></p>
<ul>
<li><p>14 page document: ~2 seconds</p></li>
<li><p>92 page document: ~35 seconds</p></li>
</ul>
</li>
</ul>
</div></blockquote>
</div>
<dl class="py class">
<dt class="sig sig-object py" id="docp_parsers.parsers._pdftextparser._PDFTextParser">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">_PDFTextParser</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/docp_parsers/parsers/_pdftextparser.html#_PDFTextParser"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#docp_parsers.parsers._pdftextparser._PDFTextParser" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="parsers__pdfbaseparser.html#docp_parsers.parsers._pdfbaseparser._PDFBaseParser" title="docp_parsers.parsers._pdfbaseparser._PDFBaseParser"><code class="xref py py-class docutils literal notranslate"><span class="pre">_PDFBaseParser</span></code></a></p>
<p>Private PDF document text parser intermediate class.</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>path</strong> (<em>str</em>) – Full path to the PDF document.</p>
</dd>
<dt class="field-even">Example<span class="colon">:</span></dt>
<dd class="field-even"><p>Extract text from a PDF file:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">docp_parsers</span><span class="w"> </span><span class="kn">import</span> <span class="n">PDFParser</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">pdf</span> <span class="o">=</span> <span class="n">PDFParser</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="s1">&#39;/path/to/myfile.pdf&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pdf</span><span class="o">.</span><span class="n">extract_text</span><span class="p">()</span>

<span class="go"># Access the content of page 1.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pg1</span> <span class="o">=</span> <span class="n">pdf</span><span class="o">.</span><span class="n">doc</span><span class="o">.</span><span class="n">pages</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">content</span>
</pre></div>
</div>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="docp_parsers.parsers._pdftextparser._PDFTextParser.extract_text">
<span class="sig-name descname"><span class="pre">extract_text</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">remove_header</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">remove_footer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">remove_newlines</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ignore_tags</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">set</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">convert_to_ascii</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_tolerance</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_tolerance</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/docp_parsers/parsers/_pdftextparser.html#_PDFTextParser.extract_text"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#docp_parsers.parsers._pdftextparser._PDFTextParser.extract_text" title="Link to this definition"></a></dt>
<dd><p>Extract text from the document.</p>
<p>If the PDF document contains ‘marked content’ tags, these tags
are used to extract the text as this is a more accurate approach
and respects the structure of the page(s). Otherwise, a bounding
box method is used to extract the text. If instructed, the
header and/or footer regions can be excluded.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>If a tag-based extract is used, the header/footer should be
automatically excluded as these will often have an ‘Artifact’
tag, which is excluded by default, by passing
<code class="docutils literal notranslate"><span class="pre">ignore_tags=None</span></code>.</p>
<p>To <em>keep</em> the header and footer, pass <code class="docutils literal notranslate"><span class="pre">ignore_tags='na'</span></code>.</p>
</div>
<p>A list of pages, with extracted content can be accessed using
the <code class="xref py py-attr docutils literal notranslate"><span class="pre">self.doc.pages</span></code> attribute.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p><strong>Alldocumenttextisrunningtogether</strong></p>
<p>When examining the parsed content, e.g.:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pdf</span><span class="o">.</span><span class="n">doc</span><span class="o">.</span><span class="n">pages</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">content</span>
</pre></div>
</div>
<p>and you observe alltexthasbeenruntogether, this is a sign
that marked content tags were not available for processing,
so OCR was employed.</p>
<p>To add separation to the words, the <code class="docutils literal notranslate"><span class="pre">x_tolerance</span></code> keyword
argument can be passed in with a value &lt; 3 (as the default
value is 3). For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pdf</span><span class="o">.</span><span class="n">extract_text</span><span class="p">(</span><span class="n">x_tolerance</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
<p>Re-examine the parsed content and the words should now be
separated.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>remove_header</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, the header is
cropped (skipped) from text extraction. This only applies
to the bounding box extraction method. Defaults to False.</p></li>
<li><p><strong>remove_footer</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, the footer is
cropped (skipped) from text extraction. This only applies
to the bounding box extraction method. Defaults to False.</p></li>
<li><p><strong>remove_newlines</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, the newline
characters are replaced with a space. Defaults to False.</p></li>
<li><p><strong>ignore_tags</strong> (<em>set</em><em>, </em><em>optional</em>) – If provided, these are the
PDF ‘marked content’ tags which will be ignored. Note
that the PDF document must contain tags, otherwise the
bounding box method is used and this argument is ignored.
Defaults to <code class="docutils literal notranslate"><span class="pre">{'Artifact'}</span></code>, as these generally
relate to a header and/or footer. To include all tags,
(not skip any) pass this argument as <code class="docutils literal notranslate"><span class="pre">'na'</span></code>.</p></li>
<li><p><strong>convert_to_ascii</strong> (<em>bool</em><em>, </em><em>optional</em>) – When a non-ASCII character
is found, an attempt is made to convert it to an
associated ASCII character. If a character cannot be
converted, it is replaced with a <code class="docutils literal notranslate"><span class="pre">'?'</span></code>.
Defaults to True.</p></li>
<li><p><strong>x_tolerance</strong> (<em>int</em><em>, </em><em>optional</em>) – Adds space where the difference
between x1 of one character and the x0 of the next
character is greater than x_tolerance. Defaults to 3.</p></li>
<li><p><strong>y_tolerance</strong> (<em>int</em><em>, </em><em>optional</em>) – Adds space where the difference
between y1 of one character and the y0 of the next
character is greater than y_tolerance. Defaults to 3.</p></li>
</ul>
</dd>
<dt class="field-even">Keyword Args<span class="colon">:</span></dt>
<dd class="field-even"><p>Keyword <a class="reference external" href="https://github.com/jsvine/pdfplumber#the-pdfplumberpage-class">args_txt</a> to be passed directly into
<code class="docutils literal notranslate"><span class="pre">pdfplumber</span></code>’s <code class="docutils literal notranslate"><span class="pre">.extract_text</span></code> method.</p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>None.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="docp_parsers.parsers._pdftextparser._PDFTextParser._extract_text_using_bbox">
<span class="sig-name descname"><span class="pre">_extract_text_using_bbox</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/docp_parsers/parsers/_pdftextparser.html#_PDFTextParser._extract_text_using_bbox"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#docp_parsers.parsers._pdftextparser._PDFTextParser._extract_text_using_bbox" title="Link to this definition"></a></dt>
<dd><p>Extract text using a bbox for finding the header and footer.</p>
<dl class="field-list simple">
<dt class="field-odd">Keyword Arguments<span class="colon">:</span></dt>
<dd class="field-odd"><p>Those passed by the caller (<a class="reference internal" href="#docp_parsers.parsers._pdftextparser._PDFTextParser.extract_text" title="docp_parsers.parsers._pdftextparser._PDFTextParser.extract_text"><code class="xref py py-meth docutils literal notranslate"><span class="pre">extract_text()</span></code></a>) to be
passed directly into the underlying <code class="docutils literal notranslate"><span class="pre">.extract_text</span></code> method.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="docp_parsers.parsers._pdftextparser._PDFTextParser._extract_text_using_tags">
<span class="sig-name descname"><span class="pre">_extract_text_using_tags</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/docp_parsers/parsers/_pdftextparser.html#_PDFTextParser._extract_text_using_tags"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#docp_parsers.parsers._pdftextparser._PDFTextParser._extract_text_using_tags" title="Link to this definition"></a></dt>
<dd><p>Extract text using tags.</p>
<p>The tags defined by the <code class="docutils literal notranslate"><span class="pre">ignore_tags</span></code> are skipped.</p>
<dl class="field-list simple">
<dt class="field-odd">Keyword Arguments<span class="colon">:</span></dt>
<dd class="field-odd"><p>Those passed by the caller, <a class="reference internal" href="#docp_parsers.parsers._pdftextparser._PDFTextParser.extract_text" title="docp_parsers.parsers._pdftextparser._PDFTextParser.extract_text"><code class="xref py py-meth docutils literal notranslate"><span class="pre">extract_text()</span></code></a>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="docp_parsers.parsers._pdftextparser._PDFTextParser._text_from_tags">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">_text_from_tags</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">page</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">pdfplumber.page.Page</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ignored</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">set</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="reference internal" href="_modules/docp_parsers/parsers/_pdftextparser.html#_PDFTextParser._text_from_tags"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#docp_parsers.parsers._pdftextparser._PDFTextParser._text_from_tags" title="Link to this definition"></a></dt>
<dd><p>Generate a page of text extracted from tags.</p>
<p>When extracting text from tags, newlines are not encoded and must
be derived. For each character on the page, the top and bottom
coordinates are compared to determine when a newline should be
inserted. If both the top and bottom of the current character
are greater than the previous character, a newline is inserted
into the text stream.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>page</strong> (<em>pdfplumber.page.Page</em>) – Page to be parsed.</p></li>
<li><p><strong>ignored</strong> (<em>set</em>) – A set containing the tags to be ignored.</p></li>
</ul>
</dd>
<dt class="field-even">Yields<span class="colon">:</span></dt>
<dd class="field-even"><p><em>str</em> – Each character on the page, providing its tag is not to
be ignored. Or, a newline character if the current
character’s coordinates are greater than (lower on the page)
than the previous character.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="docp_parsers.parsers._pdftextparser._PDFTextParser._uses_marked_content">
<span class="sig-name descname"><span class="pre">_uses_marked_content</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">bool</span></span></span><a class="reference internal" href="_modules/docp_parsers/parsers/_pdftextparser.html#_PDFTextParser._uses_marked_content"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#docp_parsers.parsers._pdftextparser._PDFTextParser._uses_marked_content" title="Link to this definition"></a></dt>
<dd><p>Test whether the document can be parsed using tags.</p>
<p>Marked content allows us to parse the PDF using tags (rather than
OCR) which is more accurate not only in terms of character
recognition, but also with regard to the structure of the text on
a page.</p>
<dl class="field-list">
<dt class="field-odd">Logic<span class="colon">:</span></dt>
<dd class="field-odd"><p>If the document’s catalog shows <code class="docutils literal notranslate"><span class="pre">Marked:</span> <span class="pre">True</span></code>, then
<code class="docutils literal notranslate"><span class="pre">True</span></code> is returned immediately.</p>
<p>Otherwise, a second attempt is made which detects marked
content tags on the first three pages. If no tags are found,
a third attempt is made by searching the first 10 pages. If
tags are found during either of these attempts, <code class="docutils literal notranslate"><span class="pre">True</span></code> is
returned immediately.</p>
<p>Finally, if no marked content or tags were found, <code class="docutils literal notranslate"><span class="pre">False</span></code>
is returned.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Returns True if the document can be parsed using marked
content tags, otherwise False.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="docp_parsers.parsers._pdftextparser._PDFTextParser._get_crop_coordinates">
<span class="sig-name descname"><span class="pre">_get_crop_coordinates</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">skip_header</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">skip_footer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#docp_parsers.parsers._pdftextparser._PDFTextParser._get_crop_coordinates" title="Link to this definition"></a></dt>
<dd><p>Determine the bounding box coordinates.</p>
<p>These coordinates are used for removing the header and/or footer.</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>skip_header</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, set the coordinates
such that the header is skipped. Defaults to False.</p></li>
<li><p><strong>skip_footer</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, set the coordinates
such that the footer is skipped. Defaults to False.</p></li>
</ul>
</dd>
<dt class="field-even">Logic<span class="colon">:</span></dt>
<dd class="field-even"><p>When excluding a header and/or footer, the following page
numbers are used for header/footer <em>position</em> detection,
given the length of the document:</p>
<blockquote>
<div><ul class="simple">
<li><p>Number of pages [1]: 1</p></li>
<li><p>Number of pages [2,10]: 2</p></li>
<li><p>Number of pages [11,]: 5</p></li>
</ul>
</div></blockquote>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><p>A bounding box tuple of the following form, to be
passed directly into the <code class="xref py py-func docutils literal notranslate"><span class="pre">Page.crop()</span></code> method:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">top</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">bottom</span><span class="p">)</span>
</pre></div>
</div>
</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="docp_parsers.parsers._pdftextparser._PDFTextParser._open">
<span class="sig-name descname"><span class="pre">_open</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#docp_parsers.parsers._pdftextparser._PDFTextParser._open" title="Link to this definition"></a></dt>
<dd><p>Open the PDF document for reading.</p>
<p>Before opening the file, a test is performed to ensure the PDF
is valid. The file must:</p>
<blockquote>
<div><ul class="simple">
<li><p>exist</p></li>
<li><p>be a valid PDF file, per the file signature</p></li>
<li><p>have a .pdf file extension</p></li>
</ul>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Other Operations<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p>Store the <code class="docutils literal notranslate"><span class="pre">pdfplumber</span></code> parser object returned from the
<code class="xref py py-func docutils literal notranslate"><span class="pre">pdfplumber.open()</span></code> function into the
<code class="xref py py-attr docutils literal notranslate"><span class="pre">doc.parser</span></code> attribute.</p></li>
<li><p>Store the number of pages into the
<code class="xref py py-attr docutils literal notranslate"><span class="pre">doc.npages</span></code> attribute.</p></li>
<li><p>Store the document’s meta data into the
<code class="xref py py-attr docutils literal notranslate"><span class="pre">doc.metadata</span></code> attribute.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>TypeError</strong> – Raised if the file type criteria above are not
    met.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="docp_parsers.parsers._pdftextparser._PDFTextParser._prepare_row">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">_prepare_row</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">row</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="headerlink" href="#docp_parsers.parsers._pdftextparser._PDFTextParser._prepare_row" title="Link to this definition"></a></dt>
<dd><p>Prepare a table row for writing to a CSV file.</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>row</strong> (<em>list</em>) – A list of strings, constituting a table row.</p>
</dd>
<dt class="field-even">Processing Tasks<span class="colon">:</span></dt>
<dd class="field-even"><p>For each element in the row:</p>
<blockquote>
<div><ul class="simple">
<li><p>Remove any double quote characters (ASCII and Unicode).</p></li>
<li><p>Replace any empty values with <code class="docutils literal notranslate"><span class="pre">'None'</span></code>.</p></li>
<li><p>If the element contains a comma, wrap the element in
double quotes.</p></li>
<li><p>Attempt to convert any non-ASCII characters to an
associated ASCII character. If the replacement cannot
be made, the character is replaced with a <code class="docutils literal notranslate"><span class="pre">'?'</span></code>.</p></li>
</ul>
</div></blockquote>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A processed comma-separated string, ready to be written
to a CSV file.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="docp_parsers.parsers._pdftextparser._PDFTextParser._scan_common">
<span class="sig-name descname"><span class="pre">_scan_common</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#docp_parsers.parsers._pdftextparser._PDFTextParser._scan_common" title="Link to this definition"></a></dt>
<dd><p>Scan the PDF document to find the most common lines.</p>
<dl class="field-list">
<dt class="field-odd">Rationale<span class="colon">:</span></dt>
<dd class="field-odd"><p>Generally, the most common lines in a document will be the
header and footer, as these are expected to be repeated on
each page of the document.</p>
<p>‘Most common’ is defined as line occurring on 90% of the
pages throughout the document. Therefore, only documents with
more than three pages are scanned. Otherwise, the 90% may
exclude relevant pieces of the document (as was discovered in
testing).</p>
</dd>
<dt class="field-even">Logic<span class="colon">:</span></dt>
<dd class="field-even"><p>For documents with more than three pages, the entire PDF is
read through and each line extracted. The occurrence of each
line is counted, with the most common occurrences returned
to the caller.</p>
<p>The returned lines are to be passed into a page search to
determine the x/y coordinates of the header and footer.</p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>For documents with more than three pages, a list
containing the most common lines in the document. Otherwise,
an empty list if returned.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="docp_parsers.parsers._pdftextparser._PDFTextParser._set_paths">
<span class="sig-name descname"><span class="pre">_set_paths</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#docp_parsers.parsers._pdftextparser._PDFTextParser._set_paths" title="Link to this definition"></a></dt>
<dd><p>Set the document’s file path attributes.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="docp_parsers.parsers._pdftextparser._PDFTextParser.doc">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">doc</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="objects_pdfobject.html#docp_parsers.objects.pdfobject.DocPDF" title="docp_parsers.objects.pdfobject.DocPDF"><span class="pre">DocPDF</span></a></em><a class="headerlink" href="#docp_parsers.parsers._pdftextparser._PDFTextParser.doc" title="Link to this definition"></a></dt>
<dd><p>Accessor to the document object.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="docp_parsers.parsers._pdftextparser._PDFTextParser.pages">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">pages</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">list</span></em><a class="headerlink" href="#docp_parsers.parsers._pdftextparser._PDFTextParser.pages" title="Link to this definition"></a></dt>
<dd><p>Accessor to the PDF’s page objects.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="docp_parsers.parsers._pdftextparser._PDFTextParser.tables">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">tables</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">list</span></em><a class="headerlink" href="#docp_parsers.parsers._pdftextparser._PDFTextParser.tables" title="Link to this definition"></a></dt>
<dd><p>Accessor to the PDF’s table objects.</p>
</dd></dl>

</dd></dl>

</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="parsers__pdftableparser.html" class="btn btn-neutral float-left" title="Base (Private) Module: parsers/_pdftableparser.py" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="parsers__pptxbaseparser.html" class="btn btn-neutral float-right" title="Base (Private) Module: parsers/_pptxbaseparser.py" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025-2026 | s3dev | version 1.0.0.</p>
  </div>

   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>