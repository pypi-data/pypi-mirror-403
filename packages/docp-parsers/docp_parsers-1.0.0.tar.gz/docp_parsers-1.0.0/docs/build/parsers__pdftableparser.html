

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Base (Private) Module: parsers/_pdftableparser.py &mdash; docp-parsers - v1.0.0 Documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=03e43079" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
      <link rel="stylesheet" type="text/css" href="_static/css/s5defs-rules.css?v=0345028d" />

  
      <script src="_static/jquery.js?v=5d32c60e"></script>
      <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="_static/documentation_options.js?v=a12e3537"></script>
      <script src="_static/doctools.js?v=9bcbadda"></script>
      <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
      <script src="_static/clipboard.min.js?v=a7894cd8"></script>
      <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Base (Private) Module: parsers/_pdftextparser.py" href="parsers__pdftextparser.html" />
    <link rel="prev" title="Base (Private) Module: parsers/_pdfbaseparser.py" href="parsers__pdfbaseparser.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            docp-parsers
              <img src="_static/s3dev_tri_white_sm.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="library.html">Library API Documentation</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="library.html#use-cases">Use Cases</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="library.html#module-documentation">Module Documentation</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="parsers_pdfparser.html">Module: parsers/pdfparser.py</a></li>
<li class="toctree-l3"><a class="reference internal" href="parsers_pptxparser.html">Module: parsers/pptxparser.py</a></li>
<li class="toctree-l3"><a class="reference internal" href="objects_pdfobject.html">Module: objects/pdfobject.py</a></li>
<li class="toctree-l3"><a class="reference internal" href="objects_pptxobject.html">Module: objects/pptxobject.py</a></li>
<li class="toctree-l3"><a class="reference internal" href="parsers_putilities.html">Module: parsers/putilities.py</a></li>
<li class="toctree-l3"><a class="reference internal" href="objects__docbaseobject.html">Base (Private) Module: objects/_docbaseobject.py</a></li>
<li class="toctree-l3"><a class="reference internal" href="objects__pageobject.html">Base (Private) Module: objects/_pageobject.py</a></li>
<li class="toctree-l3"><a class="reference internal" href="objects__slideobject.html">Base (Private) Module: objects/_slideobject.py</a></li>
<li class="toctree-l3"><a class="reference internal" href="parsers__pdfbaseparser.html">Base (Private) Module: parsers/_pdfbaseparser.py</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Base (Private) Module: parsers/_pdftableparser.py</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#docp_parsers.parsers._pdftableparser._PDFTableParser"><code class="docutils literal notranslate"><span class="pre">_PDFTableParser</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="parsers__pdftextparser.html">Base (Private) Module: parsers/_pdftextparser.py</a></li>
<li class="toctree-l3"><a class="reference internal" href="parsers__pptxbaseparser.html">Base (Private) Module: parsers/_pptxbaseparser.py</a></li>
<li class="toctree-l3"><a class="reference internal" href="parsers__pptxtextparser.html">Base (Private) Module: parsers/_pptxtextparser.py</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="changelog.html">Change Log</a></li>
<li class="toctree-l1"><a class="reference internal" href="contact.html">Contact Us</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">docp-parsers</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="library.html">Library API Documentation</a></li>
      <li class="breadcrumb-item active">Base (Private) Module: parsers/_pdftableparser.py</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="module-docp_parsers.parsers._pdftableparser">
<span id="base-private-module-parsers-pdftableparser-py"></span><h1>Base (Private) Module: parsers/_pdftableparser.py<a class="headerlink" href="#module-docp_parsers.parsers._pdftableparser" title="Link to this heading"></a></h1>
<dl class="field-list simple">
<dt class="field-odd">Purpose<span class="colon">:</span></dt>
<dd class="field-odd"><p>This module provides the logic for parsing tables from a PDF
document.</p>
</dd>
<dt class="field-even">Platform<span class="colon">:</span></dt>
<dd class="field-even"><p>Linux</p>
</dd>
<dt class="field-odd">Developer<span class="colon">:</span></dt>
<dd class="field-odd"><p>J Berendt</p>
</dd>
<dt class="field-even">Email<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="mailto:jeremy&#46;berendt&#37;&#52;&#48;rolls-royce&#46;com">jeremy<span>&#46;</span>berendt<span>&#64;</span>rolls-royce<span>&#46;</span>com</a></p>
</dd>
</dl>
<div class="admonition attention">
<p class="admonition-title">Attention</p>
<p>This module is <em>not</em> designed to be interacted with
directly, only via the appropriate interface class(es).</p>
<p>Rather, please create an instance of a PDF document parsing
object using the following:</p>
<blockquote>
<div><ul class="simple">
<li><p><a class="reference internal" href="parsers_pdfparser.html#docp_parsers.parsers.pdfparser.PDFParser" title="docp_parsers.parsers.pdfparser.PDFParser"><code class="xref py py-class docutils literal notranslate"><span class="pre">PDFParser</span></code></a></p></li>
</ul>
</div></blockquote>
</div>
<dl class="py class">
<dt class="sig sig-object py" id="docp_parsers.parsers._pdftableparser._PDFTableParser">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">_PDFTableParser</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/docp_parsers/parsers/_pdftableparser.html#_PDFTableParser"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#docp_parsers.parsers._pdftableparser._PDFTableParser" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="parsers__pdfbaseparser.html#docp_parsers.parsers._pdfbaseparser._PDFBaseParser" title="docp_parsers.parsers._pdfbaseparser._PDFBaseParser"><code class="xref py py-class docutils literal notranslate"><span class="pre">_PDFBaseParser</span></code></a></p>
<p>Private PDF document table parser intermediate class.</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>path</strong> (<em>str</em>) – Full path to the PDF document.</p>
</dd>
<dt class="field-even">Example<span class="colon">:</span></dt>
<dd class="field-even"><p>Extract tables from a PDF file:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">docp_parsers</span><span class="w"> </span><span class="kn">import</span> <span class="n">PDFParser</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">pdf</span> <span class="o">=</span> <span class="n">PDFParser</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="s1">&#39;/path/to/myfile.pdf&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pdf</span><span class="o">.</span><span class="n">extract_tables</span><span class="p">()</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">tables</span> <span class="o">=</span> <span class="n">pdf</span><span class="o">.</span><span class="n">doc</span><span class="o">.</span><span class="n">tables</span>
</pre></div>
</div>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="docp_parsers.parsers._pdftableparser._PDFTableParser.extract_tables">
<span class="sig-name descname"><span class="pre">extract_tables</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">table_settings</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">as_dataframe</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">to_csv</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/docp_parsers/parsers/_pdftableparser.html#_PDFTableParser.extract_tables"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#docp_parsers.parsers._pdftableparser._PDFTableParser.extract_tables" title="Link to this definition"></a></dt>
<dd><p>Extract tables from the document.</p>
<p>Before a table is extracted, a number of validation tests are
performed to verify what has been identified as a ‘table’ is
actually a table which might be useful to the user.</p>
<p>Each ‘valid’ table is written as a CSV file on the user’s
desktop.</p>
<p>Additionally, the extracted table data is stored to the class’
<a class="reference internal" href="#docp_parsers.parsers._pdftableparser._PDFTableParser.tables" title="docp_parsers.parsers._pdftableparser._PDFTableParser.tables"><code class="xref py py-attr docutils literal notranslate"><span class="pre">tables</span></code></a> attribute.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>table_settings</strong> (<em>dict</em><em>, </em><em>optional</em>) – Table settings to be used
for the table extraction. Defaults to None, which is
replaced by the value in the config.</p></li>
<li><p><strong>as_dataframe</strong> (<em>bool</em><em>, </em><em>optional</em>) – By default, the extracted
tables are returned as a list of (lists of lists), for
example: all_tables[table[rows[data]]]. However, if this
argument is <code class="docutils literal notranslate"><span class="pre">True</span></code>, the table data is returned as a
list of <code class="docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code> objects. In this case, the
first row of the table is used as the header, and all
remaining rows are treated as data. <strong>Note:</strong> This will
<em>not</em> work properly for all tables. Defaults to False.</p></li>
<li><p><strong>to_csv</strong> (<em>bool</em><em>, </em><em>optional</em>) – Dump extracted table data to a CSV
file, one per table. Defaults to True.</p></li>
<li><p><strong>verbose</strong> (<em>bool</em><em>, </em><em>optional</em>) – Display how many tables were
extracted, and the path to their location.</p></li>
</ul>
</dd>
<dt class="field-even">Keyword Args<span class="colon">:</span></dt>
<dd class="field-even"><p>Additional keyword <a class="reference external" href="https://github.com/jsvine/pdfplumber?tab=readme-ov-file#table-extraction-settings">args_tbl</a> to be added to the
<code class="docutils literal notranslate"><span class="pre">table_settings</span></code> argument of <code class="docutils literal notranslate"><span class="pre">pdfplumber</span></code>’s
<code class="xref py py-func docutils literal notranslate"><span class="pre">extract_table()</span></code> method.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="docp_parsers.parsers._pdftableparser._PDFTableParser._create_table_directory_path">
<span class="sig-name descname"><span class="pre">_create_table_directory_path</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/docp_parsers/parsers/_pdftableparser.html#_PDFTableParser._create_table_directory_path"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#docp_parsers.parsers._pdftableparser._PDFTableParser._create_table_directory_path" title="Link to this definition"></a></dt>
<dd><p>Create the output directory for table data.</p>
<p>If the directory does not exist, it is created.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="docp_parsers.parsers._pdftableparser._PDFTableParser._create_table_file_path">
<span class="sig-name descname"><span class="pre">_create_table_file_path</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pageno</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tblno</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="reference internal" href="_modules/docp_parsers/parsers/_pdftableparser.html#_PDFTableParser._create_table_file_path"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#docp_parsers.parsers._pdftableparser._PDFTableParser._create_table_file_path" title="Link to this definition"></a></dt>
<dd><p>Create the filename for the table.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pageno</strong> (<em>int</em>) – Page from which the table was extracted.</p></li>
<li><p><strong>tblno</strong> (<em>int</em>) – Number of the table on the page, starting at 1.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Explicit path to the file to be written.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="docp_parsers.parsers._pdftableparser._PDFTableParser._filter_tables">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">_filter_tables</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tables</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">5000</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">list</span></span></span><a class="reference internal" href="_modules/docp_parsers/parsers/_pdftableparser.html#_PDFTableParser._filter_tables"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#docp_parsers.parsers._pdftableparser._PDFTableParser._filter_tables" title="Link to this definition"></a></dt>
<dd><p>Remove tables from the passed list which are deemed invalid.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tables</strong> (<em>list</em>) – A list of tables as detected by the
<code class="xref py py-meth docutils literal notranslate"><span class="pre">Page.find_table()</span></code> method.</p></li>
<li><p><strong>threshold</strong> (<em>int</em><em>, </em><em>optional</em>) – Minimum pixel area for a detected
table to be returned. Defaults to 5000.</p></li>
</ul>
</dd>
<dt class="field-even">Rationale<span class="colon">:</span></dt>
<dd class="field-even"><p>An ‘invalid’ table is determined by the number of pixels
which the table covered. Any table which is less than (N)
pixels is likely a block of text which has been categorised
as a ‘table’, but is not.</p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A list of tables whose pixel area is greater than
<code class="docutils literal notranslate"><span class="pre">threshold</span></code>.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="docp_parsers.parsers._pdftableparser._PDFTableParser._table_header_footer">
<span class="sig-name descname"><span class="pre">_table_header_footer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">table</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">list</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">bool</span></span></span><a class="reference internal" href="_modules/docp_parsers/parsers/_pdftableparser.html#_PDFTableParser._table_header_footer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#docp_parsers.parsers._pdftableparser._PDFTableParser._table_header_footer" title="Link to this definition"></a></dt>
<dd><p>Verify a table is not a header or footer.</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>table</strong> (<em>list</em><em>[</em><em>list</em><em>]</em>) – Table (a list of lists) be a analysed.</p>
</dd>
<dt class="field-even">Rationale<span class="colon">:</span></dt>
<dd class="field-even"><p>A table is determined to be a header or footer if any of the
line contained in the ‘common lines list’ are found in the
table.</p>
<p>If any of these lines are found, the table is determined to
be a header/footer, True is returned.</p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>False if the table is <em>not</em> a header/footer, otherwise
True.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="docp_parsers.parsers._pdftableparser._PDFTableParser._to_buffer">
<span class="sig-name descname"><span class="pre">_to_buffer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">list</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">StringIO</span></span></span><a class="reference internal" href="_modules/docp_parsers/parsers/_pdftableparser.html#_PDFTableParser._to_buffer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#docp_parsers.parsers._pdftableparser._PDFTableParser._to_buffer" title="Link to this definition"></a></dt>
<dd><p>Write the table data into a string buffer.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>data</strong> (<em>list</em><em>[</em><em>list</em><em>]</em>) – The table data as a list of lists to be
written to a buffer.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A string buffer as an <code class="docutils literal notranslate"><span class="pre">io.StringIO</span></code> object.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>io.StringIO</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="docp_parsers.parsers._pdftableparser._PDFTableParser._to_csv">
<span class="sig-name descname"><span class="pre">_to_csv</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">buffer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">StringIO</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pageno</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tableno</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">int</span></span></span><a class="reference internal" href="_modules/docp_parsers/parsers/_pdftableparser.html#_PDFTableParser._to_csv"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#docp_parsers.parsers._pdftableparser._PDFTableParser._to_csv" title="Link to this definition"></a></dt>
<dd><p>Write a table (from the buffer) to CSV.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>buffer</strong> (<em>io.StringIO</em>) – A pre-processed <code class="docutils literal notranslate"><span class="pre">StringIO</span></code> object
containing table data to be written.</p></li>
<li><p><strong>pageno</strong> (<em>int</em>) – Page number from the <code class="docutils literal notranslate"><span class="pre">Page</span></code> object.</p></li>
<li><p><strong>tableno</strong> (<em>int</em>) – Number of the table on the page, based at 1.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>1 if the file was written, otherwise 0. This is used by
the caller to track the number of CSV files written.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="docp_parsers.parsers._pdftableparser._PDFTableParser._to_df">
<span class="sig-name descname"><span class="pre">_to_df</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">buffer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">StringIO</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/docp_parsers/parsers/_pdftableparser.html#_PDFTableParser._to_df"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#docp_parsers.parsers._pdftableparser._PDFTableParser._to_df" title="Link to this definition"></a></dt>
<dd><p>Write a table (from the buffer) to a DataFrame.</p>
<p>Once written, the DataFrame is appended to
<code class="xref py py-attr docutils literal notranslate"><span class="pre">doc.tables</span></code> list of tables.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>buffer</strong> (<em>io.StringIO</em>) – A pre-processed <code class="docutils literal notranslate"><span class="pre">StringIO</span></code> object
containing table data to be written.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="docp_parsers.parsers._pdftableparser._PDFTableParser._get_crop_coordinates">
<span class="sig-name descname"><span class="pre">_get_crop_coordinates</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">skip_header</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">skip_footer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#docp_parsers.parsers._pdftableparser._PDFTableParser._get_crop_coordinates" title="Link to this definition"></a></dt>
<dd><p>Determine the bounding box coordinates.</p>
<p>These coordinates are used for removing the header and/or footer.</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>skip_header</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, set the coordinates
such that the header is skipped. Defaults to False.</p></li>
<li><p><strong>skip_footer</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, set the coordinates
such that the footer is skipped. Defaults to False.</p></li>
</ul>
</dd>
<dt class="field-even">Logic<span class="colon">:</span></dt>
<dd class="field-even"><p>When excluding a header and/or footer, the following page
numbers are used for header/footer <em>position</em> detection,
given the length of the document:</p>
<blockquote>
<div><ul class="simple">
<li><p>Number of pages [1]: 1</p></li>
<li><p>Number of pages [2,10]: 2</p></li>
<li><p>Number of pages [11,]: 5</p></li>
</ul>
</div></blockquote>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><p>A bounding box tuple of the following form, to be
passed directly into the <code class="xref py py-func docutils literal notranslate"><span class="pre">Page.crop()</span></code> method:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">top</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">bottom</span><span class="p">)</span>
</pre></div>
</div>
</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="docp_parsers.parsers._pdftableparser._PDFTableParser._open">
<span class="sig-name descname"><span class="pre">_open</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#docp_parsers.parsers._pdftableparser._PDFTableParser._open" title="Link to this definition"></a></dt>
<dd><p>Open the PDF document for reading.</p>
<p>Before opening the file, a test is performed to ensure the PDF
is valid. The file must:</p>
<blockquote>
<div><ul class="simple">
<li><p>exist</p></li>
<li><p>be a valid PDF file, per the file signature</p></li>
<li><p>have a .pdf file extension</p></li>
</ul>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Other Operations<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p>Store the <code class="docutils literal notranslate"><span class="pre">pdfplumber</span></code> parser object returned from the
<code class="xref py py-func docutils literal notranslate"><span class="pre">pdfplumber.open()</span></code> function into the
<code class="xref py py-attr docutils literal notranslate"><span class="pre">doc.parser</span></code> attribute.</p></li>
<li><p>Store the number of pages into the
<code class="xref py py-attr docutils literal notranslate"><span class="pre">doc.npages</span></code> attribute.</p></li>
<li><p>Store the document’s meta data into the
<code class="xref py py-attr docutils literal notranslate"><span class="pre">doc.metadata</span></code> attribute.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>TypeError</strong> – Raised if the file type criteria above are not
    met.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="docp_parsers.parsers._pdftableparser._PDFTableParser._prepare_row">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">_prepare_row</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">row</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="headerlink" href="#docp_parsers.parsers._pdftableparser._PDFTableParser._prepare_row" title="Link to this definition"></a></dt>
<dd><p>Prepare a table row for writing to a CSV file.</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>row</strong> (<em>list</em>) – A list of strings, constituting a table row.</p>
</dd>
<dt class="field-even">Processing Tasks<span class="colon">:</span></dt>
<dd class="field-even"><p>For each element in the row:</p>
<blockquote>
<div><ul class="simple">
<li><p>Remove any double quote characters (ASCII and Unicode).</p></li>
<li><p>Replace any empty values with <code class="docutils literal notranslate"><span class="pre">'None'</span></code>.</p></li>
<li><p>If the element contains a comma, wrap the element in
double quotes.</p></li>
<li><p>Attempt to convert any non-ASCII characters to an
associated ASCII character. If the replacement cannot
be made, the character is replaced with a <code class="docutils literal notranslate"><span class="pre">'?'</span></code>.</p></li>
</ul>
</div></blockquote>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A processed comma-separated string, ready to be written
to a CSV file.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="docp_parsers.parsers._pdftableparser._PDFTableParser._scan_common">
<span class="sig-name descname"><span class="pre">_scan_common</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#docp_parsers.parsers._pdftableparser._PDFTableParser._scan_common" title="Link to this definition"></a></dt>
<dd><p>Scan the PDF document to find the most common lines.</p>
<dl class="field-list">
<dt class="field-odd">Rationale<span class="colon">:</span></dt>
<dd class="field-odd"><p>Generally, the most common lines in a document will be the
header and footer, as these are expected to be repeated on
each page of the document.</p>
<p>‘Most common’ is defined as line occurring on 90% of the
pages throughout the document. Therefore, only documents with
more than three pages are scanned. Otherwise, the 90% may
exclude relevant pieces of the document (as was discovered in
testing).</p>
</dd>
<dt class="field-even">Logic<span class="colon">:</span></dt>
<dd class="field-even"><p>For documents with more than three pages, the entire PDF is
read through and each line extracted. The occurrence of each
line is counted, with the most common occurrences returned
to the caller.</p>
<p>The returned lines are to be passed into a page search to
determine the x/y coordinates of the header and footer.</p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>For documents with more than three pages, a list
containing the most common lines in the document. Otherwise,
an empty list if returned.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="docp_parsers.parsers._pdftableparser._PDFTableParser._set_paths">
<span class="sig-name descname"><span class="pre">_set_paths</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#docp_parsers.parsers._pdftableparser._PDFTableParser._set_paths" title="Link to this definition"></a></dt>
<dd><p>Set the document’s file path attributes.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="docp_parsers.parsers._pdftableparser._PDFTableParser.doc">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">doc</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="objects_pdfobject.html#docp_parsers.objects.pdfobject.DocPDF" title="docp_parsers.objects.pdfobject.DocPDF"><span class="pre">DocPDF</span></a></em><a class="headerlink" href="#docp_parsers.parsers._pdftableparser._PDFTableParser.doc" title="Link to this definition"></a></dt>
<dd><p>Accessor to the document object.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="docp_parsers.parsers._pdftableparser._PDFTableParser.pages">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">pages</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">list</span></em><a class="headerlink" href="#docp_parsers.parsers._pdftableparser._PDFTableParser.pages" title="Link to this definition"></a></dt>
<dd><p>Accessor to the PDF’s page objects.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="docp_parsers.parsers._pdftableparser._PDFTableParser.tables">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">tables</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">list</span></em><a class="headerlink" href="#docp_parsers.parsers._pdftableparser._PDFTableParser.tables" title="Link to this definition"></a></dt>
<dd><p>Accessor to the PDF’s table objects.</p>
</dd></dl>

</dd></dl>

</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="parsers__pdfbaseparser.html" class="btn btn-neutral float-left" title="Base (Private) Module: parsers/_pdfbaseparser.py" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="parsers__pdftextparser.html" class="btn btn-neutral float-right" title="Base (Private) Module: parsers/_pdftextparser.py" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025-2026 | s3dev | version 1.0.0.</p>
  </div>

   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>