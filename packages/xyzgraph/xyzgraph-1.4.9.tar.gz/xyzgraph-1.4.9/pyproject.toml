[build-system]
requires = ["setuptools>=42", "wheel"]
build-backend = "setuptools.build_meta"

[project]
name = "xyzgraph"
version = "1.4.9"
description = "Molecular Graph Construction from Cartesian Coordinates."
authors = [{name = "Dr Alister Goodfellow"}]
readme = "README.md"
requires-python = ">=3.8"
dependencies = [
    "numpy",
    "rdkit",
    "networkx"
]
classifiers = [
    "Programming Language :: Python :: 3",
    "License :: OSI Approved :: MIT License",
    "Operating System :: OS Independent",
]

[project.urls]
homepage = "https://github.com/aligfellow/xyzgraph"

[project.scripts]
xyzgraph = "xyzgraph.cli:main"
xyzgraph-build = "xyzgraph.cli:main"

[tool.setuptools.packages.find]
where = ["src"]

[tool.setuptools.package-data]
"xyzgraph.data" = ["*.json", "*.yaml"]

[dependency-groups]
dev = [
    "pre-commit>=3.5.0",
    "pytest>=8.3.5",
    "pytest-cov>=5.0.0",
    "ruff>=0.14.14",
    "ty>=0.0.14",
]

# ===== Ruff =====
[tool.ruff]
line-length = 120
target-version = "py310"
src = ["src", "tests"]

[tool.ruff.lint]
select = [
    "B",  # bugbear
    "D",  # pydocstyle
    "E",  # pycodestyle errors
    "F",  # pyflakes
    "I",  # isort
    "N",  # pep8-naming conventions
    "W",  # pycodestyle warnings
    "C4", # comprehensions
    "PL", # pylint
    "PT", # flake8-pytest-style
    "PIE", # misc lints
    "PYI", # flake8-pyi
    "TID", # tidy imports
    "TCH", # type-checking imports
    "RUF", # Ruff-specific rules
    "RSE", # flake8-raise
    "ICN001", # unconventional-import-alias
]
ignore = [
    "B905",    # zip() without strict= (ty doesn't support strict parameter)
    "N803",    # Argument name should be lowercase (G for graph is standard)
    "N806",    # Non-lowercase variable in function
    "PLR0911", # Too many returns
    "PLR0912", # Too many branches
    "PLR0913", # Too many arguments to function call
    "PLR0914", # Too many locals
    "PLR0915", # Too many statements
    "PLR1702", # Too many nested-blocks
    "PLC0415", # Local imports which may be performance related
    "PLR2004", # Magic numbers
]

[tool.ruff.lint.per-file-ignores]
"__init__.py" = ["F401", "F403"]
"tests/**" = ["D", "PLR2004"]  # No docstrings or magic number checks in tests

[tool.ruff.lint.pydocstyle]
convention = "numpy"

[tool.ruff.format]
docstring-code-format = true

# ===== ty =====
[tool.ty]
# ty auto-detects src/ directory

# ===== Pytest =====
[tool.pytest.ini_options]
testpaths = ["tests"]
addopts = "--doctest-modules"
doctest_optionflags = "NORMALIZE_WHITESPACE"

# ===== Coverage =====
[tool.coverage.run]
source = ["src/xyzgraph"]
branch = true

[tool.coverage.report]
exclude_lines = [
    "pragma: no cover",
    "if TYPE_CHECKING:",
    "raise NotImplementedError",
]

