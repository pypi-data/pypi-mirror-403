"""
HYPE Model Configuration.

Provides configuration schema, defaults, transformers, and validation
for the Hydrological Predictions for the Environment (HYPE) model.

This module registers HYPE-specific configuration components with the
ModelRegistry, enabling the core config system to remain model-agnostic.

PHASE 2 REFACTORING: This adapter now uses AutoGeneratedConfigAdapter
to auto-generate defaults and transformers from Pydantic Field declarations.
All defaults are maintained in HYPEConfig (model_configs.py) for single
source of truth.
"""

from typing import Dict, Any
from symfluence.models.base import AutoGeneratedConfigAdapter, ConfigValidationError
from symfluence.core.config.models.model_configs import HYPEConfig


# ============================================================================
# HYPE Config Adapter
# ============================================================================

class HYPEConfigAdapter(AutoGeneratedConfigAdapter):
    """
    Configuration adapter for HYPE model with auto-generated defaults and transformers.

    Defaults and transformers are automatically extracted from HYPEConfig
    Pydantic model. Only custom validation logic is implemented here.
    """

    def __init__(self, model_name: str = 'HYPE'):
        super().__init__(model_name)

    def get_config_schema(self):
        """Return HYPE Pydantic configuration schema."""
        return HYPEConfig

    def validate(self, config: Dict[str, Any]) -> None:
        """Validate HYPE-specific configuration."""
        required_fields = self.get_required_keys()
        missing_fields = []

        for field in required_fields:
            value = config.get(field)
            if value is None or value == '' or value == 'None':
                missing_fields.append(field)

        if missing_fields:
            raise ConfigValidationError(
                "HYPE configuration incomplete. Missing required fields:\n"
                + "\n".join(f"  â€¢ {field}" for field in missing_fields)
            )

    def get_required_keys(self) -> list:
        """Get list of required configuration keys for HYPE."""
        return [
            'SETTINGS_HYPE_PATH',
        ]
