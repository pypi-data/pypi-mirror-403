Metadata-Version: 2.4
Name: wiretaps
Version: 0.4.1
Summary: See what your AI agents are sending to LLMs. MitM proxy for auditing, PII detection, and compliance.
Project-URL: Homepage, https://wiretaps.ai
Project-URL: Documentation, https://wiretaps.ai/docs
Project-URL: Repository, https://github.com/marcosgabbardo/wiretaps
Project-URL: Issues, https://github.com/marcosgabbardo/wiretaps/issues
Author-email: Marcos Gabbardo <mgabbardo@protonmail.com>
License-Expression: MIT
License-File: LICENSE
Keywords: ai-agents,anthropic,audit,compliance,llm,openai,pii,proxy,security
Classifier: Development Status :: 3 - Alpha
Classifier: Environment :: Console
Classifier: Intended Audience :: Developers
Classifier: License :: OSI Approved :: MIT License
Classifier: Operating System :: OS Independent
Classifier: Programming Language :: Python :: 3
Classifier: Programming Language :: Python :: 3.11
Classifier: Programming Language :: Python :: 3.12
Classifier: Programming Language :: Python :: 3.13
Classifier: Topic :: Security
Classifier: Topic :: Software Development :: Libraries :: Python Modules
Requires-Python: >=3.11
Requires-Dist: aiohttp>=3.9.0
Requires-Dist: click>=8.1.0
Requires-Dist: pyyaml>=6.0
Requires-Dist: rich>=13.0.0
Requires-Dist: textual>=0.47.0
Provides-Extra: dev
Requires-Dist: mypy>=1.8.0; extra == 'dev'
Requires-Dist: pytest-asyncio>=0.23.0; extra == 'dev'
Requires-Dist: pytest-cov>=4.1.0; extra == 'dev'
Requires-Dist: pytest>=8.0.0; extra == 'dev'
Requires-Dist: ruff>=0.2.0; extra == 'dev'
Provides-Extra: spacy
Requires-Dist: spacy>=3.7.0; extra == 'spacy'
Description-Content-Type: text/markdown

# ğŸ”Œ wiretaps

**See what your AI agents are sending to LLMs.**

A transparent MitM proxy for auditing AI agent traffic. Logs every prompt, response, and tool call. Auto-detects PII, credentials, and crypto wallet addresses.

[![License: MIT](https://img.shields.io/badge/License-MIT-yellow.svg)](https://opensource.org/licenses/MIT)
[![Python 3.11+](https://img.shields.io/badge/python-3.11+-blue.svg)](https://www.python.org/downloads/)

---

## Why?

AI agents have access to your emails, files, and credentials. But do you know what they're actually sending to OpenAI, Anthropic, or other LLM APIs?

**wiretaps** sits between your agent and the LLM, giving you complete visibility:

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  AI Agent   â”‚â”€â”€â”€â”€â–¶â”‚   wiretaps   â”‚â”€â”€â”€â”€â–¶â”‚   LLM API   â”‚
â”‚ (any agent) â”‚     â”‚              â”‚     â”‚ (OpenAI,..) â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚
                          â–¼
                   ğŸ“‹ Audit Logs
                   ğŸš¨ PII Alerts
                   ğŸ“Š Dashboard
```

## Features

- **ğŸ” Full Visibility** â€” Log every prompt, response, and tool call
- **ğŸš¨ PII Detection** â€” Auto-detect emails, phone numbers, SSNs, credit cards
- **â‚¿ Crypto Detection** â€” Flag wallet addresses, private keys, seed phrases
- **ğŸ“Š Live Dashboard** â€” Terminal UI to monitor traffic in real-time
- **ğŸ”Œ Zero Code Changes** â€” Just set `OPENAI_BASE_URL` and go
- **ğŸ  Self-Hosted** â€” Your data never leaves your machine
- **ğŸ“¦ SQLite Default** â€” Zero dependencies, instant setup

## Quick Start

```bash
# Install
pip install wiretaps

# Start the proxy
wiretaps start

# Point your agent to the proxy
export OPENAI_BASE_URL=http://localhost:8080/v1

# Run your agent as usual
python my_agent.py

# View logs
wiretaps logs
```

## Dashboard

```bash
wiretaps dashboard
```

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ wiretaps v0.1.0                          Requests: 1,234    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 14:23:01 â”‚ POST /chat/completions â”‚ 1,200 tk â”‚ âš ï¸ PII: email â”‚
â”‚ 14:22:58 â”‚ POST /chat/completions â”‚ 856 tk   â”‚ âœ“ clean      â”‚
â”‚ 14:22:45 â”‚ POST /chat/completions â”‚ 2,100 tk â”‚ âš ï¸ PII: phone â”‚
â”‚ 14:22:30 â”‚ POST /embeddings       â”‚ 128 tk   â”‚ âœ“ clean      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## PII Detection

wiretaps automatically scans for sensitive data:

| Pattern | Example |
|---------|---------|
| Email | `user@example.com` |
| Phone | `+1 (555) 123-4567` |
| SSN | `123-45-6789` |
| Credit Card | `4111-1111-1111-1111` |
| CPF (Brazil) | `123.456.789-00` |
| BTC Address | `bc1qxy2kgdygjrsqtzq2n0yrf2493p83kkfjhx0wlh` |
| ETH Address | `0x71C7656EC7ab88b098defB751B7401B5f6d8976F` |
| Private Key | `0x...` (64 hex chars) |
| Seed Phrase | 12/24 BIP-39 words |

Add custom patterns:

```yaml
# ~/.wiretaps/patterns.yaml
patterns:
  - name: internal_id
    regex: "INTERNAL-[A-Z]{3}-[0-9]{6}"
    severity: high
```

## Supported LLM APIs

- âœ… OpenAI (`api.openai.com`)
- âœ… Anthropic (`api.anthropic.com`)
- âœ… Azure OpenAI
- âœ… Google AI (Gemini)
- âœ… Local models (Ollama, vLLM, etc.)
- âœ… Any OpenAI-compatible API

## Configuration

```bash
# Generate default config
wiretaps init

# Edit config
vim ~/.wiretaps/config.yaml
```

```yaml
# ~/.wiretaps/config.yaml
proxy:
  host: 127.0.0.1
  port: 8080

storage:
  type: sqlite  # or postgresql
  path: ~/.wiretaps/logs.db

pii:
  enabled: true
  patterns:
    - email
    - phone
    - credit_card
    - crypto_address
  
  # Auto-redact before sending to LLM (enterprise)
  redact: false

alerts:
  # Webhook on PII detection
  webhook: https://your-server.com/alerts
```

## Use Cases

### Compliance & Audit
Keep audit logs of all AI interactions for GDPR, LGPD, SOC2 compliance.

### Security Review  
Ensure your agents aren't leaking credentials, API keys, or sensitive data.

### Crypto/Fintech
Detect wallet addresses and private keys before they reach external APIs.

### Development
Debug exactly what your agent is sending without modifying code.

## Integrations

### Clawdbot

```yaml
# clawdbot.yaml
llm:
  baseUrl: http://localhost:8080/v1
```

### LangChain

```python
from langchain_openai import ChatOpenAI

llm = ChatOpenAI(
    base_url="http://localhost:8080/v1"
)
```

### Any OpenAI SDK

```python
import openai

client = openai.OpenAI(
    base_url="http://localhost:8080/v1"
)
```

## Enterprise

Self-hosted open source not enough? **wiretaps Enterprise** adds:

- ğŸŒ Web dashboard with auth
- ğŸ” SSO (SAML, OIDC)
- ğŸ‘¥ RBAC (role-based access)
- ğŸ“Š Compliance reports (LGPD, GDPR, SOC2)
- ğŸ”” Alerts (Slack, email, webhook)
- â˜ï¸ Managed hosting option

Contact: hello@wiretaps.ai

## Contributing

Contributions welcome! See [CONTRIBUTING.md](CONTRIBUTING.md).

```bash
# Clone
git clone https://github.com/marcosgabbardo/wiretaps
cd wiretaps

# Install dev dependencies
pip install -e ".[dev]"

# Run tests
pytest

# Run linter
ruff check .
```

## License

MIT â€” use it however you want.

---

Built with ğŸ”Œ by [@marcosgabbardo](https://github.com/marcosgabbardo)

**[wiretaps.ai](https://wiretaps.ai)**
