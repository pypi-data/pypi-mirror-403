# commit
#
# Reviews code, runs tests, lints, and commits changes. Use when ready to commit work with quality checks.
#
# Generated by DeepWork - do not edit manually

description = "Reviews code, runs tests, lints, and commits changes. Use when ready to commit work with quality checks."

prompt = """
# commit

**Multi-step workflow**: Reviews code, runs tests, lints, and commits changes. Use when ready to commit work with quality checks.

> **NOTE**: Gemini CLI requires manual command invocation. After each step, tell the user which command to run next.

A workflow for preparing and committing code changes with quality checks.

This job starts with a code review to catch issues early, runs tests until
they pass, formats and lints code with ruff, then reviews changed files
before committing and pushing. The review and lint steps use sub-agents
to reduce context usage.

Steps:
1. review - Code review for issues, DRY opportunities, naming, and test coverage (runs in sub-agent)
2. test - Pull latest code and run tests until they pass
3. lint - Format and lint code with ruff (runs in sub-agent)
4. commit_and_push - Review changes and commit/push


## Available Steps

1. **review** - Reviews changed code for issues, DRY opportunities, naming clarity, and test coverage using a sub-agent. Use as the first step before testing.
   Command: `/commit:review`
2. **test** - Pulls latest code and runs tests until all pass. Use after code review passes to verify changes work correctly. (requires: review)
   Command: `/commit:test`
3. **lint** - Formats and lints code with ruff using a sub-agent. Use after tests pass to ensure code style compliance. (requires: test)
   Command: `/commit:lint`
4. **commit_and_push** - Verifies changed files, creates commit, and pushes to remote. Use after linting passes to finalize changes. (requires: lint)
   Command: `/commit:commit_and_push`

## Execution Instructions

### Step 1: Analyze Intent

Parse any text following `/commit` to determine user intent:
- "review" or related terms → start at `/commit:review`
- "test" or related terms → start at `/commit:test`
- "lint" or related terms → start at `/commit:lint`
- "commit_and_push" or related terms → start at `/commit:commit_and_push`

### Step 2: Direct User to Starting Step

Tell the user which command to run:
```
/commit:review
```

### Step 3: Guide Through Workflow

After each step completes, tell the user the next command to run until workflow is complete.

### Handling Ambiguous Intent

If user intent is unclear:
- Present available steps as numbered options
- Ask user to select the starting point

## Reference

- Job definition: `.deepwork/jobs/commit/job.yml`
"""