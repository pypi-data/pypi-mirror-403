[build-system]
requires = ["setuptools"]
build-backend = "setuptools.build_meta"

[project]
name = "fnattr"
version = "0.2.10"
description = "Manage key/value metadata in file names."
license.text = "MIT License"
readme = "README.md"
requires-python = ">=3.11"
classifiers = [
    "Development Status :: 4 - Beta",
    "Environment :: Console",
    "Intended Audience :: End Users/Desktop",
    "License :: OSI Approved :: MIT License",
    "Natural Language :: English",
    "Operating System :: POSIX",
    "Programming Language :: Python :: 3.11",
    "Programming Language :: Python :: 3.12",
    "Programming Language :: Python :: 3.13",
    "Programming Language :: Python :: 3.14",
    "Topic :: Utilities",
    "Typing :: Typed",
]

[project.scripts]
fna = "fnattr.fna:main"
fnaffle = "fnattr.extra.fnaffle:main"

[project.urls]
repository = "https://codeberg.org/datatravelandexperiments/fna"

[tool.coverage.run]
omit = ["/usr/*"]

[tool.coverage.report]
exclude_lines = [
  "pragma: no cover",
  "raise NotImplementedError",
  "class .*\\bProtocol\\)",
  "def __repr__\\(",
]

[tool.mypy]
check_untyped_defs = true
mypy_path = "$MYPY_CONFIG_FILE_DIR/src"

[tool.pylint.basic]
argument-rgx = "[a-z_][a-z0-9_]*$"
attr-rgx = "[a-z_][a-z0-9_]*$"
class-rgx = "[A-Z_][A-Za-z0-9]*$"
const-rgx = "[A-Z_][A-Za-z0-9_]*$"
docstring-min-length = 12
function-rgx = "[a-z_][a-z0-9_]*$"
method-rgx = "[a-z_][a-z0-9_]*$"
no-docstring-rgx = "main|cmd_.*|test_.*|__.*|^_"
variable-rgx = "[a-z_][a-z0-9_]*$"

[tool.pylint.design]
max-args = 99
max-attributes = 99
max-branches = 99
max-locals  = 99
min-public-methods = 1
max-public-methods = 99
max-returns = 99
max-statements = 99

[tool.pylint.format]
max-line-length = 80

[tool.pylint."messages control"]
disable = [
    "bad-inline-option",
    "deprecated-pragma",
    "file-ignored",
    "import-error", # https://github.com/pylint-dev/pylint/issues/7306
    "locally-disabled",
    "raw-checker-failed",
    "suppressed-message",
    "too-few-public-methods",
    "unused-argument",
    "use-symbolic-message-instead",
    "useless-suppression",
]

[tool.pyright]
include = ["src"]

[tool.pytest.ini_options]
pythonpath = ["src"]
addopts = "--tb=native"

[tool.ruff]
src = ["src"]
namespace-packages = ["src/extra"]
line-length = 80
exclude = ["src/fnattr/extra"]

[tool.ruff.lint]
allowed-confusables = ["‘", "’", "–", "—", "‹", "›", "ı", "′", "″", "¦", "·"]
select = ["ALL"]
ignore = [
    "ANN002",   # missing-type-args: Nah.
    "ANN003",   # missing-type-kwargs: Nah.
    "ANN401",   # any-type: I wrote what I meant.
    "ERA",      # eradicate: Complains about yapf: directives.
    "C901",     # complex-structure: Be direct.
    "D102",     # undocumented-public-method: Plan to fix eventually.
    "D103",     # undocumented-public-function: Plan to fix eventually.
    "D105",     # undocumented-magic-method: We know what they're for.
    "D107",     # undocumented-public-init: We know what it's for.
    "D203",     # one-blank-line-before-class: Conflicts with D211.
    "D212",     # multi-line-summary-first-line: Conflicts with D213.
    "LOG015",   # root-logger-call
    "PD",       # pandas-vet: Not using Pandas.
    "PLR0911",  # too-many-return-statements: Be direct.
    "PLR0912",  # too-many-branches: Be direct.
    "PLR0912",  # too-many-branches: Be direct.
    "PLR0913",  # too-many-arguments: Be direct.
    "PLR2004",  # magic-value-comparison: Be direct.
    "PYI041",   # redundant-numeric-union: Prefer to be explicit.
    "PYI025",   # unaliased-collections-abc-set-import
    "RUF100",   # unused-noqa: Ruff isn't the only tool in the world.
    "S314", 	# suspicious-xml-element-tree-usage: defusedxml is not builtin.
    "T20",      # flake8-print: I like having output.
    "TRY400",   # error-instead-of-exception: Don't dump traces on end users.
]

[tool.ruff.lint.flake8-annotations]
allow-star-arg-any = true
suppress-dummy-args = true

[tool.ruff.lint.flake8-quotes]
inline-quotes = "single"

[tool.ruff.lint.isort]
lines-after-imports = 1
lines-between-types = 1

[tool.ruff.lint.per-file-ignores]
"*_test.py" = [
    "ANN001", "ANN201", "ANN202",   # type annotations tbd
    "PLC1901",  # testing for specific results
    "S101",     # assert
]
"src/fnattr/vlju/types/doi/org.py" = ["Q000"]
"src/fnattr/vlju/types/ean/isbn_ranges.py" = ["E501"]

[tool.ruff.lint.pylint]
max-args = 8

[tool.yapf]
based_on_style = "pep8"
allow_multiline_lambdas = true
allow_multiline_dictionary_keys = true
blank_lines_around_top_level_definition = 1
blank_lines_between_top_level_imports_and_variables = 1
coalesce_brackets = true
column_limit = 80
dedent_closing_brackets = false
each_dict_entry_on_separate_line = true
indent_dictionary_value = true
join_multiple_lines = false
spaces_around_default_or_named_assign = false
spaces_around_subscript_colon = true
spaces_before_comment = 2
split_before_bitwise_operator = true
split_before_arithmetic_operator = true
split_before_dot = true
split_before_expression_after_opening_paren = true
split_before_logical_operator = true
split_complex_comprehension = true
