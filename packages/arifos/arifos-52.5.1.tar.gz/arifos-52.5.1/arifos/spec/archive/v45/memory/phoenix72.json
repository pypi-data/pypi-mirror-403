{
  "meta": {
    "version": "v45.0",
    "arifos_version": "v45.0",
    "authority": "Track B (amendment process) governed by Track A canon",
    "locked": true,
    "status": "AUTHORITATIVE",
    "source": "spec/v45/cooling_ledger_phoenix.json",
    "canonical_source": "L1_THEORY/canon/05_memory/05_PHOENIX_72_v45.md",
    "spec_type": "phoenix72",
    "description": "Phoenix-72 Amendment Engine - constitutional amendment lifecycle with 72-hour cooling",
    "note": "Cooling window prevents hasty amendments. Temporal distance enables wisdom."
  },
  "phoenix72": {
    "cooling_window": 72,
    "cooling_window_seconds": 259200,
    "principle": "Truth must cool before it rules",
    "rationale": "Hot reactions make poor law. Temporal distance enables wisdom.",
    "phases": [
      "SCAR_CAPTURE (0-24h): Collect governance failures",
      "PATTERN_SYNTHESIS (24-48h): Identify recurring patterns",
      "AMENDMENT_DRAFT (48-60h): Propose constitutional changes",
      "HUMAN_REVIEW (60-72h): Human approval or rejection",
      "CANONIZATION (72h+): Promote to VAULT (if approved)"
    ],
    "fail_closed": true
  },
  "phases": {
    "scar_capture": {
      "id": 1,
      "symbol": "SCAR",
      "display": "SCAR Capture",
      "duration": [
        0,
        24
      ],
      "description": "Collect governance failures and edge cases",
      "triggers": [
        "PARTIAL verdict (marginal governance)",
        "SABAR verdict (floor pause)",
        "User correction of constitutional claim (H-USER-CORRECTION)",
        "Source conflict detected (H-SOURCE-CONFLICT)",
        "Repeated pattern (3+ occurrences)"
      ],
      "scar_schema": {
        "required": {
          "timestamp": "ISO8601",
          "scar_id": "UUID v4",
          "status": "PROPOSED",
          "floor_failures": {
            "type": "array",
            "description": "Which floors failed or were marginal",
            "example": [
              "F2(truth=0.85)",
              "F4(delta_s=-0.1)"
            ]
          },
          "reason": "string (why this SCAR was created)",
          "ledger_ref": "entry_id from Cooling Ledger"
        },
        "optional": {
          "query": "string (user query that triggered SCAR)",
          "output": "string (output that was marginal/blocked)",
          "evidence": "array (supporting evidence)",
          "severity": "number (1.0-8.0, default 1.0)",
          "pattern_similarity": "number (0.0-1.0 if related to existing SCAR)"
        }
      },
      "actions": [
        "Write SCAR to PHOENIX band (write-once)",
        "Log SCAR creation to LEDGER",
        "Tag SCAR as PROPOSED (awaiting synthesis)"
      ],
      "examples": {
        "partial_scar": {
          "floor_failures": [
            "F6(kappa_r=0.92)"
          ],
          "reason": "Harsh truth, low empathy",
          "query": "Tell me bluntly what's wrong",
          "status": "PROPOSED"
        }
      }
    },
    "pattern_synthesis": {
      "id": 2,
      "symbol": "üî¨",
      "display": "Pattern Synthesis",
      "duration": [
        24,
        48
      ],
      "description": "Identify recurring patterns across SCARs",
      "wait_time": 24,
      "synthesis_criteria": {
        "min_scars": 3,
        "similarity_threshold": 0.85,
        "time_window": 7
      },
      "pattern_detection": {
        "method": "Clustering + frequency analysis",
        "steps": [
          "Retrieve all PROPOSED SCARs from last 7 days",
          "Compute similarity matrix (query + reason embeddings)",
          "Cluster SCARs with similarity > 0.85",
          "Identify clusters with >= 3 SCARs",
          "Extract common pattern from cluster"
        ]
      },
      "pattern_schema": {
        "pattern_id": "UUID v4",
        "pattern_name": "string (descriptive name)",
        "scar_count": "integer (how many SCARs match this pattern)",
        "scar_ids": "array (list of SCAR IDs in cluster)",
        "common_floor_failures": "array (which floors commonly fail)",
        "proposed_threshold_change": "object (suggested new thresholds)",
        "confidence": "number (0.0-1.0 synthesis confidence)"
      },
      "actions": [
        "Create PATTERN record in PHOENIX band",
        "Link pattern to source SCARs",
        "Transition SCARs to PATTERN_LINKED status",
        "Log synthesis to LEDGER"
      ],
      "examples": {
        "harsh_truth_pattern": {
          "pattern_name": "Harsh truth (high truth, low empathy)",
          "scar_count": 5,
          "common_floor_failures": [
            "F6(kappa_r < 0.93)"
          ],
          "proposed_threshold_change": {
            "F6_kappa_r": {
              "current": 0.95,
              "proposed": 0.9,
              "reason": "Allow harsher truths when user explicitly requests bluntness"
            }
          }
        }
      }
    },
    "amendment_draft": {
      "id": 3,
      "symbol": "üìù",
      "display": "Amendment Draft",
      "duration": [
        48,
        60
      ],
      "description": "Draft constitutional amendment from pattern",
      "wait_time": 48,
      "amendment_schema": {
        "required": {
          "amendment_id": "UUID v4",
          "pattern_id": "UUID v4 (which pattern this amends)",
          "status": "DRAFT",
          "applied_at": "null (not yet applied)",
          "reason": "string (why this amendment is needed)",
          "changes": {
            "type": "object",
            "description": "Proposed changes to constitutional spec",
            "example": {
              "F6_kappa_r": {
                "threshold": {
                  "current": 0.95,
                  "proposed": 0.9
                },
                "context_rule": {
                  "add": "When user explicitly requests bluntness (HARD lane), F6 threshold = 0.90"
                }
              }
            }
          }
        },
        "optional": {
          "tri_witness": "number (expected tri-witness score for amendment)",
          "delta_s_gain": "number (expected clarity gain from amendment)",
          "peace2": "number (expected peace¬≤ score - non-escalatory?)",
          "risk_level": "enum (LOW, MEDIUM, HIGH)",
          "evidence": "array (supporting evidence from SCARs)"
        }
      },
      "drafting_process": {
        "step_1": "Retrieve PATTERN from PHOENIX band",
        "step_2": "Analyze proposed threshold change",
        "step_3": "Check impact on existing canon (simulation)",
        "step_4": "Draft amendment text (changes object)",
        "step_5": "Compute expected metrics (tri_witness, delta_s_gain, peace¬≤)",
        "step_6": "Write AMENDMENT to PHOENIX band as DRAFT"
      },
      "invariants": [
        "INV-1: Amendment cannot violate higher floors (F1 Amanah, F2 Truth hard)",
        "INV-2: Amendment must increase tri_witness >= 0.95",
        "INV-3: Amendment must NOT decrease peace¬≤ below 1.0",
        "INV-4: Amendment requires positive delta_s_gain >= 0"
      ],
      "actions": [
        "Create AMENDMENT record in PHOENIX band",
        "Transition PATTERN to AMENDMENT_DRAFTED status",
        "Log draft to LEDGER",
        "Prepare for human review"
      ]
    },
    "human_review": {
      "id": 4,
      "symbol": "üë§",
      "display": "Human Review",
      "duration": [
        60,
        72
      ],
      "description": "Human approval or rejection of amendment",
      "wait_time": 60,
      "review_criteria": [
        "Does amendment align with arifOS philosophy?",
        "Does amendment pass all 4 invariants (INV-1 through INV-4)?",
        "Is evidence chain sufficient (>= 3 SCARs)?",
        "Does amendment improve governance (tri_witness, delta_s_gain, peace¬≤)?"
      ],
      "human_actions": {
        "approve": {
          "command": "arifos-seal-canon --amendment-id <UUID>",
          "effect": "Transition AMENDMENT status to SEALED",
          "next_phase": "CANONIZATION"
        },
        "reject": {
          "command": "arifos-reject-amendment --amendment-id <UUID> --reason <TEXT>",
          "effect": "Transition AMENDMENT status to DEPRECATED",
          "next_phase": "None (amendment discarded)"
        },
        "request_revision": {
          "command": "arifos-revise-amendment --amendment-id <UUID> --changes <JSON>",
          "effect": "Transition AMENDMENT to REVISION status, restart DRAFT phase"
        }
      },
      "timeout_behavior": {
        "if_no_response_after_72h": "AUTO-REJECT (fail-closed)",
        "reason": "Human review timeout - conservative default is to reject",
        "note": "Hasty amendments are worse than no amendments"
      },
      "actions": [
        "Notify human reviewer (email, webhook, etc.)",
        "Wait for human decision (approve/reject/revise)",
        "Log decision to LEDGER",
        "Transition AMENDMENT status accordingly"
      ]
    },
    "canonization": {
      "id": 5,
      "symbol": "‚öñÔ∏è",
      "display": "Canonization",
      "duration": [
        72,
        "infinity"
      ],
      "description": "Promote sealed amendment to VAULT (immutable canon)",
      "wait_time": 72,
      "prerequisites": [
        "AMENDMENT status = SEALED (human-approved)",
        "72-hour cooling window completed",
        "All 4 invariants verified (INV-1 through INV-4)",
        "No conflicting amendments in queue"
      ],
      "canonization_process": {
        "step_1": "Retrieve SEALED amendment from PHOENIX band",
        "step_2": "Apply changes to spec/v45/ JSON files (Track B)",
        "step_3": "Regenerate SHA-256 manifest",
        "step_4": "Update L1_THEORY/canon/ markdown (Track A)",
        "step_5": "Git commit with Phoenix-72 compliance message",
        "step_6": "Move AMENDMENT to VAULT band (immutable)",
        "step_7": "Transition source SCARs to HEALED status"
      },
      "git_commit_template": "feat(phoenix72): <amendment_name>\n\nAmendment ID: <UUID>\nPattern: <pattern_name>\nSCARs healed: <count>\nTri-witness: <score>\nDelta_s_gain: <score>\nPeace¬≤: <score>\n\nChanges:\n- <change_1>\n- <change_2>\n\nEvidence: <SCAR_IDs>\n\nSEALED by: <human_reviewer>\nSEALED at: <ISO8601>\n\n72-hour cooling window: COMPLETE\n",
      "actions": [
        "Apply amendment changes to spec files",
        "Promote AMENDMENT to VAULT",
        "Transition SCARs to HEALED",
        "Log canonization to LEDGER",
        "Emit SUNSET verdict for deprecated patterns"
      ]
    }
  },
  "scar_lifecycle": {
    "description": "State machine for SCAR entries",
    "states": {
      "PROPOSED": {
        "description": "SCAR captured, awaiting synthesis",
        "transitions": [
          "PATTERN_LINKED",
          "DEPRECATED"
        ],
        "duration": "0-48 hours"
      },
      "PATTERN_LINKED": {
        "description": "SCAR linked to pattern, awaiting amendment draft",
        "transitions": [
          "AMENDMENT_DRAFTED",
          "DEPRECATED"
        ],
        "duration": "24-60 hours"
      },
      "AMENDMENT_DRAFTED": {
        "description": "Amendment drafted from pattern, awaiting human review",
        "transitions": [
          "SEALED",
          "DEPRECATED",
          "REVISION"
        ],
        "duration": "48-72 hours"
      },
      "SEALED": {
        "description": "Human-approved, awaiting canonization",
        "transitions": [
          "HEALED"
        ],
        "duration": "72+ hours"
      },
      "HEALED": {
        "description": "Amendment canonized, SCAR resolved",
        "transitions": [],
        "retention": "VAULT (permanent)"
      },
      "DEPRECATED": {
        "description": "SCAR rejected or obsolete",
        "transitions": [],
        "retention": "COLD (365 days, then archive)"
      }
    },
    "transitions": {
      "PROPOSED ‚Üí PATTERN_LINKED": {
        "trigger": "Pattern synthesis (Phase 2) finds matching cluster",
        "action": "Link SCAR to pattern_id"
      },
      "PATTERN_LINKED ‚Üí AMENDMENT_DRAFTED": {
        "trigger": "Amendment draft (Phase 3) created from pattern",
        "action": "Link SCAR to amendment_id"
      },
      "AMENDMENT_DRAFTED ‚Üí SEALED": {
        "trigger": "Human approval (Phase 4)",
        "action": "Mark amendment as SEALED"
      },
      "SEALED ‚Üí HEALED": {
        "trigger": "Canonization (Phase 5) completes",
        "action": "Move SCAR to VAULT, mark as HEALED"
      },
      "* ‚Üí DEPRECATED": {
        "trigger": "Human rejection OR timeout OR obsolete",
        "action": "Mark SCAR as DEPRECATED, move to COLD storage"
      }
    }
  },
  "amendment_schema": {
    "required_fields": {
      "amendment_id": {
        "type": "string (UUID v4)",
        "description": "Unique amendment identifier"
      },
      "pattern_id": {
        "type": "string (UUID v4)",
        "description": "Which pattern this amendment addresses"
      },
      "status": {
        "type": "enum",
        "values": [
          "DRAFT",
          "REVISION",
          "SEALED",
          "HEALED",
          "DEPRECATED"
        ],
        "description": "Current status in lifecycle"
      },
      "applied_at": {
        "type": "ISO8601 or null",
        "description": "When amendment was canonized (null if not yet applied)"
      },
      "reason": {
        "type": "string",
        "description": "Why this amendment is needed"
      },
      "changes": {
        "type": "object",
        "description": "Proposed changes to constitutional spec",
        "schema": "Flexible (depends on what's being changed)"
      },
      "evidence": {
        "type": "array",
        "description": "Evidence chain (SCAR IDs)",
        "min_length": 3
      }
    },
    "optional_fields": {
      "tri_witness": {
        "type": "number",
        "range": [
          0.0,
          1.0
        ],
        "description": "Expected tri-witness score for amendment"
      },
      "delta_s_gain": {
        "type": "number",
        "range": [
          -1.0,
          1.0
        ],
        "description": "Expected clarity gain from amendment"
      },
      "peace2": {
        "type": "number",
        "range": [
          0.0,
          2.0
        ],
        "description": "Expected peace¬≤ score (non-escalatory?)"
      },
      "risk_level": {
        "type": "enum",
        "values": [
          "LOW",
          "MEDIUM",
          "HIGH"
        ],
        "description": "Risk assessment"
      },
      "sealed_by": {
        "type": "string",
        "description": "Human reviewer who sealed the amendment"
      },
      "sealed_at": {
        "type": "ISO8601",
        "description": "When amendment was sealed"
      }
    }
  },
  "invariants": {
    "INV-1": {
      "name": "No Hard Floor Weakening",
      "rule": "Amendment cannot reduce hard floor thresholds (F1, F2, F4, F7)",
      "examples": {
        "forbidden": "F2 truth threshold 0.99 ‚Üí 0.85 (REJECTED)",
        "allowed": "F2 truth threshold 0.99 ‚Üí 0.99 (no change) OR context-specific rule (e.g., PHATIC lane exemption)"
      }
    },
    "INV-2": {
      "name": "Tri-Witness Requirement",
      "rule": "Amendment must achieve tri_witness >= 0.95",
      "reason": "Human‚ÄìAI‚ÄìEarth consensus required",
      "verification": "Simulate amendment impact, check if tri_witness >= 0.95"
    },
    "INV-3": {
      "name": "Non-Escalatory Requirement",
      "rule": "Amendment must NOT decrease peace¬≤ below 1.0",
      "reason": "Amendments cannot introduce conflict amplification",
      "verification": "Simulate amendment impact, check if peace¬≤ >= 1.0"
    },
    "INV-4": {
      "name": "Clarity Gain Requirement",
      "rule": "Amendment must provide positive delta_s_gain >= 0",
      "reason": "Amendments must reduce confusion, not add it",
      "verification": "Check if amendment text improves clarity (measured by delta_s)"
    }
  },
  "usage_examples": {
    "full_lifecycle": {
      "phase_1_scar_capture": {
        "hour": 0,
        "event": "User asks harsh truth question 5 times, all get PARTIAL (Œ∫·µ£ = 0.92-0.93)",
        "action": "Create 5 SCARs with floor_failures=['F6(kappa_r<0.95)']",
        "scar_status": "PROPOSED"
      },
      "phase_2_pattern_synthesis": {
        "hour": 24,
        "event": "Pattern synthesis runs, finds cluster of 5 SCARs",
        "action": "Create PATTERN 'Harsh truth (high truth, low empathy)'",
        "pattern_proposal": {
          "F6_kappa_r": {
            "current": 0.95,
            "proposed": 0.9,
            "context_rule": "When user explicitly requests bluntness (HARD lane), threshold = 0.90"
          }
        },
        "scar_status": "PATTERN_LINKED"
      },
      "phase_3_amendment_draft": {
        "hour": 48,
        "event": "Amendment draft created from pattern",
        "amendment": {
          "amendment_id": "a1b2c3d4-e5f6-4a7b-8c9d-0e1f2a3b4c5d",
          "reason": "Allow harsher truths when user explicitly requests bluntness",
          "changes": {
            "F6_kappa_r": {
              "threshold": {
                "current": 0.95,
                "proposed": 0.9
              },
              "context_rule": {
                "add": "HARD lane (factual/blunt queries) threshold = 0.90"
              }
            }
          },
          "tri_witness": 0.96,
          "delta_s_gain": 0.15,
          "peace2": 1.1,
          "risk_level": "LOW"
        },
        "scar_status": "AMENDMENT_DRAFTED"
      },
      "phase_4_human_review": {
        "hour": 60,
        "event": "Human reviewer examines amendment",
        "review_decision": "APPROVE",
        "command": "arifos-seal-canon --amendment-id a1b2c3d4-e5f6-4a7b-8c9d-0e1f2a3b4c5d",
        "amendment_status": "SEALED",
        "scar_status": "SEALED"
      },
      "phase_5_canonization": {
        "hour": 72,
        "event": "72-hour cooling window complete, canonization begins",
        "actions": [
          "Update spec/v45/constitutional_floors.json (F6 context rule added)",
          "Regenerate SHA-256 manifest",
          "Update L1_THEORY/canon/01_floors/016_KAPPA_R_F6_v45.md",
          "Git commit with Phoenix-72 template",
          "Move amendment to VAULT",
          "Transition SCARs to HEALED"
        ],
        "amendment_status": "HEALED",
        "scar_status": "HEALED"
      }
    },
    "rejection_example": {
      "phase_4_human_review": {
        "hour": 60,
        "event": "Human reviewer rejects amendment",
        "review_decision": "REJECT",
        "reason": "Weakening F6 too much - empathy floor is critical",
        "command": "arifos-reject-amendment --amendment-id <UUID> --reason 'Empathy floor is critical'",
        "amendment_status": "DEPRECATED",
        "scar_status": "DEPRECATED",
        "retention": "COLD (365 days)"
      }
    }
  },
  "cli_commands": {
    "propose_canon": {
      "command": "arifos-propose-canon --list",
      "description": "List all PROPOSED SCARs awaiting synthesis"
    },
    "seal_canon": {
      "command": "arifos-seal-canon --amendment-id <UUID>",
      "description": "Approve amendment for canonization (human-only)"
    },
    "reject_amendment": {
      "command": "arifos-reject-amendment --amendment-id <UUID> --reason <TEXT>",
      "description": "Reject amendment (human-only)"
    },
    "show_amendment": {
      "command": "arifos-show-amendment --amendment-id <UUID>",
      "description": "Show amendment details and current status"
    }
  },
  "notes": {
    "created": "2025-12-29",
    "updated": "2025-12-29",
    "author": "arifOS Project",
    "license": "Apache-2.0",
    "canonical_source": "L1_THEORY/canon/05_memory/05_PHOENIX_72_v45.md",
    "note": "Phoenix-72 enforces 72-hour cooling window for constitutional amendments. Prevents hasty changes. Temporal distance enables wisdom.",
    "etymology": "Phoenix = rebirth/renewal. 72 hours = 3 days for cooling and reflection."
  }
}