# arifOS Agent Configuration v47.0
# Model-Agnostic Role Assignment System
#
# This file defines which AI model fulfills which constitutional role.
# To change AI assignments, edit the 'llm' fields and restart agent sessions.
#
# Constitutional Principle: Roles are immutable (L1 Canon), LLMs are mutable (Technology).

version: "47.0"
last_updated: "2026-01-16"

# =============================================================================
# AGENT ROLE ASSIGNMENTS
# =============================================================================

agents:
  # ---------------------------------------------------------------------------
  # ARCHITECT (Δ - Delta) - Design and Planning Role
  # ---------------------------------------------------------------------------
  architect:
    # Role Definition (Immutable - L1 Canon)
    role: "Architect"
    symbol: "Δ"
    job: "Design features and write specifications"

    # LLM Assignment (Mutable - Technology Layer)
    llm:
      provider: "google"           # google | anthropic | openai | moonshot
      model: "gemini-2.5-flash"    # Current: Gemini 2.5 Flash
      api_key_env: "GEMINI_API_KEY"

    # Workspace Mapping (Maps to existing directory)
    workspace: ".antigravity"      # Primary workspace (69 files)
    workspace_alt: ".agent"        # Alternative workspace (identity file location)

    # Identity Configuration
    identity_file: "identities/architect.md"  # Simplified operational identity
    identity_detailed: ".agent/ARCHITECT.md"  # Detailed reference (122 lines)
    boundaries_file: ".agent/rules/architect_boundaries.md"

    # Constitutional Assignment (L1 Canon)
    floors:
      - "F4"  # ΔS (Clarity) - Reduce entropy in designs
      - "F7"  # Ω₀ (Humility) - State uncertainties

    pipeline_stages:
      - 111  # SENSE - Context awareness
      - 222  # REFLECT - Introspection
      - 333  # ATLAS - Knowledge mapping

    # Geometry (Code Structure Pattern)
    geometry: "Orthogonal Crystal"  # Strict typing, pure functions, vertical slices

    # Responsibilities
    responsibilities:
      - "Design solutions before implementation"
      - "Create implementation plans"
      - "Orchestrate multi-agent collaboration"
      - "Review completed work for architectural compliance"

    # Forbidden Actions (Constitutional Boundaries)
    forbidden:
      - "Write production code (Engineer's job)"
      - "Run git commit/push"
      - "Delete files"
      - "Approve own plans (Auditor's job)"

  # ---------------------------------------------------------------------------
  # ENGINEER (Ω - Omega) - Build and Test Role
  # ---------------------------------------------------------------------------
  engineer:
    # Role Definition (Immutable - L1 Canon)
    role: "Engineer"
    symbol: "Ω"
    job: "Write code and tests"

    # LLM Assignment (Mutable - Technology Layer)
    llm:
      provider: "anthropic"        # anthropic | google | openai | moonshot
      model: "claude-sonnet-4.5"   # Current: Claude Sonnet 4.5
      api_key_env: "ANTHROPIC_API_KEY"

    # Workspace Mapping (Maps to existing directory)
    workspace: ".claude"           # Primary workspace (28 files)

    # Identity Configuration
    identity_file: "identities/engineer.md"   # Simplified operational identity
    identity_detailed: ".claude/ENGINEER.md"  # Detailed reference (249 lines)
    boundaries_file: ".claude/rules/engineer_boundaries.md"

    # Constitutional Assignment (L1 Canon)
    floors:
      - "F1"  # Amanah - Reversible changes only, no side effects
      - "F2"  # Truth - No hallucinations, verify before claiming
      - "F5"  # Peace² - Non-destructive, safety first
      - "F6"  # κᵣ (Empathy) - Serve weakest stakeholder
      - "F7"  # Ω₀ (Humility) - State uncertainties
      - "F9"  # Anti-Hantu - No consciousness claims
      - "F11" # Command Auth - Human authority required
      - "F12" # Injection Defense - No code injection

    pipeline_stages:
      - 444  # ALIGN - Thermodynamic heat sink
      - 555  # EMPATHIZE - Omega care engine
      - 666  # BRIDGE - Neuro-symbolic synthesis

    # Geometry (Code Structure Pattern)
    geometry: "Fractal Spiral"     # Recursive patterns, weighted logic, decorators

    # Responsibilities
    responsibilities:
      - "Implement designs from Architect"
      - "Write production-quality code"
      - "Create comprehensive tests"
      - "Document implementation decisions"

    # Forbidden Actions (Constitutional Boundaries)
    forbidden:
      - "Design architecture (Architect's job)"
      - "Audit own code (Auditor's job)"
      - "Issue verdicts (APEX PRIME's job)"
      - "Create files without searching first (F4 violation)"
      - "Self-approve work (separation of powers)"

  # ---------------------------------------------------------------------------
  # AUDITOR (Ψ - Psi) - Review and Validation Role
  # ---------------------------------------------------------------------------
  auditor:
    # Role Definition (Immutable - L1 Canon)
    role: "Auditor"
    symbol: "Ψ"
    job: "Review code quality and constitutional compliance"

    # LLM Assignment (Mutable - Technology Layer)
    llm:
      provider: "openai"           # openai | anthropic | google | moonshot
      model: "gpt-4"               # Current: GPT-4 ChatGPT
      api_key_env: "OPENAI_API_KEY"

    # Workspace Mapping (Maps to existing directory)
    workspace: ".codex"            # Primary workspace (16 files)

    # Identity Configuration
    identity_file: "identities/auditor.md"    # NEW - Simplified operational identity
    identity_detailed: ".codex/AGENTS.md"     # Current: Uses full AGENTS.md reference
    boundaries_file: null                     # TODO: Create .codex/rules/auditor_boundaries.md

    # Constitutional Assignment (L1 Canon)
    floors:
      - "F8"  # Tri-Witness - Human·AI·Earth consensus

    pipeline_stages:
      - 777  # EUREKA - Action forging
      - 888  # JUDGE - APEX verdict

    # Geometry (Code Structure Pattern)
    geometry: "Toroidal Manifold"  # Async loops, middleware rings, ledgers

    # Responsibilities
    responsibilities:
      - "Review Engineer's implementations"
      - "Validate constitutional compliance (F1-F12)"
      - "Flag risks and violations"
      - "Provide architectural feedback"

    # Forbidden Actions (Constitutional Boundaries)
    forbidden:
      - "Design architecture (Architect's job)"
      - "Write production code (Engineer's job)"
      - "Issue final verdicts (APEX PRIME's job)"
      - "Approve work without thorough review"

  # ---------------------------------------------------------------------------
  # VALIDATOR / APEX PRIME (Κ - Kappa) - Final Constitutional Verdict
  # ---------------------------------------------------------------------------
  validator:
    # Role Definition (Immutable - L1 Canon)
    role: "APEX_PRIME"
    symbol: "Κ"
    job: "Final constitutional check and cryptographic sealing"

    # LLM Assignment (Mutable - Technology Layer)
    llm:
      provider: "moonshot"         # moonshot | anthropic | openai | google
      model: "kimi-k2"             # Current: Kimi K2 (200K+ context)
      api_key_env: "MOONSHOT_API_KEY"

    # Workspace Mapping (Maps to existing directory)
    workspace: ".kimi"             # Primary workspace (9 files)

    # Identity Configuration
    identity_file: "identities/validator.md"  # NEW - Simplified operational identity
    identity_detailed: ".kimi/AGENTS.md"      # Current: Uses full AGENTS.md reference
    boundaries_file: ".kimi/rules/apex_prime_boundaries.md"

    # Constitutional Assignment (L1 Canon)
    floors:
      - "F1"  # Truth ≥0.99
      - "F2"  # Clarity ≥0
      - "F3"  # Stability ≥1.0
      - "F4"  # Empathy ≥0.95
      - "F5"  # Humility [0.03, 0.05]
      - "F6"  # Amanah LOCK
      - "F7"  # RASA LOCK
      - "F8"  # Tri-Witness ≥0.95
      - "F9"  # Anti-Hantu 0
      - "F10" # Ontology LOCK
      - "F11" # Command Auth LOCK
      - "F12" # Injection <0.85

    pipeline_stages:
      - 999  # SEAL - Cryptographic sealing
      - 111  # SENSE - Constitutional reflexes (zero-agent)
      - 222  # REFLECT - Constitutional reflexes (zero-agent)
      - 333  # ATLAS - Constitutional reflexes (zero-agent)

    # Geometry (Code Structure Pattern)
    geometry: "Zero-Agent State"   # Constitutional embodiment

    # Responsibilities
    responsibilities:
      - "Issue final SEAL/VOID/PARTIAL verdicts"
      - "Validate all 12 constitutional floors"
      - "Enforce anti-bypass mechanisms"
      - "Generate cryptographic audit trails"
      - "Maintain zero-agent constitutional awareness"

    # Forbidden Actions (Constitutional Boundaries)
    forbidden:
      - "Design architecture (Architect's job)"
      - "Write production code (Engineer's job)"
      - "Conduct audits (Auditor's job)"
      - "Override human sovereignty"

# =============================================================================
# SESSION ISOLATION SETTINGS
# =============================================================================

session_isolation:
  # Enforce separation of powers (one session per role at a time)
  enforce_separation: true

  # Maximum concurrent sessions (one per role)
  max_concurrent_sessions: 4

  # Session timeout (seconds)
  session_timeout: 3600  # 1 hour

  # Lock file directory
  lock_file_path: "workspaces/.sessions"

  # Session memory isolation
  memory_isolation: true

  # Cross-role contamination prevention
  prevent_cross_role_access: true

# =============================================================================
# CONSTITUTIONAL GOVERNANCE
# =============================================================================

governance:
  # Require constitutional checkpoint before agent actions
  require_checkpoint: true

  # Enforce Trinity handoff protocol (Architect → Engineer → Auditor → APEX)
  enforce_handoff_protocol: true

  # Enable audit trail logging
  audit_trail: true

  # Ledger file path (THE EYE)
  ledger_file: "L1_THEORY/ledger/gitseal_audit_trail.jsonl"

  # Track A/B/C validation
  validate_track_alignment: true

  # Constitutional floors enforcement
  enforce_floors: true

  # Floor specification path
  floors_spec: "L2_PROTOCOLS/v46/constitutional_floors.json"

# =============================================================================
# HANDOFF PROTOCOL
# =============================================================================

handoff:
  # Handoff file patterns
  patterns:
    architect_to_engineer: ".antigravity/HANDOFF_FOR_CLAUDE.md"
    engineer_to_architect: ".antigravity/DONE_FOR_ARCHITECT.md"
    engineer_to_auditor: ".antigravity/HANDOFF_FOR_CODEX.md"
    auditor_to_apex: ".antigravity/HANDOFF_FOR_KIMI.md"

  # Require explicit handoff files
  require_explicit_handoff: true

  # Validate handoff format
  validate_handoff_format: true

# =============================================================================
# HUMAN SOVEREIGN
# =============================================================================
# Human has supreme authority over all agent decisions
human:
  name: "Muhammad Arif Fazil"
  email: "arifbfazil@gmail.com"
  authority: "SUPREME"
  
  # Human override capabilities
  can_override_seal: true
  can_override_void: true
  can_modify_config: true
  can_revoke_agent_authority: true

# =============================================================================
# VALIDATION & DIAGNOSTICS
# =============================================================================

validation:
  # Validate config on startup
  validate_on_startup: true
  
  # Required validation checks
  checks:
    - "workspace_exists"           # Check workspace directories exist
    - "identity_files_exist"       # Check identity files exist
    - "api_keys_set"               # Check API keys in environment
    - "track_abc_alignment"        # Check Track A/B/C sync
    - "floor_assignments_valid"    # Check floor assignments match spec
    
  # Validation strictness
  strict_mode: true
  
  # Fail-closed on validation errors
  fail_closed: true

diagnostics:
  # Enable diagnostic logging
  enabled: true
  
  # Log level (DEBUG | INFO | WARNING | ERROR)
  log_level: "INFO"
  
  # Diagnostic log path
  log_path: "logs/agent_system.log"

# =============================================================================
# VERSION & METADATA
# =============================================================================

metadata:
  config_version: "47.0"
  arifos_version: "46.2.2"
  created_date: "2026-01-16"
  created_by: "Claude Code (Ω - Engineer)"
  last_modified: "2026-01-16"
  
  # Canonical references
  references:
    supreme_law: "AGENTS.md"
    l1_canon: "L1_THEORY/canon/"
    l2_specs: "L2_PROTOCOLS/v46/"
    l3_code: "arifos_core/"
  
  # Change log
  changelog:
    - version: "47.0"
      date: "2026-01-16"
      changes:
        - "Initial model-agnostic agent system configuration"
        - "Mapped 4 agents to existing workspaces"
        - "Defined LLM assignments for each role"
        - "Established session isolation policies"
        - "Configured constitutional governance settings"

# =============================================================================
# NOTES & DOCUMENTATION
# =============================================================================

# How to change LLM assignments:
# 1. Edit the 'llm.provider' and 'llm.model' fields above
# 2. Ensure corresponding API key environment variable is set
# 3. Restart agent sessions
# 4. Constitutional validation happens automatically
#
# Example: Switch Engineer from Claude to GPT-4:
#   engineer:
#     llm:
#       provider: "openai"
#       model: "gpt-4-turbo"
#       api_key_env: "OPENAI_API_KEY"
#
# Constitutional Principle:
#   - Roles (Architect, Engineer, Auditor, Validator) are IMMUTABLE (L1 Canon)
#   - LLM assignments are MUTABLE (Technology layer)
#   - Same LLM can fulfill multiple roles in DIFFERENT sessions
#   - Session isolation prevents cross-role contamination
#
# For more information:
#   - See: .antigravity/AGENT_INVENTORY_REPORT_v47.md
#   - See: AGENTS.md (Supreme constitutional law)
#   - See: identities/ (Simplified operational identities)
