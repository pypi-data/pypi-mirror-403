{
    "$schema": "../schema/policy_schema.json",
    "name": "FAG Policy",
    "version": "v45.0.3",
    "description": "File Access Governance policy - hardening features for constitutional file I/O",
    "snapshot": {
        "enabled": true,
        "storage": "memory",
        "max_snapshots": 100,
        "description": "Pre-Mutate Snapshot for F1 Amanah rollback contract"
    },
    "protected_paths": {
        "patterns": [
            "~/.vscode/",
            "~/.config/",
            "~/.ssh/",
            "~/.aws/",
            "~/.azure/",
            "~/.gcloud/",
            ".vscode/",
            ".idea/",
            ".vs/",
            "__pycache__/",
            "node_modules/",
            ".git/objects/",
            ".git/hooks/"
        ],
        "require_human_seal_token": true,
        "description": "No-touch zones blocked unless HUMAN_SEAL_TOKEN provided"
    },
    "watchdog": {
        "enabled": true,
        "burst_threshold": 10,
        "time_window_seconds": 60,
        "max_event_history": 100,
        "suspicious_patterns": {
            "rename_delete_chain": true,
            "mass_change_burst": true,
            "boundary_breach": true
        },
        "description": "Mutation Watchdog detecting suspicious file operation patterns"
    },
    "alerts": {
        "enabled": true,
        "entropy_threshold": 5.0,
        "consecutive_failure_limit": 2,
        "severity_levels": [
            "INFO",
            "WARN",
            "CRITICAL"
        ],
        "alert_codes": {
            "HIGH_ENTROPY": "Î”S exceeded threshold",
            "CONSECUTIVE_FAILURES": "Multiple governance failures detected",
            "WATCHDOG_ANOMALY": "Suspicious mutation pattern detected",
            "PROTECTED_PATH_ACCESS": "Attempted access to no-touch zone"
        },
        "description": "Operator alerts for entropy spikes and governance failures"
    },
    "health_check": {
        "enabled": true,
        "scan_interval_hours": 24,
        "checks": [
            "file_integrity",
            "policy_drift",
            "unusual_diffs"
        ],
        "description": "Optional daily repository integrity scan"
    }
}
