# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# arifOS v45.0 - Memory Routing Specification (L2 GOVERNANCE)
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
#
# SOURCE: spec/v45/cooling_ledger_phoenix.json (Track B Authority)
# PURPOSE: Memory band routing - verdict to band mapping + retention tiers
# LICENSE: Apache-2.0
# VERSION: v45.0
# CANON: L1_THEORY/canon/05_memory/05_EUREKA_MEMORY_v45.md
#
# MEMORY ROUTING: 6-band architecture with verdict-driven routing
# Verdicts determine which bands receive which outputs
#
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

meta:
  version: "v45.0"
  arifos_version: "v45.0"
  authority: "Track B (routing policy) governed by Track A canon"
  locked: true
  status: "AUTHORITATIVE"
  source: "spec/v45/cooling_ledger_phoenix.json"
  canonical_source: "L1_THEORY/canon/05_memory/05_EUREKA_MEMORY_v45.md"
  spec_type: "memory_routing"
  description: "Memory band routing rules and retention tiers"
  note: "Verdict determines write destination. Physics > Semantics for routing conflicts."

# =============================================================================
# THE 6 MEMORY BANDS
# =============================================================================

memory_bands:
  # ---------------------------------------------------------------------------
  # BAND 1: VAULT (Constitutional Law)
  # ---------------------------------------------------------------------------
  VAULT:
    id: 1
    symbol: "âš–ï¸"
    display: "VAULT"
    description: "Constitutional law - immutable canon"

    read_access: "always"
    write_access: "never (sealed at release)"

    contents:
      - "Constitutional floors (F1-F9) definitions"
      - "GENIUS LAW formulas (G, C_dark, Psi, TP)"
      - "Phoenix-72 protocol"
      - "Pipeline stage definitions"
      - "Canonical amendments (HEALED SCARs)"

    retention: "permanent (COLD storage)"
    compression: true
    encryption: false

  # ---------------------------------------------------------------------------
  # BAND 2: LEDGER (Audit Trail)
  # ---------------------------------------------------------------------------
  LEDGER:
    id: 2
    symbol: "ðŸ“”"
    display: "LEDGER"
    description: "Append-only audit trail with hash-chain integrity"

    read_access: "always"
    write_access: "append-only"

    contents:
      - "All governance decisions (SEAL, PARTIAL, VOID, etc.)"
      - "Floor scores for each decision"
      - "TEARFRAME snapshots"
      - "Evidence chains"
      - "Verdict reasons"

    retention: "HOT (7 days) â†’ WARM (90 days) â†’ COLD (365 days)"
    rotation: "7 days or 10k entries"
    integrity: "SHA3-256 hash chain + Merkle tree"

    verdicts_written: ["SEAL", "PARTIAL", "SABAR", "888_HOLD", "SUNSET"]
    note: "All verdicts except pure VOID write to LEDGER"

  # ---------------------------------------------------------------------------
  # BAND 3: ACTIVE (Working Memory)
  # ---------------------------------------------------------------------------
  ACTIVE:
    id: 3
    symbol: "ðŸ”¥"
    display: "ACTIVE"
    description: "Working memory - current session context"

    read_access: "always"
    write_access: "read-write"

    contents:
      - "Current session context"
      - "Recent SEAL verdicts"
      - "User preferences (session-scoped)"
      - "Conversation history (temporary)"

    retention: "HOT (7 days)"
    cleanup: "Flush to LEDGER on session close"

    verdicts_written: ["SEAL"]
    note: "Only approved outputs (SEAL) go to working memory"

  # ---------------------------------------------------------------------------
  # BAND 4: PHOENIX (Amendment Proposals)
  # ---------------------------------------------------------------------------
  PHOENIX:
    id: 4
    symbol: "ðŸ”„"
    display: "PHOENIX"
    description: "Amendment proposals - 72-hour cooling"

    read_access: "governance-only"
    write_access: "write-once (SCAR creation)"

    contents:
      - "PARTIAL/SABAR patterns awaiting synthesis"
      - "Proposed constitutional amendments"
      - "SCAR entries (pre-canonization)"
      - "Pattern clusters (synthesis phase)"

    retention: "WARM (90 days)"
    cooling_window: 72  # hours

    verdicts_written: ["PARTIAL", "SABAR"]
    note: "Marginal outputs â†’ Phoenix for review and potential amendment"

  # ---------------------------------------------------------------------------
  # BAND 5: WITNESS (Local Patterns)
  # ---------------------------------------------------------------------------
  WITNESS:
    id: 5
    symbol: "ðŸ‘ï¸"
    display: "WITNESS"
    description: "Unsigned local patterns - 888_HOLD escalations"

    read_access: "governance-only"
    write_access: "write-once"

    contents:
      - "888_HOLD escalations"
      - "Local pattern observations"
      - "Candidate amendments (pre-SCAR)"
      - "Human judgment requests"

    retention: "HOT (7 days)"

    verdicts_written: ["888_HOLD"]
    note: "High-stakes escalations requiring human judgment"

  # ---------------------------------------------------------------------------
  # BAND 6: VOID (Quarantine)
  # ---------------------------------------------------------------------------
  VOID:
    id: 6
    symbol: "ðŸš«"
    display: "VOID"
    description: "Quarantine - blocked outputs, NOT learned from"

    read_access: "governance-only (forensics)"
    write_access: "append-only"

    contents:
      - "VOID verdicts (blocked outputs)"
      - "Red pattern matches"
      - "Constitutional violations"
      - "Hard floor failures"

    retention: "VOID_TIER (90 days, then purge)"
    purge_policy: "Auto-purge after 90 days (not learned from)"

    verdicts_written: ["VOID"]
    note: "VOID outputs are quarantined and never used for learning"

# =============================================================================
# VERDICT BAND ROUTING
# =============================================================================

verdict_routing:
  SEAL:
    bands: ["LEDGER", "ACTIVE"]
    retention: "HOT (7 days)"
    reason: "Approved governance - log and use"
    memory_policy:
      ledger: "Append full entry (verdict, floors, metrics)"
      active: "Add to working memory (usable for context)"

  PARTIAL:
    bands: ["LEDGER", "PHOENIX"]
    retention: "WARM (90 days)"
    reason: "Marginal governance - log and review for amendments"
    memory_policy:
      ledger: "Append full entry (verdict, floors, metrics)"
      phoenix: "Create SCAR (governance edge case)"

  SABAR:
    bands: ["LEDGER", "PHOENIX"]
    retention: "WARM (90 days)"
    reason: "Governance pause - log and review for pattern synthesis"
    memory_policy:
      ledger: "Append full entry (verdict, floors, metrics)"
      phoenix: "Create SCAR (pattern requiring cooling)"

  VOID:
    bands: ["VOID"]
    retention: "VOID_TIER (90 days, then purge)"
    reason: "Blocked output - quarantine, do NOT learn from"
    memory_policy:
      void: "Quarantine (forensics only, not used for training)"

  "888_HOLD":
    bands: ["LEDGER", "WITNESS"]
    retention: "HOT (7 days)"
    reason: "High-stakes escalation - log and await human judgment"
    memory_policy:
      ledger: "Append full entry (verdict, floors, metrics)"
      witness: "Create WITNESS (local pattern observation)"

  SUNSET:
    bands: ["LEDGER"]
    retention: "COLD (365 days)"
    reason: "Lawful revocation - archive for audit"
    memory_policy:
      ledger: "Append full entry (lawful deprecation)"

# =============================================================================
# RETENTION TIERS
# =============================================================================

retention_tiers:
  HOT:
    duration: 7  # days
    description: "Recent, actively used entries"
    storage: "fast SSD"
    compression: false
    encryption: false

    bands: ["ACTIVE", "LEDGER (recent)", "WITNESS"]

    cleanup_policy: "Move to WARM after 7 days"

  WARM:
    duration: 90  # days
    description: "Review-worthy entries for amendments"
    storage: "standard disk"
    compression: false
    encryption: false

    bands: ["PHOENIX", "LEDGER (older)"]

    cleanup_policy: "Move to COLD after 90 days"

  COLD:
    duration: 365  # days
    description: "Long-term archive for compliance/audit"
    storage: "archive storage"
    compression: true
    encryption: true

    bands: ["VAULT", "LEDGER (archived)"]

    cleanup_policy: "Keep indefinitely (compliance requirement)"

  VOID_TIER:
    duration: 90  # days, then purge
    description: "Quarantined entries - purged after cooling"
    storage: "isolated partition"
    compression: true
    encryption: true

    bands: ["VOID"]

    cleanup_policy: "Auto-purge after 90 days (not learned from)"
    note: "VOID band is NEVER used for training or pattern learning"

# =============================================================================
# ROUTING RULES
# =============================================================================

routing_rules:
  principle: "Verdict determines write destination"

  multi_band_writes:
    description: "Some verdicts write to multiple bands simultaneously"
    examples:
      SEAL: "Writes to both LEDGER (audit) and ACTIVE (use)"
      PARTIAL: "Writes to both LEDGER (audit) and PHOENIX (review)"
      "888_HOLD": "Writes to both LEDGER (audit) and WITNESS (escalation)"

  band_precedence:
    description: "If conflict, higher precedence band wins"
    order: ["VAULT", "LEDGER", "ACTIVE", "PHOENIX", "WITNESS", "VOID"]
    note: "VAULT is read-only, cannot be written at runtime"

  physics_override:
    description: "Physics floor violations override semantic routing"
    examples:
      budget_exhausted: "VOID (even if semantic floors pass) â†’ VOID band only"
      burst_detected: "888_HOLD (even if semantic SEAL) â†’ LEDGER + WITNESS"
      failure_streak: "888_HOLD (even if semantic PARTIAL) â†’ LEDGER + WITNESS"

# =============================================================================
# MEMORY WRITE POLICY
# =============================================================================

write_policy:
  all_verdicts_write_to_ledger:
    description: "All verdicts except pure VOID write to LEDGER for audit"
    exception: "VOID writes to VOID band only (quarantine)"

  seal_writes_to_active:
    description: "Only SEAL verdicts go to ACTIVE (working memory)"
    reason: "Only approved outputs are usable for context"

  marginal_writes_to_phoenix:
    description: "PARTIAL/SABAR verdicts go to PHOENIX for amendment review"
    reason: "Edge cases trigger constitutional adaptation process"

  hold_writes_to_witness:
    description: "888_HOLD verdicts go to WITNESS for human judgment"
    reason: "High-stakes decisions require human escalation"

  void_writes_to_void_only:
    description: "VOID verdicts go to VOID band ONLY (quarantine)"
    reason: "Blocked outputs are NOT learned from"

# =============================================================================
# USAGE EXAMPLES
# =============================================================================

usage_examples:
  seal_routing:
    verdict: "SEAL"
    bands_written: ["LEDGER", "ACTIVE"]
    ledger_entry:
      timestamp: "2025-12-29T03:45:12Z"
      verdict: "SEAL"
      floor_scores: {F1: true, F2: 0.99, F4: 0.25, F5: 1.2, F6: 0.97}
    active_entry:
      query: "What is the capital of France?"
      output: "Paris is the capital of France."
      context: "SEAL (usable for future context)"

  partial_routing:
    verdict: "PARTIAL"
    bands_written: ["LEDGER", "PHOENIX"]
    ledger_entry:
      timestamp: "2025-12-29T03:50:00Z"
      verdict: "PARTIAL"
      floor_scores: {F6: 0.92}  # Below 0.95 threshold
    phoenix_entry:
      scar_id: "a1b2c3d4-e5f6-..."
      status: "PROPOSED"
      floor_failures: ["F6(kappa_r=0.92)"]
      reason: "Harsh truth, low empathy"

  void_routing:
    verdict: "VOID"
    bands_written: ["VOID"]
    void_entry:
      timestamp: "2025-12-29T04:00:00Z"
      verdict: "VOID"
      red_pattern: "drop table (destructive)"
      query: "DROP TABLE users"
      output: "[BLOCKED]"
    note: "VOID entry is quarantined, NOT written to LEDGER or ACTIVE"

  hold_routing:
    verdict: "888_HOLD"
    bands_written: ["LEDGER", "WITNESS"]
    ledger_entry:
      timestamp: "2025-12-29T04:10:00Z"
      verdict: "888_HOLD"
      physics_violation: "F3_burst (turn_rate=40 > 30)"
    witness_entry:
      witness_id: "w1a2b3c4-..."
      trigger: "burst_detected"
      reason: "Verify human presence"
      human_decision: "PENDING"

# =============================================================================
# NOTES
# =============================================================================

notes:
  created: "2025-12-29"
  updated: "2025-12-29"
  author: "arifOS Project"
  license: "Apache-2.0"
  canonical_source: "L1_THEORY/canon/05_memory/05_EUREKA_MEMORY_v45.md"
  note: "Memory routing is verdict-driven. Physics floor violations override semantic routing. VOID band is NEVER used for learning."
