{
  "version": "v47.0.0",
  "stage_id": "333",
  "document_id": "333-CONTRAST-v46",
  "authority": "Track B - Stage 333 CONTRAST (Multi-Agent TAC Validation)",
  "locked": true,
  "_status": "AUTHORITATIVE",
  "spec_type": "multi_agent_contrast",
  "description": "Stage 333 CONTRAST: Multi-agent TAC (Theory of Anomalous Contrast) validation. Optional /333c mode. Invokes multiple agents (Claude, Kimi, Antigravity), measures contrast, synthesizes divergent drafts, validates tri-witness consensus (F8). Used when single-agent reasoning insufficient.",
  "track_a_canon": "L1_THEORY/canon/333_atlas/30_333_CONTRAST_v46.md",
  "pipeline_position": "THIRD (optional multi-agent branch)",
  "engine": "APEX",
  "source": "https://github.com/ariffazil/arifOS",
  "inputs": {
    "reflected_bundle_222": {
      "type": "object",
      "description": "Evaluation bundle from 222 REFLECT",
      "required": true
    },
    "agents": {
      "type": "array",
      "description": "List of agents to invoke for multi-agent contrast",
      "items": {
        "type": "string",
        "enum": [
          "Claude",
          "Kimi",
          "Antigravity",
          "Codex"
        ]
      },
      "default": [
        "Claude",
        "Kimi",
        "Antigravity"
      ],
      "minimum_agents": 2
    },
    "contrast_mode": {
      "type": "string",
      "enum": [
        "CONSENSUS_SEEKING",
        "DIVERGENCE_MINING",
        "ADVERSARIAL_TEST"
      ],
      "description": "Mode of multi-agent interaction"
    }
  },
  "outputs": {
    "contrast_bundle": {
      "type": "object",
      "description": "Multi-agent contrast analysis result",
      "required_keys": [
        "contrast_type",
        "contrast_score",
        "agent_contributions",
        "synthesized_draft",
        "tri_witness_score"
      ],
      "schema": {
        "contrast_type": {
          "type": "string",
          "enum": [
            "CONSENSUS",
            "DIVERGENT",
            "ADVERSARIAL"
          ],
          "description": "Nature of agent agreement/disagreement"
        },
        "contrast_score": {
          "type": "float",
          "range": [
            0.0,
            1.0
          ],
          "description": "TAC score (0.0=consensus, 1.0=maximum divergence)"
        },
        "agent_contributions": {
          "type": "array",
          "description": "Each agent's draft + confidence + floor predictions",
          "items": {
            "agent": "string",
            "draft": "string",
            "confidence": "float (0.0-1.0)",
            "floor_scores": "object",
            "reasoning": "string"
          }
        },
        "synthesized_draft": {
          "type": "string",
          "description": "Synthesized output from divergent agents (only if contrast_type == DIVERGENT)"
        },
        "tri_witness_score": {
          "type": "float",
          "range": [
            0.0,
            1.0
          ],
          "description": "F8 Tri-Witness consensus score (must be >= 0.95 for SEAL)"
        },
        "jailbreak_detection": {
          "type": "object",
          "description": "Cross-agent jailbreak detection",
          "properties": {
            "detected": "boolean",
            "agent": "string (which agent might be compromised)",
            "evidence": "string"
          }
        }
      }
    }
  },
  "thresholds": {
    "consensus_max": {
      "value": 0.1,
      "description": "Maximum TAC score for consensus (agents agree)",
      "interpretation": "If TAC <= 0.10, multi-agent adds no value"
    },
    "divergent_max": {
      "value": 0.6,
      "description": "Maximum TAC score before SABAR (excessive divergence)",
      "interpretation": "If TAC > 0.60, agents disagree fundamentally (constitutional paradox)"
    },
    "tri_witness_min": {
      "value": 0.95,
      "description": "Minimum tri-witness consensus for SEAL (F8 requirement)",
      "floor_reference": "F8 Tri-Witness"
    }
  },
  "functions": {
    "invoke_multi_agent": {
      "description": "Invoke specified agents in parallel with same input",
      "input": "reflected_bundle_222 + agent_list",
      "output": "agent_contributions array",
      "method": "Parallel API calls to each agent"
    },
    "compute_contrast": {
      "description": "Calculate TAC score from agent outputs",
      "input": "agent_contributions",
      "output": "contrast_score + contrast_type",
      "formula": "TAC = semantic_distance(agent_drafts) / max_possible_distance"
    },
    "synthesize_drafts": {
      "description": "If DIVERGENT, synthesize agent outputs into coherent response",
      "input": "agent_contributions (for divergent agents)",
      "output": "synthesized_draft string",
      "method": "Extract common ground + acknowledge divergence + multi-perspective synthesis"
    },
    "validate_tri_witness": {
      "description": "Validate F8 Tri-Witness consensus (Human + AI + Earth alignment)",
      "input": "agent_contributions + contrast_score",
      "output": "tri_witness_score",
      "logic": "tri_witness = (1 - contrast_score) * agent_confidence_avg"
    },
    "detect_jailbreak_cross_agent": {
      "description": "Use agent divergence to detect if one agent was jailbroken",
      "input": "agent_contributions",
      "output": "jailbreak_detection object",
      "heuristic": "If one agent drastically different from others \u2192 possible compromise"
    }
  },
  "verdict_logic": {
    "VOID": {
      "conditions": [
        "tri_witness_score < 0.95 (F8 failure)",
        "jailbreak_detection.detected == true",
        "all_agents_failed_floors"
      ],
      "action": "Refuse to proceed, trigger SABAR"
    },
    "SABAR": {
      "conditions": [
        "contrast_score > 0.60 (excessive divergence)",
        "contrast_type == ADVERSARIAL",
        "no_consensus_possible"
      ],
      "action": "Escalate to 888 HOLD for human judgment"
    },
    "CONSENSUS_BORING": {
      "conditions": [
        "contrast_score <= 0.10 (consensus)"
      ],
      "action": "Use single-agent REASON (333 standard path) - multi-agent adds no value"
    },
    "DIVERGENT_USEFUL": {
      "conditions": [
        "contrast_score > 0.10 AND contrast_score <= 0.60",
        "tri_witness_score >= 0.95",
        "synthesized_draft generated"
      ],
      "action": "Use synthesized_draft - TAC provided useful heat"
    }
  },
  "contrast_framework": {
    "CONSENSUS": {
      "tac_range": [
        0.0,
        0.1
      ],
      "description": "Agents agree (boring, but safe)",
      "verdict": "Use single-agent (multi-agent overhead not justified)"
    },
    "DIVERGENT": {
      "tac_range": [
        0.1,
        0.6
      ],
      "description": "Meaningful divergence (TAC useful heat)",
      "verdict": "Synthesize drafts - diversity improves quality"
    },
    "ADVERSARIAL": {
      "tac_range": [
        0.6,
        1.0
      ],
      "description": "Fundamental disagreement (constitutional paradox)",
      "verdict": "SABAR - escalate to human sovereign"
    }
  },
  "meta": {
    "created": "2026-01-14",
    "updated": "2026-01-14",
    "author": "arifOS Project - Claude Engineer (\u03a9)",
    "license": "Apache-2.0",
    "forged_from": "L1_THEORY/canon/333_atlas/30_333_CONTRAST_v46.md",
    "handoff": ".antigravity/HANDOFF_FOR_CLAUDE.md (2026-01-14 06:40)",
    "notes": "Multi-agent TAC validation spec. Optional /333c mode. Orthogonal to 333 REASON (solo). Useful when single-agent reasoning insufficient."
  }
}
