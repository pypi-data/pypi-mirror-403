import{a as y,t as Qe,f as k}from"../chunks/cZ5dS-Bk.js";import"../chunks/D0ky-wp8.js";import{o as We,a as Ye}from"../chunks/C0R47HOl.js";import{l as Ze,a5 as Ge,a6 as Ke,P as Xe,a7 as et,a8 as tt,j as ke,k as ot,p as Ne,f as De,c as t,r as o,s as e,g as n,t as z,z as J,u as M,a as He,b as h,e as c,d as Pe,a9 as Re}from"../chunks/DxqtznRv.js";import{s as w,e as F}from"../chunks/BGP0akLM.js";import{p as Se,i as V}from"../chunks/C8zSuf0b.js";import{e as at,i as rt}from"../chunks/FF3P85hg.js";import{r as Be,a as Je}from"../chunks/D2iqoFGv.js";import{b as Ce}from"../chunks/CCFLHyNb.js";import{i as Me}from"../chunks/DvaMvQ_S.js";import{F as it}from"../chunks/Bypr0-Js.js";import{f as nt}from"../chunks/C8Jx7AEg.js";function ze(r,d,a=!1){if(r.multiple){if(d==null)return;if(!Xe(d))return et();for(var b of r.options)b.selected=d.includes(U(b));return}for(b of r.options){var l=U(b);if(tt(l,d)){b.selected=!0;return}}(!a||d!==void 0)&&(r.selectedIndex=-1)}function lt(r){var d=new MutationObserver(()=>{ze(r,r.__value)});d.observe(r,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),Ke(()=>{d.disconnect()})}function qe(r,d,a=d){var b=new WeakSet,l=!0;Ze(r,"change",u=>{var f=u?"[selected]":":checked",v;if(r.multiple)v=[].map.call(r.querySelectorAll(f),U);else{var _=r.querySelector(f)??r.querySelector("option:not([disabled])");v=_&&U(_)}a(v),ke!==null&&b.add(ke)}),Ge(()=>{var u=d();if(r===document.activeElement){var f=ot??ke;if(b.has(f))return}if(ze(r,u,l),l&&u===void 0){var v=r.querySelector(":checked");v!==null&&(u=U(v),a(u))}r.__value=u,l=!1}),lt(r)}function U(r){return"__value"in r?r.__value:r.value}var st=k('<button type="button" class="inline-block px-6 py-2.5 bg-blue-600 text-white font-medium text-xs leading-tight uppercase rounded shadow-md hover:bg-blue-700 hover:shadow-lg focus:bg-blue-700 focus:shadow-lg focus:outline-none focus:ring-0 active:bg-blue-800 active:shadow-lg transition duration-150 ease-in-out">Clear Barrier</button>'),dt=k(`<div class="flex justify-center"><div class="block p-6 border border-gray-200 bg-white w-full"><h5 class="text-gray-900 text-xl leading-tight font-medium mb-2"> </h5> <p class="text-gray-700 text-base mb-4"> <br/> <br/> <br/> <br/> <!></p> <div class="flex space-x-2"><button type="button" class="inline-block px-6 py-2.5 bg-blue-600 text-white font-medium text-xs leading-tight uppercase rounded shadow-md hover:bg-blue-700 hover:shadow-lg focus:bg-blue-700 focus:shadow-lg focus:outline-none focus:ring-0 active:bg-blue-800 active:shadow-lg transition duration-150 ease-in-out">Delete</button> <button type="button" class="inline-block px-6 py-2.5 bg-blue-600 text-white font-medium text-xs leading-tight uppercase rounded shadow-md hover:bg-blue-700 hover:shadow-lg focus:bg-blue-700 focus:shadow-lg focus:outline-none focus:ring-0 active:bg-blue-800 active:shadow-lg transition duration-150 ease-in-out" data-bs-toggle="modal" data-bs-target="#broker-set-barrier-model">Set Barrier</button> <!></div></div></div> <div class="modal fade fixed top-0 left-0 hidden w-full h-full outline-none overflow-x-hidden overflow-y-auto" id="broker-set-barrier-model" tabindex="-1" aria-labelledby="broker-set-barrier-model-title" aria-modal="true" role="dialog"><div class="modal-dialog modal-dialog-centered relative w-auto pointer-events-none"><div class="modal-content border-none shadow-lg relative flex flex-col w-full pointer-events-auto bg-white bg-clip-padding rounded-md outline-none text-current"><div class="modal-header flex flex-shrink-0 items-center justify-between p-4 border-b border-gray-200 rounded-t-md"><h5 class="text-xl font-medium leading-normal text-gray-800" id="broker-set-barrier-model-label">Modal title</h5> <button type="button" class="btn-close box-content w-4 h-4 p-1 text-black border-none rounded-none opacity-50 focus:shadow-none focus:outline-none focus:opacity-100 hover:text-black hover:opacity-75 hover:no-underline" data-bs-dismiss="modal" aria-label="Close"></button></div> <div class="modal-body relative p-4"><label for="broker-barrier-time-input" class="form-label inline-block mb-2 text-gray-700">Broker Barrier Time:</label> <input type="number" class="
        form-control
        block
        w-full
        px-3
        py-1.5
        text-base
        font-normal
        text-gray-700
        bg-white bg-clip-padding
        border border-solid border-gray-300
        rounded
        transition
        ease-in-out
        m-0
        focus:text-gray-700 focus:bg-white focus:border-blue-600 focus:outline-none
      " id="broker-barrier-time-input" placeholder="0"/></div> <div class="modal-footer flex flex-shrink-0 flex-wrap items-center justify-end p-4 border-t border-gray-200 rounded-b-md"><button type="button" class="inline-block px-6 py-2.5 bg-purple-600 text-white font-medium text-xs leading-tight uppercase rounded shadow-md hover:bg-purple-700 hover:shadow-lg focus:bg-purple-700 focus:shadow-lg focus:outline-none focus:ring-0 active:bg-purple-800 active:shadow-lg transition duration-150 ease-in-out" data-bs-dismiss="modal">Close</button> <button type="button" data-bs-dismiss="modal">Set Barrier</button></div></div></div></div>`,1);function ut(r,d){Ne(d,!1);let a=Se(d,"broker",24,()=>({})),b=Se(d,"callback",8,async()=>{}),l=Se(d,"broker_barrier_time",12,null),u=h(!1);const f="http://127.0.0.1:8080";async function v(){a()&&await fetch(`${f}/${a().name}`,{method:"DELETE",mode:"cors"}),await b()()}async function _(p){const g=await fetch(`${f}/${a().name}/barrier`,{method:"POST",mode:"cors",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({time:p})});await b()(),g.status==200?c(u,!0):console.log(g)}async function S(){const p=await fetch(`${f}/${a().name}/barrier`,{method:"DELETE",mode:"cors",headers:{Accept:"application/json","Content-Type":"application/json"}});await b()(),p.status==200?c(u,!1):console.log(p)}Me();var x=dt(),B=De(x),C=t(B),m=t(C),ee=t(m);o(m);var O=e(m,2),Q=t(O),W=e(Q,2),Y=e(W,2),A=e(Y,2),I=e(A,3);{var Z=p=>{var g=Qe();z(()=>w(g,`Barrier Time: ${l()??""}`)),y(p,g)};V(I,p=>{n(u)&&l()!=null&&l()!=null&&p(Z)})}o(O);var P=e(O,2),j=t(P),R=e(j,4);{var E=p=>{var g=st();F("click",g,S),y(p,g)};V(R,p=>{n(u)&&p(E)})}o(P),o(C),o(B);var G=e(B,2),K=t(G),X=t(K),q=e(t(X),2),N=e(t(q),2);Be(N),o(q);var $=e(q,2),D=e(t($),2);o($),o(X),o(K),o(G),z(()=>{w(ee,`Name: ${J(a()),M(()=>a().name)??""}`),w(Q,`Address: ${J(a()),M(()=>a().address)??""} `),w(W,` Is Connected: ${J(a()),M(()=>a().isConnected)??""} `),w(Y,` Is Open: ${J(a()),M(()=>a().isOpen)??""} `),w(A,` Is Root: ${J(a()),M(()=>a().isRoot)??""} `),Je(D,1,`inline-block px-6 py-2.5 bg-blue-600 text-white font-medium text-xs leading-tight uppercase rounded shadow-md focus:outline-none focus:ring-0 transition duration-150 ease-in-out ml-1
          ${l()!=null?"hover:bg-blue-700 hover:shadow-lg focus:bg-blue-700 active:bg-blue-800 active:shadow-lg focus:shadow-lg":"pointer-events-none opacity-60"}`),D.disabled=l()==null}),F("click",j,v),Ce(N,l),F("click",D,()=>_(l())),y(r,x),He()}var ct=k('<button type="button" data-mdb-ripple="true" data-mdb-ripple-color="light" class="inline-block px-6 py-2.5 bg-blue-600 text-white font-medium text-xs leading-tight uppercase rounded shadow-md hover:bg-blue-700 hover:shadow-lg focus:bg-blue-700 focus:shadow-lg focus:outline-none focus:ring-0 active:bg-blue-800 active:shadow-lg transition duration-150 ease-in-out" data-bs-toggle="modal" data-bs-target="#create-broker-model">Create New Broker</button>'),bt=k('<div class="py-2">Server is up and running with http interface.</div>'),vt=k('<li class="px-6 py-4 w-full"><!></li>'),pt=k('<div class="grow grid grid-areas-layout justify-items-stretch my-auto py-6"><div class="flex justify-center w-full"><ul class="bg-white rounded-lg border border-gray-200 w-full text-gray-900 py-4"><h4 class="px-6 py-2 font-medium leading-tight text-2xl mt-0 mb-2 text-blue-600 border-b border-gray-200">Brokers</h4> <!></ul></div></div>'),ft=k(`<div class="flex w-7/8 flex-col mt-6 mx-8"><div class="overflow-x-auto sm:-mx-6 lg:-mx-8"><div class="py-2 inline-block w-full sm:px-6 lg:px-8"><div class="flex justify-between"><div class="flex space-x-4 items-center"><button type="button" data-mdb-ripple="true" data-mdb-ripple-color="light" class="inline-block px-6 py-2.5 bg-blue-600 text-white font-medium text-xs leading-tight uppercase rounded shadow-md hover:bg-blue-700 hover:shadow-lg focus:bg-blue-700 focus:shadow-lg focus:outline-none focus:ring-0 active:bg-blue-800 active:shadow-lg transition duration-150 ease-in-out"> </button> <!></div> <!></div> <div class="flex flex-col h-full"><div class="grow grid grid-areas-layout justify-items-stretch my-auto"><!></div> <!></div></div></div></div> <div class="modal fade fixed top-0 left-0 hidden w-full h-full outline-none overflow-x-hidden overflow-y-auto" id="create-broker-model" tabindex="-1" aria-labelledby="create-broker-model-title" aria-modal="true" role="dialog"><div class="modal-dialog modal-dialog-centered relative w-auto pointer-events-none"><div class="modal-content border-none shadow-lg relative flex flex-col w-full pointer-events-auto bg-white bg-clip-padding rounded-md outline-none text-current"><div class="modal-header flex flex-shrink-0 items-center justify-between p-4 border-b border-gray-200 rounded-t-md"><h5 class="text-xl font-medium leading-normal text-gray-800">Create Broker</h5> <button type="button" class="btn-close box-content w-4 h-4 p-1 text-black border-none rounded-none opacity-50 focus:shadow-none focus:outline-none focus:opacity-100 hover:text-black hover:opacity-75 hover:no-underline" data-bs-dismiss="modal" aria-label="Close"></button></div> <div class="modal-body relative p-4"><label for="broker-name-input" class="form-label inline-block mb-2 text-gray-700">Broker Name:</label> <input type="text" class="
        form-control
        block
        w-full
        px-3
        py-1.5
        text-base
        font-normal
        text-gray-700
        bg-white bg-clip-padding
        border border-solid border-gray-300
        rounded
        transition
        ease-in-out
        m-0
        focus:text-gray-700 focus:bg-white focus:border-blue-600 focus:outline-none
      " id="broker-name-input" placeholder="broker-name"/></div> <div class="modal-body relative p-4"><label for="broker-port-input" class="form-label inline-block mb-2 text-gray-700">Broker Port:</label> <input type="text" class="
        form-control
        block
        w-full
        px-3
        py-1.5
        text-base
        font-normal
        text-gray-700
        bg-white bg-clip-padding
        border border-solid border-gray-300
        rounded
        transition
        ease-in-out
        m-0
        focus:text-gray-700 focus:bg-white focus:border-blue-600 focus:outline-none
      " id="broker-port-input" placeholder="23404"/></div> <div class="modal-body relative p-4"><label for="broker-core-type-input" class="form-label inline-block mb-2 text-gray-700">Broker Core Type:</label> <select id="broker-core-type-input" class="form-select appearance-none
            block
            w-full
            px-3
            py-1.5
            text-base
            font-normal
            text-gray-700
            bg-white bg-clip-padding bg-no-repeat
            border border-solid border-gray-300
            rounded
            transition
            ease-in-out
            m-0
            focus:text-gray-700 focus:bg-white focus:border-blue-600 focus:outline-none" aria-label="Core Type"><option>ZMQ</option><option>TCP</option><option>UDP</option></select></div> <div class="modal-body relative p-4"><label for="broker-log-level-input" class="form-label inline-block mb-2 text-gray-700">Broker Log Level:</label> <select id="broker-core-type-input" class="form-select appearance-none
            block
            w-full
            px-3
            py-1.5
            text-base
            font-normal
            text-gray-700
            bg-white bg-clip-padding bg-no-repeat
            border border-solid border-gray-300
            rounded
            transition
            ease-in-out
            m-0
            focus:text-gray-700 focus:bg-white focus:border-blue-600 focus:outline-none" aria-label="Log Level"><option>debug</option><option>trace</option><option>info</option><option>error</option><option>warning</option><option>none</option><option>data</option><option>connections</option><option>interfaces</option><option>profiling</option><option>summary</option><option>timing</option></select></div> <div class="modal-footer flex flex-shrink-0 flex-wrap items-center justify-end p-4 border-t border-gray-200 rounded-b-md"><button type="button" class="inline-block px-6 py-2.5 bg-purple-600 text-white font-medium text-xs leading-tight uppercase rounded shadow-md hover:bg-purple-700 hover:shadow-lg focus:bg-purple-700 focus:shadow-lg focus:outline-none focus:ring-0 active:bg-purple-800 active:shadow-lg transition duration-150 ease-in-out" data-bs-dismiss="modal">Close</button> <button type="button" data-bs-dismiss="modal">Create</button></div></div></div></div>`,1);function Et(r,d){Ne(d,!1);let a=h(!1),b=h([]),l=h(!0),u=h(!1),f=null,v=h("Broker1"),_=h(23404),S=h("zmq"),x=h("info");const B="http://127.0.0.1:5000/api",C="http://127.0.0.1:8080";async function m(){await ee(),await O(),await Q()}We(async()=>{await m(),await Pe(),c(l,!1),clearInterval(f),f=setInterval(async()=>{await m(),await Pe()},5e3)}),Ye(()=>{clearInterval(f)});async function ee(){try{const s=await(await fetch(`${C}/healthcheck`,{mode:"cors",headers:{"Content-Type":"application/json"}})).json();s&&c(a,s.success),n(a)&&console.log("Healthy server")}catch{console.log("Unable to reach server"),c(a,!1)}}async function O(){n(a)?(await(await fetch(`${B}/broker-server`)).json()).status?c(u,!0):c(u,!1):c(u,!1)}async function Q(){if(n(a)){const s=await(await fetch(`${C}/brokers`,{mode:"cors",headers:{"Content-Type":"application/json"}})).json();s&&c(b,s.brokers)}}async function W(){c(l,!0),await(await fetch(`${B}/broker-server`,{method:"POST",mode:"cors",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({status:!n(u)})})).json(),await m(),c(l,!1)}async function Y(i,s,T,L){if(n(a)){(s===""||s===null)&&(s=23404);var H;L==="info"?H={broker:i,port:s,core_type:T}:H={broker:i,port:s,log_level:L,core_type:T},console.log(JSON.stringify({broker:i,port:s,log_level:L,core_type:T})),c(l,!0);const xe=await fetch(`${C}/create`,{method:"POST",mode:"cors",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(H)});console.log(xe),await m(),c(l,!1)}}Me();var A=ft(),I=De(A),Z=t(I),P=t(Z),j=t(P),R=t(j),E=t(R),G=t(E);o(E);var K=e(E,2);it(K,{get icon(){return nt},get spin(){return n(l)}}),o(R);var X=e(R,2);{var q=i=>{var s=ct();y(i,s)};V(X,i=>{n(a)&&i(q)})}o(j);var N=e(j,2),$=t(N),D=t($);{var p=i=>{var s=bt();y(i,s)};V(D,i=>{n(a)&&i(p)})}o($);var g=e($,2);{var Fe=i=>{var s=pt(),T=t(s),L=t(T),H=e(t(L),2);at(H,1,()=>n(b),rt,(xe,Ve)=>{var we=vt(),Ue=t(we);ut(Ue,{get broker(){return n(Ve)},callback:m}),o(we),y(xe,we)}),o(L),o(T),o(s),y(i,s)};V(g,i=>{n(a)&&i(Fe)})}o(N),o(P),o(Z),o(I);var je=e(I,2),Ee=t(je),$e=t(Ee),te=e(t($e),2),Te=e(t(te),2);Be(Te),o(te);var oe=e(te,2),Le=e(t(oe),2);Be(Le),o(oe);var ae=e(oe,2),re=e(t(ae),2);z(()=>{n(S),Re(()=>{})});var ie=t(re);ie.value=ie.__value="zmq";var ne=e(ie);ne.value=ne.__value="tcp";var Oe=e(ne);Oe.value=Oe.__value="udp",o(re),o(ae);var le=e(ae,2),se=e(t(le),2);z(()=>{n(x),Re(()=>{})});var de=t(se);de.value=de.__value="debug";var ue=e(de);ue.value=ue.__value="trace";var ce=e(ue);ce.value=ce.__value="info";var be=e(ce);be.value=be.__value="error";var ve=e(be);ve.value=ve.__value="warning";var pe=e(ve);pe.value=pe.__value="none";var fe=e(pe);fe.value=fe.__value="data";var ge=e(fe);ge.value=ge.__value="connections";var me=e(ge);me.value=me.__value="interfaces";var he=e(me);he.value=he.__value="profiling";var _e=e(he);_e.value=_e.__value="summary";var Ae=e(_e);Ae.value=Ae.__value="timing",o(se),o(le);var Ie=e(le,2),ye=e(t(Ie),2);o(Ie),o($e),o(Ee),o(je),z(()=>{w(G,`${n(u)?"Stop":"Start"} Broker Server`),Je(ye,1,`inline-block px-6 py-2.5 bg-blue-600 text-white font-medium text-xs leading-tight uppercase rounded shadow-md focus:outline-none focus:ring-0 transition duration-150 ease-in-out ml-1
          ${n(v)!==""?"hover:bg-blue-700 hover:shadow-lg focus:bg-blue-700 active:bg-blue-800 active:shadow-lg focus:shadow-lg":"pointer-events-none opacity-60"}`),ye.disabled=n(v)==""}),F("click",E,async()=>await W()),Ce(Te,()=>n(v),i=>c(v,i)),Ce(Le,()=>n(_),i=>c(_,i)),qe(re,()=>n(S),i=>c(S,i)),qe(se,()=>n(x),i=>c(x,i)),F("click",ye,async()=>await Y(n(v),n(_),n(S),n(x))),y(r,A),He()}export{Et as component};
