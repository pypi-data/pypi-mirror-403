import{a as T,b as mt,c as Yt,f as ht}from"../chunks/cZ5dS-Bk.js";import"../chunks/D0ky-wp8.js";import{p as xt,b9 as Et,c as j,r as C,s as lt,t as dt,u as k,a as bt,ap as F,e as W,g as a,ba as wt,aq as Jt,f as $t,b as U,b5 as Kt}from"../chunks/DxqtznRv.js";import{s as Mt,e as Qt}from"../chunks/BGP0akLM.js";import{i as _t}from"../chunks/DvaMvQ_S.js";import{p as it,c as ct,s as Q,a as yt,b as ut}from"../chunks/C8zSuf0b.js";import{e as kt,d as st,i as At}from"../chunks/FF3P85hg.js";import{s as G,b as Pt}from"../chunks/D2iqoFGv.js";import{a as It,n as Zt,o as Lt,i as Tt,l as te,b as Nt,c as ee,d as gt,e as Ht,r as ne,f as ae,g as ft,s as St,h as jt,L as re}from"../chunks/COjgeFWH.js";import{s as Ct}from"../chunks/DcsVdkUI.js";import{D as ie}from"../chunks/DfmVMWXE.js";function oe(t=It){if(t===It)return Bt;if(typeof t!="function")throw new TypeError("compare is not a function");return(e,r)=>{const n=t(e,r);return n||n===0?n:(t(r,r)===0)-(t(e,e)===0)}}function Bt(t,e){return(t==null||!(t>=t))-(e==null||!(e>=e))||(t<e?-1:t>e?1:0)}function zt(t,e){let r;for(const n of t)n!=null&&(r<n||r===void 0&&n>=n)&&(r=n);return r}function Dt(t,e){let r;for(const n of t)n!=null&&(r>n||r===void 0&&n>=n)&&(r=n);return r}function Wt(t,e,r=0,n=1/0,l){if(e=Math.floor(e),r=Math.floor(Math.max(0,r)),n=Math.floor(Math.min(t.length-1,n)),!(r<=e&&e<=n))return t;for(l=l===void 0?Bt:oe(l);n>r;){if(n-r>600){const i=n-r+1,u=e-r+1,p=Math.log(i),s=.5*Math.exp(2*p/3),o=.5*Math.sqrt(p*s*(i-s)/i)*(u-i/2<0?-1:1),f=Math.max(r,Math.floor(e-u*s/i+o)),x=Math.min(n,Math.floor(e+(i-u)*s/i+o));Wt(t,e,f,x,l)}const d=t[e];let c=r,g=n;for(ot(t,r,e),l(t[n],d)>0&&ot(t,r,n);c<g;){for(ot(t,c,g),++c,--g;l(t[c],d)<0;)++c;for(;l(t[g],d)>0;)--g}l(t[r],d)===0?ot(t,r,g):(++g,ot(t,g,n)),g<=e&&(r=g+1),e<=g&&(n=g-1)}return t}function ot(t,e,r){const n=t[e];t[e]=t[r],t[r]=n}function se(t,e,r){if(t=Float64Array.from(Zt(t)),!(!(n=t.length)||isNaN(e=+e))){if(e<=0||n<2)return Dt(t);if(e>=1)return zt(t);var n,l=(n-1)*e,d=Math.floor(l),c=zt(Wt(t,d).subarray(0,d+1)),g=Dt(t.subarray(d+1));return c+(g-c)*(l-d)}}function vt(t,e,r){t=+t,e=+e,r=(l=arguments.length)<2?(e=t,t=0,1):l<3?1:+r;for(var n=-1,l=Math.max(0,Math.ceil((e-t)/r))|0,d=new Array(l);++n<l;)d[n]=t+n*r;return d}function pt(){var t=Lt().unknown(void 0),e=t.domain,r=t.range,n=0,l=1,d,c,g=!1,i=0,u=0,p=.5;delete t.unknown;function s(){var o=e().length,f=l<n,x=f?l:n,y=f?n:l;d=(y-x)/Math.max(1,o-i+u*2),g&&(d=Math.floor(d)),x+=(y-x-d*(o-i))*p,c=d*(1-i),g&&(x=Math.round(x),c=Math.round(c));var z=vt(o).map(function(D){return x+d*D});return r(f?z.reverse():z)}return t.domain=function(o){return arguments.length?(e(o),s()):e()},t.range=function(o){return arguments.length?([n,l]=o,n=+n,l=+l,s()):[n,l]},t.rangeRound=function(o){return[n,l]=o,n=+n,l=+l,g=!0,s()},t.bandwidth=function(){return c},t.step=function(){return d},t.round=function(o){return arguments.length?(g=!!o,s()):g},t.padding=function(o){return arguments.length?(i=Math.min(1,u=+o),s()):i},t.paddingInner=function(o){return arguments.length?(i=Math.min(1,o),s()):i},t.paddingOuter=function(o){return arguments.length?(u=+o,s()):u},t.align=function(o){return arguments.length?(p=Math.max(0,Math.min(1,o)),s()):p},t.copy=function(){return pt(e(),[n,l]).round(g).paddingInner(i).paddingOuter(u).align(p)},Tt.apply(s(),arguments)}function Ot(t,e){for(var r=new Array(e),n=0;n<e;++n)r[n]=t(n/(e-1));return r}function le(){var t=0,e=1,r,n,l,d,c=Nt,g=!1,i;function u(s){return s==null||isNaN(s=+s)?i:c(l===0?.5:(s=(d(s)-r)*l,g?Math.max(0,Math.min(1,s)):s))}u.domain=function(s){return arguments.length?([t,e]=s,r=d(t=+t),n=d(e=+e),l=r===n?0:1/(n-r),u):[t,e]},u.clamp=function(s){return arguments.length?(g=!!s,u):g},u.interpolator=function(s){return arguments.length?(c=s,u):c};function p(s){return function(o){var f,x;return arguments.length?([f,x]=o,c=s(f,x),u):[c(0),c(1)]}}return u.range=p(gt),u.rangeRound=p(Ht),u.unknown=function(s){return arguments.length?(i=s,u):i},function(s){return d=s,r=s(t),n=s(e),l=r===n?0:1/(n-r),u}}function ue(t,e){return e.domain(t.domain()).interpolator(t.interpolator()).clamp(t.clamp()).unknown(t.unknown())}function Ut(){var t=te(le()(Nt));return t.copy=function(){return ue(t,Ut())},ee.apply(t,arguments)}const fe=t=>ne(t[t.length-1]);var de=new Array(3).concat("fc8d59ffffbf91bfdb","d7191cfdae61abd9e92c7bb6","d7191cfdae61ffffbfabd9e92c7bb6","d73027fc8d59fee090e0f3f891bfdb4575b4","d73027fc8d59fee090ffffbfe0f3f891bfdb4575b4","d73027f46d43fdae61fee090e0f3f8abd9e974add14575b4","d73027f46d43fdae61fee090ffffbfe0f3f8abd9e974add14575b4","a50026d73027f46d43fdae61fee090e0f3f8abd9e974add14575b4313695","a50026d73027f46d43fdae61fee090ffffbfe0f3f8abd9e974add14575b4313695").map(ae);const Rt=fe(de);var ce=mt('<svg class="layercake-layout-svg svelte-1lxpxcd"><defs><!></defs><g class="layercake-layout-svg_g"><!></g></svg>');function ge(t,e){xt(e,!1);const r=()=>Q(o,"$containerWidth",d),n=()=>Q(f,"$containerHeight",d),l=()=>Q(x,"$padding",d),[d,c]=yt();let g=it(e,"element",12,void 0),i=it(e,"innerElement",12,void 0),u=it(e,"zIndex",8,void 0),p=it(e,"pointerEvents",8,void 0),s=it(e,"viewBox",8,void 0);const{containerWidth:o,containerHeight:f,padding:x}=Et("LayerCake");_t();var y=ce();let z;var D=j(y),I=j(D);Ct(I,e,"defs",{},null),C(D);var O=lt(D),R=j(O);Ct(R,e,"default",{get element(){return g()}},null),C(O),ct(O,S=>i(S),()=>i()),C(y),ct(y,S=>g(S),()=>g()),dt(()=>{G(y,"viewBox",s()),G(y,"width",r()),G(y,"height",n()),z=Pt(y,"",z,{"z-index":u(),"pointer-events":p()===!1?"none":null}),G(O,"transform",`translate(${l(),k(()=>l().left)??""}, ${l(),k(()=>l().top)??""})`)}),T(t,y),bt(),c()}function ve(t){return t}var pe=3,qt=1e-6;function me(t){return"translate("+t+",0)"}function he(t){return e=>+t(e)}function xe(t,e){return e=Math.max(0,t.bandwidth()-e*2)/2,t.round()&&(e=Math.round(e)),r=>+t(r)+e}function be(){return!this.__axis}function _e(t,e){var r=[],n=null,l=null,d=6,c=6,g=3,i=typeof window<"u"&&window.devicePixelRatio>1?0:.5,u=1,p="y",s=me;function o(f){var x=n??(e.ticks?e.ticks.apply(e,r):e.domain()),y=l??(e.tickFormat?e.tickFormat.apply(e,r):ve),z=Math.max(d,0)+g,D=e.range(),I=+D[0]+i,O=+D[D.length-1]+i,R=(e.bandwidth?xe:he)(e.copy(),i),S=f.selection?f.selection():f,X=S.selectAll(".domain").data([null]),q=S.selectAll(".tick").data(x,e).order(),Y=q.exit(),Z=q.enter().append("g").attr("class","tick"),V=q.select("line"),L=q.select("text");X=X.merge(X.enter().insert("path",".tick").attr("class","domain").attr("stroke","currentColor")),q=q.merge(Z),V=V.merge(Z.append("line").attr("stroke","currentColor").attr(p+"2",u*d)),L=L.merge(Z.append("text").attr("fill","currentColor").attr(p,u*z).attr("dy","0.71em")),f!==S&&(X=X.transition(f),q=q.transition(f),V=V.transition(f),L=L.transition(f),Y=Y.transition(f).attr("opacity",qt).attr("transform",function(N){return isFinite(N=R(N))?s(N+i):this.getAttribute("transform")}),Z.attr("opacity",qt).attr("transform",function(N){var tt=this.parentNode.__axis;return s((tt&&isFinite(tt=tt(N))?tt:R(N))+i)})),Y.remove(),X.attr("d",c?"M"+I+","+u*c+"V"+i+"H"+O+"V"+u*c:"M"+I+","+i+"H"+O),q.attr("opacity",1).attr("transform",function(N){return s(R(N)+i)}),V.attr(p+"2",u*d),L.attr(p,u*z).text(y),S.filter(be).attr("fill","none").attr("font-size",10).attr("font-family","sans-serif").attr("text-anchor","middle"),S.each(function(){this.__axis=R})}return o.scale=function(f){return arguments.length?(e=f,o):e},o.ticks=function(){return r=Array.from(arguments),o},o.tickArguments=function(f){return arguments.length?(r=f==null?[]:Array.from(f),o):r.slice()},o.tickValues=function(f){return arguments.length?(n=f==null?null:Array.from(f),o):n&&n.slice()},o.tickFormat=function(f){return arguments.length?(l=f,o):l},o.tickSize=function(f){return arguments.length?(d=c=+f,o):d},o.tickSizeInner=function(f){return arguments.length?(d=+f,o):d},o.tickSizeOuter=function(f){return arguments.length?(c=+f,o):c},o.tickPadding=function(f){return arguments.length?(g=+f,o):g},o.offset=function(f){return arguments.length?(i=+f,o):i},o}function ye(t){return _e(pe,t)}var we=mt("<rect><title> </title></rect>"),$e=mt('<g><!><text x="0"> </text></g>'),Me=ht('<div class="container"><svg></svg></div> <div class="container py-10"><!></div>',1);function ke(t,e){xt(e,!1);const r=()=>Q(st,"$store_data",c),n=()=>Q(D,"$data",c),l=()=>Q(I,"$width",c),d=()=>Q(O,"$height",c),[c,g]=yt(),i=U(),u=U(),p=U(),s=U(),o=U(),f=U(),x=U(),y=U(),z=U(),{data:D,width:I,height:O}=Et("LayerCake");function R(v){var $=1/0,w=-1/0;for(const[M,_]of Object.entries(v))for(const h of _)h[a(i)]<$&&($=h[a(i)]),h[a(u)]>w&&(w=h[a(u)]);return[$,w]}function S(v){var $=1/0,w=-1/0;for(const[M,_]of Object.entries(v))for(const h of _)h[a(u)]-h[a(i)]<$&&($=h[a(u)]-h[a(i)]),h[a(u)]-h[a(i)]>w&&(w=h[a(u)]-h[a(i)]);return[$,w]}function X({color:v,title:$,tickSize:w=6,width:M=320,height:_=44+w,marginTop:h=18,marginRight:H=0,marginBottom:E=16+w,marginLeft:P=0,ticks:et=M/64,tickFormat:A,tickValues:J}={}){St(a(Y)).selectAll("*").remove();const K=St(a(Y)).attr("width",M).attr("height",_).attr("viewBox",[0,0,M,_]).style("overflow","visible").style("display","block");let nt=b=>b.selectAll(".tick line").attr("y1",h+E-_),m;if(v.interpolate){const b=Math.min(v.domain().length,v.range().length);m=v.copy().rangeRound(Ot(gt(P,M-H),b)),K.append("image").attr("x",P).attr("y",h).attr("width",M-P-H).attr("height",_-h-E).attr("preserveAspectRatio","none").attr("xlink:href",q(v.copy().domain(Ot(gt(0,1),b))).toDataURL())}else if(v.interpolator){if(m=Object.assign(v.copy().interpolator(Ht(P,M-H)),{range(){return[P,M-H]}}),K.append("image").attr("x",P).attr("y",h).attr("width",M-P-H).attr("height",_-h-E).attr("preserveAspectRatio","none").attr("xlink:href",q(v.interpolator()).toDataURL()),!m.ticks){if(J===void 0){const b=Math.round(et+1);J=vt(b).map(at=>se(v.domain(),at/(b-1)))}typeof A!="function"&&(A=jt(A===void 0?",f":A))}}else if(v.invertExtent){const b=v.thresholds?v.thresholds():v.quantiles?v.quantiles():v.domain(),at=A===void 0?B=>B:typeof A=="string"?jt(A):A;m=ft().domain([-1,v.range().length-1]).rangeRound([P,M-H]),K.append("g").selectAll("rect").data(v.range()).join("rect").attr("x",(B,rt)=>m(rt-1)).attr("y",h).attr("width",(B,rt)=>m(rt)-m(rt-1)).attr("height",_-h-E).attr("fill",B=>B),J=vt(b.length),A=B=>at(b[B],B)}else m=pt().domain(v.domain()).rangeRound([P,M-H]),K.append("g").selectAll("rect").data(v.domain()).join("rect").attr("x",m).attr("y",h).attr("width",Math.max(0,m.bandwidth()-1)).attr("height",_-h-E).attr("fill",v),nt=()=>{};return K.append("g").attr("transform",`translate(0,${_-E})`).call(ye(m).ticks(et,typeof A=="string"?A:void 0).tickFormat(typeof A=="function"?A:void 0).tickSize(w).tickValues(J)).call(nt).call(b=>b.select(".domain").remove()).call(b=>b.append("text").attr("x",P).attr("y",h+E-_-6).attr("fill","currentColor").attr("text-anchor","start").attr("font-weight","bold").text($)),K.node()}function q(v,$=256){var w=document.createElement("canvas");w.width=$,w.height=1;const M=w.getContext("2d");for(let _=0;_<$;++_)M.fillStyle=v(_/($-1)),M.fillRect(_,0,1,1);return w}let Y=U(null);F(()=>r(),()=>{W(i,r().profile_toggle_value=="real_time"?"r_enter":"s_enter")}),F(()=>r(),()=>{W(u,r().profile_toggle_value=="real_time"?"r_end":"s_end")}),F(()=>(n(),l(),a(i),a(u)),()=>{X({color:Ut(S(n()).reverse(),Rt),title:"Simulation Time (s)",width:l(),start_index:a(i),end_index:a(u)})}),F(()=>n(),()=>{W(p,Object.keys(n()))}),F(()=>(a(p),d()),()=>{W(s,pt().domain(a(p)).range([d(),0]))}),F(()=>(a(o),a(f),n(),a(i),a(u)),()=>{(v=>{var $=wt(v,2);W(o,$[0]),W(f,$[1])})(R(n(),a(i),a(u)))}),F(()=>(a(o),a(f),l()),()=>{W(x,ft().domain([a(o),a(f)]).range([75,l()-100]))}),F(()=>n(),()=>{W(y,v=>Rt(ft().domain(S(n())).range([1,0])(v)))}),F(()=>r(),()=>{W(z,r().profile_toggle_value=="real_time"?1e9:1)}),Jt(),_t();var Z=Me(),V=$t(Z),L=j(V);ct(L,v=>W(Y,v),()=>a(Y)),C(V);var N=lt(V,2),tt=j(N);ge(tt,{get viewBox(){return`0 0 ${l()??""} ${d()??""}`},children:(v,$)=>{var w=Yt(),M=$t(w);kt(M,1,()=>(n(),k(()=>Object.entries(n()))),At,(_,h)=>{var H=Kt(()=>wt(a(h),2));let E=()=>a(H)[0],P=()=>a(H)[1];var et=$e(),A=j(et);kt(A,1,P,At,(nt,m)=>{var b=we(),at=j(b),B=j(at);C(at),C(b),dt((rt,Vt,Ft,Gt,Xt)=>{G(b,"x",rt),G(b,"y",Vt),G(b,"width",Ft),G(b,"height",(d(),a(p),k(()=>d()/a(p).length*.9))),Pt(b,`fill:${Gt??""};stroke-width:0.25;stroke:rgb(0,0,0)`),Mt(B,`${E()??""} (time = ${a(m),k(()=>a(m).s_enter)??""}): elapsed = ${Xt??""}s`)},[()=>(a(x),a(m),a(i),k(()=>100+a(x)(a(m)[a(i)]))),()=>(a(s),a(m),k(()=>a(s)(a(m).name)+75)),()=>(a(x),a(m),a(u),a(i),k(()=>a(x)(a(m)[a(u)])-a(x)(a(m)[a(i)]))),()=>(a(y),a(m),a(u),a(i),k(()=>a(y)(a(m)[a(u)]-a(m)[a(i)]))),()=>(a(m),a(u),a(i),k(()=>(a(m)[a(u)]-a(m)[a(i)]).toFixed(2)))]),T(nt,b)});var J=lt(A),K=j(J,!0);C(J),C(et),dt(nt=>{G(J,"y",nt),Mt(K,E())},[()=>(a(s),E(),k(()=>a(s)(E())+100))]),T(_,et)}),T(v,w)},$$slots:{default:!0}}),C(N),T(t,Z),bt(),g()}var Ae=ht(`<p>Drag 'n' drop a "profile.txt" file here, or click to select a "profile.txt" file</p>`),Ie=ht('<div class="container flex w-7/8 flex-col mt-6 svelte-maq4gq"><div class="overflow-x-auto"><div class="py-2 inline-block w-full sm:px-6 lg:px-8"><div class="flex space-x-4"><!> <button type="button" class="inline-block px-6 py-2.5 bg-blue-600 text-white font-medium text-xs leading-tight uppercase rounded shadow-md hover:bg-blue-700 hover:shadow-lg focus:bg-blue-700 focus:shadow-lg focus:outline-none focus:ring-0 active:bg-blue-800 active:shadow-lg transition duration-150 ease-in-out">Clear</button></div></div></div> <div class="flex flex-grow my-4 w-full place-items-center"><!></div></div>');function He(t,e){xt(e,!1);const r=()=>Q(st,"$data",n),[n,l]=yt(),d="http://127.0.0.1:5000/api";let c={accepted:[],rejected:[]};async function g(){ut(st,k(r).profile=await(await fetch(`${d}/profiler`)).json(),k(r))}async function i(I){const{acceptedFiles:O,fileRejections:R}=I.detail;c.accepted=[...c.accepted,...O],c.rejected=[...c.rejected,...R];var S=new FormData;S.append("file",c.accepted.at(-1)),await fetch(`${d}/profiler`,{method:"POST",body:S}),await g()}async function u(I){ut(st,k(r).profile=[],k(r))}_t();var p=Ie(),s=j(p),o=j(s),f=j(o),x=j(f);ie(x,{multiple:"false",$$events:{drop:i},children:(I,O)=>{var R=Ae();T(I,R)},$$slots:{default:!0}});var y=lt(x,2);C(f),C(o),C(s);var z=lt(s,2),D=j(z);re(D,{get data(){return r().profile},set data(I){ut(st,k(r).profile=I,k(r))},children:(I,O)=>{ke(I,{})},$$slots:{default:!0},$$legacy:!0}),C(z),C(p),Qt("click",y,u),T(t,p),bt(),l()}export{He as component};
