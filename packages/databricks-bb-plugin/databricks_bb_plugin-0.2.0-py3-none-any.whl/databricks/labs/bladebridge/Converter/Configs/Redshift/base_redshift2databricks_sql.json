{
	"inherit_from":["final_master_dbx_sql_scripting.json"],
	"target_file_extension" : "sql",
	"code_fragment_breakers": {
		"line_end": ["\;"]
	},
	"statement_end" : ";",
	"apply_lateral_column_adjustment" : true,
	"auto_alias_columns" : true	,
	"datepart_translations" : { // case sensitive! will be processed lengthier pattern first (yyyy goes before DD)
		
		"Y,YYY" : "y,yyy",
		"IYYY" : "y",
		"YYYY" : "y",
		"YY" : "yy",
		"Y" : "y",
		"MONTH":"MMMM",
		"Month":"MMMM",
		"month":"MMMM",
		"MON" : "MMM",
		"Mon" : "MMM",
		"mon" : "MMM",
		"WW":"WEEK",
		"IW":"WEEK",
		"IDDD" : "D",
		"DDD" : "d",
		"DD" : "dd",
		"TZH\:TZM":"z",
		"TZ":"z",
		"tz":"z",
		"BC":"G",
		"B.C.":"G",
		"bc":"G",
		"b.c.":"G",
		"AD":"G",
		"A.D.":"G",
		"ad":"G",
		"a.d.":"G",
		"Day":"EEEE ",
		"day":"EEEE ",
		"DAY":"EEEE ",
		"DY":"EEE",
		"Dy":"EEE",
		"dy":"EEE",
		"hh24" : "HH",
		"hh12" : "hh",
		"HH24" : "HH",
		"HH12" : "hh",
		"mi" : "mm",
		"MI" : "mm",
		"Mi" : "mm",
		"OF" : "xxx",
		"MS" : "SSS",
		"US" : "SSSSSS",
		"xFF": "SSSSSS",
		"AM" : "a",
		"am" : "a",
		"PM" : "a",
		"pm" : "a",
		"A.M." : "a",
		"a.m." : "a",
		"P.M." : "a",
		"p.m." : "a",
		"(?<!S)SS(?!S)" : "ss",
		"\'T\'":"\'T\'",
		"\"":"\'"		
	},
	"line_subst" : [
		{"from" : "\bat\s+time\s+zone\s+\'UTC\'\s+\bat\s+time\s+zone\b", "to" : "AT TIME ZONE"},
		{"from" : "\b(\w+\.?\w*)\s+at\s+time\s+zone\s+(\'.*?\')", "to" : "from_utc_timestamp($1, $2)"},
		{"from" : "DEFAULT\s+NULL\s*\,", "to" : ",--FIXME databricks.migration.unsupported.feature Redshift UNSUPPORTED DEFAULT NULL\n", "statement_categories" : ["TABLE_DDL"]}, //change NOT NULL to NOT_NULL
		{"from" : "\"(\w+)\"", "to" : "$1", "statement_categories" : ["TABLE_DDL"]} ,
		{"from" : "NOT\s+NULL", "to" : "NOT_NULL", "statement_categories" : ["TABLE_DDL"]}, //change NOT NULL to NOT_NULL
		{"from" : "\bNULL\b", "to" : "", "statement_categories" : ["TABLE_DDL"]}, // get rid of NULL words
		{"from" : "NOT_NULL", "to" : "NOT NULL", "statement_categories" : ["TABLE_DDL"]}, //change back from NOT_NULL to NOT NULL
			
		// datatype mapping start
		{"from" : "GENERATED\s+BY\s+DEFAULT\s+AS\s+identity\s*\(\s*(\d+)\s*\,\s*(\d+)\s*\)\s+NOT\s*NULL", "to" : "GENERATED BY DEFAULT AS IDENTITY(START WITH $1 INCREMENT BY $2)", "statement_categories" : ["TABLE_DDL"]},
		{"from" : "GENERATED\s+BY\s+DEFAULT\s+AS\s+identity\s*\(\s*(\d+)\s*\,\s*(\d+)\s*\)", "to" : "GENERATED BY DEFAULT AS IDENTITY(START WITH $1 INCREMENT BY $2)", "statement_categories" : ["TABLE_DDL"]},

		{"from" : "identity\s*\(\s*(\d+)\s*\,\s*(\d+)\s*\)", "to" : "GENERATED ALWAYS AS IDENTITY (START WITH $1 INCREMENT BY $2)", "statement_categories" : ["TABLE_DDL"]},

		{"from" : "identity\s+NOT\s+NULL", "to" : "GENERATED ALWAYS AS IDENTITY","statement_categories" : ["TABLE_DDL"]},
		{"from" : "\bint\s*\(\s*\d+\s*\)\s+identity\s*\(.*?\)", "to" : "BIGINT GENERATED ALWAYS AS IDENTITY", "statement_categories" : ["TABLE_DDL"]},
		{"from" : "\bcompound\s+sortkey\b","to" : "compound_sortkey", "statement_categories" : ["TABLE_DDL"]},
		{"from" : "diststyle\s+(?!on)(\w+)","to" : ""},
		{"from" : "\binterleaved\s+sortkey\b","to" : "interleaved_sortkey", "statement_categories" : ["TABLE_DDL"]},
		{"from" : "int\s+identity\s*\(.*?\)", "to" : "BIGINT GENERATED ALWAYS AS IDENTITY", "statement_categories" : ["TABLE_DDL"]},

		{"from" : "\bencode\b\s+(\w+)\s*\,", "to" : ","},
		{"from" : "\bencode\b\s+(\w+)", "to" : ""},
		{"from" : "(\w+\s+\w+\(*\d*\)*)\s+PRIMARY\s+KEY\s*\,", "to" : "$1,-- FIXME databricks.migration.unsupported.feature PRIMARY KEY", "statement_categories" : ["TABLE_DDL"]},
		{"from" : "(?<!\_DONE\_)PRIMARY\s+KEY\s*\((.*?)\)", "to" : "CONSTRAINT $1 _DONE_PRIMARY KEY($1)", "statement_categories" : ["TABLE_DDL"]},
		{"from" : "(?<!\_DONE\_)FOREIGN\s+KEY\s*\((.*?)\)", "to" : "CONSTRAINT $1 _DONE_FOREIGN KEY($1)", "statement_categories" : ["TABLE_DDL"]},
		{"from" : "\bTIMESTAMP\s+WITHOUT\s+TIME\s+ZONE\b", "to" : "TIMESTAMP"},
		{"from" : "\bHLLSKETCH\b\s+\,", "to" : "HLLSKETCH,--FIXME databricks.migration.unsupported.feature Redshift UNSUPPORTED TYPE","statement_categories" : ["TABLE_DDL"]},
		{"from" : "\bGEOMETRY\b\s+\,", "to" : "GEOMETRY,--FIXME databricks.migration.unsupported.feature Redshift UNSUPPORTED TYPE","statement_categories" : ["TABLE_DDL"]},
		{"from" : "\bSUPER\b\s+\,", "to" : "SUPER,--FIXME databricks.migration.unsupported.feature Redshift UNSUPPORTED TYPE","statement_categories" : ["TABLE_DDL"]},

		{"from" : "\bTIMESTAMPTZ\b", "to" : "TIMESTAMP"}, 
		{"from" : "\bTIMETZ\b", "to" : "TIMESTAMP"}, 
		{"from" : "\bTIMESTAMP\s+WITH\s+TIME\s+ZONE\b", "to" : "TIMESTAMP"}, 
		{"from" : "\bNUMBER\b(?!\s*\()", "to" : "NUMERIC"},
		{"from" : "AS\s+\bNUMBER\b(?!\s*\()", "to" : "AS NUMERIC"},
		{"from" : "\:\:NUMBER\b\s*(?!\()", "to" : "\:\:NUMERIC"},
		{"from" : "\bNUMBER\b\s*\(", "to" : "NUMERIC("},
		{"from" : "AS\s+\bNUMBER\b", "to" : "AS NUMERIC"},
		{"from" : "\:\:NUMBER\b(?!\s*\()", "to" : "::NUMERIC"},
		{"from" : "\bNUMBER\b\s*\(", "to" : "NUMERIC("},
		{"from" : "\bNUMBER\b", "to" : "NUMERIC"},
		{"from" : "\bNUMBER\b\s*\(", "to" : "NUMERIC("},
		{"from" : "AS\s+\bNUMBER\b", "to" : "AS NUMERIC"},
		{"from" : "\:\:NUMBER\b", "to" : "\:\:NUMERIC"},
		{"from" : "\bCHAR\s*\(.*?\)", "to" : "STRING"},
		{"from" : "\bNCHAR\s*\(.*?\)", "to" : "STRING"},
		{"from" : "\bVARCHAR\s*\(.*?\)", "to" : "STRING"},
		{"from" : "\bNVARCHAR\s*\(.*?\)", "to" : "STRING"},
		{"from" : "\bNVARCHAR2\s*\(.*?\)", "to" : "STRING"},
		{"from" : "\bVARCHAR\s*\(.*?\)", "to" : "STRING"},
		{"from" : "CHARACTER\s+VARYING\s*\(.*?\)","to" : "STRING"},
		{"from" : "CHARACTER\s+VARYING","to" : "STRING"},
		{"from" : "\bCHARACTER\s*\(.*?\)", "to" : "STRING"},
		{"from" : "\bCHAR\b", "to" : "STRING"},
		
		{"from" : "\bNCHAR\b", "to" : "STRING"},
		{"from" : "\:\:NCHAR\b", "to" : "::STRING"},
		{"from" : "as\s+ NCHAR\b", "to" : "as STRING"},
		{"from" : "\bVARCHAR\b\s*\(\d+\)", "to" : "STRING"},
		{"from" : "\bVARCHAR\b", "to" : "STRING"},
		{"from" : "\:\:VARCHAR\b", "to" : "::STRING"},
		{"from" : "as\s+VARCHAR\b", "to" : "as STRING"},
		
		{"from" : "\bNVARCHAR\b", "to" : "STRING"},
		{"from" : "\:\:NVARCHAR\b", "to" : "::STRING"},
		{"from" : "as\s+NVARCHAR\b", "to" : "as STRING"},
		
		{"from" : "\bVARCHAR2\b", "to" : "STRING"},
		{"from" : "\:\:VARCHAR2\b", "to" : "::STRING"},
		{"from" : "as\s+VARCHAR2\b", "to" : "as STRING"},
		
		{"from" : "\bNVARCHAR2\b", "to" : "STRING"},
		{"from" : "\:\:NVARCHAR2\b", "to" : "::STRING"},
		{"from" : "\bas\s+NVARCHAR2\b", "to" : "as STRING"},
		
		{"from" : "\bCHARACTER\b", "to" : "STRING"},
		{"from" : "\:\:CHARACTER\b", "to" : "::STRING"},
		{"from" : "as\s+CHARACTER\b", "to" : "as STRING"}, 		
		{"from" : "\bTEXT\s*\(.*?\)", "to" : "STRING"},
		{"from" : "\bTEXT\b", "to" : "STRING"},
		{"from" : "\:\:TEXT\b", "to" : "::STRING"},
		{"from" : "as\s+TEXT\b", "to" : "as STRING"}, 	
		{"from" : "\bVARBINARY\b", "to" : "BINARY"},
		{"from" : "\bBYTEINT\b", "to" : "TINYINT"},
		{"from" : "FLOAT4", "to" : "FLOAT"},
		{"from" : "FLOAT8", "to" : "FLOAT"},
		{"from" : "\bdatetime\b", "to" : "TIMESTAMP"},
		{"from" : "\bSET\s+time\b", "to" : "SET_TIME_TEMP_HOLDER"},
		{"from" : "([\-|\+|\,])\s+(\btime\b)", "to" : "$1$2"},
		{"from" : "\border\s+by\s+(\btime\b)", "to" : "ORDER_BY_$1"},
		{"from" : "\bAT\s+(\btime\b)", "to" : "AT_$1"},
		{"from" : "(?<![\.,\"\`\(\-\+\,])\btime\b\s*(?!\))", "to" : "TIMESTAMP "},
		{"from" : "\bORDER_BY_(TIME\b)", "to" : "ORDER BY $1"},
		{"from" : "\bAT_(TIME\b)", "to" : "AT $1"},
		{"from" : "\bSET_TIME_TEMP_HOLDER\b", "to" : "SET TIME"},

		{"from" : "\btimestamp_ntz\b", "to" : "TIMESTAMP"},
		{"from" : "\btimestamp_ltz\b", "to" : "TIMESTAMP"},
		{"from" : "\btimestamp_tz\b", "to" : "TIMESTAMP"},
		{"from" : "\bBINARY\s*\(.*?\)", "to" : "BINARY"},
		{"from" : "\bNUMBER\s*\(\s*\*\s*\,\s*\d\s*\)", "to" : "NUMERIC"},
		{"from" : "\bSTRING\s*\(.*?\)", "to" : "STRING"},
		{"from" : "\bnchar\b", "to" : "string"},
		{"from" : "\bnvarchar\b", "to" : "string"},
		{"from" : "\bchar\b", "to" : "string"},
		{"from" : "\bcharacter\b", "to" : "string"},
		{"from" : "\bbpchar\b", "to" : "string"},
		{"from" : "\bvarchar\b", "to" : "string"},
		{"from" : "\bCHARACTER\s+VARYING", "to" : "string"},
		{"from" : "\bTEXT\b", "to" : "string"},
		{"from" : "\bBYTE\b", "to" : "BINARY"},
		{"from" : "\bVARBYTE\b", "to" : "BINARY"},
		{"from" : "\bVARBINARY\b", "to" : "BINARY"}, //1
		{"from" : "\bTO_HEX\b", "to" : " HEX"},    
		{"from" : "\bFROM_HEX\b", "to" : "HEX"},
		{"from" : "\bINT2", "to" : "INT"},
		{"from" : "\bINT4", "to" : "INT"},
		{"from" : "\bINT8", "to" : "BIGINT"},
		{"from" : "\bFLOAT4\b", "to" : "FLOAT"},
		{"from" : "\bREAL\b", "to" : "FLOAT"},
		{"from" : "DOUBLE\s+PRECISION", "to" : "FLOAT"},
		{"from" : "\bBOOL\b", "to" : "BOOLEAN"},
		{"from" : "\bTIMESTAMP\s+WITHOUT\s+TIME\s+ZONE\b", "to" : "TIMESTAMP"},
		{"from" : "\bTIMESTAMP\s+WITH\s+TIME\s+ZONE\b", "to" : "TIMESTAMP"},
		{"from" : "\bTIMEZ\b", "to" : "TIMESTAMP"},
		{"from" : "\bINTEGER\s*\(.*?\)", "to" : "INTEGER"},
		{"from" : "\bINT\s*\(.*?\)", "to" : "INTEGER"},
		// datatype mapping end
		
		{"from" : "\bCOLLATE\b\s+(\w+)", "to" : "/*commented collation $1*/"},
		{"from" : "\'(\d\d)\-(\w\w\w)\-(\d\d\d\d)\'", "to" : "'$3-$2-$1'"},
		{"from" : "\'(\d\d)\.(\w\w\w)\.(\d\d\d\d)\'", "to" : "'$3.$2.$1'"},
		{"from" : "\'(\d\d)\/(\w\w\w)\/(\d\d\d\d)\'", "to" : "'$3/$2/$1'"},
		{"from" : "\'(\d\d)\-([0-1][3-9]+)\-(\d\d\d\d)\'", "to" : "'$3-$1-$2'"},

		{"from" : "\'(\d\d)\-(\w+)\-(\d\d\d\d)\'", "to" : "'$3-$2-$1'"},
		{"from" : "\'(\d\d)\.(\w+)\.(\d\d\d\d)\'", "to" : "'$3.$2.$1'"},
		{"from" : "\'(\d\d)\/(\w+)\/(\d\d\d\d)\'", "to" : "'$3/$2/$1'"},
		{"from" : "TO_CHAR\s*\(\s*(\w+)\s*\,\s*\'Mon\'\s*\)", "to" : "DATE_FORMAT($1,'MMM')"},
		{"from" : "TO_CHAR\s*\(\s*\((\w+\s*\(*\s*\)*)\s*\:\:timestamp\s+AT\s+time\s+zone\s+(\'.*?\')\s*\)\:*\:*\w+\s*\,\s*\'IWIYYY\'\s*\)", "to" : "EXTRACT(WEEK from from_utc_timestamp(to_utc_timestamp($1, current_timezone()), $2))||EXTRACT(YEAROFWEEK from from_utc_timestamp(to_utc_timestamp($1, current_timezone()), $2))"},
		{"from" : "TO_CHAR\s*\(\s*\((\w+\s*\(*\s*\)*)\s*\:\:timestamp\s+AT\s+time\s+zone\s+(\'.*?\')\s*\)\:*\:*\w+\s*\,\s*\'IW\-IYYY\'\s*\)", "to" : "EXTRACT(WEEK from from_utc_timestamp(to_utc_timestamp($1, current_timezone()), $2))||'-'||EXTRACT(YEAROFWEEK from from_utc_timestamp(to_utc_timestamp($1, current_timezone()), $2))"},
		{"from" : "TO_CHAR\s*\(\s*\((\w+\s*\(*\s*\)*)\s*\:\:timestamp\s+AT\s+time\s+zone\s+(\'.*?\')\s*\)\:*\:*\w+\s*\,\s*\'IYYYIW\'\s*\)", "to" : "EXTRACT(YEAROFWEEK from from_utc_timestamp(to_utc_timestamp($1, current_timezone()), $2))||EXTRACT(WEEK from from_utc_timestamp(to_utc_timestamp($1, current_timezone()), $2))"},
		{"from" : "TO_CHAR\s*\(\s*\((\w+\s*\(*\s*\)*)\s+AT\s+time\s+zone\s+(\'.*?\')\s*\)\:*\:*\w+\s*\,\s*\'IWIYYY\'\s*\)", "to" : "EXTRACT(WEEK from from_utc_timestamp(to_utc_timestamp($1, current_timezone()), $2))||EXTRACT(YEAROFWEEK from from_utc_timestamp(to_utc_timestamp($1, current_timezone()), $2))"},
		{"from" : "TO_CHAR\s*\(\s*\((\w+\s*\(*\s*\)*)\s+AT\s+time\s+zone\s+(\'.*?\')\s*\)\:*\:*\w+\s*\,\s*\'IYYYIW\'\s*\)", "to" : "EXTRACT(YEAROFWEEK from from_utc_timestamp(to_utc_timestamp($1, current_timezone()), $2))||EXTRACT(WEEK from from_utc_timestamp(to_utc_timestamp($1, current_timezone()), $2))"},
		{"from" : "TO_CHAR\s*\(\s*\((\w+\s*\(*\s*\)*)\s+AT\s+time\s+zone\s+(\'.*?\')\s*\)\:*\:*\w+\s*\,\s*\'IW\-IYYY\'\s*\)", "to" : "EXTRACT(WEEK from from_utc_timestamp(to_utc_timestamp($1, current_timezone()), $2))||'-'||EXTRACT(YEAROFWEEK from from_utc_timestamp(to_utc_timestamp($1, current_timezone()), $2))"},
		{"from" : "TO_CHAR\((\w*\.*\w*\.*\w+)\s*\,\'YYYYMMWW\'\)", "to" : "DATE_FORMAT($1,'yyyyMM')||EXTRACT(YEAROFWEEK from $1)"},
		{"from" : "TO_CHAR\((\w*\.*\w*\.*\w+)\s*\,\'IW\'\)", "to" : "EXTRACT(YEAROFWEEK from $1)"},
		{"from" : "TO_CHAR\((.*?)\,\s*\'IW\'\)", "to" : "WEEKOFYEAR($1)"},
		
		{"from" : "CAST\s*\(\s*\(\s*([\w.]+)\s*\(\s*FORMAT\s+'YYYY-MM-DD'\s*\)\s*\)\s*AS\s+CHAR\s*\(\s*10\s*\)\s*\)", "to" : "TO_CHAR($1,'YYYY-MM-DD')"},
		{"from": "SYSDATE" , "to" : "current_timestamp()"},
		{"from" : "\bDATE\b", "to" : "CURRENT_DATE", "statement_categories": ["TABLE_DDL_AS_SELECT"]},
		{"from" : "TRIM\(LEADING'", "to" : "TRIM(LEADING '"},
		{"from" : "TRIM\(TRAILING'", "to" : "TRIM(TRAILING '"},
		{"from" : "TRIM\(LEADING ", "to" : "TRIM_LEADING("},
		{"from" : "TRIM\(TRAILING ", "to" : "TRIM_TRAILING("},
		
		{"from" : "SET QUERY_GROUP.*", "to":""},
		
		{"from" : "\bLEN\b", "to" : "LENGTH"},
		{"from" : "\bCHARACTER_LENGTH", "to" : "LENGTH"},
		{"from" : "\bCHAR_LENGTH", "to" : "LENGTH"},
		{"from" : "\bTEXTLEN", "to" : "LENGTH"},
		// {"from" : "\bQUOTE_LITERAL\s*\(([^\s\)]\))", "to" : "CONCAT(\',$1,\')"},
		{"from" : "\bSTRPOS", "to" : "POSITION"},
		
		{"from" : "(?!<\-)\s*CREATE(\s+?)MULTISET(\s+?)TABLE", "to": "CREATE OR REPLACE TABLE"},
		{"from" : "CREATE SET TABLE", "to" : "CREATE TABLE IF NOT EXISTS"},
		{"from" : "(?!<\-)CREATE SET TABLE", "to" : "CREATE OR REPLACE TABLE"},
		{"from" : "(?!<\-)CREATE(\s+?)TABLE", "to": "CREATE OR REPLACE TABLE"},
		{"from" : "(?!<\-)CREATE(.*?)VOLATILE TABLE", "to": "CREATE TEMPORARY TABLE"},
		{"from" : "(?!<\-)CREATE TABLE ([$|\S]+?) AS ([$|\S]+?) WITH NO DATA", "to" : "CREATE OR REPLACE TABLE $1 LIKE $2"},
		{"from" : "\'(\d\d)\'XC", "to" : "TRY_HEX_DECODE_STRING($1)"},
		{"from" : " NOT CS ", "to" : " ", "statement_categories": ["TABLE_DDL"]},
		{"from" : " NOT CS$", "to" : " ", "statement_categories": ["TABLE_DDL"]},
		{"from" : " CS ", "to" : " ", "statement_categories": ["TABLE_DDL"]},
		{"from" : " CS,", "to" : ",", "statement_categories": ["TABLE_DDL"]},
		{"from" : " CS$", "to" : " ", "statement_categories": ["TABLE_DDL"]},
		
		{"from" : "COLLECT STATISTICS.*;", "to" : ""},
		{"from" : "COLLECT STATS.*;", "to" : ""},
		{"from" : "COLLECT STATS.*", "to" : ""},
		{"from" : "update command options using c off\s;", "to" : ""},
		{"from" : "NOT NULL WITH DEFAULT", "to" : ""},		
		{"from" : "CHARACTER SET LATIN NOT CASESPECIFIC", "to" : "COLLATE 'en-ci'"},
		{"from" : "CHARACTER SET LATIN NOT CS", "to" : "COLLATE 'en-ci'"},
		{"from" : "CHARACTER(\s+)SET LATIN", "to" : ""},
		{"from" : "CHARACTER SET UNICODE NOT CASESPECIFIC", "to" : ""},
		{"from" : "\(NOT CASESPECIFIC\)", "to" : ""},
		{"from" : "NOT CASESPECIFIC", "to" : ""},
		{"from" : "\(CASESPECIFIC\)", "to" : ""},
		{"from" : "\sCASESPECIFIC", "to" : ""},
		{"from" : "CHARACTER SET UNICODE", "to" : ""},
		{"from" : "USING UNICODE_TO_LATIN", "to" : ""},
		
		{"from" : "^\s*DATABASE\s*(\S+);", "to" : "USE SCHEMA $1;"},
		// {"from" : "\bSEL\b(?!\.)", "to" : "SELECT"}, //abbreviation for SELECT
		// {"from" : "\bDEL\b\s+\bFROM\b", "to" : "DELETE FROM"}, //abbreviation for DELETE
		// {"from" : "\bDEL\b(?!\.)", "to" : "DELETE FROM"}, //abbreviation for DELETE
		// // {"from" : "\bAS\s+(ins)\b(?!\.)", "to" : "as_$1_alias"},
		// {"from" : "\bINS\b(?!\.)", "to" : "INSERT INTO"}, //abbreviation for INSERT,
		// {"from" : "as_(ins)_alias", "to" : "AS $1"},
		{"from" : "\bDROP\b\s+\bTEMPORARY\b", "to" : "DROP"},
		{"from" : "\(\s+NAMED\s(\w+)\s+\)", "to" : ""},
		{"from" : "\.os\s(.*)", "to" : "!SYSTEM $1"},
		{"from" : ",(.*?)NO FALLBACK", "to": ""},
		{"from" : "(.*?)NO FALLBACK", "to": ""},
		{"from" : ",(.*?)\bFALLBACK\s*,", "to": ""},
		{"from" : ",(.*?)\bFALLBACK", "to": ""},
		{"from" : "NO BEFORE JOURNAL", "to": ""},
		{"from" : "NO AFTER JOURNAL", "to": ""},
		{"from" : "CHECKSUM = DEFAULT", "to": ""},
		{"from" : ",(.*?)NO LOG", "to": ""},
		{"from" : ",(.*?)CHECKSUM = DEFAULT,", "to": ""},
		{"from" : ",(.*?)CHECKSUM = DEFAULT", "to": ""},
		{"from" : "CREATE JOIN INDEX", "to": "CREATE TEMPORARY TABLE"},
		{"from" : "^(\s*?)REPLACE(\s+?)VIEW", "to": "CREATE OR REPLACE VIEW"},
		{"from" : "^(\s*?)CREATE VIEW", "to": "CREATE OR REPLACE VIEW"},
		{"from" : "LOCKING(.+?)FOR\s+ACCESS\s+MODE", "to": ""},
		{"from" : "LOCKING(.+?)FOR ACCESS", "to": ""},
		{"from" : "LOCK ROW FOR ACCESS", "to": ""},
		{"from" : "END TRANSACTION;", "to": "COMMIT;"},
		{"from" : "current_date - ([0-9]+)", "to": "dateadd('DAY',-$1,current_date)"},	
		
		{"from" : "([\w.]+)\s*\(\s*FORMAT '99999'\s*\)", "to" : "LPAD($1,5,'0')"},
		
		{"from" : "LOGGING ALL ERRORS WITH NO LIMIT", "to" : ""},
		{"from" : "NO\s+PRIMARY\s+INDEX", "to" : ""},

		{"from" : "\bMAXIMUM\b", "to" : "MAX"},
		{"from" : "\(NOT CS\)", "to" : ""},
		{"from" : "\(CS\)", "to" : ""},
		
		{"from" : "AS FORMAT 'YYYY-MM-DD'", "to": " AS DATE"},
		{"from" : "AS FORMAT 'HH:MI:SS'", "to": " AS TIMESTAMP(6)"},
		{"from" : "FROM (\d+) FOR (\d)", "to" : ", $1, $2"}, //used in SUBSTRING function
		{"from" : "FROM(\s+)(\d+)(\s+)FOR(\s+)(\d)", "to" : ", $2, $5"}, //used in SUBSTRING function
		{"from" : "FROM (\d+)\)", "to" : ", $1)"}, //used in SUBSTRING function without 3rd arg
		
		{"from" : "OREPLACE", "to" : "REPLACE"},
		{"from" : "OTRANSLATE", "to" : "REPLACE"},
		
		{"from" : "DEFAULT(\s+)MERGEBLOCKRATIO", "to" : "$1"},
		{"from" : "DEFAULT DATE", "to" : "DEFAULT CURRENT_DATE"},

		{"from" : "CONSTRAINT\s(.*)CHECK\s", "to" : ",CONSTRAINT_CHECK ", "statement_categories": ["TABLE_DDL"]},
		{"from" : "\sCHECK\s", "to" : " CONSTRAINT_CHECK ", "statement_categories": ["TABLE_DDL"]},
		{"from" : ",CHECK\s", "to" : ",CONSTRAINT_CHECK ", "statement_categories": ["TABLE_DDL"]},
		{"from" : "ORDER BY VALUES", "to" : "ORDER_BY_VALUES", "statement_categories": ["TABLE_DDL"]},
		{"from" : "EFF_PERIOD\s*PERIOD\(DATE\)\s*FORMAT 'YY\/MM\/DD' AS VALIDTIME", "to" : "EFF_BEGIN_DT DATE, EFF_END_DT DATE"},
		{"from" : "EFF_PERIOD\s*PERIOD\(DATE\)\s*AS VALIDTIME", "to" : "EFF_BEGIN_DT DATE, EFF_END_DT DATE"},
		{"from" : "VALID_DT\s*PERIOD\(DATE\)\s*AS VALIDTIME", "to" : "VALID_BEGIN_DT DATE, VALID_END_DT DATE"},
		{"from" : "AU_TS_PERIOD\s*PERIOD\(TIMESTAMP\(0\)\) NOT NULL AS VALIDTIME", "to" : "AU_BEGIN_TS TIMESTAMP(0), AU_END_TS TIMESTAMP(0)"},
		{"from" : "EFFTS_PERIOD\s*PERIOD\s*\(TIMESTAMP\(6\)\) WITH TIME ZONE\) NOT NULL AS VALIDTIME", "to" : "EFFTS_BEGIN_TS TIMESTAMP(6), EFFT_END_TS TIMESTAMP(6)"},
		{"from" : "PERIOD\(TIMESTAMP\(0\)\) NOT NULL AS VALIDTIME", "to" : "timestamp(0) default current_timestamp"},
		{"from" : "PERIOD\(DATE\)(\s+)AS VALIDTIME", "to" : "timestamp(0)"},
		{"from" : "PERIOD\(DATE\) FORMAT 'YY\/MM\/DD' AS VALIDTIME", "to" : "timestamp(0)"},
		{"from" : "PERIOD\(TIMESTAMP\(6\) WITH TIME ZONE\) NOT NULL AS TRANSACTIONTIME", "to" : "timestamp(6) default current_timestamp"},
		{"from" : "current_timestamp at 'america eastern'", "to" : "CURRENT_TIMESTAMP"},
		{"from" : "PERIOD\(DATE\)", "to" : "DATE"},
		
		//date arithmetic
		{"from" : "DAY\(4\) TO MINUTE", "to" : ""},
		
		
		{"from" : " UPPERCASE ", "to": ""},
		{"from" : "NONSEQUENCED VALIDTIME", "to" : ""},
		{"from" : "COMPRESS '(.+)'","to": ""},
		{"from" : "COMPRESS\s*\(", "to" : "COMPRESS_SUPPRESS("},
		{"from" : "COMPRESS 'SAN'","to": ""},
		{"from" : "COMPRESS 1737","to": ""},
		{"from" : "COMPRESS 888", "to": ""},
		{"from" : "COMPRESS 'N'", "to": ""},
		{"from" : "COMPRESS 'M'", "to": ""},
		{"from" : "COMPRESS ,","to": ","},
		{"from" : "COMPRESS '6'","to": ""},
		{"from" : "COMPRESS 'P'","to": ""},
		{"from" : "COMPRESS 1 ,","to": ","},
		{"from" : "COMPRESS 0 ,","to": ","},
		{"from" : "COMPRESS 0,","to": ","},
		{"from" : "COMPRESS 0(\s+)$","to": ""},
		{"from" : "COMPRESS .0000","to": ""},
		{"from" : "COMPRESS \.00","to": ""},
		{"from" : "COMPRESS -1(\s*),(\s*)$","to": ","},
		{"from" : "COMPRESS ([\d.]+)(\s*),", "to": ","},
		{"from" : "COMPRESS (\d+)\.(\d+)(\s*)", "to": ""},
		{"from" : "COMPRESS 0\b","to": ""},
		{"from" : "COMPRESS(\s+)0(\s+),", "to": ",", "statement_categories": ["TABLE_DDL"] },
		{"from" : "COMPRESS(\s+)0$", "to": "", "statement_categories": ["TABLE_DDL"] },
		{"from" : "COMPRESS ' ',", "to": ",", "statement_categories": ["TABLE_DDL"] },
		{"from" : "COMPRESS(\s*),", "to": ",", "statement_categories": ["TABLE_DDL"] },
		{"from" : "COMPRESS(\s*)\)", "to": ")", "statement_categories": ["TABLE_DDL"] },
		{"from" : "COMPRESS\s*'\s*?',", "to": "", "statement_categories": ["TABLE_DDL"] },
		{"from" : "DATE\s+FORMAT\s+'YY\/MM\/DD'", "to" : "DATE",  "statement_categories": ["TABLE_DDL"] },
		{"from" : "DATE\s+FORMAT\s+'YYYY-MM-DD'", "to" : "DATE",  "statement_categories": ["TABLE_DDL"] },
		{"from" : "UNIQUE PRIMARY INDEX", "to": "UPI"},
		{"from" : "PRIMARY INDEX", "to": "PRIM_IDX"},
		{"from" : "CREATE UNIQUE INDEX .*\((.*?)\).*;", "to": ""},
		{"from" : "CREATE INDEX \((.*?)\).*;", "to": ""},
		{"from" : "UNIQUE\s+INDEX", "to": "UNK_IDX"},
		{"from" : "INTERVAL '(\d+)' DAY", "to": "$1"},
		{"from" : "INTERVAL\s+'([0-9.]+)'\s+SECOND", "to": "INTERVAL '$1 SECOND'"},
		
		//casting
		{"from" : "\( (\d+)\)", "to": "($1)"},
		{"from" : "\(VARCHAR\((\d+)\)\)", "to" : "::STRING"},
		{"from" : "\(CHAR\((\d+)\)\)", "to" : "::STRING"},
		{"from" : "\((\s*)SMALLINT(\s*)\)", "to" : "::SMALLINT"},
		{"from" : "\(INTEGER\)", "to" : "::INTEGER"},
		{"from" : "\(DATE\)", "to" : "::DATE"},
		{"from" : "\(DECIMAL\(([\d|,]+)\)\)", "to" : "::DECIMAL($1)"},
		{"from" : "\(BYTEINT\)", "to" : ""},
		{"from" : "AS BYTEINT", "to" : "AS INT"},
		
		{"from" : "\bIN .*", "to" : "", "statement_categories": ["TABLE_DDL_LIKE"]},
		{"from" : "\bwith\s+no\s+schema\s+BINDING\b", "to" : ""},
		{"from" : "DELETE(.*) ALL\b", "to" : "DELETE$1"},
		
		{"from" : "SYSLIB\.ISO8601_TO_DT", "to" : "TRY_TO_DATE"},
		{"from" : "SYSLIB\.ISO8601_TO_TS", "to" : "TRY_TO_TIMESTAMP"},
		{"from" : "REPLACE_CHARS", "to" : "REPLACE"},
		{"from" : "FLOAT\s+\.\S+ \d+\b", "to" : "FLOAT", "statement_categories": ["TABLE_DDL"]},
		{"from" : "\bDBC\.TABLES\b", "to" : "INFORMATION_SCHEMA.TABLES"},
		{"from" : "\bDBC\.COLUMNS\b", "to" : "INFORMATION_SCHEMA.COLUMNS"},
		{"from" : "\bdatabasename\b", "to" : "TABLE_CATALOG"},
		{"from" : "\btablename\b", "to" : "TABLE_NAME"}	,
		{"from" : "(?<!\<)>\s*\bany\b\s*\(\s*select\s+(\w*\.*\w+)", "to" : " > (SELECT min($1)"},
		{"from" : "\<(?!\>)\s*\bany\b\s*\(\s*select\s+(\w*\.*\w+)", "to" : " < (SELECT max($1)"},
		{"from" : "\<\>\s*\bany\b\s*\(\s*select\s+(\w*\.*\w+)", "to" : " exists (SELECT 1"},
		{"from" : "(?<!\!|\>)\=\s*any", "to" : " IN "},
		{"from" : "ARRAY\s*\[(.*?)\]", "to" : " ARRAY($1) "},
		{"from" : "\bJSON_QUERY\b", "to" : "JSON_EXTRACT_SCALAR"},
		{"from" : "\bJSON_EXTRACT_SCALAR\b(.*?)\,\s*\'\s*\$\.(.*?)\'", "to" : "JSON_EXTRACT_SCALAR$1,$2"},
		{"from" : "\bMAKE_INTERVAL\b\s*\(\s*\'*(\w+)\'*\s*\=\>\s*(.*?)\)", "to" : "INTERVAL $2 $1"},
		{"from" : "(\b\w+\s*\(\s*)\"(\w+)\"(\s*\bas\s+\w+\s*\))", "to" : "$1`$2`$3"},
		{"from" : "(\w+)\.\"(\w+)\"", "to" : "$1.`$2`"},
		{"from" : "(?<![\[|\'])\"(\w+)\"(?![\]|\'])", "to" : "`$1`"},
		{"from" : "\:\:varchar\b(?!\()", "to" : "::string"},
		{"from" : "\~", "to" : " RLIKE "},
		{"from" : "\bCURRENT_TIMESTAMP\s+(\-|\+)\s*([0-9]+)", "to" : "CURRENT_TIMESTAMP $1 INTERVAL $2 DAYS"},
		{"from" : "\bis\s+not\s+null\s*\=\s*\'*(\btrue\b)\'*", "to" : " IS NOT NULL "},
		{"from" : "\bis\s+not\s+null\s*\=\s*\'*(\bfalse\b)\'*", "to" : " IS NULL "},
		{"from" : "\bis\s+null\s*\=\s*\'*(\btrue\b)\'*", "to" : " IS NULL "},
		{"from" : "\bis\s+null\s*\=\s*\'*(\bfalse\b)\'*", "to" : " IS NOT NULL "},
		//{"from" : "\+\s*\'", "to" : " || ' "},
		{"from" : "(\'[0-9]+\-[0-9]+\-[0-9]+\')\s*(\-|\+)\s*([0-9]+)", "to" : " $1 $2 INTERVAL $3 DAYS"},
		{"from" : "\bISNULL\s+THEN", "to" : "IS NULL THEN "},
		{"from" : "\:\s*\:\s*SUPER\b", "to" : "::VARIANT"},
		{"from" : "\bGROUP\s+BY\s*\((.*?)\)", "to" : "GROUP BY $1"},
		{"from" : "(\'.*?\')\s*\+\s*(\w*\.*\w+)", "to" : "$1||$2"},
		{"from" : "(\w*\.*\w+)\s*\+\s*(\'.*?\')", "to" : "$1||$2"},
		{"from" : "cast\s*\(\s*(\w*\.*\w+)\s+as\s+SUPER\s*\)", "to" : "CAST($1 AS VARIANT)"},
		{"from" : "(\((?:MIN|MAX)\s*\(\w*\.*\w+\s*\))\s*(\-|\+)\s*([0-9]+)\s*\)(\s*\:\:\s*DATE|TIMESTAMP)", "to" : "$1 $2 INTERVAL $3 DAYS)$4"},
		{"from" : "(\(\w*\.*\w+\s*)\s*(\-|\+)\s*([0-9]+)\s*\)(\s*\:\:\s*DATE|TIMESTAMP)", "to" : "$1 $2 INTERVAL $3 DAYS)$4"},
	
		{"from" : "(DATE\s*\(\s*\w*\.*\w+\))\s*\-\s*(DATE\s*\(\s*\w*\.*\w+\))", "to" : "DATEDIFF(DAY,$2,$1)"},
		{"from" : "\bVACUUM\s+FULL\s+\w*\.*\w*\.*\w+\s*\;", "to" : ""},	
		{"from" : "(\bVACUUM\b|\bANALYZE\b)\s+\w*\.*\w*\.*\w+\s*\;", "to" : ""}
		//{"from" : "(LAST|FIRST)_VALUE\s*\(\s*(\w*\.*\w+)\s*IGNORE\s+NULLS", "to" : "$1_VALUE($2 /*$2 FIX ME UNSUPPORTED FEATURE IGNORE NULLS ADD FILTERING CONDITIONS TO FILTER OUT NULL VALUES*/\nIGNORE NULLS"}
	
	],

	"block_subst" : [
		{"from" : "LISTAGG\s*\(\s*DISTINCT\s+(\w+\.*\w+)\s*\,\s*(\'.*?\')\s*\)(\s*WITHIN\s+GROUP\s*\(\s*ORDER\s+by\b.*?\))", "extension_call" : "::handle_within_group_order"},
		{"from" : "LISTAGG\s*\(\s*DISTINCT\s+(\w+\.*\w+)\s*\,\s*(\'.*?\')\s*\)(\s*WITHIN\s+GROUP\s*\(\s*ORDER\s+by\b.*?\))", "to" : "array_join(array_distinct(split(LISTAGG ( $1, $2) $3,$2)),$2) "},
		{"from" : "\bDELETE(\s+FROM\s+\w*\.*\w*\.*\w+\s+where\b)", "to" : "DEL_ETE$1"},
		{"from" : "\bDELETE\b.*\bJOIN\b", "extension_call" : "$self->convert_delete_to_merge"},
		{"from" : "DEL_ETE", "to" : "DELETE"},
		{"from" : "\bDELETE\s+FROM\s+(\w*\.*\w*\.*\w+)\s+using\s+(\w*\.*\w+)\s+where\b(.*)\;", "to" : "MERGE INTO $1\nUSING $2\nON $3\nWHEN MATCHED THEN DELETE;"},
		{"from" : "\bUPDATE\b.*\bSET\b.*\bFROM\b", "extension_call" : "$self->convert_update_to_merge"},
		{"from" : "\)\s*\bAS\b\s*(\w+)\s*(\(.*?)(group by\b.*)\)", "extension_call" : "::handle_in_group_by"},
		{"from" : "\b(\w+\.?\w*)\s+at\s+time\s+zone\s+(\'.*?\')", "to" : "from_utc_timestamp($1, $2)"},
		{"from" : "CREATE\s+OR\s+REPLACE\s+VIEW\s+(\w+\.?\w*)\s+AS\s+CREATE\s+OR\s+REPLACE\s+VIEW\s+\w+\.?\w*\s+AS\b", "to" : "CREATE OR REPLACE VIEW $1 AS"},
		{"from" : "CREATE\s+OR\s+REPLACE\s+TABLE\s+(\w+)\s*\(LIKE\s+(\w+)\s+(INCLUDING|EXCLUDING)(\s+DEFAULTS)\s*\)", "to" : "CREATE OR REPLACE TABLE $1 AS\nSELECT * FROM $2\n"},
		{"from" : "CREATE\s+OR\s+REPLACE\s+TABLE\s+(\w+)\s*\(LIKE\s+(\w+)\s*\)", "to" : "CREATE OR REPLACE TABLE $1 AS\nSELECT * FROM $2"},
		//constraints
		{"from": "\bCONSTRAINT\s+\w+\s+PRIMARY\s+KEY\s*\(",                         "to": "BB_CONSTRAINT_PRIMARY_KEY_PARENS (", "statement_categories": ["TABLE_DDL"]},
		{"from": "\bCONSTRAINT\s+\w+\s+PRIMARY\s+KEY",                              "to": "BB_CONSTRAINT_PRIMARY_KEY ()",       "statement_categories": ["TABLE_DDL"]},
		{"from": "\bCONSTRAINT\s+\w+\s+REFERENCES\s+\w+\s*\(",                      "to": "BB_CONSTRAINT_REFS_PARENS (",        "statement_categories": ["TABLE_DDL"]},
		{"from": "\bCONSTRAINT\s+\w+\s+REFERENCES\s+\w+",                           "to": "BB_CONSTRAINT_REFS ()",              "statement_categories": ["TABLE_DDL"]},
		// For leftover "REFERENCES <word> ("  and "REFERENCES <word>"
		{"from": "\bREFERENCES\s+\w+\s*\(",                                         "to": "BB_REFS_PARENS (",                   "statement_categories": ["TABLE_DDL"]},
		{"from": "\bREFERENCES\s+\w+",                                              "to": "BB_REFS ()",                         "statement_categories": ["TABLE_DDL"]},
		{"from": "\b(DECLARE\s+\w+\s+CURSOR\s.*);", "to": "\n-- FIXME databricks.migration.unsupported.feature 'BB_DECLARE_CURSOR'\n $1 $2\n", "first_match": "1"},
    	{"from": "(^|\n)\s*(OPEN\s+\w+.*)",      "to": "\n-- FIXME databricks.migration.unsupported.feature 'BB_OPEN_CURSOR'\n $2 \n", "first_match": "1"},
		{"from": "(^|\n)\s*(PREPARE\s+\w+.*)",   "to": "\n-- FIXME databricks.migration.unsupported.feature 'BB_PREPARE_CURSOR'\n $2 \n", "first_match": "1"},
		{"from": "(^|\n)\s*(FETCH\s+\w+.*)",     "to": "\n-- FIXME databricks.migration.unsupported.feature 'BB_FETCH_CURSOR'\n $2 \n", "first_match": "1"},
		{"from": "(^|\n)\s*(CLOSE\s+\w+.*)",     "to": "\n-- FIXME databricks.migration.unsupported.feature 'BB_CLOSE_CURSOR'\n $2 \n", "first_match": "1"},
		{"from" : "COLLECT\s+(?:STATS|STATISTICS)(?:\s+ON)?\s+(\S+|\S+\s+\.\S+|\S+\.\s+\S+)\s+(INDEX|COLUMN)\s*.*?([^();]+).*", "to" : "ANALYZE TABLE $1 COMPUTE STATISTICS FOR COLUMNS $3;"},
		{"from": "WITH\s+NO\s+CHECK\s+OPTION\s+(\w+\s*\(.*?\))", "to": " $1 NOT ENFORCED " },
		{"from": "WITH\s+NO\s+CHECK\s+OPTION", "to": " " },
		// Comment out CONSTRAINT...UNIQUE with a "FIXME" tag
		{"from": "\bCONSTRAINT\s+\w+\s+CHECK\b",         "to": "BB_CONSTRAINT_CHECK ",    "statement_categories": ["TABLE_DDL"]},
		{"from": "\bCHECK\b",                            "to": "BB_CHECK",                "statement_categories": ["TABLE_DDL"]},
		{"from": "\b(NO\s+)?(UNIQUE\s+)?(PRIMARY\s+)?INDEX\s*\(.*?\)\s*,", "to": "BB_HANDLE_INDEX ()", "statement_categories": ["TABLE_DDL"]},
		{"from": "\b(NO\s+)?(UNIQUE\s+)?(PRIMARY\s+)?INDEX",               "to": "BB_HANDLE_INDEX",    "statement_categories": ["TABLE_DDL"]},
		{"from": "\bUNIQUE\s*\((.*?)\)\s*\,*", "statement_categories": ["TABLE_DDL"],     "to": "/*  FIXME databricks.migration.unsupported.feature ' BB_UNIQ ' $1 Constraint\n */ " },
		{"from" : "__EXPRESSION__\s(FORMAT '(9+)')", "to" : "LPAD(__EXPRESSION__,__LENGTH__,'0')"},
		{"from" : "\)\s*WITH NO DATA", "to" : " WHERE 1=2)"},
		{"from" : "\(\s*TITLE\s+'\w+'\s*\)", "to" : ""}, //blank out TITLE spec
		{"from" : "TITLE\s*'.*?'", "to" : "", "statement_categories": ["TABLE_DDL"]},
		{"from" : "\)__GAMMA_NL__\s*WITH NO DATA", "to" : " WHERE 1=2)"}, //use __GAMMA_NL__ for newline pattern
		{"from" : "CREATE INDEX \((.*?)\).*;", "to": "", "statement_categories": ["CREATE_INDEX"] },
		{"from" : "VALIDTIME .*\(SELECT.*\)(.*?)(SELECT?)", "to" : "SELECT"},		
		{"from" : "__EXPRESSION__\s\(FORMAT\s*'9\(18\)'\)", "to" : "LPAD(__EXPRESSION__,18,'0')"},
		{"from" : "__EXPRESSION__\s\(FORMAT\s*'999999'\)", "to" : "LPAD(__EXPRESSION__,6,'0')"},
		{"from" : "__EXPRESSION__\s\(FORMAT\s*'9\(2\)'\s*\)", "to" : "LPAD(__EXPRESSION__,2,'0')"},
		{"from" : "PRIM_IDX\s+\S+\s*\(.+?\)", "to": "", "statement_categories": ["TABLE_DDL"]}, //get rid of named primary index
		//{"from" : "^\s*SELECT(.*)", "force_alias_usage" : "1", "first_match" : "1"},
		{"from" : "\bCREATE\s+TABLE\s+IF\s+NOT\s+EXISTS\b", "to" : "CREATE TABLE"},
		{"from" : "\bCREATE\s+OR\s+REPLACE\s+TABLE\s+IF\s+NOT\s+EXISTS\b", "to" : "CREATE OR REPLACE TABLE"},
		{"from" : "\bALTER\s+TABLE\s+(\w+\.?\w*)\s+OWNER\s+TO\s+(\w+)", "to" : "ALTER TABLE $1 OWNER TO `$2`"},		
		//various
		{"from" : "\$\$\s+LANGUAGE.*\;", "to" : ""},
		{"from" : "\b\_DONE\_\b", "to" : ""},
		
		{"from" : "\,(\s*FROM\b)", "to" : "$1"},
		{"from" : "(\)\s*)WITH\s+DATA", "to" : "$1"},
		{"from" : "\bEXISTS\s*\(\s*SELECT\s+\*", "to" : "EXISTS(SELECT 1"},
		{"from" : "\bEXTRACT\s*\(\s*EPOCH\s+FROM\s+\(\s*(\w*\.*\w+)\s*(\-\s*)(\w*\.*\w+)\s*\)\s*\)", "to" : "unix_timestamp($1) - unix_timestamp($3)"},
		{"from" : "\bEXTRACT\s*\(\s*EPOCH\s+FROM\s+\(*\s*(\w*\.*\w+)\s*(\-|\+)\s*(\w*\.*\w+)\s*\)*\s*\)", "to" : "unix_timestamp($1) $2 unix_timestamp($3)"},
		{"from" : "\bEXTRACT\s*\(\s*EPOCH\s+FROM\s+(\w*\s*\(\s*\w*\.*\w+\s*\)*)\s*(\-\s*)(\w*\(*\w*\.*\w+\s*\))\s*\)", "to" : "unix_timestamp($1) - unix_timestamp($3)"},
		{"from" : "\bEXTRACT\s*\(\s*EPOCH\s+FROM\s+(\'.*?\')\s*\)", "to" : "(EXTRACT(DAY FROM $1) * 24 * 60 * 60 + \n\tEXTRACT(HOUR FROM  $1 ) * 60 * 60 + \n\tEXTRACT(MINUTE FROM  $1)  * 60 + \n\tEXTRACT(SECOND FROM  $1))"},
		{"from" : "count\s*\(\s*\w+\.\*", "to" : "count(1"},
		//{"from" : "\bselect\b.*\bas\s+\b(\w+)\b.*?(\bfrom\b|\bwhere\b).*(?<!\.)\b\1\b(?!\.)", "extension_call" : "::handle_dynamic_cols"},
		//{"from" : "\bgroup\s+by\s+[1-9]+", "extension_call" : "::handle_dynamic_cols"},
		//{"from" : "\bselect\b", "extension_call" : "::handle_dynamic_cols"},
		{"from" : "\bROW_NUMBER\s*\(\s*\)\s+OVER\s*\(\s*PARTITION\s+BY\s+(?:(?!ORDER\s+BY)[^)])*\)", "extension_call" : "::handle_row_num"},
		{"from" : "_ALREADY_CONVERTED_", "to" : ""},
		{"from" : "\,\s*unpivot\s+(\w*\.*)(\w+)\s+AS\s+(\w+)\s+at\s+(\w+)", "to" : "\nLATERAL VIEW EXPLODE($1$2) AS $4, $3"},
		{"from" : "LAST_VALUE\s*\(\s*(\w*\.*\w+)\s+IGNORE\s+NULLS\s*\)", "to" : "LAST_VALUE($1) IGNORE NULLS "},
		{"from" : "FIRST_VALUE\s*\(\s*(\w*\.*\w+)\s+IGNORE\s+NULLS\s*\)", "to" : "FIRST_VALUE($1) IGNORE NULLS "},
		{"from" : "\bgetdate\s*\(\s*\)\s*(\-|\+)\s*([0-9]+)", "to" : "current_timestamp $1 INTERVAL 60 DAYS"},
		{"from" : "daterange", "to" : "some dummy line"}
	
	],
	
	"function_subst" : [
		{"from": "BB_CONSTRAINT_PRIMAR+Y_KEY_PARENS", "to": "__BLANK__"},
		{"from": "BB_CONSTRAINT_PRIMARY_KEY",        "to": "__BLANK__"},
		{"from": "BB_CONSTRAINT_FOREIGN_KEY_REFS",   "to": "__BLANK__"},
		{"from": "BB_CONSTRAINT_REFS_PARENS",        "to": "__BLANK__"},
		{"from": "BB_CONSTRAINT_REFS",               "to": "__BLANK__"},
		{"from": "BB_REFS_PARENS",                   "to": "__BLANK__"},
		{"from": "BB_REFS",                          "to": "__BLANK__"},
		{"from": "BB_FOREIGN_KEY_PARENS",            "to": "__BLANK__"},

		{"from": "BB_CONSTRAINT_CHECK",                 "to": "__BLANK__"},
		{"from": "BB_CHECK",                            "to": "__BLANK__"},

		{"from": "BB_HANDLE_INDEX",                     "to": "__BLANK__"},
		{"from": "LEN", "to" : "CHAR_LENGTH" },
		{"from": "LENGTH", "to" : "CHAR_LENGTH" },
		{"from": "TEXTLEN", "to" : "CHAR_LENGTH" },
		// {"from": "QUOTE_LITERAL", "OUTPUT_TEMPLATE" : "\"'\"||$1||\"'\"" },
		{"from": "REPLICATE", "TO" : "REPEAT" },
		{"from": "DLOG1", "TO" : "LN" },
		{"from" : "TO_CHAR","arg_pattern" : {"2" : "'FM999\,999\,999\,990D00'"},"output_template" :"FORMAT_NUMBER($1,2)"},
		{"from" : "TO_CHAR","arg_pattern" : {"2" : "(Y|M|S|O|I|D|W|T|Z|B|A|P|U|H)"},"output_template" :"DATE_FORMAT($1,$2)","date_format_arg" : "2"},
				
		{"from" : "DECODE","num_args" : "3","output_template" :"case when $1=$2 then $3 END"},
		{"from" : "DECODE","num_args" : "4","output_template" :"case when $1=$2 then $3 else $4 END"},
		{"from" : "DECODE","num_args" : "5","output_template" :"case when $1=$2 then $3 when $1=$4 then $5 END"},
		{"from" : "DECODE","num_args" : "6","output_template" :"case when $1=$2 then $3 when $1=$4 then $5 else $6 END"},
		{"from" : "DECODE","num_args" : "7","output_template" :"case when $1=$2 then $3 when $1=$4 then $5 when $1=$6 then $7 END"},
		{"from" : "DECODE","num_args" : "8","output_template" :"case when $1=$2 then $3 when $1=$4 then $5 when $1=$6 then $7 else $8 END"},

		{"from" : "DATEPART", "to": "DATE_PART"},
		{"from" : "DATE_PART","arg_pattern" : {"1" : "'year'"},"output_template" :"YEAR($2)"},
		{"from" : "DATE_PART","arg_pattern" : {"1" : "'month'"},"output_template" :"MONTH($2)"},
		{"from" : "DATE_PART","arg_pattern" : {"1" : "'day'"},"output_template" :"DAY($2)"},
		{"from" : "DATE_PART","arg_pattern" : {"1" : "'hour'"},"output_template" :"HOUR($2)"},
		{"from" : "DATE_PART","arg_pattern" : {"1" : "'minute'"},"output_template" :"MINUTE($2)"},
		{"from" : "DATE_PART","arg_pattern" : {"1" : "'second'"},"output_template" :"SECOND($2)"},
		{"from" : "DATE_PART","arg_pattern" : {"1" : "'quarter'"},"output_template" :"QUARTER($2)"},
		{"from" : "DATE_PART","arg_pattern" : {"1" : "'week'"},"output_template" :"WEEKOFYEAR($2)"},
		{"from" : "DATE_PART","arg_pattern" : {"1" : "'dow'"},"output_template" :"DAYOFWEEK($2)"},
		{"from" : "DATE_PART","arg_pattern" : {"1" : "'doy'"},"output_template" :"DAYOFYEAR($2)"},
		{"from" : "DATE_PART","arg_pattern" : {"1" : "'epoch'"},"output_template" :"UNIX_TIMESTAMP($2)"},

		{"from" : "DATE_DIFF", "to": "DATEDIFF"},
		{"from" : "DATEDIFF","arg_pattern" : {"1" : "'days'"},"output_template" :"DATEDIFF(DAY,$2, $3)"},
		{"from" : "DATEDIFF","arg_pattern" : {"1" : "'day'"},"output_template" :"DATEDIFF(DAY, $2, $3)"},
		{"from" : "DATEDIFF","arg_pattern" : {"1" : "'month'"},"output_template" :"MONTH($3) - MONTH($2) + 12 * (YEAR($3) - YEAR($3))"},
		{"from" : "DATEDIFF","arg_pattern" : {"1" : "'year'"},"output_template" :"YEAR($3) - YEAR($2)"},
		{"from" : "DATEDIFF","arg_pattern" : {"1" : "'hour'"},"output_template" :"(UNIX_TIMESTAMP($3) - UNIX_TIMESTAMP($2)) / 3600"},
		{"from" : "DATEDIFF","arg_pattern" : {"1" : "'minute'"},"output_template" :"(UNIX_TIMESTAMP($3) - UNIX_TIMESTAMP($2)) / 60"},
		{"from" : "DATEDIFF","arg_pattern" : {"1" : "'second'"},"output_template" :"UNIX_TIMESTAMP($3) - UNIX_TIMESTAMP($2)"},
		{"from" : "DATEDIFF","arg_pattern" : {"1" : "'seconds'"},"output_template" :"UNIX_TIMESTAMP($3) - UNIX_TIMESTAMP($2)"},
		{"from" : "DATEDIFF","arg_pattern" : {"1" : "'week'"},"output_template" :"FLOOR(DATEDIFF($3, $2) / 7)"},
		{"from" : "DATEDIFF","arg_pattern" : {"1" : "'quarter'"},"output_template" :"(YEAR($3) - YEAR($2)) * 4 + (QUARTER($3) - QUARTER($2))"},

		{"from" : "DATEDIFF","arg_pattern" : {"1" : "days"},"output_template" :"DATEDIFF(DAY,$2, $3)"},
		{"from" : "DATEDIFF","arg_pattern" : {"1" : "day"},"output_template" :"DATEDIFF_DONE(DAY, $2, $3)"},
		{"from" : "DATEDIFF_DONE", "to": "DATEDIFF"},
		{"from" : "DATEDIFF","arg_pattern" : {"1" : "month"},"output_template" :"MONTH($3) - MONTH($2) + 12 * (YEAR($3) - YEAR($3))"},
		{"from" : "DATEDIFF","arg_pattern" : {"1" : "year"},"output_template" :"YEAR($3) - YEAR($2)"},
		{"from" : "DATEDIFF","arg_pattern" : {"1" : "hour"},"output_template" :"(UNIX_TIMESTAMP($3) - UNIX_TIMESTAMP($2)) / 3600"},
		{"from" : "DATEDIFF","arg_pattern" : {"1" : "h"},"output_template" :"(UNIX_TIMESTAMP($3) - UNIX_TIMESTAMP($2)) / 3600"},
		{"from" : "DATEDIFF","arg_pattern" : {"1" : "minute"},"output_template" :"(UNIX_TIMESTAMP($3) - UNIX_TIMESTAMP($2)) / 60"},
		{"from" : "DATEDIFF","arg_pattern" : {"1" : "second"},"output_template" :"UNIX_TIMESTAMP($3) - UNIX_TIMESTAMP($2)"},
		{"from" : "DATEDIFF","arg_pattern" : {"1" : "seconds"},"output_template" :"UNIX_TIMESTAMP($3) - UNIX_TIMESTAMP($2)"},
		{"from" : "DATEDIFF","arg_pattern" : {"1" : "week"},"output_template" :"FLOOR(DATEDIFF($3, $2) / 7)"},
		{"from" : "DATEDIFF","arg_pattern" : {"1" : "quarter"},"output_template" :"(YEAR($3) - YEAR($2)) * 4 + (QUARTER($3) - QUARTER($2))"},


		{"from" : "DATE_ADD", "to": "DATEADD"},
		//{"from" : "DATEADD","arg_pattern" : {"1" : "static"},"output_template" :"DATE_ADD($3, $2)"},
		{"from" : "DATEADD","arg_pattern" : {"1" : "'day'"},"output_template" :"DATE_ADD($3, $2)"},
		{"from" : "DATEADD","arg_pattern" : {"1" : "'d'"},"output_template" :"DATE_ADD($3, $2)"},
		{"from" : "DATEADD","arg_pattern" : {"1" : "'month'"},"output_template" :"ADD_MONTHS($3, $2)"},
		{"from" : "DATEADD","arg_pattern" : {"1" : "month"},"output_template" :"ADD_MONTHS($3, $2)"},
		{"from" : "DATEADD","arg_pattern" : {"1" : "'year'"},"output_template" :"ADD_MONTHS($3, $2 * 12)"},
		{"from" : "DATEADD","arg_pattern" : {"1" : "'week'"},"output_template" :"DATE_ADD($3, $2 * 7)"},
		{"from" : "DATEADD","arg_pattern" : {"1" : "'quarter'"},"output_template" :"ADD_MONTHS($3, $2 * 3)"},
		{"from" : "DATEADD","arg_pattern" : {"1" : "'hour'"},"output_template" :"TIMESTAMPADD(HOUR, $2, $3)"},
		{"from" : "DATEADD","arg_pattern" : {"1" : "'h'"},"output_template" :"TIMESTAMPADD(HOUR, $2, $3)"},
		{"from" : "DATEADD","arg_pattern" : {"1" : "'minute'"},"output_template" :"TIMESTAMPADD(MINUTE, $2, $3)"},
		{"from" : "DATEADD","arg_pattern" : {"1" : "'second'"},"output_template" :"TIMESTAMPADD(SECOND, $2, $3)"},
		{"from" : "DATEADD","arg_pattern" : {"1" : "'millisecond'"},"output_template" :"TIMESTAMPADD(MILLISECOND, $2, $3)"},
		{"from" : "DATEADD","arg_pattern" : {"1" : "'microsecond'"},"output_template" :"TIMESTAMPADD(MICROSECOND, $2, $3)"},

		{"from" : "DISTKEY", "to": "__BLANK__"},
		// {"from" : "LISTAGG","num_args":1, "to": "STRING_AGG"},
		// {"from" : "LISTAGG", "output_template": "ARRAY_JOIN(COLLECT_LIST($1), $2)"},
		{"from" : "GETDATE", "output_template": "CURRENT_TIMESTAMP"},
		{"from" : "PGDATE_PART", "to": "date_part"},

		{"from" : "compound_sortkey", "output_template": "ZORDER BY($1)"},
		{"from" : "interleaved_sortkey", "output_template": "ZORDER BY($1)"},
		{"from" : "sortkey", "output_template": "ZORDER BY($1)"},
		{"from" : "RIGHT", "output_template": "SUBSTRING($1, LENGTH($1) - $2 + 1, $2)"},
		{"from" : "nvl", "to": "COALESCE"},
		//{"from" : "SPLIT_PART", "output_template": "split($1, $2)[$3-1]"},
		//{"from" : "BOOL_OR", "output_template": "MAX(CAST($1 AS INT)) > 0"},
		{"from" : "REGEXP_SUBSTR", "output_template": "regexp_extract($1, $2, 0)"},
		{"from" : "CHR", "to": "CHAR"},
		{"from" : "ARRAY_TO_STRING", "to" : "ARRAY_JOIN"},
		{"from" : "TIMEZONE", "output_template" : "from_utc_timestamp($2, $1)"},
		{"from" : "CHARINDEX", "output_template" : "INSTR($2, $1)"},
		{"from" : "REGEXP_COUNT", "output_template" : "LENGTH($1) - LENGTH(REGEXP_REPLACE($1, $2, ''))"},
		{"from" : "PG_BACKEND_PID", "output_template" : "current_user()||'_'|| current_database()"},

		{"from": "TRIM_LEADING", "to" : "LTRIM", "arg_token_output" : "2,1", "split_string" : "FROM" },
		{"from": "TRIM_TRAILING", "to" : "RTRIM", "arg_token_output" : "2,1", "split_string" : "FROM" }, //tells the parser to get tokens from args and place them inside the new call
		{"from": "TRUNC", "to": "TRUNC", "arg_placement" : { "1":"2||'DD'", "2":"1" } },
		{"from": "QUOTE_LITERAL", "output_template": "concat('\'', regexp_replace($1, '\'', '\'\'') , '\'')"},
		{"from": "MEDIAN", "output_template": "PERCENTILE_CONT(0.5) WITHIN GROUP (ORDER BY $1)"},
		{"from": "ARRAY_UPPER", "output_template": "size($1)"},		
		
		{"from": "CONSTRAINT_CHECK", "to": "__BLANK__"},
		{"from": "REFERENCES", "to": "__BLANK__"},
		
		{"from": "UNK_IDX", "to": "UNIQUE", "statement_categories" : ["TABLE_DDL"], "placement" : "append_inside_ddl"},
		{"from": "UNK_IDX", "to": "ALTER TABLE __LAST_OBJECT_CREATED__ ADD UNIQUE", "statement_categories" : ["TABLE_DDL_LIKE","TABLE_DDL_AS_SELECT"], "placement" : "append_after_ddl"},
		{"from": "CREATE_INDEX", "to": "__BLANK__", "statement_categories" : ["TABLE_DDL","TABLE_DDL_LIKE","TABLE_DDL_AS_SELECT"]},
		{"from": "PRIM_IDX", "to": "__BLANK__"},
		{"from": "INDEX", "to": "__BLANK__", "statement_categories" : ["TABLE_DDL","TABLE_DDL_LIKE","TABLE_DDL_AS_SELECT"]},
		{"from": "ORDER_BY_VALUES", "to": "__BLANK__", "statement_categories" : ["TABLE_DDL","TABLE_DDL_LIKE","TABLE_DDL_AS_SELECT"]},

		//{"from": "TRANSLATE", "to" : "__ELIMINATE_CALL__"}, //get rid of the function call with the parens, but leave the inner part
		
		{"from": "COMPRESS", "to": "__BLANK__"},
		{"from": "COMPRESS_SUPPRESS", "to": "__BLANK__"},
		{"from": "ANY_MATCH", "output_template": "size(filter($2,$1))>0"},
		{"from": "GENERATE_SERIES", "num_args" : "2","output_template": "explode(sequence($1,$2,1))"},
		{"from": "GENERATE_SERIES", "num_args" : "3","output_template": "explode(sequence($1,$2,$3))"},
		{"from": "HAS_TABLE_PRIVILEGE","to": "HAS_TABLE_PRIVILEGE_FUNCTION--fix me create udf querying information schema"},
		{"from": "JSON_EXTRACT_ARRAY_ELEMENT_TEXT", "output_template": "GET_JSON_OBJECT($1,'$[$2]')"},
		{"from": "JSON_EXTRACT_PATH_TEXT","num_args" : "2", "output_template": "get_json_object($1,__QUOTE__DOLLAR__$2)"},
		{"from": "JSON_EXTRACT_PATH_TEXT","arg_pattern" : {"3" : "(TRUE|FALSE)"},"num_args" : "3", "output_template": "get_json_object($1,__QUOTE__DOLLAR__$2)"},
		{"from": "JSON_EXTRACT_PATH_TEXT","arg_pattern" : {"4" : "(TRUE|FALSE)"},"num_args" : "4", "output_template": "get_json_object($1,__QUOTE__DOLLAR__$2__QUOTE__DOLLAR__$3)"},
		{"from": "JSON_EXTRACT_PATH_TEXT","arg_pattern" : {"5" : "(TRUE|FALSE)"},"num_args" : "5", "output_template": "get_json_object($1,__QUOTE__DOLLAR__$2__QUOTE__DOLLAR__$3__QUOTE__DOLLAR__$4)"},
		{"from": "JSON_EXTRACT_PATH_TEXT","arg_pattern" : {"6" : "(TRUE|FALSE)"},"num_args" : "6", "output_template": "get_json_object($1,__QUOTE__DOLLAR__$2__QUOTE__DOLLAR__$3__QUOTE__DOLLAR__$4__QUOTE__DOLLAR__$5)"},
		{"from": "JSON_EXTRACT_PATH_TEXT","num_args" : "3", "output_template": "get_json_object($1,__QUOTE__DOLLAR__$2__QUOTE__DOLLAR__$3)"},
		{"from": "JSON_EXTRACT_PATH_TEXT","num_args" : "4", "output_template": "get_json_object($1,__QUOTE__DOLLAR__$2__QUOTE__DOLLAR__$3__QUOTE__DOLLAR__$4)"},
		{"from": "JSON_EXTRACT_PATH_TEXT","num_args" : "5", "output_template": "get_json_object($1,__QUOTE__DOLLAR__$2__QUOTE__DOLLAR__$3__QUOTE__DOLLAR__$4__QUOTE__DOLLAR__$5)"},
		{"from": "JSON_EXTRACT_PATH_TEXT","num_args" : "6", "output_template": "get_json_object($1,__QUOTE__DOLLAR__$2__QUOTE__DOLLAR__$3__QUOTE__DOLLAR__$4__QUOTE__DOLLAR__$5__QUOTE__DOLLAR__$6)"},
		{"from": "get_json_object","to" : "GET_JSON_OBJECT"},
		{"from":"JSON_PARSE","to": "FROM_JSON"},
		{"from":"is_valid_json","output_template": "CASE WHEN TRY_PARSE_JSON($1) is not null then true else false end"},
		{"from":"CONVERT_TIMEZONE","num_args" : "3","output_template": "FROM_UTC_TIMESTAMP( TO_UTC_TIMESTAMP($3,$1), $2)"},
		{"from":"CONVERT_TIMEZONE","num_args" : "2","output_template": "FROM_UTC_TIMESTAMP($2,$1)"},
		{"from":"CONVERT","output_template": "CAST($2 as $1)"},
		{"from":"get_array_length","to": "size"},
		{"from":"SPLIT_TO_ARRAY","to": "SPLIT"},
		{"from":"URLPARSE","to": "PARSE_URL"},
		{"from":"ISNULL","to": "COALESCE"},
		{"from":"CAST_NAN_TO_NULL","output_template": "NANVL($1, NULL)"},
		{"from":"WEEK_TRUNC_SUNDAY","output_template": "date_sub(date_trunc('week', to_date($1)), 1)"},
		{"from":"PCT_DIVISION","output_template": "CASE WHENE $2 = 0 THEN NULL ESLE ($1/$2)*100 END"},
		{"from":"VARCHAR_TO_BOOL","output_template": "CASE WHEN LOWER($1) IN ('true','t','yes','y','1') THEN TRUE ELSE FALSE  END"},
		{"from" : "LEAST","num_args" : "1","output_template" :"$1"}
	]
}