objects:
  spms: "['S001', 'S002']"
  optmap_test: reboost.spms.load_optmap_all(ARGS.optmap_path)

processing_groups:
  - name: spms

    detector_mapping:
      - output: OBJECTS.spms
        input: det001

    outputs:
      - t0
      - evtid
      - edep
      - pe_times
      - pe_times_lar
      - pe_times_lar_full

    pre_operations:
      num_scint_ph:
        reboost.spms.emitted_scintillation_photons(HITS.edep, HITS.particle,
        "lar")

    detector_objects:
      optmap_lar: reboost.spms.load_optmap(ARGS.optmap_path, DETECTOR)

    operations:
      num_det_ph: reboost.spms.number_of_detected_photoelectrons(
        HITS.xloc, HITS.yloc, HITS.zloc, HITS.num_scint_ph,
        DETECTOR_OBJECTS.optmap_lar, DETECTOR)
      pe_times_lar:
        reboost.spms.photoelectron_times(HITS.num_det_ph, HITS.particle,
        HITS.time, "lar")
      pe_times_lar_full:
        reboost.spms.detected_photoelectrons( HITS.num_scint_ph, HITS.particle,
        HITS.time, HITS.xloc, HITS.yloc, HITS.zloc, DETECTOR_OBJECTS.optmap_lar,
        "lar", DETECTOR )
