Metadata-Version: 2.4
Name: aiagent-runner
Version: 0.1.12
Summary: Runner for AI Agent PM - executes tasks via MCP and CLI
Author: AI Agent PM Team
License-Expression: MIT
Keywords: agent,ai,automation,mcp,orchestration,task-management
Classifier: Development Status :: 3 - Alpha
Classifier: Environment :: Console
Classifier: Intended Audience :: Developers
Classifier: License :: OSI Approved :: MIT License
Classifier: Operating System :: OS Independent
Classifier: Programming Language :: Python :: 3
Classifier: Programming Language :: Python :: 3.11
Classifier: Programming Language :: Python :: 3.12
Classifier: Topic :: Software Development :: Libraries :: Python Modules
Requires-Python: >=3.9
Requires-Dist: filelock>=3.0.0
Requires-Dist: pyyaml>=6.0
Provides-Extra: dev
Requires-Dist: aiohttp>=3.9; extra == 'dev'
Requires-Dist: pytest-asyncio>=0.23; extra == 'dev'
Requires-Dist: pytest-cov>=4.1; extra == 'dev'
Requires-Dist: pytest>=8.0; extra == 'dev'
Provides-Extra: http
Requires-Dist: aiohttp>=3.9; extra == 'http'
Description-Content-Type: text/markdown

# AI Agent PM Coordinator

å…¨ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã®ã‚¿ã‚¹ã‚¯å®Ÿè¡Œã‚’çµ±åˆç®¡ç†ã™ã‚‹ã‚ªãƒ¼ã‚±ã‚¹ãƒˆãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãƒ‡ãƒ¼ãƒ¢ãƒ³ã€‚

---

## ğŸš¨ è‡´å‘½çš„ãªè¨­è¨ˆé•åè­¦å‘Š (2026-01-09)

**ç¾åœ¨ã®å®Ÿè£…ã«ã¯è‡´å‘½çš„ãªè¨­è¨ˆé•åãŒã‚ã‚Šã¾ã™ã€‚ä¿®æ­£ãŒå¿…è¦ã§ã™ã€‚**

### å•é¡Œç‚¹

Coordinator/Runnerã¯**ç´”ç²‹ãªMCPã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆ**ã§ã‚ã‚‹ã¹ãã§ã™ãŒã€ç¾åœ¨ã®å®Ÿè£…ã¯ä»¥ä¸‹ã®ä¸æ­£ãªæƒ…å ±ã‚’ä¿æŒã—ã¦ã„ã¾ã™ï¼š

| è¨­å®šé …ç›® | å•é¡Œ | å¯¾å¿œ |
|---------|------|------|
| `mcp_server_command` | ã‚µãƒ¼ãƒãƒ¼èµ·å‹•ã‚³ãƒãƒ³ãƒ‰ã‚’ä¿æŒ | **å‰Šé™¤å¿…é ˆ** |
| `mcp_database_path` | DBãƒ‘ã‚¹ï¼ˆå†…éƒ¨å®Ÿè£…è©³ç´°ï¼‰ã‚’ä¿æŒ | **å‰Šé™¤å¿…é ˆ** |

### è¨­è¨ˆåŸå‰‡

```
âœ… æ­£ã—ã„è¨­è¨ˆ: Coordinatorã¯ã‚½ã‚±ãƒƒãƒˆæ¥ç¶šã®ã¿è¡Œã†ç´”ç²‹ãªã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆ
âŒ ç¾åœ¨ã®å®Ÿè£…: CoordinatorãŒã‚µãƒ¼ãƒãƒ¼èµ·å‹•ã‚„DBæ¥ç¶šæƒ…å ±ã‚’ç®¡ç†
```

### å½±éŸ¿

- Agent Instanceã”ã¨ã«æ–°ã—ã„MCPã‚µãƒ¼ãƒãƒ¼ã‚’stdio transportã§èµ·å‹•
- è¤‡æ•°ã®MCPã‚µãƒ¼ãƒãƒ¼ãŒåŒã˜DBã«åŒæ™‚ã‚¢ã‚¯ã‚»ã‚¹ â†’ ãƒ‡ãƒ¼ã‚¿æ•´åˆæ€§ã®å•é¡Œ
- ãƒ†ã‚¹ãƒˆã¨æœ¬ç•ªã§ç•°ãªã‚‹DBè¨­å®šãŒå¿…è¦ â†’ è¨­å®šã®è¤‡é›‘åŒ–

### æ­£ã—ã„ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£

```
[ã‚¢ãƒ—ãƒª] â†’ MCPãƒ‡ãƒ¼ãƒ¢ãƒ³èµ·å‹•ï¼ˆå”¯ä¸€ã®ã‚µãƒ¼ãƒãƒ¼ï¼‰
[Coordinator] â†’ Unix Socketã§æ¥ç¶šï¼ˆã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã®ã¿ï¼‰
[Agent Instance] â†’ åŒã˜Unix Socketã§æ¥ç¶šï¼ˆã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã®ã¿ï¼‰
```

è©³ç´°ã¯ `docs/plan/PHASE4_COORDINATOR_ARCHITECTURE.md` ã®è­¦å‘Šã‚»ã‚¯ã‚·ãƒ§ãƒ³ã‚’å‚ç…§ã€‚

---

## ã‚¯ã‚¤ãƒƒã‚¯ã‚¹ã‚¿ãƒ¼ãƒˆ

```bash
cd runner
pip install -e .

# ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆè¨­å®šã§èµ·å‹•ï¼ˆconfig/coordinator_default.yaml ã‚’ä½¿ç”¨ï¼‰
python -m aiagent_runner --coordinator
```

---

## Coordinatorãƒ¢ãƒ¼ãƒ‰ï¼ˆæ¨å¥¨ï¼‰

å˜ä¸€ã®CoordinatorãŒå…¨ã¦ã®(agent_id, project_id)ãƒšã‚¢ã‚’ç®¡ç†ã—ã¾ã™ã€‚

### åŸºæœ¬èµ·å‹•

```bash
# ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆè¨­å®šã§èµ·å‹•
python -m aiagent_runner --coordinator

# è©³ç´°ãƒ­ã‚°å‡ºåŠ›
python -m aiagent_runner --coordinator -v
```

### ã‚«ã‚¹ã‚¿ãƒ è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«

```bash
python -m aiagent_runner --coordinator -c /path/to/config.yaml
```

### è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ä¾‹

```yaml
# config/coordinator_default.yaml ãŒãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§èª­ã¿è¾¼ã¾ã‚Œã¾ã™
# ã‚«ã‚¹ã‚¿ãƒ è¨­å®šã§ä¸Šæ›¸ãå¯èƒ½

polling_interval: 10
max_concurrent: 3

# AI providers
ai_providers:
  claude:
    cli_command: claude
    cli_args:
      - "--dangerously-skip-permissions"
      - "--max-turns"
      - "50"

# Agents (passkeyã®ã¿ - ai_typeç­‰ã¯MCPã‹ã‚‰å–å¾—)
agents:
  agt_developer:
    passkey: secret123
  agt_reviewer:
    passkey: ${REVIEWER_PASSKEY}  # ç’°å¢ƒå¤‰æ•°å±•é–‹å¯¾å¿œ

log_directory: /tmp/coordinator_logs
```

### ãƒãƒƒã‚¯ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰å®Ÿè¡Œ

```bash
nohup python -m aiagent_runner --coordinator -v > coordinator.log 2>&1 &
```

---

## è¨­å®šã®å„ªå…ˆé †ä½

1. **ã‚³ãƒãƒ³ãƒ‰ãƒ©ã‚¤ãƒ³å¼•æ•°** (`--polling-interval` ç­‰)
2. **æŒ‡å®šã—ãŸè¨­å®šãƒ•ã‚¡ã‚¤ãƒ«** (`-c /path/to/config.yaml`)
3. **ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆè¨­å®š** (`runner/config/coordinator_default.yaml`)
4. **çµ„ã¿è¾¼ã¿ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤**

---

## å‹•ä½œãƒ•ãƒ­ãƒ¼

1. MCPã‚µãƒ¼ãƒãƒ¼ã«æ¥ç¶šï¼ˆUnixã‚½ã‚±ãƒƒãƒˆï¼‰
2. `list_active_projects_with_agents()` ã§å…¨ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ»ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã‚’å–å¾—
3. å„(agent_id, project_id)ãƒšã‚¢ã«å¯¾ã—ã¦ `get_agent_action()` ã‚’å‘¼ã³å‡ºã—
4. ä½œæ¥­ãŒå¿…è¦ãªå ´åˆã€Agent Instanceï¼ˆClaude CLIç­‰ï¼‰ã‚’ã‚¹ãƒãƒ¼ãƒ³
5. Agent InstanceãŒ `authenticate` â†’ `get_my_task` â†’ å®Ÿè¡Œ â†’ `report_completed`
6. å¾…æ©Ÿã—ã¦2ã«æˆ»ã‚‹

---

## å‰ææ¡ä»¶

- MCPã‚µãƒ¼ãƒãƒ¼ãŒèµ·å‹•ã—ã¦ã„ã‚‹ã“ã¨
- ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆãŒã‚¢ãƒ—ãƒªã§ç™»éŒ²æ¸ˆã¿ã§ã€passkeyãŒè¨­å®šã•ã‚Œã¦ã„ã‚‹ã“ã¨
- è©²å½“ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆãŒãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã«å‰²ã‚Šå½“ã¦ã‚‰ã‚Œã¦ã„ã‚‹ã“ã¨
- ã‚¿ã‚¹ã‚¯ãŒ `in_progress` ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã§ã‚ã‚‹ã“ã¨

---

## Legacy Runnerãƒ¢ãƒ¼ãƒ‰ï¼ˆéæ¨å¥¨ï¼‰

1ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ = 1ãƒ‡ãƒ¼ãƒ¢ãƒ³ ã®æ—§ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã€‚

```bash
# éæ¨å¥¨: Coordinatorãƒ¢ãƒ¼ãƒ‰ã‚’ä½¿ç”¨ã—ã¦ãã ã•ã„
aiagent-runner --agent-id <AGENT_ID> --passkey <PASSKEY> --project-id <PROJECT_ID>
```

---

## é–‹ç™º

```bash
pip install -e ".[dev]"
pytest
```
