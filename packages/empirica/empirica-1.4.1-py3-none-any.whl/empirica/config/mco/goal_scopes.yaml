# =============================================================================
# GOAL SCOPE MAPPING - Epistemic Vector to Scope Vector Recommendations
# =============================================================================
# 
# Purpose: Map epistemic vectors to recommended scope vectors for goal setting
# Usage: Loaded by AI during self-assessment to determine appropriate scope
# Philosophy: NO goal heuristics/templates - AI determines goals, system maps vectors
#
# Architecture: Part of MCO (Meta-Agent Configuration Object)
#   - This file provides SCOPE RECOMMENDATIONS based on epistemic state
#   - Goals themselves are determined by Sentinel or AI, never heuristics
#   - AI self-assesses epistemic vectors and consults this mapping
#
# Vector Definitions:
#   - breadth: 0.0-1.0 (0=single function, 1=entire codebase)  
#   - duration: 0.0-1.0 (0=minutes/hours, 1=weeks/months)
#   - coordination: 0.0-1.0 (0=solo work, 1=heavy cross-AI coordination)
#

metadata:
  version: "1.0.0"
  last_updated: "2025-01-29"
  author: "Empirica Framework"
  description: "Epistemic vector to scope vector mapping - no goal heuristics"

# =============================================================================
# SCOPE RECOMMENDATIONS BY EPISTEMIC PATTERN
# =============================================================================

scope_recommendations:

  # ---------------------------------------------------------------------------
  # HIGH KNOWLEDGE + HIGH CONFIDENCE = BROADER SCOPE
  # ---------------------------------------------------------------------------
  knowledge_leader:
    description: "AI has strong domain knowledge and confidence"
    epistemic_pattern:
      know: {min: 0.80}          # Strong domain knowledge
      clarity: {min: 0.75}       # Clear understanding
      coherence: {min: 0.70}     # Coherent mental model
      confidence: {min: 0.75}    # High confidence in approach
    
    recommended_scope:
      breadth: 0.7              # Can handle broader scope
      duration: 0.6             # Can commit to longer duration
      coordination: 0.4         # Moderate coordination needed
    
    rationale: "High knowledge + confidence enables broader scope work"

  # ---------------------------------------------------------------------------
  # LOW KNOWLEDGE + LOW CONFIDENCE = NARROW SCOPE
  # ---------------------------------------------------------------------------
  learning_mode:
    description: "AI learning new domain or uncertain approach"
    epistemic_pattern:
      know: {max: 0.50}         # Limited knowledge
      uncertainty: {min: 0.60}  # High uncertainty
      engagement: {min: 0.60}   # Still engaged though
      clarity: {max: 0.60}      # Less clear understanding
    
    recommended_scope:
      breadth: 0.2              # Keep scope narrow for learning
      duration: 0.2             # Short duration to iterate
      coordination: 0.1         # Minimal coordination
    
    rationale: "Uncertainty requires narrow scope for safety and learning"

  # ---------------------------------------------------------------------------
  # HIGH COMPLEXITY SIGNAL = REDUCE SCOPE
  # ---------------------------------------------------------------------------
  complexity_signals:
    description: "High complexity indicators suggest scope reduction"
    epistemic_pattern:
      density: {min: 0.75}      # High cognitive load
      uncertainty: {min: 0.70}  # Significant uncertainty
      signal: {max: 0.60}       # Weak signal quality
    
    recommended_scope:
      breadth: 0.3              # Reduce breadth
      duration: 0.3             # Reduce duration
      coordination: 0.2         # Reduce coordination
    
    rationale: "High complexity signals require scope reduction"

  # ---------------------------------------------------------------------------
  # HIGH COORDINATION NEEDED = BROADEN SCOPE FOR INTEGRATION
  # ---------------------------------------------------------------------------
  coordination_heavy:
    description: "Task requires significant cross-AI coordination"
    epistemic_pattern:
      context: {min: 0.70}      # Good context awareness
      coherence: {min: 0.75}    # Strong coherence
      impact: {min: 0.60}       # High impact task
    
    recommended_scope:
      breadth: 0.6              # Broader scope for integration
      duration: 0.7             # Longer duration for coordination
      coordination: 0.8         # Heavy coordination required
    
    rationale: "Coordination-heavy tasks require broader scope"

  # ---------------------------------------------------------------------------
  # RAPID ITERATION MODE = SMALL SCOPE
  # ---------------------------------------------------------------------------
  rapid_iteration:
    description: "Rapid prototyping or exploration mode"
    epistemic_pattern:
      engagement: {min: 0.85}   # High engagement
      uncertainty: {min: 0.50}  # Some uncertainty but manageable
      density: {max: 0.70}      # Manageable complexity
    
    recommended_scope:
      breadth: 0.3              # Small scope for quick iterations
      duration: 0.2             # Very short duration
      coordination: 0.2         # Minimal coordination
    
    rationale: "Rapid iteration requires small, focused scope"

  # ---------------------------------------------------------------------------
  # PRODUCTION WORK = MEDIUM-HIGH SCOPE
  # ---------------------------------------------------------------------------
  production_focused:
    description: "Production-quality work with standards"
    epistemic_pattern:
      know: {min: 0.70}         # Solid knowledge base
      clarity: {min: 0.70}      # Clear requirements
      coherence: {min: 0.65}    # Coherent design
      completion: {min: 0.60}   # Strong completion focus
    
    recommended_scope:
      breadth: 0.5              # Medium scope for production
      duration: 0.5             # Medium duration
      coordination: 0.4         # Moderate coordination
    
    rationale: "Production work requires balanced scope with standards"

  # ---------------------------------------------------------------------------
  # WEB PROJECT / DESIGN WORK = WIDE SCOPE + MANDATORY REFERENCE CHECK
  # ---------------------------------------------------------------------------
  web_project_design:
    description: "Web development with design systems and multi-file components"
    epistemic_pattern:
      know: {max: 0.50}         # Often unfamiliar with design system
      context: {min: 0.60}      # Need good context awareness
      clarity: {max: 0.60}      # Design systems can be unclear initially
      breadth_indicator: {min: 0.70}  # Wide scope across many files
    
    recommended_scope:
      breadth: 0.75             # Wide scope - many files affected
      duration: 0.6             # Medium-long duration
      coordination: 0.4         # Moderate coordination (design + dev)
    
    protocol_requirements:
      mandatory_handoff_query: true     # MUST query handoff reports first
      mandatory_reference_check: true   # MUST view reference implementation first
      preflight_enforcement: true       # MUST run PREFLIGHT if KNOW < 0.5 or UNCERTAINTY > 0.7
    
    workflow:
      - "1. Query handoff reports for design system knowledge"
      - "2. View reference implementation (e.g., index.astro) BEFORE creating"
      - "3. Extract patterns (glassmorphic design, color palette, component structure)"
      - "4. PREFLIGHT assessment if KNOW < 0.5 or UNCERTAINTY > 0.7"
      - "5. Create with validated patterns, not assumptions"
    
    rationale: "Wide scope web work requires reference validation to prevent 2+ hour mistakes from wrong assumptions about design systems"
    
    mistake_prevention:
      common_mistake: "Creating pages/components without checking design system first"
      root_cause_vector: "KNOW"
      typical_cost: "2-4 hours of rework"
      prevention: "ALWAYS view reference implementation BEFORE creating new pages/components"

  # ---------------------------------------------------------------------------
  # MULTI-SESSION CONTINUATION = MANDATORY HANDOFF QUERY
  # ---------------------------------------------------------------------------
  session_continuation:
    description: "Resuming work from previous session (multi-session project)"
    epistemic_pattern:
      context: {max: 0.50}      # Limited context from previous session
      know: {max: 0.40}         # Don't know what previous AI discovered
      uncertainty: {min: 0.60}  # High uncertainty about prior work
    
    recommended_scope:
      breadth: 0.6              # Inherit scope from previous session
      duration: 0.5             # Continue duration estimate
      coordination: 0.5         # Multi-session implies coordination
    
    protocol_requirements:
      mandatory_handoff_query: true     # MUST query handoff before starting
      mandatory_goals_query: true       # MUST check goals/subtasks status
      preflight_enforcement: true       # MUST run PREFLIGHT if KNOW < 0.5
    
    workflow:
      - "1. Query handoff reports: empirica handoff-query --session-id <ID>"
      - "2. Review key_findings (what was learned)"
      - "3. Review remaining_unknowns (what needs investigation)"
      - "4. Query goals/subtasks: empirica goals-list --session-id <ID>"
      - "5. Check completed vs pending subtasks"
      - "6. PREFLIGHT assessment with inherited context"
      - "7. Continue work from stopping point, not from scratch"
    
    rationale: "Multi-session work requires explicit continuity protocol to avoid redoing completed work and losing discovered knowledge"
    
    mistake_prevention:
      common_mistake: "Starting new session without querying handoff/goals"
      root_cause_vector: "CONTEXT"
      typical_cost: "1-3 hours of duplicate work or lost progress"
      prevention: "MANDATORY handoff query at session start for multi-session projects"

# =============================================================================
# DYNAMIC ADJUSTMENT RULES
# =============================================================================

adjustment_rules:
  # Rules for dynamically adjusting scope based on epistemic changes during CASCADE execution
  uncertainty_spike:
    condition: "uncertainty increases by >0.2 during execution"
    action: "reduce scope by reducing breadth and duration by 0.2"
    
  knowledge_gain:
    condition: "know increases by >0.2 during investigation"
    action: "consider expanding scope by increasing breadth by 0.2"
    
  complexity_overload:
    condition: "density > 0.85 OR coherence < 0.4"
    action: "immediately reduce scope to prevent overload"
  complexity_overload:
    condition: "density > 0.85 OR coherence < 0.4"
    action: "immediately reduce scope to prevent overload"

# =============================================================================
# SCOPE VALIDATION RULES
# =============================================================================

validation_coherence:
  # Sentinel validates scope coherence - warnings for inconsistent combinations
  # Note: Warnings are advisory, not blocking
  high_coord_narrow_scope:
    scope: {coordination: {min: 0.7}, breadth: {max: 0.3}}
    warning: "High coordination without breadth scope may indicate analysis paralysis"
    
  short_duration_heavy_coordination:
    scope: {duration: {max: 0.3}, coordination: {min: 0.6}}
    warning: "Heavy coordination with short duration may be unrealistic"

# =============================================================================
# USAGE GUIDELINES
# =============================================================================

usage_notes:
  - "This mapping is ADVISORY only - AI can override based on task requirements"
  - "Sentinel may override for strategic reasons (priority, resource allocation)"
  - "AI should consider multiple patterns and choose most relevant"
  - "Scope adjustments can happen during CASCADE execution based on epistemic changes"
  - "Goal objectives are NEVER predefined - only scope vector recommendations"