# This file is auto-generated by the CDP protocol generator.
# Do not edit this file manually as your changes will be overwritten.
# Generated from Chrome DevTools Protocol specifications.

from __future__ import annotations

from typing import Literal, TYPE_CHECKING
from dataclasses import dataclass
from cdpify.shared.models import CDPModel

if TYPE_CHECKING:
    from cdpify.domains import network

"""
An internal certificate ID value.
"""
CertificateId = int

"""
A description of mixed content (HTTP resources on HTTPS pages), as defined by
https://www.w3.org/TR/mixed-content/#categories
"""
MixedContentType = Literal["blockable", "optionally-blockable", "none"]

"""
The security level of a page or resource.
"""
SecurityState = Literal[
    "unknown", "neutral", "insecure", "secure", "info", "insecure-broken"
]


@dataclass(kw_only=True)
class CertificateSecurityState(CDPModel):
    """
    Details about the security state of the page certificate.
    """

    protocol: str
    key_exchange: str
    key_exchange_group: str | None | None = None
    cipher: str
    mac: str | None | None = None
    certificate: list[str]
    subject_name: str
    issuer: str
    valid_from: network.TimeSinceEpoch
    valid_to: network.TimeSinceEpoch
    certificate_network_error: str | None | None = None
    certificate_has_weak_signature: bool
    certificate_has_sha1_signature: bool
    modern_ssl: bool
    obsolete_ssl_protocol: bool
    obsolete_ssl_key_exchange: bool
    obsolete_ssl_cipher: bool
    obsolete_ssl_signature: bool


SafetyTipStatus = Literal["badReputation", "lookalike"]


@dataclass(kw_only=True)
class SafetyTipInfo(CDPModel):
    safety_tip_status: SafetyTipStatus
    safe_url: str | None | None = None


@dataclass(kw_only=True)
class VisibleSecurityState(CDPModel):
    """
    Security state information about the page.
    """

    security_state: SecurityState
    certificate_security_state: CertificateSecurityState | None | None = None
    safety_tip_info: SafetyTipInfo | None | None = None
    security_state_issue_ids: list[str]


@dataclass(kw_only=True)
class SecurityStateExplanation(CDPModel):
    """
    An explanation of an factor contributing to the security state.
    """

    security_state: SecurityState
    title: str
    summary: str
    description: str
    mixed_content_type: MixedContentType
    certificate: list[str]
    recommendations: list[str] | None | None = None


@dataclass(kw_only=True)
class InsecureContentStatus(CDPModel):
    """
    Information about insecure content on the page.
    """

    ran_mixed_content: bool
    displayed_mixed_content: bool
    contained_mixed_form: bool
    ran_content_with_cert_errors: bool
    displayed_content_with_cert_errors: bool
    ran_insecure_content_style: SecurityState
    displayed_insecure_content_style: SecurityState


"""
The action to take when a certificate error occurs. continue will continue processing
the request and cancel will cancel the request.
"""
CertificateErrorAction = Literal["continue", "cancel"]
