# This file is auto-generated by the CDP protocol generator.
# Do not edit this file manually as your changes will be overwritten.
# Generated from Chrome DevTools Protocol specifications.

from __future__ import annotations

from typing import TYPE_CHECKING, Any

if TYPE_CHECKING:
    from cdpify.client import CDPClient

from .commands import (
    AccessibilityCommand,
    GetAXNodeAndAncestorsParams,
    GetAXNodeAndAncestorsResult,
    GetChildAXNodesParams,
    GetChildAXNodesResult,
    GetFullAXTreeParams,
    GetFullAXTreeResult,
    GetPartialAXTreeParams,
    GetPartialAXTreeResult,
    GetRootAXNodeParams,
    GetRootAXNodeResult,
    QueryAXTreeParams,
    QueryAXTreeResult,
)

from .types import (
    AXNodeId,
)

if TYPE_CHECKING:
    from cdpify.domains import dom, page, runtime


class AccessibilityClient:
    def __init__(self, client: CDPClient) -> None:
        self._client = client

    async def disable(
        self,
        session_id: str | None = None,
    ) -> dict[str, Any]:
        """
        Disables the accessibility domain.
        """
        result = await self._client.send_raw(
            method=AccessibilityCommand.DISABLE,
            params=None,
            session_id=session_id,
        )
        return result

    async def enable(
        self,
        session_id: str | None = None,
    ) -> dict[str, Any]:
        """
        Enables the accessibility domain which causes `AXNodeId`s to remain consistent
        between method calls. This turns on accessibility for the page, which can impact
        performance until accessibility is disabled.
        """
        result = await self._client.send_raw(
            method=AccessibilityCommand.ENABLE,
            params=None,
            session_id=session_id,
        )
        return result

    async def get_partial_ax_tree(
        self,
        *,
        node_id: dom.NodeId | None = None,
        backend_node_id: dom.BackendNodeId | None = None,
        object_id: runtime.RemoteObjectId | None = None,
        fetch_relatives: bool | None = None,
        session_id: str | None = None,
    ) -> GetPartialAXTreeResult:
        """
        Fetches the accessibility node and partial accessibility tree for this DOM
        node, if it exists.
        """
        params = GetPartialAXTreeParams(
            node_id=node_id,
            backend_node_id=backend_node_id,
            object_id=object_id,
            fetch_relatives=fetch_relatives,
        )

        result = await self._client.send_raw(
            method=AccessibilityCommand.GET_PARTIAL_AX_TREE,
            params=params.to_cdp_params(),
            session_id=session_id,
        )
        return GetPartialAXTreeResult.from_cdp(result)

    async def get_full_ax_tree(
        self,
        *,
        depth: int | None = None,
        frame_id: page.FrameId | None = None,
        session_id: str | None = None,
    ) -> GetFullAXTreeResult:
        """
        Fetches the entire accessibility tree for the root Document
        """
        params = GetFullAXTreeParams(depth=depth, frame_id=frame_id)

        result = await self._client.send_raw(
            method=AccessibilityCommand.GET_FULL_AX_TREE,
            params=params.to_cdp_params(),
            session_id=session_id,
        )
        return GetFullAXTreeResult.from_cdp(result)

    async def get_root_ax_node(
        self,
        *,
        frame_id: page.FrameId | None = None,
        session_id: str | None = None,
    ) -> GetRootAXNodeResult:
        """
        Fetches the root node. Requires `enable()` to have been called previously.
        """
        params = GetRootAXNodeParams(frame_id=frame_id)

        result = await self._client.send_raw(
            method=AccessibilityCommand.GET_ROOT_AX_NODE,
            params=params.to_cdp_params(),
            session_id=session_id,
        )
        return GetRootAXNodeResult.from_cdp(result)

    async def get_ax_node_and_ancestors(
        self,
        *,
        node_id: dom.NodeId | None = None,
        backend_node_id: dom.BackendNodeId | None = None,
        object_id: runtime.RemoteObjectId | None = None,
        session_id: str | None = None,
    ) -> GetAXNodeAndAncestorsResult:
        """
        Fetches a node and all ancestors up to and including the root. Requires
        `enable()` to have been called previously.
        """
        params = GetAXNodeAndAncestorsParams(
            node_id=node_id, backend_node_id=backend_node_id, object_id=object_id
        )

        result = await self._client.send_raw(
            method=AccessibilityCommand.GET_AX_NODE_AND_ANCESTORS,
            params=params.to_cdp_params(),
            session_id=session_id,
        )
        return GetAXNodeAndAncestorsResult.from_cdp(result)

    async def get_child_ax_nodes(
        self,
        *,
        id: AXNodeId,
        frame_id: page.FrameId | None = None,
        session_id: str | None = None,
    ) -> GetChildAXNodesResult:
        """
        Fetches a particular accessibility node by AXNodeId. Requires `enable()` to
        have been called previously.
        """
        params = GetChildAXNodesParams(id=id, frame_id=frame_id)

        result = await self._client.send_raw(
            method=AccessibilityCommand.GET_CHILD_AX_NODES,
            params=params.to_cdp_params(),
            session_id=session_id,
        )
        return GetChildAXNodesResult.from_cdp(result)

    async def query_ax_tree(
        self,
        *,
        node_id: dom.NodeId | None = None,
        backend_node_id: dom.BackendNodeId | None = None,
        object_id: runtime.RemoteObjectId | None = None,
        accessible_name: str | None = None,
        role: str | None = None,
        session_id: str | None = None,
    ) -> QueryAXTreeResult:
        """
        Query a DOM node's accessibility subtree for accessible name and role. This
        command computes the name and role for all nodes in the subtree, including those
        that are ignored for accessibility, and returns those that match the specified
        name and role. If no DOM node is specified, or the DOM node does not exist, the
        command returns an error. If neither `accessibleName` or `role` is specified, it
        returns all the accessibility nodes in the subtree.
        """
        params = QueryAXTreeParams(
            node_id=node_id,
            backend_node_id=backend_node_id,
            object_id=object_id,
            accessible_name=accessible_name,
            role=role,
        )

        result = await self._client.send_raw(
            method=AccessibilityCommand.QUERY_AX_TREE,
            params=params.to_cdp_params(),
            session_id=session_id,
        )
        return QueryAXTreeResult.from_cdp(result)
