# This file is auto-generated by the CDP protocol generator.
# Do not edit this file manually as your changes will be overwritten.
# Generated from Chrome DevTools Protocol specifications.

from __future__ import annotations

from typing import TYPE_CHECKING, Any, Literal

if TYPE_CHECKING:
    from cdpify.client import CDPClient

from .commands import (
    InputCommand,
    DispatchDragEventParams,
    DispatchKeyEventParams,
    DispatchMouseEventParams,
    DispatchTouchEventParams,
    EmulateTouchFromMouseEventParams,
    ImeSetCompositionParams,
    InsertTextParams,
    SetIgnoreInputEventsParams,
    SetInterceptDragsParams,
    SynthesizePinchGestureParams,
    SynthesizeScrollGestureParams,
    SynthesizeTapGestureParams,
)

from .types import (
    DragData,
    GestureSourceType,
    MouseButton,
    TimeSinceEpoch,
    TouchPoint,
)


class InputClient:
    def __init__(self, client: CDPClient) -> None:
        self._client = client

    async def dispatch_drag_event(
        self,
        *,
        type: Literal["dragEnter", "dragOver", "drop", "dragCancel"],
        x: float,
        y: float,
        data: DragData,
        modifiers: int | None = None,
        session_id: str | None = None,
    ) -> dict[str, Any]:
        """
        Dispatches a drag event into the page.
        """
        params = DispatchDragEventParams(
            type=type, x=x, y=y, data=data, modifiers=modifiers
        )

        result = await self._client.send_raw(
            method=InputCommand.DISPATCH_DRAG_EVENT,
            params=params.to_cdp_params(),
            session_id=session_id,
        )
        return result

    async def dispatch_key_event(
        self,
        *,
        type: Literal["keyDown", "keyUp", "rawKeyDown", "char"],
        modifiers: int | None = None,
        timestamp: TimeSinceEpoch | None = None,
        text: str | None = None,
        unmodified_text: str | None = None,
        key_identifier: str | None = None,
        code: str | None = None,
        key: str | None = None,
        windows_virtual_key_code: int | None = None,
        native_virtual_key_code: int | None = None,
        auto_repeat: bool | None = None,
        is_keypad: bool | None = None,
        is_system_key: bool | None = None,
        location: int | None = None,
        commands: list[str] | None = None,
        session_id: str | None = None,
    ) -> dict[str, Any]:
        """
        Dispatches a key event to the page.
        """
        params = DispatchKeyEventParams(
            type=type,
            modifiers=modifiers,
            timestamp=timestamp,
            text=text,
            unmodified_text=unmodified_text,
            key_identifier=key_identifier,
            code=code,
            key=key,
            windows_virtual_key_code=windows_virtual_key_code,
            native_virtual_key_code=native_virtual_key_code,
            auto_repeat=auto_repeat,
            is_keypad=is_keypad,
            is_system_key=is_system_key,
            location=location,
            commands=commands,
        )

        result = await self._client.send_raw(
            method=InputCommand.DISPATCH_KEY_EVENT,
            params=params.to_cdp_params(),
            session_id=session_id,
        )
        return result

    async def insert_text(
        self,
        *,
        text: str,
        session_id: str | None = None,
    ) -> dict[str, Any]:
        """
        This method emulates inserting text that doesn't come from a key press, for
        example an emoji keyboard or an IME.
        """
        params = InsertTextParams(text=text)

        result = await self._client.send_raw(
            method=InputCommand.INSERT_TEXT,
            params=params.to_cdp_params(),
            session_id=session_id,
        )
        return result

    async def ime_set_composition(
        self,
        *,
        text: str,
        selection_start: int,
        selection_end: int,
        replacement_start: int | None = None,
        replacement_end: int | None = None,
        session_id: str | None = None,
    ) -> dict[str, Any]:
        """
        This method sets the current candidate text for IME. Use imeCommitComposition
        to commit the final text. Use imeSetComposition with empty string as text to
        cancel composition.
        """
        params = ImeSetCompositionParams(
            text=text,
            selection_start=selection_start,
            selection_end=selection_end,
            replacement_start=replacement_start,
            replacement_end=replacement_end,
        )

        result = await self._client.send_raw(
            method=InputCommand.IME_SET_COMPOSITION,
            params=params.to_cdp_params(),
            session_id=session_id,
        )
        return result

    async def dispatch_mouse_event(
        self,
        *,
        type: Literal["mousePressed", "mouseReleased", "mouseMoved", "mouseWheel"],
        x: float,
        y: float,
        modifiers: int | None = None,
        timestamp: TimeSinceEpoch | None = None,
        button: MouseButton | None = None,
        buttons: int | None = None,
        click_count: int | None = None,
        force: float | None = None,
        tangential_pressure: float | None = None,
        tilt_x: float | None = None,
        tilt_y: float | None = None,
        twist: int | None = None,
        delta_x: float | None = None,
        delta_y: float | None = None,
        pointer_type: Literal["mouse", "pen"] | None = None,
        session_id: str | None = None,
    ) -> dict[str, Any]:
        """
        Dispatches a mouse event to the page.
        """
        params = DispatchMouseEventParams(
            type=type,
            x=x,
            y=y,
            modifiers=modifiers,
            timestamp=timestamp,
            button=button,
            buttons=buttons,
            click_count=click_count,
            force=force,
            tangential_pressure=tangential_pressure,
            tilt_x=tilt_x,
            tilt_y=tilt_y,
            twist=twist,
            delta_x=delta_x,
            delta_y=delta_y,
            pointer_type=pointer_type,
        )

        result = await self._client.send_raw(
            method=InputCommand.DISPATCH_MOUSE_EVENT,
            params=params.to_cdp_params(),
            session_id=session_id,
        )
        return result

    async def dispatch_touch_event(
        self,
        *,
        type: Literal["touchStart", "touchEnd", "touchMove", "touchCancel"],
        touch_points: list[TouchPoint],
        modifiers: int | None = None,
        timestamp: TimeSinceEpoch | None = None,
        session_id: str | None = None,
    ) -> dict[str, Any]:
        """
        Dispatches a touch event to the page.
        """
        params = DispatchTouchEventParams(
            type=type,
            touch_points=touch_points,
            modifiers=modifiers,
            timestamp=timestamp,
        )

        result = await self._client.send_raw(
            method=InputCommand.DISPATCH_TOUCH_EVENT,
            params=params.to_cdp_params(),
            session_id=session_id,
        )
        return result

    async def cancel_dragging(
        self,
        session_id: str | None = None,
    ) -> dict[str, Any]:
        """
        Cancels any active dragging in the page.
        """
        result = await self._client.send_raw(
            method=InputCommand.CANCEL_DRAGGING,
            params=None,
            session_id=session_id,
        )
        return result

    async def emulate_touch_from_mouse_event(
        self,
        *,
        type: Literal["mousePressed", "mouseReleased", "mouseMoved", "mouseWheel"],
        x: int,
        y: int,
        button: MouseButton,
        timestamp: TimeSinceEpoch | None = None,
        delta_x: float | None = None,
        delta_y: float | None = None,
        modifiers: int | None = None,
        click_count: int | None = None,
        session_id: str | None = None,
    ) -> dict[str, Any]:
        """
        Emulates touch event from the mouse event parameters.
        """
        params = EmulateTouchFromMouseEventParams(
            type=type,
            x=x,
            y=y,
            button=button,
            timestamp=timestamp,
            delta_x=delta_x,
            delta_y=delta_y,
            modifiers=modifiers,
            click_count=click_count,
        )

        result = await self._client.send_raw(
            method=InputCommand.EMULATE_TOUCH_FROM_MOUSE_EVENT,
            params=params.to_cdp_params(),
            session_id=session_id,
        )
        return result

    async def set_ignore_input_events(
        self,
        *,
        ignore: bool,
        session_id: str | None = None,
    ) -> dict[str, Any]:
        """
        Ignores input events (useful while auditing page).
        """
        params = SetIgnoreInputEventsParams(ignore=ignore)

        result = await self._client.send_raw(
            method=InputCommand.SET_IGNORE_INPUT_EVENTS,
            params=params.to_cdp_params(),
            session_id=session_id,
        )
        return result

    async def set_intercept_drags(
        self,
        *,
        enabled: bool,
        session_id: str | None = None,
    ) -> dict[str, Any]:
        """
        Prevents default drag and drop behavior and instead emits
        `Input.dragIntercepted` events. Drag and drop behavior can be directly
        controlled via `Input.dispatchDragEvent`.
        """
        params = SetInterceptDragsParams(enabled=enabled)

        result = await self._client.send_raw(
            method=InputCommand.SET_INTERCEPT_DRAGS,
            params=params.to_cdp_params(),
            session_id=session_id,
        )
        return result

    async def synthesize_pinch_gesture(
        self,
        *,
        x: float,
        y: float,
        scale_factor: float,
        relative_speed: int | None = None,
        gesture_source_type: GestureSourceType | None = None,
        session_id: str | None = None,
    ) -> dict[str, Any]:
        """
        Synthesizes a pinch gesture over a time period by issuing appropriate touch
        events.
        """
        params = SynthesizePinchGestureParams(
            x=x,
            y=y,
            scale_factor=scale_factor,
            relative_speed=relative_speed,
            gesture_source_type=gesture_source_type,
        )

        result = await self._client.send_raw(
            method=InputCommand.SYNTHESIZE_PINCH_GESTURE,
            params=params.to_cdp_params(),
            session_id=session_id,
        )
        return result

    async def synthesize_scroll_gesture(
        self,
        *,
        x: float,
        y: float,
        x_distance: float | None = None,
        y_distance: float | None = None,
        x_overscroll: float | None = None,
        y_overscroll: float | None = None,
        prevent_fling: bool | None = None,
        speed: int | None = None,
        gesture_source_type: GestureSourceType | None = None,
        repeat_count: int | None = None,
        repeat_delay_ms: int | None = None,
        interaction_marker_name: str | None = None,
        session_id: str | None = None,
    ) -> dict[str, Any]:
        """
        Synthesizes a scroll gesture over a time period by issuing appropriate touch
        events.
        """
        params = SynthesizeScrollGestureParams(
            x=x,
            y=y,
            x_distance=x_distance,
            y_distance=y_distance,
            x_overscroll=x_overscroll,
            y_overscroll=y_overscroll,
            prevent_fling=prevent_fling,
            speed=speed,
            gesture_source_type=gesture_source_type,
            repeat_count=repeat_count,
            repeat_delay_ms=repeat_delay_ms,
            interaction_marker_name=interaction_marker_name,
        )

        result = await self._client.send_raw(
            method=InputCommand.SYNTHESIZE_SCROLL_GESTURE,
            params=params.to_cdp_params(),
            session_id=session_id,
        )
        return result

    async def synthesize_tap_gesture(
        self,
        *,
        x: float,
        y: float,
        duration: int | None = None,
        tap_count: int | None = None,
        gesture_source_type: GestureSourceType | None = None,
        session_id: str | None = None,
    ) -> dict[str, Any]:
        """
        Synthesizes a tap gesture over a time period by issuing appropriate touch
        events.
        """
        params = SynthesizeTapGestureParams(
            x=x,
            y=y,
            duration=duration,
            tap_count=tap_count,
            gesture_source_type=gesture_source_type,
        )

        result = await self._client.send_raw(
            method=InputCommand.SYNTHESIZE_TAP_GESTURE,
            params=params.to_cdp_params(),
            session_id=session_id,
        )
        return result
