# This file is auto-generated by the CDP protocol generator.
# Do not edit this file manually as your changes will be overwritten.
# Generated from Chrome DevTools Protocol specifications.

from __future__ import annotations

from typing import TYPE_CHECKING, Any

if TYPE_CHECKING:
    from cdpify.client import CDPClient

from .commands import (
    CSSCommand,
    AddRuleParams,
    AddRuleResult,
    CollectClassNamesParams,
    CollectClassNamesResult,
    CreateStyleSheetParams,
    CreateStyleSheetResult,
    ForcePseudoStateParams,
    ForceStartingStyleParams,
    GetAnimatedStylesForNodeParams,
    GetAnimatedStylesForNodeResult,
    GetBackgroundColorsParams,
    GetBackgroundColorsResult,
    GetComputedStyleForNodeParams,
    GetComputedStyleForNodeResult,
    GetEnvironmentVariablesResult,
    GetInlineStylesForNodeParams,
    GetInlineStylesForNodeResult,
    GetLayersForNodeParams,
    GetLayersForNodeResult,
    GetLocationForSelectorParams,
    GetLocationForSelectorResult,
    GetLonghandPropertiesParams,
    GetLonghandPropertiesResult,
    GetMatchedStylesForNodeParams,
    GetMatchedStylesForNodeResult,
    GetMediaQueriesResult,
    GetPlatformFontsForNodeParams,
    GetPlatformFontsForNodeResult,
    GetStyleSheetTextParams,
    GetStyleSheetTextResult,
    ResolveValuesParams,
    ResolveValuesResult,
    SetContainerQueryTextParams,
    SetContainerQueryTextResult,
    SetEffectivePropertyValueForNodeParams,
    SetKeyframeKeyParams,
    SetKeyframeKeyResult,
    SetLocalFontsEnabledParams,
    SetMediaTextParams,
    SetMediaTextResult,
    SetPropertyRulePropertyNameParams,
    SetPropertyRulePropertyNameResult,
    SetRuleSelectorParams,
    SetRuleSelectorResult,
    SetScopeTextParams,
    SetScopeTextResult,
    SetStyleSheetTextParams,
    SetStyleSheetTextResult,
    SetStyleTextsParams,
    SetStyleTextsResult,
    SetSupportsTextParams,
    SetSupportsTextResult,
    StopRuleUsageTrackingResult,
    TakeComputedStyleUpdatesResult,
    TakeCoverageDeltaResult,
    TrackComputedStyleUpdatesForNodeParams,
    TrackComputedStyleUpdatesParams,
)

from .types import (
    CSSComputedStyleProperty,
    SourceRange,
    StyleDeclarationEdit,
)

if TYPE_CHECKING:
    from cdpify.domains import dom, page


class CSSClient:
    def __init__(self, client: CDPClient) -> None:
        self._client = client

    async def add_rule(
        self,
        *,
        style_sheet_id: dom.StyleSheetId,
        rule_text: str,
        location: SourceRange,
        node_for_property_syntax_validation: dom.NodeId | None = None,
        session_id: str | None = None,
    ) -> AddRuleResult:
        """
        Inserts a new rule with the given `ruleText` in a stylesheet with given
        `styleSheetId`, at the position specified by `location`.
        """
        params = AddRuleParams(
            style_sheet_id=style_sheet_id,
            rule_text=rule_text,
            location=location,
            node_for_property_syntax_validation=node_for_property_syntax_validation,
        )

        result = await self._client.send_raw(
            method=CSSCommand.ADD_RULE,
            params=params.to_cdp_params(),
            session_id=session_id,
        )
        return AddRuleResult.from_cdp(result)

    async def collect_class_names(
        self,
        *,
        style_sheet_id: dom.StyleSheetId,
        session_id: str | None = None,
    ) -> CollectClassNamesResult:
        """
        Returns all class names from specified stylesheet.
        """
        params = CollectClassNamesParams(style_sheet_id=style_sheet_id)

        result = await self._client.send_raw(
            method=CSSCommand.COLLECT_CLASS_NAMES,
            params=params.to_cdp_params(),
            session_id=session_id,
        )
        return CollectClassNamesResult.from_cdp(result)

    async def create_style_sheet(
        self,
        *,
        frame_id: page.FrameId,
        force: bool | None = None,
        session_id: str | None = None,
    ) -> CreateStyleSheetResult:
        """
        Creates a new special "via-inspector" stylesheet in the frame with given
        `frameId`.
        """
        params = CreateStyleSheetParams(frame_id=frame_id, force=force)

        result = await self._client.send_raw(
            method=CSSCommand.CREATE_STYLE_SHEET,
            params=params.to_cdp_params(),
            session_id=session_id,
        )
        return CreateStyleSheetResult.from_cdp(result)

    async def disable(
        self,
        session_id: str | None = None,
    ) -> dict[str, Any]:
        """
        Disables the CSS agent for the given page.
        """
        result = await self._client.send_raw(
            method=CSSCommand.DISABLE,
            params=None,
            session_id=session_id,
        )
        return result

    async def enable(
        self,
        session_id: str | None = None,
    ) -> dict[str, Any]:
        """
        Enables the CSS agent for the given page. Clients should not assume that the
        CSS agent has been enabled until the result of this command is received.
        """
        result = await self._client.send_raw(
            method=CSSCommand.ENABLE,
            params=None,
            session_id=session_id,
        )
        return result

    async def force_pseudo_state(
        self,
        *,
        node_id: dom.NodeId,
        forced_pseudo_classes: list[str],
        session_id: str | None = None,
    ) -> dict[str, Any]:
        """
        Ensures that the given node will have specified pseudo-classes whenever its
        style is computed by the browser.
        """
        params = ForcePseudoStateParams(
            node_id=node_id, forced_pseudo_classes=forced_pseudo_classes
        )

        result = await self._client.send_raw(
            method=CSSCommand.FORCE_PSEUDO_STATE,
            params=params.to_cdp_params(),
            session_id=session_id,
        )
        return result

    async def force_starting_style(
        self,
        *,
        node_id: dom.NodeId,
        forced: bool,
        session_id: str | None = None,
    ) -> dict[str, Any]:
        """
        Ensures that the given node is in its starting-style state.
        """
        params = ForceStartingStyleParams(node_id=node_id, forced=forced)

        result = await self._client.send_raw(
            method=CSSCommand.FORCE_STARTING_STYLE,
            params=params.to_cdp_params(),
            session_id=session_id,
        )
        return result

    async def get_background_colors(
        self,
        *,
        node_id: dom.NodeId,
        session_id: str | None = None,
    ) -> GetBackgroundColorsResult:
        params = GetBackgroundColorsParams(node_id=node_id)

        result = await self._client.send_raw(
            method=CSSCommand.GET_BACKGROUND_COLORS,
            params=params.to_cdp_params(),
            session_id=session_id,
        )
        return GetBackgroundColorsResult.from_cdp(result)

    async def get_computed_style_for_node(
        self,
        *,
        node_id: dom.NodeId,
        session_id: str | None = None,
    ) -> GetComputedStyleForNodeResult:
        """
        Returns the computed style for a DOM node identified by `nodeId`.
        """
        params = GetComputedStyleForNodeParams(node_id=node_id)

        result = await self._client.send_raw(
            method=CSSCommand.GET_COMPUTED_STYLE_FOR_NODE,
            params=params.to_cdp_params(),
            session_id=session_id,
        )
        return GetComputedStyleForNodeResult.from_cdp(result)

    async def resolve_values(
        self,
        *,
        values: list[str],
        node_id: dom.NodeId,
        property_name: str | None = None,
        pseudo_type: dom.PseudoType | None = None,
        pseudo_identifier: str | None = None,
        session_id: str | None = None,
    ) -> ResolveValuesResult:
        """
        Resolve the specified values in the context of the provided element. For
        example, a value of '1em' is evaluated according to the computed 'font-size' of
        the element and a value 'calc(1px + 2px)' will be resolved to '3px'. If the
        `propertyName` was specified the `values` are resolved as if they were
        property's declaration. If a value cannot be parsed according to the provided
        property syntax, the value is parsed using combined syntax as if null
        `propertyName` was provided. If the value cannot be resolved even then, return
        the provided value without any changes. Note: this function currently does not
        resolve CSS random() function, it returns unmodified random() function parts.`
        """
        params = ResolveValuesParams(
            values=values,
            node_id=node_id,
            property_name=property_name,
            pseudo_type=pseudo_type,
            pseudo_identifier=pseudo_identifier,
        )

        result = await self._client.send_raw(
            method=CSSCommand.RESOLVE_VALUES,
            params=params.to_cdp_params(),
            session_id=session_id,
        )
        return ResolveValuesResult.from_cdp(result)

    async def get_longhand_properties(
        self,
        *,
        shorthand_name: str,
        value: str,
        session_id: str | None = None,
    ) -> GetLonghandPropertiesResult:
        params = GetLonghandPropertiesParams(shorthand_name=shorthand_name, value=value)

        result = await self._client.send_raw(
            method=CSSCommand.GET_LONGHAND_PROPERTIES,
            params=params.to_cdp_params(),
            session_id=session_id,
        )
        return GetLonghandPropertiesResult.from_cdp(result)

    async def get_inline_styles_for_node(
        self,
        *,
        node_id: dom.NodeId,
        session_id: str | None = None,
    ) -> GetInlineStylesForNodeResult:
        """
        Returns the styles defined inline (explicitly in the "style" attribute and
        implicitly, using DOM attributes) for a DOM node identified by `nodeId`.
        """
        params = GetInlineStylesForNodeParams(node_id=node_id)

        result = await self._client.send_raw(
            method=CSSCommand.GET_INLINE_STYLES_FOR_NODE,
            params=params.to_cdp_params(),
            session_id=session_id,
        )
        return GetInlineStylesForNodeResult.from_cdp(result)

    async def get_animated_styles_for_node(
        self,
        *,
        node_id: dom.NodeId,
        session_id: str | None = None,
    ) -> GetAnimatedStylesForNodeResult:
        """
        Returns the styles coming from animations & transitions including the animation
        & transition styles coming from inheritance chain.
        """
        params = GetAnimatedStylesForNodeParams(node_id=node_id)

        result = await self._client.send_raw(
            method=CSSCommand.GET_ANIMATED_STYLES_FOR_NODE,
            params=params.to_cdp_params(),
            session_id=session_id,
        )
        return GetAnimatedStylesForNodeResult.from_cdp(result)

    async def get_matched_styles_for_node(
        self,
        *,
        node_id: dom.NodeId,
        session_id: str | None = None,
    ) -> GetMatchedStylesForNodeResult:
        """
        Returns requested styles for a DOM node identified by `nodeId`.
        """
        params = GetMatchedStylesForNodeParams(node_id=node_id)

        result = await self._client.send_raw(
            method=CSSCommand.GET_MATCHED_STYLES_FOR_NODE,
            params=params.to_cdp_params(),
            session_id=session_id,
        )
        return GetMatchedStylesForNodeResult.from_cdp(result)

    async def get_environment_variables(
        self,
        session_id: str | None = None,
    ) -> GetEnvironmentVariablesResult:
        """
        Returns the values of the default UA-defined environment variables used in
        env()
        """
        result = await self._client.send_raw(
            method=CSSCommand.GET_ENVIRONMENT_VARIABLES,
            params=None,
            session_id=session_id,
        )
        return GetEnvironmentVariablesResult.from_cdp(result)

    async def get_media_queries(
        self,
        session_id: str | None = None,
    ) -> GetMediaQueriesResult:
        """
        Returns all media queries parsed by the rendering engine.
        """
        result = await self._client.send_raw(
            method=CSSCommand.GET_MEDIA_QUERIES,
            params=None,
            session_id=session_id,
        )
        return GetMediaQueriesResult.from_cdp(result)

    async def get_platform_fonts_for_node(
        self,
        *,
        node_id: dom.NodeId,
        session_id: str | None = None,
    ) -> GetPlatformFontsForNodeResult:
        """
        Requests information about platform fonts which we used to render child
        TextNodes in the given node.
        """
        params = GetPlatformFontsForNodeParams(node_id=node_id)

        result = await self._client.send_raw(
            method=CSSCommand.GET_PLATFORM_FONTS_FOR_NODE,
            params=params.to_cdp_params(),
            session_id=session_id,
        )
        return GetPlatformFontsForNodeResult.from_cdp(result)

    async def get_style_sheet_text(
        self,
        *,
        style_sheet_id: dom.StyleSheetId,
        session_id: str | None = None,
    ) -> GetStyleSheetTextResult:
        """
        Returns the current textual content for a stylesheet.
        """
        params = GetStyleSheetTextParams(style_sheet_id=style_sheet_id)

        result = await self._client.send_raw(
            method=CSSCommand.GET_STYLE_SHEET_TEXT,
            params=params.to_cdp_params(),
            session_id=session_id,
        )
        return GetStyleSheetTextResult.from_cdp(result)

    async def get_layers_for_node(
        self,
        *,
        node_id: dom.NodeId,
        session_id: str | None = None,
    ) -> GetLayersForNodeResult:
        """
        Returns all layers parsed by the rendering engine for the tree scope of a node.
        Given a DOM element identified by nodeId, getLayersForNode returns the root
        layer for the nearest ancestor document or shadow root. The layer root contains
        the full layer tree for the tree scope and their ordering.
        """
        params = GetLayersForNodeParams(node_id=node_id)

        result = await self._client.send_raw(
            method=CSSCommand.GET_LAYERS_FOR_NODE,
            params=params.to_cdp_params(),
            session_id=session_id,
        )
        return GetLayersForNodeResult.from_cdp(result)

    async def get_location_for_selector(
        self,
        *,
        style_sheet_id: dom.StyleSheetId,
        selector_text: str,
        session_id: str | None = None,
    ) -> GetLocationForSelectorResult:
        """
        Given a CSS selector text and a style sheet ID, getLocationForSelector returns
        an array of locations of the CSS selector in the style sheet.
        """
        params = GetLocationForSelectorParams(
            style_sheet_id=style_sheet_id, selector_text=selector_text
        )

        result = await self._client.send_raw(
            method=CSSCommand.GET_LOCATION_FOR_SELECTOR,
            params=params.to_cdp_params(),
            session_id=session_id,
        )
        return GetLocationForSelectorResult.from_cdp(result)

    async def track_computed_style_updates_for_node(
        self,
        *,
        node_id: dom.NodeId | None = None,
        session_id: str | None = None,
    ) -> dict[str, Any]:
        """
        Starts tracking the given node for the computed style updates and whenever the
        computed style is updated for node, it queues a `computedStyleUpdated` event
        with throttling. There can only be 1 node tracked for computed style updates so
        passing a new node id removes tracking from the previous node. Pass `undefined`
        to disable tracking.
        """
        params = TrackComputedStyleUpdatesForNodeParams(node_id=node_id)

        result = await self._client.send_raw(
            method=CSSCommand.TRACK_COMPUTED_STYLE_UPDATES_FOR_NODE,
            params=params.to_cdp_params(),
            session_id=session_id,
        )
        return result

    async def track_computed_style_updates(
        self,
        *,
        properties_to_track: list[CSSComputedStyleProperty],
        session_id: str | None = None,
    ) -> dict[str, Any]:
        """
        Starts tracking the given computed styles for updates. The specified array of
        properties replaces the one previously specified. Pass empty array to disable
        tracking. Use takeComputedStyleUpdates to retrieve the list of nodes that had
        properties modified. The changes to computed style properties are only tracked
        for nodes pushed to the front-end by the DOM agent. If no changes to the tracked
        properties occur after the node has been pushed to the front-end, no updates
        will be issued for the node.
        """
        params = TrackComputedStyleUpdatesParams(
            properties_to_track=properties_to_track
        )

        result = await self._client.send_raw(
            method=CSSCommand.TRACK_COMPUTED_STYLE_UPDATES,
            params=params.to_cdp_params(),
            session_id=session_id,
        )
        return result

    async def take_computed_style_updates(
        self,
        session_id: str | None = None,
    ) -> TakeComputedStyleUpdatesResult:
        """
        Polls the next batch of computed style updates.
        """
        result = await self._client.send_raw(
            method=CSSCommand.TAKE_COMPUTED_STYLE_UPDATES,
            params=None,
            session_id=session_id,
        )
        return TakeComputedStyleUpdatesResult.from_cdp(result)

    async def set_effective_property_value_for_node(
        self,
        *,
        node_id: dom.NodeId,
        property_name: str,
        value: str,
        session_id: str | None = None,
    ) -> dict[str, Any]:
        """
        Find a rule with the given active property for the given node and set the new
        value for this property
        """
        params = SetEffectivePropertyValueForNodeParams(
            node_id=node_id, property_name=property_name, value=value
        )

        result = await self._client.send_raw(
            method=CSSCommand.SET_EFFECTIVE_PROPERTY_VALUE_FOR_NODE,
            params=params.to_cdp_params(),
            session_id=session_id,
        )
        return result

    async def set_property_rule_property_name(
        self,
        *,
        style_sheet_id: dom.StyleSheetId,
        range: SourceRange,
        property_name: str,
        session_id: str | None = None,
    ) -> SetPropertyRulePropertyNameResult:
        """
        Modifies the property rule property name.
        """
        params = SetPropertyRulePropertyNameParams(
            style_sheet_id=style_sheet_id, range=range, property_name=property_name
        )

        result = await self._client.send_raw(
            method=CSSCommand.SET_PROPERTY_RULE_PROPERTY_NAME,
            params=params.to_cdp_params(),
            session_id=session_id,
        )
        return SetPropertyRulePropertyNameResult.from_cdp(result)

    async def set_keyframe_key(
        self,
        *,
        style_sheet_id: dom.StyleSheetId,
        range: SourceRange,
        key_text: str,
        session_id: str | None = None,
    ) -> SetKeyframeKeyResult:
        """
        Modifies the keyframe rule key text.
        """
        params = SetKeyframeKeyParams(
            style_sheet_id=style_sheet_id, range=range, key_text=key_text
        )

        result = await self._client.send_raw(
            method=CSSCommand.SET_KEYFRAME_KEY,
            params=params.to_cdp_params(),
            session_id=session_id,
        )
        return SetKeyframeKeyResult.from_cdp(result)

    async def set_media_text(
        self,
        *,
        style_sheet_id: dom.StyleSheetId,
        range: SourceRange,
        text: str,
        session_id: str | None = None,
    ) -> SetMediaTextResult:
        """
        Modifies the rule selector.
        """
        params = SetMediaTextParams(
            style_sheet_id=style_sheet_id, range=range, text=text
        )

        result = await self._client.send_raw(
            method=CSSCommand.SET_MEDIA_TEXT,
            params=params.to_cdp_params(),
            session_id=session_id,
        )
        return SetMediaTextResult.from_cdp(result)

    async def set_container_query_text(
        self,
        *,
        style_sheet_id: dom.StyleSheetId,
        range: SourceRange,
        text: str,
        session_id: str | None = None,
    ) -> SetContainerQueryTextResult:
        """
        Modifies the expression of a container query.
        """
        params = SetContainerQueryTextParams(
            style_sheet_id=style_sheet_id, range=range, text=text
        )

        result = await self._client.send_raw(
            method=CSSCommand.SET_CONTAINER_QUERY_TEXT,
            params=params.to_cdp_params(),
            session_id=session_id,
        )
        return SetContainerQueryTextResult.from_cdp(result)

    async def set_supports_text(
        self,
        *,
        style_sheet_id: dom.StyleSheetId,
        range: SourceRange,
        text: str,
        session_id: str | None = None,
    ) -> SetSupportsTextResult:
        """
        Modifies the expression of a supports at-rule.
        """
        params = SetSupportsTextParams(
            style_sheet_id=style_sheet_id, range=range, text=text
        )

        result = await self._client.send_raw(
            method=CSSCommand.SET_SUPPORTS_TEXT,
            params=params.to_cdp_params(),
            session_id=session_id,
        )
        return SetSupportsTextResult.from_cdp(result)

    async def set_scope_text(
        self,
        *,
        style_sheet_id: dom.StyleSheetId,
        range: SourceRange,
        text: str,
        session_id: str | None = None,
    ) -> SetScopeTextResult:
        """
        Modifies the expression of a scope at-rule.
        """
        params = SetScopeTextParams(
            style_sheet_id=style_sheet_id, range=range, text=text
        )

        result = await self._client.send_raw(
            method=CSSCommand.SET_SCOPE_TEXT,
            params=params.to_cdp_params(),
            session_id=session_id,
        )
        return SetScopeTextResult.from_cdp(result)

    async def set_rule_selector(
        self,
        *,
        style_sheet_id: dom.StyleSheetId,
        range: SourceRange,
        selector: str,
        session_id: str | None = None,
    ) -> SetRuleSelectorResult:
        """
        Modifies the rule selector.
        """
        params = SetRuleSelectorParams(
            style_sheet_id=style_sheet_id, range=range, selector=selector
        )

        result = await self._client.send_raw(
            method=CSSCommand.SET_RULE_SELECTOR,
            params=params.to_cdp_params(),
            session_id=session_id,
        )
        return SetRuleSelectorResult.from_cdp(result)

    async def set_style_sheet_text(
        self,
        *,
        style_sheet_id: dom.StyleSheetId,
        text: str,
        session_id: str | None = None,
    ) -> SetStyleSheetTextResult:
        """
        Sets the new stylesheet text.
        """
        params = SetStyleSheetTextParams(style_sheet_id=style_sheet_id, text=text)

        result = await self._client.send_raw(
            method=CSSCommand.SET_STYLE_SHEET_TEXT,
            params=params.to_cdp_params(),
            session_id=session_id,
        )
        return SetStyleSheetTextResult.from_cdp(result)

    async def set_style_texts(
        self,
        *,
        edits: list[StyleDeclarationEdit],
        node_for_property_syntax_validation: dom.NodeId | None = None,
        session_id: str | None = None,
    ) -> SetStyleTextsResult:
        """
        Applies specified style edits one after another in the given order.
        """
        params = SetStyleTextsParams(
            edits=edits,
            node_for_property_syntax_validation=node_for_property_syntax_validation,
        )

        result = await self._client.send_raw(
            method=CSSCommand.SET_STYLE_TEXTS,
            params=params.to_cdp_params(),
            session_id=session_id,
        )
        return SetStyleTextsResult.from_cdp(result)

    async def start_rule_usage_tracking(
        self,
        session_id: str | None = None,
    ) -> dict[str, Any]:
        """
        Enables the selector recording.
        """
        result = await self._client.send_raw(
            method=CSSCommand.START_RULE_USAGE_TRACKING,
            params=None,
            session_id=session_id,
        )
        return result

    async def stop_rule_usage_tracking(
        self,
        session_id: str | None = None,
    ) -> StopRuleUsageTrackingResult:
        """
        Stop tracking rule usage and return the list of rules that were used since last
        call to `takeCoverageDelta` (or since start of coverage instrumentation).
        """
        result = await self._client.send_raw(
            method=CSSCommand.STOP_RULE_USAGE_TRACKING,
            params=None,
            session_id=session_id,
        )
        return StopRuleUsageTrackingResult.from_cdp(result)

    async def take_coverage_delta(
        self,
        session_id: str | None = None,
    ) -> TakeCoverageDeltaResult:
        """
        Obtain list of rules that became used since last call to this method (or since
        start of coverage instrumentation).
        """
        result = await self._client.send_raw(
            method=CSSCommand.TAKE_COVERAGE_DELTA,
            params=None,
            session_id=session_id,
        )
        return TakeCoverageDeltaResult.from_cdp(result)

    async def set_local_fonts_enabled(
        self,
        *,
        enabled: bool,
        session_id: str | None = None,
    ) -> dict[str, Any]:
        """
        Enables/disables rendering of local CSS fonts (enabled by default).
        """
        params = SetLocalFontsEnabledParams(enabled=enabled)

        result = await self._client.send_raw(
            method=CSSCommand.SET_LOCAL_FONTS_ENABLED,
            params=params.to_cdp_params(),
            session_id=session_id,
        )
        return result
