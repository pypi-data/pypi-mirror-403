# This file is auto-generated by the CDP protocol generator.
# Do not edit this file manually as your changes will be overwritten.
# Generated from Chrome DevTools Protocol specifications.

from dataclasses import dataclass
from enum import StrEnum
from cdpify.shared.models import CDPModel

from .types import (
    AuthenticatorId,
    Credential,
)


class WebAuthnEvent(StrEnum):
    CREDENTIAL_ADDED = "WebAuthn.credentialAdded"
    CREDENTIAL_DELETED = "WebAuthn.credentialDeleted"
    CREDENTIAL_UPDATED = "WebAuthn.credentialUpdated"
    CREDENTIAL_ASSERTED = "WebAuthn.credentialAsserted"


@dataclass(kw_only=True)
class CredentialAddedEvent(CDPModel):
    """
    Triggered when a credential is added to an authenticator.
    """

    authenticator_id: AuthenticatorId
    credential: Credential


@dataclass(kw_only=True)
class CredentialDeletedEvent(CDPModel):
    """
    Triggered when a credential is deleted, e.g. through
    PublicKeyCredential.signalUnknownCredential().
    """

    authenticator_id: AuthenticatorId
    credential_id: str


@dataclass(kw_only=True)
class CredentialUpdatedEvent(CDPModel):
    """
    Triggered when a credential is updated, e.g. through
    PublicKeyCredential.signalCurrentUserDetails().
    """

    authenticator_id: AuthenticatorId
    credential: Credential


@dataclass(kw_only=True)
class CredentialAssertedEvent(CDPModel):
    """
    Triggered when a credential is used in a webauthn assertion.
    """

    authenticator_id: AuthenticatorId
    credential: Credential
