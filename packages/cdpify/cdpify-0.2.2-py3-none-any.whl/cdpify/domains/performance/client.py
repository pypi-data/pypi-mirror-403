# This file is auto-generated by the CDP protocol generator.
# Do not edit this file manually as your changes will be overwritten.
# Generated from Chrome DevTools Protocol specifications.

from __future__ import annotations

from typing import TYPE_CHECKING, Any, Literal

if TYPE_CHECKING:
    from cdpify.client import CDPClient

from cdpify.shared.decorators import deprecated

from .commands import (
    PerformanceCommand,
    EnableParams,
    GetMetricsResult,
    SetTimeDomainParams,
)


class PerformanceClient:
    def __init__(self, client: CDPClient) -> None:
        self._client = client

    async def disable(
        self,
        session_id: str | None = None,
    ) -> dict[str, Any]:
        """
        Disable collecting and reporting metrics.
        """
        result = await self._client.send_raw(
            method=PerformanceCommand.DISABLE,
            params=None,
            session_id=session_id,
        )
        return result

    async def enable(
        self,
        *,
        time_domain: Literal["timeTicks", "threadTicks"] | None = None,
        session_id: str | None = None,
    ) -> dict[str, Any]:
        """
        Enable collecting and reporting metrics.
        """
        params = EnableParams(time_domain=time_domain)

        result = await self._client.send_raw(
            method=PerformanceCommand.ENABLE,
            params=params.to_cdp_params(),
            session_id=session_id,
        )
        return result

    @deprecated()
    async def set_time_domain(
        self,
        *,
        time_domain: Literal["timeTicks", "threadTicks"],
        session_id: str | None = None,
    ) -> dict[str, Any]:
        """
        Sets time domain to use for collecting and reporting duration metrics. Note
        that this must be called before enabling metrics collection. Calling this method
        while metrics collection is enabled returns an error.
        """
        params = SetTimeDomainParams(time_domain=time_domain)

        result = await self._client.send_raw(
            method=PerformanceCommand.SET_TIME_DOMAIN,
            params=params.to_cdp_params(),
            session_id=session_id,
        )
        return result

    async def get_metrics(
        self,
        session_id: str | None = None,
    ) -> GetMetricsResult:
        """
        Retrieve current values of run-time metrics.
        """
        result = await self._client.send_raw(
            method=PerformanceCommand.GET_METRICS,
            params=None,
            session_id=session_id,
        )
        return GetMetricsResult.from_cdp(result)
