# This file is auto-generated by the CDP protocol generator.
# Do not edit this file manually as your changes will be overwritten.
# Generated from Chrome DevTools Protocol specifications.

from dataclasses import dataclass
from enum import StrEnum
from cdpify.shared.models import CDPModel

from .types import (
    InsecureContentStatus,
    SecurityState,
    SecurityStateExplanation,
    VisibleSecurityState,
)


class SecurityEvent(StrEnum):
    CERTIFICATE_ERROR = "Security.certificateError"
    VISIBLE_SECURITY_STATE_CHANGED = "Security.visibleSecurityStateChanged"
    SECURITY_STATE_CHANGED = "Security.securityStateChanged"


@dataclass(kw_only=True)
class CertificateErrorEvent(CDPModel):
    """
    There is a certificate error. If overriding certificate errors is enabled, then it
    should be handled with the `handleCertificateError` command. Note: this event does
    not fire if the certificate error has been allowed internally. Only one client per
    target should override certificate errors at the same time.
    """

    event_id: int
    error_type: str
    request_url: str


@dataclass(kw_only=True)
class VisibleSecurityStateChangedEvent(CDPModel):
    """
    The security state of the page changed.
    """

    visible_security_state: VisibleSecurityState


@dataclass(kw_only=True)
class SecurityStateChangedEvent(CDPModel):
    """
    The security state of the page changed. No longer being sent.
    """

    security_state: SecurityState
    scheme_is_cryptographic: bool
    explanations: list[SecurityStateExplanation]
    insecure_content_status: InsecureContentStatus
    summary: str | None | None = None
