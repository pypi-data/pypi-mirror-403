"use strict";(self.webpackChunklino_react=self.webpackChunklino_react||[]).push([[6301],{723:function(t,e,n){var l,a=this&&this.__createBinding||(Object.create?function(t,e,n,l){void 0===l&&(l=n);var a=Object.getOwnPropertyDescriptor(e,n);a&&!("get"in a?!e.__esModule:a.writable||a.configurable)||(a={enumerable:!0,get:function(){return e[n]}}),Object.defineProperty(t,l,a)}:function(t,e,n,l){void 0===l&&(l=n),t[l]=e[n]}),o=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),r=this&&this.__importStar||(l=function(t){return l=Object.getOwnPropertyNames||function(t){var e=[];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[e.length]=n);return e},l(t)},function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n=l(t),r=0;r<n.length;r++)"default"!==n[r]&&a(e,t,n[r]);return o(e,t),e}),i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.quillMention=e.imageHandler=e.overrideImageButtonHandler=e.changeDelta=e.getQuillModules=e.tableContextMenuProps=e.TextBoxTable=e.TextBoxTableRow=e.TextBoxTableCell=e.TableModule=e.TableContainer=e.TableRow=e.TableCell=e.Delta=e.Quill=e.name=void 0,e.textboxId=w,e.QuillEditor=W,e.name="quillmodules";const s=i(n(6540)),d=i(n(5556)),c=r(n(5743));e.Quill=c.default,Object.defineProperty(e,"Delta",{enumerable:!0,get:function(){return c.Delta}});const u=i(n(3503)),m=n(7421),h=i(n(4744)),b=i(n(1244)),f=i(n(7514)),g=i(n(537)),p=i(n(194)),x=i(n(3117)),A=n(5548),v=n(6606);n(5065),n(1882);const y=r(n(8524));function w(){return`textbox-${Math.random().toString(36).slice(2,6)}`}class q extends f.default{static create(t){y.debugMessage("TextBoxBlock.create",t);const e=super.create(t);return t?e.setAttribute("data-textbox-id",t):e.setAttribute("data-textbox-id",w()),e}static formats(t){if(t.hasAttribute("data-textbox-id"))return t.getAttribute("data-textbox-id")||void 0}getTextBoxId(){return this.domNode.getAttribute("data-textbox-id")||void 0}format(t,e){t===q.blotName&&e?this.domNode.setAttribute("data-textbox-id",String(e)):super.format(t,e)}formats(){return{[this.statics.blotName]:q.formats(this.domNode)}}textbox(){return this.parent&&"textbox"===this.parent.statics.blotName?this.parent:null}optimize(t){if(super.optimize(t),this.parent&&"textbox"!==this.parent.statics.blotName){const t="50%",e="",n=this.scroll.create("textbox",{width:t,align:e});n.appendChild(this),this.replaceWith(n)}}}q.blotName="textbox-block",q.tagName="P",q.className="ql-textbox-block";class C extends b.default{get textboxId(){return this.children.head&&this.children.head.getTextBoxId()||""}static create(t){y.debugMessage("TextBoxBlot.create",t);const e=super.create(),n="string"==typeof t?{}:t||{};return n.width?(e.style.width=n.width,e.setAttribute("data-width",n.width)):(e.style.width="50%",e.setAttribute("data-width","50%")),n.align&&(e.setAttribute("data-align",n.align),e.classList.add(`ql-textbox-align-${n.align}`)),e}static formats(t){return{width:t.getAttribute("data-width")||t.style.width,align:t.getAttribute("data-align")||void 0}}constructor(t,e){super(t,e)}format(t,e){if("textbox"!==t)throw new Error(`${this.statics.name}.format: Unsupported format name '${t}'`);if("object"==typeof e&&null!==e){const t=e,n=this.domNode;t.width&&(n.style.width=t.width,n.setAttribute("data-width",t.width)),void 0!==t.align&&(n.classList.remove("ql-textbox-align-left","ql-textbox-align-center","ql-textbox-align-right"),t.align?(n.setAttribute("data-align",t.align),n.classList.add(`ql-textbox-align-${t.align}`)):n.removeAttribute("data-align"))}}formats(){return{[this.statics.blotName]:C.formats(this.domNode)}}optimize(t,e){if(super.optimize(t),0===this.children.length){const t=this.scroll.create(q.blotName,this.textboxId);this.appendChild(t)}this.children.head&&(this.children.forEach(t=>{var e;if(!(null===(e=C.allowedChildren)||void 0===e?void 0:e.some(e=>t instanceof e))){const e=this.scroll.create(q.blotName,this.textboxId);t.replaceWith(e),e.appendChild(t)}}),this.children.forEach(t=>{if(null==t.next)return;if(t.getTextBoxId()!==t.next.getTextBoxId()){const e=this.splitAfter(t);e&&e.optimize({})}}))}checkMerge(){if(super.checkMerge()&&this.next instanceof C){const t=this.next.children.head.getTextBoxId();return this.textboxId===t}return!1}}C.blotName="textbox",C.tagName="DIV",C.className="ql-textbox",C.defaultChild=q,C.allowedChildren=[q],q.requiredContainer=C;const B=c.default.import("modules/table"),E=c.default.import("formats/table"),N=c.default.import("formats/table-row"),I=c.default.import("formats/table-container"),T=c.default.import("formats/table-body");class k extends E{static create(t){let e;return"string"==typeof t||null==t?e=super.create(t):(e=super.create(t.row),t.class&&e.setAttribute("class",t.class)),e}static formats(t,e){const n={};if(n.row=super.formats(t,e),t.hasAttribute("class")){const e=t.getAttribute("class");e&&e.length&&(n.class=e)}return n}formats(){return{[this.statics.blotName]:k.formats(this.domNode,this.scroll)}}format(t,e){if(t===this.statics.blotName){if("string"==typeof e)throw new Error(`${this.statics.name}.format: string value is not supported, use an object { row?: string, class?: string }`);"object"==typeof e&&null!=e&&(e.row&&super.format(t,e.row),e.class&&e.class.length?this.domNode.setAttribute("class",e.class):this.domNode.hasAttribute("class")&&this.domNode.removeAttribute("class"))}else super.format(t,e)}}e.TableCell=k;class R extends N{static create(t){const e=super.create();return t&&t.length&&e.setAttribute("class",t),e}static formats(t){if(t.hasAttribute("class"))return t.getAttribute("class")}formats(){return{[this.statics.blotName]:R.formats(this.domNode)}}format(t,e){if(t!==this.statics.blotName)throw new Error(`${this.statics.name}.format: Unsupported format name '${t}'`);e&&e.length?this.domNode.setAttribute("class",e):this.domNode.removeAttribute("class")}checkMerge(){if(b.default.prototype.checkMerge.call(this)&&null!=this.next.children.head){const t=this.children.head.statics.blotName,e=this.children.head.formats(),n=this.children.tail.formats(),l=this.next.children.head.formats(),a=this.next.children.tail.formats();return e[t].row===n[t].row&&e[t].row===l[t].row&&e[t].row===a[t].row}return!1}optimize(...t){b.default.prototype.optimize.call(this,...t);const e=this instanceof P?_:k;this.children.forEach(t=>{var n,l;if(null==t.next)return;const a=t.formats(),o=t.next.formats();if((null===(n=a[e.blotName])||void 0===n?void 0:n.row)!==(null===(l=o[e.blotName])||void 0===l?void 0:l.row)){const e=this.splitAfter(t);e&&e.optimize(),this.prev&&this.prev.optimize()}})}}e.TableRow=R;class L extends I{static create(t){const e=super.create(t);return t&&t.length&&e.setAttribute("class",t),e}static formats(t){if(t.hasAttribute("class"))return t.getAttribute("class")}formats(){return{[this.statics.blotName]:L.formats(this.domNode)}}format(t,e){if(t!==this.statics.blotName)throw new Error(`${this.statics.name}.format: Unsupported format name '${t}'`);e&&e.length?this.domNode.setAttribute("class",e):this.domNode.removeAttribute("class")}balanceCells(){const t=this.descendants(R),e=t.reduce((t,e)=>Math.max(e.children.length,t),0),n=t[0]instanceof P?_:k;t.forEach(t=>{new Array(e-t.children.length).fill(0).forEach(()=>{let e=null;null!=t.children.head&&(e=n.formats(t.children.head.domNode,this.scroll));const l=this.scroll.create(n.blotName,e);t.appendChild(l),l.optimize()})})}insertColumn(t){const[e]=this.descendant(T);if(null==e||null==e.children.head)return;const n=e instanceof S?_:k;e.children.forEach(e=>{const l=e.children.at(t),a=n.formats(e.children.head.domNode,this.scroll),o=this.scroll.create(n.blotName,a);e.insertBefore(o,l)})}insertRow(t){const[e]=this.descendant(T);if(null==e||null==e.children.head)return;const n=e instanceof S,l=(0,m.tableId)(),a=e.children.head,o=a&&a.domNode?a.domNode.getAttribute("class"):void 0;let r;o&&o.length&&(r=o);const i=this.scroll.create(n?P.blotName:R.blotName,r);e.children.head.children.forEach(()=>{const t=a.children.head,e=Object.values(t.formats())[0];e.row=l;const o=this.scroll.create(n?_.blotName:k.blotName,e);i.appendChild(o)});const s=e.children.at(t);e.insertBefore(i,s)}}e.TableContainer=L;class M extends B{getTable(t=this.quill.getSelection()){if(null==t)return[null,null,null,-1];const[e,n]=this.quill.getLine(t.index);if(null==e||e.statics.blotName!==k.blotName&&e.statics.blotName!==_.blotName)return[null,null,null,-1];const l=e.parent;return[l.parent.parent,l,e,n]}insertTable(t,e){const n=this.quill.getSelection();if(null==n)return;let[l]=this.quill.getLine(n.index),a="table";const o={};for(;null!=l;){if(l instanceof C){a="textbox-table-cell",o.textbox_id=l.textboxId;break}l=l.parent}const r=new Array(t).fill(0).reduce(t=>{const n=new Array(e).fill("\n").join("");return t.insert(n,{[a]:Object.assign({},o,{row:(0,m.tableId)()})})},(new c.Delta).retain(n.index));this.quill.updateContents(r,c.default.sources.USER),this.quill.setSelection(n.index,c.default.sources.SILENT),this.balanceTables()}}e.TableModule=M;class _ extends k{static create(t){if("object"==typeof t&&null!=t){let e=null,n=null,l=null;t.class&&(e=t.class),t.row&&(n=t.row),t.textbox_id&&(l=t.textbox_id);const a=super.create({row:n||"",class:e||""});return l&&a.setAttribute("data-textbox-id",l),a}return super.create(t)}static formats(t,e){const n={},l=super.formats(t,e);if(n.row=l.row,l.class&&(n.class=l.class),t.hasAttribute("data-textbox-id")){const e=t.getAttribute("data-textbox-id");e&&e.length&&(n.textbox_id=e)}return n}formats(){return{[this.statics.blotName]:_.formats(this.domNode,this.scroll)}}format(t,e){if(t===this.statics.blotName){if("string"==typeof e)throw new Error(`${this.statics.name}.format: string value is not supported, use an object { row?: string; class?: string; textbox_id?: string }`);"object"==typeof e&&null!=e&&(e.row&&this.domNode.setAttribute("data-row",e.row),e.class&&e.class.length?this.domNode.setAttribute("class",e.class):this.domNode.hasAttribute("class")&&this.domNode.removeAttribute("class"),e.textbox_id&&e.textbox_id.length?this.domNode.setAttribute("data-textbox-id",e.textbox_id):this.domNode.hasAttribute("data-textbox-id")&&this.domNode.removeAttribute("data-textbox-id"))}else super.format(t,e)}}e.TextBoxTableCell=_,_.blotName="textbox-table-cell",_.className="ql-textbox-table-cell";class P extends R{}e.TextBoxTableRow=P,P.blotName="textbox-table-row",P.className="ql-textbox-table-row";class S extends T{}S.blotName="textbox-table-body",S.className="ql-textbox-table-body";class H extends L{getTextBoxId(){const[t]=this.descendant(_);return t&&t.domNode.hasAttribute("data-textbox-id")?t.domNode.getAttribute("data-textbox-id"):null}}e.TextBoxTable=H,H.blotName="textbox-table",H.className="ql-textbox-table",H.requiredContainer=C,_.requiredContainer=P,P.allowedChildren=[_],P.requiredContainer=S,S.allowedChildren=[P],S.requiredContainer=H,H.allowedChildren=[S],C.allowedChildren=[q,H],c.default.register("formats/textbox-table",H),c.default.register("formats/textbox-table-body",S),c.default.register("formats/textbox-table-row",P),c.default.register("formats/textbox-table-cell",_),c.default.register("modules/imageDropAndPaste",g.default),c.default.register("modules/blotFormatter2",p.default),c.default.register({"blots/mention":A.MentionBlot,"modules/mention":A.Mention}),c.default.register("modules/htmlEditButton",x.default),c.default.register("formats/textbox",C),c.default.register("formats/textbox-block",q),c.default.register("modules/textboxFormatter",class{constructor(t,e={}){this.quill=t,this.options=(0,h.default)({debug:!1,overlay:{className:"ql-textbox-overlay",style:{}},resize:{handleClassName:"ql-textbox-handle",handleStyle:{width:"12px",height:"12px",backgroundColor:"#4285f4",border:"1px solid white"}},align:{alignments:["left","center","right"],icons:{left:"â¬…",center:"â†”",right:"âž¡"}},toolbar:{mainClassName:"ql-textbox-toolbar",buttonClassName:"ql-textbox-toolbar-button"}},e,{arrayMerge:(t,e)=>e}),this.overlay=this.createOverlay(),this.toolbar=this.createToolbar(),this.currentTarget=null,this.resizeHandles=this.createResizeHandles(),this.alignButtons={},this.isDragging=!1,this.dragHandle=null,this.dragStartX=0,this.dragStartWidth=0,this.attachEventListeners(),this.log("TextBoxFormatter initialized")}log(...t){this.options.debug&&console.debug("[TextBoxFormatter]",...t)}createOverlay(){const t=document.createElement("div");return t.className=this.options.overlay.className,t.style.cssText="\n            position: absolute;\n            display: none;\n            border: 2px dashed #4285f4;\n            pointer-events: none;\n            z-index: 100;\n        ",Object.assign(t.style,this.options.overlay.style||{}),this.quill.root.parentNode.appendChild(t),t}createToolbar(){const t=document.createElement("div");return t.className=this.options.toolbar.mainClassName,t.style.cssText="\n            position: absolute;\n            display: none;\n            background: white;\n            border: 1px solid #ccc;\n            border-radius: 4px;\n            padding: 4px;\n            z-index: 101;\n            box-shadow: 0 2px 8px rgba(0,0,0,0.15);\n        ",this.quill.root.parentNode.appendChild(t),t}createResizeHandles(){const t={};return[{name:"topLeft",cursor:"nwse-resize",pos:{top:"-6px",left:"-6px"}},{name:"topRight",cursor:"nesw-resize",pos:{top:"-6px",right:"-6px"}},{name:"bottomLeft",cursor:"nesw-resize",pos:{bottom:"-6px",left:"-6px"}},{name:"bottomRight",cursor:"nwse-resize",pos:{bottom:"-6px",right:"-6px"}}].forEach(({name:e,cursor:n,pos:l})=>{const a=document.createElement("div");a.className=this.options.resize.handleClassName,a.setAttribute("data-position",e),a.style.cssText=`\n                position: absolute;\n                cursor: ${n};\n                pointer-events: auto;\n                border-radius: 50%;\n            `,Object.assign(a.style,l),Object.assign(a.style,this.options.resize.handleStyle||{}),this.overlay.appendChild(a),t[e]=a}),t}createAlignButtons(){this.toolbar.innerHTML="",this.alignButtons={},this.options.align.alignments.forEach(t=>{const e=document.createElement("button");e.className=this.options.toolbar.buttonClassName,e.setAttribute("data-action",t),e.innerHTML=this.options.align.icons[t]||t[0].toUpperCase(),e.style.cssText="\n                padding: 6px 10px;\n                margin: 0 2px;\n                border: 1px solid #ddd;\n                background: white;\n                cursor: pointer;\n                border-radius: 3px;\n            ",e.addEventListener("click",e=>{e.preventDefault(),e.stopPropagation(),this.applyAlignment(t)}),this.toolbar.appendChild(e),this.alignButtons[t]=e})}attachEventListeners(){this.quill.root.addEventListener("click",t=>{const e=t.target.closest(".ql-textbox");e&&e instanceof HTMLElement?(t.preventDefault(),this.show(e)):this.hide()}),Object.values(this.resizeHandles).forEach(t=>{t.addEventListener("mousedown",e=>{e.preventDefault(),e.stopPropagation(),this.startResize(e,t)})}),document.addEventListener("mousedown",t=>{!this.currentTarget||this.overlay.contains(t.target)||this.toolbar.contains(t.target)||t.target.closest(".ql-textbox")||this.hide()}),this.quill.root.addEventListener("scroll",()=>{this.currentTarget&&this.repositionOverlay()}),this.quill.on("text-change",()=>{this.currentTarget&&requestAnimationFrame(()=>{this.repositionOverlay()})})}show(t){this.currentTarget=t,this.createAlignButtons(),this.updateAlignButtons(),this.repositionOverlay(),this.overlay.style.display="block",this.toolbar.style.display="block",this.log("Showing overlay for",t)}hide(){this.isDragging||(this.currentTarget=null,this.overlay.style.display="none",this.toolbar.style.display="none",this.log("Hiding overlay"))}repositionOverlay(){if(!this.currentTarget)return;const t=this.currentTarget.getBoundingClientRect(),e=this.quill.root.getBoundingClientRect();this.overlay.style.left=`${t.left-e.left+this.quill.root.scrollLeft}px`,this.overlay.style.top=`${t.top-e.top+this.quill.root.scrollTop}px`,this.overlay.style.width=`${t.width}px`,this.overlay.style.height=`${t.height}px`,this.toolbar.style.left=`${t.left-e.left+this.quill.root.scrollLeft}px`,this.toolbar.style.top=t.top-e.top+this.quill.root.scrollTop-40+"px"}startResize(t,e){if(!this.currentTarget)return;this.isDragging=!0,this.dragHandle=e,this.dragStartX=t.clientX,this.dragStartWidth=this.currentTarget.offsetWidth;const n=t=>{var e;if(!this.isDragging||!this.currentTarget)return;const n=t.clientX-this.dragStartX,l=this.dragHandle.getAttribute("data-position");let a=this.dragStartWidth;l.includes("Right")?a=this.dragStartWidth+n:l.includes("Left")&&(a=this.dragStartWidth-n);const o=this.quill.root.offsetWidth;a=Math.max(100,Math.min(a,o));const r=(null===(e=this.currentTarget.getAttribute("data-width"))||void 0===e?void 0:e.includes("%"))?`${(a/o*100).toFixed(2)}%`:`${a}px`;this.currentTarget.style.width=r,this.currentTarget.setAttribute("data-width",r),this.repositionOverlay(),this.log("Resizing to",r)},l=()=>{this.isDragging=!1,this.dragHandle=null,document.removeEventListener("mousemove",n),document.removeEventListener("mouseup",l),this.updateBlotFormat(),this.log("Resize complete")};document.addEventListener("mousemove",n),document.addEventListener("mouseup",l)}updateAlignButtons(){if(!this.currentTarget)return;const t=this.currentTarget.getAttribute("data-align")||"";Object.entries(this.alignButtons).forEach(([e,n])=>{e===t?(n.style.background="#e3f2fd",n.style.borderColor="#4285f4"):(n.style.background="white",n.style.borderColor="#ddd")})}applyAlignment(t){if(!this.currentTarget)return;this.currentTarget.classList.remove("ql-textbox-align-left","ql-textbox-align-center","ql-textbox-align-right");this.currentTarget.getAttribute("data-align")===t?this.currentTarget.removeAttribute("data-align"):(this.currentTarget.setAttribute("data-align",t),this.currentTarget.classList.add(`ql-textbox-align-${t}`)),this.updateAlignButtons(),this.updateBlotFormat(),requestAnimationFrame(()=>{this.repositionOverlay()}),this.log("Applied alignment",t)}updateBlotFormat(){if(!this.currentTarget)return;const t=c.default.find(this.currentTarget);if(t&&"textbox"===t.statics.blotName){const e=this.quill.getIndex(t),n=C.formats(this.currentTarget);this.quill.formatText(e,1,"textbox",n,"user"),this.log("Updated blot format",n)}}}),c.default.register("modules/table",M),c.default.register("formats/table-row",R),c.default.register("formats/table",k),c.default.register("formats/table-container",L);const D=g.default.ImageData;let z;const j=z={AbortController:Promise.resolve().then(()=>r(n(5568))),prContextMenu:Promise.resolve().then(()=>r(n(3181))),prUtils:Promise.resolve().then(()=>r(n(4881))),queryString:Promise.resolve().then(()=>r(n(8091))),i18n:Promise.resolve().then(()=>r(n(5721))),u:Promise.resolve().then(()=>r(n(7540)))};(0,v.RegisterImportPool)(z);e.tableContextMenuProps=({i18n:t,quillRef:e,c:n})=>{const l=()=>(e.current.focus(),e.current.getModule("table"));return{model:[{command:()=>{l().insertColumnLeft()},icon:s.default.createElement("span",null,"Â â­°Â "),label:t.t("Insert column left")},{command:()=>{l().insertColumnRight()},icon:s.default.createElement("span",null,"Â â­²Â "),label:t.t("Insert column right")},{command:()=>{l().insertRowAbove()},icon:s.default.createElement("span",null,"Â â­±Â "),label:t.t("Insert row above")},{command:()=>{l().insertRowBelow()},icon:s.default.createElement("span",null,"Â â­³Â "),label:t.t("Insert row below")},{command:()=>{l().deleteColumn()},icon:"pi pi-delete-left",label:t.t("Delete column")},{command:()=>{l().deleteRow()},icon:"pi pi-eraser",label:t.t("Delete row")},{command:()=>{l().deleteTable()},icon:"pi pi-trash",label:t.t("Delete table")},{command:()=>{const a=e.current,[o,r,i]=l().getTable(),s=n,d=t.t("TABLE class"),c=t.t("TR class"),u=t.t("TD class"),m=t.t("Apply to all rows"),h=t.t("Apply to all cells"),b=t.t("Apply to all cells of this row"),f=t.t("Manage classes"),g=t.t("Apply");s.APP.dialogFactory.createParamDialog(s,{[d]:{default:o.domNode.getAttribute("class")||"",react_name:"CharFieldElement"},[c]:{default:r.domNode.getAttribute("class")||"",react_name:"CharFieldElement"},[m]:{default:!1,react_name:"BooleanFieldElement"},[u]:{default:i.domNode.getAttribute("class")||"",react_name:"CharFieldElement"},[b]:{default:!1,react_name:"BooleanFieldElement"},[h]:{default:!1,react_name:"BooleanFieldElement"}},f,t=>{const e=t[d].split(",").filter(t=>!!t).join(" ").trim();a.formatLine(a.getIndex(o),1,o.statics.blotName,e);const n=(t,e)=>{a.formatLine(a.getIndex(e),1,e.statics.blotName,t)},l=t[c].split(",").filter(t=>!!t).join(" ").trim();let s;if(n(l,r),t[m]){for(s=r.prev;null!==s;)n(l,s),s=s.prev;for(s=r.next;null!==s;)n(l,s),s=s.next}const f=t[h];let g;const p=t[u].split(",").filter(t=>!!t).join(" ").trim(),x=(t,e)=>{const n=e.statics.blotName,l=e.formats()[n];a.formatLine(a.getIndex(e),1,n,Object.assign({},l,{class:t}))};if(x(p,i),f||t[b]){for(g=i.prev;null!==g;)x(p,g),g=g.prev;for(g=i.next;null!==g;)x(p,g),g=g.next}if(f){for(s=r.prev;null!==s;){if(g=s.children.head,null!==g.prev)throw new Error("Programming error, row.children.head returned cell with prev item");for(;null!==g;)x(p,g),g=g.next;s=s.prev}for(s=r.next;null!==s;){if(g=s.children.head,null!==g.prev)throw new Error("Programming error, row.children.head returned cell with prev item");for(;null!==g;)x(p,g),g=g.next;s=s.next}}return a.emitter.emit("text-change"),!0},g)},icon:s.default.createElement("span",null,"Â ðŸ„¿Â "),label:t.t("Properties")}]}};const O=({plain:t,quillRef:e,elementRef:n})=>t?null:t=>{const l=e.current.getModule("table"),[a]=l.getTable();null!==a&&(t.preventDefault(),n.current.show(t))};e.getQuillModules=({signal:t,i18n:n,props:l,quillRef:a})=>{const{c:o}=l,r=`l-ql-toolbar-${l.parent.props.elem.name}`,i={toolbar:`#${r}`,mention:(0,e.quillMention)({silentFetch:o.actionHandler.silentFetch,signal:t,mentionValues:o.mentionValues}),blotFormatter2:{debug:!1,resize:{useRelativeSize:!0},video:{registerBackspaceFix:!1}},textboxFormatter:{debug:!1,resize:{handleStyle:{width:"12px",height:"12px",backgroundColor:"#4285f4",border:"2px solid white"}},align:{alignments:["left","center","right"],icons:{left:"â¬…",center:"â†”",right:"âž¡"}}},table:!0};l.showHeader&&(i.htmlEditButton={msg:n.t('Edit HTML here, when you click "OK" the quill editor\'s contents will be replaced'),prependSelector:"div#raw-editor-container",okText:n.t("Ok"),cancelText:n.t("Cancel"),buttonTitle:n.t("Show HTML source")}),l.c.APP.state.site_data.installed_plugins.includes("uploads")&&(i.imageDropAndPaste={handler:(0,e.imageHandler)(a)}),i.keyboard={bindings:{home:{key:"Home",shiftKey:null,handler:function(t,e){const n=a.current,[l]=n.getLine(t.index);if(l&&"LI"===l.domNode.tagName){if(e.event.shiftKey){const e=l.offset(n.scroll);n.setSelection(e,t.index-e,c.default.sources.USER)}else n.setSelection(l.offset(n.scroll),0,c.default.sources.USER);return!1}return!0}}}},l.plain&&(i.keyboard.bindings["list autofill"]=!1),l.showHeader||delete i.toolbar;return{modules:i,meta:{toolbarID:r}}};e.changeDelta=({quillRef:t,parent:e,prUtils:n,plain:l})=>(a,o,r)=>{const i=t.current,s=i.container.children[0];let d=s?s.innerHTML:null;const u=i.getText();if("<p><br></p>"===d&&(d=null),r===c.default.sources.API){const m=i.container.children[0],h=document.createElement("div");if(h.innerHTML=e.getValue()||"",n.DomHandler.isEqualElement(m,h))return}if(d){const b=document.createElement("div");function f(t){if(t.nodeType===Node.ELEMENT_NODE){const e=Array.from(t.attributes);e.sort((t,e)=>t.name.localeCompare(e.name));for(let n=0;n<e.length;n++)t.removeAttribute(e[n].name);for(let n=0;n<e.length;n++)t.setAttribute(e[n].name,e[n].value)}for(let e=0;e<t.childNodes.length;e++)f(t.childNodes[e])}b.innerHTML=d,f(b),d=b.innerHTML}((t,e,n)=>{const l=n.textValue.slice(0,-1),a=(e?l:n.htmlValue)||"";t.update({[t.dataKey]:a})})(e,l,{htmlValue:d,textValue:u,delta:a,source:r})};e.overrideImageButtonHandler=t=>{t.current.getModule("toolbar").addHandler("image",n=>{if(n){const n=document.createElement("input");n.setAttribute("type","file"),n.setAttribute("accept","image/png, image/gif, image/jpeg, image/bmp, image/x-icon"),n.classList.add("ql-image"),n.addEventListener("change",l=>{const a=l.target.files;let o;if(a.length>0){o=a[0];const l=o.type,r=new FileReader;r.onload=a=>{const r=a.target.result;(0,e.imageHandler)(t)(r,l,new D(r,l,o.name)),n.value=""},r.readAsDataURL(o)}}),n.click()}})};e.imageHandler=t=>(e,n,l)=>{const a=t.current;let o=(a.getSelection()||{}).index;(void 0===o||o<0)&&(o=a.getLength()),a.insertEmbed(o,"image",e);const r=a.getLeaf(o)[0];r.domNode.setAttribute("width","100%"),r.domNode.setAttribute("height","auto")};e.quillMention=({silentFetch:t,signal:e,mentionValues:n})=>({allowedChars:/^[A-Za-z0-9\s]*$/,mentionDenotationChars:window.App.state.site_data.suggestors,source:function(l,a,o){if(0===l.length){const t=n[o];a(t,l)}else z.resolve(["queryString"]).then(({queryString:n})=>{t({path:`suggestions?${n.default.stringify({query:l,trigger:o})}`,signal:e}).then(t=>a(t.suggestions,l))})},listItemClass:"ql-mention-list-item",mentionContainerClass:"ql-mention-list-container",mentionListClass:"ql-mention-list",dataAttributes:["value","link","title","denotationChar"]});const F=s.default.createElement(s.default.Fragment,null,s.default.createElement("span",{className:"ql-formats"},s.default.createElement("select",{className:"ql-header",defaultValue:"0"},s.default.createElement("option",{value:"1"},"Header 1"),s.default.createElement("option",{value:"2"},"Header 2"),s.default.createElement("option",{value:"3"},"Header 3"),s.default.createElement("option",{value:"4"},"Header 4"),s.default.createElement("option",{value:"0"},"Normal")),s.default.createElement("select",{className:"ql-font"},s.default.createElement("option",{defaultValue:"true"}),s.default.createElement("option",{value:"serif"}),s.default.createElement("option",{value:"monospace"}))),s.default.createElement("span",{className:"ql-formats"},s.default.createElement("select",{className:"ql-size"},s.default.createElement("option",{value:"small"}),s.default.createElement("option",{defaultValue:"true"}),s.default.createElement("option",{value:"large"}),s.default.createElement("option",{value:"huge"}))),s.default.createElement("span",{className:"ql-formats"},s.default.createElement("button",{className:"ql-script",value:"sub"}),s.default.createElement("button",{className:"ql-script",value:"super"})),s.default.createElement("span",{className:"ql-formats"},s.default.createElement("button",{type:"button",className:"ql-bold","aria-label":"Bold"}),s.default.createElement("button",{type:"button",className:"ql-italic","aria-label":"Italic"}),s.default.createElement("button",{type:"button",className:"ql-underline","aria-label":"Underline"})),s.default.createElement("span",{className:"ql-formats"},s.default.createElement("select",{className:"ql-color"}),s.default.createElement("select",{className:"ql-background"})),s.default.createElement("span",{className:"ql-formats"},s.default.createElement("button",{type:"button",className:"ql-list",value:"ordered","aria-label":"Ordered List"}),s.default.createElement("button",{type:"button",className:"ql-list",value:"bullet","aria-label":"Unordered List"}),s.default.createElement("select",{className:"ql-align"},s.default.createElement("option",{defaultValue:"true"}),s.default.createElement("option",{value:"center"}),s.default.createElement("option",{value:"right"}),s.default.createElement("option",{value:"justify"}))),s.default.createElement("span",{className:"ql-formats"},s.default.createElement("button",{type:"button",className:"ql-link","aria-label":"Insert Link"}),s.default.createElement("button",{type:"button",className:"ql-image","aria-label":"Insert Image"}),s.default.createElement("button",{type:"button",className:"ql-code-block","aria-label":"Insert Code Block"})),s.default.createElement("span",{className:"ql-formats"},s.default.createElement("button",{type:"button",className:"ql-clean","aria-label":"Remove Styles"}))),$=({quill:t,c:e})=>{const{APP:n}=e,{URLContext:l}=n;let a=(t.getSelection()||{}).index;(void 0===a||a<0)&&(a=t.getLength()),l.actionHandler.runAction({action_full_name:l.actionHandler.findUniqueAction("insert_reference").full_name,actorId:"about.About",response_callback:e=>{e.success&&t.insertText(a,e.message)}})},U=({quillRef:t,c:e})=>e.APP.state.site_data.installed_plugins.includes("memo")?s.default.createElement("span",{className:"ql-formats"},s.default.createElement("button",{type:"button",onClick:()=>$({quill:t.current,c:e}),"aria-label":"Open link dialog"},s.default.createElement("i",{className:"pi pi-link"}))):null,V=({quillRef:t,c:e,i18n:n,u:l})=>s.default.createElement(s.default.Fragment,null,F,U({quillRef:t,c:e}),s.default.createElement("span",{className:"ql-formats"},s.default.createElement("button",{type:"button",onClick:()=>{const a=e,o=n.t("rows x columns"),r=n.t("Rows"),i=n.t("Columns");a.APP.dialogFactory.createParamDialog(a,{[r]:{react_name:"IntegerFieldElement",default:3},[i]:{react_name:"IntegerFieldElement",default:3}},o,e=>{const o=parseInt(e[r]),s=parseInt(e[i]),d=l.isNaN(o);if(d||l.isNaN(s))return a.APP.toast.show({severity:"warn",summary:n.t("Not a number '{{dir}}'",{dir:d?n.t("rows"):n.t("columns")})}),!1;const c=t.current.getModule("table");return t.current.focus(),c.insertTable(o,s),!0})}},s.default.createElement("i",{className:"pi pi-table"}))),s.default.createElement("span",{className:"ql-formats"},s.default.createElement("button",{type:"button",onClick:()=>{const e=t.current;e.focus();const n=e.getSelection(),l=n?n.index:e.getLength(),a=w(),o=(new c.Delta).retain(l).insert("\n",{textbox:{width:"50%",align:""},"textbox-block":a});e.updateContents(o,c.default.sources.USER),setTimeout(()=>{e.setSelection(l,0,c.default.sources.USER)},0)},title:n.t("Insert text box")},s.default.createElement("i",{className:"pi pi-box"}))));function W(t){const n=s.default.useRef(null),l=s.default.useRef(null),a=s.default.useRef(null),o=(0,v.getExReady)(j,["i18n","prContextMenu","u","AbortController","prUtils"],l=>{l.i18n=l.i18n.default,l.AbortController=l.AbortController.default,a.current=new l.AbortController;const{modules:o,meta:r}=(0,e.getQuillModules)({props:t,signal:a.current.signal,i18n:l.i18n,quillRef:n});l.modules=o,l.meta=r,t.showHeader||(l.modules.toolbar=!1)});return s.default.useEffect(()=>()=>{a.current&&a.current.abort()},[]),o.ready?s.default.createElement("div",{onContextMenu:O({plain:t.plain,quillRef:n,elementRef:l}),onKeyDown:e=>{e.ctrlKey&&e.shiftKey&&"KeyL"==e.code&&(e.stopPropagation(),e.preventDefault(),$({quill:n.current,c:t.c}))}},t.showHeader&&s.default.createElement("div",{id:o.meta.toolbarID},t.plain?U({quillRef:n,c:t.c}):V({quillRef:n,c:t.c,i18n:o.i18n,u:o.u}),t.headerExtend),s.default.createElement(u.default,{config:{modules:o.modules,theme:"snow"},defaultValue:t.plain?(new c.Delta).insert(t.value):null,dangerouslySetInnerHTML:t.plain?null:{__html:t.htmlValue},onReady:l=>{if(n.current=l,t.parent.quill=l,y.debugMessage("Quill editor on",t.parent.props.elem.name,"autoFocus",t.autoFocus,"leafindex match",t.parent.leafIndexMatch()),t.autoFocus){let e;l.focus(),e=t.plain?(new c.Delta).insert(t.value||""):l.clipboard.convert({html:t.htmlValue||""}),0===e.length()&&setTimeout(()=>{l.setSelection(0,0,c.default.sources.USER)},50)}!t.showHeader||t.inGrid||t.plain||t.c.APP.state.site_data.installed_plugins.includes("uploads")&&(0,e.overrideImageButtonHandler)(n)},onTextChange:(0,e.changeDelta)({parent:t.parent,plain:t.plain,prUtils:o.prUtils,quillRef:n})}),s.default.createElement(o.prContextMenu.ContextMenu,{...(0,e.tableContextMenuProps)({i18n:o.i18n,quillRef:n,c:t.c}),ref:l}),s.default.createElement("div",{id:"raw-editor-container",onKeyDown:t=>t.stopPropagation()})):null}W.propTypes={value:(t,...e)=>t.plain?d.default.string.isRequired(t,...e):null,htmlValue:(t,...e)=>t.plain?null:d.default.string.isRequired(t,...e),plain:d.default.bool.isRequired,showHeader:d.default.bool.isRequired,c:d.default.object.isRequired,parent:d.default.object.isRequired,inGrid:d.default.bool.isRequired,headerExtend:d.default.node,autoFocus:d.default.bool}},1882:(t,e,n)=>{n.r(e),n.d(e,{default:()=>p});var l=n(5072),a=n.n(l),o=n(7825),r=n.n(o),i=n(7659),s=n.n(i),d=n(5056),c=n.n(d),u=n(540),m=n.n(u),h=n(1113),b=n.n(h),f=n(5969),g={};g.styleTagTransform=b(),g.setAttributes=c(),g.insert=s().bind(null,"head"),g.domAPI=r(),g.insertStyleElement=m();a()(f.A,g);const p=f.A&&f.A.locals?f.A.locals:void 0},5969:(t,e,n)=>{n.d(e,{A:()=>i});var l=n(1354),a=n.n(l),o=n(6314),r=n.n(o)()(a());r.push([t.id,".l-editor .ql-container {\n    font-family: inherit;\n    font-size: inherit;\n}\n\n/* TextBox Blot Styles */\n.ql-textbox {\n    border: 2px solid #ccc;\n    padding: 10px;\n    margin: 10px 0;\n    min-height: 60px;\n    background: #fafafa;\n    border-radius: 4px;\n    box-sizing: border-box;\n    position: relative;\n    transition: border-color 0.2s;\n}\n\n.ql-textbox:hover {\n    border-color: #4285f4;\n}\n\n.ql-textbox:focus-within {\n    border-color: #4285f4;\n    background: white;\n    outline: none;\n}\n\n/* TextBox child elements */\n.ql-textbox-block {\n    margin: 0;\n    padding: 0;\n    min-height: 1em;\n}\n\n.ql-textbox-soft-break {\n    /* Inherits from soft-break */\n}\n\n.ql-textbox-break {\n    /* Custom break styling within textbox */\n    display: block;\n}\n\n/* Alignment classes */\n.ql-textbox-align-left {\n    float: left;\n    margin-left: 0;\n    margin-right: 10px;\n    margin-bottom: 10px;\n}\n\n.ql-textbox-align-center {\n    display: block;\n    margin-left: auto;\n    margin-right: auto;\n    margin-bottom: 10px;\n    clear: both;\n}\n\n.ql-textbox-align-right {\n    float: right;\n    margin-left: 10px;\n    margin-right: 0;\n    margin-bottom: 10px;\n}\n\n/* Overlay styles */\n.ql-textbox-overlay {\n    pointer-events: none;\n}\n\n.ql-textbox-overlay .ql-textbox-handle {\n    pointer-events: auto;\n}\n\n/* Toolbar styles */\n.ql-textbox-toolbar {\n    display: flex;\n    gap: 2px;\n}\n\n.ql-textbox-toolbar-button {\n    font-size: 14px;\n    transition: all 0.2s;\n}\n\n.ql-textbox-toolbar-button:hover {\n    background: #f0f0f0 !important;\n    transform: scale(1.05);\n}\n\n.ql-textbox-toolbar-button:active {\n    transform: scale(0.95);\n}","",{version:3,sources:["webpack://./lino_react/react/components/quillmodules.css"],names:[],mappings:"AAAA;IACI,oBAAoB;IACpB,kBAAkB;AACtB;;AAEA,wBAAwB;AACxB;IACI,sBAAsB;IACtB,aAAa;IACb,cAAc;IACd,gBAAgB;IAChB,mBAAmB;IACnB,kBAAkB;IAClB,sBAAsB;IACtB,kBAAkB;IAClB,6BAA6B;AACjC;;AAEA;IACI,qBAAqB;AACzB;;AAEA;IACI,qBAAqB;IACrB,iBAAiB;IACjB,aAAa;AACjB;;AAEA,2BAA2B;AAC3B;IACI,SAAS;IACT,UAAU;IACV,eAAe;AACnB;;AAEA;IACI,6BAA6B;AACjC;;AAEA;IACI,wCAAwC;IACxC,cAAc;AAClB;;AAEA,sBAAsB;AACtB;IACI,WAAW;IACX,cAAc;IACd,kBAAkB;IAClB,mBAAmB;AACvB;;AAEA;IACI,cAAc;IACd,iBAAiB;IACjB,kBAAkB;IAClB,mBAAmB;IACnB,WAAW;AACf;;AAEA;IACI,YAAY;IACZ,iBAAiB;IACjB,eAAe;IACf,mBAAmB;AACvB;;AAEA,mBAAmB;AACnB;IACI,oBAAoB;AACxB;;AAEA;IACI,oBAAoB;AACxB;;AAEA,mBAAmB;AACnB;IACI,aAAa;IACb,QAAQ;AACZ;;AAEA;IACI,eAAe;IACf,oBAAoB;AACxB;;AAEA;IACI,8BAA8B;IAC9B,sBAAsB;AAC1B;;AAEA;IACI,sBAAsB;AAC1B",sourcesContent:[".l-editor .ql-container {\n    font-family: inherit;\n    font-size: inherit;\n}\n\n/* TextBox Blot Styles */\n.ql-textbox {\n    border: 2px solid #ccc;\n    padding: 10px;\n    margin: 10px 0;\n    min-height: 60px;\n    background: #fafafa;\n    border-radius: 4px;\n    box-sizing: border-box;\n    position: relative;\n    transition: border-color 0.2s;\n}\n\n.ql-textbox:hover {\n    border-color: #4285f4;\n}\n\n.ql-textbox:focus-within {\n    border-color: #4285f4;\n    background: white;\n    outline: none;\n}\n\n/* TextBox child elements */\n.ql-textbox-block {\n    margin: 0;\n    padding: 0;\n    min-height: 1em;\n}\n\n.ql-textbox-soft-break {\n    /* Inherits from soft-break */\n}\n\n.ql-textbox-break {\n    /* Custom break styling within textbox */\n    display: block;\n}\n\n/* Alignment classes */\n.ql-textbox-align-left {\n    float: left;\n    margin-left: 0;\n    margin-right: 10px;\n    margin-bottom: 10px;\n}\n\n.ql-textbox-align-center {\n    display: block;\n    margin-left: auto;\n    margin-right: auto;\n    margin-bottom: 10px;\n    clear: both;\n}\n\n.ql-textbox-align-right {\n    float: right;\n    margin-left: 10px;\n    margin-right: 0;\n    margin-bottom: 10px;\n}\n\n/* Overlay styles */\n.ql-textbox-overlay {\n    pointer-events: none;\n}\n\n.ql-textbox-overlay .ql-textbox-handle {\n    pointer-events: auto;\n}\n\n/* Toolbar styles */\n.ql-textbox-toolbar {\n    display: flex;\n    gap: 2px;\n}\n\n.ql-textbox-toolbar-button {\n    font-size: 14px;\n    transition: all 0.2s;\n}\n\n.ql-textbox-toolbar-button:hover {\n    background: #f0f0f0 !important;\n    transform: scale(1.05);\n}\n\n.ql-textbox-toolbar-button:active {\n    transform: scale(0.95);\n}"],sourceRoot:""}]);const i=r}}]);
//# sourceMappingURL=main.quillmodules_TextFieldElement.5b513498c2afdace04a0.js.map