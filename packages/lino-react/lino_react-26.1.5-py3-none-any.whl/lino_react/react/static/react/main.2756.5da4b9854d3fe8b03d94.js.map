{"version":3,"file":"main.2756.5da4b9854d3fe8b03d94.js","mappings":"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","sources":["webpack://lino_react/./lino_react/react/components/LinoComponentUtils.jsx"],"sourcesContent":["export const name = \"LinoComponentUtils\";\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport { RegisterImportPool, getExReady, Component, DataContextType } from \"./Base\";\n\nimport * as constants from \"./constants\";\n\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\nlet ex; const exModulePromises = ex = {\n    classNames: import(/* webpackChunkName: \"classNames_LinoComponentUtils\" */\"classnames\"),\n    prDropdown: import(/* webpackChunkName: \"prDropdown_LinoComponentUtils\" */\"primereact/dropdown\"),\n    prInputText: import(/* webpackChunkName: \"prInputText_LinoComponentUtils\" */\"primereact/inputtext\"),\n    queryString: import(/* webpackChunkName: \"queryString_LinoComponentUtils\" */\"query-string\"),\n    sc: import(/* webpackChunkName: \"SiteContext_LinoComponentUtils\" */\"./SiteContext\"),\n    u: import(/* webpackChunkName: \"LinoUtils_LinoComponentUtils\" */\"./LinoUtils\"),\n};RegisterImportPool(ex);\n\n\nexport function maintainTableWidth(count) {\n    let keys = Object.keys(this.flexs),\n        fo_conditional = count !== undefined ? keys.length === count : keys.length > 1;\n    if (fo_conditional) {\n        keys.forEach(key => {\n            var tbl = document.getElementById(key)\n                .getElementsByClassName('p-datatable');\n            if (tbl.length === 1) {\n                tbl = tbl[0]\n                let width = tbl.getBoundingClientRect().width / document\n                    .getElementsByClassName('layout-topbar')[0]\n                    .getBoundingClientRect().width;\n                if (width > this.flexs[key]) {\n                    Array.from(tbl.querySelectorAll(\n                        '.p-datatable table')).forEach(el => {\n                            if (Array.from(el.classList).join(' ')\n                                .includes('p-datatable')) el.style\n                                    .setProperty('table-layout', 'auto');\n                        });\n                }\n            }\n        });\n    }\n}\n\n\nexport const Labeled = ({\n    actions = [], label, elem, children,\n    hide_label = false, isFilled = false,\n}) => {\n    const localEx = getExReady(ex, ['classNames']);\n    label = label || elem.label;\n    return !localEx.ready ? null : <React.Fragment>\n        {!hide_label && label && <React.Fragment>\n            <label\n                className={localEx.classNames.default(\n                    \"l-label\", \"l-span-clickable\",\n                    {\"l-label--unfilled\": !isFilled},\n                )}\n                title={Object.assign({}, elem.value || {}).quicktip\n                    || elem.help_text}>\n                    {label}\n                    {actions.map((action, i) => <React.Fragment key={i}>\n                        &nbsp;|&nbsp;\n                        {\n                            // <span\n                            //     className=\"l-span-clickable\"\n                            //     onClick={e => action.run(e)}>\n                            //     {action.label}</span>\n                        }\n                        <span dangerouslySetInnerHTML={{__html: action}} />\n                    </React.Fragment>)}:</label>\n            <br/>\n        </React.Fragment>}\n        {children}\n    </React.Fragment>\n}\n\n\nLabeled.propTypes = {\n    actions: PropTypes.array,\n    label: PropTypes.string,\n    elem: PropTypes.object.isRequired,\n    hide_label: PropTypes.bool,\n    isFilled: PropTypes.bool,\n    children: PropTypes.element.isRequired,\n}\n\n\nexport class ABCComponent {\n    static getValueByName({name, props, context}) {\n        if (props[constants.URL_PARAM_WINDOW_TYPE] === constants.WINDOW_TYPE_PARAMS)\n            return context.param_values[name];\n        return props[constants.URL_PARAM_WINDOW_TYPE] === constants.WINDOW_TYPE_TABLE\n            ? context.rows[props.column.rowIndex][name]\n            : props[constants.URL_PARAM_WINDOW_TYPE] === constants.WINDOW_TYPE_CARDS\n                ? context[name] : context.data[name];\n    }\n}\n\n\nexport class LeafComponentBase extends Component {\n    static requiredModules = [\"classNames\"];\n    static iPool = ex;\n    static contextType = DataContextType;\n    static propTypesFromLinoLayout = {\n        column: PropTypes.object,\n        editing_mode: PropTypes.bool,\n        hide_label: PropTypes.bool,\n        [constants.URL_PARAM_WINDOW_TYPE]: PropTypes.oneOf([\n            constants.WINDOW_TYPE_TABLE,\n            constants.WINDOW_TYPE_DETAIL,\n            constants.WINDOW_TYPE_CARDS,\n            constants.WINDOW_TYPE_GALLERIA,\n            constants.WINDOW_TYPE_INSERT,\n            constants.WINDOW_TYPE_PARAMS,\n            constants.WINDOW_TYPE_UNKNOWN,\n        ]),\n        tabIndex: PropTypes.number.isRequired,\n    }\n\n    static propTypes = {\n        ...LeafComponentBase.propTypesFromLinoLayout,\n        elem: PropTypes.object.isRequired,\n        urlParams: PropTypes.object.isRequired,\n        // leafIndex used in onLeafMount handler\n        leafIndex: PropTypes.number.isRequired,\n    }\n\n    static defaultProps = {\n        editing_mode: false,\n        hide_label: false,\n        [constants.URL_PARAM_WINDOW_TYPE]: constants.WINDOW_TYPE_UNKNOWN,\n    }\n\n    constructor(props, context) {\n        super(props, context);\n        this.wrapperClasses = []\n        this.dataKey = props[constants.URL_PARAM_WINDOW_TYPE] === constants.WINDOW_TYPE_TABLE\n            ? props.elem.fields_index : props.elem.name;\n        this.upController = props.urlParams.controller;\n        this.c = props.urlParams.controller;\n\n        this.filled = this.filled.bind(this);\n        this.getValue = this.getValue.bind(this);\n        this.getValueByName = this.getValueByName.bind(this);\n        this.innerHTML = this.innerHTML.bind(this);\n        this.setLeafRef = this.setLeafRef.bind(this);\n    }\n\n    filled = () => (![\"\", null, undefined].includes(this.getValue()));\n\n    getValueByName(name) {\n        return ABCComponent.getValueByName({\n            name: name, props: this.props, context: this.context});\n    }\n\n    getValue() {\n        return this.getValueByName(this.dataKey);\n    }\n\n    formatValue(v) {\n        return v;\n    }\n\n    innerHTML(dangerous, style={}) {\n        let v = this.formatValue(this.getValue());\n        if (!this.c.filled(v)) v = \"\\u00a0\";\n        if (v instanceof Object) v = JSON.stringify(v);\n        if (dangerous) {\n            return <div style={style} dangerouslySetInnerHTML={{__html: v}}/>\n        } else {\n            return <div style={style}>{v}</div>\n        }\n    }\n\n    setLeafRef({input=false, type=\"\"} = {}) {\n        if (\n            this.props[constants.URL_PARAM_WINDOW_TYPE] === constants.WINDOW_TYPE_DETAIL ||\n            this.props[constants.URL_PARAM_WINDOW_TYPE] === constants.WINDOW_TYPE_INSERT\n        ) {\n            this.upController.dataContext.setLeafRef({\n                name: type === 'slave' ? this.actorID\n                    : this.props.elem.name, ref: this, input: input, type: type});\n            const {controller} = this.props.urlParams;\n            controller.onLeafMount();\n        }\n    }\n}\n\n\nexport class LeafComponentDelayedValue extends LeafComponentBase {\n    static requiredModules = [\"queryString\", \"sc\"].concat(LeafComponentBase.requiredModules);\n    static propTypes = {\n        ...LeafComponentBase.propTypes,\n        hasOwnContext: PropTypes.bool.isRequired\n    }\n    static defaultProps = {\n        ...LeafComponentBase.defaultProps,\n        hasOwnContext: false\n    }\n\n    constructor(props, context, notSlave=false) {\n        super(props, context);\n        this.delayed = !!props.elem.delayed_value;\n        const masterRelate = {}\n        if (!props.hasOwnContext) Object.assign(masterRelate,\n            this.upController.actionHandler.masterRelateForSlave());\n        this.state = {\n            ...this.state, value: null, data_url: null, ...masterRelate,\n            key: this.upController.newSlug(),\n            haveCTX: this.delayed && !notSlave,\n        }\n        this.state.UCMount = !this.state.haveCTX || !this.delayed;\n        this.actorID = props.elem.actor_id || (props.elem.name.includes('.')\n            ? props.elem.name : `${props.urlParams.packId}.${props.elem.name}`);\n\n        this.shouldComponentUpdate = this.shouldComponentUpdate.bind(this);\n        this.getData = this.getData.bind(this);\n        this.getValue = this.getValue.bind(this);\n        this.update = this.update.bind(this);\n    }\n\n    onReady() {\n        let val = super.getValue();\n        if (!this.delayed) {\n            this.setState({value: val});\n            return;\n        }\n        if (!this.props.hasOwnContext) this.setLeafRef({type: 'slave'});\n        this.upController.globals.panels[this.actorID] = this;\n        if (val !== null) this.getData(val.delayed_value_url)\n        else this.setState({value: \"\\u00a0\", data_url: undefined});\n    }\n\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\n    shouldComponentUpdate(nextProps, nextState, context) {\n        const val = super.getValue();\n        let update = (\n            this.state.value !== nextState.value ||\n            this.state.UCMount !== nextState.UCMount ||\n            this.state.ready !== nextState.ready\n        );\n        if (this.delayed) update = update || (this.state.value !== null &&\n            (val || {}).delayed_value_url !== this.state.data_url);\n        return update;\n    }\n\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\n    componentDidUpdate(prevProps, prevState) {\n        const val = super.getValue();\n        if (this.delayed) {\n            if (this.state.data_url !== (val || {}).delayed_value_url) {\n                this.setState({value: null});\n                if (val !== null) this.update()\n                else this.setState({value: \"\\u00a0\", data_url: undefined});\n            }\n        } else this.setState({value: val});\n    }\n\n    componentWillUnmount() {\n        delete this.upController.globals.panels[this.actorID];\n    }\n\n    getValue() {\n        return this.state.value;\n    }\n\n    getData(data_url) {\n        if (!this.state.UCMount) return;\n        // const myParams = this.upController.actionHandler.getParams();\n        const params = this.props.urlParams.controller.actionHandler.getParams();\n        // params.childParams = JSON.stringify(myParams);\n        // this.props.urlParams.controller.actionHandler.defaultStaticParams(params);\n        params[constants.URL_PARAM_REQUESTING_PANEL\n        ] = this.upController.actionHandler.refName;\n\n        this.upController.actionHandler.silentFetch({\n            // path: `${data_url}?${this.ex.queryString.default.stringify(this.upController.actionHandler.commonParams())}`\n            path: `${data_url}?${this.ex.queryString.default.stringify(params)}`\n        }).then((data) => {\n            this.setState({value: data.data, buttons: data.buttons,\n                           data_url: data_url});\n            this.upController.root.setState({});\n        });\n    }\n\n    liveUpdate = (params) => {\n        if (params.mk == null ||\n            (params.mk === this.state.mk && params.mt === this.state.mt)\n        ) this.update();\n    }\n\n    update() {\n        this.getData(super.getValue().delayed_value_url);\n    }\n\n    getChildren() {\n        throw \"NotImplemented\";\n    }\n\n    render() {\n        if (!this.state.ready) return null;\n        const up = this.props.urlParams, c = up.controller;\n        return this.state.haveCTX ? <this.ex.sc.URLContext\n            getChildren={(context) => {\n                context.controller.setContextType(constants.CONTEXT_TYPE_SLAVE_GRID);\n                const elem = this.getChildren();\n                return elem;\n            }}\n            params={c.actionHandler.masterRelateForSlave()}\n            parentContext={c}\n            path={`/api/${this.actorID.split(\".\").join(\"/\")}`}\n            onContextReady={(context) => {\n                this.upController = context.controller;\n                // const c = context.controller;\n                // const param_values = {}\n                // if (c.static.actorData.params_layout) {\n                //     c.static.actorData.params_fields.reduce((v, name) => {\n                //         v[name] = null;\n                //         return v;\n                //     }, param_values);\n                // }\n                // this.DataContext = new this.ex.sc.DataContext({\n                //     root: this, context: {param_values}, next: (dc) => {\n                //         c.attachDataContext(dc);\n                //     }\n                // });\n                this.setState({UCMount: true});\n            }}\n            simple={false}\n            summary={this}/>\n            : this.getChildren();\n    }\n}\n\n\nexport class LeafComponentInput extends LeafComponentBase {\n    static requiredModules = [\"prInputText\", \"u\"].concat(LeafComponentBase.requiredModules);\n    constructor(props, context) {\n        super(props, context);\n\n        this.wrapperClasses.push(\"lino-input-leaf\");\n\n        this.state = {\n            ...this.state,\n            textSelected: false,\n            // initialHang: props.urlParams.controller.contextType !== constants.CONTEXT_TYPE_ACTION,\n        }\n\n        this.styleClasses = [\n            \"disabled-input\",\n            \"l-card\",\n            \"unsaved-modification\",\n        ]\n\n        this.clockTimer = null;\n\n        this.disabled = this.disabled.bind(this);\n        this.filled = this.filled.bind(this);\n        this.focus = this.focus.bind(this);\n        this.getCellStyleClasses = this.getCellStyleClasses.bind(this);\n        this.getLinoInput = this.getLinoInput.bind(this);\n        this.onChangeUpdate = this.onChangeUpdate.bind(this);\n        this.onInputRef = this.onInputRef.bind(this);\n        this.onKeyDown = this.onKeyDown.bind(this);\n        this.onRef = this.onRef.bind(this);\n        this.setCellStyle = this.setCellStyle.bind(this);\n        this.submit = this.submit.bind(this);\n        this.leafIndexMatch = this.leafIndexMatch.bind(this);\n        this.update = this.update.bind(this);\n    }\n\n    async prepare() {\n        // this.select = this.ex.u.debounce(this.select.bind(this), 100);\n        this.inputState = {\n            inputComponent: this.ex.prInputText.InputText,\n            inputOnly: false,\n            inputProps: {},\n            onChangeUpdateAssert: () => true,\n            postOnChange: () => null,\n            getValueFromEvent: (event) => event.target.value,\n        }\n        this.setLeafRef({input: true});\n    }\n\n    // componentDidUpdate(prevProps) {\n    //     if (!this.props.editing_mode && prevProps.editing_mode) {\n    //         this.initialSelectionDone = false;\n    //     }\n    // }\n\n    disabled() {\n        if (this.props[constants.URL_PARAM_WINDOW_TYPE] === constants.WINDOW_TYPE_CARDS)\n            return true;\n        if (this.props[constants.URL_PARAM_WINDOW_TYPE] === constants.WINDOW_TYPE_PARAMS)\n            return false;\n        if (!this.props.elem.editable) return true;\n        if (this.props[constants.URL_PARAM_WINDOW_TYPE] === constants.WINDOW_TYPE_TABLE) {\n            let row = this.context.rows[this.props.column.rowIndex],\n                last_item = row[row.length - 1];\n\n            // No meta, assume not disabled;\n            if (!last_item || !last_item.meta || last_item.phantom) return false;\n            // disable_editing set to true;\n            if (row[row.length - 2]) return true;\n            // check name in the disabled_fields meta;\n            return row[row.length - 3][this.props.elem.name] || false;\n        } else {\n            if (this.context.data.disable_editing) return true;\n            return this.context.data.disabled_fields[this.props.elem.name] || false;\n        }\n    }\n\n    /**\n     * Find HTML input element\n     */\n    findHTMLInputElement(ref) {\n        if (!ref) return ref;\n        if (ref.focusInput) ref = ref.focusInput\n        else if (ref.inputRef) ref = ref.inputRef.current\n        else if (Object.prototype.hasOwnProperty.call(ref, 'getInput')) ref = ref.getInput();\n        return ref;\n    }\n\n    select(input) {\n        if (getSelection().toString() != \"\") return;\n        const _select = (_input) => {\n            this.state.textSelected = true;\n            _input.select();\n            // this.initialSelectionDone = true;\n            // this.setState({initialHang: false});\n        }\n        if (input.select) {_select(input); return}\n        if (this.container) input = this.container.getElementsByTagName('input')[0];\n        if (input && input.select) _select(input);\n    }\n\n    focus() {\n        let ref = this.findHTMLInputElement(this.inputEl);\n        if (ref && !this.focusSet) {\n        // if (ref) {\n            if (ref.focus) {\n                ref.focus()\n            } else if (ref.click) {\n                ref.click();\n            }   \n            this.focusSet = true\n            // this.select(ref);\n        }\n    }\n\n    getCellStyleClasses(disabled) {\n        let styleClasses = [];\n        if (this.props[constants.URL_PARAM_WINDOW_TYPE] === constants.WINDOW_TYPE_TABLE) {\n            if (this.context.modifiedRows[this.props.column.rowIndex].includes(\n                this.props.elem.fields_index\n            )) {\n                styleClasses.push(\"unsaved-modification\");\n            }\n        } else {\n            styleClasses.push('l-card');\n            if (this.props[constants.URL_PARAM_WINDOW_TYPE] !== constants.WINDOW_TYPE_CARDS) {\n                if (disabled) styleClasses.push(\"disabled-input\")\n                else if (this.context.modified.includes(this.props.elem.name))\n                    styleClasses.push(\"unsaved-modification\");\n            }\n        }\n        return styleClasses;\n    }\n\n    getValue() {\n        let v = super.getValue();\n        if (!this.c.filled(v)) v = \"\";\n        return v;\n    }\n\n    getLinoInput() {\n        return <this.inputState.inputComponent\n            autoFocus={this.leafIndexMatch()}\n            // disabled={this.state.initialHang}\n            onChange={(e) => {\n                if (!this.inputState.onChangeUpdateAssert(e)) return;\n                this.onChangeUpdate(e);\n                this.inputState.postOnChange(e);\n            }}\n            onFocus={(e) => {\n                this.select(e.target);\n            }}\n            ref={this.onInputRef}\n            style={{width: \"100%\"}}\n            tabIndex={this.props.tabIndex}\n            value={this.getValue()}\n            {...this.inputState.inputProps}/>;\n    }\n\n    onChangeUpdate(e) {\n        this.update({[this.dataKey]: this.inputState.getValueFromEvent(e)});\n        this.setState({});\n    }\n\n    onInputRef(ref) {\n        this.inputEl = ref;\n        // if (ref && !this.initialSelectionDone && this.leafIndexMatch()) {\n        //     const input = this.findHTMLInputElement(ref);\n        //     if (input) {\n        //         this.select(input);\n        //     }\n        // }\n        // if (ref) {\n        //     // if (ref != this.inputEl) this.focusDone = false;\n        //     // if (!this.focusDone) {\n        //     //     let htmlInput = this.findHTMLInputElement(ref);\n        //     //     if (document.activeElement === htmlInput) return;\n        //     //     if (this.leafIndexMatch()) this.focus();\n        //     //     this.focusDone = true\n        //     // }\n        //     if (this.leafIndexMatch()) this.focus();\n        // }\n    }\n\n    onKeyDown(event) {\n        if (event.code === \"Escape\" &&\n        this.props[constants.URL_PARAM_WINDOW_TYPE] === constants.WINDOW_TYPE_DETAIL &&\n        this.props.editing_mode) {\n            this.ex.u.toggleEditingMode(this.props.urlParams);\n        }\n    }\n\n    onRef(ref) {\n        this.container = ref;\n        const disabled = this.disabled();\n        \n        const handleClick = () => {\n            if (disabled) return;\n            \n            // Check if text is selected\n            const selection = window.getSelection();\n            const hasSelection = selection && selection.toString().length > 0;\n            if (hasSelection) return;\n            \n            Object.assign(this.upController.globals, {\n                currentInputRowIndex: Object.assign({rowIndex: 0}, this.props.column).rowIndex,\n                currentInputIndex: this.props.leafIndex,\n                currentInputWindowType: this.props[constants.URL_PARAM_WINDOW_TYPE],\n                currentInputAHRefName: this.upController.actionHandler.refName,\n            });\n            \n            if (this.props[constants.URL_PARAM_WINDOW_TYPE] === constants.WINDOW_TYPE_DETAIL) {\n                if (!this.props.editing_mode) {\n                    this.upController.history.replaceState({editing_mode: true});\n                } else {\n                    if (this.state.textSelected) {\n                        this.setState({textSelected: false});\n                    } else {\n                        this.select(this.findHTMLInputElement(this.inputEl));\n                    }\n                }\n            }\n        };\n        \n        const setupClickHandlers = () => {\n            this.container.onclick = () => {\n                // if (this.clickTimer !== null) {\n                //     clearTimeout(this.clickTimer);\n                //     this.clickTimer = null;\n                // } else {\n                //     this.clickTimer = setTimeout(() => {\n                //         this.clickTimer = null;\n                //         handleClick();\n                //     }, 250);\n                // }\n                handleClick();\n            };\n            \n            // this.container.ondblclick = () => {\n            //     if (this.clickTimer !== null) {\n            //         clearTimeout(this.clickTimer);\n            //         this.clickTimer = null;\n            //     }\n            // };\n        };\n\n        if (ref) {\n            if (this.props[constants.URL_PARAM_WINDOW_TYPE] === constants.WINDOW_TYPE_TABLE) {\n                this.container = ref.closest(\"td\");\n                setupClickHandlers();\n            }\n            else if (\n                this.props[constants.URL_PARAM_WINDOW_TYPE] === constants.WINDOW_TYPE_DETAIL ||\n                this.props[constants.URL_PARAM_WINDOW_TYPE] === constants.WINDOW_TYPE_INSERT\n            ) {\n                setupClickHandlers();\n            }\n        }\n        this.setCellStyle(this.container, disabled);\n    }\n\n    setCellStyle(ref, disabled) {\n        if (ref) {\n            let classes = this.getCellStyleClasses(disabled);\n            this.styleClasses.forEach(item => {ref.classList.remove(item)});\n            classes.forEach(item => {ref.classList.add(item)});\n        }\n    }\n\n    submit() {\n        this.upController.actionHandler.submit({\n            cellInfo: {rowIndex: this.props.column.rowIndex}});\n    }\n\n    leafIndexMatch() {\n        if (\n            this.props[constants.URL_PARAM_WINDOW_TYPE] === constants.WINDOW_TYPE_TABLE &&\n            this.props.column.rowIndex !== this.upController.globals.currentInputRowIndex\n        ) return false;\n        if (\n            this.props[constants.URL_PARAM_WINDOW_TYPE] === this.upController.globals.currentInputWindowType &&\n            this.upController.actionHandler.refName === this.upController.globals.currentInputAHRefName &&\n            this.props.leafIndex === this.upController.globals.currentInputIndex\n        ) return true;\n        return false;\n    }\n\n    update(values) {\n        this.upController.actionHandler.update({\n            values: values, elem: this.props.elem, col: this.props.column,\n            windowType: this.props[constants.URL_PARAM_WINDOW_TYPE]});\n    }\n\n    render(hide_label=this.props.hide_label) {\n        if (!this.state.ready) return null;\n        const disabled = this.disabled();\n        if (this.container) this.setCellStyle(this.container, disabled);\n        return <Labeled {...this.props}\n            actions={(this.context.field_actions || {})[this.props.elem.name] || []}\n            hide_label={hide_label}\n            elem={this.props.elem} isFilled={this.filled()}>\n            <div\n                className={this.ex.classNames.default(\n                    this.wrapperClasses,\n                    {\"lino-disabled-leaf\": disabled},\n                )}\n                onKeyDown={this.onKeyDown}\n                ref={this.onRef}>\n                    {this.inputState.inputOnly ? this.getLinoInput() :\n                        this.props.editing_mode && !disabled ?\n                            this.getLinoInput() : this.innerHTML()}\n            </div>\n        </Labeled>\n    }\n}\n\n\nexport class LeafComponentInputChoices extends LeafComponentInput {\n    static requiredModules = [\"prDropdown\"].concat(LeafComponentInput.requiredModules);\n    constructor(props, context) {\n        super(props, context);\n        this.wrapperClasses.push(\"l-ChoiceListFieldElement\");\n        this.state = {\n            ...this.state,\n            hidden_value: null\n        }\n\n        this.dataKeyHidden = props[constants.URL_PARAM_WINDOW_TYPE] === constants.WINDOW_TYPE_TABLE\n            ? props.elem.fields_index_hidden\n            : props.elem.name + \"Hidden\";\n\n        this.getLinoInput = this.getLinoInput.bind(this);\n        this.getValue = this.getValue.bind(this);\n        this.innerHTML = this.innerHTML.bind(this);\n    }\n\n    onKeyDown = (e) => {\n        super.onKeyDown(e);\n        if (e.key === \"Enter\" && this.inputEl.getOverlay()) e.stopPropagation();\n    }\n\n    getValue() {\n        return {\n            text: super.getValue(),\n            value: this.getValueByName(this.dataKeyHidden)};\n    }\n\n    getLinoInput() {\n        return <this.ex.prDropdown.Dropdown\n            // appendTo={this.inputEl ? this.findHTMLInputElement(this.inputEl) : window.App.topDiv}\n            autoFocus={this.leafIndexMatch()}\n            itemTemplate={(item) => {\n                return <div dangerouslySetInnerHTML={{__html: item.text}}/>\n            }}\n            onChange={(e) => {\n                if (e.originalEvent.ctrlKey || e.originalEvent.altKey) return;\n                this.update({[this.dataKey]: e.value || null,  // have null instead of undefined\n                    [this.dataKeyHidden]: e.value || null});\n                this.setState({});\n            }}\n            onFocus={(e) => {\n                this.select(e.target);\n            }}\n            optionLabel=\"text\"\n            options={this.options}\n            // panelStyle={{zIndex: \"99999\"}}\n            // ref={this.onInputRef}\n            ref={ref => this.inputEl = ref}\n            showClear={this.props.elem.field_options.allowBlank}\n            style={{width: \"100%\"}}\n            tabIndex={this.props.tabIndex}\n            value={this.getValue().value}\n            valueTemplate={(item) => {\n                if (item) return <div dangerouslySetInnerHTML={{__html: item.text}}/>\n                return <div>&nbsp;</div>;\n            }}/>\n    }\n\n    innerHTML() {\n        let v = super.getValue();\n        if (!this.c.filled(v)) v = \"\\u00a0\";\n        // return <div style={{whiteSpace: \"nowrap\"}}>{v}</div>\n        return <div /* style={{whiteSpace: \"nowrap\"}} */ dangerouslySetInnerHTML={{__html: v}}/>\n    }\n}\n"],"names":["ex","name","classNames","prDropdown","prInputText","queryString","sc","u","maintainTableWidth","count","_this","keys","Object","this","flexs","undefined","length","forEach","key","tbl","document","getElementById","getElementsByClassName","getBoundingClientRect","width","Array","from","querySelectorAll","el","classList","join","includes","style","setProperty","RegisterImportPool","Labeled","_ref","_ref$actions","actions","label","elem","children","_ref$hide_label","hide_label","_ref$isFilled","isFilled","localEx","getExReady","ready","React","className","title","assign","value","quicktip","help_text","map","action","i","dangerouslySetInnerHTML","__html","propTypes","PropTypes","isRequired","ABCComponent","_createClass","_classCallCheck","_ref2","props","context","constants","param_values","rows","column","rowIndex","data","LeafComponentBase","_Component","_this2","_callSuper","filled","getValue","wrapperClasses","dataKey","fields_index","upController","urlParams","controller","c","bind","getValueByName","innerHTML","setLeafRef","_inherits","v","dangerous","arguments","formatValue","JSON","stringify","_ref3","_ref3$input","input","_ref3$type","type","dataContext","actorID","ref","onLeafMount","Component","requiredModules","iPool","contextType","DataContextType","propTypesFromLinoLayout","_defineProperty","editing_mode","_objectSpread","leafIndex","defaultProps","LeafComponentDelayedValue","_LeafComponentBase","_this3","notSlave","liveUpdate","params","mk","state","mt","update","delayed","delayed_value","masterRelate","hasOwnContext","actionHandler","masterRelateForSlave","data_url","newSlug","haveCTX","UCMount","actor_id","concat","packId","shouldComponentUpdate","getData","val","_superPropGet","globals","panels","delayed_value_url","setState","nextProps","nextState","prevProps","prevState","_this4","getParams","refName","silentFetch","path","then","buttons","root","_this5","URLContext","getChildren","setContextType","parentContext","split","onContextReady","simple","summary","LeafComponentInput","_LeafComponentBase2","_this6","push","textSelected","styleClasses","clockTimer","disabled","focus","getCellStyleClasses","getLinoInput","onChangeUpdate","onInputRef","onKeyDown","onRef","setCellStyle","submit","leafIndexMatch","_prepare","_asyncToGenerator","_regeneratorRuntime","_callee","_context","prev","next","inputState","inputComponent","InputText","inputOnly","inputProps","onChangeUpdateAssert","postOnChange","getValueFromEvent","event","target","stop","apply","editable","row","last_item","meta","phantom","disable_editing","disabled_fields","focusInput","inputRef","current","prototype","hasOwnProperty","call","getInput","_this7","getSelection","toString","_select","_input","select","container","getElementsByTagName","findHTMLInputElement","inputEl","focusSet","click","modifiedRows","modified","_this8","_extends","autoFocus","onChange","e","onFocus","tabIndex","code","toggleEditingMode","_this9","setupClickHandlers","onclick","selection","window","currentInputRowIndex","currentInputIndex","currentInputWindowType","currentInputAHRefName","history","replaceState","handleClick","closest","classes","item","remove","add","cellInfo","values","col","windowType","field_actions","LeafComponentInputChoices","_LeafComponentInput","_this0","getOverlay","stopPropagation","hidden_value","dataKeyHidden","fields_index_hidden","text","_this1","Dropdown","itemTemplate","originalEvent","ctrlKey","altKey","optionLabel","options","showClear","field_options","allowBlank","valueTemplate"],"ignoreList":[],"sourceRoot":""}