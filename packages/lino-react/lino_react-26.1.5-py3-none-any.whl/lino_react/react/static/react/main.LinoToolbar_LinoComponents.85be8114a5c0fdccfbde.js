"use strict";(self.webpackChunklino_react=self.webpackChunklino_react||[]).push([[8923],{6511:(e,t,n)=>{n.r(t),n.d(t,{LayoutButton:()=>F,LinoToolbar:()=>j,name:()=>N});var r=n(467),o=n(3029),i=n(2901),a=n(6822),l=n(5501),c=n(3954),s=n(991),u=n(296),p=n(4467),d=n(2284),_=n(4756),A=n.n(_),h=n(5072),D=n.n(h),f=n(7825),m=n.n(f),E=n(7659),b=n.n(E),L=n(5056),v=n.n(L),P=n(540),S=n.n(P),x=n(1113),O=n.n(x),g=n(8462),I={};I.styleTagTransform=O(),I.setAttributes=v(),I.insert=b().bind(null,"head"),I.domAPI=m(),I.insertStyleElement=S();D()(g.A,I);g.A&&g.A.locals&&g.A.locals;var y=n(6540),M=n(5556),R=n.n(M),T=n(8524),C=n(6606);function Y(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function B(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Y(Object(n),!0).forEach(function(t){(0,p.A)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Y(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function w(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(w=function(){return!!e})()}function k(e,t,n,r){var o=(0,s.A)((0,c.A)(1&r?e.prototype:e),t,n);return 2&r&&"function"==typeof o?function(e){return o.apply(n,e)}:o}var U,N="LinoToolbar";U={AbortController:n.e(4166).then(n.t.bind(n,5568,23)),prButton:Promise.all([n.e(8026),n.e(1927),n.e(8887),n.e(5573),n.e(7335),n.e(9685),n.e(7801)]).then(n.bind(n,9119)),prInputText:Promise.all([n.e(8026),n.e(9109),n.e(8887),n.e(5573),n.e(7335),n.e(9685),n.e(2123)]).then(n.bind(n,413)),prOverlayPanel:Promise.all([n.e(8026),n.e(6190),n.e(8887),n.e(5573),n.e(7335),n.e(6836),n.e(3618)]).then(n.bind(n,619)),prMultiSelect:Promise.all([n.e(8026),n.e(9109),n.e(8887),n.e(5573),n.e(7335),n.e(9685),n.e(6836),n.e(6799),n.e(7529)]).then(n.bind(n,5117)),prSelectButton:Promise.all([n.e(8026),n.e(7134),n.e(8887),n.e(5573),n.e(7335),n.e(9685),n.e(8320)]).then(n.bind(n,2927)),prSplitButton:Promise.all([n.e(8026),n.e(6190),n.e(1927),n.e(8887),n.e(5573),n.e(7335),n.e(9685),n.e(6836),n.e(2315)]).then(n.bind(n,8997)),prToggleButton:Promise.all([n.e(8026),n.e(7134),n.e(8887),n.e(5573),n.e(7335),n.e(9685),n.e(5145)]).then(n.bind(n,2251)),u:Promise.resolve().then(n.bind(n,7540)),bb:n.e(8865).then(n.bind(n,7741)),lm:n.e(8865).then(n.bind(n,8546)),ac:Promise.all([n.e(8026),n.e(9109),n.e(4166),n.e(1927),n.e(8887),n.e(5573),n.e(7335),n.e(9685),n.e(6836),n.e(1304),n.e(8605),n.e(6799),n.e(2756),n.e(7667)]).then(n.t.bind(n,2617,23)),tbc:Promise.all([n.e(8026),n.e(1927),n.e(8887),n.e(5573),n.e(7335),n.e(9685),n.e(1304),n.e(8605),n.e(8729)]).then(n.t.bind(n,8004,23)),i18n:Promise.all([n.e(1304),n.e(8605),n.e(7211)]).then(n.bind(n,5721))};function F(){var e=y.useContext(C.URLContextType),t=(0,C.getExReady)(U,["prSelectButton","u","i18n"],function(e){e.i18n=e.i18n.default}),n=e.controller,r=y.useCallback(function(t,r){var o,i=function(e){n.isModified()?n.actionHandler.discardModDConfirm({agree:e}):e()};switch(t){case T.DISPLAY_MODE_DETAIL:if(n.contextType===T.CONTEXT_TYPE_SINGLE_ROW)return;if(0===e[T.URL_PARAM_SELECTED].length){var a,l=n.dataContext.mutableContext.rows[0];l&&(a=Object.prototype.hasOwnProperty.call(l,"id")?l.id:"object"===(0,d.A)(l)?l[n.static.actorData.pk_index]:null),n.filled(a)?i(function(){return n.actionHandler.singleRow(r,a)}):(void 0===a&&console.warn("actorData.pk_index is undefined, cannot resolve pk!"),null===a&&console.warn("cannot open detail on a phantom row!"),n.history.replaceState({hasDetail:!1}))}else i(function(){return n.actionHandler.singleRow(r,e[T.URL_PARAM_SELECTED][0])});break;case"external":var c={};[T.DISPLAY_MODE_HTML,T.DISPLAY_MODE_SUMMARY].includes(e[T.URL_PARAM_DISPLAY_MODE])&&Object.assign(c,(0,p.A)({},T.URL_PARAM_DISPLAY_MODE,T.DISPLAY_MODE_TABLE)),i(function(){return n.actionHandler.copyContext(n.APP.URLContext,c)});break;case T.DISPLAY_MODE_HTML:case T.DISPLAY_MODE_SUMMARY:case T.DISPLAY_MODE_TABLE:case T.DISPLAY_MODE_CARDS:case T.DISPLAY_MODE_LIST:case T.DISPLAY_MODE_GALLERY:case T.DISPLAY_MODE_STORY:case T.DISPLAY_MODE_TILES:var s=(0,p.A)({},T.URL_PARAM_DISPLAY_MODE,t);o||(o=n.contextType===T.CONTEXT_TYPE_SINGLE_ROW?n.actionHandler.multiRow:n.history.replace),i(function(){return o(s)})}}),o=y.useState([]),i=(0,u.A)(o,2),a=i[0],l=i[1];return y.useEffect(function(){if(t.ready){var r=n.static.actorData,o=[];o.push({icon:"pi-table",help:t.i18n.t("Table view"),value:T.DISPLAY_MODE_TABLE}),e.hasDetail&&o.push({icon:"pi-file-o",help:t.i18n.t("Detail view"),value:T.DISPLAY_MODE_DETAIL}),r.available_display_modes.includes(T.DISPLAY_MODE_HTML)&&o.push({icon:"pi-arrows-h",help:t.i18n.t("Simple table view"),value:T.DISPLAY_MODE_HTML}),r.available_display_modes.includes(T.DISPLAY_MODE_LIST)&&o.push({icon:"pi-bars",help:t.i18n.t("List view"),value:T.DISPLAY_MODE_LIST}),r.available_display_modes.includes(T.DISPLAY_MODE_SUMMARY)&&o.push({icon:"pi-ellipsis-h",help:t.i18n.t("Summary view"),value:T.DISPLAY_MODE_SUMMARY}),r.available_display_modes.includes(T.DISPLAY_MODE_TILES)&&o.push({icon:"pi-microsoft",help:t.i18n.t("Tiles view"),value:T.DISPLAY_MODE_TILES}),r.available_display_modes.includes(T.DISPLAY_MODE_STORY)&&o.push({icon:"pi-map",help:t.i18n.t("Story view"),value:T.DISPLAY_MODE_STORY}),r.available_display_modes.includes(T.DISPLAY_MODE_GALLERY)&&o.push({icon:"pi-clone",help:t.i18n.t("Gallery view"),value:T.DISPLAY_MODE_GALLERY}),r.available_display_modes.includes(T.DISPLAY_MODE_CARDS)&&o.push({icon:"pi-th-large",help:t.i18n.t("Card view"),value:T.DISPLAY_MODE_CARDS}),n.isSlave&&o.push({icon:"pi-eject",help:t.i18n.t("Expand this panel to own window"),value:"external"}),l(o)}},[t.ready,e.hasDetail]),t.ready?y.createElement(t.prSelectButton.SelectButton,{itemTemplate:function(e){return y.createElement("i",{title:e.help,className:"pi "+e.icon})},onChange:function(e){return r(e.value,e)},options:a,style:{float:"right"},value:e[T.URL_PARAM_DISPLAY_MODE]}):null}(0,C.RegisterImportPool)(U);var j=function(e){function t(e){var n,r,i,l;return(0,o.A)(this,t),r=this,i=t,l=[e],i=(0,c.A)(i),(n=(0,a.A)(r,w()?Reflect.construct(i,l||[],(0,c.A)(r).constructor):i.apply(r,l))).state=B(B({},n.state),{},{query:e.query||"",key:"whatev"}),n.renderActionBar=n.renderActionBar.bind(n),n.renderDataViewSortButton=n.renderDataViewSortButton.bind(n),n.renderDetailNavigator=n.renderDetailNavigator.bind(n),n.renderEditorButton=n.renderEditorButton.bind(n),n.renderParamValueControls=n.renderParamValueControls.bind(n),n.renderQuickFilter=n.renderQuickFilter.bind(n),n.renderToggle_colControls=n.renderToggle_colControls.bind(n),n}return(0,l.A)(t,e),(0,i.A)(t,[{key:"prepare",value:(n=(0,r.A)(A().mark(function e(){return A().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=1,k(t,"prepare",this,3)([]);case 1:this.ex.i18n=this.ex.i18n.default;case 2:case"end":return e.stop()}},e,this)})),function(){return n.apply(this,arguments)})},{key:"onReady",value:function(){this.controller=new this.ex.AbortController.default}},{key:"renderActionBar",value:function(e,t){var n=this.context.controller.static.actorData,r=this.context.controller.APP;return y.createElement(this.ex.bb.LinoBbar,{onSide:e,nonCollapsibles:t,action_full_name:this.context[T.URL_PARAM_DISPLAY_MODE]===T.DISPLAY_MODE_DETAIL?n.default_action.endsWith(".show")?n.default_action:n.detail_action:n.grid_action||r.state.site_data.common_actions.show_table})}},{key:"renderDataViewSortButton",value:function(){var e=this;if(this.context[T.URL_PARAM_DISPLAY_MODE]!==T.DISPLAY_MODE_DETAIL){var t=this.context.controller.static.actorData,n=t.col.map(function(n){return{label:n.name,value:String(n.fields_index),command:function(n){var r=parseInt(n.item.value);e.context.controller.history.replace((0,p.A)((0,p.A)((0,p.A)((0,p.A)({},T.URL_PARAM_SORT,t.col.filter(function(e){return e.fields_index===r})[0].name),T.URL_PARAM_SORTDIR,"DESC"),"sortField",r),"sortOrder",1))}}});return y.createElement(this.ex.prSplitButton.SplitButton,{icon:0===this.context.sortOrder?"pi pi-sort-alt":1===this.context.sortOrder?"pi pi-sort-amount-up":"pi pi-sort-amount-down",label:this.ex.i18n.t("Sort by {{value}}",{value:this.context[T.URL_PARAM_SORT]||""}),model:n,onClick:function(){var t=1===e.context.sortOrder?-1:1;e.context.controller.history.replace((0,p.A)((0,p.A)({},T.URL_PARAM_SORTDIR,1===t?"DESC":"ASC"),"sortOrder",t))},style:{verticalAlign:"bottom"}})}}},{key:"renderDetailNavigator",value:function(){var e=this;if(this.context[T.URL_PARAM_DISPLAY_MODE]!==T.DISPLAY_MODE_DETAIL)return null;var t=this.context.controller.dataContext.mutableContext.navinfo,n=this.props.parent.state.loading,r=function(t){e.props.parent.LinoDetail.navigate(t)};return t&&y.createElement(y.Fragment,null,y.createElement(this.ex.prButton.Button,{disabled:n||null===t.prev,className:"l-nav-first",icon:"pi pi-angle-double-left",onClick:function(){return r("first")}}),y.createElement(this.ex.prButton.Button,{disabled:n||null===t.prev,className:"l-nav-prev",icon:"pi pi-angle-left",onClick:function(){return r("prev")}}),y.createElement(this.ex.prButton.Button,{disabled:n||null===t.next,className:"l-nav-next",icon:"pi pi-angle-right",onClick:function(){return r("next")}}),y.createElement(this.ex.prButton.Button,{disabled:n||null===t.next,className:"l-nav-last",icon:"pi pi-angle-double-right",onClick:function(){return r("last")}}))}},{key:"renderEditorButton",value:function(){var e=this,t=this.context.controller,n=t.static.actorData;return this.context[T.URL_PARAM_DISPLAY_MODE]!==T.DISPLAY_MODE_DETAIL||!n.editable||n.edit_safe||t.dataContext.contextBackup.disable_editing?null:y.createElement(this.ex.prToggleButton.ToggleButton,{checked:!this.context.editing_mode,className:"l-bbar-editor-button",onChange:function(){e.ex.u.toggleEditingMode(e.context)},onLabel:"",offLabel:"",offIcon:"pi pi-times",onIcon:"pi pi-pencil",tooltip:this.context.editing_mode?this.ex.i18n.t("Cancel"):this.ex.i18n.t("Edit"),tooltipOptions:{position:"bottom"}})}},{key:"renderParamValueControls",value:function(){return y.createElement(this.ex.tbc.ParamsPanelControl,null)}},{key:"renderQuickFilter",value:function(e){var t=this;return y.createElement("span",{onKeyDown:function(e){"Delete"===e.code&&e.stopPropagation()}},this.context[T.URL_PARAM_DISPLAY_MODE]===T.DISPLAY_MODE_DETAIL?y.createElement(this.ex.ac.QuickFilter,{urlParams:this.context,wide:!!e}):y.createElement(this.ex.prInputText.InputText,{className:"l-grid-quickfilter",onChange:function(e){var n=e.target.value;t.setState({query:n}),t.props.parent.quickFilter({query:n})},placeholder:this.ex.i18n.t("Quick search"),ref:function(e){e&&t.context.controller.globals.currentInputWindowType===T.WINDOW_TYPE_UNKNOWN&&0===t.context.controller.globals.currentInputIndex&&e.focus()},style:{width:e?"100%":void 0,marginRight:e?"1ch":void 0,marginLeft:e?"1ch":void 0},value:this.state.query}))}},{key:"renderToggle_colControls",value:function(){var e=this;return this.context[T.URL_PARAM_DISPLAY_MODE]!==T.DISPLAY_MODE_TABLE?null:y.createElement(y.Fragment,null,y.createElement(this.ex.prButton.Button,{icon:"pi pi-list",onClick:function(t){return e.col_selector_op.toggle(t)},tooltip:this.ex.i18n.t("Configure visibility of the grid columns"),tooltipOptions:{position:"bottom"}}),y.createElement(this.ex.prOverlayPanel.OverlayPanel,{onHide:function(){return e.col_selector.hide()},onShow:function(){return e.col_selector.show()},ref:function(t){return e.col_selector_op=t}},y.createElement(this.ex.prMultiSelect.MultiSelect,{display:"chip",filter:!0,onChange:function(t){var n=new Map;t.value.forEach(function(t){n.set(t,e.context.controller.static.actorData.col.find(function(e){return e.fields_index===t}).name)}),e.context.controller.history.replace({showableColumns:n}),e.props.parent.GridElement.set_cols()},onHide:function(){return e.col_selector_op.hide()},options:this.context.controller.static.actorData.col.map(function(e){return{label:e.name,value:e.fields_index}}),panelStyle:{zIndex:"99999",height:"auto",width:"auto",position:"absolute"},ref:function(t){return e.col_selector=t},style:{maxWidth:"90vw"},value:Array.from(this.context.showableColumns.keys())})))}},{key:"render",value:function(){if(!this.state.ready)return null;var e=this.context.controller.static.actorData;return y.createElement(y.Fragment,{key:this.state.key},this.context.toolbarState==T.TOOLBAR_STATE_VISIBLE?y.createElement(y.Fragment,null,y.createElement("div",{className:"table-header"},y.createElement("div",{className:"l-bbar-left",style:{background:"transparent"}},!e.hide_navigator&&y.createElement(y.Fragment,null,this.renderQuickFilter(),this.renderParamValueControls(),this.context[T.URL_PARAM_DISPLAY_MODE]!==T.DISPLAY_MODE_TABLE?this.renderDataViewSortButton():this.renderToggle_colControls(),this.renderDetailNavigator()),this.renderActionBar(!1),this.renderEditorButton()),y.createElement(F,null))):this.props.side?y.createElement(y.Fragment,null,!e.hide_navigator&&y.createElement(y.Fragment,null,this.renderDetailNavigator(),this.context[T.URL_PARAM_DISPLAY_MODE]===T.DISPLAY_MODE_TABLE&&this.renderToggle_colControls()),this.renderActionBar(!0),this.renderEditorButton()):!e.hide_top_toolbar&&this.context.toolbarState==T.TOOLBAR_STATE_PARTIALLY_VISIBLE&&y.createElement(y.Fragment,null,y.createElement("div",{className:"table-header"},y.createElement("div",{className:"l-bbar-left",style:{background:"transparent"}},!e.hide_navigator&&y.createElement(y.Fragment,null,this.renderQuickFilter(),this.renderParamValueControls(),this.context[T.URL_PARAM_DISPLAY_MODE]!==T.DISPLAY_MODE_TABLE&&this.renderDataViewSortButton()),this.renderActionBar(!1,!0)),y.createElement(F,null))),!this.props.side&&y.createElement(this.ex.lm.LinoProgressBar,{loading:this.props.parent.state.loading}))}}]);var n}(C.Component);j.requiredModules=["AbortController","prButton","prInputText","prOverlayPanel","prMultiSelect","prSplitButton","prToggleButton","bb","lm","u","ac","i18n","tbc"],j.iPool=U,j.contextType=C.URLContextType,j.propTypes={side:R().bool,parent:R().object.isRequired,query:R().string},j.defaultProps={side:!1}},8462:(e,t,n)=>{n.d(t,{A:()=>l});var r=n(1354),o=n.n(r),i=n(6314),a=n.n(i)()(o());a.push([e.id,".l-header {\n    padding: 3px;\n    border: 1px solid #8080804d;\n}\n.l-whitewall-body-container .p-button.p-component {\n    /* color: #ffffff70; */\n}\n.l-whitewall-body-container .p-inputtext {\n    /* background: transparent;\n    color: unset; */\n}\n","",{version:3,sources:["webpack://./lino_react/react/components/LinoToolbar.css"],names:[],mappings:"AAAA;IACI,YAAY;IACZ,2BAA2B;AAC/B;AACA;IACI,sBAAsB;AAC1B;AACA;IACI;mBACe;AACnB",sourcesContent:[".l-header {\n    padding: 3px;\n    border: 1px solid #8080804d;\n}\n.l-whitewall-body-container .p-button.p-component {\n    /* color: #ffffff70; */\n}\n.l-whitewall-body-container .p-inputtext {\n    /* background: transparent;\n    color: unset; */\n}\n"],sourceRoot:""}]);const l=a}}]);
//# sourceMappingURL=main.LinoToolbar_LinoComponents.85be8114a5c0fdccfbde.js.map