{"version":3,"file":"main.LinoBbar_LinoDialog.4c9601b3a25047e1b6df.js","mappings":"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","sources":["webpack://lino_react/./lino_react/react/components/LinoBbar.css?9ad2","webpack://lino_react/./lino_react/react/components/LinoBbar.jsx","webpack://lino_react/./lino_react/react/components/LinoBbar.css"],"sourcesContent":["\n      import API from \"!../../../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js\";\n      import domAPI from \"!../../../node_modules/style-loader/dist/runtime/styleDomAPI.js\";\n      import insertFn from \"!../../../node_modules/style-loader/dist/runtime/insertBySelector.js\";\n      import setAttributes from \"!../../../node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js\";\n      import insertStyleElement from \"!../../../node_modules/style-loader/dist/runtime/insertStyleElement.js\";\n      import styleTagTransformFn from \"!../../../node_modules/style-loader/dist/runtime/styleTagTransform.js\";\n      import content, * as namedExport from \"!!../../../node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[0].oneOf[4].use[1]!./LinoBbar.css\";\n      \n      \n\nvar options = {};\n\noptions.styleTagTransform = styleTagTransformFn;\noptions.setAttributes = setAttributes;\noptions.insert = insertFn.bind(null, \"head\");\noptions.domAPI = domAPI;\noptions.insertStyleElement = insertStyleElement;\n\nvar update = API(content, options);\n\n\n\nexport * from \"!!../../../node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[0].oneOf[4].use[1]!./LinoBbar.css\";\n       export default content && content.locals ? content.locals : undefined;\n","export const name = \"LinoBbar\";\n\nimport \"./LinoBbar.css\";\n\nimport * as constants from './constants';\nimport React from \"react\";\nimport PropTypes from \"prop-types\";\nimport { RegisterImportPool, Component, URLContextType } from \"./Base\";\n\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\nlet ex; const exModulePromises = ex = {\n    _: import(/* webpackChunkName: \"lodash_LinoBbar\" */\"lodash\"),\n    prButton: import(/* webpackChunkName: \"prButton_LinoBbar\" */\"primereact/button\"),\n    prSplitButton: import(/* webpackChunkName: \"prSplitButton_LinoBbar\" */\"primereact/splitbutton\"),\n    i18n: import(/* webpackChunkName: \"i18n_LinoBbar\" */\"./i18n\"),\n};RegisterImportPool(ex);\n\n\nexport class LinoBbar extends Component {\n    static requiredModules = [\"prButton\", \"prSplitButton\", \"_\", \"i18n\"];\n    static iPool = ex;\n\n    static contextType = URLContextType;\n\n    static propTypes = {\n        action_full_name: PropTypes.string.isRequired,\n        nonCollapsibles: PropTypes.bool,\n        onSide: PropTypes.bool,\n        resetable: PropTypes.bool,\n    }\n    static defaultProps = {\n        nonCollapsibles: false,\n        onSide: false,\n        resetable: true,\n    }\n\n    async prepare() {\n        await super.prepare();\n        this.ex.i18n = this.ex.i18n.default;\n    }\n\n    constructor(props) {\n        super(props);\n        this.state = {...this.state, overflowShow: false};\n        this.action2buttonProps = this.action2buttonProps.bind(this);\n        this.render_buttons = this.render_buttons.bind(this);\n        this.render_overflow = this.render_overflow.bind(this);\n        this.render_actionbutton = this.render_actionbutton.bind(this);\n        this.render_splitActionButton = this.render_splitActionButton.bind(this);\n        this.runAction = this.runAction.bind(this);\n    }\n\n    runAction(action, tba, event) {\n        if (tba.js_handler) {\n            eval(tba.js_handler);\n            return\n        }\n\n        let runnable = {\n            action_full_name: tba[constants.URL_PARAM_ACTION_NAME],\n            actorId: this.context.controller.static.actorData.id,\n            pollContext: true,\n        }\n\n        if (Object.prototype.hasOwnProperty.call(action, 'actor')) {\n            if (action.actor !== runnable.actorId) runnable.pollContext = false;\n            runnable.actorId = action.actor;\n        }\n        if (action.select_rows) runnable[constants.URL_PARAM_SELECTED] = this.context[constants.URL_PARAM_SELECTED];\n        if (event.ctrlKey) runnable.clickCatch = true;\n        this.context.controller.actionHandler.checkAndRunAction(runnable);\n    }\n\n    render_overflow() {\n        return <div>\n            <this.ex.prButton.Button icon={\"pi pi-ellipsis-v\"} onClick={this.setState({overflowShow: !this.state.overflowShow})}/>\n            <div>\n\n            </div>\n        </div>\n    }\n\n    action2buttonProps(tba, action, bbar) {\n        let icon_and_label = {label: action.label, className: `l-button-${action[constants.URL_PARAM_ACTION_NAME]}`};\n        if (action.icon) {\n            icon_and_label.icon = action.icon;\n            icon_and_label.label = bbar ? undefined : icon_and_label.label;\n        }\n        else if (action.button_text) {\n            icon_and_label.label = action.button_text;\n            if (action.button_text.length === 1) {\n                icon_and_label.style = {fontSize: \"1.2rem\"}\n            }\n        }\n        icon_and_label.disabled = (\n            (action.select_rows && this.context[constants.URL_PARAM_SELECTED]\n                && this.context[constants.URL_PARAM_SELECTED].length === 0\n            )\n            || this.context.controller.disabled(action[constants.URL_PARAM_ACTION_NAME])\n            || (action[constants.URL_PARAM_ACTION_NAME] === 'submit_detail' && !this.context.editing_mode)\n            || (this.props.onSide && !action.show_in_side_toolbar && action[constants.URL_PARAM_ACTION_NAME] !== 'submit_detail')\n            || (this.props.nonCollapsibles && !action.never_collapse)\n        );\n        icon_and_label.tooltip = tba.help_text || action.label;\n        icon_and_label.tooltipOptions = {position: this.props.onSide ? 'left' : 'bottom'};\n\n        return icon_and_label;\n    }\n\n    render_actionbutton(tba) {\n        let {action} = this.context.controller.actionHandler.getAction(tba[constants.URL_PARAM_ACTION_NAME], false);\n        if (action) {\n            let icon_and_label = this.action2buttonProps(tba, action, true);\n            if (icon_and_label.disabled) return\n            return <this.ex.prButton.Button {...icon_and_label}\n                key={Math.random()}\n                onClick={(e) => this.runAction(action, tba, e)}/>\n        }\n    }\n\n    render_splitActionButton(combo) {\n        let actionArray = combo.menu.map(\n            n => this.context.controller.actionHandler.getAction(n[constants.URL_PARAM_ACTION_NAME], false).action);\n        if (actionArray[0]) {\n            let model = actionArray.map((action, i) => {\n                let props = this.action2buttonProps(combo.menu[i], action, i === 0);\n                props.command = (e) => this.runAction(action, combo.menu[i], e);\n                return props;\n            });\n            let icon_and_label = this.ex._.default.cloneDeep(model[0]);\n            if (icon_and_label.disabled) return\n            let command = icon_and_label.command;\n            delete icon_and_label.command;\n            // if (model.length === 1) return <this.ex.prButton.Button\n            //     {...icon_and_label}\n            //     key={Math.random()}\n            //     onClick={command}/>\n            return <this.ex.prSplitButton.SplitButton\n                {...icon_and_label}\n                key={Math.random()}\n                model={model}\n                onClick={command}/>\n        }\n    }\n\n    render_buttons() {\n        let ba = this.context.controller.static.actorData.actions_list.find(ba => ba[constants.URL_PARAM_ACTION_NAME] === this.props.action_full_name);\n        if (!ba) return;\n        let tbas = ba.toolbarActions;\n        return tbas && tbas.map((tba) => {\n            if (tba.combo && tba.menu.length > 1) {\n                return this.render_splitActionButton(tba);\n            } else if (tba.combo) {\n                return this.render_actionbutton(tba.menu[0]);\n            } else {\n                return this.render_actionbutton(tba);\n            }\n        })\n    }\n\n    render() {\n        if (!this.state.ready) return null;\n        return <React.Fragment>\n            {this.props.resetable && <this.ex.prButton.Button\n                icon=\"pi pi-refresh\"\n                onClick={() => {\n                    const { actionHandler } = this.context.controller;\n                    actionHandler.refreshChildren([actionHandler.context]);\n                }}\n                tooltip={this.ex.i18n.t(\"Reload this view from the underlying database\")}\n                tooltipOptions={{position: \"bottom\"}}/>}\n            {this.render_buttons()}\n        </React.Fragment>\n    }\n};\n","// Imports\nimport ___CSS_LOADER_API_SOURCEMAP_IMPORT___ from \"../../../node_modules/css-loader/dist/runtime/sourceMaps.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../../node_modules/css-loader/dist/runtime/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, `.l-bbar .hidden{\n    opacity: 0;\n}\n.p-inputtext.p-component {\n    padding: 0.3rem 0.3rem;\n}\n.p-component.p-button {\n    color: var(--text-color);\n    border: 0;\n    padding: 0.3rem 0.3rem;\n    vertical-align: middle;\n    font-size: 0.85rem;\n}\n.p-togglebutton .p-button .p-button-icon-left {\n    color: var(--text-color);\n}\n.p-component.p-button:not(.p-highlight) {\n    background: transparent;\n}\n.p-component.p-button.p-button-icon-only {\n    width: 1.6rem;\n    padding: 0.3rem;\n}\n.p-button.p-button-icon-only .pi {\n    font-size: 0.85rem;\n}\n.p-splitbutton.p-component {\n    vertical-align: middle;\n}\n.p-progress-spinner .p-progress-spinner-circle {\n    stroke-linecap: butt;\n}\n`, \"\",{\"version\":3,\"sources\":[\"webpack://./lino_react/react/components/LinoBbar.css\"],\"names\":[],\"mappings\":\"AAAA;IACI,UAAU;AACd;AACA;IACI,sBAAsB;AAC1B;AACA;IACI,wBAAwB;IACxB,SAAS;IACT,sBAAsB;IACtB,sBAAsB;IACtB,kBAAkB;AACtB;AACA;IACI,wBAAwB;AAC5B;AACA;IACI,uBAAuB;AAC3B;AACA;IACI,aAAa;IACb,eAAe;AACnB;AACA;IACI,kBAAkB;AACtB;AACA;IACI,sBAAsB;AAC1B;AACA;IACI,oBAAoB;AACxB\",\"sourcesContent\":[\".l-bbar .hidden{\\n    opacity: 0;\\n}\\n.p-inputtext.p-component {\\n    padding: 0.3rem 0.3rem;\\n}\\n.p-component.p-button {\\n    color: var(--text-color);\\n    border: 0;\\n    padding: 0.3rem 0.3rem;\\n    vertical-align: middle;\\n    font-size: 0.85rem;\\n}\\n.p-togglebutton .p-button .p-button-icon-left {\\n    color: var(--text-color);\\n}\\n.p-component.p-button:not(.p-highlight) {\\n    background: transparent;\\n}\\n.p-component.p-button.p-button-icon-only {\\n    width: 1.6rem;\\n    padding: 0.3rem;\\n}\\n.p-button.p-button-icon-only .pi {\\n    font-size: 0.85rem;\\n}\\n.p-splitbutton.p-component {\\n    vertical-align: middle;\\n}\\n.p-progress-spinner .p-progress-spinner-circle {\\n    stroke-linecap: butt;\\n}\\n\"],\"sourceRoot\":\"\"}]);\n// Exports\nexport default ___CSS_LOADER_EXPORT___;\n"],"names":["options","styleTagTransform","setAttributes","insert","domAPI","insertStyleElement","locals","name","ex","exModulePromises","_","prButton","prSplitButton","i18n","RegisterImportPool","LinoBbar","_Component","props","_this","_classCallCheck","_callSuper","state","_objectSpread","overflowShow","action2buttonProps","bind","render_buttons","render_overflow","render_actionbutton","render_splitActionButton","runAction","_inherits","_createClass","key","value","_prepare","_asyncToGenerator","_regeneratorRuntime","_callee","_context","prev","next","_superPropGet","this","stop","apply","arguments","action","tba","event","js_handler","eval","runnable","action_full_name","constants","actorId","context","controller","actorData","id","pollContext","Object","prototype","hasOwnProperty","call","actor","select_rows","ctrlKey","clickCatch","actionHandler","checkAndRunAction","React","Button","icon","onClick","setState","bbar","icon_and_label","label","className","concat","undefined","button_text","length","style","fontSize","disabled","editing_mode","onSide","show_in_side_toolbar","nonCollapsibles","never_collapse","tooltip","help_text","tooltipOptions","position","_this2","getAction","_extends","Math","random","e","combo","_this3","actionArray","menu","map","n","model","i","command","cloneDeep","SplitButton","_this4","ba","actions_list","find","tbas","toolbarActions","_this5","ready","resetable","refreshChildren","t","Component","requiredModules","iPool","contextType","URLContextType","propTypes","PropTypes","isRequired","defaultProps","___CSS_LOADER_EXPORT___","push","module"],"ignoreList":[],"sourceRoot":""}