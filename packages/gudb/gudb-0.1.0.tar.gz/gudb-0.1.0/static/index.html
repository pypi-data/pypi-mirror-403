<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI-DB-Sentinel Command Center</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>

<body>

    <div class="dashboard-container">
        <!-- TOP NAV -->
        <nav class="top-nav">
            <div class="brand">
                <div class="logo-icon">S</div>
                <div class="brand-name">AI-DB-SENTINEL</div>
            </div>
            <div class="system-status">
                <span class="status-dot"></span>
                Middleware: Active
            </div>
        </nav>

        <!-- KPI ROW -->
        <div class="kpi-card">
            <div class="kpi-header">Health Score</div>
            <div class="kpi-main">
                <div class="kpi-value">98<span style="font-size:1rem;color:var(--text-secondary)">%</span></div>
                <div class="kpi-sub">System Nominal</div>
            </div>
            <!-- Simple SVG Donut -->
            <svg height="60" width="60" style="position:absolute; right:20px; top:20px; opacity:0.5;">
                <circle cx="30" cy="30" r="25" stroke="#30363D" stroke-width="5" fill="none" />
                <circle cx="30" cy="30" r="25" stroke="#10B981" stroke-width="5" fill="none" stroke-dasharray="100 100"
                    stroke-dashoffset="10" />
            </svg>
        </div>

        <div class="kpi-card">
            <div class="kpi-header">Circuit Breaker</div>
            <div class="kpi-main">
                <div style="display:flex; align-items:center;">
                    <div class="status-pill safe" id="bouncerStatus">
                        <i class="fas fa-shield-alt"></i> Monitoring
                    </div>
                </div>
            </div>
        </div>

        <div class="kpi-card">
            <div class="kpi-header">Optimizations (24h)</div>
            <div class="kpi-main">
                <div class="kpi-value">1,240</div>
                <div style="height:30px; width:60px; display:flex; align-items:end; gap:2px;">
                    <!-- Micro sparkline bars -->
                    <div style="width:10px; height:40%; background:var(--emerald)"></div>
                    <div style="width:10px; height:60%; background:var(--emerald)"></div>
                    <div style="width:10px; height:50%; background:var(--emerald)"></div>
                    <div style="width:10px; height:90%; background:var(--emerald)"></div>
                    <div style="width:10px; height:70%; background:var(--emerald)"></div>
                </div>
            </div>
        </div>

        <!-- MAIN FEED -->
        <div class="feed-container">
            <div class="section-title">REAL-TIME INSIGHTS</div>
            <div id="feedList">
                <!-- Cards Injected Here -->
                <div style="text-align:center; padding:40px; color:var(--text-secondary)">
                    Waiting for query events...
                </div>
            </div>
        </div>

        <!-- SIDEBAR WIDGETS -->
        <aside class="sidebar-widgets">
            <div class="widget-card">
                <div class="kpi-header" style="margin-bottom:20px;">LangGraph Live Brain</div>

                <div class="brain-visualizer">
                    <div class="connector c1" id="conn1"></div>
                    <div class="connector c2" id="conn2"></div>

                    <div class="node" id="nodeDetective" title="Detective: Analyzing Plan">
                        <i class="fas fa-search"></i>
                    </div>
                    <div class="node" id="nodeArchitect" title="Architect: Reasoning with Gemini">
                        <i class="fas fa-brain"></i>
                    </div>
                    <div class="node" id="nodeValidator" title="Validator: Safety Check">
                        <i class="fas fa-shield-check"></i>
                    </div>
                </div>

                <div class="section-title" style="margin-top:20px;">THOUGHT STREAM</div>
                <div class="terminal-log" id="thoughtLog">
                    <div class="log-entry">> System ready.</div>
                    <div class="log-entry">> Listening for slow queries...</div>
                </div>
            </div>
        </aside>

    </div>

    <!-- DEEP DIVE MODAL -->
    <div class="modal-overlay" id="detailModal">
        <div class="modal-window">

            <!-- LEFT: VISUALIZATION -->
            <div class="visual-panel">
                <div class="section-title">EXECUTION PLAN</div>
                <div id="planTree">
                    <!-- Tree Nodes Injected JS -->
                </div>
            </div>

            <!-- RIGHT: INTELLIGENCE -->
            <div class="intel-panel" id="intelContent">
                <!-- Injected via JS -->
                <div class="skeleton title"></div>
                <div class="skeleton text"></div>
                <div class="skeleton text"></div>
                <div class="skeleton text"></div>
            </div>

        </div>
    </div>

    <!-- Toast Container -->
    <div id="toast-container" style="position:fixed; bottom:20px; right:20px; z-index:2000;"></div>

    <script src="https://cdn.socket.io/4.7.5/socket.io.min.js"></script>
    <script>
        // Dynamically load app.js with cache busting
        const script = document.createElement('script');
        script.src = 'app.js?v=' + Date.now();
        document.body.appendChild(script);
    </script>
</body>

</html>