# generated by datamodel-codegen:
#   filename:  <stdin>
#   timestamp: 2026-01-29T15:05:21+00:00

from __future__ import annotations

from datetime import datetime
from enum import IntEnum, StrEnum
from typing import Annotated, Dict, List, Optional, Union

from pydantic import AnyUrl, ConfigDict, Field, RootModel

from .base_model import BaseModelSdk, RootModelSdk


class ApiKeyCredentials(BaseModelSdk):
    api_key: Annotated[
        str, Field(description='API key for the integration', title='Api Key')
    ]


class BasicAuthCredentials(BaseModelSdk):
    username: Annotated[
        str,
        Field(description='Basic auth username for the integration', title='Username'),
    ]
    password: Annotated[
        str,
        Field(description='Basic auth password for the integration', title='Password'),
    ]


class BlocklistSubscription(BaseModelSdk):
    id: Annotated[str, Field(title='Id')]
    remediation: Annotated[Optional[str], Field(title='Remediation')] = None


class CVESubscription(BaseModelSdk):
    id: Annotated[str, Field(description='CVE ID', title='Id')]


class IntegrationType(StrEnum):
    FIREWALL_INTEGRATION = 'firewall_integration'
    REMEDIATION_COMPONENT_INTEGRATION = 'remediation_component_integration'


class Links(BaseModelSdk):
    first: Annotated[
        Optional[str], Field(examples=['/api/v1/users?limit=1&offset1'], title='First')
    ] = None
    last: Annotated[
        Optional[str], Field(examples=['/api/v1/users?limit=1&offset1'], title='Last')
    ] = None
    self: Annotated[
        Optional[str], Field(examples=['/api/v1/users?limit=1&offset1'], title='Self')
    ] = None
    next: Annotated[
        Optional[str], Field(examples=['/api/v1/users?limit=1&offset1'], title='Next')
    ] = None
    prev: Annotated[
        Optional[str], Field(examples=['/api/v1/users?limit=1&offset1'], title='Prev')
    ] = None


class OutputFormat(StrEnum):
    PLAIN_TEXT = 'plain_text'
    F5 = 'f5'
    REMEDIATION_COMPONENT = 'remediation_component'
    FORTIGATE = 'fortigate'
    PALOALTO = 'paloalto'
    CHECKPOINT = 'checkpoint'
    CISCO = 'cisco'
    JUNIPER = 'juniper'
    MIKROTIK = 'mikrotik'
    PFSENSE = 'pfsense'
    OPNSENSE = 'opnsense'
    SOPHOS = 'sophos'


class Stats(BaseModelSdk):
    count: Annotated[
        int,
        Field(
            description='Number of total blocklists items the integration will pull',
            title='Count',
        ),
    ]


class ValidationError(BaseModelSdk):
    loc: Annotated[List[Union[str, int]], Field(title='Location')]
    msg: Annotated[str, Field(title='Message')]
    type: Annotated[str, Field(title='Error Type')]


class AffectedComponent(BaseModelSdk):
    vendor: Annotated[
        Optional[str],
        Field(description='Vendor of the affected component', title='Vendor'),
    ] = None
    product: Annotated[
        Optional[str],
        Field(description='Product name of the affected component', title='Product'),
    ] = None


class AllowlistSubscription(BaseModelSdk):
    id: Annotated[str, Field(title='Id')]


class AttackDetail(BaseModelSdk):
    name: Annotated[str, Field(description='Attack detail name', title='Name')]
    label: Annotated[str, Field(description='Attack detail label', title='Label')]
    description: Annotated[
        str, Field(description='Attack detail description', title='Description')
    ]
    references: Annotated[
        Optional[List[str]],
        Field(description='Attack detail references', title='References'),
    ] = None


class Behavior(BaseModelSdk):
    name: Annotated[str, Field(description='Behavior name', title='Name')]
    label: Annotated[str, Field(description='Behavior label', title='Label')]
    description: Annotated[
        str, Field(description='Behavior description', title='Description')
    ]


class CVEEvent(BaseModelSdk):
    date: Annotated[datetime, Field(description='Date of the event', title='Date')]
    description: Annotated[
        str, Field(description='Description of the event', title='Description')
    ]
    label: Annotated[str, Field(description='Label of the event', title='Label')]
    name: Annotated[str, Field(description='Name of the event', title='Name')]


class CvssScore(RootModelSdk[float]):
    root: Annotated[
        float,
        Field(description='CVSS score of the CVE', ge=0.0, le=10.0, title='Cvss Score'),
    ]


class CVEResponseBase(BaseModelSdk):
    id: Annotated[str, Field(description='ID of the CVE', title='Id')]
    name: Annotated[str, Field(description='Name of the CVE', title='Name')]
    title: Annotated[str, Field(description='Title of the CVE', title='Title')]
    affected_components: Annotated[
        List[AffectedComponent],
        Field(description='List of affected components', title='Affected Components'),
    ]
    crowdsec_score: Annotated[
        int,
        Field(
            description='Live Exploit Tracker score of the CVE',
            ge=0,
            le=10,
            title='Crowdsec Score',
        ),
    ]
    opportunity_score: Annotated[
        Optional[int],
        Field(
            description="Opportunity score indicating if it's an opportunistic(0) or targeted(5) attack (between 0-5)",
            ge=0,
            le=5,
            title='Opportunity Score',
        ),
    ] = 0
    first_seen: Annotated[
        Optional[datetime], Field(description='First seen date', title='First Seen')
    ] = None
    last_seen: Annotated[
        Optional[datetime], Field(description='Last seen date', title='Last Seen')
    ] = None
    nb_ips: Annotated[
        int, Field(description='Number of unique IPs affected', ge=0, title='Nb Ips')
    ]
    published_date: Annotated[
        datetime, Field(description='Published date of the CVE', title='Published Date')
    ]
    cvss_score: Annotated[
        Optional[CvssScore],
        Field(description='CVSS score of the CVE', title='Cvss Score'),
    ] = None
    has_public_exploit: Annotated[
        bool,
        Field(
            description='Indicates if there is a public exploit for the CVE',
            title='Has Public Exploit',
        ),
    ]
    rule_release_date: Annotated[
        Optional[datetime],
        Field(
            description='Release date of the associated detection rule',
            title='Rule Release Date',
        ),
    ] = None


class CVEsubscription(BaseModelSdk):
    id: Annotated[str, Field(title='Id')]


class CWE(BaseModelSdk):
    name: Annotated[str, Field(description='Name of the CWE', title='Name')]
    label: Annotated[str, Field(description='Label of the CWE', title='Label')]
    description: Annotated[
        str, Field(description='Description of the CWE', title='Description')
    ]


class Classification(BaseModelSdk):
    name: Annotated[str, Field(description='Classification name', title='Name')]
    label: Annotated[str, Field(description='Classification label', title='Label')]
    description: Annotated[
        str, Field(description='Classification description', title='Description')
    ]


class Classifications(BaseModelSdk):
    false_positives: Annotated[
        Optional[List[Classification]],
        Field(description='False positive classifications', title='False Positives'),
    ] = None
    classifications: Annotated[
        Optional[List[Classification]],
        Field(description='Main classifications', title='Classifications'),
    ] = None


class EntityType(StrEnum):
    ORG = 'org'
    TAG = 'tag'
    ENGINE = 'engine'
    FIREWALL_INTEGRATION = 'firewall_integration'
    REMEDIATION_COMPONENT_INTEGRATION = 'remediation_component_integration'
    REMEDIATION_COMPONENT = 'remediation_component'
    LOG_PROCESSOR = 'log_processor'


class GetCVEResponse(BaseModelSdk):
    id: Annotated[str, Field(description='ID of the CVE', title='Id')]
    name: Annotated[str, Field(description='Name of the CVE', title='Name')]
    title: Annotated[str, Field(description='Title of the CVE', title='Title')]
    affected_components: Annotated[
        List[AffectedComponent],
        Field(description='List of affected components', title='Affected Components'),
    ]
    crowdsec_score: Annotated[
        int,
        Field(
            description='Live Exploit Tracker score of the CVE',
            ge=0,
            le=10,
            title='Crowdsec Score',
        ),
    ]
    opportunity_score: Annotated[
        Optional[int],
        Field(
            description="Opportunity score indicating if it's an opportunistic(0) or targeted(5) attack (between 0-5)",
            ge=0,
            le=5,
            title='Opportunity Score',
        ),
    ] = 0
    first_seen: Annotated[
        Optional[datetime], Field(description='First seen date', title='First Seen')
    ] = None
    last_seen: Annotated[
        Optional[datetime], Field(description='Last seen date', title='Last Seen')
    ] = None
    nb_ips: Annotated[
        int, Field(description='Number of unique IPs affected', ge=0, title='Nb Ips')
    ]
    published_date: Annotated[
        datetime, Field(description='Published date of the CVE', title='Published Date')
    ]
    cvss_score: Annotated[
        Optional[CvssScore],
        Field(description='CVSS score of the CVE', title='Cvss Score'),
    ] = None
    has_public_exploit: Annotated[
        bool,
        Field(
            description='Indicates if there is a public exploit for the CVE',
            title='Has Public Exploit',
        ),
    ]
    rule_release_date: Annotated[
        Optional[datetime],
        Field(
            description='Release date of the associated detection rule',
            title='Rule Release Date',
        ),
    ] = None
    references: Annotated[
        List[str],
        Field(description='List of references for the CVE', title='References'),
    ]
    description: Annotated[
        str, Field(description='Description of the CVE', title='Description')
    ]
    crowdsec_analysis: Annotated[
        Optional[str],
        Field(description='CrowdSec analysis of the CVE', title='Crowdsec Analysis'),
    ] = None
    cwes: Annotated[
        List[CWE],
        Field(description='List of CWEs associated with the CVE', title='Cwes'),
    ]
    events: Annotated[
        Optional[List[CVEEvent]],
        Field(description='List of events related to the CVE', title='Events'),
    ] = None


class GetCVEsFilterBy(StrEnum):
    IS_PUBLIC = 'is_public'


class GetCVEsResponsePage(BaseModelSdk):
    items: Annotated[List[CVEResponseBase], Field(title='Items')]
    total: Annotated[int, Field(ge=0, title='Total')]
    page: Annotated[int, Field(ge=1, title='Page')]
    size: Annotated[int, Field(ge=1, title='Size')]
    pages: Annotated[int, Field(ge=0, title='Pages')]
    links: Links


class GetCVEsSortBy(StrEnum):
    RULE_RELEASE_DATE = 'rule_release_date'
    TRENDING = 'trending'
    NB_IPS = 'nb_ips'
    NAME = 'name'


class GetCVEsSortOrder(StrEnum):
    ASC = 'asc'
    DESC = 'desc'


class History(BaseModelSdk):
    first_seen: Annotated[
        datetime, Field(description='First seen timestamp', title='First Seen')
    ]
    last_seen: Annotated[
        datetime, Field(description='Last seen timestamp', title='Last Seen')
    ]
    full_age: Annotated[int, Field(description='Full age in days', title='Full Age')]
    days_age: Annotated[int, Field(description='Days age', title='Days Age')]


class IntegrationResponse(BaseModelSdk):
    tags: Annotated[Optional[List[str]], Field(title='Tags')] = []
    organization_id: Annotated[str, Field(title='Organization Id')]
    created_at: Annotated[
        Optional[datetime],
        Field(description='Time the integration was created', title='Created At'),
    ] = None
    entity_type: Annotated[EntityType, Field(description='Type of the integration')]
    id: Annotated[
        Optional[str], Field(description='ID of the integration', title='Id')
    ] = None
    blocklists: Annotated[
        Optional[List[BlocklistSubscription]], Field(title='Blocklists')
    ] = []
    allowlists: Annotated[
        Optional[List[AllowlistSubscription]], Field(title='Allowlists')
    ] = []
    cves: Annotated[Optional[List[CVEsubscription]], Field(title='Cves')] = []
    name: Annotated[str, Field(description='Name of the integration', title='Name')]
    updated_at: Annotated[
        Optional[datetime],
        Field(description='Last time the integration was updated', title='Updated At'),
    ] = None
    description: Annotated[
        Optional[str],
        Field(description='Description of the integration', title='Description'),
    ] = None
    output_format: Annotated[
        OutputFormat, Field(description='Output format of the integration')
    ]
    last_pull: Annotated[
        Optional[datetime],
        Field(
            description='Last time the integration pulled blocklists', title='Last Pull'
        ),
    ] = None


class Location(BaseModelSdk):
    country: Annotated[
        Optional[str], Field(description='Country code', title='Country')
    ] = None
    city: Annotated[Optional[str], Field(description='City name', title='City')] = None
    latitude: Annotated[
        Optional[float], Field(description='Latitude coordinate', title='Latitude')
    ] = None
    longitude: Annotated[
        Optional[float], Field(description='Longitude coordinate', title='Longitude')
    ] = None


class MitreTechnique(BaseModelSdk):
    name: Annotated[str, Field(description='MITRE technique ID', title='Name')]
    label: Annotated[str, Field(description='MITRE technique label', title='Label')]
    description: Annotated[
        str, Field(description='MITRE technique description', title='Description')
    ]


class Reference(BaseModelSdk):
    name: Annotated[str, Field(description='Reference name', title='Name')]
    label: Annotated[str, Field(description='Reference label', title='Label')]
    description: Annotated[
        str, Field(description='Reference description', title='Description')
    ]


class ScoreBreakdown(BaseModelSdk):
    aggressiveness: Annotated[
        int, Field(description='Aggressiveness score', title='Aggressiveness')
    ]
    threat: Annotated[int, Field(description='Threat score', title='Threat')]
    trust: Annotated[int, Field(description='Trust score', title='Trust')]
    anomaly: Annotated[int, Field(description='Anomaly score', title='Anomaly')]
    total: Annotated[int, Field(description='Total score', title='Total')]


class Scores(BaseModelSdk):
    overall: Annotated[ScoreBreakdown, Field(description='Overall scores')]
    last_day: Annotated[ScoreBreakdown, Field(description='Last day scores')]
    last_week: Annotated[ScoreBreakdown, Field(description='Last week scores')]
    last_month: Annotated[ScoreBreakdown, Field(description='Last month scores')]


class SinceOptions(IntEnum):
    INTEGER_1 = 1
    INTEGER_7 = 7
    INTEGER_30 = 30


class SubscribeCVEIntegrationRequest(BaseModelSdk):
    model_config = ConfigDict(
        extra='forbid',
    )
    name: Annotated[
        str, Field(description='Name of the integration to subscribe', title='Name')
    ]


class TimelineItem(BaseModelSdk):
    timestamp: Annotated[
        datetime,
        Field(description='Timestamp of the timeline event', title='Timestamp'),
    ]
    count: Annotated[
        int, Field(description='Count of occurrences at the timestamp', title='Count')
    ]


class IntegrationsGetIntegrationsQueryParameters(BaseModelSdk):
    tag: Annotated[
        Optional[List[str]],
        Field(
            description='List of tags associated with the integrations (any of)',
            title='Tag',
        ),
    ] = None


class IntegrationsGetIntegrationPathParameters(BaseModelSdk):
    integration_id: Annotated[str, Field(title='Integration Id')]


class IntegrationsUpdateIntegrationPathParameters(BaseModelSdk):
    integration_id: Annotated[str, Field(title='Integration Id')]


class IntegrationsDeleteIntegrationQueryParameters(BaseModelSdk):
    force: Annotated[
        Optional[bool],
        Field(
            description='Force delete the integration even if it has active subscriptions (it will unsubscribe from all lists)',
            title='Force',
        ),
    ] = False


class IntegrationsDeleteIntegrationPathParameters(BaseModelSdk):
    integration_id: Annotated[str, Field(title='Integration Id')]


class IntegrationsHeadIntegrationContentPathParameters(BaseModelSdk):
    integration_id: Annotated[
        str, Field(examples=['5f9d88b9e5c4f5b9a3d3e8b1'], title='Integration Id')
    ]


class PageSize(RootModelSdk[int]):
    root: Annotated[
        int,
        Field(
            description='Maximum number of items to return, 0 means no limit (default), should be greater than 10000',
            ge=10000,
            title='Page Size',
        ),
    ]


class IntegrationsGetIntegrationContentQueryParameters(BaseModelSdk):
    page: Annotated[
        Optional[int], Field(description='Page number to return', ge=1, title='Page')
    ] = 1
    page_size: Annotated[
        Optional[PageSize],
        Field(
            description='Maximum number of items to return, 0 means no limit (default), should be greater than 10000',
            title='Page Size',
        ),
    ] = None


class IntegrationsGetIntegrationContentPathParameters(BaseModelSdk):
    integration_id: Annotated[
        str, Field(examples=['5f9d88b9e5c4f5b9a3d3e8b1'], title='Integration Id')
    ]


class IntegrationsGetIntegrationContentStreamQueryParameters(BaseModelSdk):
    startup: Annotated[
        Optional[bool],
        Field(
            description="Set to true if it's the first run to fetch all the content, otherwise only changes since the last pull.",
            title='Startup',
        ),
    ] = False


class IntegrationsGetIntegrationContentStreamPathParameters(BaseModelSdk):
    integration_id: Annotated[
        str, Field(examples=['5f9d88b9e5c4f5b9a3d3e8b1'], title='Integration Id')
    ]


class CvesGetCvesQueryParameters(BaseModelSdk):
    query: Annotated[
        Optional[str], Field(description='Search query for CVEs', title='Query')
    ] = None
    sort_by: Annotated[
        Optional[GetCVEsSortBy], Field(description='Field to sort by', title='Sort By')
    ] = 'rule_release_date'
    sort_order: Annotated[
        Optional[GetCVEsSortOrder],
        Field(description='Sort order: ascending or descending', title='Sort Order'),
    ] = 'desc'
    filters: Annotated[
        Optional[List[GetCVEsFilterBy]],
        Field(description='Filters to apply on the CVE list', title='Filters'),
    ] = None
    page: Annotated[
        Optional[int], Field(description='Page number', ge=1, title='Page')
    ] = 1
    size: Annotated[
        Optional[int], Field(description='Page size', ge=1, le=100, title='Size')
    ] = 50


class CvesGetCvePathParameters(BaseModelSdk):
    cve_id: Annotated[str, Field(title='Cve Id')]


class CvesDownloadCveIpsPathParameters(BaseModelSdk):
    cve_id: Annotated[str, Field(title='Cve Id')]


class Since(RootModelSdk[str]):
    root: Annotated[
        str,
        Field(
            description='Filter IPs seen since this date, format duration (e.g., 7d, 24h), default to 14d',
            pattern='^\\d+[hd]$',
            title='Since',
        ),
    ]


class CvesGetCveIpsDetailsQueryParameters(BaseModelSdk):
    since: Annotated[
        Optional[Since],
        Field(
            description='Filter IPs seen since this date, format duration (e.g., 7d, 24h), default to 14d',
            title='Since',
        ),
    ] = '14d'
    page: Annotated[
        Optional[int], Field(description='Page number', ge=1, title='Page')
    ] = 1
    size: Annotated[
        Optional[int], Field(description='Page size', ge=1, le=100, title='Size')
    ] = 50


class CvesGetCveIpsDetailsPathParameters(BaseModelSdk):
    cve_id: Annotated[str, Field(title='Cve Id')]


class CvesSubscribeIntegrationToCvePathParameters(BaseModelSdk):
    cve_id: Annotated[str, Field(title='Cve Id')]


class CvesGetCveSubscribedIntegrationsQueryParameters(BaseModelSdk):
    page: Annotated[
        Optional[int], Field(description='Page number', ge=1, title='Page')
    ] = 1
    size: Annotated[
        Optional[int], Field(description='Page size', ge=1, le=100, title='Size')
    ] = 50


class CvesGetCveSubscribedIntegrationsPathParameters(BaseModelSdk):
    cve_id: Annotated[str, Field(title='Cve Id')]


class CvesUnsubscribeIntegrationFromCvePathParameters(BaseModelSdk):
    cve_id: Annotated[str, Field(title='Cve Id')]
    integration_name: Annotated[str, Field(title='Integration Name')]


class CvesGetCveTimelineQueryParameters(BaseModelSdk):
    since_days: Annotated[
        Optional[SinceOptions],
        Field(
            description='Time range for the timeline data (in days). Options: 1 (1 day), 7 (1 week), 30 (1 month). Default is 7 days.'
        ),
    ] = 7


class CvesGetCveTimelinePathParameters(BaseModelSdk):
    cve_id: Annotated[str, Field(title='Cve Id')]


class HTTPValidationError(BaseModelSdk):
    detail: Annotated[Optional[List[ValidationError]], Field(title='Detail')] = None


class IntegrationCreateRequest(BaseModelSdk):
    model_config = ConfigDict(
        extra='forbid',
    )
    name: Annotated[
        str, Field(description='Name of the integration', min_length=1, title='Name')
    ]
    description: Annotated[
        Optional[str],
        Field(
            description='Description of the integration',
            min_length=1,
            title='Description',
        ),
    ] = None
    entity_type: Annotated[
        IntegrationType, Field(description='Type of the integration')
    ]
    output_format: Annotated[
        OutputFormat, Field(description='Output format of the integration')
    ]


class IntegrationCreateResponse(BaseModelSdk):
    id: Annotated[str, Field(description='ID of the integration', title='Id')]
    name: Annotated[
        str,
        Field(
            description='Name of the integration. Should be unique within the organization',
            title='Name',
        ),
    ]
    organization_id: Annotated[
        str, Field(description='ID of the owner organization', title='Organization Id')
    ]
    description: Annotated[
        Optional[str],
        Field(description='Description of the integration', title='Description'),
    ] = None
    created_at: Annotated[
        datetime,
        Field(description='Time the integration was created', title='Created At'),
    ]
    updated_at: Annotated[
        datetime,
        Field(description='Last time the integration was updated', title='Updated At'),
    ]
    entity_type: Annotated[
        IntegrationType, Field(description='Type of the integration')
    ]
    output_format: Annotated[
        OutputFormat, Field(description='Output format of the integration')
    ]
    last_pull: Annotated[
        Optional[datetime],
        Field(
            description='Last time the integration pulled blocklists', title='Last Pull'
        ),
    ] = None
    blocklists: Annotated[
        List[BlocklistSubscription],
        Field(
            description='Blocklists that are subscribed by the integration',
            title='Blocklists',
        ),
    ]
    cves: Annotated[
        List[CVESubscription],
        Field(description='CVEs that are subscribed by the integration', title='Cves'),
    ]
    endpoint: Annotated[
        AnyUrl,
        Field(
            description="Url that should be used by the firewall or the remediation component to fetch the integration's content",
            title='Endpoint',
        ),
    ]
    stats: Annotated[Optional[Stats], Field(description='Stats of the integration')] = {
        'count': 0
    }
    tags: Annotated[
        Optional[List[str]],
        Field(description='Tags associated with the integration', title='Tags'),
    ] = []
    credentials: Annotated[
        Union[ApiKeyCredentials, BasicAuthCredentials],
        Field(
            description='Credentials that were generated for the integration',
            title='Credentials',
        ),
    ]


class IntegrationGetResponse(BaseModelSdk):
    id: Annotated[str, Field(description='ID of the integration', title='Id')]
    name: Annotated[
        str,
        Field(
            description='Name of the integration. Should be unique within the organization',
            title='Name',
        ),
    ]
    organization_id: Annotated[
        str, Field(description='ID of the owner organization', title='Organization Id')
    ]
    description: Annotated[
        Optional[str],
        Field(description='Description of the integration', title='Description'),
    ] = None
    created_at: Annotated[
        datetime,
        Field(description='Time the integration was created', title='Created At'),
    ]
    updated_at: Annotated[
        datetime,
        Field(description='Last time the integration was updated', title='Updated At'),
    ]
    entity_type: Annotated[
        IntegrationType, Field(description='Type of the integration')
    ]
    output_format: Annotated[
        OutputFormat, Field(description='Output format of the integration')
    ]
    last_pull: Annotated[
        Optional[datetime],
        Field(
            description='Last time the integration pulled blocklists', title='Last Pull'
        ),
    ] = None
    blocklists: Annotated[
        List[BlocklistSubscription],
        Field(
            description='Blocklists that are subscribed by the integration',
            title='Blocklists',
        ),
    ]
    cves: Annotated[
        List[CVESubscription],
        Field(description='CVEs that are subscribed by the integration', title='Cves'),
    ]
    endpoint: Annotated[
        AnyUrl,
        Field(
            description="Url that should be used by the firewall or the remediation component to fetch the integration's content",
            title='Endpoint',
        ),
    ]
    stats: Annotated[Optional[Stats], Field(description='Stats of the integration')] = {
        'count': 0
    }
    tags: Annotated[
        Optional[List[str]],
        Field(description='Tags associated with the integration', title='Tags'),
    ] = []


class IntegrationGetResponsePage(BaseModelSdk):
    items: Annotated[List[IntegrationGetResponse], Field(title='Items')]
    total: Annotated[int, Field(ge=0, title='Total')]
    page: Annotated[int, Field(ge=1, title='Page')]
    size: Annotated[int, Field(ge=1, title='Size')]
    pages: Annotated[int, Field(ge=0, title='Pages')]
    links: Links


class IntegrationUpdateRequest(BaseModelSdk):
    model_config = ConfigDict(
        extra='forbid',
    )
    name: Annotated[
        Optional[str], Field(description='New name', min_length=1, title='Name')
    ] = None
    description: Annotated[
        Optional[str],
        Field(description='New description', min_length=1, title='Description'),
    ] = None
    output_format: Annotated[
        Optional[OutputFormat], Field(description='New output format')
    ] = None
    regenerate_credentials: Annotated[
        Optional[bool],
        Field(
            description='Regenerate credentials for the integration',
            title='Regenerate Credentials',
        ),
    ] = None


class IntegrationUpdateResponse(BaseModelSdk):
    id: Annotated[str, Field(description='ID of the integration', title='Id')]
    name: Annotated[
        str,
        Field(
            description='Name of the integration. Should be unique within the organization',
            title='Name',
        ),
    ]
    organization_id: Annotated[
        str, Field(description='ID of the owner organization', title='Organization Id')
    ]
    description: Annotated[
        Optional[str],
        Field(description='Description of the integration', title='Description'),
    ] = None
    created_at: Annotated[
        datetime,
        Field(description='Time the integration was created', title='Created At'),
    ]
    updated_at: Annotated[
        datetime,
        Field(description='Last time the integration was updated', title='Updated At'),
    ]
    entity_type: Annotated[
        IntegrationType, Field(description='Type of the integration')
    ]
    output_format: Annotated[
        OutputFormat, Field(description='Output format of the integration')
    ]
    last_pull: Annotated[
        Optional[datetime],
        Field(
            description='Last time the integration pulled blocklists', title='Last Pull'
        ),
    ] = None
    blocklists: Annotated[
        List[BlocklistSubscription],
        Field(
            description='Blocklists that are subscribed by the integration',
            title='Blocklists',
        ),
    ]
    cves: Annotated[
        List[CVESubscription],
        Field(description='CVEs that are subscribed by the integration', title='Cves'),
    ]
    endpoint: Annotated[
        AnyUrl,
        Field(
            description="Url that should be used by the firewall or the remediation component to fetch the integration's content",
            title='Endpoint',
        ),
    ]
    stats: Annotated[Optional[Stats], Field(description='Stats of the integration')] = {
        'count': 0
    }
    tags: Annotated[
        Optional[List[str]],
        Field(description='Tags associated with the integration', title='Tags'),
    ] = []
    credentials: Annotated[
        Optional[Union[ApiKeyCredentials, BasicAuthCredentials]],
        Field(description='Credentials for the integration', title='Credentials'),
    ] = None


class GetCVESubscribedIntegrationsResponsePage(BaseModelSdk):
    items: Annotated[List[IntegrationResponse], Field(title='Items')]
    total: Annotated[int, Field(ge=0, title='Total')]
    page: Annotated[int, Field(ge=1, title='Page')]
    size: Annotated[int, Field(ge=1, title='Size')]
    pages: Annotated[int, Field(ge=0, title='Pages')]
    links: Links


class IPItem(BaseModelSdk):
    ip: Annotated[str, Field(description='IP address', title='Ip')]
    reputation: Annotated[
        Optional[str], Field(description='Reputation of the IP', title='Reputation')
    ] = None
    ip_range: Annotated[
        Optional[str], Field(description='IP range', title='Ip Range')
    ] = None
    ip_range_score: Annotated[
        Optional[int], Field(description='IP range score', title='Ip Range Score')
    ] = None
    ip_range_24: Annotated[
        Optional[str], Field(description='IP range /24', title='Ip Range 24')
    ] = None
    ip_range_24_reputation: Annotated[
        Optional[str],
        Field(description='IP range /24 reputation', title='Ip Range 24 Reputation'),
    ] = None
    ip_range_24_score: Annotated[
        Optional[int],
        Field(description='IP range /24 score', title='Ip Range 24 Score'),
    ] = None
    as_name: Annotated[Optional[str], Field(description='AS name', title='As Name')] = (
        None
    )
    as_num: Annotated[Optional[int], Field(description='AS number', title='As Num')] = (
        None
    )
    background_noise_score: Annotated[
        Optional[int],
        Field(description='Background noise score', title='Background Noise Score'),
    ] = None
    background_noise: Annotated[
        Optional[str],
        Field(description='Background noise level', title='Background Noise'),
    ] = None
    confidence: Annotated[
        Optional[str], Field(description='Confidence level', title='Confidence')
    ] = None
    location: Annotated[
        Optional[Location], Field(description='IP location information')
    ] = None
    reverse_dns: Annotated[
        Optional[str], Field(description='Reverse DNS', title='Reverse Dns')
    ] = None
    behaviors: Annotated[
        Optional[List[Behavior]],
        Field(description='List of behaviors', title='Behaviors'),
    ] = None
    references: Annotated[
        Optional[List[Reference]],
        Field(description='List of references', title='References'),
    ] = None
    history: Annotated[Optional[History], Field(description='Historical data')] = None
    classifications: Annotated[
        Optional[Classifications], Field(description='Classification data')
    ] = None
    mitre_techniques: Annotated[
        Optional[List[MitreTechnique]],
        Field(description='MITRE techniques', title='Mitre Techniques'),
    ] = None
    cves: Annotated[
        Optional[List[str]], Field(description='List of CVEs', title='Cves')
    ] = None
    attack_details: Annotated[
        Optional[List[AttackDetail]],
        Field(description='Attack details', title='Attack Details'),
    ] = None
    target_countries: Annotated[
        Optional[Dict[str, int]],
        Field(description='Target countries', title='Target Countries'),
    ] = None
    scores: Annotated[Optional[Scores], Field(description='Scoring information')] = None


class GetCVEIPsResponsePage(BaseModelSdk):
    items: Annotated[List[IPItem], Field(title='Items')]
    total: Annotated[int, Field(ge=0, title='Total')]
    page: Annotated[int, Field(ge=1, title='Page')]
    size: Annotated[int, Field(ge=1, title='Size')]
    pages: Annotated[int, Field(ge=0, title='Pages')]
    links: Links
