{# Page loader - shows during initial page load, auto-hides when fonts are ready #}
{% macro page_loader(color="#6366f1", bg="#f9fafb") %}
<div id="page-loader" style="position:fixed;inset:0;z-index:9999;display:flex;align-items:center;justify-content:center;background:{{ bg }};transition:opacity 0.2s ease-out;">
    <div style="width:40px;height:40px;border:3px solid #e5e7eb;border-top-color:{{ color }};border-radius:50%;animation:_pl_spin 0.8s linear infinite;"></div>
</div>
<style>@keyframes _pl_spin { to { transform: rotate(360deg); } }</style>
<script>
(function() {
    var loader = document.getElementById('page-loader');
    if (!loader) return;

    function hideLoader() {
        loader.style.opacity = '0';
        loader.style.pointerEvents = 'none';
        setTimeout(function() { loader.remove(); }, 200);
    }

    // Wait for fonts to be ready (important for Material Icons)
    // Falls back to window.load if document.fonts is not supported
    if (document.fonts && document.fonts.ready) {
        document.fonts.ready.then(hideLoader);
    } else {
        window.addEventListener('load', hideLoader);
    }
})();
</script>
{% endmacro %}
