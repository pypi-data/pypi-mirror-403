Metadata-Version: 2.4
Name: mcp-media-analyzer
Version: 1.0.0
Summary: å¤šåª’é«”æª”æ¡ˆåˆ†æå·¥å…· - æ”¯æ´å½±ç‰‡ã€åœ–ç‰‡å’ŒéŸ³æª”çš„è¦–è¦ºåˆ†æã€èªéŸ³è½‰éŒ„å’Œæ™ºæ…§æª”åå»ºè­°
Project-URL: Homepage, https://github.com/hsiehchenwei/mcp-media-analyzer
Project-URL: Repository, https://github.com/hsiehchenwei/mcp-media-analyzer
Author: Chen Wei Hsieh
License: MIT
Keywords: ai,analyzer,audio,image,mcp,media,mlx,transcription,video,vision,whisper
Classifier: Development Status :: 4 - Beta
Classifier: Intended Audience :: Developers
Classifier: License :: OSI Approved :: MIT License
Classifier: Programming Language :: Python :: 3
Classifier: Programming Language :: Python :: 3.10
Classifier: Programming Language :: Python :: 3.11
Classifier: Programming Language :: Python :: 3.12
Requires-Python: >=3.10
Requires-Dist: google-genai>=1.0.0
Requires-Dist: httpx>=0.27.0
Requires-Dist: mcp>=1.0.0
Requires-Dist: mlx-whisper>=0.4.0; sys_platform == 'darwin' and platform_machine == 'arm64'
Requires-Dist: python-dotenv>=1.0.0
Description-Content-Type: text/markdown

# MCP åª’é«”åˆ†æå·¥å…·

å®Œå…¨æœ¬åœ°åŸ·è¡Œçš„éš±ç§åª’é«”åˆ†æå·¥å…· - æ”¯æ´å½±ç‰‡ã€åœ–ç‰‡å’ŒéŸ³æª”çš„è¦–è¦ºåˆ†æã€èªéŸ³è½‰éŒ„å’Œæ™ºæ…§æª”åå»ºè­°ï¼Œç„¡éœ€ä¸Šå‚³æ•¸æ“šåˆ°é›²ç«¯ã€‚

## æ ¸å¿ƒå„ªå‹¢

- ğŸ” **å®Œå…¨æœ¬åœ°åŸ·è¡Œ**ï¼šæ‰€æœ‰åˆ†æåœ¨æœ¬åœ°å®Œæˆï¼Œç„¡éœ€ä¸Šå‚³ä»»ä½•æ•¸æ“š
- ğŸ›¡ï¸ **æ¥µåº¦éš±ç§ä¿è­·**ï¼šæ•æ„Ÿåª’é«”æª”æ¡ˆæ°¸ä¸é›¢é–‹ä½ çš„è¨­å‚™
- âš¡ **é›¢ç·šå¯ç”¨**ï¼šç„¡ç¶²è·¯äº¦å¯æ­£å¸¸é‹ä½œï¼ˆlocal æ¨¡å¼ï¼‰
- ğŸ¯ **ä¸‰ç¨®å·¥ä½œæ¨¡å¼**ï¼š
  - ğŸ“Œ **é è¨­æ¨¡å¼**ï¼šæœ¬åœ°å„ªå…ˆ + å¯é¸é›²ç«¯ fallback
  - ğŸ”’ **æœ¬åœ°æ¨¡å¼**ï¼š100% é›¢ç·šï¼Œå®Œå…¨éš±ç§
  - â˜ï¸ **ç·šä¸Šæ¨¡å¼**ï¼šç´”é›²ç«¯ï¼ˆéœ€ Gemini APIï¼‰

## åŠŸèƒ½

- ğŸ“¹ **å½±ç‰‡åˆ†æ**ï¼šè¦–è¦ºå…§å®¹ã€metadataã€éŸ³è¨Šè½‰éŒ„
- ğŸ–¼ï¸ **åœ–ç‰‡åˆ†æ**ï¼šè‡ªå‹•è½‰æª”ï¼ˆHEICâ†’JPGï¼‰ã€è¦–è¦ºè­˜åˆ¥
- ğŸµ **éŸ³æª”è½‰éŒ„**ï¼šæœ¬åœ° Whisperï¼ˆApple Silicon æœ€å„ªåŒ–ï¼‰
- âœ¨ **æ™ºæ…§æª”å**ï¼šLLM ç”Ÿæˆæœ‰æ„ç¾©çš„æª”åå»ºè­°

---

## å¿«é€Ÿé–‹å§‹

### æ­¥é©Ÿ 1ï¼šè¨­å®š MCPï¼ˆåªéœ€é€™æ­¥ï¼‰

å°‡ä»¥ä¸‹å…§å®¹åŠ å…¥ `~/.cursor/mcp.json`ï¼š

```json
{
  "mcpServers": {
    "mcp-media-analyzer": {
      "command": "uvx",
      "args": ["mcp-media-analyzer"],
      "env": {
        "WHISPER_MODEL": "mlx-community/whisper-large-v3-turbo",
        "WHISPER_LANGUAGE": "zh"
      }
    }
  }
}
```

### æ­¥é©Ÿ 2ï¼šé å…ˆä¸‹è¼‰æ¨¡å‹ï¼ˆå¯é¸ï¼‰

é¿å…ç¬¬ä¸€æ¬¡ä½¿ç”¨æ™‚ç­‰å¾…ï¼š

```bash
uvx --with huggingface_hub python -c "
from huggingface_hub import snapshot_download
print('ä¸‹è¼‰ Whisper æ¨¡å‹ä¸­...')
snapshot_download('mlx-community/whisper-large-v3-turbo')
print('âœ“ å®Œæˆ')
"
```

### æ­¥é©Ÿ 3ï¼šé–‹å§‹ä½¿ç”¨

é‡å•Ÿ Cursor å¾Œï¼Œç›´æ¥å°è©±ï¼š

```
"åˆ†æé€™å€‹å½±ç‰‡ /path/to/video.mp4"
"å¹«æˆ‘è½‰éŒ„é€™å€‹éŸ³æª”"
"é€™å¼µç…§ç‰‡æ˜¯åœ¨å“ªè£¡æ‹çš„ï¼Ÿ"
```

---

## å‰ææ¢ä»¶

éœ€è¦å…ˆå®‰è£ `uv`ï¼ˆä¸€æ¬¡æ€§ï¼‰ï¼š

```bash
# macOS / Linux
curl -LsSf https://astral.sh/uv/install.sh | sh

# Windows
powershell -ExecutionPolicy ByPass -c "irm https://astral.sh/uv/install.ps1 | iex"
```

ä»¥åŠ `ffmpeg`ï¼š

```bash
# macOS
brew install ffmpeg

# Linux
sudo apt-get install ffmpeg
```

---

## å¹³å°æ”¯æ´

| å¹³å° | èªéŸ³è½‰éŒ„ | èªªæ˜ |
|------|----------|------|
| Apple Silicon (M1/M2/M3/M4) | MLX-Whisper | æœ¬åœ°è½‰éŒ„ï¼Œå¿«é€Ÿ |
| Intel Mac / Linux / Windows | Gemini API | éœ€è¨­å®š GEMINI_API_KEY |

---

## æœ¬åœ°é–‹ç™¼

å¦‚æœä½ è¦ä¿®æ”¹ç¨‹å¼ç¢¼ï¼Œä½¿ç”¨æœ¬åœ°é–‹ç™¼æ¨¡å¼ï¼š

```bash
cd /path/to/mcp-media-analyzer
uv sync
uv run mcp-media-analyzer
```

å°æ‡‰çš„ mcp.jsonï¼š

```json
{
  "mcpServers": {
    "mcp-media-analyzer": {
      "command": "uv",
      "args": ["--directory", "/path/to/mcp-media-analyzer", "run", "mcp-media-analyzer"],
      "env": {
        "WHISPER_MODEL": "mlx-community/whisper-large-v3-turbo",
        "WHISPER_LANGUAGE": "zh"
      }
    }
  }
}
```

---

## ç’°å¢ƒè®Šæ•¸èªªæ˜

| è®Šæ•¸ | å¿…è¦ | é è¨­å€¼ | èªªæ˜ |
|------|------|--------|------|
| `LM_STUDIO_URL` | âŒ | `http://localhost:1234/v1/chat/completions` | LM Studio API ç«¯é» |
| `LM_STUDIO_MODEL` | âŒ | `qwen/qwen3-vl-30b` | è¦–è¦ºåˆ†ææ¨¡å‹ |
| `GEMINI_API_KEY` | âŒ | ç„¡ | Google Gemini API key |
| `WHISPER_MODEL` | âŒ | `mlx-community/whisper-large-v3-turbo` | Whisper æ¨¡å‹ |
| `WHISPER_LANGUAGE` | âŒ | `zh` | è½‰éŒ„èªè¨€ |

---

## ä½¿ç”¨

### å·¥å…· 1ï¼šåˆ†æå–®ä¸€æª”æ¡ˆ

```python
# é è¨­æ¨¡å¼ï¼ˆæœ¬åœ°å„ªå…ˆ + Gemini fallbackï¼‰
{
  "file_path": "video.mp4",
  "mode": "default"
}

# æœ¬åœ°æ¨¡å¼ï¼ˆå®Œå…¨é›¢ç·šï¼‰
{
  "file_path": "video.mp4",
  "mode": "local"
}

# ç·šä¸Šæ¨¡å¼ï¼ˆç›´æ¥ç”¨ Geminiï¼‰
{
  "file_path": "audio.mp3",
  "mode": "online"
}

# éŸ³æª”åˆ†æ
{
  "file_path": "recording.wav",
  "mode": "default"
}
```

### å·¥å…· 2ï¼šæ‰¹æ¬¡åˆ†æ

```python
{
  "directory": "./media",
  "pattern": "*.mp4",
  "mode": "default",
  "output_file": "./report.md"
}
```

---

## æ¨¡å¼å°æ¯”

### æœ¬åœ°æ¨¡å¼ï¼ˆLocalï¼‰- ğŸ† å®Œå…¨éš±ç§ä¿è­·
âœ… **é©åˆæ©Ÿå¯†è³‡æ–™ã€ä¼æ¥­æª”æ¡ˆ**
- è¦–è¦ºåˆ†æï¼šLM Studio onlyï¼ˆæœ¬åœ°ï¼‰
- èªéŸ³è½‰éŒ„ï¼šWhisper onlyï¼ˆæœ¬åœ°ï¼‰
- æª”åå»ºè­°ï¼šLM Studio onlyï¼ˆæœ¬åœ°ï¼‰
- æ‰€æœ‰æ•¸æ“šæ°¸ä¸é›¢é–‹ä½ çš„è¨­å‚™
- 100% é›¢ç·šå¯ç”¨

### é è¨­æ¨¡å¼ï¼ˆDefaultï¼‰- æ¨è–¦
âœ… **æœ¬åœ°å„ªå…ˆ + å¯é¸é›²ç«¯**
- è¦–è¦ºåˆ†æï¼šLM Studio â†’ Gemini fallback
- èªéŸ³è½‰éŒ„ï¼šWhisper â†’ Gemini fallback
- æª”åå»ºè­°ï¼šLM Studio â†’ Gemini fallback
- é©åˆï¼šå¹³è¡¡éš±ç§èˆ‡è³ªé‡

### ç·šä¸Šæ¨¡å¼ï¼ˆOnlineï¼‰- ğŸš€ æœ€è°æ˜ã€æœ€å¿«é€Ÿ
âš ï¸ **éœ€è¦ Gemini API key**
- è¦–è¦ºåˆ†æï¼šGemini
- èªéŸ³è½‰éŒ„ï¼šGemini
- æª”åå»ºè­°ï¼šGemini
- æœ€é«˜æº–ç¢ºåº¦ã€æœ€å¿«è™•ç†é€Ÿåº¦
- é©åˆï¼šè³ªé‡å„ªå…ˆã€å°éš±ç§è¦æ±‚ä½

---

## æ”¯æ´çš„æª”æ¡ˆæ ¼å¼

### å½±ç‰‡
`.mp4`, `.mov`, `.avi`, `.mkv`, `.webm`, `.m4v`, `.wmv`, `.flv`

### åœ–ç‰‡
`.jpg`, `.jpeg`, `.png`, `.webp`, `.gif`, `.bmp`, `.tiff`, `.heic`, `.heif`
ï¼ˆè‡ªå‹•è½‰æ›ç‚º JPGï¼‰

### éŸ³æª”
`.mp3`, `.wav`, `.m4a`, `.aac`, `.ogg`, `.flac`, `.wma`, `.aiff`

---

## è¼¸å‡ºç¯„ä¾‹

### å½±ç‰‡åˆ†æçµæœ

```
## å½±ç‰‡è³‡è¨Š
- æª”æ¡ˆ: IMG_7096.MOV
- æ™‚é•·: 0:12
- è§£æåº¦: 3840x2160
- æ‹æ”æ™‚é–“: 2025-06-29T22:38:37.000000Z
- æ‹æ”åœ°é»: 43.7241, 142.5051
- æ¨¡å¼: é è¨­ï¼ˆæœ¬åœ°å„ªå…ˆï¼‰

## è¦–è¦ºåˆ†æ
**åˆ†æä¾†æº**: lm_studio (qwen/qwen3-vl-30b)
æ ¹æ“šæä¾›çš„åœ–ç‰‡...

## éŸ³è¨Šè½‰éŒ„
**è½‰éŒ„ä¾†æº**: whisper_local (mlx-community/whisper-large-v3-turbo)
(è½‰éŒ„å…§å®¹...)

## å»ºè­°æª”å
**ä¾†æº**: lm_studio
`7096_202506_æ—¥æœ¬é„‰æ‘_ç¨»ç”°çŒæº‰.MOV`

---
**å ±å‘Šå·²å„²å­˜**: `IMG_7096.md`
```

---

## å¸¸è¦‹å•é¡Œ

### Q1ï¼šWhisper æ¨¡å‹ä¸‹è¼‰å¾ˆæ…¢æ€éº¼è¾¦ï¼Ÿ

**Aï¼š** æ‰‹å‹•é ä¸‹è¼‰æˆ–ä½¿ç”¨è¼ƒå°æ¨¡å‹ï¼š

```bash
# ä½¿ç”¨ tiny æ¨¡å‹ï¼ˆ39MBï¼‰
export WHISPER_MODEL="mlx-community/whisper-tiny"
```

### Q2ï¼šå¦‚ä½•åŠ é€Ÿè¦–è¦ºåˆ†æï¼Ÿ

**Aï¼š** è¨­å®šæœ¬åœ° LM Studio æ¨¡å‹ï¼š
- ç¢ºä¿ LM Studio é‹è¡Œä¸­ï¼š`http://localhost:1234`
- ä½¿ç”¨å°å‹æ¨¡å‹ï¼š`phi-4-mini` æˆ– `qwen2-7b`

### Q3ï¼šHEIC åœ–ç‰‡è½‰æ›å¤±æ•—ï¼Ÿ

**Aï¼š** ç¢ºä¿å·²å®‰è£è½‰æ›å·¥å…·ï¼š

```bash
# macOS å·²å…§å»º sips
# Linux å®‰è£ imagemagick
sudo apt-get install imagemagick
```

### Q4ï¼šå ±å‘Šæª”æ¡ˆåœ¨å“ªè£¡ï¼Ÿ

**Aï¼š** `.md` æª”æ¡ˆå„²å­˜åœ¨åŸæª”æ¡ˆæ—é‚Šï¼š
- è¼¸å…¥ï¼š`video.mp4`
- è¼¸å‡ºï¼š`video.md`ï¼ˆåªåœ¨æœ‰åˆ†æå…§å®¹æ™‚å»ºç«‹ï¼‰

---

## æ•ˆèƒ½å„ªåŒ–

### æœ¬åœ°æ¨¡å¼æœ€ä½³åŒ–

```bash
# é å…ˆè¼‰å…¥ Whisper æ¨¡å‹
export WHISPER_MODEL="mlx-community/whisper-large-v3-turbo"

# é å…ˆç·©å­˜ LM Studio é€£ç·š
curl http://localhost:1234/v1/models
```

### é›²ç«¯æ¨¡å¼æœ€ä½³åŒ–

```json
"GEMINI_API_KEY": "your-key",  // ä½¿ç”¨ quota å……è¶³çš„ key
"WHISPER_LANGUAGE": "zh"       // æŒ‡å®šèªè¨€åŠ å¿«è½‰éŒ„
```

---

## æ•…éšœæ’é™¤

### é€£ç·šå•é¡Œ

```bash
# æª¢æŸ¥ LM Studio
curl http://localhost:1234/v1/models

# æª¢æŸ¥ Gemini API
curl -X POST "https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=YOUR_KEY" \
  -H "Content-Type: application/json" \
  -d '{"contents":[{"parts":[{"text":"test"}]}]}'
```

### Whisper å•é¡Œ

```bash
# æ¸¬è©¦æœ¬åœ°è½‰éŒ„
uv run python -c "import mlx_whisper; print(mlx_whisper.__version__)"

# æ‰‹å‹•æª¢æŸ¥æ¨¡å‹
uv run python -c "from huggingface_hub import model_info; print(model_info('mlx-community/whisper-large-v3-turbo'))"
```

---

## é–‹ç™¼

### é‹è¡Œæ¸¬è©¦

```bash
uv run pytest tests/
```

### é–‹ç™¼æ¨¡å¼

```bash
# ç·¨è¼¯å¾Œè‡ªå‹•é‡è¼‰
uv run python -m mcp_media_analyzer.server
```

---

## æˆæ¬Š

MIT

---

## æ”¯æ´

å¦‚æœ‰å•é¡Œï¼Œè«‹æäº¤ issue æˆ–è¯çµ¡é–‹ç™¼è€…ã€‚
