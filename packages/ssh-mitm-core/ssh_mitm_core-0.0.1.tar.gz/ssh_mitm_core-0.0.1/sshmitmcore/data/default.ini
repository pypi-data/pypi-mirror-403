[SSH-MITM]
debug = False
paramiko-log-level = warning
log-format = text
disable-workarounds = False

[SSH-Server-Modules]
ssh-interface = sshmitmcore.forwarders.ssh:SSHForwarder
scp-interface = sshmitmcore.forwarders.scp:SCPForwarder
sftp-interface = sshmitmcore.interfaces.sftp:SFTPProxyServerInterface
sftp-handler = sshmitmcore.forwarders.sftp:SFTPHandlerPlugin
server-tunnel-interface = sshmitmcore.forwarders.tunnel:RemotePortForwardingForwarder
client-tunnel-interface = sshmitmcore.forwarders.tunnel:LocalPortForwardingForwarder
auth-interface = sshmitmcore.interfaces.server:ServerInterface
authenticator = sshmitmcore.authentication:AuthenticatorRemote
session-class = sshmitmcore.session:Session

[SSH-Server-Options]
listen-address = ::
listen-port = 10022
transparent = False
host-key =
host-key-algorithm = rsa
host-key-length = 2048
request-agent-breakin = False
banner-name =

##################################
# Session-Plugins
##################################

[sshmitmcore.session:Session]
session-log-dir =
log-webhook-dest =

##################################
# Authentication-Plugins
##################################

[sshmitm.plugins.authentication.passthrough:AuthenticatorPassThrough]
close-pubkey-enumerator-with-session = False
remote-host =
remote-port =
remote-fingerprints =
disable-remote-fingerprint-warning = False
auth-username =
auth-password =
auth-hide-credentials = False
enable-auth-fallback = False
fallback-host =
fallback-port = 22
fallback-username =
fallback-password =

[sshmitmcore.authentication:AuthenticatorRemote]


##################################
# Server-Interface-Plugins
##################################

[sshmitmcore.interfaces.server:ServerInterface]
disable-ssh = False
disable-scp = False
disable-subsystems = False
disable-port-forwarding = False
disable-environment-requests = False
disable-agent-forwarding = False

[sshmitm.plugins.serverinterface.mitm_server_interface:MitmServerInterface]
disable-ssh = False
disable-scp = False
disable-subsystems = False
disable-port-forwarding = False
disable-environment-requests = False
disable-agent-forwarding = False

disable-password-auth = False
disable-pubkey-auth = False
disallow-publickey-auth = False
disable-keyboard-interactive-prompts = False
disable-auth-method-lookup = False

enable-none-auth = False
enable-keyboard-interactive-auth = False
enable-trivial-auth = False

accept-first-publickey = False
extra-auth-methods =

[sshmitm.plugins.serverinterface.pubkey_only_server_interface:PubkeyOnlyServerInterface]
disable-ssh = False
disable-scp = True
disable-subsystems = False
disable-port-forwarding = False
disable-environment-requests = False
disable-agent-forwarding = True
auth-username =
auth-key-sha256 =

##################################
# Terminal-Session-Plugins
##################################

[sshmitmcore.forwarders.ssh:SSHForwarder]

[sshmitm.plugins.ssh.mirrorshell:SSHMirrorForwarder]
ssh-mirrorshell-net = 127.0.0.1
ssh-mirrorshell-key =
store-ssh-session = False
ssh-terminal-log-formatter = script


##################################
# SCP-Plugins
##################################

[sshmitmcore.forwarders.scp:SCPForwarder]

[sshmitm.plugins.scp.debug_traffic:SCPDebugForwarder]

[sshmitm.plugins.scp.inject_file:SCPInjectFile]
scp-inject-file =

[sshmitm.plugins.scp.replace_file:SCPReplaceFile]
scp-replace-file =

[sshmitm.plugins.scp.store_file:SCPStorageForwarder]
store-scp-files = False
store-command-data = False

[sshmitm.plugins.scp.rewrite_command:SCPRewriteCommand]
scp-append-string =
scp-replace-string =

[sshmitm.plugins.scp.cve202229154:CVE202229154]
rsync-inject-file =

##################################
# SFTP-Server-Plugins
##################################

[sshmitmcore.interfaces.sftp:SFTPProxyServerInterface]

##################################
# SFTP-Handler-Plugins
##################################

[sshmitmcore.forwarders.sftp:SFTPHandlerPlugin]

[sshmitm.plugins.sftp.store_file:SFTPHandlerStoragePlugin]
store-sftp-files = False

[sshmitm.plugins.sftp.replace_file:SFTPProxyReplaceHandler]
sftp-replace-file =

[sshmitm.plugins.sftp.replace_file:SFTPHandlerCheckFilePlugin]

##################################
# Remote-Port-Forwarding-Plugins
##################################

[sshmitmcore.forwarders.tunnel:RemotePortForwardingForwarder]

[sshmitm.plugins.tunnel.injectservertunnel:InjectableRemotePortForwardingForwarder]
server-tunnel-net = 127.0.0.1

##################################
# Local-Port-Forwarding-Plugins
##################################

[sshmitmcore.forwarders.tunnel:LocalPortForwardingForwarder]

[sshmitm.plugins.tunnel.socks:SOCKSTunnelForwarder]
socks-listen-address = 127.0.0.1
socks5-username =
socks5-password =
