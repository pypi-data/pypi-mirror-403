import{L as G,E as z,C as N}from"./index-DTdRS8K_.js";import{s as I,t as d,E as Y,L as j,e as A,j as U,a as Z,i as D,f as B,q as M}from"./NewEditor-DcCxOWL3.js";import"./asyncComputed-3zrnCYug.js";import"./jwt-decode.esm-Dw_OlTCW.js";import"./contracts.generated-BY4ff4DP.js";import"./linters-7piodHpP.js";import"./omniChatStore-GzvmxXJk.js";import"./router-DzczyMew.js";import"./ts.worker-5sEEipil.js";import"./record-BTRCUCPd.js";import"./runnerData-DZ54UJZ3.js";import"./url-vGC2YsRB.js";import"./colorHelpers-Chvd75S3.js";import"./uuid-uY6ajUFo.js";import"./PhCopySimple.vue-BolmM9w7.js";import"./CreateTaskModal.vue_vue_type_script_setup_true_lang-9gKpO07j.js";import"./LoadingOutlined-Du0iiSbv.js";import"./metadata-vgMtKcWz.js";import"./PhMagnifyingGlass.vue-7kNaqZFQ.js";import"./PhWebhooksLogo.vue-BZ5oEMJy.js";import"./datetime-XffTntCT.js";import"./PhStop.vue-CxrT_vyV.js";import"./PhBroom.vue-CDU1y1Fu.js";import"./PhCaretRight.vue-CPFOGdR4.js";import"./index-FhuFwKwr.js";import"./index-4hy9Zjs6.js";import"./ExecutionContext-CAwA0rAz.js";import"./build-DHVrj-yw.js";import"./string-BuQ9zSDy.js";import"./tables-CkY-LQhC.js";import"./polling-C2YNfl7D.js";import"./ant-design-Cvwf7JMR.js";import"./PhCopy.vue-CYMhBES8.js";import"./PhRobot.vue-Cw9THnjN.js";import"./index-BNW_czQY.js";import"./OmniChat-BcKSlznz.js";import"./PhTranslate.vue-DNVQd2KV.js";import"./PhClockCounterClockwise.vue-D2hTcJTL.js";import"./file-oQhfP6ps.js";import"./AbstraLogo.vue_vue_type_script_setup_true_lang--TrSji4U.js";import"./logo-BiWG9_W5.js";import"./Logo-CecBL509.js";import"./index-CKBppVEa.js";import"./PhDatabase.vue-CDL-qWEb.js";import"./AbstraButton.vue_vue_type_script_setup_true_lang-60wd7w0p.js";import"./constants-DtajWhvQ.js";import"./editor-Cv3nuAVg.js";import"./router-EePVc0Jw.js";import"./userStore-4FpRPoeM.js";import"./workspaceStore-CeNiHwH_.js";import"./useCodebaseEvents-Bflf0zUq.js";import"./PhArrowSquareOut.vue-B__lN4s3.js";import"./PhRocket.vue-Bwc9Vl1o.js";import"./PhSignOut.vue-DXIoBRl-.js";import"./PhWarningCircle.vue-CqmcrxwZ.js";import"./PhDownloadSimple.vue-BVpgtzm2.js";import"./CloseCircleOutlined-DDQD24eE.js";import"./PhFolderPlus.vue-Cl7z2UQz.js";import"./tasksController-DJpAodBz.js";import"./taskCreator-Cl5IQgz9.js";import"./vue-flow-core-DIcVZb9v.js";import"./keyboard-ChYuPiMg.js";import"./os-DZQnSzPn.js";import"./ContentLayout-Dzzrm9gc.js";import"./fetch-B1nAdsqQ.js";import"./repository-tH4Xk8va.js";import"./SaveButton-C9JMDose.js";import"./ExclamationCircleOutlined-CVcFSPgk.js";import"./View.vue_vue_type_script_setup_true_lang-BYrCSA9s.js";import"./CrudView-lwVlHvLk.js";import"./DocsButton.vue_vue_type_script_setup_true_lang-4fYs65kc.js";import"./PhDotsThreeVertical.vue-zeuZOamM.js";import"./PhPencil.vue-B1w6UtLB.js";import"./PlayerNavbar-D7ITQOqs.js";import"./PlayerConfigProvider-DW0F9F5y.js";import"./LoadingContainer-CWREaKdR.js";import"./ImageViewer-Ce_zD7hk.js";import"./PhArrowUp.vue-CdDYoNSG.js";import"./ScrollArea.vue_vue_type_script_setup_true_lang-BhCwSPN5.js";import"./UploadOutlined-9uYjWBQ1.js";import"./xlsx-sIPcJk3-.js";import"./editor.main-ys9l7DM7.js";import"./index-BHC_ex0T.js";import"./vue-flow-background-2yLNeDII.js";import"./PhArrowCounterClockwise.vue-YLZkrNBt.js";import"./FormRunner-DxuG_5gW.js";import"./Login.vue_vue_type_script_setup_true_lang-BhhCxcTK.js";import"./OTPInput-BNXizKEV.js";import"./CircularLoading-KIKDgvZr.js";import"./Steps-BcOsmBCT.js";import"./index--PNRck0c.js";import"./Watermark-Bo0Yk0E7.js";import"./redirect-BlXxmFll.js";(function(){try{var t=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},e=new Error().stack;e&&(t._sentryDebugIds=t._sentryDebugIds||{},t._sentryDebugIds[e]="25e0f8ac-8aca-45c0-90d6-83f7d4230fdd",t._sentryDebugIdIdentifier="sentry-dbid-25e0f8ac-8aca-45c0-90d6-83f7d4230fdd")}catch{}})();const h=1,F=2,L=3,K=4,H=5,J=36,tt=37,et=38,ot=11,Ot=13;function rt(t){return t==45||t==46||t==58||t>=65&&t<=90||t==95||t>=97&&t<=122||t>=161}function nt(t){return t==9||t==10||t==13||t==32}let Q=null,V=null,_=0;function W(t,e){let O=t.pos+e;if(V==t&&_==O)return Q;for(;nt(t.peek(e));)e++;let o="";for(;;){let r=t.peek(e);if(!rt(r))break;o+=String.fromCharCode(r),e++}return V=t,_=O,Q=o||null}function X(t,e){this.name=t,this.parent=e}const at=new N({start:null,shift(t,e,O,o){return e==h?new X(W(o,1)||"",t):t},reduce(t,e){return e==ot&&t?t.parent:t},reuse(t,e,O,o){let r=e.type.id;return r==h||r==Ot?new X(W(o,1)||"",t):t},strict:!1}),lt=new z((t,e)=>{if(t.next==60){if(t.advance(),t.next==47){t.advance();let O=W(t,0);if(!O)return t.acceptToken(H);if(e.context&&O==e.context.name)return t.acceptToken(F);for(let o=e.context;o;o=o.parent)if(o.name==O)return t.acceptToken(L,-2);t.acceptToken(K)}else if(t.next!=33&&t.next!=63)return t.acceptToken(h)}},{contextual:!0});function y(t,e){return new z(O=>{let o=0,r=e.charCodeAt(0);t:for(;!(O.next<0);O.advance(),o++)if(O.next==r){for(let a=1;a<e.length;a++)if(O.peek(a)!=e.charCodeAt(a))continue t;break}o&&O.acceptToken(t)})}const it=y(J,"-->"),st=y(tt,"?>"),mt=y(et,"]]>"),pt=I({Text:d.content,"StartTag StartCloseTag EndTag SelfCloseEndTag":d.angleBracket,TagName:d.tagName,"MismatchedCloseTag/TagName":[d.tagName,d.invalid],AttributeName:d.attributeName,AttributeValue:d.attributeValue,Is:d.definitionOperator,"EntityReference CharacterReference":d.character,Comment:d.blockComment,ProcessingInst:d.processingInstruction,DoctypeDecl:d.documentMeta,Cdata:d.special(d.string)}),ct=G.deserialize({version:14,states:",lOQOaOOOrOxO'#CfOzOpO'#CiO!tOaO'#CgOOOP'#Cg'#CgO!{OrO'#CrO#TOtO'#CsO#]OpO'#CtOOOP'#DT'#DTOOOP'#Cv'#CvQQOaOOOOOW'#Cw'#CwO#eOxO,59QOOOP,59Q,59QOOOO'#Cx'#CxO#mOpO,59TO#uO!bO,59TOOOP'#C|'#C|O$TOaO,59RO$[OpO'#CoOOOP,59R,59ROOOQ'#C}'#C}O$dOrO,59^OOOP,59^,59^OOOS'#DO'#DOO$lOtO,59_OOOP,59_,59_O$tOpO,59`O$|OpO,59`OOOP-E6t-E6tOOOW-E6u-E6uOOOP1G.l1G.lOOOO-E6v-E6vO%UO!bO1G.oO%UO!bO1G.oO%dOpO'#CkO%lO!bO'#CyO%zO!bO1G.oOOOP1G.o1G.oOOOP1G.w1G.wOOOP-E6z-E6zOOOP1G.m1G.mO&VOpO,59ZO&_OpO,59ZOOOQ-E6{-E6{OOOP1G.x1G.xOOOS-E6|-E6|OOOP1G.y1G.yO&gOpO1G.zO&gOpO1G.zOOOP1G.z1G.zO&oO!bO7+$ZO&}O!bO7+$ZOOOP7+$Z7+$ZOOOP7+$c7+$cO'YOpO,59VO'bOpO,59VO'mO!bO,59eOOOO-E6w-E6wO'{OpO1G.uO'{OpO1G.uOOOP1G.u1G.uO(TOpO7+$fOOOP7+$f7+$fO(]O!bO<<GuOOOP<<Gu<<GuOOOP<<G}<<G}O'bOpO1G.qO'bOpO1G.qO(hO#tO'#CnO(vO&jO'#CnOOOO1G.q1G.qO)UOpO7+$aOOOP7+$a7+$aOOOP<<HQ<<HQOOOPAN=aAN=aOOOPAN=iAN=iO'bOpO7+$]OOOO7+$]7+$]OOOO'#Cz'#CzO)^O#tO,59YOOOO,59Y,59YOOOO'#C{'#C{O)lO&jO,59YOOOP<<G{<<G{OOOO<<Gw<<GwOOOO-E6x-E6xOOOO1G.t1G.tOOOO-E6y-E6y",stateData:")z~OPQOSVOTWOVWOWWOXWOiXOyPO!QTO!SUO~OvZOx]O~O^`Oz^O~OPQOQcOSVOTWOVWOWWOXWOyPO!QTO!SUO~ORdO~P!SOteO!PgO~OuhO!RjO~O^lOz^O~OvZOxoO~O^qOz^O~O[vO`sOdwOz^O~ORyO~P!SO^{Oz^O~OteO!P}O~OuhO!R!PO~O^!QOz^O~O[!SOz^O~O[!VO`sOd!WOz^O~Oa!YOz^O~Oz^O[mX`mXdmX~O[!VO`sOd!WO~O^!]Oz^O~O[!_Oz^O~O[!aOz^O~O[!cO`sOd!dOz^O~O[!cO`sOd!dO~Oa!eOz^O~Oz^O{!gO}!hO~Oz^O[ma`madma~O[!kOz^O~O[!lOz^O~O[!mO`sOd!nO~OW!qOX!qO{!sO|!qO~OW!tOX!tO}!sO!O!tO~O[!vOz^O~OW!qOX!qO{!yO|!qO~OW!tOX!tO}!yO!O!tO~O",goto:"%cxPPPPPPPPPPyyP!PP!VPP!`!jP!pyyyP!v!|#S$[$k$q$w$}%TPPPP%ZXWORYbXRORYb_t`qru!T!U!bQ!i!YS!p!e!fR!w!oQdRRybXSORYbQYORmYQ[PRn[Q_QQkVjp_krz!R!T!X!Z!^!`!f!j!oQr`QzcQ!RlQ!TqQ!XsQ!ZtQ!^{Q!`!QQ!f!YQ!j!]R!o!eQu`S!UqrU![u!U!bR!b!TQ!r!gR!x!rQ!u!hR!z!uQbRRxbQfTR|fQiUR!OiSXOYTaRb",nodeNames:"âš  StartTag StartCloseTag MissingCloseTag StartCloseTag StartCloseTag Document Text EntityReference CharacterReference Cdata Element EndTag OpenTag TagName Attribute AttributeName Is AttributeValue CloseTag SelfCloseEndTag SelfClosingTag Comment ProcessingInst MismatchedCloseTag DoctypeDecl",maxTerm:50,context:at,nodeProps:[["closedBy",1,"SelfCloseEndTag EndTag",13,"CloseTag MissingCloseTag"],["openedBy",12,"StartTag StartCloseTag",19,"OpenTag",20,"StartTag"],["isolate",-6,13,18,19,21,22,24,""]],propSources:[pt],skippedNodes:[0],repeatNodeCount:9,tokenData:"!)v~R!YOX$qXY)iYZ)iZ]$q]^)i^p$qpq)iqr$qrs*vsv$qvw+fwx/ix}$q}!O0[!O!P$q!P!Q2z!Q![$q![!]4n!]!^$q!^!_8U!_!`!#t!`!a!$l!a!b!%d!b!c$q!c!}4n!}#P$q#P#Q!'W#Q#R$q#R#S4n#S#T$q#T#o4n#o%W$q%W%o4n%o%p$q%p&a4n&a&b$q&b1p4n1p4U$q4U4d4n4d4e$q4e$IS4n$IS$I`$q$I`$Ib4n$Ib$Kh$q$Kh%#t4n%#t&/x$q&/x&Et4n&Et&FV$q&FV;'S4n;'S;:j8O;:j;=`)c<%l?&r$q?&r?Ah4n?Ah?BY$q?BY?Mn4n?MnO$qi$zXVP|W!O`Or$qrs%gsv$qwx'^x!^$q!^!_(o!_;'S$q;'S;=`)c<%lO$qa%nVVP!O`Ov%gwx&Tx!^%g!^!_&o!_;'S%g;'S;=`'W<%lO%gP&YTVPOv&Tw!^&T!_;'S&T;'S;=`&i<%lO&TP&lP;=`<%l&T`&tS!O`Ov&ox;'S&o;'S;=`'Q<%lO&o`'TP;=`<%l&oa'ZP;=`<%l%gX'eWVP|WOr'^rs&Tsv'^w!^'^!^!_'}!_;'S'^;'S;=`(i<%lO'^W(ST|WOr'}sv'}w;'S'};'S;=`(c<%lO'}W(fP;=`<%l'}X(lP;=`<%l'^h(vV|W!O`Or(ors&osv(owx'}x;'S(o;'S;=`)]<%lO(oh)`P;=`<%l(oi)fP;=`<%l$qo)t`VP|W!O`zUOX$qXY)iYZ)iZ]$q]^)i^p$qpq)iqr$qrs%gsv$qwx'^x!^$q!^!_(o!_;'S$q;'S;=`)c<%lO$qk+PV{YVP!O`Ov%gwx&Tx!^%g!^!_&o!_;'S%g;'S;=`'W<%lO%g~+iast,n![!]-r!c!}-r#R#S-r#T#o-r%W%o-r%p&a-r&b1p-r4U4d-r4e$IS-r$I`$Ib-r$Kh%#t-r&/x&Et-r&FV;'S-r;'S;:j/c?&r?Ah-r?BY?Mn-r~,qQ!Q![,w#l#m-V~,zQ!Q![,w!]!^-Q~-VOX~~-YR!Q![-c!c!i-c#T#Z-c~-fS!Q![-c!]!^-Q!c!i-c#T#Z-c~-ug}!O-r!O!P-r!Q![-r![!]-r!]!^/^!c!}-r#R#S-r#T#o-r$}%O-r%W%o-r%p&a-r&b1p-r1p4U-r4U4d-r4e$IS-r$I`$Ib-r$Je$Jg-r$Kh%#t-r&/x&Et-r&FV;'S-r;'S;:j/c?&r?Ah-r?BY?Mn-r~/cOW~~/fP;=`<%l-rk/rW}bVP|WOr'^rs&Tsv'^w!^'^!^!_'}!_;'S'^;'S;=`(i<%lO'^k0eZVP|W!O`Or$qrs%gsv$qwx'^x}$q}!O1W!O!^$q!^!_(o!_;'S$q;'S;=`)c<%lO$qk1aZVP|W!O`Or$qrs%gsv$qwx'^x!^$q!^!_(o!_!`$q!`!a2S!a;'S$q;'S;=`)c<%lO$qk2_X!PQVP|W!O`Or$qrs%gsv$qwx'^x!^$q!^!_(o!_;'S$q;'S;=`)c<%lO$qm3TZVP|W!O`Or$qrs%gsv$qwx'^x!^$q!^!_(o!_!`$q!`!a3v!a;'S$q;'S;=`)c<%lO$qm4RXdSVP|W!O`Or$qrs%gsv$qwx'^x!^$q!^!_(o!_;'S$q;'S;=`)c<%lO$qo4{!P`S^QVP|W!O`Or$qrs%gsv$qwx'^x}$q}!O4n!O!P4n!P!Q$q!Q![4n![!]4n!]!^$q!^!_(o!_!c$q!c!}4n!}#R$q#R#S4n#S#T$q#T#o4n#o$}$q$}%O4n%O%W$q%W%o4n%o%p$q%p&a4n&a&b$q&b1p4n1p4U4n4U4d4n4d4e$q4e$IS4n$IS$I`$q$I`$Ib4n$Ib$Je$q$Je$Jg4n$Jg$Kh$q$Kh%#t4n%#t&/x$q&/x&Et4n&Et&FV$q&FV;'S4n;'S;:j8O;:j;=`)c<%l?&r$q?&r?Ah4n?Ah?BY$q?BY?Mn4n?MnO$qo8RP;=`<%l4ni8]Y|W!O`Oq(oqr8{rs&osv(owx'}x!a(o!a!b!#U!b;'S(o;'S;=`)]<%lO(oi9S_|W!O`Or(ors&osv(owx'}x}(o}!O:R!O!f(o!f!g;e!g!}(o!}#ODh#O#W(o#W#XLp#X;'S(o;'S;=`)]<%lO(oi:YX|W!O`Or(ors&osv(owx'}x}(o}!O:u!O;'S(o;'S;=`)]<%lO(oi;OV!QP|W!O`Or(ors&osv(owx'}x;'S(o;'S;=`)]<%lO(oi;lX|W!O`Or(ors&osv(owx'}x!q(o!q!r<X!r;'S(o;'S;=`)]<%lO(oi<`X|W!O`Or(ors&osv(owx'}x!e(o!e!f<{!f;'S(o;'S;=`)]<%lO(oi=SX|W!O`Or(ors&osv(owx'}x!v(o!v!w=o!w;'S(o;'S;=`)]<%lO(oi=vX|W!O`Or(ors&osv(owx'}x!{(o!{!|>c!|;'S(o;'S;=`)]<%lO(oi>jX|W!O`Or(ors&osv(owx'}x!r(o!r!s?V!s;'S(o;'S;=`)]<%lO(oi?^X|W!O`Or(ors&osv(owx'}x!g(o!g!h?y!h;'S(o;'S;=`)]<%lO(oi@QY|W!O`Or?yrs@psv?yvwA[wxBdx!`?y!`!aCr!a;'S?y;'S;=`Db<%lO?ya@uV!O`Ov@pvxA[x!`@p!`!aAy!a;'S@p;'S;=`B^<%lO@pPA_TO!`A[!`!aAn!a;'SA[;'S;=`As<%lOA[PAsOiPPAvP;=`<%lA[aBQSiP!O`Ov&ox;'S&o;'S;=`'Q<%lO&oaBaP;=`<%l@pXBiX|WOrBdrsA[svBdvwA[w!`Bd!`!aCU!a;'SBd;'S;=`Cl<%lOBdXC]TiP|WOr'}sv'}w;'S'};'S;=`(c<%lO'}XCoP;=`<%lBdiC{ViP|W!O`Or(ors&osv(owx'}x;'S(o;'S;=`)]<%lO(oiDeP;=`<%l?yiDoZ|W!O`Or(ors&osv(owx'}x!e(o!e!fEb!f#V(o#V#WIr#W;'S(o;'S;=`)]<%lO(oiEiX|W!O`Or(ors&osv(owx'}x!f(o!f!gFU!g;'S(o;'S;=`)]<%lO(oiF]X|W!O`Or(ors&osv(owx'}x!c(o!c!dFx!d;'S(o;'S;=`)]<%lO(oiGPX|W!O`Or(ors&osv(owx'}x!v(o!v!wGl!w;'S(o;'S;=`)]<%lO(oiGsX|W!O`Or(ors&osv(owx'}x!c(o!c!dH`!d;'S(o;'S;=`)]<%lO(oiHgX|W!O`Or(ors&osv(owx'}x!}(o!}#OIS#O;'S(o;'S;=`)]<%lO(oiI]V|W!O`yPOr(ors&osv(owx'}x;'S(o;'S;=`)]<%lO(oiIyX|W!O`Or(ors&osv(owx'}x#W(o#W#XJf#X;'S(o;'S;=`)]<%lO(oiJmX|W!O`Or(ors&osv(owx'}x#T(o#T#UKY#U;'S(o;'S;=`)]<%lO(oiKaX|W!O`Or(ors&osv(owx'}x#h(o#h#iK|#i;'S(o;'S;=`)]<%lO(oiLTX|W!O`Or(ors&osv(owx'}x#T(o#T#UH`#U;'S(o;'S;=`)]<%lO(oiLwX|W!O`Or(ors&osv(owx'}x#c(o#c#dMd#d;'S(o;'S;=`)]<%lO(oiMkX|W!O`Or(ors&osv(owx'}x#V(o#V#WNW#W;'S(o;'S;=`)]<%lO(oiN_X|W!O`Or(ors&osv(owx'}x#h(o#h#iNz#i;'S(o;'S;=`)]<%lO(oi! RX|W!O`Or(ors&osv(owx'}x#m(o#m#n! n#n;'S(o;'S;=`)]<%lO(oi! uX|W!O`Or(ors&osv(owx'}x#d(o#d#e!!b#e;'S(o;'S;=`)]<%lO(oi!!iX|W!O`Or(ors&osv(owx'}x#X(o#X#Y?y#Y;'S(o;'S;=`)]<%lO(oi!#_V!SP|W!O`Or(ors&osv(owx'}x;'S(o;'S;=`)]<%lO(ok!$PXaQVP|W!O`Or$qrs%gsv$qwx'^x!^$q!^!_(o!_;'S$q;'S;=`)c<%lO$qo!$wX[UVP|W!O`Or$qrs%gsv$qwx'^x!^$q!^!_(o!_;'S$q;'S;=`)c<%lO$qk!%mZVP|W!O`Or$qrs%gsv$qwx'^x!^$q!^!_(o!_!`$q!`!a!&`!a;'S$q;'S;=`)c<%lO$qk!&kX!RQVP|W!O`Or$qrs%gsv$qwx'^x!^$q!^!_(o!_;'S$q;'S;=`)c<%lO$qk!'aZVP|W!O`Or$qrs%gsv$qwx'^x!^$q!^!_(o!_#P$q#P#Q!(S#Q;'S$q;'S;=`)c<%lO$qk!(]ZVP|W!O`Or$qrs%gsv$qwx'^x!^$q!^!_(o!_!`$q!`!a!)O!a;'S$q;'S;=`)c<%lO$qk!)ZXxQVP|W!O`Or$qrs%gsv$qwx'^x!^$q!^!_(o!_;'S$q;'S;=`)c<%lO$q",tokenizers:[lt,it,st,mt,0,1,2,3,4],topRules:{Document:[0,6]},tokenPrec:0});function T(t,e){let O=e&&e.getChild("TagName");return O?t.sliceString(O.from,O.to):""}function P(t,e){let O=e&&e.firstChild;return!O||O.name!="OpenTag"?"":T(t,O)}function $t(t,e,O){let o=e&&e.getChildren("Attribute").find(a=>a.from<=O&&a.to>=O),r=o&&o.getChild("AttributeName");return r?t.sliceString(r.from,r.to):""}function C(t){for(let e=t&&t.parent;e;e=e.parent)if(e.name=="Element")return e;return null}function gt(t,e){var O;let o=A(t).resolveInner(e,-1),r=null;for(let a=o;!r&&a.parent;a=a.parent)(a.name=="OpenTag"||a.name=="CloseTag"||a.name=="SelfClosingTag"||a.name=="MismatchedCloseTag")&&(r=a);if(r&&(r.to>e||r.lastChild.type.isError)){let a=r.parent;if(o.name=="TagName")return r.name=="CloseTag"||r.name=="MismatchedCloseTag"?{type:"closeTag",from:o.from,context:a}:{type:"openTag",from:o.from,context:C(a)};if(o.name=="AttributeName")return{type:"attrName",from:o.from,context:r};if(o.name=="AttributeValue")return{type:"attrValue",from:o.from,context:r};let i=o==r||o.name=="Attribute"?o.childBefore(e):o;return i?.name=="StartTag"?{type:"openTag",from:e,context:C(a)}:i?.name=="StartCloseTag"&&i.to<=e?{type:"closeTag",from:e,context:a}:i?.name=="Is"?{type:"attrValue",from:e,context:r}:i?{type:"attrName",from:e,context:r}:null}else if(o.name=="StartCloseTag")return{type:"closeTag",from:e,context:o.parent};for(;o.parent&&o.to==e&&!(!((O=o.lastChild)===null||O===void 0)&&O.type.isError);)o=o.parent;return o.name=="Element"||o.name=="Text"||o.name=="Document"?{type:"tag",from:e,context:o.name=="Element"?o:C(o)}:null}class St{constructor(e,O,o){this.attrs=O,this.attrValues=o,this.children=[],this.name=e.name,this.completion=Object.assign(Object.assign({type:"type"},e.completion||{}),{label:this.name}),this.openCompletion=Object.assign(Object.assign({},this.completion),{label:"<"+this.name}),this.closeCompletion=Object.assign(Object.assign({},this.completion),{label:"</"+this.name+">",boost:2}),this.closeNameCompletion=Object.assign(Object.assign({},this.completion),{label:this.name+">"}),this.text=e.textContent?e.textContent.map(r=>({label:r,type:"text"})):[]}}const b=/^[:\-\.\w\u00b7-\uffff]*$/;function E(t){return Object.assign(Object.assign({type:"property"},t.completion||{}),{label:t.name})}function R(t){return typeof t=="string"?{label:`"${t}"`,type:"constant"}:/^"/.test(t.label)?t:Object.assign(Object.assign({},t),{label:`"${t.label}"`})}function dt(t,e){let O=[],o=[],r=Object.create(null);for(let n of e){let c=E(n);O.push(c),n.global&&o.push(c),n.values&&(r[n.name]=n.values.map(R))}let a=[],i=[],f=Object.create(null);for(let n of t){let c=o,m=r;n.attributes&&(c=c.concat(n.attributes.map(l=>typeof l=="string"?O.find(u=>u.label==l)||{label:l,type:"property"}:(l.values&&(m==r&&(m=Object.create(m)),m[l.name]=l.values.map(R)),E(l)))));let S=new St(n,c,m);f[S.name]=S,a.push(S),n.top&&i.push(S)}i.length||(i=a);for(let n=0;n<a.length;n++){let c=t[n],m=a[n];if(c.children)for(let S of c.children)f[S]&&m.children.push(f[S]);else m.children=a}return n=>{var c;let{doc:m}=n.state,S=gt(n.state,n.pos);if(!S||S.type=="tag"&&!n.explicit)return null;let{type:l,from:u,context:$}=S;if(l=="openTag"){let s=i,p=P(m,$);if(p){let g=f[p];s=g?.children||a}return{from:u,options:s.map(g=>g.completion),validFor:b}}else if(l=="closeTag"){let s=P(m,$);return s?{from:u,to:n.pos+(m.sliceString(n.pos,n.pos+1)==">"?1:0),options:[((c=f[s])===null||c===void 0?void 0:c.closeNameCompletion)||{label:s+">",type:"type"}],validFor:b}:null}else if(l=="attrName"){let s=f[T(m,$)];return{from:u,options:s?.attrs||o,validFor:b}}else if(l=="attrValue"){let s=$t(m,$,u);if(!s)return null;let p=f[T(m,$)],g=(p?.attrValues||r)[s];return!g||!g.length?null:{from:u,to:n.pos+(m.sliceString(n.pos,n.pos+1)=='"'?1:0),options:g,validFor:/^"[^"]*"?$/}}else if(l=="tag"){let s=P(m,$),p=f[s],g=[],q=$&&$.lastChild;s&&(!q||q.name!="CloseTag"||T(m,q)!=s)&&g.push(p?p.closeCompletion:{label:"</"+s+">",type:"type",boost:2});let v=g.concat((p?.children||($?a:i)).map(x=>x.openCompletion));if($&&p?.text.length){let x=$.firstChild;x.to>n.pos-20&&!/\S/.test(n.state.sliceDoc(x.to,n.pos))&&(v=v.concat(p.text))}return{from:u,options:v,validFor:/^<\/?[:\-\.\w\u00b7-\uffff]*$/}}else return null}}const w=j.define({name:"xml",parser:ct.configure({props:[D.add({Element(t){let e=/^\s*<\//.test(t.textAfter);return t.lineIndent(t.node.from)+(e?0:t.unit)},"OpenTag CloseTag SelfClosingTag"(t){return t.column(t.node.from)+t.unit}}),B.add({Element(t){let e=t.firstChild,O=t.lastChild;return!e||e.name!="OpenTag"?null:{from:e.to,to:O.name=="CloseTag"?O.from:t.to}}}),M.add({"OpenTag CloseTag":t=>t.getChild("TagName")})]}),languageData:{commentTokens:{block:{open:"<!--",close:"-->"}},indentOnInput:/^\s*<\/$/}});function Oo(t={}){let e=[w.data.of({autocomplete:dt(t.elements||[],t.attributes||[])})];return t.autoCloseTags!==!1&&e.push(ft),new Z(w,e)}function k(t,e,O=t.length){if(!e)return"";let o=e.firstChild,r=o&&o.getChild("TagName");return r?t.sliceString(r.from,Math.min(r.to,O)):""}const ft=Y.inputHandler.of((t,e,O,o,r)=>{if(t.composing||t.state.readOnly||e!=O||o!=">"&&o!="/"||!w.isActiveAt(t.state,e,-1))return!1;let a=r(),{state:i}=a,f=i.changeByRange(n=>{var c,m,S;let{head:l}=n,u=i.doc.sliceString(l-1,l)==o,$=A(i).resolveInner(l,-1),s;if(u&&o==">"&&$.name=="EndTag"){let p=$.parent;if(((m=(c=p.parent)===null||c===void 0?void 0:c.lastChild)===null||m===void 0?void 0:m.name)!="CloseTag"&&(s=k(i.doc,p.parent,l))){let g=l+(i.doc.sliceString(l,l+1)===">"?1:0),q=`</${s}>`;return{range:n,changes:{from:l,to:g,insert:q}}}}else if(u&&o=="/"&&$.name=="StartCloseTag"){let p=$.parent;if($.from==l-2&&((S=p.lastChild)===null||S===void 0?void 0:S.name)!="CloseTag"&&(s=k(i.doc,p,l))){let g=l+(i.doc.sliceString(l,l+1)===">"?1:0),q=`${s}>`;return{range:U.cursor(l+q.length,-1),changes:{from:l,to:g,insert:q}}}}return{range:n}});return f.changes.empty?!1:(t.dispatch([a,i.update(f,{userEvent:"input.complete",scrollIntoView:!0})]),!0)});export{ft as autoCloseTags,dt as completeFromSchema,Oo as xml,w as xmlLanguage};
//# sourceMappingURL=index-DVVp7xsp.js.map
