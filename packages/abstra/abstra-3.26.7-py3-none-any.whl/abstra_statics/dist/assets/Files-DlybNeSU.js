const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/ImageViewer-Ce_zD7hk.js","assets/asyncComputed-3zrnCYug.js","assets/jwt-decode.esm-Dw_OlTCW.js","assets/jwt-decode-D9e-DIPp.css","assets/string-BuQ9zSDy.js","assets/PhArrowUp.vue-CdDYoNSG.js","assets/PhFolderPlus.vue-Cl7z2UQz.js","assets/PhWebhooksLogo.vue-BZ5oEMJy.js","assets/AbstraButton.vue_vue_type_script_setup_true_lang-60wd7w0p.js","assets/ScrollArea.vue_vue_type_script_setup_true_lang-BhCwSPN5.js","assets/index-BNW_czQY.js","assets/UploadOutlined-9uYjWBQ1.js","assets/router-DzczyMew.js","assets/ts.worker-5sEEipil.js","assets/index-4hy9Zjs6.js","assets/xlsx-sIPcJk3-.js","assets/ImageViewer-uN72ahlU.css"])))=>i.map(i=>d[i]);
import{_ as R}from"./DocsButton.vue_vue_type_script_setup_true_lang-4fYs65kc.js";import{F as A,I as q,S as H,a as J}from"./ImageViewer-Ce_zD7hk.js";import{_ as U,a as L,ag as E,r as h,J as N,q as O,k as v,m as W,f as n,h as d,n as x,u as l,b4 as D,t as y,aK as M,O as $,w as g,g as I,i as F,ak as K,aN as Y,F as S,R as G,$ as Q,b as C,e as X,Y as Z}from"./jwt-decode.esm-Dw_OlTCW.js";import"./router-DzczyMew.js";import{F as P}from"./file-oQhfP6ps.js";import"./tables-CkY-LQhC.js";import{e as B}from"./editor.main-ys9l7DM7.js";import{G as ee}from"./PhFolderPlus.vue-Cl7z2UQz.js";import{T as te,A as V,C as ae}from"./index-FhuFwKwr.js";import"./constants-DtajWhvQ.js";import"./asyncComputed-3zrnCYug.js";import"./string-BuQ9zSDy.js";import"./PhArrowUp.vue-CdDYoNSG.js";import"./PhWebhooksLogo.vue-BZ5oEMJy.js";import"./AbstraButton.vue_vue_type_script_setup_true_lang-60wd7w0p.js";import"./ScrollArea.vue_vue_type_script_setup_true_lang-BhCwSPN5.js";import"./index-BNW_czQY.js";import"./UploadOutlined-9uYjWBQ1.js";import"./index-4hy9Zjs6.js";import"./xlsx-sIPcJk3-.js";import"./ts.worker-5sEEipil.js";import"./record-BTRCUCPd.js";(function(){try{var p=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},e=new Error().stack;e&&(p._sentryDebugIds=p._sentryDebugIds||{},p._sentryDebugIds[e]="8af65834-d00d-4a7c-b3bf-d7cc592540a9",p._sentryDebugIdIdentifier="sentry-dbid-8af65834-d00d-4a7c-b3bf-d7cc592540a9")}catch{}})();class se{constructor(e){this.filesModel=e}async list(e){const i=await this.filesModel.list(e.limit||20,e.offset||0,e.search,e.path);return{items:i.items.map(r=>this.mapToFileItem(r)),totalCount:i.totalCount}}async upload(e,i,r){await this.filesModel.upload(e,i,r)}async delete(e){await this.filesModel.delete(e)}async download(e){return await this.filesModel.download(e)}async createFolder(e){await this.filesModel.createFolder(e)}async move(e,i){await this.filesModel.move(e,i)}async preview(e){const i=await this.filesModel.download(e),r=e.split("/").pop()||e,{FileTypeHelper:_}=await U(async()=>{const{FileTypeHelper:u}=await import("./ImageViewer-Ce_zD7hk.js").then(b=>b.f);return{FileTypeHelper:u}},__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16])),a=_.getMimeType(r);return{blob:new Blob([i],{type:a}),mimeType:a}}mapToFileItem(e){return{name:e.name,path:e.path,type:e.type,size:e.sizeBytes,_original:e}}}const oe={key:0,class:"loading-container"},le={key:1,class:"error-container"},ne={class:"error-message"},ie=L({__name:"ConsoleFileAdapter",props:{filePath:{},loadingText:{default:"Loading file..."}},setup(p){const e=p,r=E().params.projectId,_=h(!0),a=h(null),t=h(null),u=h(null),b=w=>{const f=w.toLowerCase().split(".").pop();return["txt","md","json","js","ts","jsx","tsx","py","html","css","scss","yaml","yml","xml","sql","sh","vue","csv"].includes(f||"")};return N(async()=>{try{const f=await P.fromProjectId(r).download(e.filePath);if(f.size<1e3){const T=await f.slice(0,f.size,f.type).text();if(T.includes("<!DOCTYPE")||T.includes("<html"))throw new Error("Downloaded file appears to be an HTML error page")}if(t.value=URL.createObjectURL(f),b(e.filePath)&&(u.value=await f.text(),e.filePath.toLowerCase().endsWith(".json")))try{const k=JSON.parse(u.value);u.value=JSON.stringify(k,null,2)}catch{}}catch(w){a.value=`Failed to load file: ${String(w)}`}finally{_.value=!1}}),O(()=>{t.value&&URL.revokeObjectURL(t.value)}),(w,f)=>_.value?(n(),v("div",oe,[d(l(D),{size:"large"}),x("p",null,y(p.loadingText),1)])):a.value?(n(),v("div",le,[x("p",ne,y(a.value),1)])):W(w.$slots,"default",{key:2,blobUrl:t.value,fileContent:u.value},void 0,!0)}}),re=M(ie,[["__scopeId","data-v-3ce1506a"]]),ce={key:0,class:"loading-container"},de={key:1,class:"error-container"},pe={class:"error-message"},ue=L({__name:"CodeViewer",props:{content:{},language:{default:"plaintext"},loadingText:{default:"Loading..."},readonly:{type:Boolean,default:!0}},setup(p){const e=p,i=h(!1),r=h(null),_=h();let a=null;return N(()=>{if(_.value)try{a=B.create(_.value,{value:e.content,language:e.language,readOnly:e.readonly,theme:"vs",automaticLayout:!0,minimap:{enabled:!1},scrollBeyondLastLine:!1,lineNumbers:"on",renderWhitespace:"selection",folding:!0,wordWrap:"on",quickSuggestions:!1,parameterHints:{enabled:!1},suggestOnTriggerCharacters:!1,acceptSuggestionOnCommitCharacter:!1,tabCompletion:"off",wordBasedSuggestions:!1})}catch(t){console.error("[CodeViewer] Failed to create editor:",t),r.value=`Failed to create editor: ${String(t)}`}}),$(()=>e.content,t=>{a&&t!==a.getValue()&&a.setValue(t)}),$(()=>e.language,t=>{if(a){const u=a.getModel();u&&B.setModelLanguage(u,t)}}),O(()=>{a?.dispose()}),(t,u)=>i.value?(n(),v("div",ce,[d(l(D),{size:"large"}),x("p",null,y(p.loadingText),1)])):r.value?(n(),v("div",de,[x("p",pe,y(r.value),1)])):(n(),v("div",{key:2,ref_key:"editorContainer",ref:_,class:"code-viewer-container"},null,512))}}),fe=M(ue,[["__scopeId","data-v-f3162ce8"]]),me={class:"files-container"},ge={class:"tab-content"},_e={key:1,class:"pdf-viewer-container"},ye=["data"],ve={class:"pdf-fallback"},he={key:1,class:"pdf-loading"},we=L({__name:"Files",setup(p){const i=E().params.projectId,r=P.fromProjectId(i),_=new se(r),a=h("all-files"),t=h([]);function u(o){const c=o.split("/").pop()||o,s=t.value.find(j=>j.path===o);if(s){a.value=s.key;return}const m={key:`file-${Date.now()}`,name:c,path:o};t.value.push(m),a.value=m.key}function b(o,c){if(c==="remove"&&typeof o=="string"){const s=t.value.findIndex(m=>m.key===o);s!==-1&&(t.value.splice(s,1),t.value.length>0?a.value=t.value[Math.max(0,s-1)].key:a.value="all-files")}}function w(o){return J.getFileIcon(o)}function f(o){const c=o.toLowerCase().split(".").pop();return["jpg","jpeg","png","gif","webp","svg","bmp","ico"].includes(c||"")}function k(o){return o.toLowerCase().split(".").pop()==="pdf"}function T(o){const c=o.toLowerCase().split(".").pop();return["xlsx","xls","csv"].includes(c||"")}function z(o){const c=o.toLowerCase().split(".").pop();return{json:"json",py:"python",js:"javascript",ts:"typescript",jsx:"javascript",tsx:"typescript",html:"html",css:"css",scss:"scss",md:"markdown",yaml:"yaml",yml:"yaml",xml:"xml",sql:"sql",sh:"shell",vue:"vue"}[c||""]||"plaintext"}return(o,c)=>(n(),v("div",me,[d(l(K),null,{default:g(()=>[I(y(l(F).translate("i18n_filesview_title")),1)]),_:1}),d(l(Y),null,{default:g(()=>[I(y(l(F).translate("i18n_filesview_description"))+" ",1),d(R,{path:"tools/files"})]),_:1}),d(l(ae),{class:"files-card"},{default:g(()=>[d(l(te),{"active-key":a.value,"onUpdate:activeKey":c[0]||(c[0]=s=>a.value=s),"hide-add":"",type:"editable-card",size:"small",onEdit:b},{default:g(()=>[d(l(V),{key:"all-files",closable:!1},{tab:g(()=>[d(l(S),{align:"center",gap:"small"},{default:g(()=>[d(l(ee),{size:16}),x("span",null,y(l(F).translate("i18n_filesview_all_files")),1)]),_:1})]),default:g(()=>[d(A,{repository:l(_),"show-pagination":!0,"enable-preview":!1,"enable-move":!0,"on-open":u},null,8,["repository"])]),_:1}),(n(!0),v(G,null,Q(t.value,s=>(n(),C(l(V),{key:s.key,closable:!0},{tab:g(()=>[d(l(S),{align:"center",gap:"small"},{default:g(()=>[(n(),C(Z(w(s.name)),{size:16})),I(" "+y(s.name),1)]),_:2},1024)]),default:g(()=>[x("div",ge,[d(re,{"file-path":s.path},{default:g(({blobUrl:m,fileContent:j})=>[f(s.name)&&m?(n(),C(q,{key:0,src:m},null,8,["src"])):k(s.name)?(n(),v("div",_e,[m?(n(),v("object",{key:0,data:m,type:"application/pdf",class:"pdf-object"},[x("p",ve,y(l(F).translate("i18n_filesview_pdf_fallback")),1)],8,ye)):(n(),v("div",he,[x("p",null,y(l(F).translate("i18n_filesview_pdf_loading")),1)]))])):T(s.name)&&m?(n(),C(H,{key:2,"file-path":m,filename:s.name},null,8,["file-path","filename"])):j?(n(),C(fe,{key:3,content:j,language:z(s.name)},null,8,["content","language"])):X("",!0)]),_:2},1032,["file-path"])])]),_:2},1024))),128))]),_:1},8,["active-key"])]),_:1})]))}}),qe=M(we,[["__scopeId","data-v-fa4e28a0"]]);export{qe as default};
//# sourceMappingURL=Files-DlybNeSU.js.map
