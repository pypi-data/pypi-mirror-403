/**
 * Copyright 2024 Huawei Technologies Co., Ltd
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

#ifndef MINDSPORE_MINDSPORE_CCSRC_PYBIND_API_IR_TENSOR_FUNC_UTILS_H_
#define MINDSPORE_MINDSPORE_CCSRC_PYBIND_API_IR_TENSOR_FUNC_UTILS_H_

#include <memory>
#include "utils/ms_context.h"
#include "pybind11/pybind11.h"
#include "include/utils/visible.h"

namespace py = pybind11;
namespace mindspore {
namespace tensor {
enum TensorPyboostMethod : int {
  kUpsampleNearest1DReg,
  kSquareReg,
  kNormalTensorTensorReg,
  kSilentCheckV3Reg,
  kConvolutionStrGradReg,
  kMaximumReg,
  kNsaCompressReg,
  kFloorDivScalarReg,
  kLerpScalarReg,
  kFmodTensorReg,
  kAdaptiveMaxPool2DGradReg,
  kInplaceEluReg,
  kInplaceScatterAddReg,
  kErfcReg,
  kBitwiseAndScalarReg,
  kBatchNormGatherStatsWithCountsReg,
  kTensorScatterAddReg,
  kNewFullReg,
  kBitwiseOrScalarReg,
  kNarrowReg,
  kInplaceRemainderTensorTensorReg,
  kEmptyReg,
  kReplicationPad1DGradReg,
  kNewZerosReg,
  kSigmoidReg,
  kRepeatReg,
  kUpsampleBicubic2DGradReg,
  kTakeReg,
  kAddcmulExtReg,
  kFlattenExtReg,
  kNsaSelectAttentionGradReg,
  kInplacePutReg,
  kCumsumExtReg,
  kCountNonZeroReg,
  kAdaptiveAvgPool1DReg,
  kLogSoftmaxGradReg,
  kDenseReg,
  kMaxDimReg,
  kSoftmaxBackwardReg,
  kInplaceGroupedMatmulAddReg,
  kReciprocalReg,
  kInplaceFloorDivideReg,
  kConvTranspose2DReg,
  kMoeTokenPermuteGradReg,
  kSliceExtViewReg,
  kEyeReg,
  kSoftMarginLossReg,
  kRmsNormReg,
  kTypeAsReg,
  kAllGatherMatmulReg,
  kInplaceRemainderTensorScalarReg,
  kSliceReg,
  kConvolutionGradReg,
  kInplaceHardtanhReg,
  kSoftplusExtReg,
  kStdMeanReg,
  kInplaceScatterValueReduceReg,
  kOuterReg,
  kMaskedFillReg,
  kSoftShrinkReg,
  kMoeDistributeDispatchReg,
  kLogAddExpReg,
  kMoeTokenUnpermuteGradReg,
  kInplaceMatmulAddReg,
  kIndexAddExtReg,
  kSinReg,
  kBatchNormReduceGradReg,
  kAcoshExtReg,
  kArgMinExtReg,
  kMoeDistributeCombineReg,
  kProdExtReg,
  kCrossReg,
  kBitwiseNotReg,
  kBinaryCrossEntropyGradReg,
  kInplaceSignReg,
  kEmbeddingReg,
  kMishExtReg,
  kMulsReg,
  kIsCloseReg,
  kPagedAttentionReg,
  kReduceMinReg,
  kSoftShrinkGradReg,
  kUpsampleTrilinear3DReg,
  kErfReg,
  kMaskedSelectReg,
  kReluGradReg,
  kMvReg,
  kLogSigmoidGradReg,
  kLeakyReLUExtReg,
  kSmoothL1LossReg,
  kBatchNormExtReg,
  kNewOnesReg,
  kGatherNdExtReg,
  kMedianDimReg,
  kNLLLossReg,
  kNotEqualReg,
  kReduceMaxReg,
  kStackExtReg,
  kConv1DExtReg,
  kSumExtReg,
  kMatMulReg,
  kReLUReg,
  kBitwiseOrTensorReg,
  kMedianExtReg,
  kReplicationPad2DReg,
  kReshapeReg,
  kGluGradReg,
  kThresholdGradReg,
  kScatterAddExtReg,
  kIndexFillTensorReg,
  kInplaceDivModReg,
  kAtanExtReg,
  kLayerNormExtReg,
  kAdamWReg,
  kSubScalarReg,
  kLogSumExpReg,
  kPReLUReg,
  kHShrinkReg,
  kFracReg,
  kSubReg,
  kInplaceDivsReg,
  kRandnReg,
  kInplaceZeroReg,
  kEmptyLikeReg,
  kLogSoftmaxExtReg,
  kFillTensorReg,
  kLogSoftmaxReg,
  kGatherDGradV2Reg,
  kAtan2ExtReg,
  kReflectionPad1DGradReg,
  kSelectExtViewReg,
  kSoftMarginLossGradReg,
  kKLDivGradReg,
  kNansumReg,
  kBitwiseAndTensorReg,
  kGreaterEqualScalarReg,
  kNormalFloatFloatReg,
  kFloorDivReg,
  kTruncReg,
  kLayerNormGradExtReg,
  kHardtanhGradReg,
  kGridSampler2DReg,
  kAddbmmReg,
  kChunkViewReg,
  kUpsampleNearest1DGradReg,
  kUniqueConsecutiveReg,
  kAdaptiveAvgPool3DGradExtReg,
  kInplaceMaskedScatterReg,
  kMmReg,
  kAddmmReg,
  kRandnLikeReg,
  kBernoulliExtReg,
  kViewDtypeReg,
  kReflectionPad2DReg,
  kSpeedFusionAttentionGradReg,
  kInnerInplaceIndexPutReg,
  kInplaceLogReg,
  kAvgPool2DReg,
  kFmodScalarReg,
  kAvgPool1DReg,
  kMoeTokenPermuteReg,
  kReplicationPad1DReg,
  kCol2ImGradReg,
  kCastReg,
  kRotaryPositionEmbeddingGradReg,
  kReplicationPad3DGradReg,
  kGcdReg,
  kBatchMatMulReg,
  kReplicationPad2DGradReg,
  kIm2ColExtReg,
  kInnerUniqueReg,
  kRotaryPositionEmbeddingReg,
  kToDeviceReg,
  kRollReg,
  kThresholdReg,
  kMeanExtReg,
  kInplaceThresholdReg,
  kConv1DPaddingReg,
  kLogicalXorReg,
  kMSELossGradExtReg,
  kLogSigmoidReg,
  kNormalFloatTensorReg,
  kCumminExtReg,
  kFlashAttentionScoreGradReg,
  kInplaceFloorReg,
  kHShrinkGradReg,
  kImagViewReg,
  kAsinhExtReg,
  kRepeatInterleaveIntReg,
  kMulReg,
  kArangeReg,
  kFullLikeReg,
  kRandExtReg,
  kXlogyReg,
  kIsNegInfReg,
  kBroadcastToViewReg,
  kBaddbmmReg,
  kSelectV2Reg,
  kRandIntReg,
  kExp2Reg,
  kArgSortReg,
  kInplaceFloorDividesReg,
  kNLLLossGradReg,
  kAtanhReg,
  kInplaceSubScalarReg,
  kAvgPool2DGradReg,
  kSincReg,
  kMaxPoolGradWithMaskReg,
  kInplaceDivModsReg,
  kMaxUnpool2DExtReg,
  kDivModsReg,
  kInplaceScatterSrcReg,
  kTanhGradReg,
  kMaxPoolWithIndicesReg,
  kKLDivReg,
  kGeluExtReg,
  kPReLUGradReg,
  kGLUReg,
  kViewAsReg,
  kAsinExtReg,
  kAddLayerNormGradReg,
  kExpandAsReg,
  kRandLikeExtReg,
  kNLLLoss2dGradReg,
  kSignReg,
  kVarReg,
  kConvolutionStrReg,
  kIndexSelectReg,
  kInnerNonZeroReg,
  kInplaceFillScalarReg,
  kCoshReg,
  kL1LossExtReg,
  kPromptFlashAttentionReg,
  kInplaceMaskedFillScalarReg,
  kMaxPoolGradWithIndicesReg,
  kConv3DExtReg,
  kRemainderScalarTensorReg,
  kTransposeExtViewReg,
  kMinimumReg,
  kNsaCompressAttentionReg,
  kDropoutDoMaskExtReg,
  kPowReg,
  kRandIntLikeReg,
  kUpsampleBicubic2DReg,
  kSwigluReg,
  kDivModReg,
  kLinalgQrReg,
  kInplaceIndexFillScalarReg,
  kCummaxReg,
  kIsFiniteReg,
  kLogReg,
  kSpeedFusionAttentionReg,
  kAdaptiveAvgPool3DExtReg,
  kTriangularSolveReg,
  kRsqrtReg,
  kIndexFillScalarReg,
  kMultiScaleDeformableAttnGradReg,
  kAddLayerNormV2Reg,
  kMaskedSelectGradReg,
  kHistcExtReg,
  kSqueezeReg,
  kNsaSelectAttentionReg,
  kSilentCheckV2Reg,
  kDequantSwigluQuantReg,
  kInplaceScatterSrcReduceReg,
  kRmsNormGradReg,
  kXLogYScalarSelfReg,
  kLeakyReLUGradExtReg,
  kLogAddExp2Reg,
  kClampTensorReg,
  kSoftplusGradExtReg,
  kUpsampleNearest2DGradReg,
  kAddScalarReg,
  kNanToNumReg,
  kReflectionPad3DGradReg,
  kInplaceAddsExtReg,
  kReflectionPad3DReg,
  kDiagonalViewReg,
  kSplitReg,
  kAsStridedReg,
  kTExtReg,
  kInplaceSubExtReg,
  kBinaryCrossEntropyReg,
  kDropoutGradExtReg,
  kBinaryCrossEntropyWithLogitsBackwardReg,
  kInplaceBernoulliTensorReg,
  kOnesReg,
  kAvgPool3DGradExtReg,
  kNLLLoss2dReg,
  kFFNExtReg,
  kSoftmaxReg,
  kInplaceRandomReg,
  kCol2ImExtReg,
  kDotReg,
  kExpm1Reg,
  kLerpReg,
  kUnstackExtViewReg,
  kInplaceMulsReg,
  kHSwishGradReg,
  kLessReg,
  kSliceExtReg,
  kInplaceExpReg,
  kAcosExtReg,
  kRandpermExtReg,
  kCrossEntropyLossReg,
  kTileReg,
  kTanhReg,
  kCeilReg,
  kToDtypeReg,
  kMinDimReg,
  kGreaterEqualReg,
  kMlaReg,
  kAbsReg,
  kCrossEntropyLossGradReg,
  kEluGradExtReg,
  kSwigluGradReg,
  kOnesLikeExtReg,
  kBroadcastToReg,
  kConcatReg,
  kInplaceIndexPutReg,
  kSearchSortedReg,
  kGroupNormReg,
  kUniformExtReg,
  kRepeatInterleaveGradReg,
  kGridSampler3DGradReg,
  kOneHotExtReg,
  kSinhReg,
  kKthvalueReg,
  kUpsampleLinear1DGradReg,
  kBatchNormElemtGradReg,
  kSeLUExtReg,
  kInplaceNormalReg,
  kLogicalAndReg,
  kInplaceUniformReg,
  kDiagExtReg,
  kRemainderTensorScalarReg,
  kConv3DPaddingReg,
  kGridSampler2DGradReg,
  kReplicationPad3DReg,
  kAddcdivExtReg,
  kInplaceCopyReg,
  kReshapeAndCacheReg,
  kAdaptiveMaxPool1DReg,
  kPolarReg,
  kNormReg,
  kSeluGradReg,
  kSubExtReg,
  kCosReg,
  kArgMaxExtReg,
  kMultinomialExtReg,
  kRemainderTensorTensorReg,
  kReduceAnyReg,
  kFlashAttentionScoreReg,
  kChunkReg,
  kMaxPoolWithMaskReg,
  kConv2DExtReg,
  kSplitWithSizeReg,
  kSelectReg,
  kNormalTensorFloatReg,
  kUpsampleTrilinear3DGradReg,
  kMatrixInverseExtReg,
  kNsaCompressGradReg,
  kBatchNormStatsReg,
  kMishGradExtReg,
  kInplaceSiLUReg,
  kInplaceStopGradientReg,
  kArgMinWithValueReg,
  kInplaceScatterValueReg,
  kExpandDimsReg,
  kAvgPool3DExtReg,
  kAddmvReg,
  kSplitTensorViewReg,
  kClampMinReg,
  kMaskedFillScalarReg,
  kRepeatInterleaveTensorReg,
  kGeluGradExtReg,
  kInplaceIndexFillTensorReg,
  kReduceAllReg,
  kDropoutExtReg,
  kUpsampleNearest2DReg,
  kUpsampleBilinear2DGradReg,
  kTriuReg,
  kMatMulExtReg,
  kXLogYScalarOtherReg,
  kUpsampleNearest3DReg,
  kNonZeroReg,
  kIsInfReg,
  kMSELossExtReg,
  kInplaceSigmoidReg,
  kNegReg,
  kUnique2Reg,
  kAddReg,
  kL1LossBackwardExtReg,
  kNonZeroExtReg,
  kEqualReg,
  kGeneratorReg,
  kGeLUGradReg,
  kAdaptiveAvgPool2DExtReg,
  kSplitWithSizeViewReg,
  kInplaceClampScalarReg,
  kSortExtReg,
  kZerosReg,
  kEmbeddingDenseBackwardReg,
  kRingAttentionUpdateReg,
  kGeLUReg,
  kInplaceIndexCopyReg,
  kLinSpaceExtReg,
  kInplaceFillTensorReg,
  kInplaceAddmmReg,
  kGridSampler3DReg,
  kGroupNormGradReg,
  kSiLUGradReg,
  kCreateSymmetricMemoryReg,
  kLog10Reg,
  kSplitTensorReg,
  kInplaceMaskedFillTensorReg,
  kExpReg,
  kNarrowViewReg,
  kHSwishReg,
  kInplaceErfinvReg,
  kVarMeanReg,
  kErfinvReg,
  kTransposeReg,
  kBatchNormGradExtReg,
  kMaxReg,
  kPowTensorScalarReg,
  kLessEqualReg,
  kDivsReg,
  kHSigmoidGradReg,
  kExpandDimsViewReg,
  kBitwiseXorTensorReg,
  kTransposeViewReg,
  kTrilExtReg,
  kConvolutionReg,
  kFillScalarReg,
  kViewReg,
  kTopkExtReg,
  kBCEWithLogitsLossReg,
  kReflectionPad1DReg,
  kSmoothL1LossGradReg,
  kLogicalOrReg,
  kReverseV2Reg,
  kInnerMoeTokenUnpermuteReg,
  kInplaceClampTensorReg,
  kIndexReg,
  kAddExtReg,
  kNeScalarReg,
  kCopyReg,
  kMeshgridReg,
  kUpsampleBilinear2DReg,
  kClampScalarReg,
  kBatchMatMulExtReg,
  kFloorReg,
  kGatherDReg,
  kBatchNormElemtReg,
  kPowScalarTensorReg,
  kLog2Reg,
  kInplaceAddExtReg,
  kEqualExtReg,
  kConv2DPaddingReg,
  kEluExtReg,
  kRealViewReg,
  kScatterValueReg,
  kDivReg,
  kInplaceMulReg,
  kGreaterReg,
  kToOtherReg,
  kAdaptiveMaxPool2DReg,
  kAllFiniteReg,
  kInplaceReLUReg,
  kReflectionPad2DGradReg,
  kRoundReg,
  kEqScalarReg,
  kApplyRotaryPosEmbReg,
  kInplaceFillDiagonalReg,
  kAdaptiveAvgPool2DGradExtReg,
  kInplaceDivReg,
  kZerosLikeExtReg,
  kGetDataReg,
  kMatmulReduceScatterReg,
  kMinReg,
  kMultiScaleDeformableAttnReg,
  kInplaceBernoulliScalarReg,
  kLinalgVectorNormReg,
  kBitwiseXorScalarReg,
  kHSigmoidReg,
  kBincountExtReg,
  kInnerIndexReg,
  kSiLUReg,
  kStdReg,
  kHardtanhReg,
  kMaskedScatterReg,
  kConstantPadNDReg,
  kUniqueDimReg,
  kUpsampleNearest3DGradReg,
  kTraceExtReg,
  kLogicalNotReg,
  kLog1pReg,
  kNewEmptyReg,
  kSigmoidGradReg,
  kInplaceTanhReg,
  kSqrtReg,
  kAddRmsNormReg,
  kScatterReg,
  kUpsampleLinear1DReg,
  kInplaceIndexAddExtReg,
  kIncreFlashAttentionReg,
  kCloneReg,
  kArgMaxWithValueReg,
  kDropoutGenMaskExtReg,
  kTanReg,
  kContiguousReg,
  kQuantV2Reg,
  kAddRmsNormQuantV2Reg,
  kKVCacheScatterUpdateReg,
  kQuantBatchMatmulReg,
  kFusedInferAttentionScoreReg,
  kMoeInitRoutingReg,
  kGroupedMatmulReg,
  kMoeGatingTopKSoftmaxReg,
  kMatmulAllReduceAddRmsNormReg,
  kWeightQuantBatchMatmulReg,
  kMoeComputeExpertTokensReg,
  kMoeInitRoutingQuantV2Reg,
  kDynamicQuantExtReg,
  kGroupedMatmulV4Reg,
  kMoeInitRoutingV2Reg,
  kGroupedMatmulV2Reg,
  kQuantMatmulReg,
  kMoeFinalizeRoutingReg,
  kDistCommAllGatherReg,
  kDistCommAllReduceReg,
  kDistCommAllGatherIntoTensorUnevenReg,
  kInnerCommAllGatherReg,
  kDistCommAllGatherIntoTensorReg,
  kInnerCommAllReduceReg,
  kInnerCommIsendReg,
  kDistCommScatterTensorReg,
  kDistCommGatherReg,
  kDistCommIsendReg,
  kInnerCommAllToAllVReg,
  kDistCommIrecvReg,
  kDistCommAllToAllVCReg,
  kDistCommAllToAllVSingleReg,
  kInnerCommReduceScatterReg,
  kDistCommReduceScatterReg,
  kDistCommGatherIntoTensorReg,
  kDistCommAllToAllVReg,
  kDistCommBarrierReg,
  kDistCommReduceReg,
  kDistCommReduceScatterTensorReg,
  kDistCommBatchIsendIrecvReg,
  kDistCommScatterReg,
  kDistCommBroadcastReg,
  kDistCommReduceScatterTensorUnevenReg,
  kInnerCommIrecvReg,
  kFuncDropoutExtReg,
  kAnyReg,
  kFuncMaxPool2DReg,
  kGmmV2Reg,
  kGmmReg,
  kCosineEmbeddingLossReg,
  kGmmBackwardReg,
  kGmmV2BackwardReg,
  kAnyExtReg,
  kGmmV2BackwardFusionReg,
  kInplaceExponentialReg,
  kPixelShuffleReg,
  kEinsumExtReg,
  kDropout2dExtReg,
  kGmmBackwardFusionReg,
  kMoeTokenUnpermuteReg,
};

class TensorPyboostMethodRegister {
 public:
  using PyBoostOp = std::function<py::object(const py::list &args)>;
  static void Register(const TensorPyboostMethod methodName, const PyBoostOp &op) { methods_[methodName] = op; }

  static const PyBoostOp &GetOp(TensorPyboostMethod methodName) { return methods_[methodName]; }

 private:
  inline static std::unordered_map<TensorPyboostMethod, PyBoostOp> methods_;
};
}  // namespace tensor
}  // namespace mindspore

#endif  // MINDSPORE_MINDSPORE_CCSRC_PYBIND_API_IR_TENSOR_FUNC_UTILS_H_
