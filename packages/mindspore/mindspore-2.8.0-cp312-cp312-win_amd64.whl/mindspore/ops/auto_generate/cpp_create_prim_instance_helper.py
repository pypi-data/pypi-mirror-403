# Copyright 2023 Huawei Technologies Co., Ltd
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
# http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
# ============================================================================

"""Operator labels and args default value."""
from mindspore.common import dtype as mstype

op_args_default_value = {
    "AdamW": {"amsgrad": False, "maximize": False},
    "AdamWeightDecay": {"use_locking": False},
    "Addbmm": {"beta": 1, "alpha": 1},
    "AddcdivExt": {"value": 1},
    "AddcmulExt": {"value": 1},
    "Addmm": {"beta": 1, "alpha": 1},
    "Addmv": {"beta": 1, "alpha": 1},
    "AddExt": {"alpha": 1},
    "AddLayerNormV2": {"epsilon": 1e-5, "additionalOut": False},
    "AddRmsNorm": {"epsilon": 1e-6},
    "AddScalar": {"alpha": 1},
    "AllGatherMatmul": {"bias": None, "gather_index": 0, "gather_output": True, "comm_turn": 0, "trans_input": False, "trans_x2": False},
    "ApplyAdamW": {"max_grad_norm": None, "amsgrad": False, "maximize": False},
    "ApplyCamePart2": {"sum_r": None, "global_shape": None},
    "ApplyCamePart3": {"global_shape": None, "use_first_moment": False},
    "ApplyCamePart4": {"global_shape": None},
    "ApplyRotaryPosEmb": {"cos_format": 0},
    "Arange": {"dtype": None},
    "ArgMaxExt": {"dim": None, "keepdim": False},
    "Argmax": {"axis": -1, "output_type": mstype.int32},
    "ArgMaxWithValue": {"axis": 0, "keep_dims": False},
    "ArgMinExt": {"dim": None, "keepdim": False},
    "Argmin": {"axis": -1, "output_type": mstype.int32},
    "ArgMinWithValue": {"axis": 0, "keep_dims": False},
    "ArgSort": {"dim": -1, "descending": False, "stable": False},
    "AsStrided": {"storage_offset": 0},
    "AvgPool1D": {"stride": None, "padding": 0, "ceil_mode": False, "count_include_pad": True},
    "AvgPool2DGrad": {"padding": 0, "ceil_mode": False, "count_include_pad": True, "divisor_override": None},
    "AvgPool2D": {"padding": 0, "ceil_mode": False, "count_include_pad": True, "divisor_override": None},
    "AvgPool3DExt": {"stride": None, "padding": 0, "ceil_mode": False, "count_include_pad": True, "divisor_override": None},
    "AvgPool3DGradExt": {"stride": None, "padding": 0, "ceil_mode": False, "count_include_pad": True, "divisor_override": None},
    "AvgPoolGrad": {"kernel_size": 1, "strides": 1, "pad_mode": 'VALID', "data_format": 'NCHW'},
    "AvgPool": {"kernel_size": 1, "strides": 1, "pad_mode": 'VALID', "data_format": 'NCHW'},
    "Baddbmm": {"beta": 1, "alpha": 1},
    "BatchMatMul": {"transpose_a": False, "transpose_b": False},
    "BatchNormElemt": {"weight": None, "bias": None, "mean": None, "invstd": None, "eps": 1e-5},
    "BatchNormExt": {"weight": None, "bias": None, "running_mean": None, "runnning_var": None, "training": False, "momentum": 0.1, "epsilon": 1e-5},
    "BatchNormGatherStatsWithCounts": {"running_mean": None, "running_var": None, "momentum": 1e-1, "eps": 1e-5, "counts": None},
    "BatchNormGradExt": {"weight": None, "running_mean": None, "running_var": None, "saved_mean": None, "saved_rstd": None, "training": False, "eps": 1e-5, "output_mask": (1, 1, 1)},
    "BatchNormGradGrad": {"is_training": False, "epsilon": 1e-5, "data_format": 'NCHW'},
    "BatchNormGrad": {"is_training": False, "epsilon": 1e-5, "data_format": 'NCHW'},
    "BatchNormGradWithActivation": {"is_training": False, "epsilon": 1e-5, "data_format": 'NCHW'},
    "BatchNormGradWithAddAndActivation": {"is_training": False, "epsilon": 1e-5, "data_format": 'NCHW'},
    "BatchNorm": {"is_training": False, "epsilon": 1e-5, "momentum": 0.1, "data_format": 'NCHW'},
    "BatchNormWithActivation": {"is_training": False, "epsilon": 1e-5, "momentum": 0.1, "data_format": 'NCHW'},
    "BatchNormWithAddAndActivation": {"is_training": False, "epsilon": 1e-5, "momentum": 0.1, "data_format": 'NCHW'},
    "BiasAddGrad": {"data_format": 'NCHW'},
    "BiasAdd": {"data_format": 'NCHW'},
    "BinaryCrossEntropyGrad": {"weight": None, "reduction": 'mean'},
    "BinaryCrossEntropy": {"weight": None, "reduction": 'mean'},
    "BinaryCrossEntropyWithLogitsBackward": {"weight": None, "posWeight": None, "reduction": 'mean'},
    "BCEWithLogitsLoss": {"weight": None, "posWeight": None, "reduction": 'mean'},
    "BincountExt": {"weights": None, "minlength": 0},
    "CdistGrad": {"p": 2.0},
    "Cdist": {"p": 2.0},
    "CeLU": {"alpha": 1.0},
    "CholeskyInverse": {"upper": False},
    "Cholesky": {"upper": False},
    "Chunk": {"dim": 0},
    "ChunkView": {"dim": 0},
    "ClampScalar": {"min": None, "max": None},
    "ClampTensor": {"min": None, "max": None},
    "Col2ImExt": {"dilation": 1, "padding": 0, "stride": 1},
    "Col2ImGrad": {"dilation": 1, "padding": 0, "stride": 1},
    "Concat": {"axis": 0},
    "ConstantPadND": {"value": 0.0},
    "Conv1DExt": {"bias": None, "stride": 1, "padding": 0, "dilation": 1, "groups": 1},
    "Conv1DPadding": {"bias": None, "stride": 1, "padding": 'valid', "dilation": 1, "groups": 1},
    "Conv2DExt": {"bias": None, "stride": 1, "padding": 0, "dilation": 1, "groups": 1},
    "Conv2DPadding": {"bias": None, "stride": 1, "padding": 'valid', "dilation": 1, "groups": 1},
    "Conv3DExt": {"bias": None, "stride": 1, "padding": 0, "dilation": 1, "groups": 1},
    "Conv3DPadding": {"bias": None, "stride": 1, "padding": 'valid', "dilation": 1, "groups": 1},
    "ConvolutionGrad": {"bias": None, "stride": 1, "padding": 0, "dilation": (1, 1), "transposed": False, "output_padding": 0, "groups": 1, "output_mask": ()},
    "Convolution": {"bias": None, "stride": 1, "padding": 0, "dilation": 1, "transposed": False, "output_padding": 0, "groups": 1},
    "ConvolutionStrGrad": {"bias": None, "stride": 1, "padding": 'valid', "dilation": 1, "transposed": False, "output_padding": 0, "groups": 1, "output_mask": ()},
    "ConvolutionStr": {"bias": None, "stride": 1, "padding": 'valid', "dilation": 1, "transposed": False, "output_padding": 0, "groups": 1},
    "ConvTranspose2D": {"bias": None, "stride": 1, "padding": 0, "output_padding": 0, "groups": 1, "dilation": 1},
    "CopyToDevice": {"sync": False},
    "CopyToHost": {"sync": False},
    "Correlate": {"pad_mode": 'valid'},
    "CountNonZero": {"dim": None},
    "CrossEntropyLossGrad": {"weight": None, "grad_zloss": None, "lse_for_zloss": None, "reduction": 'mean', "ignore_index": -100, "label_smoothing": 0.0, "lse_square_scale_for_zloss": 0.0},
    "CrossEntropyLoss": {"weight": None, "reduction": 'mean', "ignore_index": -100, "label_smoothing": 0.0, "lse_square_scale_for_zloss": 0.0, "return_zloss": False},
    "Cross": {"dim": -65530},
    "CumsumExt": {"dtype": None},
    "CumProd": {"exclusive": False, "reverse": False},
    "CumSum": {"exclusive": False, "reverse": False},
    "DCTN": {"type": 2, "s": None, "axes": None, "norm": None},
    "DCT": {"type": 2, "n": None, "axis": -1, "norm": None},
    "Dense": {"bias": None},
    "DequantSwigluQuant": {"bias": None, "quant_scale": None, "quant_offset": None, "group_index": None, "activate_left": False, "quant_mode": 'static'},
    "Detach": {"sync": False},
    "Diagonal": {"offset": 0, "dim1": 0, "dim2": 1},
    "DiagonalView": {"offset": 0, "dim1": 0, "dim2": 1},
    "DiagExt": {"diagonal": 0},
    "DivMods": {"rounding_mode": None},
    "DivMod": {"rounding_mode": None},
    "Dropout": {"keep_prob": 0.5, "Seed0": 0, "Seed1": 0},
    "Eig": {"compute_v": False},
    "EluExt": {"alpha": 1.0},
    "EluGradExt": {"alpha": 1.0, "is_result": False},
    "Elu": {"alpha": 1.0},
    "EmbeddingDenseBackward": {"padding_idx": None, "scale_grad_by_freq": False},
    "Embedding": {"padding_idx": None, "max_norm": None, "norm_type": 2.0, "scale_grad_by_freq": False},
    "EmptyLike": {"dtype": None, "device": None, "pin_memory": False},
    "Empty": {"dtype": None, "device": None, "pin_memory": False},
    "ExtractImagePatches": {"padding": 'VALID'},
    "FFNExt": {"expertTokens": None, "bias1": None, "bias2": None, "scale": None, "offset": None, "deqScale1": None, "deqScale2": None, "antiquant_scale1": None, "antiquant_scale2": None, "antiquant_offset1": None, "antiquant_offset2": None, "activation": 'fastgelu', "inner_precise": 0},
    "FFT2": {"s": None, "dim": (-2, -1), "norm": None},
    "FFTFreq": {"d": 1.0, "dtype": None},
    "FFTN": {"s": None, "dim": None, "norm": None},
    "FFTShift": {"dim": None},
    "FFT": {"n": None, "dim": -1, "norm": None},
    "FFTOrtho": {"axes": None, "forward": True},
    "FFTWithSize": {"norm": 'backward', "onesided": True, "signal_sizes": ()},
    "FillScalar": {"dtype": None},
    "FillTensor": {"dtype": None},
    "FlashAttentionScoreGrad": {"pse_shift": None, "drop_mask": None, "padding_mask": None, "atten_mask": None, "softmax_max": None, "softmax_sum": None, "softmax_in": None, "attention_in": None, "prefix": None, "actual_seq_qlen": None, "actual_seq_kvlen": None, "keep_prob": 1.0, "scale_value": 1.0, "pre_tokens": 65536, "next_tokens": 65536, "inner_precise": 1, "input_layout": 'BSH', "sparse_mode": 0},
    "FlashAttentionScore": {"real_shift": None, "drop_mask": None, "padding_mask": None, "attn_mask": None, "prefix": None, "actual_seq_qlen": None, "actual_seq_kvlen": None, "keep_prob": 1.0, "scale_value": 1.0, "pre_tokens": 2147483647, "next_tokens": 2147483647, "inner_precise": 0, "input_layout": 'BSH', "sparse_mode": 0},
    "FlattenExt": {"start_dim": 0, "end_dim": -1},
    "Free": {"sync": False},
    "FullLike": {"dtype": None},
    "FusedAddTopKDiv": {"activate_type": 0, "is_norm": True, "scale": 2.5, "mapping_num": None, "mapping_table": None, "enable_expert_mapping": False},
    "Gather": {"batch_dims": 0},
    "GeluExt": {"approximate": 'none'},
    "GeluGradExt": {"approximate": 'none'},
    "GenerateEodMaskV2": {"start": 0, "steps": 1, "error_mode": 'cycle', "flip_mode": 'bitflip', "multiply_factor": 0.0, "bit_pos": 0, "flip_probability": 0.0},
    "GetMem": {"target_pe": 0, "non_blocking": False},
    "GLU": {"axis": -1},
    "GridSampler2DGrad": {"interpolation_mode": 'bilinear', "padding_mode": 'zeros', "align_corners": False, "output_mask": (1, 1)},
    "GridSampler2D": {"interpolation_mode": 'bilinear', "padding_mode": 'zeros', "align_corners": False},
    "GridSampler3DGrad": {"interpolation_mode": 'bilinear', "padding_mode": 'zeros', "align_corners": False, "output_mask": (1, 1)},
    "GridSampler3D": {"interpolation_mode": 'bilinear', "padding_mode": 'zeros', "align_corners": False},
    "GroupNormGrad": {"dx_is_require": True, "dgamma_is_require": True, "dbeta_is_require": True},
    "GroupNorm": {"weight": None, "bias": None, "eps": 1e-5},
    "GroupTopk": {"k_inner": 1},
    "HardtanhGrad": {"min_val": -1, "max_val": 1},
    "Hardtanh": {"min_val": -1, "max_val": 1},
    "HFFT2": {"s": None, "dim": (-2, -1), "norm": None},
    "HFFTN": {"s": None, "dim": None, "norm": None},
    "HFFT": {"n": None, "dim": -1, "norm": None},
    "HistcExt": {"bins": 100, "min": 0, "max": 0},
    "HShrinkGrad": {"lambd": 0.5},
    "HShrink": {"lambd": 0.5},
    "IDCTN": {"type": 2, "s": None, "axes": None, "norm": None},
    "IDCT": {"type": 2, "n": None, "axis": -1, "norm": None},
    "IFFT2": {"s": None, "dim": (-2, -1), "norm": None},
    "IFFTN": {"s": None, "dim": None, "norm": None},
    "IFFTShift": {"dim": None},
    "IFFT": {"n": None, "dim": -1, "norm": None},
    "IHFFT2": {"s": None, "dim": (-2, -1), "norm": None},
    "IHFFTN": {"s": None, "dim": None, "norm": None},
    "IHFFT": {"n": None, "dim": -1, "norm": None},
    "Im2ColExt": {"dilation": 1, "padding": 0, "stride": 1},
    "IncreFlashAttention": {"attn_mask": None, "actual_seq_lengths": None, "pse_shift": None, "dequant_scale1": None, "quant_scale1": None, "dequant_scale2": None, "quant_scale2": None, "quant_offset2": None, "antiquant_scale": None, "antiquant_offset": None, "block_table": None, "kv_padding_size": None, "num_heads": 1, "input_layout": 'BSH', "scale_value": 1.0, "num_key_value_heads": 0, "block_size": 0, "inner_precise": 1},
    "IndexAddExt": {"alpha": 1},
    "InnerInplaceIndexPut": {"accumulate": False},
    "InnerMoeTokenUnpermute": {"probs": None, "padded_mode": False, "restore_shape": None},
    "InnerUnique": {"sorted": True, "return_inverse": False},
    "InplaceAddmm": {"beta": 1, "alpha": 1},
    "InplaceAddsExt": {"alpha": 1},
    "InplaceAddExt": {"alpha": 1},
    "InplaceClampScalar": {"min": None, "max": None},
    "InplaceClampTensor": {"min": None, "max": None},
    "InplaceCopy": {"non_blocking": False},
    "InplaceDivMods": {"rounding_mode": None},
    "InplaceDivMod": {"rounding_mode": None},
    "InplaceElu": {"alpha": 1.0},
    "InplaceFillDiagonal": {"wrap": False},
    "InplaceHardtanh": {"min_val": -1, "max_val": 1},
    "InplaceIndexAddExt": {"alpha": 1},
    "InplaceIndexPut": {"accumulate": False},
    "InplacePut": {"accumulate": False},
    "InplaceRandom": {"from_": 0, "to": None, "seed": 0, "offset": 0},
    "InplaceSubExt": {"alpha": 1},
    "InplaceSubScalar": {"alpha": 1},
    "InplaceToDevice": {"device": None, "non_blocking": False},
    "InsertGemV2InBackward": {"start": 0, "steps": 1, "error_mode": 'cycle', "flip_mode": 'bitflip', "multiply_factor": 0.0, "bit_pos": 0, "flip_probability": 0.0},
    "IRFFT2": {"s": None, "dim": (-2, -1), "norm": None},
    "IRFFTN": {"s": None, "dim": None, "norm": None},
    "IRFFTDouble": {"dim": -1},
    "IRFFT": {"n": None, "dim": -1, "norm": None},
    "IsClose": {"rtol": 1e-05, "atol": 1e-08, "equal_nan": False},
    "KLDivGrad": {"reduction": 'mean', "log_target": False},
    "KLDiv": {"reduction": 'mean', "log_target": False},
    "Kthvalue": {"dim": -1, "keepdim": False},
    "L1LossBackwardExt": {"reduction": 'mean'},
    "L1LossExt": {"reduction": 'mean'},
    "LayerNormExt": {"weight": None, "bias": None, "eps": 1e-5},
    "LayerNormGradExt": {"output_mask": (1, 1, 1)},
    "LayerNormGradGrad": {"begin_norm_axis": 1, "begin_params_axis": 1},
    "LayerNormGrad": {"begin_norm_axis": 1, "begin_params_axis": 1},
    "LayerNormGradV3": {"begin_norm_axis": 1, "begin_params_axis": 1},
    "LayerNorm": {"begin_norm_axis": 1, "begin_params_axis": 1, "epsilon": 1e-7},
    "LayerNormV3": {"begin_norm_axis": 1, "begin_params_axis": 1, "epsilon": 1e-7},
    "LeakyReLUExt": {"negative_slope": 0.01},
    "LeakyReLUGradExt": {"negative_slope": 0.01, "is_result": False},
    "LinalgQr": {"mode": 'reduced'},
    "LinalgVectorNorm": {"ord": 2, "dim": None, "keepdim": False, "dtype": None},
    "LinSpaceExt": {"dtype": None},
    "LogitGrad": {"eps": -1.0},
    "Logit": {"eps": -1.0},
    "LogSumExp": {"keepdim": False},
    "LogSoftmaxExt": {"dim": None, "dtype": None},
    "LogSoftmaxGrad": {"axis": -1},
    "LogSoftmax": {"axis": -1},
    "LpNormV2": {"p": 2, "dim": None, "keepdim": False, "epsilon": 1e-12},
    "LstsqV2": {"driver": None},
    "MatMul": {"transpose_a": False, "transpose_b": False},
    "MatmulReduceScatter": {"reduce_op": 'sum', "bias": None, "comm_turn": 0, "trans_input": False, "trans_x2": False},
    "MaximumGradGrad": {"grad_x": True, "grad_y": True},
    "MaximumGrad": {"grad_x": True, "grad_y": True},
    "MaxDim": {"keepdim": False},
    "MaxPoolGradWithIndices": {"strides": None, "pads": 0, "dilation": (1, 1), "ceil_mode": False, "argmax_type": mstype.int64},
    "MaxPoolGradWithMask": {"strides": None, "pads": 0, "dilation": (1, 1), "ceil_mode": False, "argmax_type": mstype.int64},
    "MaxPoolWithIndices": {"strides": None, "pads": 0, "dilation": (1, 1), "ceil_mode": False, "argmax_type": mstype.int64},
    "MaxPoolWithMask": {"strides": None, "pads": 0, "dilation": (1, 1), "ceil_mode": False, "argmax_type": mstype.int64},
    "MaxUnpool2DExt": {"stride": None, "padding": 0, "output_size": None},
    "MeanExt": {"dim": None, "keepdim": False, "dtype": None},
    "MedianDim": {"dim": -1, "keepdim": False},
    "Meshgrid": {"indexing": 'xy'},
    "MinimumGrad": {"grad_x": True, "grad_y": True},
    "MinDim": {"keepdim": False},
    "Mla": {"attn_mask": None, "deq_scale_qk": None, "deq_scale_pv": None, "q_seq_lens": None, "context_lens": None, "head_num": 32, "scale_value": 0.0, "kv_head_num": 1, "mask_mode": 'MASK_NONE', "is_ring": 0},
    "MlaPreprocess": {"param_cache_mode": 0},
    "MoeDistributeCombine": {"tp_send_counts": None, "x_active_mask": None, "activate_scale": None, "weight_scale": None, "group_list": None, "expand_scales": None, "group_ep": None, "group_tp": None, "tp_world_size": 0, "tp_rank_id": 0, "expert_shard_type": 0, "shared_expert_num": 0, "shared_export_rank_num": 0, "global_bs": 0, "out_dtype": 0, "common_quant_mode": 0, "group_list_type": 0},
    "MoeDistributeDispatch": {"expert_scales": None, "scales": None, "x_active_mask": None, "group_ep": None, "group_tp": None, "tp_world_size": 0, "tp_rank_id": 0, "expert_shard_type": 0, "shared_expert_num": 0, "shared_expert_rank_num": 0, "quant_mode": 0, "global_bs": 0, "expert_token_nums_type": 0},
    "MoeTokenPermuteGrad": {"num_topk": 1, "padded_mode": False},
    "MoeTokenPermute": {"num_out_tokens": None, "padded_mode": False},
    "MoeTokenUnpermuteGrad": {"probs": None, "padded_mode": False, "restore_shape": None},
    "MSELossExt": {"reduction": 'mean'},
    "MSELossGradExt": {"reduction": 'mean'},
    "Nansum": {"dim": None, "keepdim": False, "dtype": None},
    "NanToNum": {"nan": None, "posinf": None, "neginf": None},
    "NewEmpty": {"dtype": None, "device": None},
    "NewFull": {"dtype": None},
    "NewOnes": {"dtype": None},
    "NewZeros": {"dtype": None},
    "NLLLoss2d": {"reduction": 'mean', "ignore_index": -100},
    "NLLLossGrad": {"reduction": 'mean', "ignore_index": -100},
    "NLLLoss": {"reduction": 'mean', "ignore_index": -100},
    "Norm": {"p": 2.0, "dim": None, "keepdim": False, "dtype": None},
    "NsaCompressAttention": {"topk_mask": None, "atten_mask": None, "actual_seq_qlen": None, "actual_cmp_seq_kvlen": None, "actual_sel_seq_kvlen": None},
    "NsaCompress": {"actual_seq_len": None},
    "NsaSelectAttentionGrad": {"atten_mask": None, "actual_seq_qlen": None, "actual_seq_kvlen": None},
    "NsaSelectAttention": {"atten_mask": None, "actual_seq_qlen": None, "actual_seq_kvlen": None},
    "OnesLikeExt": {"dtype": None},
    "Ones": {"dtype": None},
    "OneHotExt": {"axis": -1},
    "OneHot": {"axis": -1},
    "PagedAttentionMask": {"antiquant_scale": None, "antiquant_offset": None, "alibi_mask": None, "kv_cache_quant_mode": 'DEFAULT'},
    "PagedAttention": {"value_cache": None, "block_tables": None, "context_lens": None, "antiquant_scale": None, "antiquant_offset": None, "attn_mask": None, "q_seq_lens": None, "alibi_mask": None, "kv_cache_quant_mode": 'DEFAULT', "mask_mode": 'MASK_DEFAULT', "mla_v_dim": 0},
    "ProdExt": {"dim": None, "keepdim": False, "dtype": None},
    "PromptFlashAttention": {"attn_mask": None, "actual_seq_lengths": None, "actual_seq_lengths_kv": None, "pse_shift": None, "deq_scale1": None, "quant_scale1": None, "deq_scale2": None, "quant_scale2": None, "quant_offset2": None, "num_heads": 1, "scale_value": 1.0, "pre_tokens": 2147483647, "next_tokens": 0, "input_layout": 'BSH', "num_key_value_heads": 0, "sparse_mode": 0, "inner_precise": 1},
    "PutMem": {"target_pe": 0, "non_blocking": False},
    "PutMemSignal": {"signal_op": 'set', "target_pe": 0, "non_blocking": False},
    "Qr": {"full_matrices": False},
    "RandIntLike": {"dtype": None, "device": None},
    "RandInt": {"dtype": None, "device": None},
    "RandnLike": {"dtype": None, "device": None},
    "Randn": {"dtype": None, "device": None},
    "RandpermExt": {"dtype": mstype.int64},
    "RandpermV2": {"seed": 0, "offset": 0, "dtype": mstype.int64},
    "RandExt": {"dtype": None, "device": None},
    "RandLikeExt": {"dtype": None, "device": None},
    "Range": {"maxlen": 1000000},
    "ReduceAll": {"axis": None, "keep_dims": False},
    "ReduceAny": {"axis": (), "keep_dims": False},
    "ReduceMax": {"axis": (), "keep_dims": False},
    "ReduceMean": {"axis": (), "keep_dims": False},
    "ReduceMin": {"axis": (), "keep_dims": False},
    "ReduceProd": {"axis": (), "keep_dims": False},
    "ReduceStd": {"axis": [], "unbiased": True, "keep_dims": False},
    "ReduceSum": {"axis": (), "keep_dims": False, "skip_mode": False},
    "RepeatInterleaveInt": {"dim": None, "output_size": None},
    "RepeatInterleaveTensor": {"dim": None, "output_size": None},
    "ReshapeAndCache": {"value": None, "key_cache": None, "value_cache": None, "slot_mapping": None},
    "ResizeBicubicGrad": {"align_corners": False, "half_pixel_centers": False},
    "ResizeBicubic": {"align_corners": False, "half_pixel_centers": False},
    "ResizeBilinearGrad": {"align_corners": False, "half_pixel_centers": False},
    "ResizeBilinearV2": {"align_corners": False, "half_pixel_centers": False},
    "ResizeD": {"coordinate_transformation_mode": 'align_corners'},
    "ResizeLinear1DGrad": {"coordinate_transformation_mode": 'align_corners'},
    "ResizeLinear1D": {"coordinate_transformation_mode": 'align_corners'},
    "ResizeNearestNeighborGrad": {"align_corners": False, "half_pixel_centers": False},
    "ResizeNearestNeighbor": {"align_corners": False, "half_pixel_centers": False},
    "ResizeNearestNeighborV2Grad": {"align_corners": False, "half_pixel_centers": False},
    "ResizeNearestNeighborV2": {"align_corners": False, "half_pixel_centers": False},
    "RFFT2": {"s": None, "dim": (-2, -1), "norm": None},
    "RFFTFreq": {"d": 1.0, "dtype": None},
    "RFFTN": {"s": None, "dim": None, "norm": None},
    "RFFT": {"n": None, "dim": -1, "norm": None},
    "RingAttentionUpdate": {"actual_seq_qlen": None, "layout": 'SBH'},
    "RmsNorm": {"epsilon": 1e-6},
    "Roll": {"dims": None},
    "RotaryPositionEmbeddingGrad": {"dx": None, "mode": 0},
    "RotaryPositionEmbedding": {"mode": 0},
    "RotatedIou": {"trans": False, "mode": 0, "is_cross": True, "v_threshold": 0.0, "e_threshold": 0.0},
    "Round": {"decimals": 0},
    "ScalarToTensor": {"dtype": None},
    "Scatter": {"reduce": 'none'},
    "ScatterValue": {"reduce": 'none'},
    "SearchSorted": {"sorter": None, "dtype": mstype.int64, "right": False},
    "SequenceConcat": {"axis": 0},
    "SignalOp": {"signal_op": 'set', "target_pe": 0},
    "SignalWaitUntil": {"compare_op": 'eq'},
    "SilentCheckV2": {"c_min_steps": 7, "c_thresh_l1": 1000000.0, "c_coeff_l1": 100000.0, "c_thresh_l2": 10000.0, "c_coeff_l2": 5000.0, "npu_asd_detect": 1},
    "SilentCheckV3": {"c_thresh_l1": 1000000.0, "c_thresh_l2": 10000.0, "beta1": 0.0, "npu_asd_detect": 1},
    "SmoothL1LossGrad": {"beta": 1.0, "reduction": 'none'},
    "SmoothL1Loss": {"beta": 1.0, "reduction": 'none'},
    "SoftmaxBackward": {"dim": -1},
    "Softmax": {"axis": -1},
    "SoftplusExt": {"beta": 1, "threshold": 20},
    "SoftplusGradExt": {"beta": 1, "threshold": 20},
    "SoftShrinkGrad": {"lambd": 0.5},
    "SoftShrink": {"lambd": 0.5},
    "SoftMarginLossGrad": {"reduction": 'mean'},
    "SoftMarginLoss": {"reduction": 'mean'},
    "SolveTriangular": {"trans": 0, "lower": False, "unit_diagonal": False},
    "SortExt": {"dim": -1, "descending": False, "stable": False},
    "SpeedFusionAttentionGrad": {"pse": None, "padding_mask": None, "atten_mask": None, "softmax_max": None, "softmax_sum": None, "softmax_in": None, "attention_in": None, "scale_value": 1.0, "keep_prob": 1.0, "pre_tokens": 2147483647, "next_tokens": 2147483647, "inner_precise": 0, "seed": None, "offset": None, "numels": None, "prefix": None, "actual_seq_qlen": None, "actual_seq_kvlen": None, "sparse_mode": 0, "gen_mask_parallel": True, "sync": False, "pse_type": 1, "q_start_idx": None, "kv_start_idx": None},
    "SpeedFusionAttention": {"pse": None, "padding_mask": None, "atten_mask": None, "scale": 1.0, "keep_prob": 1.0, "pre_tokens": 2147483647, "next_tokens": 2147483647, "inner_precise": 0, "prefix": None, "actual_seq_qlen": None, "actual_seq_kvlen": None, "sparse_mode": 0, "gen_mask_parallel": True, "sync": False, "pse_type": 1, "q_start_idx": None, "kv_start_idx": None},
    "Split": {"axis": 0, "output_num": 1},
    "SplitTensor": {"dim": 0},
    "SplitTensorView": {"dim": 0},
    "SplitWithSize": {"dim": 0},
    "SplitWithSizeView": {"dim": 0},
    "Squeeze": {"axis": ()},
    "StackExt": {"dim": 0},
    "StdMean": {"dim": None, "correction": 1, "keepdim": False},
    "Std": {"dim": None, "correction": 1, "keepdim": False},
    "StridedSlice": {"begin_mask": 0, "end_mask": 0, "ellipsis_mask": 0, "new_axis_mask": 0, "shrink_axis_mask": 0},
    "SubExt": {"alpha": 1},
    "SubScalar": {"alpha": 1},
    "SumExt": {"dim": None, "keepdim": False, "dtype": None},
    "Svd": {"full_matrices": False, "compute_uv": True},
    "SwigluGrad": {"dim": -1},
    "Swiglu": {"dim": -1},
    "TensorScatterElements": {"axis": 0, "reduce": 'none'},
    "TopKRouter": {"drop_type": 0},
    "TopkExt": {"dim": -1, "largest": True, "sorted": True},
    "TopPRouter": {"drop_type": 0, "threshold": 0.0, "router_prob": 0.0},
    "ToDevice": {"device": None, "dtype": None, "non_blocking": False, "copy": False},
    "ToDtype": {"dtype": None, "non_blocking": False, "copy": False},
    "ToOther": {"non_blocking": False, "copy": False},
    "TraceV2Grad": {"offset": 0, "axis1": 1, "axis2": 0},
    "TraceV2": {"offset": 0, "axis1": 1, "axis2": 0, "dtype": None},
    "TriangularSolve": {"upper": True, "transpose": False, "unitriangular": False},
    "TrilExt": {"diagonal": 0},
    "Triu": {"diagonal": 0},
    "TupleToTensor": {"dtype": None},
    "Unique2": {"sorted": True, "return_inverse": False, "return_counts": False},
    "UniqueConsecutive": {"return_inverse": False, "return_counts": False, "dim": None},
    "UnstackExtView": {"dim": 0},
    "UpdateToDevice": {"sync": False},
    "UpdateToRemote": {"sync": False},
    "UpsampleBicubic2DGrad": {"output_size": None, "scales": None, "align_corners": False},
    "UpsampleBicubic2D": {"output_size": None, "scales": None, "align_corners": False},
    "UpsampleBilinear2DGrad": {"output_size": None, "scales": None, "align_corners": False},
    "UpsampleBilinear2D": {"output_size": None, "scales": None, "align_corners": False},
    "UpsampleLinear1DGrad": {"output_size": None, "scales": None, "align_corners": False},
    "UpsampleLinear1D": {"output_size": None, "scales": None, "align_corners": False},
    "UpsampleNearest1DGrad": {"output_size": None, "scales": None},
    "UpsampleNearest1D": {"output_size": None, "scales": None},
    "UpsampleNearest2DGrad": {"output_size": None, "scales": None},
    "UpsampleNearest2D": {"output_size": None, "scales": None},
    "UpsampleNearest3DGrad": {"output_size": None, "scales": None},
    "UpsampleNearest3D": {"output_size": None, "scales": None},
    "UpsampleTrilinear3DGrad": {"output_size": None, "scales": None, "align_corners": False},
    "UpsampleTrilinear3D": {"output_size": None, "scales": None, "align_corners": False},
    "VarMean": {"dim": None, "correction": 1, "keepdim": False},
    "Var": {"dim": None, "correction": 1, "keepdim": False},
    "ZerosLikeExt": {"dtype": None},
    "Zeros": {"dtype": None},
    "AddRmsNormDynamicQuant": {"smooth_scale2": None, "epsilon": 1e-5},
    "AddRmsNormQuantV2": {"epsilon": 1e-5},
    "DynamicNTK": {"dtype": mstype.float16},
    "DynamicQuantExt": {"smooth_scales": None},
    "FusedInferAttentionScore": {"pse_shift": None, "attn_mask": None, "actual_seq_lengths": None, "actual_seq_lengths_kv": None, "dequant_scale1": None, "quant_scale1": None, "dequant_scale2": None, "quant_scale2": None, "quant_offset2": None, "antiquant_scale": None, "antiquant_offset": None, "block_table": None, "query_padding_size": None, "kv_padding_size": None, "key_antiquant_scale": None, "key_antiquant_offset": None, "value_antiquant_scale": None, "value_antiquant_offset": None, "key_shared_prefix": None, "value_shared_prefix": None, "actual_shared_prefix_len": None, "num_heads": 1, "scale_value": 1.0, "pre_tokens": 2147483647, "next_tokens": 2147483647, "input_layout": 'BSH', "num_key_value_heads": 0, "sparse_mode": 0, "inner_precise": 1, "block_size": 0, "antiquant_mode": 0, "softmax_lse_flag": False, "key_antiquant_mode": 0, "value_antiquant_mode": 0},
    "GroupedMatmul": {"bias": None, "scale": None, "offset": None, "antiquant_scale": None, "antiquant_offset": None, "group_list": None, "split_item": 0, "group_type": -1, "transpose_a": False, "transpose_b": False},
    "GroupedMatmulV2": {"bias": None, "scale": None, "offset": None, "antiquant_scale": None, "antiquant_offset": None, "group_list": None, "split_item": 0, "group_type": -1},
    "GroupedMatmulV4": {"bias": None, "scale": None, "offset": None, "antiquant_scale": None, "antiquant_offset": None, "pre_token_scale": None, "group_list": None, "activation_input": None, "activation_quant_scale": None, "activation_quant_offset": None, "split_item": 0, "group_type": -1, "group_list_type": 0, "act_type": 0, "output_dtype": None},
    "KVCacheScatterUpdate": {"reduce": 'none'},
    "MatmulAllReduceAddRmsNorm": {"reduce_op": 'sum', "comm_turn": 0, "stream_mode": 1},
    "MoeFinalizeRouting": {"x2": None, "bias": None, "scales": None, "expanded_row_idx": None, "expanded_expert_idx": None},
    "MoeGatingTopKSoftmax": {"finished": None, "k": 1},
    "MoeInitRoutingQuantV2": {"scale": None, "offset": None},
    "QuantBatchMatmul": {"offset": None, "bias": None, "pertokenScaleOptional": None, "transpose_x1": False, "transpose_x2": False, "dtype": mstype.float16},
    "QuantMatmul": {"offset": None, "pertoken_scale": None, "bias": None, "output_dtype": None, "x1_dtype": None, "x2_dtype": None, "pertoken_scale_dtype": None, "scale_dtype": None, "group_sizes": None},
    "QuantV2": {"sqrt_mode": False, "rounding_mode": 'ROUND', "dst_type": mstype.int8},
    "RmsNormQuant": {"beta": None, "epsilon": 1e-6},
    "SwiGLUDynamicQuant": {"smooth_scale": None},
    "TransposeBatchMatmulTranspose": {"transpose_a": False, "transpose_b": False},
    "WeightQuantBatchMatmul": {"antiquant_offset": None, "quant_scale": None, "quant_offset": None, "bias": None, "transpose_x": False, "transpose_weight": False, "antiquant_group_size": 0},
    "AnyExt": {"keepdim": False},
    "CosineEmbeddingLoss": {"margin": 0.0, "reduction": 'mean'},
    "FuncMaxPool2D": {"stride": None, "padding": 0, "dilation": (1, 1), "ceil_mode": False, "return_indices": False},
    "GmmBackwardFusion": {"group_list": None, "group_list_type": 0},
    "GmmBackward": {"group_list": None, "group_list_type": 0},
    "Gmm": {"bias": None, "group_list": None, "group_type": 0, "group_list_type": 0},
    "GmmV2BackwardFusion": {"group_list": None, "group_list_type": 0},
    "GmmV2Backward": {"group_list": None, "group_list_type": 0},
    "GmmV2": {"bias": None, "group_list": None, "group_type": 0, "group_list_type": 0},
    "MoeTokenUnpermute": {"probs": None, "padded_mode": False, "restore_shape": None},
    "DeprecatedAddbmm": {"beta": 1, "alpha": 1},
    "DeprecatedAddmm": {"beta": 1, "alpha": 1},
    "DeprecatedAddmv": {"beta": 1, "alpha": 1},
    "DeprecatedReduceAll": {"dim": None, "keepdim": False},
    "DeprecatedAllclose": {"rtol": 1e-05, "atol": 1e-08, "equal_nan": False},
    "DeprecatedReduceAny": {"axis": None, "keep_dims": False},
    "DeprecatedArgmax": {"axis": -1, "keepdims": False},
    "DeprecatedArgmin": {"axis": None, "keepdims": False},
    "DeprecatedArgsort": {"axis": -1, "descending": False},
    "DeprecatedBaddbmm": {"beta": 1, "alpha": 1},
    "DeprecatedBincount": {"weights": None, "minlength": 0},
    "DeprecatedChunk": {"axis": 0},
    "DeprecatedCountNonzero": {"axis": (), "keep_dims": False, "dtype": None},
    "DeprecatedCumsum": {"axis": None, "dtype": None},
    "DeprecatedDiv": {"rounding_mode": None},
    "DeprecatedFlatten": {"order": 'C', "start_dim": 0, "end_dim": -1},
    "DeprecatedGather": {"batch_dims": 0},
    "DeprecatedHistc": {"bins": 100, "min": 0, "max": 0},
    "DeprecatedIndexAdd": {"use_lock": True, "check_index_bound": True},
    "DeprecatedIsclose": {"rtol": 1e-05, "atol": 1e-08, "equal_nan": False},
    "DeprecatedLogsumexp": {"keepdim": False},
    "DeprecatedMax": {"axis": None, "keepdims": False, "initial": None, "where": True, "return_indices": False},
    "DeprecatedMean": {"axis": None, "keep_dims": False},
    "DeprecatedMedian": {"axis": -1, "keepdims": False},
    "DeprecatedMin": {"axis": None, "keepdims": False, "initial": None, "where": True, "return_indices": False},
    "DeprecatedNansum": {"axis": None, "keepdims": False, "dtype": None},
    "DeprecatedPermute": {"axis": None},
    "DeprecatedProd": {"dim": None, "keepdim": False, "dtype": None},
    "DeprecatedRepeatInterleave": {"dim": None},
    "DeprecatedRoll": {"dims": None},
    "DeprecatedSort": {"axis": -1, "descending": False},
    "DeprecatedSplit": {"axis": 0},
    "DeprecatedSqueeze": {"axis": None},
    "DeprecatedStd": {"axis": None, "ddof": 0, "keepdims": False},
    "DeprecatedSum": {"axis": None, "dtype": None, "keepdims": False, "initial": None},
    "DeprecatedTake": {"axis": None, "mode": 'clip'},
    "DeprecatedTopk": {"dim": None, "largest": True, "sorted": True},
    "DeprecatedTranspose": {"axes": None},
    "DeprecatedTril": {"diagonal": 0},
    "DeprecatedUnstack": {"dim": 0},
    "DeprecatedUnique": {"sorted": True, "return_inverse": False, "return_counts": False, "dim": None},
    "DeprecatedVar": {"axis": None, "ddof": 0, "keepdims": False},
}

op_labels = {
    "AdamW": {"side_effect_mem": True},
    "AdamWeightDecay": {"side_effect_mem": True},
    "ApplyAdamW": {"side_effect_mem": True},
    "AssignAdd": {"side_effect_mem": True},
    "Assign": {"side_effect_mem": True},
    "AssignSub": {"side_effect_mem": True},
    "BatchNormElemt": {"side_effect_mem": True},
    "BatchNormGatherStatsWithCounts": {"side_effect_mem": True},
    "BroadcastToView": {"side_effect_mem": True},
    "ChunkView": {"side_effect_mem": True},
    "CopyToDevice": {"side_effect_mem": True},
    "CopyToHost": {"side_effect_mem": True},
    "Detach": {"side_effect_mem": True},
    "DiagonalView": {"side_effect_mem": True},
    "DropoutExt": {"side_effect_hidden": True},
    "DropoutGenMaskExt": {"side_effect_hidden": True},
    "Dropout": {"side_effect_hidden": True},
    "Embedding": {"side_effect_mem": True},
    "ExpandDimsView": {"side_effect_mem": True},
    "Free": {"side_effect_mem": True},
    "Generator": {"side_effect_mem": True},
    "GetData": {"side_effect_mem": True},
    "GroupTopk": {"side_effect_mem": True},
    "InnerInplaceIndexPut": {"side_effect_mem": True},
    "InplaceAddmm": {"side_effect_mem": True},
    "InplaceAddsExt": {"side_effect_mem": True},
    "InplaceAddExt": {"side_effect_mem": True},
    "InplaceBernoulliScalar": {"side_effect_mem": True},
    "InplaceBernoulliTensor": {"side_effect_mem": True},
    "InplaceCopy": {"side_effect_mem": True},
    "InplaceDivMods": {"side_effect_mem": True},
    "InplaceDivMod": {"side_effect_mem": True},
    "InplaceDivs": {"side_effect_mem": True},
    "InplaceDiv": {"side_effect_mem": True},
    "InplaceElu": {"side_effect_mem": True},
    "InplaceErfinv": {"side_effect_mem": True},
    "InplaceExp": {"side_effect_mem": True},
    "InplaceFillDiagonal": {"side_effect_mem": True},
    "InplaceFillScalar": {"side_effect_mem": True},
    "InplaceFillTensor": {"side_effect_mem": True},
    "InplaceFloorDivides": {"side_effect_mem": True},
    "InplaceFloorDivide": {"side_effect_mem": True},
    "InplaceFloor": {"side_effect_mem": True},
    "InplaceGroupedMatmulAdd": {"side_effect_mem": True},
    "InplaceHardtanh": {"side_effect_mem": True},
    "InplaceIndexAddExt": {"side_effect_mem": True},
    "InplaceIndexCopy": {"side_effect_mem": True},
    "InplaceIndexPut": {"side_effect_mem": True},
    "InplaceLog": {"side_effect_mem": True},
    "InplaceMaskedFillScalar": {"side_effect_mem": True},
    "InplaceMaskedFillTensor": {"side_effect_mem": True},
    "InplaceMaskedScatter": {"side_effect_mem": True},
    "InplaceMatmulAdd": {"side_effect_mem": True},
    "InplaceMuls": {"side_effect_mem": True},
    "InplaceMul": {"side_effect_mem": True},
    "InplaceNormal": {"side_effect_mem": True},
    "InplacePut": {"side_effect_mem": True},
    "InplaceRandom": {"side_effect_mem": True},
    "InplaceReLU": {"side_effect_mem": True},
    "InplaceRemainderTensorScalar": {"side_effect_mem": True},
    "InplaceRemainderTensorTensor": {"side_effect_mem": True},
    "InplaceScatterAdd": {"side_effect_mem": True},
    "InplaceScatterSrc": {"side_effect_mem": True},
    "InplaceScatterSrcReduce": {"side_effect_mem": True},
    "InplaceScatterValue": {"side_effect_mem": True},
    "InplaceScatterValueReduce": {"side_effect_mem": True},
    "InplaceSigmoid": {"side_effect_mem": True},
    "InplaceSign": {"side_effect_mem": True},
    "InplaceSiLU": {"side_effect_mem": True},
    "InplaceSubExt": {"side_effect_mem": True},
    "InplaceSubScalar": {"side_effect_mem": True},
    "InplaceTanh": {"side_effect_mem": True},
    "InplaceThreshold": {"side_effect_mem": True},
    "InplaceToDevice": {"side_effect_mem": True},
    "InplaceUniform": {"side_effect_mem": True},
    "KvScaleCache": {"side_effect_mem": True},
    "Log": {"cust_aicpu": 'Log', "base": -1.0, "scale": 1.0, "shift": 0.0},
    "MlaPreprocess": {"side_effect_mem": True},
    "NarrowView": {"side_effect_mem": True},
    "ReshapeAndCache": {"side_effect_mem": True},
    "ResizeD": {"mode": 'linear'},
    "SelectExtView": {"side_effect_mem": True},
    "SetData": {"side_effect_mem": True},
    "SilentCheckV2": {"side_effect_mem": True},
    "SilentCheckV3": {"side_effect_mem": True},
    "SliceExtView": {"side_effect_mem": True},
    "SplitTensorView": {"side_effect_mem": True},
    "SplitWithSizeView": {"side_effect_mem": True},
    "TransposeExtView": {"side_effect_mem": True},
    "TransposeView": {"side_effect_mem": True},
    "UnstackExtView": {"side_effect_mem": True},
    "UpdateToDevice": {"side_effect_mem": True},
    "UpdateToRemote": {"side_effect_mem": True},
    "KVCacheScatterUpdate": {"side_effect_mem": True},
    "DistCommAllGatherIntoTensor": {"side_effect_mem": True},
    "DistCommAllGather": {"side_effect_mem": True},
    "DistCommAllReduce": {"side_effect_mem": True},
    "DistCommAllToAllVSingle": {"side_effect_mem": True},
    "DistCommIrecv": {"side_effect_mem": True},
    "DistCommIsend": {"side_effect_mem": True},
    "DistCommReduce": {"side_effect_mem": True},
    "DistCommReduceScatter": {"side_effect_mem": True},
    "DistCommReduceScatterTensor": {"side_effect_mem": True},
    "InnerCommIrecv": {"side_effect_mem": True},
    "InnerCommIsend": {"side_effect_mem": True},
    "InplaceExponential": {"side_effect_mem": True},
}
