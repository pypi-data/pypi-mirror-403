"""Response items used in agent execution."""

from __future__ import annotations

from typing import Optional, Union, Literal, TypeAlias
from pydantic import BaseModel

from openai.types.responses import (
    ResponseOutputMessage,
    ResponseReasoningItem,
    ResponseFunctionToolCall,
    ResponseFunctionWebSearch,
    ResponseInputText,
)


class ResponseFunctionToolCallOutput(BaseModel):
    """The output of a function tool call."""

    call_id: str
    """The unique ID of the function tool call generated by the model."""

    output: Union[str, ResponseInputText]
    """The output from the function call generated by your code."""

    name: str
    """The name of the function tool call."""

    type: Literal["function_call_output"]
    """The type of the function tool call output. Always `function_call_output`."""

    id: Optional[str] = None
    """The unique ID of the function tool call output."""

    status: Optional[Literal["in_progress", "completed", "incomplete"]] = None
    """The status of the item."""


class MessageOutputItem(BaseModel):
    """Represents a message from the LLM."""

    role: Literal["assistant"] = "assistant"

    content: str = ""
    """The text content of the message. Always `assistant`."""

    raw_item: Optional[ResponseOutputMessage] = None
    """The raw response output message."""

    type: Literal["message_output_item"] = "message_output_item"
    """The type of the message output item. Always `message_output_item`."""


class ToolCallItem(BaseModel):
    """Represents a tool call e.g. a function call or computer action call."""

    role: Literal["assistant"] = "assistant"

    content: str = ""
    """The content of the tool call. Usually empty."""

    raw_item: Optional[Union[ResponseFunctionToolCall, ResponseFunctionWebSearch]] = (
        None
    )
    """The raw tool call item."""

    type: Literal["tool_call_item"] = "tool_call_item"
    """The type of the tool call item. Always `tool_call_item`."""


class ToolCallOutputItem(BaseModel):
    """Represents the output of a tool call."""

    role: Literal["tool"] = "tool"

    content: str = ""
    """The output from the function call generated by your code."""

    raw_item: Optional[ResponseFunctionToolCallOutput] = None
    """The raw tool call output item."""

    type: Literal["tool_call_output_item"] = "tool_call_output_item"
    """The type of the tool call output item. Always `tool_call_output_item`."""


class ReasoningItem(BaseModel):
    """Represents a reasoning item."""

    role: Literal["assistant"] = "assistant"

    content: Optional[str] = None
    """The reasoning content."""

    raw_item: Optional[ResponseReasoningItem] = None
    """The raw reasoning item."""

    type: Literal["reasoning_item"] = "reasoning_item"
    """The type of the reasoning item. Always `reasoning_item`."""


RunItem: TypeAlias = Union[
    MessageOutputItem,
    ToolCallItem,
    ToolCallOutputItem,
    ReasoningItem,
]
