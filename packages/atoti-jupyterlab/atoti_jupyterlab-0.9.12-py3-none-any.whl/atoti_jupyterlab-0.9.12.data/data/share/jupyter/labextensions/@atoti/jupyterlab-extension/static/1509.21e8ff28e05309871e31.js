(self.webpackChunk_atoti_jupyterlab_extension=self.webpackChunk_atoti_jupyterlab_extension||[]).push([[1509],{8622:(e,n,t)=>{"use strict";t.d(n,{t:()=>v});var r=t(59300),a=t.n(r),i=t(29506),s=t.n(i),o=t(96531),c=t(47676),l=t(86189),u=t(50466),h=t(29213),d=t(9117),m=t(45795),f=t(92080);const p=["DD-MM-YYYY","MM-DD-YYYY","YYYY-MM-DD"];function y({hierarchy:e,member:n,style:t,levelIndex:r}){if(!n)return"";const i=n.captionPath[r]??"",s=Object.values(e.levels)[r],o=t?.measures?.[(0,h.quote)(n.dimensionName,n.hierarchyName,s.name)];if((0,c.K)(s)){const e=o?.dateFormat,t=n.namePath[r],s=a()(t,p);return e&&s.isValid()?s.format(e):i}const l=""===i?NaN:Number(i);return i&&!isNaN(l)&&o?(0,m.m)({value:l,numericFieldStyle:o,valueFormattedByAtotiServer:i}):i}function v({hasCaptionOnlyForLeafLevels:e,cube:n,...t}){const{member:r,mapping:a,captionForTotals:i}=t;if(!r)return"";const s=r.namePath.length-1;if((0,l.t)(r)){const e=(0,f.v)({mapping:a,tuple:[r]});return e?(0,d.getKpiPropertyCaption)(e):r.captionPath[s]??""}const c=(0,u.q)(r,n);if((0,o.isTotal)(c,r))return i;if(e)return y({...t,hierarchy:c,levelIndex:r.namePath.length-1});const h=[];for(let e=c.slicing?0:1;e<r.namePath.length;e++)h.push(y({...t,hierarchy:c,levelIndex:e}));return h.join(", ")}a().extend(s())},92080:(e,n,t)=>{"use strict";t.d(n,{v:()=>i});var r=t(86189),a=t(63449);function i({mapping:e,tuple:n}){if(!n)return;const t=n.find(r.t)?.namePath[0];for(const n of e.measures??[])if((0,a.isKpiPropertyInMapping)(n)&&n.underlyingMeasureName===t)return n}},98985:(e,n,t)=>{"use strict";function r(e,{hierarchyIndex:n,levelIndex:t}){const r=e[n];return[...e.slice(0,n),{...r,captionPath:r.captionPath.slice(0,t+1),namePath:r.namePath.slice(0,t+1)}]}t.d(n,{A:()=>r})},16681:(e,n,t)=>{"use strict";t.d(n,{n:()=>a});var r=t(86189);function a(e){return(0,r.t)(e)}},23872:(e,n,t)=>{"use strict";function r(e){return"Measures"===e.type}t.d(n,{g:()=>r})},1512:(e,n,t)=>{"use strict";t.d(n,{k:()=>i});var r=t(86189),a=t(50466);function i(e,n){const t=[];return e.maxLevelPerHierarchy.forEach(((i,s)=>{const{dimension:o,hierarchy:c}=e.hierarchies[s];for(let l=e.positions.length>0&&!(0,r.t)({dimensionName:o})&&!(0,a.q)({dimensionName:o,hierarchyName:c},n).slicing?1:0;l<i;l++)t.push({hierarchyIndex:s,levelIndex:l})})),t}},13372:(e,n,t)=>{"use strict";t.d(n,{G:()=>o});var r=t(96531),a=t(86189),i=t(50466),s=t(29213);const o=({columnIndex:e,cube:n,tableStateDerivedFromCellSet:t})=>{if(!n)return null;const{columnsAxis:o,numberOfFrozenColumns:c,rowHeaderIndices:l,rowsAxis:u}=t;if(e<c){if(u){const{hierarchyIndex:t,levelIndex:r}=l[e],{dimension:o,hierarchy:c}=u.hierarchies[t];if((0,a.t)({dimensionName:o}))return"[Measures].[Measures]";const h=(0,i.q)({dimensionName:o,hierarchyName:c},n);return(0,s.quote)(o,c,Object.keys(h.levels)[r])}}else{if(!o)return"Value";{const n=e-(o.range?.from||0)-c,t=o.positions[n];if(t){const e=t.map(((e,n)=>({dimensionName:o.hierarchies[n].dimension,hierarchyName:o.hierarchies[n].hierarchy,...e})));return(0,r.getTupleKey)(e)}}}return null}},66039:(e,n,t)=>{"use strict";t.d(n,{b:()=>i});var r=t(86189),a=t(50466);const i=(e,n)=>{if(!e||!n)return[];const t=[];return e.hierarchies.forEach((({dimension:i,hierarchy:s},o)=>{if((0,r.t)({dimensionName:i}))t.push({dimensionName:"Measures",hierarchyName:"Measures"});else{const r=(0,a.q)({dimensionName:i,hierarchyName:s},n);t.push(...Object.values(r.levels).slice(r.slicing?0:1,e.maxLevelPerHierarchy[o]).map((e=>({dimensionName:i,hierarchyName:s,levelName:e.name}))))}})),t}},45725:(e,n,t)=>{"use strict";function r({axis:e,defaultMeasure:n,positionIndex:t}){if(!e)return n?[{captionPath:n.captionPath,dimensionName:"Measures",hierarchyName:"Measures",namePath:n.path,properties:{}}]:null;const r=e?.range?.from||0;return e.positions[t-r]?.map(((n,t)=>({dimensionName:e.hierarchies[t].dimension,hierarchyName:e.hierarchies[t].hierarchy,...n})))||null}t.d(n,{P:()=>r})},97755:(e,n,t)=>{"use strict";t.d(n,{P:()=>Y});var r=t(96531),a=t(86189),i=t(57019),s=t(45795);function o({cell:e,style:n,columnIndex:t,data:i,rowIndex:o,hierarchyIndicesInCellSet:c,locale:l}){const u=Number(e.value),h=e.formattedValue;if(isNaN(u)||!n)return h;const d=(0,r.getTuple)({data:i,rowIndex:o,columnIndex:t,hierarchyIndicesInCellSet:c});if(!d)return h;const m=d.find(a.t),f=m&&n?.measures?.[m.namePath[0]];return(0,s.m)({value:u,numericFieldStyle:f,valueFormattedByAtotiServer:h,locale:l})}var c=t(29213),l=t(16681),u=t(23872),h=t(1512),d=t(59300),m=t.n(d),f=t(29506),p=t.n(f),y=t(98985),v=t(8622);function x({mapping:e,captionForTotals:n,cube:t,tuple:r,hierarchyIndex:a,levelIndex:i,convertValueToNumber:s=!0,style:o}){if(!r)return{caption:"",value:""};if(a>=r.length||i>=r[a].namePath.length)return{caption:n,value:n};const c=(0,y.A)(r,{hierarchyIndex:a,levelIndex:i}),l=c?.[a],u=(0,v.t)({captionForTotals:n,cube:t,mapping:e,member:l,style:o,hasCaptionOnlyForLeafLevels:!0}),h=""===u?NaN:Number(u);return{caption:u,value:s&&!isNaN(h)?h:u}}m().extend(p());var g=t(50466);function I({cube:e,tuple:n}){let t=-1;return n?.forEach((n=>{t+=n.namePath.length,(0,a.t)(n)||(0,g.q)(n,e).slicing||(t-=1)})),Math.max(0,t)}var M=t(66039),w=t(45725);const Y=e=>{const{captionForMeasures:n,captionForTotals:t,captionForValue:s,cube:d,doesConvertHeaderCellValuesToNumbers:m,isRowHeaderTree:f,mapping:p,mdx:y,style:v,rowIndexMapping:g,locale:Y}=e,b=f?(0,r.addMissingTotalRows)(e.data,{cube:d,rowIndexMapping:g}):e.data;let N,D,P;for(let e=0;e<b.axes.length;e++){const n=b.axes[e];n.id===c.axisIds.columns?D=n:n.id===c.axisIds.rows?N=n:n.id===c.axisIds.slicer&&(P=n)}const L=b.defaultMembers.find(a.t),S=(P?.hierarchies??[]).findIndex(a.t),C=-1!==S,T=N?.hierarchies.some(a.t),A=(D?.hierarchies??[]).findIndex(a.t),F=-1!==A,O={},H=y?.axes.flatMap(c.getAxisMemberPropertyKeys).map((e=>(0,c.unquote)(e).at(-1))).filter((e=>"CHILDREN_CARDINALITY"!==e)),R=D?(0,r.getAxisLength)(D):C||T?1:0,k=N?(0,r.getAxisLength)(N):1,[[$,V],[_,q]]=[N,D].map((e=>{const n=(0,M.b)(e,d),t=d?n.map((e=>(0,l.n)(e)?{type:"Measures"}:(0,i.r)(e,d))):[];return[n,t]})),[z,E]=[N,D].map((e=>e&&d?(0,h.k)(e,d):[])),Z=f?Math.min(1,z.length):z.length,j=Math.max(E.length,1),K=new Array(j+k).fill(null).map((()=>new Array(Z+R).fill(null)));if(V)for(let e=0;e<Z;e++){const t=V[e],r=(0,u.g)(t)?n:t?.caption??null;for(let n=0;n<j;n++)K[n][e]={caption:r,value:r}}if(N&&d){const e=N.range?.from||0;for(let n=0;n<N.positions.length;n++){const r=n+e+j,a=(0,w.P)({axis:N,defaultMeasure:L,positionIndex:n+e});for(let e=0;e<Z;e++){const n=d&&f?I({cube:d,tuple:a}):e,{hierarchyIndex:i,levelIndex:s}=z[n],{caption:o,value:c}=x({captionForTotals:t,cube:d,convertValueToNumber:m,style:v,tuple:a,hierarchyIndex:i,levelIndex:s,mapping:p});K[r][e]={caption:o,value:c,hierarchyIndex:i,levelIndex:s,headerDepth:n}}}}if(D&&d){const e=D.range?.from||0;for(let n=0;n<D.positions.length;n++){const r=n+e+Z,a=(0,w.P)({axis:D,defaultMeasure:L,positionIndex:n+e});for(let e=0;e<j;e++){const{hierarchyIndex:n,levelIndex:i}=E[e],{caption:s,value:o}=x({...D,captionForTotals:t,cube:d,convertValueToNumber:m,style:v,tuple:a,hierarchyIndex:n,levelIndex:i,mapping:p});K[e][r]={caption:s,value:o,hierarchyIndex:n,levelIndex:i,headerDepth:e}}if(F&&a){const t=a[A].namePath[0];O[t]||(O[t]=[]),O[t].push(n+e)}}}else if(C){const e=Z,n=0,t=(0,w.P)({axis:P,defaultMeasure:L,positionIndex:0}),r=t?.[S],a=r?.captionPath[0];K[n][e]={caption:a,value:a,hierarchyIndex:0,levelIndex:0,headerDepth:0}}else T&&(K[0][Z]={caption:s,value:s});const B=(0,r.getHierarchyIndicesInCellSet)(b);(C||F||T)&&b.cells.forEach((e=>{const n=Math.floor(e.ordinal/R),t=e.ordinal%R;K[j+n][Z+t]={caption:o({cell:e,data:b,hierarchyIndicesInCellSet:B,columnIndex:t,rowIndex:n,style:v,locale:Y}),value:e.value,properties:e.properties}}));const{columnIndexImpactingRowStyle:U,styleImpactingRows:Q}=function({columnIndicesPerMeasure:e,style:n}){const t=n?.tupleImpactingRowStyle;if(!t)return;let r;for(const e of t)if("Measures"===e.dimensionName){r=e.namePath[0];break}return r?{columnIndexImpactingRowStyle:e[r]?.[0],styleImpactingRows:n?.measures?.[r]}:void 0}({columnIndicesPerMeasure:O,style:v})??{columnIndexImpactingRowStyle:void 0,styleImpactingRows:void 0},X=y&&d?(0,c.getSort)(y,{cube:d}):void 0;return{cells:K,columnIndexImpactingRowStyle:U,cube:d,data:b,defaultMeasure:L,hierarchyIndicesInCellSet:B,indexOfMeasureOnSlicer:S,isRowHeaderTree:f,mapping:p,memberPropertyKeys:H,numberOfRowsInBody:k,numberOfColumnsInBody:R,numberOfFrozenColumns:Z,numberOfFrozenRows:j,staticHeaderCoordinatesOnRows:$,staticHeaderCoordinatesOnColumns:_,staticHeadersOnColumns:q,staticHeadersOnRows:V,rowsAxis:N,columnsAxis:D,rowHeaderIndices:z,columnHeaderIndices:E,slicerAxis:P,sort:X,styleImpactingRows:Q,loadedRange:{columns:{from:D?.range?.from??0,to:(D?.range?.to??1/0)-1},rows:{from:N?.range?.from??0,to:(N?.range?.to??1/0)-1}}}}},29506:function(e){e.exports=function(){"use strict";var e={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"},n=/(\[[^[]*\])|([-_:/.,()\s]+)|(A|a|Q|YYYY|YY?|ww?|MM?M?M?|Do|DD?|hh?|HH?|mm?|ss?|S{1,3}|z|ZZ?)/g,t=/\d/,r=/\d\d/,a=/\d\d?/,i=/\d*[^-_:/,()\s\d]+/,s={},o=function(e){return(e=+e)+(e>68?1900:2e3)},c=function(e){return function(n){this[e]=+n}},l=[/[+-]\d\d:?(\d\d)?|Z/,function(e){(this.zone||(this.zone={})).offset=function(e){if(!e)return 0;if("Z"===e)return 0;var n=e.match(/([+-]|\d\d)/g),t=60*n[1]+(+n[2]||0);return 0===t?0:"+"===n[0]?-t:t}(e)}],u=function(e){var n=s[e];return n&&(n.indexOf?n:n.s.concat(n.f))},h=function(e,n){var t,r=s.meridiem;if(r){for(var a=1;a<=24;a+=1)if(e.indexOf(r(a,0,n))>-1){t=a>12;break}}else t=e===(n?"pm":"PM");return t},d={A:[i,function(e){this.afternoon=h(e,!1)}],a:[i,function(e){this.afternoon=h(e,!0)}],Q:[t,function(e){this.month=3*(e-1)+1}],S:[t,function(e){this.milliseconds=100*+e}],SS:[r,function(e){this.milliseconds=10*+e}],SSS:[/\d{3}/,function(e){this.milliseconds=+e}],s:[a,c("seconds")],ss:[a,c("seconds")],m:[a,c("minutes")],mm:[a,c("minutes")],H:[a,c("hours")],h:[a,c("hours")],HH:[a,c("hours")],hh:[a,c("hours")],D:[a,c("day")],DD:[r,c("day")],Do:[i,function(e){var n=s.ordinal,t=e.match(/\d+/);if(this.day=t[0],n)for(var r=1;r<=31;r+=1)n(r).replace(/\[|\]/g,"")===e&&(this.day=r)}],w:[a,c("week")],ww:[r,c("week")],M:[a,c("month")],MM:[r,c("month")],MMM:[i,function(e){var n=u("months"),t=(u("monthsShort")||n.map((function(e){return e.slice(0,3)}))).indexOf(e)+1;if(t<1)throw new Error;this.month=t%12||t}],MMMM:[i,function(e){var n=u("months").indexOf(e)+1;if(n<1)throw new Error;this.month=n%12||n}],Y:[/[+-]?\d+/,c("year")],YY:[r,function(e){this.year=o(e)}],YYYY:[/\d{4}/,c("year")],Z:l,ZZ:l};function m(t){var r,a;r=t,a=s&&s.formats;for(var i=(t=r.replace(/(\[[^\]]+])|(LTS?|l{1,4}|L{1,4})/g,(function(n,t,r){var i=r&&r.toUpperCase();return t||a[r]||e[r]||a[i].replace(/(\[[^\]]+])|(MMMM|MM|DD|dddd)/g,(function(e,n,t){return n||t.slice(1)}))}))).match(n),o=i.length,c=0;c<o;c+=1){var l=i[c],u=d[l],h=u&&u[0],m=u&&u[1];i[c]=m?{regex:h,parser:m}:l.replace(/^\[|\]$/g,"")}return function(e){for(var n={},t=0,r=0;t<o;t+=1){var a=i[t];if("string"==typeof a)r+=a.length;else{var s=a.regex,c=a.parser,l=e.slice(r),u=s.exec(l)[0];c.call(n,u),e=e.replace(u,"")}}return function(e){var n=e.afternoon;if(void 0!==n){var t=e.hours;n?t<12&&(e.hours+=12):12===t&&(e.hours=0),delete e.afternoon}}(n),n}}return function(e,n,t){t.p.customParseFormat=!0,e&&e.parseTwoDigitYear&&(o=e.parseTwoDigitYear);var r=n.prototype,a=r.parse;r.parse=function(e){var n=e.date,r=e.utc,i=e.args;this.$u=r;var o=i[1];if("string"==typeof o){var c=!0===i[2],l=!0===i[3],u=c||l,h=i[2];l&&(h=i[2]),s=this.$locale(),!c&&h&&(s=t.Ls[h]),this.$d=function(e,n,t,r){try{if(["x","X"].indexOf(n)>-1)return new Date(("X"===n?1e3:1)*e);var a=m(n)(e),i=a.year,s=a.month,o=a.day,c=a.hours,l=a.minutes,u=a.seconds,h=a.milliseconds,d=a.zone,f=a.week,p=new Date,y=o||(i||s?1:p.getDate()),v=i||p.getFullYear(),x=0;i&&!s||(x=s>0?s-1:p.getMonth());var g,I=c||0,M=l||0,w=u||0,Y=h||0;return d?new Date(Date.UTC(v,x,y,I,M,w,Y+60*d.offset*1e3)):t?new Date(Date.UTC(v,x,y,I,M,w,Y)):(g=new Date(v,x,y,I,M,w,Y),f&&(g=r(g).week(f).toDate()),g)}catch(e){return new Date("")}}(n,o,r,t),this.init(),h&&!0!==h&&(this.$L=this.locale(h).$L),u&&n!=this.format(o)&&(this.$d=new Date("")),s={}}else if(o instanceof Array)for(var d=o.length,f=1;f<=d;f+=1){i[1]=o[f-1];var p=t.apply(this,i);if(p.isValid()){this.$d=p.$d,this.$L=p.$L,this.init();break}f===d&&(this.$d=new Date(""))}else a.call(this,e)}}}()}}]);