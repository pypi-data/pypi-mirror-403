"use strict";(self.webpackChunk_atoti_jupyterlab_extension=self.webpackChunk_atoti_jupyterlab_extension||[]).push([[6746,5274],{81102:(e,t,o)=>{o.d(t,{y:()=>a});var n=o(42405);const a=({label:e={label:""},insertText:t,kind:o=n.languages.CompletionItemKind.Constant,...a})=>({label:e,kind:o,insertText:void 0!==t?t:"string"==typeof e?e:e.label,range:void 0,...a})},51174:(e,t,o)=>{o.d(t,{C:()=>s});var n=o(42405),a=o(47236);function s({type:e,textModel:t,offset:o,length:s,classNames:r,options:i={}}){const l={error:{color:a.d.error,className:r?.line_error??"",position:4,zIndex:10},warning:{color:a.d.warning,className:r?.line_warning??"",position:1,zIndex:1}};return{range:n.Range.fromPositions(t.getPositionAt(o),t.getPositionAt(o+s)),options:{overviewRuler:{color:l[e].color,position:l[e].position},inlineClassName:l[e].className,zIndex:l[e].zIndex,...i}}}},14290:(e,t,o)=>{function n(e,t){const o=t.reduce(((t,o)=>{const n=function(e="",t=""){if(e.length<2||t.length<2)return 0;const o=new Map;for(let t=0;t<e.length-1;t++){const n=e.substr(t,2);o.set(n,o.get(n)??1)}let n=0;for(let e=0;e<t.length-1;e++){const a=t.substr(e,2),s=o.get(a)??0;s>0&&(o.set(a,s-1),n++)}return 2*n/(e.length+t.length-2)}(o,e);return t.coefficient<n?{value:o,coefficient:n}:t}),{value:"",coefficient:0});if(o.coefficient>.65)return o.value}o.d(t,{a:()=>n})},13450:(e,t,o)=>{function n({header:e="",body:t="",formatMessage:o=(({id:e})=>e),hint:n}){const a=[{value:`#### **${e}**`}];return n&&a.push({value:`${o({id:"aui.mdxEditor.hover.didYouMean"})}: ***${n}?***`,isTrusted:!0}),a.push({value:t}),a}o.d(t,{C:()=>n})},8112:(e,t,o)=>{function n({textModel:e,position:t,numberOfLines:o=0}){return e.getValueInRange({startColumn:0,endColumn:t.column,startLineNumber:t.lineNumber-o,endLineNumber:t.lineNumber})}o.d(t,{O:()=>n})},36433:(e,t,o)=>{o.r(t),o.d(t,{default:()=>F});var n=o(74389),a=o(93345),s=o(47357),r=o(29213),i=o(45053),l=o(31529),d=o(42405),u=o(26999),m=o(86189),c=o(81102),g=o(8112);const p=e=>(e=>{const t=e.matchAll(/Member (?<calculatedMemberUniqueName>.*) AS/gim),o=new Set;for(const e of t){const t=e?.groups?.calculatedMemberUniqueName;t&&o.add(t)}return Array.from(o)})(e).map((e=>{const[{groups:t={}}={}]=e.matchAll(/(\[Measures]).(?:(\[(?<quotedMeasure>.*)\])|(?<unquotedMeasure>\w*))/gi);return t.unquotedMeasure??t.quotedMeasure})).filter(Boolean);function f(e){const t=e.matchAll(/(?:SET|Set)\s+\[(?<quotedSet>[^\]]*)\]|(?:SET|Set)\s+(?<unquotedSet>\w+)/gi);return Array.from(t).map((e=>{const{quotedSet:t,unquotedSet:o}=e.groups||{};return t??o})).filter(Boolean)}function A(e,t){return[...f(e),...(0,l.flatMap)(t,(({sets:e})=>Object.values(e).map((({name:e})=>e))))]}const b=({cubes:e,textModel:t,formatMessage:o})=>A(t.getValue(),e).map((e=>(0,c.y)({label:{label:e,description:o({id:"aui.namedSet"})}}))),h=e=>[(0,c.y)({kind:d.languages.CompletionItemKind.Unit,label:"Measures",preselect:!0}),...(0,l.flatMap)(e,(({name:e,dimensions:t})=>Object.keys(t).map((t=>(0,c.y)({label:{label:t,description:e}})))))],M={getSuggestions:({position:e,textModel:t,cube:o,dataModel:n,formatMessage:a})=>{const s=(0,g.O)({textModel:t,position:e});if(s.toLowerCase().includes("from "))return[];const i=s.match(/\[[^\]]*\]?(?:\.(?:\[[^\]]*\]?|\w*))*$/gim)?.at(-1);if(!i)return[];const[f,A,M,y]=(i||"").split(".").map((e=>e.replace(/\[([^\]]*)\]?/,"$1"))),w=o?[o]:n?(0,u.X)(n):[];if((0,m.t)({dimensionName:f}))return(({cubes:e,textModel:t,formatMessage:o})=>[...(0,l.flatMap)(e,(({name:e,measures:t})=>Object.keys(t).map((t=>(0,c.y)({label:{label:t,description:e}}))))),...p(t.getValue()).map(((e="")=>(0,c.y)({label:{label:e,description:o({id:"aui.mdxEditor.autoCompletion.calculatedMeasure"})}})))])({cubes:w,textModel:t,formatMessage:a});if(void 0===A)return[...b({cubes:w,textModel:t,formatMessage:a}),...h(w)];if(void 0===M)return(({cubes:e,dimensionName:t})=>(0,l.flatMap)(e,(({name:e,dimensions:o})=>{const n=o[t]?.hierarchies??{};return Object.keys(n).map((o=>(0,c.y)({label:{label:o,description:`${e}/${t}`}})))})))({cubes:w,dimensionName:f});if(void 0===y)return(({cubes:e,dimensionName:t,hierarchyName:o})=>[(0,c.y)({label:{label:"AllMember",description:`${t}/${o}`},preselect:!0}),...(0,l.flatMap)(e,(({name:e,dimensions:n})=>{const a=n[t]?.hierarchies[o]?.levels??{};return Object.keys(a).map((n=>(0,c.y)({label:{label:n,description:`${e}/${t}/${o}`}})))}))])({cubes:w,dimensionName:f,hierarchyName:A});const x="ALL"===M?[(0,c.y)({label:{label:"AllMember",description:`${f}/${A}`},preselect:!0})]:[];return x.push(...r.memberPropertyKeywords.map((e=>(0,c.y)({label:e,kind:d.languages.CompletionItemKind.Property,sortText:"zzz"})))),x}},y={getSuggestions:({position:e,textModel:t,cube:o,dataModel:n})=>{if(null===(0,g.O)({textModel:t,position:e,numberOfLines:1}).match(new RegExp(`(${r.kpiKeywords.join("|")})[(][^)]*`,"i")))return[];const a=o?[o]:n?(0,u.X)(n):[];return(0,l.flatMap)(a,(({name:e,kpis:t})=>Object.keys(t).map((t=>(0,c.y)({kind:d.languages.CompletionItemKind.Event,label:{label:t,description:e}})))))}},w={getSuggestions:({position:e,textModel:t})=>null!==(0,g.O)({textModel:t,position:e}).match(/(\bON\b\s*)([\w]*)$/i)?r.axisKeywords.map((e=>(0,c.y)({label:e}))):[]},x={getSuggestions:({position:e,textModel:t,cube:o,dataModel:n})=>{const a=(0,g.O)({textModel:t,position:e}).match(/(FROM\s+)(\[)([^\]]*)(?<CB>\])*/i);return null!==a&&void 0===a.groups?.CB?(o?[o]:n?(0,u.X)(n):[]).map((({name:e})=>(0,c.y)({kind:d.languages.CompletionItemKind.Interface,label:e}))):[]}},C=({position:e,textModel:t,cube:o,dataModel:n,formatMessage:a})=>{const s=(0,l.flatMap)([x,w,M,y],(({getSuggestions:s})=>s({position:e,textModel:t,cube:o,dataModel:n,formatMessage:a})));return s.length>0?s:[...[...r.functionKeywords,...r.kpiKeywords,...r.memberPropertyKeywords,...r.argumentKeywords].map((e=>(0,c.y)({kind:d.languages.CompletionItemKind.Function,label:e}))),...[...r.axisKeywords].map((e=>(0,c.y)({kind:d.languages.CompletionItemKind.EnumMember,label:e}))),...[...r.booleanKeywords,...r.booleanOperatorKeywords].map((e=>(0,c.y)({kind:d.languages.CompletionItemKind.Operator,label:e}))),...[...r.structuralKeywords,...r.cellPropertyKeywords].map((e=>(0,c.y)({kind:d.languages.CompletionItemKind.Keyword,label:e})))]};var v=o(51174),N=o(14290),k=o(13450);const K=e=>(0,l.flatMap)(e,(e=>Object.values(e.measures))),$=e=>(0,l.flatMap)(e,(e=>Object.values(e.dimensions))),E=(e,t)=>{const o=e.find((e=>e.dimensions[t])),n=o?.dimensions[t];return n?Object.values(n.hierarchies):[]},I={getDecorations:({textModel:e,mdxErrorDetails:t,classNames:o,formatMessage:n})=>{if(!t)return[];const a=((e,t)=>{const o=d.editor.createModel(e);try{if(t.from.ch>=0){const e=o.getValueInRange(new d.Range(t.from.line+1,t.from.ch,t.to.line+1,o.getLineLastNonWhitespaceColumn(t.to.line+1))),n=e.length-e.trimLeft().length;return new d.Range(t.from.line+1,t.from.ch+n,t.to.line+1,t.to.ch+n)}return new d.Range(t.from.line,o.getLineLastNonWhitespaceColumn(t.from.line),t.to.line+1,o.getLineFirstNonWhitespaceColumn(t.to.line+1)+t.text.length)}catch{return new d.Range(0,0,0,0)}})(e.getValue(),t),s=e.getOffsetAt(a.getStartPosition());return[(0,v.C)({type:"error",classNames:o,textModel:e,offset:s,length:e.getOffsetAt(a.getEndPosition())-s,options:{hoverMessage:(0,k.C)({header:`${n({id:"aui.mdxEditor.hover.errorOnLine"})} ***${a.startLineNumber}***`,body:`${n({id:"aui.mdxEditor.hover.availableOptionsAre"})} : \n${t.expected?.map((e=>`- ${e}`)).join("\n")}`,hint:(0,N.a)(t.text,t.expected?.map((e=>e.replace(/'/g,"")))??[]),formatMessage:n})}})]}},S=(e,t,{isCaseSensitive:o=!0})=>e.find((e=>o?e.name===t:e.name.toLowerCase()===t.toLowerCase())),O={getDecorations:({textModel:e,classNames:t,formatMessage:o})=>{const n=e.getValue().matchAll(/(?<functionName>\w+)\(/gi),a=[...r.functionKeywords,...r.kpiKeywords],s=[];for(const r of n){const{functionName:n}=r.groups??{};r.index&&!["FROM",...a].map((e=>e.toLowerCase())).includes(n.toLowerCase())&&s.push((0,v.C)({type:"warning",classNames:t,textModel:e,offset:r.index,length:r[0]?.length,options:{hoverMessage:(0,k.C)({header:`${o({id:"aui.mdxEditor.hover.unknownFunction"})} ***${r.groups?.function}***`,body:`${o({id:"aui.mdxEditor.hover.availableFunctionsAre"})} : \n${a.map((e=>`- ${e}`)).join("\n")}`,hint:(0,N.a)(n,a),formatMessage:o})}}))}return s}},R={getDecorations:({textModel:e,cube:t,dataModel:o,classNames:n,formatMessage:a})=>{if(!o&&!t)return[];const s=e.getValue().matchAll(/(?:FROM\s+)(?:([(])|\[([^\]]*)\]?|(\w*))/gi),r=t?[t.name]:o?(0,u.X)(o).map((({name:e})=>e)):[],i=[];for(const t of s){if("("===t[1])continue;const o=t[2]??t[3];t.index&&!r.includes(o)&&i.push((0,v.C)({type:"error",classNames:n,textModel:e,offset:t.index,length:t[0]?.length,options:{hoverMessage:(0,k.C)({header:`${a({id:"aui.error.cubeNotFound"})} ***${o}***`,body:`${a({id:"aui.mdxEditor.hover.availableCubesAre"})} : \n${r.map((e=>`- ${e}`)).join("\n")}`,hint:(0,N.a)(o,r),formatMessage:a})}}))}return i}},L={getDecorations:({textModel:e,cube:t,dataModel:o,classNames:n,isCaseSensitive:a,formatMessage:s})=>{if(!o&&!t)return[];const r=e.getValue().matchAll(/(\[(?<dimensionName>[^\]]*)\]?)(?<dotAfterDimension>\s*\.\s*)?((?:(\[(?<quotedHierarchy>[^\]]*)\]?)|(?<unquotedHierarchy>\w*)))?(?<dotAfterHierarchy>\s*\.\s*)?(?<memberPath>.*)?/gim),i=[];for(const l of r){if(!l.index)continue;const{dimensionName:r,dotAfterDimension:d,quotedHierarchy:c,unquotedHierarchy:g}=l.groups||{},p=e.getPositionAt(l.index);if((0,m.t)({dimensionName:r})||!a&&"measures"===r.toLowerCase()||["from ","member "].some((t=>e.getValueInRange({startLineNumber:p.lineNumber,endLineNumber:p.lineNumber,startColumn:0,endColumn:p.column}).toLowerCase().includes(t))))continue;const f=t?[t]:o?(0,u.X)(o):[],b=$(f),h=A(e.getValue(),f).some((e=>a?e.toLowerCase()===r.toLowerCase():e===r)),M=S(b,r,{isCaseSensitive:a});if(void 0===M&&!h){const t=b.map((({name:e})=>e));i.push((0,v.C)({type:"warning",classNames:n,textModel:e,offset:l.index,length:l[0]?.length,options:{hoverMessage:(0,k.C)({header:`${s({id:"aui.mdxEditor.hover.dimensionNotFound"})} ***${r}***`,body:`${s({id:"aui.mdxEditor.hover.availableDimensionsAre"})} : \n${t.map((e=>`- ${e}`)).join("\n")}`,hint:(0,N.a)(r,t),formatMessage:s})}}));continue}const y=(c||g)??"";if(d){const t=M?E(f,M.name):[];if(!Boolean(S(t,y,{isCaseSensitive:a}))){const o=t.map((e=>e.name));i.push((0,v.C)({type:"warning",classNames:n,textModel:e,offset:l.index,length:l[0]?.length,options:{hoverMessage:(0,k.C)({header:s({id:"aui.mdxEditor.hover.hierarchyWarning"},{dimensionName:r,hierarchyName:y}),body:`${s({id:"aui.mdxEditor.hover.availableHierarchiesAre"},{dimensionName:r,hierarchyName:y})} : \n${o.map((e=>`- ${e}`)).join("\n")}`,hint:(0,N.a)(y,o),formatMessage:s})}}));continue}}}return i}},P={getDecorations:({textModel:e,dataModel:t,classNames:o,formatMessage:n})=>{if(!t)return[];const a=e.getValue().matchAll(new RegExp(`(${r.kpiKeywords.join("|")})[(][^]*?"(?<kpi>.*)"[^]*?[)]`,"gim")),s=(0,l.flatMap)((0,u.X)(t),(e=>Object.keys(e.kpis))),i=[];for(const t of a){const a=t.groups?.kpi??"";t.index&&!s.includes(a)&&i.push((0,v.C)({type:"warning",classNames:o,textModel:e,offset:t.index,length:t[0]?.length,options:{hoverMessage:(0,k.C)({header:`${n({id:"aui.mdxEditor.hover.invalidKPI"})} ***${a}***`,body:`${n({id:"aui.mdxEditor.hover.availableKPIsAre"})} : \n${s.map((e=>`- ${e}`)).join("\n")}`,hint:(0,N.a)(a,s),formatMessage:n})}}))}return i}},V={getDecorations:({textModel:e,cube:t,dataModel:o,classNames:n,formatMessage:a=(()=>"")})=>{if(!o)return[];const s=e.getValue().matchAll(/(\[Measures]).(?:(\[(?<quotedMeasure>.*)\])|(?<unquotedMeasure>\w*))/gi),r=t?[t]:(0,u.X)(o),i=[...K(r).map((({name:e})=>e)),...p(e.getValue())],l=[];for(const t of s){const{groups:{unquotedMeasure:o,quotedMeasure:s}={unquotedMeasure:void 0,quotedMeasure:void 0}}=t||{},r=o??s??" ";if(t.index&&!i.includes(r)){const o=e.getPositionAt(t.index);if(["from","member"].some((t=>e.getValueInRange({startLineNumber:o.lineNumber,endLineNumber:o.lineNumber,startColumn:0,endColumn:o.column}).toLowerCase().includes(t))))continue;l.push((0,v.C)({type:"warning",classNames:n,textModel:e,offset:t.index,length:t[0]?.length,options:{hoverMessage:(0,k.C)({header:`${a({id:"aui.mdxEditor.hover.invalidMeasure"})} **${r}**`,body:`${a({id:"aui.mdxEditor.hover.availableMeasuresAre"})} : \n${i.map((e=>`- ${e}`)).join("\n")}`,hint:(0,N.a)(r,i),formatMessage:a})}}))}}return l}},j={provideDocumentFormattingEdits:e=>{try{return[{range:e.getFullModelRange(),text:(0,r.stringify)((0,r.parse)(e.getValue()),{indent:!0})}]}catch{}}},q={id:"mdx",monarchLanguage:{defaultToken:"",tokenPostfix:".mdx",ignoreCase:!0,brackets:[{open:"{",close:"}",token:"delimiter.curly"},{open:"[",close:"]",token:"delimiter.square"},{close:"(",open:")",token:"delimiter.parenthesis"}],functionKeywords:r.functionKeywords,kpiKeywords:r.kpiKeywords,argumentKeywords:r.argumentKeywords,memberPropertyKeywords:r.memberPropertyKeywords,axisKeywords:r.axisKeywords,cellPropertyKeywords:r.cellPropertyKeywords,booleanOperatorKeywords:r.booleanOperatorKeywords,booleanKeywords:r.booleanKeywords,structuralKeywords:r.structuralKeywords,tokenizer:{root:[{include:"@comments"},{include:"@whiteSpace"},{include:"@numbers"},{include:"@strings"},{include:"@delimitedIdentifier"},[/[\w@]+/,{cases:{"@structuralKeywords":"keyword.structural","@booleanKeywords":"boolean","@booleanOperatorKeywords":"keyword.booleanOperator","@axisKeywords":"keyword.axis","@cellPropertyKeywords":"keyword.cellProperty","@functionKeywords":"keyword.function","@kpiKeywords":"keyword.kpi","@memberPropertyKeywords":"keyword.memberProperty","@argumentKeywords":"keyword.argument","@default":"identifier.regular"}}],{include:"@operators"}],comments:[[/(^|[^\\:])\/\/.*/,"comment"],[/(^|[^\\:])-{2}.*/,"comment"],[/(^|[^\\])\/\*[\s\S]*?(?:\*\/|$)/,"comment"]],whiteSpace:[[/\s+/,"white"]],numbers:[[/\d*\.\d+(E(\+|-)?\d+)?/,"number"],[/\d+/,"number"]],operators:[[/\+|\/|\*|\^|-/,"operator"],[/>=|<=|<>|=|>|</,"operator"],[/:|&/,"operator"]],delimitedIdentifier:[[/\[([^\]]{0,100})\]/,"identifier.delimited"]],strings:[[/'/,{token:"string",next:"@string"}],[/"/,{token:"string.double",next:"@stringDouble"}]],string:[[/[^']+/,"string"],[/''/,"string"],[/'/,{token:"string",next:"@pop"}]],stringDouble:[[/[^"]+/,"string.double"],[/""/,"string.double"],[/"/,{token:"string.double",next:"@pop"}]]}},configuration:{comments:{lineComment:"//",blockComment:["/*","*/"]},brackets:[["{","}"],["[","]"],["(",")"]],autoClosingPairs:[{open:"{",close:"}"},{open:"[",close:"]"},{open:"(",close:")"},{open:'"',close:'"'},{open:"'",close:"'"}],surroundingPairs:[{open:"{",close:"}"},{open:"[",close:"]"},{open:"(",close:")"},{open:'"',close:'"'},{open:"'",close:"'"}],onEnterRules:[{beforeText:/.*\bSELECT\s*$/,action:{indentAction:1}},{beforeText:/.*\bFROM\s*$/,action:{indentAction:1}}]}},D=()=>{},F=(0,a.forwardRef)((({value:e,cube:t,dataModel:o,isCaseSensitive:u,classNames:m,onChange:c=D,options:g},p)=>{const{formatMessage:f}=(0,s.useIntl)(),[A,b]=(0,a.useState)(),h=(0,a.useMemo)((()=>(({cube:e,dataModel:t,formatMessage:o})=>({triggerCharacters:["[","."],provideCompletionItems:(n,a,s,r)=>{if(!r.isCancellationRequested)return{suggestions:C({position:a,textModel:n,cube:e,dataModel:t,formatMessage:o})}}}))({cube:t,dataModel:o,formatMessage:f})),[t,o,f]),M=(0,a.useMemo)((()=>(({value:e,mdxErrorDetails:t,cube:o,dataModel:n,classNames:a,formatMessage:s,isCaseSensitive:r})=>{if(!e)return[];const i=d.editor.createModel(e);return(0,l.flatMap)([I,R,V,L,P,O],(({getDecorations:e})=>e({textModel:i,mdxErrorDetails:t,cube:o,dataModel:n,classNames:a,formatMessage:s,isCaseSensitive:r})))})({value:e,dataModel:o,cube:t,mdxErrorDetails:A,classNames:m,formatMessage:f,isCaseSensitive:u})),[e,A,o,m,f,t,u]);return(0,a.useEffect)((()=>{try{e&&(0,r.parse)(e),b(void 0)}catch(e){if(!(e instanceof r.MdxError))throw e;b(e.details)}}),[e]),(0,n.Y)(i.default,{ref:p,value:e,onChange:c,language:q,options:g,documentFormattingEditProvider:j,completionItemProvider:h,deltaDecorations:M})}))},68968:e=>{e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAQAAAAECAYAAACp8Z5+AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAAZdEVYdFNvZnR3YXJlAHBhaW50Lm5ldCA0LjAuMTZEaa/1AAAAHUlEQVQYV2PYvXu3JAi7uLiAMaYAjAGTQBPYLQkAa/0Zef3qRswAAAAASUVORK5CYII="},3552:e=>{e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAQAAAC1+jfqAAAAL0lEQVQoz2NgCD3x//9/BhBYBWdhgFVAiVW4JBFKGIa4AqD0//9D3pt4I4tAdAMAHTQ/j5Zom30AAAAASUVORK5CYII="},62974:e=>{e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAQAAADZc7J/AAAAz0lEQVRIx2NgYGBY/R8I/vx5eelX3n82IJ9FxGf6tksvf/8FiTMQAcAGQMDvSwu09abffY8QYSAScNk45G198eX//yev73/4///701eh//kZSARckrNBRvz//+8+6ZohwCzjGNjdgQxkAg7B9WADeBjIBqtJCbhRA0YNoIkBSNmaPEMoNmA0FkYNoFKhapJ6FGyAH3nauaSmPfwI0v/3OukVi0CIZ+F25KrtYcx/CTIy0e+rC7R1Z4KMICVTQQ14feVXIbR695u14+Ir4gwAAD49E54wc1kWAAAAAElFTkSuQmCC"}}]);