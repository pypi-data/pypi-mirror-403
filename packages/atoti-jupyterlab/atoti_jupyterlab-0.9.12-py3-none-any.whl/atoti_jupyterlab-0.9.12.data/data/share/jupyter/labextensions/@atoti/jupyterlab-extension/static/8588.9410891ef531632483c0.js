"use strict";(self.webpackChunk_atoti_jupyterlab_extension=self.webpackChunk_atoti_jupyterlab_extension||[]).push([[8588],{19764:(e,t,n)=>{n.d(t,{V:()=>p});var i=n(31529),r=n(93345),a=n(47357),o=n(50466),s=n(51121),u=n(29213),c=n(29549),d=n(25617),l=n(51727),f=n(63449);const g=(e,t)=>{const n=(0,i.findKey)(e,(e=>"primaryOrdinal"===e.role)),r=n?t[n]:void 0;return r?r.at(-1):void 0};var m=n(90147);function p({cube:e,widgetState:t,onWidgetChange:n}){const p=function({cube:e,widgetState:t,onWidgetChange:n}){const{formatMessage:o}=(0,a.useIntl)(),s=(0,d.DP)(),g=(0,c.useWidgetPlugin)(t.widgetKey),p=(0,r.useRef)(t),x=(0,r.useRef)(`expand-button-${(0,l.Y)()}`);(0,r.useEffect)((()=>{p.current=t}),[t]);const{attributes:h={}}=g,w=t.query.mdx,b=(0,r.useMemo)((()=>{if(!w)return;const e=(0,f.getAxisNameForAttributeRole)("primaryOrdinal",w);return(0,u.getAxisByName)(w,e)}),[w]);if(!b)return;const v=(0,i.findKey)(h,(e=>"primaryOrdinal"===e.role)),y=v?t.mapping[v]:void 0;if(void 0===(y?y.at(-1):void 0))return;if(!(0,u.getLevels)(b,{cube:e}).at(-1))return;const C=t.isInExpandMode?s.textColor:s.disabledTextColor,k={width:500,height:600,svg:`\n      <svg width="13" height="14" viewBox="0 0 13 14" fill="none" xmlns="http://www.w3.org/2000/svg">\n        <style>\n            a[data-attr="${x.current}"] {\n              cursor:"pointer" !important;\n            }\n        </style>\n        <path d="M12.0007 6.52222H0.416495C0.0690387 6.52222 -0.124973 6.88907 0.0902035 7.13953L5.88233 13.8558C6.04812 14.0481 6.36735 14.0481 6.53491 13.8558L12.327 7.13953C12.5422 6.88907 12.3482 6.52222 12.0007 6.52222Z" fill="${C}"/>\n        <rect x="3.51196" width="5.51877" height="6.5256" rx="1" fill="${C}"/>\n      </svg>`};return{title:o({id:`aui.switch${t.isInExpandMode?"Off":"On"}DrillDown`}),name:"expandMode-"+(t.isInExpandMode?"on":"off"),icon:k,attr:x.current,click:()=>{const e=(0,m.produce)(p.current,(e=>{e.isInExpandMode=!e.isInExpandMode}));n?.(e)}}}({cube:e,widgetState:t,onWidgetChange:n}),x=function({cube:e,onWidgetChange:t,widgetState:n}){const m=(0,d.DP)(),{formatMessage:p}=(0,a.useIntl)(),x=(0,c.useWidgetPlugin)(n.widgetKey),h=(0,r.useRef)(`collapse-button-${(0,l.Y)()}`),w=(0,r.useRef)(n),b=(0,r.useRef)(void 0),v=(0,r.useMemo)((()=>g(x.attributes||{},n.mapping)),[x.attributes,n.mapping]),{mdx:y}=n.query,C=(0,r.useMemo)((()=>{if(!y)return;const e=(0,f.getAxisNameForAttributeRole)("primaryOrdinal",y);return e?(0,u.getAxisByName)(y,e):void 0}),[y]),k=(0,r.useMemo)((()=>{if(!y||!C)return;const t=(0,u.getExpandedTuples)(C,e),n=t.reduce(((e,{tupleCoordinates:t})=>(t.length>e&&(e=t.length),e)),0);return t.filter((({tupleCoordinates:e})=>e.length===n)).map((e=>e.tupleCoordinates))}),[y,e,C]);if((0,r.useEffect)((()=>{w.current=n}),[n]),(0,r.useEffect)((()=>{b.current=k}),[k]),!v)return;const M=void 0!==k&&0!==k.length;if(!C)return;const I=(0,u.getLevels)(C,{cube:e}).at(-1);if(!I)return;const{dimensionName:S,hierarchyName:N,levelName:E}=I,$=(0,o.q)({dimensionName:S,hierarchyName:N},e).levels,W=$[E].index,A=M?Object.keys($).find((e=>$[e].index===W-1)):void 0,L=M?p({id:"aui.goUp"},{levelName:A}):p({id:"aui.cannotGoUp"},{hierarchyName:N,levelName:E});return{icon:{width:500,height:600,svg:`\n        <svg width="13" height="14" viewBox="0 0 13 14" fill="none" xmlns="http://www.w3.org/2000/svg" version="1.1" xmlns:xlink="http://www.w3.org/1999/xlink" transform="matrix(1,0,0,-1,0,0)">\n            <style>\n                a[data-attr="${h.current}"] {\n                  cursor: ${M?"pointer":"not-allowed"}!important;\n                }\n            </style>\n            <path d="M12.0007 6.52222H0.416495C0.0690387 6.52222 -0.124973 6.88907 0.0902035 7.13953L5.88233 13.8558C6.04812 14.0481 6.36735 14.0481 6.53491 13.8558L12.327 7.13953C12.5422 6.88907 12.3482 6.52222 12.0007 6.52222Z" fill="${m.disabledTextColor}"></path>\n            <rect x="3.51196" width="5.51877" height="6.5256" rx="1" fill="${m.disabledTextColor}"></rect>\n        </svg>\n        `},title:L,name:"collapse"+(M?"":"-disabled"),click:M?()=>{const n=b.current,i=w.current;if(!n)return;const r=n.reduce(((t,n)=>(0,s.s)({cube:e,tupleCoordinates:n,widgetState:t})),i);t?.(r)}:i.noop,attr:h.current}}({cube:e,widgetState:t,onWidgetChange:n});return{modeBarButtonsToAdd:[x,p].filter((e=>void 0!==e))}}},71653:(e,t,n)=>{n.d(t,{_:()=>u});var i=n(93345),r=n(96531),a=n(2032),o=n(96836),s=n(63449);function u({cube:e,data:t,traces:n,widgetState:u,onWidgetChange:c}){const{mdx:d}=u.query,l=n[0].cellsIndices,f=(0,i.useMemo)((()=>d&&(0,s.getAxisNameForAttributeRole)("primaryOrdinal",d)),[d]);return(n,i)=>{const{pointIndex:s}=i,d=l[s]||[],{rowIndex:g,columnIndex:m}=d[0],p=f?(0,r.getHierarchyIndicesInCellSet)(t,{axisNames:[f]}):{},x=(0,r.getTuple)({columnIndex:m,data:t,hierarchyIndicesInCellSet:p,rowIndex:g});if(!x)throw new Error(`Could not find the corresponding tuple for the trace at index ${s}.`);const h=(0,r.trimTrailingTotals)(x,e);if(!h.at(-1))throw new Error("Cannot expand an empty tuple");const w=(0,a.J)({cube:e,mapping:u.mapping,tuple:x}),b=(0,o.N)({cube:e,toLevel:w,tupleCoordinates:h,widgetState:u});c?.(b)}}},55624:(e,t,n)=>{n.d(t,{F:()=>u});var i=n(31529),r=n(91287),a=n(63449),o=n(43623);function s(e){const{numberOfDecimals:t=2,numberFormat:n}=e,i=`,.${t}f`;let r;switch(n){case"percentage":r=" %";break;case"thousands":r=" K";break;case"millions":r=" M";break;case"billions":r=" B";break;default:r=void 0}return{tickformat:i,ticksuffix:r}}const u=(e,t,n)=>{if(!e)return{};const{mapping:u,style:c}=e;if((0,i.isEmpty)(c?.measures))return{};const d={},l={};(0,r.W)(t).forEach((([e,t])=>{if(!t)return;const n=u[t];if(n&&0!==n.length)for(const t of n){if(!(0,a.isMeasureInMapping)(t))continue;const n=c?.measures?.[t.measureName];if(!n)continue;const i=s(n);d[e]={tickformat:i.tickformat,...i.ticksuffix&&{ticksuffix:i.ticksuffix}},l[e]=i;break}}));const f=((e,t)=>{const n={};return(0,o.U)(e,(({axis:e,subplotKey:i})=>{const r=t[`${e}axis`];r&&(n[i]={tickformat:r.tickformat,...r.ticksuffix&&{ticksuffix:r.ticksuffix}})})),n})(n,l);return{...d,...f}}},18588:(e,t,n)=>{n.r(t),n.d(t,{default:()=>I});var i=n(74389),r=n(53920),a=n.n(r),o=n(58038),s=n.n(o),u=n(93345),c=n(47357),d=n(83506),l=n(19764),f=n(71653),g=n(89041),m=n(56853),p=n(9117),x=n(18355),h=n(26323),w=n(5849),b=n(95219),v=n(55624),y=n(60017),C=n(79412);const k={xaxis:"xAxis",yaxis:"values"};var M=n(23573);s().register(a());const I=(0,p.withLoadingOverlay)((0,p.withoutIrrelevantRenders)((0,d.c)((0,u.memo)((e=>{const{cube:t,data:n,metaData:r,widgetState:a}=e,{formatMessage:o}=(0,c.useIntl)(),[s]=(0,m.i)("style.members"),d=o({id:"aui.total"}),p=(0,u.useMemo)((()=>(0,M.K)({cube:t,data:n,metaData:r,widgetState:a,captionForTotals:d,userTupleStyles:s})),[t,n,r,a,d,s]),I=(0,u.useMemo)((()=>((e,t)=>{if(!e)return{};let n=(0,C.Z)({xaxis:{gridcolor:"transparent"}},(0,x.w)(e.subplots),(0,h.M)(e.subplots,{fontSize:t?.style?.axisLabelFontSize}),(0,w.u)(e,"xaxis"),(0,b.U)(t,k),(0,v.F)(t,k,e.subplots));return n=(0,y.C)(n,{axes:["xaxis","yaxis"],fontSize:t?.style?.axisLabelFontSize}),n})(r,a)),[r,a]),S=(0,l.V)({cube:t,widgetState:a,onWidgetChange:e.onChange}),N=(0,f._)({cube:t,data:n,traces:p,widgetState:a,onWidgetChange:e.onChange});return(0,i.Y)(g.Kl,{...e,config:S,onClick:a.isInExpandMode?N:void 0,traces:p,layout:I,cube:t,data:n,metaData:r})})))))}}]);