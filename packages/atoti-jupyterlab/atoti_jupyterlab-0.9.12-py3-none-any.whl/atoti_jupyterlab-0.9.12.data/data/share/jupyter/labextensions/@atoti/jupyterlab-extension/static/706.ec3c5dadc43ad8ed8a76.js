"use strict";(self.webpackChunk_atoti_jupyterlab_extension=self.webpackChunk_atoti_jupyterlab_extension||[]).push([[706],{12555:(e,t,r)=>{r.d(t,{o:()=>d});var i=r(74389),n=r(97059),a=r(93345),o=r(25617),s=r(18664);const{useToken:l}=n.theme,d=(0,a.forwardRef)((({label:e,style:t,children:r,isActive:n},d)=>{const c=(0,a.useRef)(null),{token:u}=l(),g=(0,o.DP)(),h=(0,s.useHasOverflow)(c);return(0,i.FD)("div",{ref:d,style:{border:`1px solid ${n?g.primaryColor:u.colorBorder}`,...t,position:"relative",display:"inline-flex",alignItems:"center",paddingTop:`${u.paddingXS}px`,borderRadius:`${u.borderRadius}px`},children:[(0,i.Y)(s.Tooltip,{title:e,trigger:h?["hover"]:[],children:(0,i.Y)("span",{ref:c,css:{position:"absolute",top:"0px",transform:"translateY(-55%)",width:"min-content",maxWidth:"80%",left:u.marginSM,paddingInline:`${u.paddingXS}px`,backgroundColor:t?.backgroundColor,fontSize:10,lineHeight:1.26,overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis"},children:e})}),r]})}))},70706:(e,t,r)=>{r.r(t),r.d(t,{EmptyWidget:()=>Ct,FiltersBar:()=>gt,FiltersEditor:()=>Qt,InvalidMdxTypeError:()=>or,IsContextMenuOpenProvider:()=>p,MdxInconsistentWithDashboardOrPageFiltersError:()=>sr,NoDataOverlay:()=>Tr,ResizableEditor:()=>xt,TitleBarMenu:()=>Wr,Widget:()=>ft,WidgetErrorFallback:()=>vr,WidgetInDashboard:()=>vt,WidgetLoadingBar:()=>Fr,WidgetLoadingOverlay:()=>fr,WidgetLoadingOverlayProvider:()=>yr,addFilters:()=>qr,deriveStateFromMdx:()=>dr,deserializeSavedWidgetDropItem:()=>jr,deserializeWidgetDropItem:()=>Vr,filterWidgetState:()=>Or,getFilteredQuery:()=>Xt,getFilteredWidgetState:()=>$r,getFiltersBySection:()=>Zt,getFiltersFromSelection:()=>Ir,getKpiPropertyCaption:()=>cr,getSafeMapping:()=>ur,getSavedWidgetDragItem:()=>Qr,getStringifiedQuery:()=>er,getWidgetDragItem:()=>Rr,getWidgetQuery:()=>tr,isMappingEmpty:()=>Ft,isSavedWidgetDropItem:()=>zr,isWidgetDropItem:()=>Ar,isWidgetInDashboard:()=>ht,savedWidgetMimeType:()=>Lr,serializeWidgetPlugin:()=>Tt,serializeWidgetState:()=>Yt,stringifyWidgetMdx:()=>Kt,updateDashboardStateWithFiltersBySection:()=>At,useContextualizedQuery:()=>gr,useFilterFolders:()=>Xe,useFilters:()=>at,useIsContextMenuOpen:()=>m,useIsQuerySuspended:()=>Gt,useMdxInViews:()=>qe,useQueryContexts:()=>ct,useSuspendedQueryResult:()=>Ht,useUserFilters:()=>rt,useWidgetName:()=>Wt,useWidgetQueryResult:()=>rr,widgetMimeType:()=>Er,withLoadingOverlay:()=>Dr,withStateCleanup:()=>ir,withWidgetLoadingBar:()=>kr,withWidgetQueryErrorBoundary:()=>xr,withoutIrrelevantRenders:()=>Nr});var i=r(40570),n=r(93345),a=r.n(n),o=r(29549),s=r(63449),l=r(74389);class d extends Error{actionHandlerKey;availableActionHandlers;constructor(e,t){super(`No action handler with key "${e}" was found. Available action handlers are: ${JSON.stringify(t)}`),this.actionHandlerKey=e,this.availableActionHandlers=t}}var c=r(26491),u=r(78378),g=r(18664);const h=(0,n.createContext)(!1),p=h.Provider;function m(){return(0,n.useContext)(h)}var y=r(97059),f=r(93441);const b=(0,n.createContext)(void 0),v=({children:e,...t})=>(0,l.Y)(b.Provider,{value:t,children:e}),w=()=>{const e=(0,n.useContext)(b);if(void 0===e)throw new Error("Missing `MenuWithItemsProps` provider");const{keys:t,actionProps:r,closeContextMenu:i,...a}=e,o=(0,f.uC)(t),[s,d]=(0,n.useState)([]),c=(0,n.useRef)(!1),u=[],g=[];for(const e of o){!1===e.doesContextMenuCloseOnClick&&g.push(e.key);const t=e.useMenuItem(r);t&&u.push({key:e.key,...t})}return(0,l.Y)(y.Menu,{openKeys:s,onOpenChange:e=>{0!==e.length||!0!==c.current?d(e):c.current=!1},onClick:e=>{g.some((t=>e.keyPath.includes(t)))?c.current=!0:i?.()},...a,items:u})},S=({children:e,widgetKey:t,keys:r,actionProps:i})=>{const[a,o]=(0,n.useState)(!1);return(0,l.Y)(p,{value:a,children:(0,l.Y)(v,{keys:r,actionProps:i,closeContextMenu:()=>o(!1),css:{maxWidth:600},children:(0,l.Y)(g.Dropdown,{onOpenChange:o,dropdownRender:()=>(0,l.Y)(w,{}),trigger:["contextMenu"],children:e},t)})})};var x=r(90147),C=r(31529),F=r(52970),M=r(86351),k=r(11250),N=r(81408),D=r(82969),K=r(19255),Y=r(9526),T=r(26999),W=r(86189),B=r(13029),P=r(50466),I=r(90506),q=r(69275);function O(e,t){if("members"===e.type&&(0,W.t)(e))return 0===e.members.length||void 0!==(0,B.D)(e.members[0][0],t);try{return(0,P.q)(e,t),!0}catch(e){if(e instanceof I.O||e instanceof q.h)return!1;throw e}}const $=({filter:e,cubesPerServer:t})=>(0,C.flatMap)(Object.entries(t),(([e,t])=>t.map((t=>({cube:t,serverKey:e}))))).filter((({cube:t})=>O(e,t)));var E=r(25617),R=r(47357),A=r(69394),V=r(70935),L=r(92673),Q=r(24366);const z=Q.A.default??Q.A,j=L.A.default??L.A,G=a().forwardRef(((e,t)=>(0,l.Y)(z,{...e,ref:t,icon:j})));var H=r(20952);const U=Q.A.default??Q.A,J=H.A.default??H.A,X=a().forwardRef(((e,t)=>(0,l.Y)(U,{...e,ref:t,icon:J})));var _=r(37309),Z=r(19994),ee=r(20743),te=r(95138),re=r(86790),ie=r(25070),ne=r(16970),ae=r(6522),oe=r(18222),se=r(89608),le=r(14921),de=r(27708),ce=r(97876),ue=r(12555);const ge=({cube:e,filter:t,onFilterChanged:r,style:i})=>{const[a,o]=(0,n.useState)(!1),[s,d]=(0,n.useState)(!1),{formatMessage:c}=(0,R.useIntl)(),{useToken:u}=y.theme,{token:h}=u(),p=(0,n.useMemo)((()=>{switch(t.type){case"existenceOfValue":return{element:(0,l.Y)(te.N,{doesExist:t.doesExist,onChange:e=>r({...t,doesExist:e})}),caption:c({id:"aui.filters.existenceOfValue."+(t.doesExist?"exist":"doesNotExist")})};case"topBottomMembers":{const i=(0,P.q)({dimensionName:t.dimensionName,hierarchyName:t.hierarchyName},e),n=Object.values(i.levels),a=i.levels[t.levelName].index;let o=c({id:`aui.filters.topBottomMode.${t.topBottomMode}`});return a>1&&"ofEachParent"===t.scope&&(o+=` ${c({id:"aui.filters.in-each"})} ${n[a-1].caption}`),{element:(0,l.Y)(re.c,{topBottomMode:t.topBottomMode,scope:t.scope,levels:n,levelIndex:a,onTopBottomModeChange:e=>r({...t,topBottomMode:e}),onScopeChange:e=>r({...t,scope:e})}),caption:o}}case"lowerOrGreaterValue":return{element:(0,l.Y)(ie.X,{lowerOrGreaterMode:t.lowerOrGreaterMode,lowerOrGreaterLimit:t.lowerOrGreaterLimit,onModeChange:e=>r({...t,lowerOrGreaterMode:e}),onLimitChange:e=>r({...t,lowerOrGreaterLimit:e})}),caption:`${c({id:`aui.filters.lowerOrGreaterMode.${t.lowerOrGreaterMode}`})} ${t.lowerOrGreaterLimit}`};case"valuesRange":return{element:(0,l.Y)(ne.s,{isBetween:t.isBetween,lowerLimit:t.lowerLimit,upperLimit:t.upperLimit,onIsBetweenChange:e=>r({...t,isBetween:e}),onLowerLimitChange:e=>r({...t,lowerLimit:e}),onUpperLimitChange:e=>r({...t,upperLimit:e})}),caption:`${c({id:"aui.filters.betweenMode."+(t.isBetween?"isBetween":"isNotBetween")})} ${t.lowerLimit} ${c({id:"aui.and"})} ${t.upperLimit}`};case"captionsContaining":return{element:(0,l.Y)(ae.g,{containingMode:t.containingMode,token:t.token,onContainingModeChange:e=>r({...t,containingMode:e}),onTokenChange:e=>r({...t,token:e})}),caption:`${c({id:`aui.filters.containingMode.${t.containingMode}`})} "${t.token}"`};case"lowerOrGreaterCaptions":return{element:(0,l.Y)(oe.s,{lowerOrGreaterMode:t.lowerOrGreaterMode,token:t.token,onLowerOrGreaterModeChange:e=>r({...t,lowerOrGreaterMode:e}),onTokenChange:e=>r({...t,token:e})}),caption:`${c({id:`aui.filters.alphabeticallyBeforeOrAfterMode.${t.lowerOrGreaterMode}`})} "${t.token}"`};case"captionsRange":return{element:(0,l.Y)(se.$,{isBetween:t.isBetween,lowerToken:t.lowerToken,upperToken:t.upperToken,onIsBetweenChange:e=>r({...t,isBetween:e}),onLowerTokenChange:e=>r({...t,lowerToken:e}),onUpperTokenChange:e=>r({...t,upperToken:e})}),caption:`${c({id:"aui.filters.alphabeticallyBetweenMode."+(t.isBetween?"isBetween":"isNotBetween")})} "${t.lowerToken}" ${c({id:"aui.and"})} "${t.upperToken}"`};case"recentDates":return{element:(0,l.Y)(le.T,{numberOfRecentDates:t.numberOfRecentDates,onNumberOfRecentDatesChange:e=>r({...t,numberOfRecentDates:e})}),caption:`${c({id:"aui.filters.recentDates"})} ${t.numberOfRecentDates}`};default:throw new Error(`Filter not supported by ${ge.name}`)}}),[e,t,r,c]),m="topBottomMembers"===t.type,f="measureName"in t,b={keepThe:c({id:"aui.filters.keepThe"}),whose:f?`${c({id:"aui.filters.whose"})} ${t.measureName}`:"",that:f?"":c({id:"aui.that"}),limit:m?t.limit:"",members:c({id:"aui.filters.members"}),of:c({id:"aui.filters.of"})},v="recentDates"===t.type?(0,l.FD)("div",{style:{display:"flex",flexDirection:"column",gap:"10px"},children:[(0,l.FD)("div",{style:{display:"flex",alignItems:"center"},children:[(0,l.Y)(g.Text,{small:!0,children:b.keepThe}),(0,l.Y)(g.Text,{small:!0,children:" "}),p.element,(0,l.Y)(g.Text,{small:!0,children:" "}),b.members]}),(0,l.FD)(g.Text,{small:!0,children:[b.of," ",t.levelName]})]}):(0,l.FD)("div",{style:{display:"flex",flexDirection:"column",gap:"10px"},children:[(0,l.FD)("div",{style:{display:"flex",alignItems:"center"},children:[(0,l.Y)(g.Text,{small:!0,children:b.keepThe}),m?(0,l.Y)(y.InputNumber,{type:"number",min:1,style:{width:100,margin:"0 8px"},value:t.limit,onChange:e=>{null!==e&&r({...t,limit:e})}}):(0,l.Y)(g.Text,{small:!0,children:" "}),(0,l.FD)(g.Text,{small:!0,children:[t.levelName," ",b.that]})]}),f&&(0,l.Y)("div",{children:(0,l.Y)(g.Text,{small:!0,children:b.whose})}),(0,l.Y)("div",{style:{display:"flex"},children:p.element})]}),w="recentDates"===t.type?(0,l.FD)("span",{children:[b.keepThe," ",p.caption," ",b.members," ",(0,l.Y)("br",{}),b.of," ",t.levelName]}):(0,l.FD)("span",{children:[b.keepThe," ",b.limit," ",t.levelName,f?(0,l.FD)(l.FK,{children:[(0,l.Y)("br",{}),b.whose,(0,l.Y)("br",{})]}):(0,l.FD)(l.FK,{children:[" ",b.that,(0,l.Y)("br",{})]}),p.caption]});return(0,l.Y)(ue.o,{label:t.levelName,style:i,isActive:a,children:(0,l.Y)(g.Popover,{open:a,placement:"bottomLeft",trigger:"click",showArrow:!1,overlayStyle:{padding:0},onOpenChange:e=>{e&&d(!1),o(e)},content:v,children:(0,l.Y)(g.Tooltip,{title:w,open:s&&!a,onOpenChange:d,children:(0,l.FD)("span",{role:"button",style:{cursor:"pointer",padding:"0px 5px",display:"flex",alignItems:"center",gap:"4px",height:"100%",whiteSpace:"nowrap"},children:[(0,l.Y)(de.V,{cube:e,filter:t,maxMeasureCaptionWidth:100}),(0,l.Y)(ce.l,{style:{color:h.colorTextQuaternary}})]})})})})};var he=r(87991),pe=r(89674),me=r(48361),ye=r(24162),fe=r(67197),be=r(1783),ve=r(96087),we=r(60739),Se=r(47644),xe=r(94268),Ce=r(49138),Fe=r(7384),Me=r(86622);const ke=e=>{const{cube:t,isHierarchyVirtual:r,isHierarchySlicing:i,serverKey:a,onFilterChanged:o,searchValue:s,filter:d,mdxInView:c,filtersAbove:u,queryContext:g}=e,h=(0,E.DP)(),{formatMessage:p}=(0,R.useIntl)(),[{expansion:m,levelIndex:f,selectedMemberNamePathsHistory:b},v]=(0,n.useReducer)(be.k9,{},(()=>(0,ve.$)(d,t))),w=(0,n.useCallback)((e=>{v({type:"virtualHierarchyMemberSelected",selectedMemberNamePaths:e});const t=(0,x.produce)(d,(t=>{t.members=e}));o(t)}),[d,o]),S=(0,n.useCallback)((({membersTree:e,expansionAction:t})=>{v({type:"memberExpanded",membersTree:e,expansionAction:t})}),[v]),C=(0,n.useCallback)((({searchTree:e,previousSelectedPaths:t,newSelectedPaths:r,isHierarchySlicing:i})=>{const n=(0,xe.g0)({searchTree:e,previousSelectedPaths:t,newSelectedPaths:r,isHierarchySlicing:i}),a=(0,Ce.p)({action:n,previousSelectedMemberNamePaths:d.members}),s={...d,members:a};o(s)}),[d,o]),F=(0,n.useCallback)((e=>{const t=(0,x.produce)(d,(t=>{t.members=e,t.includeAllMembers=!1}));o(t)}),[d,o]),M=(0,we.u)({isHierarchySlicing:i}),k=(0,W.t)(d),N=d.selectionMode??M;return(0,l.FD)("div",{css:{width:"100%",height:350,backgroundColor:h.grayScale[0],display:"flex",flexDirection:"column"},children:[r?(0,l.Y)(Fe.y,{serverKey:a,selectedMemberNamePaths:d.members,selectedMemberNamePathsHistory:b,cubeName:t.name,dimensionName:d.dimensionName,hierarchyName:d.hierarchyName,onSelectionChanged:w,levelIndex:f,onLevelIndexChanged:e=>{v({type:"levelIndexChanged",levelIndex:e})},filters:u,queryContext:g,selectionMode:N}):k?(0,l.Y)(fe.e,{serverKey:a,cubeName:t.name,selectedMeasureNames:d.members.map((([e])=>e)),onMeasureSelected:e=>{const t=(0,x.produce)(d,(t=>{t.members=e.map((e=>[e]))}));o(t)}}):(0,l.Y)(Me.C,{levelIndex:f,expansion:m,isSearchVisible:!1,searchValue:s,selectedMemberNamePaths:d.members,serverKey:a,cubeName:t.name,dimensionName:d.dimensionName,hierarchyName:d.hierarchyName,onMemberSelected:({membersTree:e,nodePaths:t,isAllMemberSelected:r})=>{const i={...d,includeAllMembers:r,members:r?[]:(0,Se.G)(t,e)};o(i)},onMemberExpanded:S,onSearchResultSelected:C,onMemberRemovedInTooltip:F,hasCheckbox:()=>!0,selectionMode:N,isAllMemberSelected:Boolean(d.includeAllMembers),mdxInView:c,filters:u,queryContext:g}),(0,l.FD)("div",{css:{borderTop:`1px solid ${h.grayScale[5]}`,width:"100%",paddingTop:5,marginTop:5,flexShrink:0,display:"flex",flexDirection:"column"},children:[!k&&(0,l.Y)(y.Checkbox,{checked:"multiple"===N,onChange:e=>{(e=>{const t={...d,selectionMode:e};"single"===e&&(t.includeAllMembers=!1,d.members.length>1&&(t.members=[d.members[0]])),o(t)})(e.target.checked?"multiple":"single")},children:p({id:"aui.filters.selectMultiple"})}),(0,l.Y)(y.Checkbox,{checked:d.isExclusionFilter,onChange:e=>{const t={...d,isExclusionFilter:e.target.checked};o(t)},children:p({id:"aui.filters.excludeFilter"})})]})]})},{Text:Ne}=y.Typography,{useToken:De}=y.theme,Ke="130px",Ye=e=>{const{formatMessage:t}=(0,R.useIntl)(),r=(0,E.DP)(),{cube:a,serverKey:o,onFilterChanged:s,filter:d,filtersAbove:c,queryContext:u,mdxInView:h,style:p}=e,[m,f]=(0,n.useState)(),{token:b}=De(),v=(0,W.t)(d),w=v?void 0:(0,P.q)(d,a),S=(0,n.useCallback)((e=>{const t=(0,x.produce)(d,(t=>{t.members.splice(e,1)}));s(t)}),[d,s]),F=d.members.map(((e,t)=>({key:t,value:{namePath:e,index:t}}))),[M,k]=(0,n.useState)(!1),N=(0,n.useRef)(null),D=(0,n.useRef)(null);(0,he.A)(D,(()=>{k(!1),f(void 0)}));const[K,Y]=(0,g.usePopupSize)(N,`${d.dimensionName}-${d.hierarchyName}`),T=d.members.length>0&&w?Object.values(w.levels)[d.members[0].length-1]:void 0,B=(0,pe.O)(d,a),I=B?t({id:"aui.defaultMember"},{caption:B.captionPath.at(-1)}):void 0,q=I&&!M?(0,l.Y)(Ne,{ellipsis:{tooltip:I},css:i.css`
          pointer-events: auto;
        `,children:I}):t({id:"aui.filters.searchMembers"});return(0,l.FD)(ue.o,{ref:D,label:v?t({id:"aui.dataVisualization.measures"}):T?.caption||w.caption,isActive:M,style:p,children:[d.isExclusionFilter&&(0,l.Y)(g.Tooltip,{trigger:["hover"],title:t({id:"aui.excluded"}),children:(0,l.Y)(ye.y,{"data-testid":"exclude-icon",style:{marginLeft:b.marginSM,opacity:0===d.members.length?"0.4":"initial"}})}),(0,l.Y)(i.ClassNames,{children:({css:e})=>(0,l.Y)(y.Select,{showArrow:!0,bordered:!1,className:e`
              .ant-select-selection-overflow-item-rest {
                .ant-select-selection-item {
                  height: 20px;
                  background: ${r.grayScale[1]};
                }
              }

              .ant-select-selection-placeholder {
                margin-left: 2px;
              }

              ${0===d.members.length&&B&&!M?`.ant-select-selection-placeholder {\n                position: relative;\n                left: -3px;\n                transform: none;\n                max-width: ${Ke};\n                transition: none;\n              }\n              .ant-select-selection-overflow {\n                flex-grow: 0;\n              }\n                `:""}
            `,style:{minWidth:0===d.members.length?Ke:void 0,width:"max-content"},open:M,onClick:()=>k((e=>!e)),popupMatchSelectWidth:!1,placeholder:q,searchValue:m,mode:"tags",value:F,maxTagCount:2,onSearch:f,tagRender:({value:e})=>{const{namePath:t,index:r}=e,i=v||w?.slicing?t:t.slice(1),n=i.length>2;return(0,l.Y)(y.Tag,{closable:!0,onClose:()=>{S(r)},style:{display:"inline-flex"},children:(0,l.Y)("span",{css:{maxWidth:Ke,display:"inline-flex",flexWrap:"nowrap",gap:2,"span:last-child":{flexShrink:3},"span:not(:last-child)":{flexShrink:5}},children:(0,C.flatMap)((n?[i[0],(0,l.Y)(g.Tooltip,{style:{flexShrink:0},title:i.slice(1,-1).join(" / "),children:"…"}),i.at(-1)]:i).map((e=>["string"==typeof e?(0,l.Y)(Ne,{ellipsis:{tooltip:e},children:e}):e,"/"]))).slice(0,-1)})},i.join("/"))},dropdownRender:()=>(0,l.FD)("div",{ref:N,onClick:e=>e.stopPropagation(),onMouseDown:e=>e.stopPropagation(),style:{width:Y,display:"inline-flex",padding:"4px 8px"},children:[(0,l.Y)(ke,{cube:a,onFilterChanged:s,isHierarchyVirtual:Boolean(w?.virtual),isHierarchySlicing:Boolean(w?.slicing),serverKey:o,searchValue:m,filter:d,filtersAbove:c,queryContext:u,mdxInView:h}),(0,l.Y)(me.A,{onResize:K})]})})})]})};var Te=r(7239),We=r(29213),Be=r(69937);const Pe=e=>{const{filter:t,section:r,isCorrupt:n,widgetState:a}=e,o=(0,E.DP)(),{useToken:d}=y.theme,{token:c}=d(),{formatMessage:u}=(0,R.useIntl)(),h=(0,W.t)(t),p={backgroundColor:"widget"===r?c.colorBgBase:o.grayScale[1],color:n?o.errorColor:void 0,border:`1px solid ${n?o.errorColor:c.colorBorder}`},m=(0,s.isWidgetWithQueryState)(a)&&a.query.mdx?(0,We.getCubeName)(a.query.mdx):void 0,f=n?u({id:"aui.filters.noMatchingCubeForHierarchy"},{missingHierarchy:`[${t.dimensionName}].[${t.hierarchyName}]`,section:r,cubeName:m}):u({id:"aui.dataVisualization.loadingDataModels"});return(0,l.Y)(ue.o,{label:h?u({id:"aui.dataVisualization.measures"}):t.hierarchyName,style:p,children:(0,l.Y)(g.Tooltip,{title:f,trigger:["hover"],children:(0,l.FD)("div",{style:{minWidth:Ke,display:"flex",height:"100%",alignItems:"center",padding:"0 2px 0 2px",position:"relative"},children:[(0,l.Y)(i.ClassNames,{children:({css:e})=>(0,l.Y)(y.Skeleton,{className:e({flexGrow:1,".ant-skeleton-paragraph li":{height:"22px !important",backgroundColor:`${n?(0,Be.j)(o.errorColor,.15):void 0} !important`}}),active:!n,paragraph:{rows:1,width:"100%"},title:!1})}),n?(0,l.Y)(Te.G,{style:{position:"absolute",color:o.errorColor,right:4}}):null]})})})};var Ie=r(5029);function qe({dashboardState:e,pageKey:t,widgetState:r}){const i=(0,K.W)(e,t),a=(0,M.W)(),o=(0,Ie.A)(),l={dashboard:e?(0,C.flatMap)(e.pages,(({content:e})=>Object.values(e))):[],page:i?Object.values(i.content):[],widget:[r]},d=(0,C.mapValues)(l,(e=>e.filter((e=>(0,s.isWidgetWithQueryState)(e)&&Boolean(e.query.mdx))).map((e=>{const t=e.query.mdx,{serverKey:r}=e;return{cube:(0,s.getTargetCube)({dataModels:a,serverKey:r,cubeName:(0,We.getCubeName)(t),lastUsedCube:o}).cube,mdx:t}})))),c=(0,n.useRef)(d);return["dashboard","page","widget"].some((e=>d[e].length!==c.current[e].length||d[e].some((({mdx:t},r)=>t!==c.current[e][r].mdx))))&&(c.current=d),c.current}const Oe=(0,n.lazy)((async()=>{const{FiltersBarDateRangePicker:e}=await r.e(75).then(r.bind(r,90075));return{default:e}})),$e=e=>{const{filter:t,onFilterChanged:r,dashboardState:i,pageKey:a,widgetState:o,filtersAbove:s,section:d,queryContext:c,cube:u,serverKey:g,style:h}=e,p=qe({dashboardState:i,pageKey:a,widgetState:o})[d];switch(t.type){case"members":return(0,l.Y)(Ye,{cube:u,serverKey:g,onFilterChanged:r,filter:t,filtersAbove:s,mdxInView:p,queryContext:c,style:h});case"previousOrNextTimePeriods":case"timePeriodToDate":case"dateRange":return(0,l.Y)(n.Suspense,{fallback:(0,l.Y)("div",{}),children:(0,l.Y)(Oe,{filter:t,onFilterChanged:r,serverKey:g,cube:u,filtersAbove:s,mdxInView:p,queryContext:c,style:h})});case"topBottomMembers":case"lowerOrGreaterValue":case"valuesRange":case"lowerOrGreaterCaptions":case"captionsRange":case"captionsContaining":case"existenceOfValue":case"recentDates":return(0,l.Y)(ge,{cube:u,filter:t,onFilterChanged:r,style:h});default:return null}},Ee=e=>{const{filter:t,...r}=e,i=(0,ee.d5)(),n=Object.values(i).some((e=>e.isDataModelLoading)),{applicableCubes:a,filter:o}=t,s=a[0];if(n||!s)return(0,l.Y)(Pe,{filter:o,section:r.section,isCorrupt:!n&&!s,widgetState:r.widgetState});const{cube:d,serverKey:c}=s;return(0,l.Y)($e,{...r,filter:o,cube:d,serverKey:c})};var Re=r(85229),Ae=r(91975),Ve=r(51694),Le=r(58760),Qe=r(69460),ze=r(80610),je=r(50158);const Ge=({filterFolder:e,onChange:t,style:r})=>{const{formatMessage:i}=(0,R.useIntl)(),a=(0,E.DP)(),o=(0,n.useRef)(null),[s,d]=(0,n.useState)(!1),c=(0,Le.u)(e.id),{searchValue:u,searchResults:h,onSearchValueChange:p}=(0,Qe.J)(c);(0,he.A)(o,(()=>{d(!1),p("")}));const m=c.find((t=>t.id===e.id)),f=(0,Re.W)("filter");if(!f)return null;const b=(0,Ae.Z)(f,e.id),v=(0,Ve.S)({tree:f,path:b})?.name,w=!m?.isValid;return(0,l.FD)(ue.o,{ref:o,label:v??"",isActive:s,style:{...r,paddingLeft:8},children:[(0,l.Y)(je.x,{style:{color:a.grayScale[8]}}),(0,l.Y)(y.Select,{showSearch:!0,showArrow:!0,bordered:!1,open:s,onClick:()=>d((e=>!e)),popupMatchSelectWidth:!1,searchValue:u,mode:"tags",value:[m],options:h,onSearch:p,tagRender:()=>(0,l.Y)(g.Tooltip,{title:i({id:"aui.filters.filterFolder.cannotApplyFolderWithSubfolders"}),placement:"top",trigger:w?["hover"]:[],children:(0,l.Y)(y.Tag,{color:w?"error":void 0,children:m?.name})}),dropdownRender:()=>(0,l.Y)("div",{onClick:e=>e.stopPropagation(),onMouseDown:e=>e.stopPropagation(),children:(0,l.Y)(ze.J,{searchValue:u,searchResults:h,options:c,selectedOption:e.id,onChange:t})})})]})},He=[],{useToken:Ue}=y.theme,Je=e=>{const{dashboardState:t,pageKey:r,widgetState:a,filters:o,filterFolders:s,pinnedDefaultFilters:d,queryContextBySection:c,onFilterChanged:u,onFilterFolderChanged:h,onPinnedDefaultFilterChanged:p,section:m,isIconVisible:y}=e,f=(0,E.DP)(),{token:b}=Ue(),{formatMessage:v}=(0,R.useIntl)(),w=(0,n.useRef)(null),{width:S}=(0,g.useDebouncedComponentSize)(w),x=o[m]??[],C=s[m]??[],[{isLeftScrollArrowVisible:F,isRightScrollArrowVisible:M},k]=(0,n.useState)({isLeftScrollArrowVisible:!1,isRightScrollArrowVisible:!1}),N=`1px solid ${f.grayScale[5]}`,D={display:"flex",alignItems:"center",height:"100%",background:f.grayScale[3],borderLeft:N,borderRight:N},K={fontSize:16,margin:6,marginTop:8},Y={height:"100%",minWidth:24,zIndex:2,background:f.grayScale[0],position:"absolute",display:"flex",justifyContent:"center"},T=(0,n.useCallback)((()=>{if(w.current){const{scrollLeft:e,scrollWidth:t,clientWidth:r}=w.current,i=e>0,n=e+r<t;F===i&&M===n||k({isLeftScrollArrowVisible:i,isRightScrollArrowVisible:n})}}),[F,M]),W=e=>{w.current?.scrollBy({left:"left"===e?-60:60})};if((0,n.useEffect)((()=>{T()}),[S,T]),0===d.length&&0===x.length&&0===C.length)return null;const B=C.reduce(((e,t,r)=>(t.isPinned&&e.push([t,r]),e)),[]),P=x.reduce(((e,t,r)=>{const{filter:i}=t;return i.isPinned&&e.push([t,r]),e}),[]);if(0===d.length&&0===P.length&&0===B.length)return null;const I=(0,A.D)({sectionName:m,queryContextBySection:c}),q={backgroundColor:"widget"===m?b.colorBgBase:f.grayScale[1]};return(0,l.FD)("div",{style:{display:"flex",alignItems:"stretch",overflow:"hidden",position:"relative"},css:i.css`
        .left-scroll-arrow,
        .right-scroll-arrow {
          visibility: collapse;
        }

        :hover {
          .left-scroll-arrow {
            visibility: ${F?"visible":"collapse"};
          }
          .right-scroll-arrow {
            visibility: ${M?"visible":"collapse"};
          }
        }
      `,children:[y&&"dashboard"===m&&(0,l.Y)(g.Tooltip,{mouseLeaveDelay:0,placement:"bottom",title:v({id:"aui.filters.section.dashboardFilters"}),children:(0,l.Y)("div",{style:D,children:(0,l.Y)(_.z,{style:K})})}),y&&"page"===m&&(0,l.Y)(g.Tooltip,{mouseLeaveDelay:0,placement:"bottom",title:v({id:"aui.filters.section.pageFilters"}),children:(0,l.Y)("div",{style:D,children:(0,l.Y)(Z.Y,{style:K})})}),(0,l.FD)("div",{style:{display:"flex",overflow:"hidden",alignItems:"center"},ref:w,onScroll:T,onWheel:e=>{w.current?.scrollBy({left:e.deltaY<0||e.deltaX<0?-20:20})},children:[(0,l.Y)("div",{className:"left-scroll-arrow",style:{...Y,boxShadow:`5px 0 2px -1px ${f.grayScale[5]}`},onClick:()=>{W("left")},children:(0,l.Y)(G,{})}),(0,l.FD)("div",{style:{display:"flex",gap:"6px",height:"32.5px",margin:"0px 6px",flexShrink:0},children:[B.map((([e,t])=>(0,l.Y)(Ge,{filterFolder:e,style:q,onChange:e=>h(e,t)},`${e.id}-${t}`))),d.map(((e,i)=>(0,l.Y)(Ee,{filter:e,onFilterChanged:e=>{p?.(e,i)},dashboardState:t,widgetState:a,pageKey:r,filtersAbove:He,section:m,style:q,queryContext:I},`${e.filter.dimensionName}.${e.filter.hierarchyName}.${i}`))),P.map((([e,i])=>{const{filter:n,applicableCubes:s}=e,d=s[0],c=d?(0,V.f)({filtersBySection:o,position:{sectionName:m,tileIndex:i},cube:d.cube,serverKey:d.serverKey}):[],g="timePeriodToDate"===n.type||"dateRange"===n.type||"previousOrNextTimePeriods"===n.type?"calendar":n.type;return(0,l.Y)(Ee,{filter:e,onFilterChanged:e=>u(e,i),dashboardState:t,widgetState:a,pageKey:r,filtersAbove:c,section:m,style:q,queryContext:I},`${e.filter.dimensionName}.${e.filter.hierarchyName}.${g}.${i}`)}))]}),(0,l.Y)("div",{className:"right-scroll-arrow",style:{...Y,boxShadow:`-5px 0 2px -1px ${f.grayScale[5]}`,right:0},onClick:()=>{W("right")},children:(0,l.Y)(X,{})})]})]})};function Xe({dashboardState:e,widgetState:t,pageKey:r}){return(0,n.useMemo)((()=>({dashboard:e?.filterFolders??[],page:(0,K.W)(e,r)?.filterFolders??[],widget:t?.filterFolders??[]})),[e,r,t?.filterFolders])}var _e=r(31793),Ze=r(43914),et=r(3472);const tt=[];function rt(){const[e]=(0,Ze.J)("canUseUserFilters"),[t]=(0,et.v)("userFilters");return e&&t?t:tt}const it=[],nt=({cubesPerServer:e,filters:t})=>t.map((t=>({filter:t,applicableCubes:$({filter:t,cubesPerServer:e})})));function at({dashboardState:e,widgetState:t,pageKey:r}){const i=rt(),a=(0,M.W)(),o=(0,Ie.A)(),l=e?.filters??it,d=(0,K.W)(e,r)?.filters??it,c=t&&(0,s.isWidgetWithQueryState)(t)?t.serverKey:void 0,u=t&&(0,s.isWidgetWithQueryState)(t)?t.query.mdx:void 0,g=t&&(0,s.isWidgetWithQueryState)(t)?t.filters??it:it,h=u?(0,We.getCubeName)(u):void 0,{cube:p,serverKey:m}=(0,n.useMemo)((()=>{try{return(0,s.getTargetCube)({dataModels:a,serverKey:c,cubeName:h,lastUsedCube:o})}catch(e){if(e instanceof k.d||e instanceof _e.N)return{cube:void 0,serverKey:void 0};throw e}}),[a,o,c,h]),y=(0,n.useMemo)((()=>(0,C.mapValues)(a,T.X)),[a]);return(0,n.useMemo)((()=>({...(0,C.mapValues)({user:i,dashboard:l,page:d},(e=>nt({filters:e,cubesPerServer:y}))),widget:g.map((e=>({filter:e,applicableCubes:p&&O(e,p)?[{cube:p,serverKey:m}]:[]})))})),[l,d,i,g,y,p,m])}const ot=[];function st({dashboardState:e,widgetState:t,pageKey:r,userQueryContext:i}){const n=e?.queryContext,a=(0,K.W)(e,r)?.queryContext,o=t?.queryContext;return{user:i??ot,dashboard:n??ot,page:a??ot,widget:o??ot}}const lt=[];function dt(){const[e]=(0,Ze.J)("canUseUserQueryContext"),[t]=(0,et.v)("userQueryContext");return e&&t?t:lt}function ct({widgetState:e,dashboardState:t,pageKey:r}){const i=dt();return(0,n.useMemo)((()=>st({dashboardState:t,widgetState:e,pageKey:r,userQueryContext:i})),[t,e,r,i])}function ut(e){return"dashboardState"in e&&Boolean(e.dashboardState)&&Boolean(e.pageKey)&&Boolean(e.leafKey)}const gt=e=>{const t=(0,E.DP)(),r=ut(e)?(0,N.B)(e.dashboardState,e.pageKey,e.leafKey):e.widgetState,i=(0,M.W)(),{dashboardState:a,pageKey:o,leafKey:d,onDashboardChanged:c}={dashboardState:void 0,pageKey:void 0,leafKey:void 0,onDashboardChanged:void 0,...e},u=at({widgetState:r,dashboardState:a,pageKey:o}),g=(0,n.useMemo)((()=>(0,C.pick)(u,e.filterTypes)),[u,e.filterTypes]),h=Xe({dashboardState:a,pageKey:o,widgetState:r}),p=(0,n.useMemo)((()=>(0,C.pick)(h,e.filterTypes)),[h,e.filterTypes]),m=(0,n.useMemo)((()=>e.filterTypes.includes("dashboard")&&a?.pinnedDefaultFilters?a.pinnedDefaultFilters.map((e=>{const t={...e,type:"members",members:[],isPinned:!0},r=(0,C.mapValues)(i,T.X);return{filter:t,applicableCubes:$({filter:t,cubesPerServer:r})}})):[]),[a?.pinnedDefaultFilters,i,e.filterTypes]),y=ct({widgetState:r,dashboardState:a,pageKey:o});function f(e,t){if(!a||!c)return;const r=(0,x.produce)(a,(r=>{r.pinnedDefaultFilters?.splice(t,1),r.filters=r.filters??[],r.filters.unshift(e),(0,D.y)(r,s.driveFiltersFromState)}));c(r)}const b=function({filterTypes:e,filters:t,filterFolders:r,pinnedDefaultFilters:i}){return e.reduce(((e,n)=>"dashboard"===n&&Number(i?.length)>0||t[n]?.some((({filter:e})=>e.isPinned))||r[n]?.some((e=>e.isPinned))?e+1:e),0)}({filterTypes:e.filterTypes,filters:g,filterFolders:p,pinnedDefaultFilters:m}),v=b>1;return b>0&&r?(0,l.Y)("div",{css:{display:"flex",overflow:"hidden",alignItems:"center",...!e.filterTypes.includes("widget")&&{background:t.grayScale[1],borderBottom:`1px solid ${t.grayScale[5]}`}},children:e.filterTypes.map(((t,n)=>(0,l.Y)("div",{style:{height:44,display:"flex",alignItems:"stretch",overflow:"hidden"},children:(0,l.Y)(F.ErrorBoundary,{resetKeys:[i],fallbackRender:({error:e})=>{if(e instanceof k.d)return null;throw e},children:(0,l.Y)(Je,{isIconVisible:v,section:t,filters:g,filterFolders:p,pinnedDefaultFilters:"dashboard"===t?m:[],onPinnedDefaultFilterChanged:"dashboard"===t?f:void 0,queryContextBySection:y,onFilterChanged:(r,i)=>{((t,r,i)=>{const n=e=>{e.filters&&(e.filters[i]=t)};if(ut(e)){if(a&&o&&d&&c){const e=(0,x.produce)(a,(e=>{if("dashboard"===r&&(n(e),(0,D.y)(e,s.driveFiltersFromState)),"page"===r){const t=(0,K.W)(e,o);t&&(n(t),(0,Y.T)(t,s.driveFiltersFromState))}if("widget"===r){const t=(0,N.B)(e,o,d);t&&(n(t),(0,s.driveFiltersFromState)(t))}}));c(e)}}else{const t=(0,x.produce)(e.widgetState,(e=>{n(e),(0,s.driveFiltersFromState)(e)}));e.onWidgetChanged(t)}})(r,t,i)},onFilterFolderChanged:(r,i)=>{((t,r,i)=>{const n=e=>{e.filterFolders&&(e.filterFolders[i].id=t)};if(ut(e)){if(a&&o&&d&&c){const e=(0,x.produce)(a,(e=>{if("dashboard"===r&&(n(e),(0,D.y)(e,s.driveFiltersFromState)),"page"===r){const t=(0,K.W)(e,o);t&&(n(t),(0,Y.T)(t,s.driveFiltersFromState))}if("widget"===r){const t=(0,N.B)(e,o,d);t&&(n(t),(0,s.driveFiltersFromState)(t))}}));c(e)}}else{const t=(0,x.produce)(e.widgetState,(e=>{n(e),(0,s.driveFiltersFromState)(e)}));e.onWidgetChanged(t)}})(r,t,i)},widgetState:r,dashboardState:a,pageKey:o})})},n)))}):null};function ht(e){return"dashboardState"in e}function pt(e){return()=>e}const mt=[],yt=e=>{const{widgetPlugin:t,onChange:r,isSelected:a,...o}=e,g=(t.useOnDataModelNodeClicked??pt)(e.widgetState);(0,u.gO)((e=>{if(a){const t=g(e);r(t)}}));const h=t?.contextMenuItems??mt,p=(0,n.useMemo)((()=>({...o,onWidgetChange:r})),[o,r]),m=function(e){const t=e.widgetState.behavior?.actionHandler,r=(0,c.h)();let i;for(const n of Object.values(r)){const r=n.key===t?.key,a=r?t?.configuration:void 0,o=n.useOnElementsActioned({...e,configuration:a,onWidgetChange:e.onWidgetChange});r&&(i=o)}if(t){if(!i)throw new d(t.key,Object.keys(r));return i}}(p),{leafKey:y,pageKey:f,dashboardState:b,onDashboardChange:v}=ht(e)?e:{leafKey:void 0,pageKey:void 0,dashboardState:void 0,onDashboardChange:void 0},w=(0,s.isWidgetWithQueryState)(e.widgetState)&&(0,l.Y)("div",{style:{flexGrow:0,marginRight:2,marginLeft:2,paddingLeft:14},children:(0,l.Y)(gt,{dashboardState:b,leafKey:y,pageKey:f,filterTypes:["widget"],onDashboardChanged:v,widgetState:e.widgetState,onWidgetChanged:e.onChange})});return(0,l.Y)(S,{widgetKey:e.widgetState.widgetKey,keys:h,actionProps:p,children:(0,l.FD)("div",{css:i.css`
          height: 100%;
          display: flex;
          flex-direction: column;
        `,children:[w,(0,l.Y)("div",{css:{flexGrow:1,minHeight:0},children:(0,l.Y)(t.Component,{...e,onElementsActioned:m})})]})})},ft=e=>{const{onSelectionChange:t}=e,[r,a]=(0,n.useState)(e.widgetState),l=e.onChange?e.widgetState:r,d=e.onChange??a,c=(0,s.useSwitchedWidgetState)(l),u=(0,o.useWidgetPlugin)(c.widgetKey),[g,h]=(0,n.useState)(void 0),p=(0,n.useCallback)(((e,r)=>{h(e?{highLevelSelection:e,lowLevelSelection:r}:void 0),t&&t(e,r)}),[h,t]);return(0,i.createElement)(yt,{...e,widgetState:c,widgetPlugin:u,selection:g?.highLevelSelection,onSelectionChange:p,onChange:d,key:c.widgetKey})};var bt=r(68364);const vt=e=>{const t=e.widgetState.widgetKey,r=(0,o.useWidgetPlugin)(t),a=(0,bt.b)(),s=(0,n.useMemo)((()=>({...a,widget:e.leafKey,page:e.pageKey})),[a,e.leafKey,e.pageKey]);return(0,l.Y)(bt.t,{value:s,children:(0,i.createElement)(yt,{...e,widgetPlugin:r,key:t})})},wt={whenInRows:{paddingRight:8}},St={whenInRows:{paddingLeft:8,paddingTop:2}},xt=e=>(0,l.Y)(g.DynamicResizable,{widthThreshold:400,firstChildStyle:wt,secondChildStyle:St,children:e.children}),Ct=()=>{const e=(0,E.DP)();return(0,l.FD)("div",{css:i.css`
        height: 100%;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
      `,children:[(0,l.FD)("svg",{viewBox:"64 64 896 896",width:"64",height:"64",fill:"currentColor",children:[(0,l.Y)("path",{d:"M134.4 269.5l-1.9 1.8c-14.3 14.1-14.2 32.7-14.2 39.7.4 149.2.4 300.9.4 447.7v99.6a44.7 44.7 0 0044.6 44.7l184.1 1c16.5-.7 31.7-8.1 41.7-21.2a52.4 52.4 0 009.4-45.7A120.8 120.8 0 00388 811c-.8-1.3-1.5-2.7-2.2-4.1-5.5-10-10.3-18.7-11.5-26.5-3.2-21.2 3.7-42.3 18.1-55 9.2-8.2 20.8-12.3 34.3-12.3a82.6 82.6 0 0122.7 3.5c18.2 5.1 26.9 19.4 30.5 27.5a59.4 59.4 0 01-.8 50c-1.3 2.9-3 5.9-4.7 9.1-5.3 9.7-11.2 20.7-14.7 34.2a52.7 52.7 0 0051.1 65.9h66c36.6 0 73.8.1 110.5.5h1.6c7.1 0 23.3-.8 36.2-12.7l-57.1-60v.5l-91.9-.3c-10.8 0-21.6 0-32.3-.3H541c.9-1.5 1.9-3.3 2.8-5.2a130.6 130.6 0 001.9-111c-14.9-33.3-42.8-57.9-76.6-67.5a156 156 0 00-42.4-6.2 128.8 128.8 0 00-26.5 2.7 120.9 120.9 0 00-55.5 27.6c-32.6 28.9-48.5 74.9-41.5 120 2.4 15.4 14 40.6 14 40.6H190.7v-72.6c0-140.7 0-286.1-.4-429.4h1.3l-57.2-60.2",fill:"currentColor"}),(0,l.Y)("path",{d:"M924.9 566a50.6 50.6 0 00-.5-6.8c-6.8-43.6-31.6-79.1-67.9-97.3s-76.4-16.7-113.4 2.7l-1.2.6c.1-21.4.1-42.8 0-63.7 0-29.9 0-60.8.3-91.1.1-7.2.3-26.2-14.2-40.7s-33.3-14.1-39.6-14.1c-31.9.4-64.6.4-96.1.4h-52.2c.8-1.4 1.6-3 2.4-4.6 19-39.5 19-83 .2-119.6s-51.7-59.3-92-66.2a47.1 47.1 0 00-7.4-.6h-28.9a48.7 48.7 0 00-7.6.6c-42.3 7.2-74.1 30.3-91.8 66.9-19.9 41-19.9 81.1.1 119l3.6 6.6c-49 .2-99.2.3-148.5-.3-5.8-.1-23-.3-36.8 12l57.3 60.2c50.1.5 100.5.2 149.4 0h7.7c7.2-.1 26.2-.1 41.1-16a44.6 44.6 0 0011.5-24.8c3.5-28.3-8.3-48.2-16.9-62.8-1.8-3-3.5-5.9-4.9-8.6-9.1-17.3-8.8-33.9 1-54 7.3-15.2 18.4-23.3 36.8-26.8h23.9c17.1 3.5 30.6 13.2 38.1 27.7 8.4 16.3 8 36.4-1.1 55.3a97.3 97.3 0 01-4.8 8.5c-5.4 9.2-12.7 21.7-15 39.7-.9 6.9-3.6 27.7 11.3 44.4 6.4 7.2 18.2 15.9 37.7 15.6 28.5-.2 57.5-.2 85.6-.2 25.5 0 51.7 0 77.9-.2-.2 24.7-.2 49.5-.2 73.6.1 31.8.1 64.7-.3 96.9-.3 18.3 5.3 32.4 16.6 42s25.6 12.5 43.1 9.4 29-10.5 39.1-16.5l8.4-4.9c16.4-8.5 33.3-9.3 47.6-2.1s25.2 22.8 28.7 42.3V594c-3.9 20.1-14.6 35.7-29.7 42.9s-31.2 5.7-47.6-3.5l-4.8-2.7c-15.1-8.6-35.7-20.3-62.3-18.4a44.3 44.3 0 00-20.8 6.9c-21.2 13.8-20.3 44.5-20 46.9 0 .2.1.4.1.6v8.3c-.3 51.4-.5 104.4 0 157l57 60 1.3-1.2c14.3-14.3 14-33.4 14-39.6-.6-51.6-.5-104-.3-155.1 37 20.8 78.8 22.9 114.5 5.7s62.5-53.5 69.9-98.1a45.6 45.6 0 00.6-7.5z",fill:e.primaryColor})]}),(0,l.Y)("h4",{className:"ant-typography",css:i.css`
          font-size: 14px;
          line-height: 22px;
          font-weight: 400;
          color: rgba(0, 0, 0, 0.85);
          margin: 0px;
        `,children:"Drag widget to dashboard."})]})},Ft=e=>!e||Object.values(e).every((e=>!e||e.every(s.isAllMeasuresInMapping)));var Mt=r(91381);class kt extends Error{mappingType;attributeName;constructor(e,t){super(`Can not serialize the "${t}" field with "${e}" type in mapping. Available types are: 'allMeasures', 'measure', 'gluedHierarchy', 'hierarchy', 'kpiProperty'.`),this.mappingType=e,this.attributeName=t}}const Nt=e=>{const t=(0,We.quote)(e.dimensionName,e.hierarchyName,e.levelName);return e.expandedDownTo?`${t} => ${(0,We.quote)(e.dimensionName,e.hierarchyName,e.expandedDownTo)}`:t};var Dt=r(2858);function Kt(e){const t={...e,filters:e.filters?.map(Dt.V)};return void 0===t.filters&&delete t.filters,(0,s.isWidgetWithQueryState)(t)&&(0,s.isWidgetWithQueryState)(e)&&e.query.mdx&&(t.query={...e.query,mdx:(0,We.stringify)(e.query.mdx)}),t}function Yt(e){return Kt(function(e){return(0,s.isDataVisualizationWidgetState)(e)?(0,x.produce)(e,(e=>{const{mapping:t}=e;return Object.entries(t).forEach((([t,r])=>{const i=r.map((e=>{if(void 0===e.type)return e;switch(e.type){case"compositeHierarchy":return e.hierarchies.map(Nt).join(" => ");case"hierarchy":return Nt(e);case"allMeasures":return"ALL_MEASURES";case"measure":return(0,We.quote)("Measures",e.measureName);case"kpiProperty":{const{kpiName:t,propertyName:r,underlyingMeasureName:i}=e;return(0,Mt.L)({kpiName:t,kpiPropertyName:r,underlyingMeasureName:i})}case"namedSet":return(0,We.quote)(e.name);default:throw new kt(e.type,t)}}));e.mapping[t]=i})),e})):e}(function(e){if(!(0,s.isWidgetStateWithStyle)(e))return e;const t=e.style?.tupleImpactingRowStyle;if(!t)return e;const r={...e.style,tupleImpactingRowStyle:t.map((({dimensionName:e,hierarchyName:t,namePath:r})=>(0,W.t)({dimensionName:e})?(0,We.quote)(e,...r):(0,We.quote)(e,t,...r)))};return{...e,style:r}}(e)))}function Tt(e){return{...(0,C.omit)(e,["Component","Icon","behaviorEditor","contentEditor","queryEditor","filtersEditor","styleEditor","useOnDataModelNodeClicked"]),initialState:Yt(e.initialState)}}function Wt(e){const{formatMessage:t}=(0,R.useIntl)();return e.name??t({id:`aui.plugins.widget.${e.widgetKey}.defaultName`})}var Bt=r(72738),Pt=r(25170),It=r(87613),qt=r(55140),Ot=r(94888),$t=r(40410),Et=r(52370),Rt=r(82478);function At(e,{pageKey:t,leafKey:r,filtersBySection:i}){return(0,x.produce)(e,(e=>{const n=i.dashboard;(0,C.isEqual)(n,e.filters)||(e.filters=n,(0,D.y)(e,s.driveFiltersFromState));const a=(0,K.W)(e,t),o=i.page;a&&!(0,C.isEqual)(o,a.filters)&&(a.filters=o,(0,Y.T)(a,s.driveFiltersFromState));const l=(0,N.B)(e,t,r),d=i.widget;return l&&!(0,C.isEqual)(d,l.filters)&&(l.filters=d,(0,s.driveFiltersFromState)(l)),e}))}const Vt=[],Lt=(0,Rt.n)((e=>{const{widgetState:t,onWidgetChange:r}=e,{cube:i,serverKey:a}=(0,s.useCube)(t),o=(0,Bt.M)(e),{dashboardState:d,leafKey:c,pageKey:g,onDashboardChange:h}=o?e:{},[p,m]=(0,n.useState)(),y=qe({dashboardState:d,pageKey:g,widgetState:t}),[f]=(0,Ze.J)("canUseUserFilters"),[b,v]=(0,et.v)("userFilters"),w=b??Vt,S=at({widgetState:t,dashboardState:d,pageKey:g}),F=Xe({widgetState:t,dashboardState:d,pageKey:g}),M=ct({widgetState:t,dashboardState:d,pageKey:g}),k=({serverKey:e,cubeName:t,dimension:r,hierarchy:i,position:n})=>{m({serverKey:e,cubeName:t,hierarchyCoordinates:{dimensionName:r.name,hierarchyName:i.name},position:n,levelIndex:i.slicing?0:1,type:"create-filter"})},T=(0,n.useCallback)((({serverKey:e,cubeName:t,dimension:r,position:i})=>{const n=r.hierarchies[r.defaultHierarchy];k({serverKey:e,cubeName:t,dimension:r,hierarchy:n,position:i})}),[]),W=(0,n.useCallback)(((t,r)=>{if(!1===e.isActive)return;const i=S.widget.length;switch(t.type){case"dimension":T({serverKey:t.serverKey,cubeName:t.cubeName,dimension:t.dimension,position:{sectionName:"widget",tileIndex:i}}),r.preventDefault();break;case"hierarchy":case"level":k({serverKey:t.serverKey,cubeName:t.cubeName,dimension:t.dimension,hierarchy:t.hierarchy,position:{sectionName:"widget",tileIndex:i}}),r.preventDefault()}}),[S.widget.length,T,e.isActive]);(0,u.z4)(W);const B=["widget"];o&&B.unshift("dashboard","page"),f&&B.unshift("user");const P=d&&h?e=>{const t=(0,x.produce)(d,(t=>{t.pinnedDefaultFilters=e}));h?.(t)}:void 0;return(0,l.Y)(Et.l,{areCubeFiltersVisible:!0,pinnedDefaultFilters:d?.pinnedDefaultFilters,onPinnedDefaultFiltersChanged:P,serverKey:a,cubeName:i.name,filters:S,queryContextBySection:M,onFiltersChange:e=>{const i=e.user;f&&!(0,C.isEqual)(i,w)&&v(i);const n=e.widget;if(d&&h){const t=At(d,{pageKey:g,leafKey:c,filtersBySection:e});return void h(t)}const a=(0,x.produce)(t,(e=>{!function(e,t){e.filters=t,(0,s.driveFiltersFromState)(e)}(e,n)}));r(a)},canDrop:({dragItem:e})=>e&&((0,Ot.a)(e)||(0,Pt.x)(e)||(0,It.G)(e)||(0,$t.Y)(e)||(0,qt.f)(e)),popoverConfiguration:p,onPopoverConfigurationChanged:m,mdxInViews:y,visibleSectionNames:B,filterFolders:F,onFilterFoldersChanged:e=>{if(d&&h){const t=(0,x.produce)(d,(t=>{const r=e.dashboard;(0,C.isEqual)(r,t.filterFolders)||(t.filterFolders=r,(0,D.y)(t,s.driveFiltersFromState));const i=(0,K.W)(t,g),n=e.page;if(i&&!(0,C.isEqual)(n,i.filterFolders)&&(i.filterFolders=n,(0,Y.T)(i,s.driveFiltersFromState)),c){const r=(0,N.B)(t,g,c);r&&!(0,C.isEqual)(e.widget,r.filterFolders)&&(r.filterFolders=e.widget,(0,s.driveFiltersFromState)(r))}}));return void h(t)}const i=(0,x.produce)(t,(r=>{const i=e.widget;(0,C.isEqual)(i,r.filterFolders)||(r.filterFolders=i,(0,s.driveFiltersFromState)(t))}));r(i)}})})),Qt=e=>{const{widgetState:t,queryType:r="select",...i}=e;return(0,s.isWidgetWithQueryState)(t)?(0,l.Y)(Lt,{widgetState:t,queryType:r,...i}):null};var zt=r(152),jt=r(23107);function Gt({isDeferred:e,pageKey:t}){const r=(0,jt.g)(),i=Boolean(t&&r&&t!==r);return e||i}function Ht({serverKey:e,queryId:t,query:r,pageKey:i,isDeferred:a}){const o=(0,ee.mF)(e),s=Gt({isDeferred:a,pageKey:i});return(0,n.useEffect)((()=>{if(!o||!t||!s)return;const e=o.getQuery(t);e&&"realTime"===e.updateMode&&o.setQuery(t,{...e,updateMode:"once"})}),[t,s,o]),(0,zt.J)({serverKey:e,queryId:t,query:s?void 0:r})}var Ut=r(21572),Jt=r(30094);function Xt(e,{areFiltersDrivenByMdx:t,cube:r,filters:i,atotiServerVersion:n}){if(!e.mdx||t)return e;const a=i.reduce(((e,t)=>{if(!O(t,r))return e;const i=n?{atotiServerVersion:n}:void 0,a=(0,Jt.l)(t,r,i);return a?(e.push({mdx:a,nonVisualTotals:t.nonVisualTotals}),e):e}),[]);return{...e,mdx:(0,We.setFilters)(e.mdx,{filters:a,cube:r})}}const _t=[];function Zt({dashboardState:e,widgetState:t,pageKey:r,userFilters:i,filtersFromFolders:n}){return{user:i??_t,dashboard:[...n?.dashboard??_t,...e?.filters??_t],page:[...n?.page??_t,...(0,K.W)(e,r)?.filters??_t],widget:[...n?.widget??_t,...t?.filters??_t]}}function er(e){if(e.mdx)return{...e,mdx:(0,We.stringify)(e.mdx,{indent:!0})}}function tr(e,{dashboardState:t,pageKey:r,queryRanges:i,userFilters:n,userQueryContext:a,dataModels:o,lastUsedCube:l,filtersFromFoldersBySection:d={},atotiServerVersion:c}){if(!e.query.mdx)return;const u=st({dashboardState:t,widgetState:e,pageKey:r,userQueryContext:a}),g=(0,A.D)({sectionName:"widget",queryContextBySection:u}),h={...e.query,context:g},p=Zt({dashboardState:t,widgetState:e,pageKey:r,userFilters:n,filtersFromFolders:d}),m=(0,C.flatMap)(p),{cube:y}=(0,s.getTargetCube)({cubeName:(0,We.getCubeName)(e.query.mdx),serverKey:e.serverKey,dataModels:o,lastUsedCube:l}),f=er(Xt(h,{filters:m,cube:y,areFiltersDrivenByMdx:e.areFiltersDrivenByMdx,atotiServerVersion:c}));return f?{...f,ranges:i}:void 0}function rr({serverKey:e,queryId:t,widgetState:r,dashboardState:i,pageKey:a,cube:o,queryRanges:l,isDeferred:d}){const c=(0,M.W)(),u=function(e,{dashboardState:t,pageKey:r,queryRanges:i,dataModels:a}){const o=rt(),l=dt(),d=(0,Ie.A)(),c=e.query.mdx?(0,We.getCubeName)(e.query.mdx):void 0,{serverKey:u}=(0,s.getTargetCube)({cubeName:c,serverKey:e.serverKey,dataModels:a,lastUsedCube:d}),g=(0,ee.mF)(u),h=Xe({dashboardState:t,pageKey:r,widgetState:e}),{filtersFromFoldersBySection:p,loading:m,error:y}=(0,Ut.q)(h);if(y)throw y;return(0,n.useMemo)((()=>{if(m)return;const n=g.serverVersion;return tr(e,{dashboardState:t,pageKey:r,userFilters:o,userQueryContext:l,queryRanges:i,dataModels:a,lastUsedCube:d,filtersFromFoldersBySection:p,atotiServerVersion:n})}),[t,o,r,l,e,i,a,d,p,m,g.serverVersion])}(r,{dashboardState:i,pageKey:a,queryRanges:l,dataModels:(0,n.useMemo)((()=>{if(e){if(!c[e])throw new k.d({serverKey:e,existingServerKeys:Object.keys(c)});return{[e]:c[e]}}{const e=(0,s.findServerKey)({cubeName:o.name,dataModels:c});return{[e]:c[e]}}}),[o,e,c])});return Ht({serverKey:e,queryId:t,query:u,pageKey:a,isDeferred:d})}function ir({cleanedUpProperty:e,getTrigger:t}){return r=>i=>(0,l.Y)(r,{...i,onWidgetChange:r=>{const n=t(r)!==t(i.widgetState)?(0,x.produce)(r,(t=>{delete t[e]})):r;i.onWidgetChange(n)}})}var nr=r(32699),ar=r(60301);class or extends Error{constructor(e){super(`Expected an MdxSelect or an MdxDrillthrough, but received an MDX of type "${e.elementType}".`)}}class sr extends Error{constructor(e,t){super(["The provided MDX is incompatible with the dashboard or page filters.","Expected, in this order:",JSON.stringify(e.map(Dt.V),null,2),"But got:",JSON.stringify(t.map(Dt.V),null,2)].join("\n"))}}var lr=r(80456);function dr({widgetState:e,mdx:t,dashboardState:r,pageKey:i,leafKey:n,dataModels:a,widgetPlugin:o,lastUsedCube:l,shouldRemoveFiltersFromQuery:d}){const c=void 0!==r;if(c&&(void 0===i||void 0===n))throw new Error("Must pass a page key and leaf key along with the dashboard state.");if("Select"!==t.elementType&&"Drillthrough"!==t.elementType)throw new or(t);const{serverKey:u,cube:g}=function({dataModels:e,lastUsedCube:t,mdx:r,widgetState:i}){const n=r?(0,We.getCubeName)(r):void 0;if(i.serverKey&&n)try{const t=i.serverKey;return{serverKey:t,dataModel:e[t],cube:(0,lr.W)(e[t],n)}}catch(r){if(r instanceof _e.N)return(0,s.getTargetCube)({serverKey:void 0,dataModels:e,cubeName:n,lastUsedCube:t});throw r}return(0,s.getTargetCube)({dataModels:e,serverKey:i.serverKey,cubeName:n,lastUsedCube:t})}({dataModels:a,widgetState:e,lastUsedCube:l,mdx:t}),h=(0,We.getFilters)(t,{cube:g}).map((({mdx:e,nonVisualTotals:t})=>(0,nr.H)(e,{cube:g,nonVisualTotals:t})));let p=0;if(c){const e=[...r.filters??[],...r.pages[i].filters??[]].filter((e=>"members"!==e.type||e.members.length>0));if(p=e.length,!e.every(((e,t)=>(0,ar.w)(e,h[t]))))throw new sr(e,h)}const m=(0,x.produce)(e,(e=>{(0,s.isWidgetWithQueryState)(e)&&t&&("Drillthrough"===t.elementType&&function(e,t){const r=e.query.mdx;if("Drillthrough"!==r?.elementType)return;const i=(0,We.getDrillthroughColumns)(t),n=(0,We.getDrillthroughColumns)(r);(0,C.isEqual)(i,n)||delete e.shouldUseDefaultColumns}(e,t),d??1?e.query.mdx=(0,We.setFilters)(t,{filters:[],cube:g}):(e.query.mdx=t,e.areFiltersDrivenByMdx=!0)),e.filters=h.slice(p),e.serverKey=u,(0,s.isDataVisualizationWidgetPlugin)(o)&&(0,s.isDataVisualizationWidgetState)(e)&&"Select"===t.elementType&&(e.mapping=(0,s.deriveMappingFromMdx)({widgetPlugin:o,mdx:t,cube:g}))})),y=c?(0,x.produce)(r,(e=>{e.pages[i].content[n]=m})):void 0;return{widgetStateDerivedFromMdx:m,dashboardStateDerivedFromMdx:y}}function cr({kpiName:e,propertyName:t}){return`${e} ${t.slice(3)}`}function ur(e,t){return(0,C.mapValues)(t,((t,r)=>e[r]??[]))}function gr(e,t,r){const i=ct({widgetState:e,dashboardState:t,pageKey:r}),{query:a}=e,o=(0,n.useMemo)((()=>(0,A.D)({sectionName:"widget",queryContextBySection:i})),[i]);return(0,n.useMemo)((()=>({...a,context:o})),[a,o])}var hr=r(46020);const pr=({serverKey:e,queryId:t,onWidgetReset:r,isLoading:a,timeBeforeContinueLoadingButtonAppears:o})=>{const s=(0,E.DP)(),{formatMessage:d}=(0,R.useIntl)(),c=(0,ee.mF)(e),[u,h]=(0,n.useState)(void 0);return(0,n.useEffect)((()=>{if(a&&"loading"!==u){h(void 0);const e=setTimeout((()=>h("loading")),o??2e4);return()=>clearTimeout(e)}a||"loading"!==u||h(void 0)}),[a,u,o]),u&&(0,l.Y)("div",{css:i.css`
          background: transparent;
          position: absolute;
          width: 100%;
          z-index: 3;
          display: flex;
          justify-content: center;
        `,children:(0,l.Y)("div",{css:i.css`
            background: ${s.backgroundColor};
            width: calc(100% - 4px);
            display: flex;
            flex-direction: column;
            align-items: center;
            padding-top: 8px;
            padding-bottom: 8px;
          `,children:"loading"===u?(0,l.FD)(l.FK,{children:[(0,l.Y)(g.Text,{style:{marginBottom:8},children:d({id:"aui.longLoading"})}),(0,l.FD)(y.Button.Group,{css:{gap:10},children:[(0,l.Y)(y.Button,{type:"primary",onClick:()=>h(void 0),children:d({id:"aui.continueLoading"})}),(0,l.Y)(y.Button,{type:"default",onClick:()=>{t&&c?.cancelQuery(t),h("canceled")},children:d({id:"aui.stopQuery"})})]})]}):(0,l.FD)(l.FK,{children:[(0,l.FD)(g.Text,{style:{marginBottom:8},children:[(0,l.Y)(hr.z,{style:{width:"12px",height:"12px",color:"red",marginRight:"6px"}}),d({id:"aui.queryCanceled"})]}),(0,l.FD)(y.Button.Group,{css:{gap:10},children:[(0,l.Y)(y.Button,{type:"primary",onClick:()=>{if(t){const e=c?.getQuery(t);if(e){const{isCanceled:r,...i}=e;c?.setQuery(t,i)}}h(void 0)},children:d({id:"aui.runQueryagain"})}),(0,l.Y)(y.Button,{type:"default",onClick:()=>{r?.(),h(void 0)},children:d({id:"aui.reset"})})]})]})})})},mr=(0,n.createContext)(pr),yr=mr.Provider,fr=(0,n.forwardRef)(((e,t)=>{const r=(0,n.useContext)(mr)??pr;return(0,l.FD)("div",{ref:t,className:e.className,css:{height:"100%",position:"relative",padding:"0px 2px 3px"},children:[(0,l.Y)(r,{...e}),e.children]})}));var br=r(87785);function vr(e){const{error:t,onLoaded:r}=e,i=(0,ee.d5)();(0,n.useEffect)((()=>{r?.()}),[r]);const{formatMessage:a}=(0,R.useIntl)(),{widgetState:d}=e,{widgetKey:c}=d,[u]=(0,o.useWidgetPlugins)(c?[c]:[]);let h,p,m=t.message??t.stack,y="error";if(!u)return(0,l.Y)(g.ErrorPlaceholder,{Icon:h,title:p,message:m,type:y});if(!(0,s.isWidgetWithQueryState)(d))return(0,l.Y)(g.ErrorPlaceholder,{Icon:h,title:p,message:m,type:y});const{serverKey:f}=d;return(f?[i[f]]:Object.values(i)).some((e=>e.isDataModelLoading))&&t instanceof k.d?(h=u.Icon,y="info",m=a({id:"aui.dataVisualization.loadingWidget"})):t instanceof _e.N&&(h=br.v,m=a({id:"aui.error.cubeNotFoundMessage"},{cubeName:t.cubeName}),p=a({id:"aui.error.cubeNotFound"})),(0,l.Y)(g.ErrorPlaceholder,{Icon:h,title:p,message:m,type:y})}var wr=r(96531);function Sr(e){if(!(e.error instanceof wr.QueryError))throw e.error;return(0,l.Y)(vr,{...e})}function xr(e){const t=t=>(0,l.Y)(F.ErrorBoundary,{fallbackRender:e=>(0,l.Y)(Sr,{...e,...t}),resetKeys:[t.queryResult],children:(0,l.Y)(e,{...t})});return t.displayName=`withWidgetQueryErrorBoundary(${e.displayName})`,t}const Cr="\nposition: absolute;\nborder-radius: 2px;\nheight: 3px;\nz-index: 2;\n",Fr=()=>{const e=(0,E.DP)();return(0,l.Y)("div",{css:i.css`
        ${Cr}
        width: calc(100% - 4px);
        background-color: ${e.isDark?e.grayScale[5]:"#f5f9ff"};
      `,children:(0,l.Y)("div",{css:i.css`
          ${Cr}
          background-color: ${(0,Be.j)(e.primaryColor,.5)};
          animation: loadingBar 0.9s linear infinite;
          @keyframes loadingBar {
            0% {
              left: 0%;
              right: 100%;
              width: 0%;
            }
            50% {
              left: 0%;
              right: 0%;
              width: 100%;
            }

            100% {
              left: 100%;
              right: 0%;
              width: 0%;
            }
          }
        `})})},Mr=700;function kr(e){const t=(0,n.forwardRef)(((t,r)=>{const[i,a]=(0,n.useState)(!1),{queryId:o,widgetState:d}=t,c=(0,s.isWidgetWithQueryState)(d)?d.serverKey:void 0,u=(0,zt.J)({queryId:o,serverKey:c});return(0,n.useEffect)((()=>{if(u.isLoading){const e=setTimeout((()=>{a(!0)}),Mr);return()=>{clearTimeout(e)}}a(!1)}),[u.isLoading]),(0,l.FD)(l.FK,{children:[i&&(0,l.Y)(Fr,{}),(0,l.Y)(e,{ref:r,...t})]})}));return t.displayName=`withWidgetLoadingBar(${e.displayName})`,t}function Nr(e){const t=t=>{const r=(0,n.useRef)((0,l.Y)("div",{}));return t.queryResult.isLoading||(r.current=(0,l.Y)(e,{...t})),r.current},r=e.displayName||e.name||"Unknown";return t.displayName=`withoutIrrelevantRenders(${r})`,t}function Dr(e){const t=t=>{const r=(0,o.useWidgetPlugin)(t.widgetState.widgetKey);return(0,l.Y)(fr,{isLoading:t.queryResult.isLoading,style:{...t.style,height:"100%"},serverKey:t.widgetState.serverKey,queryId:t.queryId,onWidgetReset:()=>{r&&t.onChange(r.initialState)},children:(0,l.Y)(e,{...t})})},r=e.displayName||e.name||"Unknown";return t.displayName=`withLoadingOverlay(${r})`,t}const Kr=(0,We.getAxisId)("ROWS"),Yr=(0,We.getAxisId)("COLUMNS"),Tr=({widgetState:e,onStateChange:t})=>{const{formatMessage:r}=(0,R.useIntl)(),{backgroundColor:i}=(0,E.DP)(),n=e.query.mdx;if(void 0===n)return;const{[Yr]:a,[Kr]:o}=(0,We.getNonEmpty)(n),s=r=>{const i=(0,x.produce)(e,(e=>{e.query.mdx=(0,We.setNonEmpty)(n,r)}));t(i)};return(0,l.Y)("div",{style:{position:"absolute",zIndex:1,inset:0,display:"flex",justifyContent:"center",alignItems:"center"},children:(0,l.FD)("div",{style:{backgroundColor:i,textAlign:"center",display:"flex",flexDirection:"column",padding:12,gap:12},children:[r({id:"aui.dataVisualization.noData"}),(0,l.FD)("div",{style:{display:"flex",flexWrap:"wrap",justifyContent:"space-evenly",gap:4},children:[void 0!==o&&(0,l.Y)(y.Checkbox,{checked:!o,onChange:e=>s({[Kr]:!e.target.checked}),children:r({id:"aui.showEmptyRows"})}),void 0!==a&&(0,l.Y)(y.Checkbox,{checked:!a,onChange:e=>{s({[Yr]:!e.target.checked})},children:r({id:"aui.showEmptyColumns"})})]})]})})},Wr=({children:e,widgetKey:t,keys:r,actionProps:i})=>{const[a,o]=(0,n.useState)(!1);return(0,l.Y)(v,{keys:r,actionProps:i,onClick:e=>{e.domEvent.isDefaultPrevented()||o(!1)},children:(0,l.Y)(g.Dropdown,{open:a,onOpenChange:o,dropdownRender:()=>(0,l.Y)(w,{}),trigger:["click"],placement:"bottomRight",children:e},t)})};var Br=r(66318),Pr=r(16710);function Ir({selection:e,cube:t,isExclusionFilter:r}){return function(e,t){const r=(0,C.flatten)(e),i=(0,C.uniqWith)(r,((e,t)=>(0,Br.q)(e,t)&&(0,C.isEqual)(e.namePath,t.namePath))),n=(0,C.groupBy)(i,(e=>(0,We.quote)(e.dimensionName,e.hierarchyName))),a=[];return Object.keys(n).forEach((e=>{if("[Measures].[Measures]"!==e){const r=n[e];a.push({dimensionName:r[0].dimensionName,hierarchyName:r[0].hierarchyName,type:"members",members:(0,C.map)(r,"namePath"),isExclusionFilter:t})}})),a}((0,Pr.q)(e,t),r)}function qr({existingFilters:e,addedFilters:t}){t.forEach((t=>{const r=e.findIndex((e=>"members"===e.type&&(0,Br.q)(t,e)));if(-1!==r){const{isPinned:i,pinnedFilterWidth:n}=e[r];e[r]={...t,isPinned:i,pinnedFilterWidth:n}}else e.push(t)}))}function Or(e,t){e.filters||(e.filters=[]),qr({existingFilters:e.filters,addedFilters:t}),(0,s.driveFiltersFromState)(e)}function $r({addedFilters:e,widgetState:t}){return(0,x.produce)(t,(t=>{Or(t,e)}))}const Er="atoti-ui/widget";function Rr(e){return{[Er]:JSON.stringify(Yt(e))}}function Ar(e){return"text"===e.kind&&e.types.has(Er)}async function Vr(e){return(0,s.deserializeWidgetState)(JSON.parse(await e.getText(Er)))}const Lr="atoti-ui/saved-widget";function Qr(e){return{[Lr]:JSON.stringify(e)}}function zr(e){return"text"===e.kind&&e.types.has(Lr)}async function jr(e){return JSON.parse(await e.getText(Lr))}},92673:(e,t,r)=>{r.d(t,{A:()=>i});const i={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M724 218.3V141c0-6.7-7.7-10.4-12.9-6.3L260.3 486.8a31.86 31.86 0 000 50.3l450.8 352.1c5.3 4.1 12.9.4 12.9-6.3v-77.3c0-4.9-2.3-9.6-6.1-12.6l-360-281 360-281.1c3.8-3 6.1-7.7 6.1-12.6z"}}]},name:"left",theme:"outlined"}},20952:(e,t,r)=>{r.d(t,{A:()=>i});const i={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M765.7 486.8L314.9 134.7A7.97 7.97 0 00302 141v77.3c0 4.9 2.3 9.6 6.1 12.6l360 281.1-360 281.1c-3.9 3-6.1 7.7-6.1 12.6V883c0 6.7 7.7 10.4 12.9 6.3l450.8-352.1a31.96 31.96 0 000-50.4z"}}]},name:"right",theme:"outlined"}},17628:e=>{e.exports=function e(t,r){if(t===r)return!0;if(t&&r&&"object"==typeof t&&"object"==typeof r){if(t.constructor!==r.constructor)return!1;var i,n,a;if(Array.isArray(t)){if((i=t.length)!=r.length)return!1;for(n=i;0!=n--;)if(!e(t[n],r[n]))return!1;return!0}if(t.constructor===RegExp)return t.source===r.source&&t.flags===r.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===r.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===r.toString();if((i=(a=Object.keys(t)).length)!==Object.keys(r).length)return!1;for(n=i;0!=n--;)if(!Object.prototype.hasOwnProperty.call(r,a[n]))return!1;for(n=i;0!=n--;){var o=a[n];if(!("_owner"===o&&t.$$typeof||e(t[o],r[o])))return!1}return!0}return t!=t&&r!=r}},87991:(e,t,r)=>{r.d(t,{A:()=>s});var i=r(93345),n=(r(17628),function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];return e.addEventListener.apply(e,t)}),a=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];return e.removeEventListener.apply(e,t)},o=["mousedown","touchstart"];const s=function(e,t,r){void 0===r&&(r=o);var s=(0,i.useRef)(t);(0,i.useEffect)((function(){s.current=t}),[t]),(0,i.useEffect)((function(){for(var t=function(t){var r=e.current;r&&!r.contains(t.target)&&s.current(t)},i=0,o=r;i<o.length;i++){var l=o[i];n(document,l,t)}return function(){for(var e=0,i=r;e<i.length;e++){var n=i[e];a(document,n,t)}}}),[r,e])}}}]);