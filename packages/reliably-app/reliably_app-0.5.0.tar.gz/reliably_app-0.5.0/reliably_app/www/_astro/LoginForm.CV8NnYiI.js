import{v as Z,d as j,w as U}from"./runtime-dom.esm-bundler.DChKj6X8.js";import{l as J,b as re}from"./user.Bg1Nd46A.js";import{E as ie}from"./EyeIcon.CCc3ET-2.js";import{E as se}from"./EyeOffIcon.Bi6ACRtI.js";import{C as le}from"./CheckIcon.Cp1OA8SI.js";import{H as ne}from"./HelpCircle.XFsukWe6.js";/* empty css                       */import{_ as N}from"./_plugin-vue_export-helper.DlAUqK2U.js";import{d as X,t as $,r as c,g,o as ee,p as ue,h as t,c as s,a as o,n as h,w as q,F as B,k as ce,j as O,e as p,b as E,i as m,l as Q,f as de}from"./runtime-core.esm-bundler.Y6RLDZTT.js";import{G as pe}from"./GithubLogo.AFEE3hFH.js";import{G as ge}from"./GoogleG.QASPcj3J.js";import"./index.BSdFiPHn.js";import"./loader.BQDlK3Tc.js";import"./notifications.NSMm1_5U.js";const ve=X({__name:"EmailLogin",props:{register:{type:Boolean},join:{type:Boolean}},setup(R,{expose:a}){a();const L=R,{register:e,join:f}=$(L),k=c(""),i=c(null),d=c(""),P=c(!1),W=g(()=>P.value?"Hide password":"Reveal password"),V=c(""),A=g(()=>d.value.length>7),G=g(()=>new RegExp(".*[a-z].*").test(d.value)),x=g(()=>new RegExp(".*[A-Z].*").test(d.value)),I=g(()=>new RegExp(".*[0-9].*").test(d.value)),v=g(()=>new RegExp(".*[-+_!@#$%^&*.,?]").test(d.value)),n=c(!1),y=c([]),b=c(!1),S=c(!1),_=c(!1),l=c("");function r(){n.value=!1,y.value=[],b.value=!1,S.value=!1}function z(){i.value.addEventListener("invalid",u=>{y.value.push(u.target.validationMessage)})}function K(){let u=window.location,M=new URLSearchParams(u.search);M.has("invite")&&(V.value=M.get("invite"))}function ae(){e.value?D():T()}async function T(){if(y.value=[],i.value.checkValidity()?n.value=!1:n.value=!0,!n.value&&d.value.length>0){let u=await J({email:k.value,password:d.value,register:!1},f.value,V.value);if(u.status===200){_.value=!1,l.value="";let M=window.location,C=[],H=u.api_response;Object.keys(H).forEach(w=>{w==="org_id"?C.push(`orgid=${H[w]}`):C.push(`${w}=${H[w]}`)});const F=C.join("&");M.assign(`/authorized/?${F}`)}else _.value=!0,l.value=u.message}}async function D(){if(y.value=[],i.value.checkValidity()?n.value=!1:n.value=!0,!A.value||!G.value||!x.value||!I.value||!v.value?b.value=!0:b.value=!1,!n.value&&!b.value&&!S.value){let u=await J({email:k.value,password:d.value,register:!0},f.value,V.value);if(u.status===200){_.value=!1,l.value="";let M=window.location,C=[],H=u.api_response;Object.keys(H).forEach(w=>{w==="org_id"?C.push(`orgid=${H[w]}`):C.push(`${w}=${H[w]}`)});const F=C.join("&");M.assign(`/authorized/?${F}`)}else _.value=!0,l.value=u.message}}function oe(){P.value=!P.value}ee(()=>{z(),f!==void 0&&f.value===!0&&K()}),ue(e,()=>{r()});const Y={props:L,register:e,join:f,loginEmail:k,emailInput:i,loginPassword:d,isPasswordVisible:P,revealPasswordMessage:W,inviteHash:V,pwHas8Characters:A,pwHas1LowerCase:G,pwHas1UpperCase:x,pwHas1Number:I,pwHas1Special:v,emailHasErrors:n,emailErrors:y,passwordHasErrors:b,tosHaveErrors:S,hasApiErrors:_,apiErrorMessage:l,resetErrors:r,handleEmailErrors:z,setInviteHash:K,captureEnter:ae,submitLogin:T,submitRegister:D,togglePasswordVisibility:oe,EyeIcon:ie,EyeOffIcon:se,CheckIcon:le,HelpCircle:ne};return Object.defineProperty(Y,"__isScriptSetup",{enumerable:!1,value:!0}),Y}}),he={class:"emailLogin"},me={class:"emailLoginForm form"},fe={key:0,class:"inputWrapper__help list-reset"},we={key:2,class:"inputWrapper__help"},ye={key:3,class:"inputWrapper__help passwordValidation"},be={class:"list-reset"},_e={class:"help hasTooltip hasTooltip--bottom-center",label:"- + _ ! @ # $ % ^ & * . , ?","aria-label":"- + _ ! @ # $ % ^ & * . , ?"},Ee=["label","aria-label"],Le={key:0,class:"inputWrapper"},ke={key:1,class:"inputWrapper"},Pe={key:2,class:"inputWrapper emailLoginErrors"};function Ve(R,a,L,e,f,k){return t(),s("div",he,[o("form",me,[o("div",{class:h(["inputWrapper",{"inputWrapper--error":e.emailHasErrors}])},[a[5]||(a[5]=o("label",{for:"loginEmail"},"Email",-1)),q(o("input",{type:"email",id:"loginEmail",name:"loginEmail",placeholder:"you@example.com","onUpdate:modelValue":a[0]||(a[0]=i=>e.loginEmail=i),ref:"emailInput",required:"",onKeyup:j(e.captureEnter,["enter"])},null,544),[[Z,e.loginEmail]]),e.emailHasErrors?(t(),s("ul",fe,[(t(!0),s(B,null,ce(e.emailErrors,(i,d)=>(t(),s("li",{key:d},O(i),1))),128))])):p("",!0)],2),o("div",{class:h(["inputWrapper",{"inputWrapper--error":e.passwordHasErrors}])},[a[12]||(a[12]=o("label",{for:"loginPassword"},"Password",-1)),e.register?(t(),s(B,{key:0},[e.isPasswordVisible?q((t(),s("input",{key:0,type:"text",id:"loginPassword",name:"loginPassword",placeholder:"••••••••","onUpdate:modelValue":a[1]||(a[1]=i=>e.loginPassword=i),autocomplete:"off",required:"",onKeyup:j(e.captureEnter,["enter"])},null,544)),[[Z,e.loginPassword]]):q((t(),s("input",{key:1,type:"password",id:"loginPassword",name:"loginPassword",placeholder:"••••••••","onUpdate:modelValue":a[2]||(a[2]=i=>e.loginPassword=i),autocomplete:"new-password",required:"",onKeyup:j(e.captureEnter,["enter"])},null,544)),[[Z,e.loginPassword]])],64)):(t(),s(B,{key:1},[e.isPasswordVisible?q((t(),s("input",{key:0,type:"text",id:"loginPassword",name:"loginPassword",placeholder:"••••••••","onUpdate:modelValue":a[3]||(a[3]=i=>e.loginPassword=i),autocomplete:"off",required:"",onKeyup:j(e.captureEnter,["enter"])},null,544)),[[Z,e.loginPassword]]):q((t(),s("input",{key:1,type:"password",id:"loginPassword",name:"loginPassword",placeholder:"••••••••","onUpdate:modelValue":a[4]||(a[4]=i=>e.loginPassword=i),required:"",onKeyup:j(e.captureEnter,["enter"])},null,544)),[[Z,e.loginPassword]])],64)),e.register&&e.passwordHasErrors?(t(),s("p",we," Your password does not fulfill the requirements below. ")):p("",!0),e.register?(t(),s("div",ye,[a[11]||(a[11]=E(" Your password must: ")),o("ul",be,[o("li",{class:h({isValid:e.pwHas8Characters})},[o("span",null,[m(e.CheckIcon)]),a[6]||(a[6]=E(" be at least 8-characters long "))],2),o("li",{class:h({isValid:e.pwHas1LowerCase})},[o("span",null,[m(e.CheckIcon)]),a[7]||(a[7]=E(" contain at least 1 lower case letter [a-z] "))],2),o("li",{class:h({isValid:e.pwHas1UpperCase})},[o("span",null,[m(e.CheckIcon)]),a[8]||(a[8]=E(" contain at least 1 upper case letter [A-Z] "))],2),o("li",{class:h({isValid:e.pwHas1Number})},[o("span",null,[m(e.CheckIcon)]),a[9]||(a[9]=E(" contain at least 1 number "))],2),o("li",{class:h({isValid:e.pwHas1Special})},[o("span",null,[m(e.CheckIcon)]),a[10]||(a[10]=E(" contain at least 1 special character ")),o("span",_e,[m(e.HelpCircle)])],2)])])):p("",!0),o("button",{type:"button",onClick:U(e.togglePasswordVisibility,["prevent"]),class:"revealPassword hasTooltip hasTooltip--bottom-center",label:e.revealPasswordMessage,"aria-label":e.revealPasswordMessage},[e.isPasswordVisible?(t(),Q(e.EyeOffIcon,{key:0})):(t(),Q(e.EyeIcon,{key:1}))],8,Ee)],2),e.register?(t(),s("div",Le,[o("button",{type:"button",onClick:U(e.submitRegister,["prevent"]),class:"button button--primary"}," Register ")])):(t(),s("div",ke,[o("button",{type:"button",onClick:U(e.submitLogin,["prevent"]),class:"button button--primary"}," Login ")])),e.hasApiErrors?(t(),s("div",Pe,O(e.apiErrorMessage),1)):p("",!0)])])}const Ce=N(ve,[["render",Ve],["__scopeId","data-v-f8219377"]]),He={},Re={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 278 68"};function Me(R,a){return t(),s("svg",Re,a[0]||(a[0]=[de('<path d="M43.58 53.66q.14.81-.81.81H31.43a1.62 1.62 0 0 1-1.43-.88L1.17 4.35A1.7 1.7 0 0 1 1 3.84c-.09-.49.19-.73.82-.73h11.27a1.53 1.53 0 0 1 1.47.89l28.87 49.22a1.49 1.49 0 0 1 .15.44Z" fill="hsl(329.13, 96.65%, 64.9%)"></path><path d="M105.54 35.44a17.13 17.13 0 0 1-.07 1.81c0 .67-.35 1-1.06 1H83.13c-.19 0-.28.1-.28.29a2.85 2.85 0 0 0 .57 1.51 5.3 5.3 0 0 0 2.52 2.06A9.67 9.67 0 0 0 90 43a10.45 10.45 0 0 0 3.55-.58 7.49 7.49 0 0 0 2.76-1.66 1.16 1.16 0 0 1 .71-.29.89.89 0 0 1 .78.44l5.39 7a1.23 1.23 0 0 1 .28.79.87.87 0 0 1-.35.72A15.18 15.18 0 0 1 97 53a25.79 25.79 0 0 1-8 1.21 21.43 21.43 0 0 1-11.27-2.82 16.24 16.24 0 0 1-6.81-8 20.81 20.81 0 0 1-1.56-8.08 23.71 23.71 0 0 1 1.27-8.08 17 17 0 0 1 6.37-8.6 17.48 17.48 0 0 1 10.35-3.11 16.86 16.86 0 0 1 8.4 2.17 18.34 18.34 0 0 1 6.38 5.95 20.74 20.74 0 0 1 3.23 8.56 24.61 24.61 0 0 1 .18 3.24ZM83.21 30l-.29.79a.27.27 0 0 0 .07.33.5.5 0 0 0 .29.11h8.08c.19 0 .28-.1.28-.29a3.53 3.53 0 0 0-.21-.94A3.63 3.63 0 0 0 90 27.9a4.77 4.77 0 0 0-2.73-.76A4.07 4.07 0 0 0 83.21 30Z" fill="currentColor"></path><path d="M109.37 53.34a1.06 1.06 0 0 1-.28-.79V4.19a1.06 1.06 0 0 1 .28-.79 1 1 0 0 1 .78-.29h11.2a1 1 0 0 1 .78.29 1.07 1.07 0 0 1 .29.79v48.36a1.07 1.07 0 0 1-.29.79 1 1 0 0 1-.78.29h-11.2a1 1 0 0 1-.78-.29Z" fill="currentColor"></path><path d="M127.38 53.34a1.06 1.06 0 0 1-.28-.79V17.18a1.08 1.08 0 0 1 .28-.79 1.06 1.06 0 0 1 .78-.29h11.2a1.06 1.06 0 0 1 .78.29 1.08 1.08 0 0 1 .29.79v35.37a1.07 1.07 0 0 1-.29.79 1 1 0 0 1-.78.29h-11.2a1 1 0 0 1-.78-.29Z" fill="currentColor"></path><path d="M129.05 11.66a6.63 6.63 0 0 1-1.88-4.87 6.61 6.61 0 0 1 1.88-4.91 7 7 0 0 1 9.57 0 6.65 6.65 0 0 1 1.88 4.91 6.69 6.69 0 0 1-1.88 4.83 6.9 6.9 0 0 1-9.57 0Z" fill="currentColor"></path><path d="M170 17.18a15.78 15.78 0 0 1 6.38 4.55 9.76 9.76 0 0 1 2.34 6.27v24.55a1.07 1.07 0 0 1-.29.79 1 1 0 0 1-.78.29h-11.2a1 1 0 0 1-.78-.29 1.06 1.06 0 0 1-.28-.79V50c0-.19 0-.3-.11-.32s-.15 0-.25.18a7.43 7.43 0 0 1-3.33 3.28 12.74 12.74 0 0 1-5.6 1.05q-5.82 0-9.15-2.71c-2.22-1.8-3.33-4.44-3.33-7.9a10.09 10.09 0 0 1 3.79-8.45q3.79-3 11-2.95H165a.32.32 0 0 0 .36-.37v-1.27a3.09 3.09 0 0 0-1.1-2.46 4.43 4.43 0 0 0-2.94-.94 5.57 5.57 0 0 0-2.27.44 2.84 2.84 0 0 0-1.42 1.15 2.25 2.25 0 0 1-.53.69.87.87 0 0 1-.68.1L145 28.08c-.67-.09-1-.38-1-.86a10.34 10.34 0 0 1 2.56-5.92 15.49 15.49 0 0 1 6.06-4.23 22.26 22.26 0 0 1 8.47-1.55 23.27 23.27 0 0 1 8.91 1.66Zm-6.07 26.42a4.12 4.12 0 0 0 1.46-3.32v-.94A.32.32 0 0 0 165 39h-3.54q-4.47 0-4.47 3a2.76 2.76 0 0 0 .82 2.09 3.25 3.25 0 0 0 2.37.8 5.56 5.56 0 0 0 3.75-1.29Z" fill="currentColor"></path><path d="M220.55 34.72a28.56 28.56 0 0 1-1.06 8.09 16.38 16.38 0 0 1-5.35 8.33 13.22 13.22 0 0 1-8.55 3.07c-3.73 0-6.48-1.32-8.22-4-.1-.14-.19-.19-.29-.14a.28.28 0 0 0-.14.28v2.17a1.06 1.06 0 0 1-.28.79 1 1 0 0 1-.78.29h-11.21a1 1 0 0 1-.78-.29 1.06 1.06 0 0 1-.28-.79V4.19a1.06 1.06 0 0 1 .28-.79 1 1 0 0 1 .78-.29h11.21a1 1 0 0 1 .78.29 1.06 1.06 0 0 1 .28.79V18.7c0 .14.05.23.14.25a.28.28 0 0 0 .29-.11q2.48-3.32 7.65-3.32a13.83 13.83 0 0 1 8.66 2.78 16.22 16.22 0 0 1 5.32 7.18 25.57 25.57 0 0 1 1.55 9.24Zm-14 .22a11.71 11.71 0 0 0-1.06-5.42 4 4 0 0 0-3.76-2.38 4 4 0 0 0-3.68 2.24 11.65 11.65 0 0 0-1.14 5.56 11.18 11.18 0 0 0 1.09 5.19 4.13 4.13 0 0 0 7.52.08 11.58 11.58 0 0 0 1.06-5.27Z" fill="currentColor"></path><path d="M224.74 53.34a1.07 1.07 0 0 1-.29-.79V4.19a1.07 1.07 0 0 1 .29-.79 1 1 0 0 1 .78-.29h11.2a1 1 0 0 1 .78.29 1.06 1.06 0 0 1 .28.79v48.36a1.06 1.06 0 0 1-.28.79 1 1 0 0 1-.78.29h-11.2a1 1 0 0 1-.78-.29Z" fill="currentColor"></path><path d="M242.89 67.71a1.79 1.79 0 0 1-.14-.8V58q0-1.08.78-1.08a26 26 0 0 0 6.63-.58 2.86 2.86 0 0 0 2.23-2.45l-.07-.43-11.2-36.09a1 1 0 0 1-.07-.44c0-.53.33-.79 1-.79H254a1.12 1.12 0 0 1 1.21.94L259 36.31c0 .19.11.29.21.29s.16-.1.21-.29L263.24 17a1.11 1.11 0 0 1 1.21-.94h11.62c.81 0 1.09.41.86 1.23l-11.56 36.49a32.63 32.63 0 0 1-3.9 8.44 12.24 12.24 0 0 1-6.14 4.33Q251.25 68 243.74 68h-.5c-.14 0-.24-.1-.35-.29Z" fill="currentColor"></path><path d="m69.73 53.3-9.17-19.39a.34.34 0 0 1 .21-.51 13.68 13.68 0 0 0 6.47-5.33 15.31 15.31 0 0 0 2.34-8.48 17.4 17.4 0 0 0-2-8.56 14.56 14.56 0 0 0-5.78-5.76 17.57 17.57 0 0 0-8.63-2.06H31.23a1.07 1.07 0 0 0-.8.3 1.08 1.08 0 0 0-.28.8v20.43l10.24 17.48h3.33v-7a.32.32 0 0 1 .37-.36h3a.45.45 0 0 1 .43.29l8 18.66a1.18 1.18 0 0 0 1.23.8h12.11a1.12 1.12 0 0 0 .72-.22.67.67 0 0 0 .29-.58 3.45 3.45 0 0 0-.14-.51Zm-15.1-30.22a5.4 5.4 0 0 1-3.75 1.28h-6.79a.32.32 0 0 1-.37-.36v-8.6a.32.32 0 0 1 .37-.36h6.79a5.45 5.45 0 0 1 3.75 1.28 4.38 4.38 0 0 1 1.45 3.42 4.28 4.28 0 0 1-1.45 3.34Z" fill="currentColor"></path><path d="M35.72 44.74a.91.91 0 0 0-.81.48l-4.25 7.92a1.68 1.68 0 0 0-.15.49c-.09.59.18.89.82.89H42.8a1.62 1.62 0 0 0 1.47-1l4-7.44a.93.93 0 0 0-.8-1.37Z" fill="hsl(329, 97%, 55%)" opacity=".8"></path>',11)]))}const xe=N(He,[["render",Me]]),Ie=X({__name:"LoginForm",props:{join:{type:Boolean},mode:{},providers:{}},setup(R,{expose:a}){a();const L=R,{join:e,mode:f,providers:k}=$(L),i=c("login"),d=g(()=>i.value==="login"),P=g(()=>i.value==="register");function W(l){if(l==="login"){var r=window.location.protocol+"//"+window.location.host+window.location.pathname+`${v.value!==""?"?"+v.value:""}`;window.history.pushState({path:r},"",r),i.value="login"}else if(l==="register"){var r=window.location.protocol+"//"+window.location.host+window.location.pathname+`?register=true${v.value!==""?"&"+v.value:""}`;window.history.pushState({path:r},"",r),i.value="register"}}function V(){let l=new URLSearchParams(location.search);l.has("register")&&l.get("register")==="true"&&W("register")}const A=g(()=>`/login/with/github${n.value}`),G=g(()=>`/login/with/google${n.value}`),x=c(!1),I=()=>{let l=window.location,r=new URLSearchParams(l.search);r.has("s")&&r.get("s")==="failed"&&(x.value=!0)},v=c(""),n=c("");function y(){let l=window.location,r=new URLSearchParams(l.search);r.has("redirect_to")&&r.get("redirect_to")==="subscribe"&&r.has("plan")?(v.value=`redirect_to=subscribe&plan=${r.get("plan")}`,n.value=`?redirect_to=subscribe&plan=${r.get("plan")}`):r.has("redirect_to")&&r.get("redirect_to")==="templates"&&r.has("activity")&&(v.value=`redirect_to=templates&activity=${r.get("activity")}`,n.value=`?redirect_to=templates&activity=${r.get("activity")}`)}async function b(){if(e!==void 0&&e.value===!0){let l=window.location,r=new URLSearchParams(l.search);r.has("invite")?(n.value=`?invite=${r.get("invite")}`,await re()):l.replace("/login/")}}const S=g(()=>P.value?"Register":e!==void 0&&e.value===!0?"Join":"Log in");ee(async()=>{I(),y(),e!==void 0&&e.value===!0&&await b(),V()});const _={props:L,join:e,mode:f,providers:k,loginOption:i,isLoginActive:d,isRegisterActive:P,setLoginMode:W,getLoginMode:V,loginWithGitHubUrl:A,loginWithGoogleUrl:G,hasLoginFailed:x,getLoginStatus:I,params:v,apiParams:n,getRedirectParameters:y,getInviteParameters:b,actionVerb:S,EmailLogin:Ce,GithubLogo:pe,GoogleG:ge,ReliablyLogo:xe};return Object.defineProperty(_,"__isScriptSetup",{enumerable:!1,value:!0}),_}}),Se={key:0,class:"loginMessage"},Ze={class:"loginOptions list-reset"},je={key:0},qe={class:"login__links"},Ue=["href"],We=["href"],Ae={key:1,class:"loginSeparator"},Ge={key:2},Be={key:3,class:"login__error"};function Oe(R,a,L,e,f,k){return t(),s(B,null,[a[4]||(a[4]=o("div",null,null,-1)),e.join?(t(),s("section",Se," You've been invited to join an organization on Reliably ")):p("",!0),o("section",{class:h(["login",{"login--error":e.hasLoginFailed}])},[m(e.ReliablyLogo,{class:"logo"}),o("ul",Ze,[o("li",{class:h({active:e.isLoginActive})},[o("button",{onClick:a[0]||(a[0]=U(i=>e.setLoginMode("login"),["prevent"]))},"Login")],2),o("li",{class:h({active:e.isRegisterActive})},[o("button",{onClick:a[1]||(a[1]=U(i=>e.setLoginMode("register"),["prevent"]))},"Register")],2)]),e.mode==="oauth"||e.mode==="both"?(t(),s("div",je,[a[2]||(a[2]=o("div",{class:"screen-reader-text"},"Login with OpenID",-1)),o("div",qe,[e.providers&&e.providers.includes("github")?(t(),s("a",{key:0,href:e.loginWithGitHubUrl,class:"loginButton loginButton--github button"},[m(e.GithubLogo),E(" "+O(e.actionVerb)+" with GitHub ",1)],8,Ue)):p("",!0),e.providers&&e.providers.includes("google")?(t(),s("a",{key:1,href:e.loginWithGoogleUrl,class:"loginButton loginButton--google button"},[m(e.GoogleG),E(" "+O(e.actionVerb)+" with Google ",1)],8,We)):p("",!0)])])):p("",!0),e.mode==="both"?(t(),s("div",Ae,"or")):p("",!0),e.mode==="mail"||e.mode==="both"?(t(),s("div",Ge,[a[3]||(a[3]=o("div",{class:"screen-reader-text"}," Register and login with an email address ",-1)),m(e.EmailLogin,{register:e.isRegisterActive,join:e.join||!1},null,8,["register","join"])])):p("",!0),e.hasLoginFailed?(t(),s("p",Be," We couldn't log you in. Please try again. ")):p("",!0)],2)],64)}const ta=N(Ie,[["render",Oe],["__scopeId","data-v-bc1b4339"]]);export{ta as default};
