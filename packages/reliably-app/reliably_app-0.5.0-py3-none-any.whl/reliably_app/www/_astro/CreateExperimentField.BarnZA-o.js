import{b as j,v as E}from"./runtime-dom.esm-bundler.DChKj6X8.js";import{F as T}from"./FilterableSelect.C271uK1S.js";import{f as D,c as z}from"./snapshots.Bn5DFrP3.js";/* empty css                        */import{_ as P}from"./_plugin-vue_export-helper.DlAUqK2U.js";import{d as A,t as G,r as m,g as x,p as H,q as K,o as L,h as i,c as n,a as u,b,j as f,e as d,w as y,l as Q,n as X}from"./runtime-core.esm-bundler.Y6RLDZTT.js";const Y=A({__name:"CreateExperimentField",props:{configuration:{},index:{},suffix:{},forceInternal:{type:[String,Boolean,Number,Object,null]},previewMode:{type:Boolean},state:{}},emits:["updateConfiguration"],setup(F,{expose:o,emit:N}){o();const e=F,{configuration:a,index:V,suffix:r,forceInternal:s,previewMode:k,state:h}=G(e),M=N;function B(t){q()}function q(){(k===void 0||k.value===!1)&&M("updateConfiguration",a.value.key,a.value.type,g.value,V.value,a.value.required?g.value!==null&&g.value!==void 0&&g.value!==""&&!p.value:!0,r?.value)}const l=m(""),p=m(!1),_=m(""),R=x(()=>a.value.type==="string"?a.value.default:""),C=m([]),U=x(()=>C.value.length>0);function w(){a.value.no_default&&(a.value.default=null)}const g=x(()=>{if(p.value=!1,_.value="",a.value.type==="string")return l.value;if(a.value.type==="integer"||a.value.type==="float"){if(l.value===null||l.value==="")return null;{const t=parseFloat(l.value);if(isNaN(t))p.value=!0,_.value="Value must be a number";else return p.value=!1,_.value="",t}}else{if(a.value.type==="boolean")return l.value==="false"?!1:l.value==="true"?!0:null;if(a.value.type==="object"){p.value=!1,_.value="";try{return JSON.parse(l.value)}catch{p.value=!0,_.value="Object is not valid JSON"}}}}),J=x(()=>a.value.type==="string"?"str":a.value.title==="number"?"int":null);function S(){const t=s!==void 0&&s.value!==null&&s.value!==void 0,c=a.value.default!==null&&a.value.default!==void 0,v=a.value.type;v==="string"?t?l.value=s.value:c?l.value=a.value.default:l.value=null:v==="float"||v==="integer"?t?l.value=s.value.toString():c?l.value=a.value.default.toString():l.value=null:v==="boolean"?t?s.value!==""?l.value=s.value?"true":"false":l.value=null:c&&a.value.default!==""?l.value=a.value.default?"true":"false":l.value=null:t?s.value!==""?l.value=JSON.stringify(s.value,null,2):l.value=null:c&&a.value.default!==""?l.value=JSON.stringify(a.value.default,null,2):l.value=null}async function W(){if(I(),a.value.query!==void 0||a.value.query===null){await D(a.value.query);const t=[];z.value.candidates.forEach(c=>{t.push({label:c.label,val:c.val})}),C.value=t}}function I(){if(r.value===void 0)return h.value;if(h.value===void 0)return[];const t=[],c=`_${r.value}`;for(const v of h.value)v.key.endsWith(c)&&t.push({val:v.val,key:v.key.replace(c,"")});return t}H(a,()=>{w(),S()},{deep:!0}),K(async()=>{h.value=e.state,await W()}),L(async()=>{w(),S(),await W(),q()});const O={props:e,configuration:a,index:V,suffix:r,forceInternal:s,previewMode:k,state:h,emit:M,handleFieldChange:B,emitConfiguration:q,internalValue:l,hasError:p,errorMessage:_,defaultValue:R,fieldCandidates:C,hasCandidates:U,handleNoDefault:w,returnedValue:g,envVarType:J,refreshInternals:S,getCandidates:W,getCurrentState:I,FilterableSelect:T};return Object.defineProperty(O,"__isScriptSetup",{enumerable:!1,value:!0}),O}}),Z={key:0},$=["id"],ee={key:0,class:"required"},ae=["aria-labelledby"],le=["id","required"],ie=["for"],ne=["id"],re=["for"],te={key:0,class:"inputWrapper__help"},oe={key:1,class:"inputWrapper__help"},ue={key:1},de=["for"],fe={key:0,class:"required"},se=["id","placeholder"],ce={key:0,class:"inputWrapper__help"},ve={key:1,class:"inputWrapper__help"},pe={key:2},_e=["for"],he={key:0,class:"required"},ge=["id","placeholder","required"],ye={key:0,class:"inputWrapper__help"},me={key:1,class:"inputWrapper__help"},xe={key:3},be={key:1},Ve=["for"],ke={key:0,class:"required"},qe=["id","placeholder","required"],Ce={key:2,class:"inputWrapper__help"},we={key:3,class:"inputWrapper__help"};function Se(F,o,N,e,a,V){return i(),n("div",{class:X(["createExperimentField inputWrapper inputWrapper--wide",{"inputWrapper--error":e.hasError}])},[e.configuration.type==="boolean"?(i(),n("div",Z,[u("label",{id:`preview-${e.suffix}-${e.index}-label`},[b(f(e.configuration.title)+" ",1),e.configuration.required?(i(),n("span",ee,"Required")):d("",!0)],8,$),u("div",{class:"inputWrapper inputWrapper--tick","aria-labelledby":`preview-${e.suffix}-${e.index}-label`},[u("div",null,[y(u("input",{type:"radio",value:"true","onUpdate:modelValue":o[0]||(o[0]=r=>e.internalValue=r),id:`preview-${e.suffix}-${e.index}-true`,required:e.configuration.required,onInput:e.emitConfiguration},null,40,le),[[j,e.internalValue]]),u("label",{for:`preview-${e.suffix}-${e.index}-true`},"True",8,ie)]),u("div",null,[y(u("input",{type:"radio",value:"false","onUpdate:modelValue":o[1]||(o[1]=r=>e.internalValue=r),id:`preview-${e.suffix}-${e.index}-false`,onInput:e.emitConfiguration},null,40,ne),[[j,e.internalValue]]),u("label",{for:`preview-${e.suffix}-${e.index}-false`},"False",8,re)])],8,ae),e.configuration.help!==""?(i(),n("p",te,f(e.configuration.help),1)):d("",!0),e.hasError?(i(),n("p",oe,f(e.errorMessage),1)):d("",!0)])):e.configuration.type==="object"?(i(),n("div",ue,[u("label",{for:`preview-${e.suffix}-${e.index}`},[b(f(e.configuration.title)+" ",1),e.configuration.required?(i(),n("span",fe," Required ")):d("",!0)],8,de),y(u("textarea",{id:`preview-${e.suffix}-${e.index}`,"onUpdate:modelValue":o[2]||(o[2]=r=>e.internalValue=r),placeholder:e.configuration.placeholder,onInput:e.emitConfiguration},null,40,se),[[E,e.internalValue]]),e.configuration.help!==""?(i(),n("p",ce,f(e.configuration.help),1)):d("",!0),e.hasError?(i(),n("p",ve,f(e.errorMessage),1)):d("",!0)])):e.configuration.type==="integer"||e.configuration.type==="float"?(i(),n("div",pe,[u("label",{for:`preview-${e.suffix}-${e.index}`},[b(f(e.configuration.title)+" ",1),e.configuration.required?(i(),n("span",he," Required ")):d("",!0)],8,_e),y(u("input",{type:"text",id:`preview-${e.suffix}-${e.index}`,placeholder:e.configuration.placeholder,required:e.configuration.required,"onUpdate:modelValue":o[3]||(o[3]=r=>e.internalValue=r),onInput:e.emitConfiguration},null,40,ge),[[E,e.internalValue]]),e.configuration.help!==""?(i(),n("p",ye,f(e.configuration.help),1)):d("",!0),e.hasError?(i(),n("p",me,f(e.errorMessage),1)):d("",!0)])):e.configuration.type==="string"?(i(),n("div",xe,[e.hasCandidates?(i(),Q(e.FilterableSelect,{key:0,options:e.fieldCandidates,modelValue:e.internalValue,"onUpdate:modelValue":o[4]||(o[4]=r=>e.internalValue=r),label:e.configuration.title,"is-required":!0,"default-message":e.defaultValue,onEmitObject:e.handleFieldChange},null,8,["options","modelValue","label","default-message"])):(i(),n("div",be,[u("label",{for:`preview-${e.suffix}-${e.index}`},[b(f(e.configuration.title)+" ",1),e.configuration.required?(i(),n("span",ke," Required ")):d("",!0)],8,Ve),y(u("input",{type:"text",id:`preview-${e.suffix}-${e.index}`,placeholder:e.configuration.placeholder,required:e.configuration.required,"onUpdate:modelValue":o[5]||(o[5]=r=>e.internalValue=r),onInput:e.emitConfiguration},null,40,qe),[[E,e.internalValue]])])),e.configuration.help!==""?(i(),n("p",Ce,f(e.configuration.help),1)):d("",!0),e.hasError?(i(),n("p",we,f(e.errorMessage),1)):d("",!0)])):d("",!0)],2)}const Oe=P(Y,[["render",Se],["__scopeId","data-v-a0bbcc9a"]]);export{Oe as C};
