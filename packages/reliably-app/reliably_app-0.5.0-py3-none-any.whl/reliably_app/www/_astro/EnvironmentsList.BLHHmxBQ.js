import{b as C,f as N}from"./environments.zePoF_Ox.js";import{E as x}from"./EntityFilter.DE3cAZtq.js";import{N as B}from"./NoData.CWOJbPLy.js";import{w as V}from"./runtime-dom.esm-bundler.DChKj6X8.js";import{h as w}from"./objects.CrQdKsRW.js";import{T as M}from"./TimeAgo.hHi23vP_.js";import{D as T}from"./DeleteButton.Ch6PF2gM.js";import{M as F}from"./ModalWindow.Go1bYN-e.js";import{C as j}from"./ConfirmDeleteEnvironment.BcqJgHc3.js";/* empty css                       */import{_ as S}from"./_plugin-vue_export-helper.DlAUqK2U.js";import{d as k,t as A,g as b,r as _,h as o,c as d,a as l,j as D,b as y,i as u,l as p,m as E,e as g,f as I,F as P,k as O,o as R}from"./runtime-core.esm-bundler.Y6RLDZTT.js";import{L as W}from"./LoadingPlaceholder.BoWrztnb.js";import{P as z}from"./Pager.Cmasf88E.js";import{u as U}from"./index.CwJxcYEt.js";import"./user.BEEfOshe.js";import"./user.Bg1Nd46A.js";import"./index.BSdFiPHn.js";import"./loader.BQDlK3Tc.js";import"./notifications.NSMm1_5U.js";import"./strings.Fm4VVZpd.js";import"./dayjs.min.xlbmdZiw.js";import"./duration.BGVtNWJ9.js";/* empty css                       *//* empty css                        */import"./TrashIcon.BzGEjUcP.js";import"./index.DUHDLdXK.js";import"./CloseIcon.DLOPA8gH.js";/* empty css                        *//* empty css                       *//* empty css                       *//* empty css                       */const q=k({__name:"EnvironmentPreview",props:{environment:{},page:{}},setup(f,{expose:a}){a();const i=f,{environment:e,page:r}=A(i),m=b(()=>{let t="";return e!==void 0&&(e.value.envvars.forEach(n=>{t+=`${n.var_name}, `}),t=t.slice(0,t.length-2)),t}),s=b(()=>{let t="";return e!==void 0&&(e.value.secrets.forEach(n=>{w(n,"var_name")?t+=`${n.var_name}, `:w(n,"path")&&(t+=`${n.path}, `)}),t=t.slice(0,t.length-2)),t}),c=_(!1),v={props:i,environment:e,page:r,environmentVars:m,environmentSecrets:s,isDeleteDisplayed:c,displayDelete:()=>{c.value=!0},closeDelete:()=>{c.value=!1},TimeAgo:M,DeleteButton:T,ModalWindow:F,ConfirmDeleteEnvironment:j};return Object.defineProperty(v,"__isScriptSetup",{enumerable:!1,value:!0}),v}}),G={class:"environmentPreview tableList__row"},H={class:"tableList__cell environmentPreview__name"},J=["href"],K={class:"tableList__cell environmentPreview__vars"},Q={class:"tableList__cell environmentPreview__secrets"},X={class:"tableList__cell tableList__cell--small"};function Y(f,a,i,e,r,m){return o(),d("li",G,[l("div",H,[l("a",{href:`/environments/view?id=${e.environment.id}`},[l("span",null,D(e.environment.name),1)],8,J),l("small",null,[a[0]||(a[0]=y("Created ")),u(e.TimeAgo,{timestamp:e.environment.created_date},null,8,["timestamp"])])]),l("div",K,D(e.environmentVars),1),l("div",Q,D(e.environmentSecrets),1),l("div",X,[u(e.DeleteButton,{onClick:V(e.displayDelete,["prevent"])})]),e.isDeleteDisplayed?(o(),p(e.ModalWindow,{key:0,hasCloseButton:!0,hasPadding:!0,onClose:e.closeDelete},{title:E(()=>a[1]||(a[1]=[y("Delete Environment")])),content:E(()=>[u(e.ConfirmDeleteEnvironment,{id:e.environment.id,page:e.page,"in-place":!0,onClose:e.closeDelete},null,8,["id","page"])]),_:1})):g("",!0)])}const Z=S(q,[["render",Y],["__scopeId","data-v-fe010f28"]]),$=k({__name:"EnvironmentsList",setup(f,{expose:a}){a();const i=_(!0),e=_(void 0),r=_(""),m=_({currentPage:1,lastPage:1,urlBase:""}),s=U(C),c=()=>{let t=window.location,n=new URLSearchParams(t.search);n.has("page")?e.value=parseInt(n.get("page")):e.value=1,n.has("search")?r.value=n.get("search"):r.value=""},h=()=>{let t="/environments/?page=";r.value!==""&&(t=`/environments/?search=${r.value}&page=`);let n={currentPage:e.value,lastPage:Math.ceil(s.value.total/10),urlBase:t};m.value=n};async function L(){i.value=!0,c(),await N(e.value,r.value),h(),i.value=!1}R(async()=>{await L()});const v={isLoading:i,page:e,searchTerm:r,pagerData:m,envs:s,getParams:c,getPagerData:h,refreshList:L,EntityFilter:x,NoData:B,EnvironmentPreview:Z,LoadingPlaceholder:W,Pager:z};return Object.defineProperty(v,"__isScriptSetup",{enumerable:!1,value:!0}),v}}),ee={key:2,class:"environmentsList tableList"};function te(f,a,i,e,r,m){return o(),d(P,null,[u(e.EntityFilter,{onSearch:e.refreshList}),e.isLoading?(o(),p(e.LoadingPlaceholder,{key:0,size:"large"})):g("",!0),e.envs.total===0?(o(),p(e.NoData,{key:1,message:"No environments found"})):(o(),d("ul",ee,[a[0]||(a[0]=I('<li class="tableList__row tableList__row--header"><div class="tableList__cell">Name</div><div class="tableList__cell">Vars</div><div class="tableList__cell">Secrets</div><div class="tableList__cell"><span class="screen-reader-text">Actions</span></div></li>',1)),(o(!0),d(P,null,O(e.envs.environments,s=>(o(),d(P,null,[s.used_for!=="notification"&&s.used_for!=="snapshot"?(o(),p(e.EnvironmentPreview,{environment:s,page:e.page,key:s.id,class:"tableList__row"},null,8,["environment","page"])):g("",!0)],64))),256))])),e.envs.total>10?(o(),p(e.Pager,{key:3,page:e.pagerData},null,8,["page"])):g("",!0)],64)}const Te=S($,[["render",te]]);export{Te as default};
