const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["_astro/chartjs-plugin-zoom.esm.vmyBFRZ7.js","_astro/dayjs.min.xlbmdZiw.js","_astro/index.B8cAO9n_.js","_astro/runtime-core.esm-bundler.Y6RLDZTT.js"])))=>i.map(i=>d[i]);
import{_ as J}from"./preload-helper.CLcXU_4U.js";import{w as Y}from"./runtime-dom.esm-bundler.DChKj6X8.js";import{C as K,L as Q}from"./index.B8cAO9n_.js";import{d as s}from"./dayjs.min.xlbmdZiw.js";import"./chartjs-adapter-dayjs-3.esm.QhwHA_Y4.js";import{L as X}from"./LoadingPlaceholder.BoWrztnb.js";import{m as $,l as aa}from"./series.kU8HocMx.js";/* empty css                       */import{_ as ta}from"./_plugin-vue_export-helper.DlAUqK2U.js";import{u as ea}from"./index.CwJxcYEt.js";import{d as oa,c as x,a as f,n as D,l as y,e as na,r as o,p as sa,o as ia,h as r}from"./runtime-core.esm-bundler.Y6RLDZTT.js";import"./customParseFormat.OZyEFAaQ.js";/* empty css                       */import"./user.Bg1Nd46A.js";import"./index.BSdFiPHn.js";import"./loader.BQDlK3Tc.js";import"./notifications.NSMm1_5U.js";import"./contributions.K_0J8Jft.js";import"./objects.CrQdKsRW.js";import"./user.BEEfOshe.js";const ra=oa({__name:"PeriodMetrics",setup(q,{expose:n}){n();const{Chart:d,CategoryScale:a,TimeScale:h,LinearScale:M,PointElement:l,LineElement:g,Title:w,Tooltip:L,Legend:P}=K;typeof window<"u"&&(async()=>{const{default:e}=await J(async()=>{const{default:t}=await import("./chartjs-plugin-zoom.esm.vmyBFRZ7.js");return{default:t}},__vite__mapDeps([0,1,2,3]));d.register(e)})(),d.register(a,h,M,l,g,w,L,P);const i=["#f3a93c","#ee7d56","#de6177","#af588d","#3b4d7c","#3b4d7c","#163e59"],v=o(!0),k=o(!0),_=o(!1),c=ea($),z=o({datasets:[{label:"Executions",backgroundColor:i[0],borderColor:i[1],fill:!1,tension:.1,data:[]}]}),O=o({datasets:[{label:"Executions",backgroundColor:i[0],borderColor:i[1],fill:!1,tension:.1,data:[]}]}),S=o({datasets:[{label:"Execution",backgroundColor:i[0],borderColor:i[0],fill:!1,tension:.1,data:[]}]}),E=s().format("YYYY-MM-DD"),R=s().subtract(31,"days").format("YYYY-MM-DD"),p=o(10),A=s().day(),b=s().subtract((A+6)%7,"days"),B=b.format("YYYY-MM-DD"),T=b.subtract(28,"days").format("YYYY-MM-DD"),m=o(10),C=s().startOf("month"),F=C.format("YYYY-MM-DD"),G=C.subtract(5,"month").format("YYYY-MM-DD"),u=o(10);async function I(){await aa()}async function U(){if(k.value=!0,c.value.distributions.per_period.per_day.length===0)_.value=!1;else{_.value=!0;const e=c.value.distributions.per_period;e.per_day.forEach(t=>{z.value.datasets[0].data.push({x:t.day,y:t.count}),t.count>=p.value&&(p.value=Math.ceil(t.count/10)*10)}),e.per_week.forEach(t=>{O.value.datasets[0].data.push({x:t.week,y:t.count}),t.count>=m.value&&(m.value=Math.ceil(t.count/10)*10)}),e.per_month.forEach(t=>{S.value.datasets[0].data.push({x:t.month,y:t.count}),t.count>=u.value&&(u.value=Math.ceil(t.count/10)*10)})}W.value.scales.y.max=p.value,Z.value.scales.y.max=m.value,j.value.scales.y.max=u.value,k.value=!1}sa(c,()=>U());const V=o("day");function H(e){V.value=e}const W=o({type:"line",responsive:!0,maintainAspectRatio:!1,datasets:{line:{spanGaps:!0,tension:.2}},scales:{x:{type:"time",time:{unit:"day",displayFormats:{day:"DD MMM."}},min:R,max:E},y:{min:0,max:10,ticks:{beginAtZero:!0,stepSize:1}}},plugins:{legend:{display:!1},zoom:{zoom:{wheel:{enabled:!1},pinch:{enabled:!1}},pan:{enabled:!0,mode:"x",threshold:10}},tooltip:{callbacks:{title:function(e){return s(e[0].label).format("MMMM D, YYYY")}}}}}),Z=o({type:"line",responsive:!0,maintainAspectRatio:!1,datasets:{line:{spanGaps:!0,tension:.2}},scales:{x:{type:"time",time:{unit:"week",displayFormats:{day:"DD MMM."},isoWeekday:!0},min:T,max:B,ticks:{autoSkip:!1,maxRotation:90,minRotation:90}},y:{min:0,max:10,ticks:{beginAtZero:!0,stepSize:1}}},plugins:{legend:{display:!1},zoom:{zoom:{wheel:{enabled:!1},pinch:{enabled:!1}},pan:{enabled:!0,mode:"x",threshold:10}},tooltip:{callbacks:{title:function(e){return`Week starting ${s(e[0].parsed.x).format("MMMM D, YYYY")}`}}}}}),j=o({type:"line",responsive:!0,maintainAspectRatio:!1,datasets:{line:{spanGaps:!0,tension:.2}},scales:{x:{type:"time",time:{unit:"month",displayFormats:{day:"MMM."}},min:G,max:F,ticks:{autoSkip:!1,maxRotation:90,minRotation:90}},y:{min:0,max:10,ticks:{beginAtZero:!0,stepSize:1}}},plugins:{legend:{display:!1},zoom:{zoom:{wheel:{enabled:!1},pinch:{enabled:!1}},pan:{enabled:!0,mode:"x",threshold:10}},tooltip:{callbacks:{title:function(e){return s(e[0].parsed.x).format("MMMM YYYY")}}}}});ia(async()=>{v.value=!0,await I(),v.value=!1});const N={Chart:d,CategoryScale:a,TimeScale:h,LinearScale:M,PointElement:l,LineElement:g,Title:w,Tooltip:L,Legend:P,COLORS:i,isMounting:v,isComputing:k,hasData:_,storedData:c,dayData:z,weekData:O,monthData:S,dayChartMax:E,dayChartMin:R,dayUpperBound:p,day:A,lastMonday:b,weekChartMax:B,weekChartMin:T,weekUpperBound:m,startOfMonth:C,monthChartMax:F,monthChartMin:G,monthUpperBound:u,getData:I,computeData:U,displayedChart:V,display:H,dayChartOptions:W,weekChartOptions:Z,monthChartOptions:j,get Line(){return Q},LoadingPlaceholder:X};return Object.defineProperty(N,"__isScriptSetup",{enumerable:!1,value:!0}),N}}),la={class:"periodMetrics"},da={class:"periodMetrics__controls"},ca={key:1},pa={key:2,class:"periodMetrics__wrapper"};function ma(q,n,d,a,h,M){return r(),x("div",la,[f("div",da,[f("button",{onClick:n[0]||(n[0]=Y(l=>a.display("day"),["prevent"])),class:D(["pill",{"pill--active":a.displayedChart==="day"}])}," Per day ",2),f("button",{onClick:n[1]||(n[1]=Y(l=>a.display("week"),["prevent"])),class:D(["pill",{"pill--active":a.displayedChart==="week"}])}," Per week ",2),f("button",{onClick:n[2]||(n[2]=Y(l=>a.display("month"),["prevent"])),class:D(["pill",{"pill--active":a.displayedChart==="month"}])}," Per month ",2)]),a.isMounting||a.isComputing?(r(),y(a.LoadingPlaceholder,{key:0})):a.hasData?(r(),x("div",pa,[a.displayedChart==="day"?(r(),y(a.Line,{key:0,data:a.dayData,options:a.dayChartOptions},null,8,["data","options"])):a.displayedChart==="week"?(r(),y(a.Line,{key:1,data:a.weekData,options:a.weekChartOptions},null,8,["data","options"])):a.displayedChart==="month"?(r(),y(a.Line,{key:2,data:a.monthData,options:a.monthChartOptions},null,8,["data","options"])):na("",!0)])):(r(),x("p",ca,"We don't have this data yet."))])}const Ea=ta(ra,[["render",ma],["__scopeId","data-v-7fcce515"]]);export{Ea as default};
