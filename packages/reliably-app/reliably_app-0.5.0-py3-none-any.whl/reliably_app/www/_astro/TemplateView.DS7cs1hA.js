import{w as M}from"./runtime-dom.esm-bundler.DChKj6X8.js";import{s as J}from"./strings.Fm4VVZpd.js";import{t as U,f as P}from"./templates.C0LiUYsE.js";import{C as I}from"./CreateExperimentField.BarnZA-o.js";import{J as C}from"./JsonViewer.CMLqmGhq.js";/* empty css                      */import{_ as k}from"./_plugin-vue_export-helper.DlAUqK2U.js";import{d as V,t as O,h as a,c as p,a as t,j as _,i as o,e as v,l as f,b as c,F as W,k as H,m,r as d,g as R,o as A}from"./runtime-core.esm-bundler.Y6RLDZTT.js";import{C as z}from"./ConfirmDeleteTemplate.DgAxsJkF.js";import{L as q}from"./LoadingPlaceholder.BoWrztnb.js";import{N as G}from"./NoData.CWOJbPLy.js";import{M as K}from"./ModalWindow.Go1bYN-e.js";import{T as Q}from"./TagList.DHWFg1rv.js";import{T as X}from"./TimeAgo.hHi23vP_.js";import{u as Y}from"./index.CwJxcYEt.js";import"./dayjs.min.xlbmdZiw.js";import"./duration.BGVtNWJ9.js";import"./notifications.NSMm1_5U.js";import"./index.BSdFiPHn.js";import"./user.BEEfOshe.js";import"./user.Bg1Nd46A.js";import"./loader.BQDlK3Tc.js";import"./FilterableSelect.C271uK1S.js";import"./index.DUHDLdXK.js";/* empty css                        */import"./snapshots.Bn5DFrP3.js";/* empty css                        */import"./js-yaml.C-pQuU5J.js";/* empty css                        */import"./preload-helper.CLcXU_4U.js";/* empty css                       *//* empty css                       *//* empty css                        */import"./CloseIcon.DLOPA8gH.js";/* empty css                        *//* empty css                        */const Z=V({__name:"TemplateViewField",props:{field:{},index:{},configuration:{}},setup(g,{expose:i}){i();const l=g,{field:e,index:n,configuration:r}=O(l),s={props:l,field:e,index:n,configuration:r,CreateExperimentField:I,JsonViewer:C};return Object.defineProperty(s,"__isScriptSetup",{enumerable:!1,value:!0}),s}}),$={class:"templateViewField"},ee={key:0},te={class:"form"};function ie(g,i,l,e,n,r){return a(),p("div",$,[t("h3",null,_(e.field.key),1),t("div",null,[t("div",null,[e.configuration[e.field.key]!==void 0?(a(),p("div",ee,[o(e.JsonViewer,{json:JSON.stringify({[e.field.key]:e.configuration[e.field.key]},null,2)},null,8,["json"])])):v("",!0)]),t("div",null,[i[0]||(i[0]=t("h4",null,"Preview",-1)),i[1]||(i[1]=t("p",null,"How the field will appear when using the template.",-1)),t("form",te,[o(e.CreateExperimentField,{configuration:e.field,index:1,"force-internal":null,previewMode:!0},null,8,["configuration"])])])])])}const ne=k(Z,[["render",ie],["__scopeId","data-v-d6930831"]]),ae=V({__name:"TemplateView",setup(g,{expose:i}){i();const l=d(!0),e=d(void 0),n=Y(U),r=d(null);function s(){let y=window.location,T=new URLSearchParams(y.search);T.has("id")&&(e.value=T.get("id"))}async function u(){await P(e.value),n.value!==null&&(r.value={metadata:{id:n.value.id,org_id:n.value.org_id||"",name:n.value.manifest.metadata.name,labels:n.value.manifest.metadata.labels,annotations:n.value.manifest.metadata.annotations},spec:{provider:"chaostoolkit",type:"experiment",schema:{configuration:n.value.manifest.spec.schema.configuration},template:n.value.manifest.spec.template}})}const x=()=>{let y="Template · Reliably";n.value!==void 0&&n.value!==null&&(y=`${n.value.manifest.metadata.name} · Reliably`),document.title=y},L=R(()=>n.value===void 0||n.value===null||n.value.manifest.metadata.labels===void 0?!1:n.value.manifest.metadata.labels.length>0),h=d(!1),E=()=>{h.value=!0},F=()=>{h.value=!1},w=d(!1),N=()=>{w.value=!0},S=()=>{w.value=!1},b=d(!1),j=()=>{b.value=!0},B=()=>{b.value=!1};A(async()=>{l.value=!0,s(),await u(),x(),l.value=!1});const D={isLoading:l,id:e,temp:n,templateExport:r,getCurrentId:s,getTemplate:u,setMetaData:x,hasLabels:L,isDefinitionDisplayed:h,displayExperimentDefinition:E,closeExperimentDefinition:F,isTemplateDisplayed:w,displayTemplate:N,closeTemplate:S,isDeleteDisplayed:b,displayDelete:j,closeDelete:B,get shortenUuid(){return J},TemplateViewField:ne,ConfirmDeleteTemplate:z,LoadingPlaceholder:q,NoData:G,ModalWindow:K,TagList:Q,TimeAgo:X,JsonViewer:C};return Object.defineProperty(D,"__isScriptSetup",{enumerable:!1,value:!0}),D}}),le={key:1,class:"templateView"},oe={class:"pageHeader"},se={class:"pageHeader__title"},re={class:"pageHeader__actions"},me=["href"],de=["href"],pe={class:"templateInfo"},ue={key:0,class:"templateView__labels"},fe={class:"templateConfiguration"},ce={class:"templateFields list-reset"};function _e(g,i,l,e,n,r){return e.isLoading?(a(),f(e.LoadingPlaceholder,{key:0,size:"large"})):e.temp!==void 0&&e.temp!==null&&e.temp.id!==void 0?(a(),p("article",le,[t("header",oe,[t("div",null,[t("h1",se,[t("span",null,[c(_(e.temp.manifest.metadata.name)+" ",1),t("small",null,_(e.shortenUuid(e.temp.id)),1)])]),t("p",null,[i[0]||(i[0]=c("Created ")),o(e.TimeAgo,{timestamp:e.temp.created_date},null,8,["timestamp"])])]),t("div",re,[t("button",{class:"button button--destructiveLight",onClick:M(e.displayDelete,["prevent"])}," Delete template "),t("a",{href:`/experiments/custom-templates/new/?duplicate=${e.temp.id}`,class:"button button--primary"}," Duplicate template ",8,me),t("a",{href:`/experiments/custom-templates/create/?id=${e.temp.id}`,class:"button button--creative"}," Create an experiment from this template ",8,de)])]),t("section",pe,[t("dl",null,[t("div",null,[i[1]||(i[1]=t("dt",null,"Labels",-1)),t("dd",null,[e.hasLabels?(a(),p("div",ue,[o(e.TagList,{tags:e.temp.manifest.metadata.labels},null,8,["tags"])])):v("",!0)])]),t("div",null,[i[2]||(i[2]=t("dt",null,"Experiment",-1)),t("dd",null,_(e.temp.manifest.spec.template.title),1)]),t("div",null,[i[3]||(i[3]=t("dt",null,"Description",-1)),t("dd",null,_(e.temp.manifest.spec.template.description),1)]),i[4]||(i[4]=t("div",null,[t("dt",null,"Usage"),t("dd",null," Use this template to create an experiment by overriding a set predefined values. ")],-1))])]),t("section",fe,[t("div",{class:"templateConfiguration__header"},[i[5]||(i[5]=t("div",null,[t("h2",null,"Configuration"),t("p",null," These configuration values can be edited when using the template to create an experiment. ")],-1)),t("div",null,[t("button",{onClick:e.displayExperimentDefinition,class:"button button--light"}," View experiment "),t("button",{onClick:e.displayTemplate,class:"button button--primary"}," View template ")])]),t("ul",ce,[(a(!0),p(W,null,H(e.temp.manifest.spec.schema.configuration,(s,u)=>(a(),p("li",{class:"templateField",key:u},[o(e.TemplateViewField,{field:s,index:u,configuration:e.temp.manifest.spec.template.configuration},null,8,["field","index","configuration"])]))),128))])]),e.isDeleteDisplayed?(a(),f(e.ModalWindow,{key:0,hasCloseButton:!0,hasPadding:!0,onClose:e.closeDelete},{title:m(()=>i[6]||(i[6]=[c("Delete Template")])),content:m(()=>[o(e.ConfirmDeleteTemplate,{id:e.temp.id,onClose:e.closeDelete},null,8,["id"])]),_:1})):v("",!0),e.isTemplateDisplayed?(a(),f(e.ModalWindow,{key:1,isUnlimited:!0,hasCloseButton:!0,onClose:e.closeTemplate},{title:m(()=>i[7]||(i[7]=[c("Template")])),content:m(()=>[o(e.JsonViewer,{json:JSON.stringify(e.templateExport,null,2),"force-wrap":!0},null,8,["json"])]),_:1})):v("",!0),e.isDefinitionDisplayed?(a(),f(e.ModalWindow,{key:2,isUnlimited:!0,hasCloseButton:!0,onClose:e.closeExperimentDefinition},{title:m(()=>i[8]||(i[8]=[c("Experiment Definition")])),content:m(()=>[o(e.JsonViewer,{json:JSON.stringify(e.temp.manifest.spec.template,null,2),"force-wrap":!0},null,8,["json"])]),_:1})):v("",!0)])):(a(),f(e.NoData,{key:2,message:"We couldn't find an experiment with this ID."}))}const Ze=k(ae,[["render",_e],["__scopeId","data-v-639da2ed"]]);export{Ze as default};
