# nb.typ / nb-lib.typ ä»£ç å®¡æŸ¥

> å‚è€ƒ: Typst å®˜æ–¹æ–‡æ¡£ + typst-community/package-api-guidelines

---

## 1. ç»“æ„é—®é¢˜

### 1.1 set è§„åˆ™é‡å¤

`set text`ã€`set par` ä¸¤ä¸ªæ–‡ä»¶éƒ½è®¾ç½®ï¼Œé€ æˆå†²çªï¼š
- `nb.typ:37-49` è®¾ç½®
- `nb-lib.typ:297-327` å†æ¬¡è®¾ç½®

**å»ºè®®**ï¼šåˆ é™¤ `nb.typ` ä¸­çš„è®¾ç½®ï¼Œä»…ä¿ç•™ `nb-lib.typ`

---

### 1.2 æ³¨é‡Šä»£ç æœªæ¸…ç†

ä»¥ä¸‹åºŸå¼ƒä»£ç åº”åˆ é™¤ï¼ˆç”¨ git è¿½æº¯ï¼‰ï¼š
- `nb.typ:51-63` æ—§ `show: nb.with()`
- `nb-lib.typ:30-77` æ—§ç‰ˆ `floatc`
- `nb-lib.typ:89-98` æ—§ç‰ˆ `outline.entry`
- `nb-lib.typ:385-392` æ³¨é‡Šçš„ `strong` é«˜äº®

---

## 2. æœ€ä½³å®è·µé—®é¢˜

### 2.1 é­”æ³•æ•°å­—ï¼ˆMagic Numbersï¼‰

**é—®é¢˜**ï¼šç¡¬ç¼–ç å°ºå¯¸æ•£è½å„å¤„ï¼Œéš¾ä»¥ç»´æŠ¤

ç¤ºä¾‹ï¼š
```
21cm - 8.5cm   // floatc å‡½æ•°ä¸­
6.0cm          // é¡µé¢å³è¾¹è·ï¼Œå¤šå¤„é‡å¤
2.5cm          // é¡µé¢è¾¹è·
```

**å»ºè®®**ï¼šå®šä¹‰å¸¸é‡é›†ä¸­ç®¡ç†
```typst
#let page-margin-left = 2.5cm
#let page-margin-right = 6.0cm
#let float-column-width = 5cm
```

---

### 2.2 show rule é‡å¤å®šä¹‰

**é—®é¢˜**ï¼š`<quote>` æ ‡ç­¾å’Œå†…ç½® `quote` å…ƒç´ ä½¿ç”¨ç›¸åŒæ ·å¼ï¼Œä½†ä»£ç å®Œå…¨é‡å¤

- ç¬¬ 330-345 è¡Œ ä¸ ç¬¬ 347-362 è¡Œ

**å»ºè®®**ï¼šæå–ä¸ºå…¬å…±æ ·å¼å‡½æ•°
```typst
#let quote-style(it) = block(
  fill: rgb("#E4F6F6"),
  radius: 0.5em,
  ...
)
show quote: quote-style
show <quote>: quote-style
```

---

### 2.3 heading show rules é‡å¤

**é—®é¢˜**ï¼šlevel 2/3/4 çš„ heading æ ·å¼å‡ ä¹ç›¸åŒï¼Œä»…å­—å·ä¸åŒ

- ç¬¬ 309-318 è¡Œ

**å»ºè®®**ï¼šå¯ç®€åŒ–ä¸ºæ ¹æ® level è®¡ç®—å­—å·
```typst
show heading: it => {
  let size = if it.level == 1 { 20pt } 
             else if it.level == 2 { 16pt } 
             else { 14pt }
  block(above: 3em, below: 2em, text(size: size, it.body))
}
```

---

## 3. å¯è¯»æ€§ä¸å¯ç»´æŠ¤æ€§

### 3.1 å‡½æ•°å‚æ•°è¿‡å¤šï¼ˆ`conf` / `nb`ï¼‰

**é—®é¢˜**ï¼š`conf` å‡½æ•°æœ‰ 18 ä¸ªå‚æ•°ï¼Œ`nb` å‡½æ•°æœ‰ 17 ä¸ªå‚æ•°ï¼Œéš¾ä»¥è®°å¿†å’Œä½¿ç”¨

**å»ºè®®æ–¹æ¡ˆ**ï¼š
1. åˆ†ç»„ä¸ºå­—å…¸å‚æ•°

```typst
// å½“å‰
conf(title: ..., author: ..., date: ..., ...)

// æ”¹è¿›
conf(
  meta: (title: ..., author: ..., date: ...),
  style: (font: ..., disable-indent: ...),
  layout: (toc-depth: ..., disables: (...)),
)
```

2. æˆ–ä½¿ç”¨ç±»å‹å®šä¹‰ï¼ˆTypst 0.12+ æ”¯æŒï¼‰

---

### 3.2 ç¼ºä¹æ–‡æ¡£æ³¨é‡Š

**é—®é¢˜**ï¼šå¤§éƒ¨åˆ†å‡½æ•°ç¼ºå°‘å‚æ•°è¯´æ˜ï¼Œä»…æœ‰é›¶æ˜Ÿä¸­æ–‡æ³¨é‡Š

**å»ºè®®**ï¼šä¸ºæ¯ä¸ª public å‡½æ•°æ·»åŠ æ–‡æ¡£æ³¨é‡Š
```typst
/// å…¨é¡µå›¾ç‰‡æ˜¾ç¤º
/// - img: å›¾ç‰‡è·¯å¾„ï¼ˆå­—ç¬¦ä¸²ï¼‰
/// - fit: å¡«å……æ–¹å¼ "cover"/"contain"/"stretch"
/// - bg: èƒŒæ™¯è‰²
#let fullimage(img, fit: "contain", bg: white) = { ... }
```

---

## 4. æ½œåœ¨é—®é¢˜

### 4.1 `content-to-string` é€’å½’æ²¡æœ‰ç±»å‹æ£€æŸ¥

**é—®é¢˜**ï¼šå‡è®¾ content ä¸€å®šæœ‰ `.has` æ–¹æ³•ï¼Œè¾¹ç•Œæƒ…å†µå¯èƒ½æŠ¥é”™

```typst
// ç¬¬ 9 è¡Œ
let result = if content.has("text") { ... }
```

**å»ºè®®**ï¼šæ·»åŠ ç±»å‹æ£€æŸ¥
```typst
if type(content) == content and content.has("text") { ... }
```

---

### 4.2 è¡¨æ ¼å®½åº¦å¤„ç†å¯èƒ½è¶Šç•Œ

**é—®é¢˜**ï¼šå¼ºåˆ¶ 140% å®½åº¦ + 15% åç§»ï¼Œåœ¨çª„å†…å®¹æ—¶å¯èƒ½å‡ºé—®é¢˜

```typst
// ç¬¬ 375-383 è¡Œ
width: 140%,
dx: 15%,
```

**å»ºè®®**ï¼šè€ƒè™‘ä½¿ç”¨ `measure` åˆ¤æ–­å®é™…å®½åº¦

---

## 5. ä»£ç é£æ ¼å»ºè®®

| é—®é¢˜ | ä½ç½® | å»ºè®® |
|------|------|------|
| æ‹¬å·å†—ä½™ | `if(not disable_cover)` | æ”¹ä¸º `if not disable_cover` |
| ä¸€è‡´æ€§ | `disable-indent` vs `disable-cover` | ç»Ÿä¸€å‘½åé£æ ¼ |
| é­”æ³•é¢œè‰² | `#00008B`, `#E4F6F6` | æå–ä¸ºå‘½åå˜é‡ |

---

## 6. ä¼˜å…ˆçº§å»ºè®®

| ä¼˜å…ˆçº§ | ä¿®æ”¹é¡¹ |
|--------|--------|
| ğŸ”´ é«˜ | åˆ é™¤é‡å¤çš„ set è§„åˆ™ |
| ğŸ”´ é«˜ | æ¸…ç†æ³¨é‡Šä»£ç å— |
| ğŸŸ¡ ä¸­ | æå–é­”æ³•æ•°å­—ä¸ºå¸¸é‡ |
| ğŸŸ¡ ä¸­ | åˆå¹¶é‡å¤çš„ show rules |
| ğŸŸ¢ ä½ | å‡½æ•°å‚æ•°é‡ç»„ |
| ğŸŸ¢ ä½ | æ·»åŠ æ–‡æ¡£æ³¨é‡Š |
