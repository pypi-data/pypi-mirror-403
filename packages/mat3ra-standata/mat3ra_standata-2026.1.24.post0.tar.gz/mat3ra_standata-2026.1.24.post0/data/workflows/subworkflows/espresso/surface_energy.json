{
    "_id": "3e05a2b5-4171-54a2-9d2d-9e46118a56bf",
    "name": "Surface Energy",
    "application": {
        "name": "espresso"
    },
    "properties": [
        "atomic_forces",
        "fermi_energy",
        "pressure",
        "stress_tensor",
        "total_energy",
        "total_energy_contributions",
        "total_force"
    ],
    "model": {
        "type": "dft",
        "subtype": "gga",
        "method": {
            "type": "pseudopotential",
            "subtype": "us",
            "data": {}
        },
        "functional": {
            "slug": "pbe"
        },
        "refiners": [],
        "modifiers": []
    },
    "units": [
        {
            "name": "io-slab",
            "type": "io",
            "subtype": "input",
            "head": true,
            "results": [],
            "monitors": [],
            "flowchartId": "e463ef46-a36e-5168-87dd-e21eb980dfb8",
            "preProcessors": [],
            "postProcessors": [],
            "source": "api",
            "input": [
                {
                    "endpoint": "materials",
                    "endpoint_options": {
                        "params": {
                            "query": "{'_id': MATERIAL_ID}",
                            "projection": "{}"
                        }
                    },
                    "name": "DATA"
                }
            ],
            "next": "ee7abb4e-7848-5aeb-960d-0d441909e2d1",
            "application": {
                "name": "espresso",
                "shortName": "qe",
                "summary": "Quantum ESPRESSO",
                "build": "GNU",
                "hasAdvancedComputeOptions": true,
                "isDefault": true,
                "version": "6.3",
                "schemaVersion": "2022.8.16"
            },
            "status": "idle",
            "statusTrack": [],
            "tags": []
        },
        {
            "name": "slab",
            "type": "assignment",
            "operand": "SLAB",
            "value": "DATA[0]",
            "input": [
                {
                    "name": "DATA",
                    "scope": "e463ef46-a36e-5168-87dd-e21eb980dfb8"
                }
            ],
            "head": false,
            "results": [],
            "monitors": [],
            "flowchartId": "ee7abb4e-7848-5aeb-960d-0d441909e2d1",
            "preProcessors": [],
            "postProcessors": [],
            "next": "44263820-0c80-5bd1-b854-9da8d198eac1",
            "application": {
                "name": "espresso",
                "shortName": "qe",
                "summary": "Quantum ESPRESSO",
                "build": "GNU",
                "hasAdvancedComputeOptions": true,
                "isDefault": true,
                "version": "6.3",
                "schemaVersion": "2022.8.16"
            },
            "status": "idle",
            "statusTrack": [],
            "tags": []
        },
        {
            "name": "io-bulk",
            "type": "io",
            "subtype": "input",
            "head": false,
            "results": [],
            "monitors": [],
            "flowchartId": "44263820-0c80-5bd1-b854-9da8d198eac1",
            "preProcessors": [],
            "postProcessors": [],
            "source": "api",
            "input": [
                {
                    "endpoint": "materials",
                    "endpoint_options": {
                        "params": {
                            "query": "{'_id': SLAB.metadata.bulkId}",
                            "projection": "{}"
                        }
                    },
                    "name": "DATA"
                }
            ],
            "next": "b70656f1-a394-57f4-b4de-00096969df4b",
            "application": {
                "name": "espresso",
                "shortName": "qe",
                "summary": "Quantum ESPRESSO",
                "build": "GNU",
                "hasAdvancedComputeOptions": true,
                "isDefault": true,
                "version": "6.3",
                "schemaVersion": "2022.8.16"
            },
            "status": "idle",
            "statusTrack": [],
            "tags": []
        },
        {
            "name": "bulk",
            "type": "assignment",
            "operand": "BULK",
            "value": "DATA[0] if DATA else None",
            "input": [
                {
                    "name": "DATA",
                    "scope": "44263820-0c80-5bd1-b854-9da8d198eac1"
                }
            ],
            "head": false,
            "results": [],
            "monitors": [],
            "flowchartId": "b70656f1-a394-57f4-b4de-00096969df4b",
            "preProcessors": [],
            "postProcessors": [],
            "next": "6ca4006a-e3ae-56ea-91a1-06b9790b5f7e",
            "application": {
                "name": "espresso",
                "shortName": "qe",
                "summary": "Quantum ESPRESSO",
                "build": "GNU",
                "hasAdvancedComputeOptions": true,
                "isDefault": true,
                "version": "6.3",
                "schemaVersion": "2022.8.16"
            },
            "status": "idle",
            "statusTrack": [],
            "tags": []
        },
        {
            "name": "assert-bulk",
            "type": "assertion",
            "statement": "BULK != None",
            "errorMessage": "Bulk material does not exist!",
            "head": false,
            "results": [],
            "monitors": [],
            "flowchartId": "6ca4006a-e3ae-56ea-91a1-06b9790b5f7e",
            "preProcessors": [],
            "postProcessors": [],
            "next": "490635e0-c593-5809-9eb2-c794b96cfed1",
            "application": {
                "name": "espresso",
                "shortName": "qe",
                "summary": "Quantum ESPRESSO",
                "build": "GNU",
                "hasAdvancedComputeOptions": true,
                "isDefault": true,
                "version": "6.3",
                "schemaVersion": "2022.8.16"
            },
            "status": "idle",
            "statusTrack": [],
            "tags": []
        },
        {
            "name": "io-e-bulk",
            "type": "io",
            "subtype": "input",
            "head": false,
            "results": [],
            "monitors": [],
            "flowchartId": "490635e0-c593-5809-9eb2-c794b96cfed1",
            "preProcessors": [],
            "postProcessors": [],
            "source": "api",
            "input": [
                {
                    "endpoint": "refined-properties",
                    "endpoint_options": {
                        "params": {
                            "query": "{ 'exabyteId': BULK.exabyteId, 'data.name': 'total_energy', 'group': {'$regex': ''.join((SUBWORKFLOW.application.shortName, ':'))} }",
                            "projection": "{'sort': {'precision.value': -1}, 'limit': 1}"
                        }
                    },
                    "name": "DATA"
                }
            ],
            "next": "bbe13b97-4243-5a85-8f61-a279d0b797aa",
            "application": {
                "name": "espresso",
                "shortName": "qe",
                "summary": "Quantum ESPRESSO",
                "build": "GNU",
                "hasAdvancedComputeOptions": true,
                "isDefault": true,
                "version": "6.3",
                "schemaVersion": "2022.8.16"
            },
            "status": "idle",
            "statusTrack": [],
            "tags": []
        },
        {
            "name": "e-bulk",
            "type": "assignment",
            "operand": "E_BULK",
            "value": "DATA[0].data.value if DATA else None",
            "input": [
                {
                    "name": "DATA",
                    "scope": "490635e0-c593-5809-9eb2-c794b96cfed1"
                }
            ],
            "head": false,
            "results": [],
            "monitors": [],
            "flowchartId": "bbe13b97-4243-5a85-8f61-a279d0b797aa",
            "preProcessors": [],
            "postProcessors": [],
            "next": "a06c9f43-7670-5fd0-ac42-7028a472235a",
            "application": {
                "name": "espresso",
                "shortName": "qe",
                "summary": "Quantum ESPRESSO",
                "build": "GNU",
                "hasAdvancedComputeOptions": true,
                "isDefault": true,
                "version": "6.3",
                "schemaVersion": "2022.8.16"
            },
            "status": "idle",
            "statusTrack": [],
            "tags": []
        },
        {
            "name": "assert-e-bulk",
            "type": "assertion",
            "statement": "E_BULK != None",
            "errorMessage": "E_BULK does not exist!",
            "head": false,
            "results": [],
            "monitors": [],
            "flowchartId": "a06c9f43-7670-5fd0-ac42-7028a472235a",
            "preProcessors": [],
            "postProcessors": [],
            "next": "cdf210be-26ed-585a-b4ac-d55795ba2975",
            "application": {
                "name": "espresso",
                "shortName": "qe",
                "summary": "Quantum ESPRESSO",
                "build": "GNU",
                "hasAdvancedComputeOptions": true,
                "isDefault": true,
                "version": "6.3",
                "schemaVersion": "2022.8.16"
            },
            "status": "idle",
            "statusTrack": [],
            "tags": []
        },
        {
            "name": "surface",
            "type": "assignment",
            "operand": "A",
            "value": "np.linalg.norm(np.cross(SLAB.lattice.vectors.a, SLAB.lattice.vectors.b))",
            "input": [],
            "head": false,
            "results": [],
            "monitors": [],
            "flowchartId": "cdf210be-26ed-585a-b4ac-d55795ba2975",
            "preProcessors": [],
            "postProcessors": [],
            "next": "ffa8e43d-096a-555b-b8d0-6d283365ef47",
            "application": {
                "name": "espresso",
                "shortName": "qe",
                "summary": "Quantum ESPRESSO",
                "build": "GNU",
                "hasAdvancedComputeOptions": true,
                "isDefault": true,
                "version": "6.3",
                "schemaVersion": "2022.8.16"
            },
            "status": "idle",
            "statusTrack": [],
            "tags": []
        },
        {
            "name": "n-bulk",
            "type": "assignment",
            "operand": "N_BULK",
            "value": "len(BULK.basis.elements)",
            "input": [],
            "head": false,
            "results": [],
            "monitors": [],
            "flowchartId": "ffa8e43d-096a-555b-b8d0-6d283365ef47",
            "preProcessors": [],
            "postProcessors": [],
            "next": "a0336ec5-a6da-5e4c-bb48-82b70cf5245f",
            "application": {
                "name": "espresso",
                "shortName": "qe",
                "summary": "Quantum ESPRESSO",
                "build": "GNU",
                "hasAdvancedComputeOptions": true,
                "isDefault": true,
                "version": "6.3",
                "schemaVersion": "2022.8.16"
            },
            "status": "idle",
            "statusTrack": [],
            "tags": []
        },
        {
            "name": "n-slab",
            "type": "assignment",
            "operand": "N_SLAB",
            "value": "len(SLAB.basis.elements)",
            "input": [],
            "head": false,
            "results": [],
            "monitors": [],
            "flowchartId": "a0336ec5-a6da-5e4c-bb48-82b70cf5245f",
            "preProcessors": [],
            "postProcessors": [],
            "next": "9fc7a088-5533-5f70-bb33-f676ec65f565",
            "application": {
                "name": "espresso",
                "shortName": "qe",
                "summary": "Quantum ESPRESSO",
                "build": "GNU",
                "hasAdvancedComputeOptions": true,
                "isDefault": true,
                "version": "6.3",
                "schemaVersion": "2022.8.16"
            },
            "status": "idle",
            "statusTrack": [],
            "tags": []
        },
        {
            "type": "execution",
            "name": "pw_scf",
            "head": false,
            "results": [
                {
                    "name": "atomic_forces"
                },
                {
                    "name": "fermi_energy"
                },
                {
                    "name": "pressure"
                },
                {
                    "name": "stress_tensor"
                },
                {
                    "name": "total_energy"
                },
                {
                    "name": "total_energy_contributions"
                },
                {
                    "name": "total_force"
                }
            ],
            "monitors": [
                {
                    "name": "standard_output"
                },
                {
                    "name": "convergence_electronic"
                }
            ],
            "flowchartId": "9fc7a088-5533-5f70-bb33-f676ec65f565",
            "preProcessors": [],
            "postProcessors": [],
            "application": {
                "name": "espresso",
                "shortName": "qe",
                "summary": "Quantum ESPRESSO",
                "build": "GNU",
                "hasAdvancedComputeOptions": true,
                "isDefault": true,
                "version": "6.3",
                "schemaVersion": "2022.8.16"
            },
            "executable": {
                "hasAdvancedComputeOptions": true,
                "isDefault": true,
                "monitors": [
                    "standard_output",
                    "convergence_ionic",
                    "convergence_electronic"
                ],
                "postProcessors": [
                    "remove_non_zero_weight_kpoints"
                ],
                "name": "pw.x",
                "schemaVersion": "2022.8.16"
            },
            "flavor": {
                "applicationName": "espresso",
                "executableName": "pw.x",
                "input": [
                    {
                        "name": "pw_scf.in"
                    }
                ],
                "isDefault": true,
                "monitors": [
                    "standard_output",
                    "convergence_electronic"
                ],
                "results": [
                    "atomic_forces",
                    "fermi_energy",
                    "pressure",
                    "stress_tensor",
                    "total_energy",
                    "total_energy_contributions",
                    "total_force"
                ],
                "name": "pw_scf",
                "schemaVersion": "2022.8.16"
            },
            "status": "idle",
            "statusTrack": [],
            "tags": [],
            "input": [
                {
                    "applicationName": "espresso",
                    "content": "{% if subworkflowContext.MATERIAL_INDEX %}\n{%- set input = input.perMaterial[subworkflowContext.MATERIAL_INDEX] -%}\n{% endif -%}\n&CONTROL\n    calculation = 'scf'\n    title = ''\n    verbosity = 'low'\n    restart_mode = '{{ input.RESTART_MODE }}'\n    wf_collect = .true.\n    tstress = .true.\n    tprnfor = .true.\n    outdir = {% raw %}'{{ JOB_WORK_DIR }}/outdir'{% endraw %}\n    wfcdir = {% raw %}'{{ JOB_WORK_DIR }}/outdir'{% endraw %}\n    prefix = '__prefix__'\n    pseudo_dir = {% raw %}'{{ JOB_WORK_DIR }}/pseudo'{% endraw %}\n/\n&SYSTEM\n    ibrav = {{ input.IBRAV }}\n    nat = {{ input.NAT }}\n    ntyp = {{ input.NTYP }}\n    ecutwfc = {{ cutoffs.wavefunction }}\n    ecutrho = {{ cutoffs.density }}\n    occupations = 'smearing'\n    degauss = 0.005\n/\n&ELECTRONS\n    diagonalization = 'david'\n    diago_david_ndim = 4\n    diago_full_acc = .true.\n    mixing_beta = 0.3\n    startingwfc = 'atomic+random'\n/\n&IONS\n/\n&CELL\n/\nATOMIC_SPECIES\n{{ input.ATOMIC_SPECIES }}\nATOMIC_POSITIONS crystal\n{{ input.ATOMIC_POSITIONS }}\nCELL_PARAMETERS angstrom\n{{ input.CELL_PARAMETERS }}\nK_POINTS automatic\n{% for d in kgrid.dimensions %}{{d}} {% endfor %}{% for s in kgrid.shifts %}{{s}} {% endfor %}\n",
                    "contextProviders": [
                        {
                            "name": "KGridFormDataManager"
                        },
                        {
                            "name": "QEPWXInputDataManager"
                        },
                        {
                            "name": "PlanewaveCutoffDataManager"
                        }
                    ],
                    "executableName": "pw.x",
                    "name": "pw_scf.in",
                    "rendered": "&CONTROL\n    calculation = 'scf'\n    title = ''\n    verbosity = 'low'\n    restart_mode = 'from_scratch'\n    wf_collect = .true.\n    tstress = .true.\n    tprnfor = .true.\n    outdir = '{{ JOB_WORK_DIR }}/outdir'\n    wfcdir = '{{ JOB_WORK_DIR }}/outdir'\n    prefix = '__prefix__'\n    pseudo_dir = '{{ JOB_WORK_DIR }}/pseudo'\n/\n&SYSTEM\n    ibrav = 0\n    nat = 2\n    ntyp = 1\n    ecutwfc = 40\n    ecutrho = 200\n    occupations = 'smearing'\n    degauss = 0.005\n/\n&ELECTRONS\n    diagonalization = 'david'\n    diago_david_ndim = 4\n    diago_full_acc = .true.\n    mixing_beta = 0.3\n    startingwfc = 'atomic+random'\n/\n&IONS\n/\n&CELL\n/\nATOMIC_SPECIES\nSi 28.0855 \nATOMIC_POSITIONS crystal\nSi     0.000000000    0.000000000    0.000000000 \nSi     0.250000000    0.250000000    0.250000000 \nCELL_PARAMETERS angstrom\n3.348920236 0.000000000 1.933500000\n1.116306745 3.157392278 1.933500000\n0.000000000 0.000000000 3.867000000\nK_POINTS automatic\n2 2 2 0 0 0 \n",
                    "schemaVersion": "2022.8.16"
                }
            ],
            "next": "fcd88119-817c-5ac1-a430-ba892ac743eb"
        },
        {
            "name": "e-slab",
            "type": "assignment",
            "operand": "E_SLAB",
            "value": "total_energy",
            "input": [
                {
                    "name": "total_energy",
                    "scope": "9fc7a088-5533-5f70-bb33-f676ec65f565"
                }
            ],
            "head": false,
            "results": [],
            "monitors": [],
            "flowchartId": "fcd88119-817c-5ac1-a430-ba892ac743eb",
            "preProcessors": [],
            "postProcessors": [],
            "next": "542ea9ad-8a07-5a76-b233-f72fb27c4fc6",
            "application": {
                "name": "espresso",
                "shortName": "qe",
                "summary": "Quantum ESPRESSO",
                "build": "GNU",
                "hasAdvancedComputeOptions": true,
                "isDefault": true,
                "version": "6.3",
                "schemaVersion": "2022.8.16"
            },
            "status": "idle",
            "statusTrack": [],
            "tags": []
        },
        {
            "name": "surface-energy",
            "type": "assignment",
            "operand": "SURFACE_ENERGY",
            "value": "1 / (2 * A) * (E_SLAB - E_BULK * (N_SLAB/N_BULK))",
            "input": [],
            "head": false,
            "results": [
                {
                    "name": "surface_energy"
                }
            ],
            "monitors": [],
            "flowchartId": "542ea9ad-8a07-5a76-b233-f72fb27c4fc6",
            "preProcessors": [],
            "postProcessors": [],
            "application": {
                "name": "espresso",
                "shortName": "qe",
                "summary": "Quantum ESPRESSO",
                "build": "GNU",
                "hasAdvancedComputeOptions": true,
                "isDefault": true,
                "version": "6.3",
                "schemaVersion": "2022.8.16"
            },
            "status": "idle",
            "statusTrack": [],
            "tags": []
        }
    ]
}
