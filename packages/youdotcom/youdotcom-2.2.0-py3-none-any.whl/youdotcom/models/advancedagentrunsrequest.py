"""Code generated by Speakeasy (https://speakeasy.com). DO NOT EDIT."""

from __future__ import annotations
from .computetool import ComputeTool, ComputeToolTypedDict
from .researchtool import ResearchTool, ResearchToolTypedDict
from .verbosity import Verbosity
import pydantic
from pydantic import Field, model_serializer
from pydantic.functional_validators import AfterValidator
from typing import List, Literal, Optional, Union
from typing_extensions import Annotated, NotRequired, TypeAliasType, TypedDict
from youdotcom.types import BaseModel, UNSET_SENTINEL
from youdotcom.utils import validate_const


ToolTypedDict = TypeAliasType(
    "ToolTypedDict", Union[ComputeToolTypedDict, ResearchToolTypedDict]
)


Tool = Annotated[Union[ComputeTool, ResearchTool], Field(discriminator="TYPE")]


class WorkflowConfigTypedDict(TypedDict):
    r"""Defines the maximum number of steps the agent uses in its workflow plan to answer your query. Higher values allow for more tool calls, but it takes longer for the agent to provide the response. For instance, setting max_workflow_steps=5 could allow the agent to call the research tool 3 times and the compute tool 2 times."""

    max_workflow_steps: NotRequired[int]


class WorkflowConfig(BaseModel):
    r"""Defines the maximum number of steps the agent uses in its workflow plan to answer your query. Higher values allow for more tool calls, but it takes longer for the agent to provide the response. For instance, setting max_workflow_steps=5 could allow the agent to call the research tool 3 times and the compute tool 2 times."""

    max_workflow_steps: Optional[int] = 10

    @model_serializer(mode="wrap")
    def serialize_model(self, handler):
        optional_fields = set(["max_workflow_steps"])
        serialized = handler(self)
        m = {}

        for n, f in type(self).model_fields.items():
            k = f.alias or n
            val = serialized.get(k)

            if val != UNSET_SENTINEL:
                if val is not None or k not in optional_fields:
                    m[k] = val

        return m


class AdvancedAgentRunsRequestTypedDict(TypedDict):
    input: str
    r"""The question you'd like to ask the agent"""
    agent: Literal["advanced"]
    r"""Setting this value to \"advanced\" is mandatory to use the advanced agent."""
    stream: NotRequired[bool]
    r"""Must be set to `true` when you want to stream the agent response as it's being generated, and `false` when you want the response to return after the agent has finished."""
    tools: NotRequired[List[ToolTypedDict]]
    r"""The advanced agent accepts either `compute` or `research` tools <Note> Compute allows your agent to use a Python code interpreter for tasks such as data analysis, mathematical calculations, and plot generation.<br><br> Research iteratively searches the web, analyzes the results, and stops when finished. It then provides a comprehensive report to your agent with current, cited information.</Note>"""
    verbosity: NotRequired[Verbosity]
    r"""Controls the level of detail provided by the agent's response. Choosing high maps to a long-form report while medium maps to a medium verbosity report that captures most details but is less comprehensive."""
    workflow_config: NotRequired[WorkflowConfigTypedDict]
    r"""Defines the maximum number of steps the agent uses in its workflow plan to answer your query. Higher values allow for more tool calls, but it takes longer for the agent to provide the response. For instance, setting max_workflow_steps=5 could allow the agent to call the research tool 3 times and the compute tool 2 times."""


class AdvancedAgentRunsRequest(BaseModel):
    input: str
    r"""The question you'd like to ask the agent"""

    AGENT: Annotated[
        Annotated[Literal["advanced"], AfterValidator(validate_const("advanced"))],
        pydantic.Field(alias="agent"),
    ] = "advanced"
    r"""Setting this value to \"advanced\" is mandatory to use the advanced agent."""

    stream: Optional[bool] = False
    r"""Must be set to `true` when you want to stream the agent response as it's being generated, and `false` when you want the response to return after the agent has finished."""

    tools: Optional[List[Tool]] = None
    r"""The advanced agent accepts either `compute` or `research` tools <Note> Compute allows your agent to use a Python code interpreter for tasks such as data analysis, mathematical calculations, and plot generation.<br><br> Research iteratively searches the web, analyzes the results, and stops when finished. It then provides a comprehensive report to your agent with current, cited information.</Note>"""

    verbosity: Optional[Verbosity] = None
    r"""Controls the level of detail provided by the agent's response. Choosing high maps to a long-form report while medium maps to a medium verbosity report that captures most details but is less comprehensive."""

    workflow_config: Optional[WorkflowConfig] = None
    r"""Defines the maximum number of steps the agent uses in its workflow plan to answer your query. Higher values allow for more tool calls, but it takes longer for the agent to provide the response. For instance, setting max_workflow_steps=5 could allow the agent to call the research tool 3 times and the compute tool 2 times."""

    @model_serializer(mode="wrap")
    def serialize_model(self, handler):
        optional_fields = set(["stream", "tools", "verbosity", "workflow_config"])
        serialized = handler(self)
        m = {}

        for n, f in type(self).model_fields.items():
            k = f.alias or n
            val = serialized.get(k)

            if val != UNSET_SENTINEL:
                if val is not None or k not in optional_fields:
                    m[k] = val

        return m
