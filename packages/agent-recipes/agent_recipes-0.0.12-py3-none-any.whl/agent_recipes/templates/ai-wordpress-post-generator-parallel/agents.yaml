framework: praisonai
topic: "AI News {{today}}"

# Variables section - today is populated by get_current_date tool
variables:
  today: "January 2026"  # Default fallback, overridden by get_current_date

# =============================================================================
# AI BLOG POST GENERATOR - PARALLEL MULTI-TOPIC PIPELINE
# =============================================================================
# 
# HOW IT WORKS:
# 1. Gather AI news topics (ai-topic-gatherer)
# 2. Filter duplicates, generate keywords, research (ai-research-pipeline)
# 3. Write blog posts with SEO-optimized titles
# 4. Publish to WordPress (wordpress-publisher)
#
# USES MODULAR RECIPES:
# - include: ai-topic-gatherer
# - include: ai-research-pipeline
# - include: wordpress-publisher
# =============================================================================

agents:
  # Agent that writes blog posts with SEO-optimized titles
  content_writer:
    role: SEO Content Strategist and Technology Journalist
    goal: Write focused, SEO-optimized blog posts with specific, searchable titles
    backstory: |
      You MUST use correct Gutenberg block format where content is inside HTML tags.
      You write about ONE topic only - never combine multiple news items.
      You use British English (colour, centre, organisation).
      
      TITLE RULES (SEO-CRITICAL):
      - Include SPECIFIC names: company, product, person, or technology
      - Include SPECIFIC details: version numbers, dates, locations
      - NEVER use generic words like "Insights", "Findings", "Overview", "Guide"
      - BAD: "Insights on Multi-Agent Systems Research Findings"
      - GOOD: "Google DeepMind Releases Gemini 2.0 with Real-Time Reasoning"
      - GOOD: "OpenAI GPT-5 Launch Date Confirmed for March 2026"
      - GOOD: "Tesla Optimus Robot Begins Factory Deployment in Austin"

steps:
  # ─────────────────────────────────────────────────────────────────────────────
  # STEP 1: Gather topics (modular recipe)
  # ─────────────────────────────────────────────────────────────────────────────
  - include: ai-topic-gatherer

  # ─────────────────────────────────────────────────────────────────────────────
  # STEP 2-4: Filter duplicates, generate keywords, research (modular recipe)
  # ─────────────────────────────────────────────────────────────────────────────
  - include: ai-research-pipeline

  # ─────────────────────────────────────────────────────────────────────────────
  # STEP 5: Write blog posts IN PARALLEL with SEO-optimized titles
  # ─────────────────────────────────────────────────────────────────────────────
  - loop:
      over: research_results
      parallel: true
      max_workers: 4
    agent: content_writer
    output_json:
      type: object
      properties:
        title:
          type: string
          description: SEO-optimized title with specific names/dates (6-10 words, no colons)
        content:
          type: string
          description: Full Gutenberg block formatted content
    action: |
      ═══════════════════════════════════════════════════════════════════════
      RESEARCH CONTENT TO CONVERT (USE ALL OF THIS - DO NOT SKIP ANY SECTION)
      ═══════════════════════════════════════════════════════════════════════
      
      {{item}}
      
      ═══════════════════════════════════════════════════════════════════════
      CRITICAL INSTRUCTIONS
      ═══════════════════════════════════════════════════════════════════════
      
      1. INCLUDE ALL content from the research - DO NOT skip ANY section
      
      2. BE LESS DESCRIPTIVE - focus on facts and information
         - Minimal explanatory text
         - Short paragraphs
      
      3. PROGRESSIVE STRUCTURE - start simple, build to complex
         - Begin with key announcement/news
         - Then details and specifications
         - Then analysis and implications
         - Finally future outlook
      
      ═══════════════════════════════════════════════════════════════════════
      WORDPRESS GUTENBERG BLOCKS REFERENCE
      ═══════════════════════════════════════════════════════════════════════
      
      ✅ PARAGRAPH:
      <!-- wp:paragraph -->
      <p>Your paragraph text goes here inside the p tags.</p>
      <!-- /wp:paragraph -->
      
      ✅ HEADING (h2):
      <!-- wp:heading -->
      <h2 class="wp-block-heading">Your Heading Text</h2>
      <!-- /wp:heading -->
      
      ✅ HEADING (h3):
      <!-- wp:heading {"level":3} -->
      <h3 class="wp-block-heading">Subheading Text</h3>
      <!-- /wp:heading -->
      
      ✅ LIST (unordered):
      <!-- wp:list -->
      <ul class="wp-block-list">
      <li>First item</li>
      <li>Second item</li>
      </ul>
      <!-- /wp:list -->
      
      ✅ QUOTE:
      <!-- wp:quote -->
      <blockquote class="wp-block-quote"><p>Quote text here.</p></blockquote>
      <!-- /wp:quote -->
      
      ✅ TABLE:
      <!-- wp:table -->
      <figure class="wp-block-table"><table>
      <thead><tr><th>Header</th></tr></thead>
      <tbody><tr><td>Data</td></tr></tbody>
      </table></figure>
      <!-- /wp:table -->
      
      ═══════════════════════════════════════════════════════════════════════
      CRITICAL RULES
      ═══════════════════════════════════════════════════════════════════════
      
      1. ONE TOPIC ONLY - do NOT combine multiple news stories
      2. Content MUST be inside HTML tags (<p>, <h2>, <ul>, etc.)
      3. Title should be 6-10 words, NO colons
      4. Use British English (colour, centre, organisation)
      5. Include ALL numbers, stats, and tables from research
      
      OUTPUT FORMAT:
      ARTICLE_TITLE: [Title about this topic]
      ARTICLE_CONTENT:
      <!-- wp:paragraph -->
      <p>Opening paragraph...</p>
      <!-- /wp:paragraph -->
      ...more blocks...
    expected_output: |
      ARTICLE_TITLE: focused title
      ARTICLE_CONTENT: Gutenberg blocks with content inside HTML tags

  # ─────────────────────────────────────────────────────────────────────────────
  # STEP 6: Publish to WordPress
  # ─────────────────────────────────────────────────────────────────────────────
  - include: wordpress-publisher

# Enable smart context management with aggressive summarization for parallel workflows
context:
  enabled: true
  auto_compact: true
  compact_threshold: 0.6
  strategy: smart
  llm_summarize: true
  smart_tool_summarize: true
  max_tool_output_tokens: 2000
  tool_summarize_limits:
    tavily_search: 1000
    tavily_extract: 1500