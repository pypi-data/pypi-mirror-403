"""Malware Scan Info object."""

from __future__ import annotations

from typing import TYPE_CHECKING

from pydantic import Field

from ocsf._base import OCSFBaseModel

if TYPE_CHECKING:
    from ocsf.v1_5_0.enums.type_id import TypeId


class MalwareScanInfo(OCSFBaseModel):
    """The malware scan information object describes characteristics, metadata of a malware scanning job.

    See: https://schema.ocsf.io/1.5.0/objects/malware_scan_info
    """

    type_id: TypeId = Field(..., description="The type id of the scan.")
    end_time: int | None = Field(
        default=None, description="The timestamp indicating when the scan job completed execution."
    )
    name: str | None = Field(
        default=None,
        description='The administrator-supplied or application-generated name of the scan. For example: "Home office weekly user database scan", "Scan folders for viruses", "Full system virus scan"',
    )
    num_files: int | None = Field(
        default=None, description="The total number of files analyzed during the scan."
    )
    num_infected: int | None = Field(
        default=None,
        description="The total number of files identified as infected with malware during the scan.",
    )
    num_volumes: int | None = Field(
        default=None,
        description="The total number of storage volumes examined during the malware scan.",
    )
    size: int | None = Field(
        default=None, description="The total size in bytes of all files that were scanned."
    )
    start_time: int | None = Field(
        default=None, description="The timestamp indicating when the scan job began execution."
    )
    type_: str | None = Field(default=None, description="The type of scan.")
    uid: str | None = Field(
        default=None,
        description="The application-defined unique identifier assigned to an instance of a scan.",
    )
    unique_malware_count: int | None = Field(
        default=None, description="The number of unique malware detected across all infected files."
    )
