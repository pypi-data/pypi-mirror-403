"""Malware object."""

from __future__ import annotations

from typing import TYPE_CHECKING, Any

from pydantic import Field

from ocsf._base import OCSFBaseModel

if TYPE_CHECKING:
    from ocsf.v1_7_0.enums.classification_ids import ClassificationIds
    from ocsf.v1_7_0.enums.severity_id import SeverityId
    from ocsf.v1_7_0.objects.cve import Cve
    from ocsf.v1_7_0.objects.file import File


class Malware(OCSFBaseModel):
    """The Malware object describes the classification of known malicious software, which is intentionally designed to cause damage to a computer, server, client, or computer network.

    See: https://schema.ocsf.io/1.7.0/objects/malware
    """

    classification_ids: list[ClassificationIds] = Field(
        ..., description="The list of normalized identifiers of the malware classifications."
    )
    classifications: list[str] | None = Field(
        default=None,
        description="The list of malware classifications, normalized to the captions of the <code>classification_ids</code> values. In the case of 'Other', they are defined by the event source.",
    )
    cves: list[Cve] | None = Field(
        default=None,
        description="The list of Common Vulnerabilities and Exposures (CVE) identifiers associated with the malware. Reference: <a target='_blank' href='https://cve.mitre.org/'>CVE</a>",
    )
    files: list[File] | None = Field(
        default=None,
        description="The list of file objects representing files that were identified as infected by the malware.",
    )
    name: str | None = Field(
        default=None, description="The malware name, as reported by the detection engine."
    )
    num_infected: int | None = Field(
        default=None,
        description="The number of files that were identified to be infected by the malware.",
    )
    path: Any | None = Field(
        default=None,
        description="The filesystem path of the malware that was observed. [Recommended]",
    )
    provider: str | None = Field(
        default=None,
        description="The name or identifier of the security solution or service that provided the malware detection information. [Recommended]",
    )
    severity: str | None = Field(
        default=None,
        description="The severity of the malware, normalized to the captions of the <code>severity_id</code> values. In the case of 'Other', they are defined by the event source.",
    )
    severity_id: SeverityId | None = Field(
        default=None, description="The normalized identifier of the malware severity. [Recommended]"
    )
    uid: str | None = Field(
        default=None,
        description="A unique identifier for the specific malware instance, as assigned by the detection engine (e.g., virus signature ID or IPS rule ID).",
    )
