"""Finding object."""

from __future__ import annotations

from typing import TYPE_CHECKING, Any

from pydantic import Field

from ocsf._base import OCSFBaseModel

if TYPE_CHECKING:
    from ocsf.v1_7_0.objects.product import Product
    from ocsf.v1_7_0.objects.related_event import RelatedEvent
    from ocsf.v1_7_0.objects.remediation import Remediation


class Finding(OCSFBaseModel):
    """The Finding object describes metadata related to a security finding generated by a security tool or system.

    See: https://schema.ocsf.io/1.7.0/objects/finding
    """

    title: str = Field(
        ..., description="A title or a brief phrase summarizing the reported finding."
    )
    uid: str = Field(..., description="The unique identifier of the reported finding.")
    created_time: int | None = Field(
        default=None, description="The time when the finding was created."
    )
    desc: str | None = Field(default=None, description="The description of the reported finding.")
    first_seen_time: int | None = Field(
        default=None, description="The time when the finding was first observed."
    )
    last_seen_time: int | None = Field(
        default=None, description="The time when the finding was most recently observed."
    )
    modified_time: int | None = Field(
        default=None, description="The time when the finding was last modified."
    )
    product: Product | None = Field(
        default=None, description="Details about the product that reported the finding."
    )
    product_uid: str | None = Field(
        default=None, description="The unique identifier of the product that reported the finding."
    )
    related_events: list[RelatedEvent] | None = Field(
        default=None,
        description="Describes events and/or other findings related to the finding as identified by the security product. Note that these events may or may not be in OCSF.",
    )
    remediation: Remediation | None = Field(
        default=None,
        description="Describes the recommended remediation steps to address identified issue(s).",
    )
    src_url: Any | None = Field(
        default=None, description="The URL pointing to the source of the finding."
    )
    supporting_data: dict[str, Any] | None = Field(
        default=None,
        description="Additional data supporting a finding as provided by security tool",
    )
    types: list[str] | None = Field(
        default=None, description="One or more types of the reported finding."
    )
