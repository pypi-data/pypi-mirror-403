"""Vulnerability Details object."""

from __future__ import annotations

from typing import TYPE_CHECKING

from pydantic import Field

from ocsf._base import OCSFBaseModel

if TYPE_CHECKING:
    from ocsf.v1_0_0.objects.cve import Cve
    from ocsf.v1_0_0.objects.package import Package


class Vulnerability(OCSFBaseModel):
    """The Vulnerability Details object describes characteristics of an observed vulnerability.

    See: https://schema.ocsf.io/1.0.0/objects/vulnerability
    """

    cve: Cve = Field(
        ...,
        description="The Common Vulnerabilities and Exposures (<a target='_blank' href='https://cve.mitre.org/'>CVE</a>).",
    )
    desc: str | None = Field(default=None, description="The description of the vulnerability.")
    fix_available: bool | None = Field(
        default=None, description="Indicates if a fix is available for the reported vulnerability."
    )
    kb_articles: list[str] | None = Field(
        default=None, description="The KB article/s related to the entity"
    )
    packages: list[Package] | None = Field(
        default=None,
        description="List of vulnerable packages as identified by the security product",
    )
    references: list[str] | None = Field(
        default=None, description="Supporting reference URLs [Recommended]"
    )
    related_vulnerabilities: list[str] | None = Field(
        default=None,
        description="List of vulnerabilities that are related to this vulnerability. [Recommended]",
    )
    severity: str | None = Field(
        default=None,
        description="The event severity, normalized to the caption of the severity_id value. In the case of 'Other', it is defined by the event source.",
    )
    title: str | None = Field(default=None, description="The title of the vulnerability.")
    vendor_name: str | None = Field(
        default=None, description="The vendor who identified the vulnerability."
    )
