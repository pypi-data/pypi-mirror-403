"""Finding Information object."""

from __future__ import annotations

from typing import TYPE_CHECKING, Any

from pydantic import Field

from ocsf._base import OCSFBaseModel

if TYPE_CHECKING:
    from ocsf.v1_1_0.objects.analytic import Analytic
    from ocsf.v1_1_0.objects.attack import Attack
    from ocsf.v1_1_0.objects.kill_chain_phase import KillChainPhase
    from ocsf.v1_1_0.objects.related_event import RelatedEvent


class FindingInfo(OCSFBaseModel):
    """The Finding Information object describes metadata related to a security finding generated by a security tool or system.

    See: https://schema.ocsf.io/1.1.0/objects/finding_info
    """

    title: str = Field(
        ..., description="A title or a brief phrase summarizing the reported finding."
    )
    uid: str = Field(..., description="The unique identifier of the reported finding.")
    analytic: Analytic | None = Field(
        default=None,
        description="The analytic technique used to analyze and derive insights from the data or information that led to the finding or conclusion. [Recommended]",
    )
    attacks: list[Attack] | None = Field(
        default=None,
        description="The <a target='_blank' href='https://attack.mitre.org'>MITRE ATT&CK®</a> technique and associated tactics related to the finding.",
    )
    created_time: int | None = Field(
        default=None, description="The time when the finding was created."
    )
    data_sources: list[str] | None = Field(
        default=None, description="A list of data sources utilized in generation of the finding."
    )
    desc: str | None = Field(default=None, description="The description of the reported finding.")
    first_seen_time: int | None = Field(
        default=None,
        description="The time when the finding was first observed. e.g. The time when a vulnerability was first observed. <p>It can differ from the <code>created_time</code> timestamp, which reflects the time this finding was created.</p>",
    )
    kill_chain: list[KillChainPhase] | None = Field(
        default=None,
        description="The <a target='_blank' href='https://www.lockheedmartin.com/en-us/capabilities/cyber/cyber-kill-chain.html'>Cyber Kill Chain®</a> provides a detailed description of each phase and its associated activities within the broader context of a cyber attack.",
    )
    last_seen_time: int | None = Field(
        default=None,
        description="The time when the finding was most recently observed. e.g. The time when a vulnerability was most recently observed. <p>It can differ from the <code>modified_time</code> timestamp, which reflects the time this finding was last modified.</p>",
    )
    modified_time: int | None = Field(
        default=None, description="The time when the finding was last modified."
    )
    product_uid: str | None = Field(
        default=None, description="The unique identifier of the product that reported the finding."
    )
    related_analytics: list[Analytic] | None = Field(
        default=None, description="Other analytics related to this finding."
    )
    related_events: list[RelatedEvent] | None = Field(
        default=None,
        description="Describes events and/or other findings related to the finding as identified by the security product.",
    )
    src_url: Any | None = Field(
        default=None, description="The URL pointing to the source of the finding."
    )
    types: list[str] | None = Field(
        default=None, description="One or more types of the reported finding."
    )
