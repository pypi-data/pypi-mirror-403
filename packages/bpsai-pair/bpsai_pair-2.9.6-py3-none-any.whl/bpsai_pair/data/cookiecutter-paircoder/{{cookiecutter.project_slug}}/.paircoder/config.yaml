version: "2.9.3"
project:
  name: "{{ cookiecutter.project_slug }}"
  description: "{{ cookiecutter.project_name }}"
  primary_goal: "{{ cookiecutter.primary_goal }}"
  coverage_target: {{ cookiecutter.coverage_target | replace('%', '') }}
workflow:
  default_branch_type: "feature"
  main_branch: "main"
  context_dir: ".paircoder/context"
  plans_dir: ".paircoder/plans"
  tasks_dir: ".paircoder/tasks"
  skills_dir: ".claude/skills"
pack:
  default_name: "agent_pack.tgz"
  excludes:
    - ".git"
    - ".venv"
    - "__pycache__"
    - "node_modules"
    - "dist"
    - "build"
    - "*.log"
    - "*.bak"
    - "*.egg-info"
models:
  # Role-based model assignment
  navigator: claude-sonnet-4-5
  driver: claude-sonnet-4-5
  reviewer: claude-sonnet-4-5
  providers:
    anthropic:
      models:
        - claude-opus-4-5
        - claude-sonnet-4-5
        - claude-haiku-4-5
      default_effort: medium
    openai:
      models:
        - gpt-5.1-codex-max
        - gpt-5.1-codex
        - gpt-5.1-codex-mini
    google:
      models:
        - gemini-3-pro
        - gemini-3-deep-think
routing:
  by_complexity:
    trivial:
      max_score: 20
      model: claude-haiku-4-5
    simple:
      max_score: 40
      model: claude-haiku-4-5
    moderate:
      max_score: 60
      model: claude-sonnet-4-5
    complex:
      max_score: 80
      model: claude-opus-4-5
    epic:
      max_score: 100
      model: claude-opus-4-5
  overrides:
    security: claude-opus-4-5
    architecture: claude-opus-4-5
# Skills (flows are deprecated - use .claude/skills/ instead)
skills:
  enabled:
    - designing-and-implementing
    - implementing-with-tdd
    - reviewing-code
    - finishing-branches
    - managing-task-lifecycle
    - planning-with-trello
  triggers:
    feature_request:
      - designing-and-implementing
    bugfix:
      - implementing-with-tdd
    pre_merge:
      - reviewing-code
      - finishing-branches
metrics:
  enabled: true
  store_path: .paircoder/history/metrics.jsonl
estimation:
  complexity_to_hours:
    xs:
      range: [0, 15]
      hours: [0.5, 1.0, 2.0]
    s:
      range: [16, 30]
      hours: [1.0, 2.0, 4.0]
    m:
      range: [31, 50]
      hours: [2.0, 4.0, 8.0]
    l:
      range: [51, 75]
      hours: [4.0, 8.0, 16.0]
    xl:
      range: [76, 100]
      hours: [8.0, 16.0, 32.0]
token_estimates:
  base_context: 15000
  per_complexity_point: 500
  by_task_type:
    feature: 1.2
    bugfix: 0.8
    docs: 0.6
    refactor: 1.5
    chore: 0.9
  per_file_touched: 2000
token_budget:
  warning_threshold: 75  # Warn when task estimated above this %
  critical_threshold: 90  # Critical when above this %

hooks:
  enabled: true
  on_task_ready:
    - sync_trello
    - update_state
  on_task_start:
    - check_token_budget
    - start_timer
    - sync_trello
    - update_state
  on_task_review:
    - sync_trello
    - update_state
  on_task_complete:
    - stop_timer
    - record_task_completion
    - record_metrics
    - record_velocity
    - sync_trello
    - update_state
    - check_unblocked
  on_task_block:
    - sync_trello
    - update_state

# Trello integration
trello:
  enabled: false  # Set to true after running: bpsai-pair trello connect
  board_id: ""    # Set via: bpsai-pair trello use-board <id>
  board_name: ""

  defaults:
    project: "{{ cookiecutter.project_name }}"
    stack: Worker/Function
    repo_url: ""  # Set to your repo URL

  board_structure:
    lists:
      - name: Intake/Backlog
        maps_to_status: [pending, backlog]
      - name: Planned/Ready
        maps_to_status: [ready, planned]
      - name: In Progress
        maps_to_status: [in_progress]
      - name: Review/Testing
        maps_to_status: [review, testing]
      - name: Deployed/Done
        maps_to_status: [done, deployed]
      - name: Issues/Tech Debt
        maps_to_status: [blocked, issue]

  custom_fields:
    project:
      type: dropdown
      options:
        - "--"
        - "{{ cookiecutter.project_name }}"
      default: "{{ cookiecutter.project_name }}"

    stack:
      type: dropdown
      options:
        - "--"
        - React
        - Flask
        - Worker/Function
        - Infra
        - Collection
      mapping:
        cli: Worker/Function
        python: Flask
        backend: Flask
        frontend: React
        ui: React
        worker: Worker/Function
        function: Worker/Function
        infra: Infra
        deploy: Infra
        ci: Infra
        docs: Collection
        documentation: Collection
        meta: Collection
        multiple: Collection
      default: Worker/Function

    status:
      type: dropdown
      options:
        - "--"
        - Planning
        - In progress
        - Testing
        - Done
        - Enqueued
        - Waiting
        - Blocked
      mapping:
        pending: Planning
        ready: Enqueued
        in_progress: In progress
        review: Testing
        testing: Testing
        done: Done
        blocked: Blocked
        waiting: Waiting
      default: Planning

    effort:
      type: dropdown
      options:
        - "--"
        - S
        - M
        - L
      mapping:
        0-30: S
        31-60: M
        61-100: L
      default: M

    repo_url:
      type: dropdown
      options:
        - "--"
      default: "--"

    agent_task:
      type: checkbox
      default: false

    adjusted_effort:
      type: dropdown
      options:
        - "--"
        - XS
        - S
        - M
        - L
        - XL

    deployment_tag:
      type: text

    adjusted_effort_notes:
      type: text

  labels:
    - name: Frontend
      color: green
      matches: [react, ui, frontend, css]
    - name: Backend
      color: blue
      matches: [flask, api, backend, python]
    - name: Worker / Function
      color: purple
      matches: [worker, function, background, async, cli]
    - name: Deployment
      color: red
      matches: [deploy, ci, cd, infra, config]
    - name: Bug / Issue
      color: orange
      matches: [bug, fix, issue, error]
    - name: Documentation
      color: sky
      matches: [docs, documentation, readme, guide]

  automation:
    on_task_ready:
      move_to_list: Planned/Ready
      set_status: Enqueued
    on_task_start:
      move_to_list: In Progress
      set_status: In progress
    on_task_review:
      move_to_list: Review/Testing
      set_status: Testing
    on_task_complete:
      move_to_list: Deployed/Done
      set_status: Done
    on_task_block:
      move_to_list: Issues/Tech Debt
      set_status: Blocked

# Security settings
security:
  allowlist_path: .paircoder/security/allowlist.yaml
  secrets_allowlist_path: .paircoder/security/secret-allowlist.yaml
  sandbox:
    enabled: false
    config_path: .paircoder/security/sandbox.yaml

# Containment settings (contained autonomy mode)
# Controls file/directory access and network during autonomous execution
# Note: This is separate from the Docker sandbox system (security.sandbox)
containment:
  # Enable contained autonomy mode
  enabled: false

  # Enforcement mode: "advisory" (log only) or "strict" (Docker-enforced)
  mode: strict

  # Create git checkpoint when entering containment mode
  auto_checkpoint: true

  # Automatically rollback changes if containment violation detected
  rollback_on_violation: false

  # Tier 1: Blocked - cannot read OR write (secrets, credentials)
  blocked_directories: []
  blocked_files:
    - .env
    - .env.local
    - .env.production
    - credentials.json
    - secrets.yaml

  # Tier 2: Read-only - can read, cannot write (enforcement code, skills)
  readonly_directories:
    - .claude/agents/
    - .claude/commands/
    - .claude/skills/
  readonly_files:
    - CLAUDE.md
    - AGENTS.md

  # Network domains allowed in containment mode
  # All other network access is blocked
  allow_network:
    - api.anthropic.com
    - api.trello.com
    - github.com
    - pypi.org
