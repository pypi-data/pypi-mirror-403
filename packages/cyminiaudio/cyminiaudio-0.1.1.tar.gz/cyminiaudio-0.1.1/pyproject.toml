[project]
name = "cyminiaudio"
version = "0.1.1"
description = "Minimal Python bindings for miniaudio"
readme = "README.md"
license = "Unlicense"
requires-python = ">=3.9"
authors = [
    { name = "Your Name", email = "your.email@example.com" }
]
maintainers = [
    { name = "Your Name", email = "your.email@example.com" }
]
keywords = [
    "audio",
    "sound",
    "miniaudio",
    "playback",
    "recording",
    "waveform",
    "filters",
    "dsp",
    "real-time",
    "cross-platform",
]
classifiers = [
    "Development Status :: 4 - Beta",
    "Intended Audience :: Developers",
    "Intended Audience :: Science/Research",
    "Operating System :: MacOS",
    "Operating System :: Microsoft :: Windows",
    "Operating System :: POSIX :: Linux",
    "Programming Language :: Cython",
    "Programming Language :: Python :: 3",
    "Programming Language :: Python :: 3.9",
    "Programming Language :: Python :: 3.10",
    "Programming Language :: Python :: 3.11",
    "Programming Language :: Python :: 3.12",
    "Programming Language :: Python :: 3.13",
    "Programming Language :: Python :: Implementation :: CPython",
    "Topic :: Multimedia :: Sound/Audio",
    "Topic :: Multimedia :: Sound/Audio :: Analysis",
    "Topic :: Multimedia :: Sound/Audio :: Players",
    "Topic :: Multimedia :: Sound/Audio :: Sound Synthesis",
    "Topic :: Software Development :: Libraries :: Python Modules",
    "Typing :: Typed",
]

[project.urls]
Homepage = "https://github.com/yourusername/cyminiaudio"
Documentation = "https://github.com/yourusername/cyminiaudio#readme"
Repository = "https://github.com/yourusername/cyminiaudio.git"
Issues = "https://github.com/yourusername/cyminiaudio/issues"
Changelog = "https://github.com/yourusername/cyminiaudio/blob/main/CHANGELOG.md"

[build-system]
requires = ["scikit-build-core>=0.10", "cython>=3.0"]
build-backend = "scikit_build_core.build"

[tool.scikit-build]
wheel.packages = ["src/cyminiaudio"]
cmake.version = ">=3.15"
cmake.build-type = "Release"
sdist.include = [
    "src/",
    "miniaudio/",
    "CMakeLists.txt",
    "README.md",
    "LICENSE",
    "CHANGELOG.md",
]
sdist.exclude = [
    ".git/",
    ".venv/",
    "__pycache__/",
    "*.pyc",
    ".pytest_cache/",
    "build/",
    "dist/",
    "*.egg-info/",
]
wheel.exclude = [
    "*.c",
    "*.h",
    "*.cpp",
    "*.hpp",
    "*.pyx",
    "*.pxd",
    "*.pxi",
]



[tool.pytest.ini_options]
testpaths = ["tests"]

[dependency-groups]
dev = [
    "pytest>=8.0",
    "pytest-cov>=6.0",
    "build>=1.0",
    "twine>=5.0",
    "ruff>=0.8",
    "mypy>=1.13",
]

[tool.ruff]
target-version = "py39"
line-length = 100
src = ["src", "tests"]

[tool.ruff.lint]
select = [
    "E",      # pycodestyle errors
    "W",      # pycodestyle warnings
    "F",      # Pyflakes
    "I",      # isort
    "B",      # flake8-bugbear
    "C4",     # flake8-comprehensions
    "UP",     # pyupgrade
    "SIM",    # flake8-simplify
]
ignore = [
    "E501",   # line too long (handled by formatter)
    "B008",   # do not perform function calls in argument defaults
]

[tool.ruff.lint.isort]
known-first-party = ["cyminiaudio"]

[tool.mypy]
python_version = "3.10"
warn_return_any = true
warn_unused_configs = true
ignore_missing_imports = true
exclude = [
    "^.venv/",
    "^build/",
    "^dist/",
]

[tool.cibuildwheel]
# Build for Python 3.10-3.13
build = "cp310-* cp311-* cp312-* cp313-*"
# Skip 32-bit builds and musllinux (musl has issues with audio libs)
skip = "*-win32 *-manylinux_i686 *-musllinux_*"
# Test command
test-command = "python -c \"import cyminiaudio; print(cyminiaudio.get_version())\""

[tool.cibuildwheel.linux]
archs = ["x86_64", "aarch64"]
# Install ALSA dev libraries for Linux builds
before-all = "yum install -y alsa-lib-devel || apt-get update && apt-get install -y libasound2-dev || true"

[tool.cibuildwheel.macos]
archs = ["x86_64", "arm64"]

[tool.cibuildwheel.windows]
archs = ["AMD64"]
