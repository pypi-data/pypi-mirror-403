[project]
name = "ampel-lsst"
version = "0.10.1a14"
description = "Legacy Survey of Space and Time support for the Ampel system"
requires-python = ">=3.11, <4"
authors = [
    { name = "Marcus Fenner", email = "mf@physik-hu-berlin.de" },
    { name = "Valery Brinnel" },
    { name = "Jakob van Santen", email = "jakob.van.santen@desy.de" },
    { name = "Jakob Nordin" },
]
maintainers = [
    { name = "Jakob van Santen", email = "jakob.van.santen@desy.de" },
]
license = "BSD-3-Clause"
readme = "README.md"
classifiers = [
    "Development Status :: 3 - Alpha",
    "Intended Audience :: Science/Research",
    "Programming Language :: Python :: 3.11",
    "Programming Language :: Python :: 3.12",
    "Programming Language :: Python :: 3.13",
    "Programming Language :: Python :: 3.14",
    "Topic :: Scientific/Engineering :: Information Analysis",
    "Topic :: Scientific/Engineering :: Astronomy",
    "Typing :: Typed",
]
dependencies = [
    "ampel-interface (>=0.10.4.post2,<0.11)",
    "ampel-catalogmatch (>=0.10.0a2,<0.11.0)",
    "ampel-alerts (>=0.10.3,<0.11.0)",
    "ampel-photometry (>=0.10.1,<0.11.0)",
    "fastavro (>=1.12.1,<2.0.0)",
    "confluent-kafka[schemaregistry] (>=2.12.2,<3.0.0)",
    "requests (>=2.32.5,<3.0.0)",
]

[dependency-groups]
dev = [
    "pytest-ampel-core (>=0.10.0a4,<0.11)",
    "mypy (>=1.13,<2.0)",
    "types-requests (>=2.32.4.20250913,<3.0.0.0)",
    "pytest-mock (>=3.15.1,<4.0.0)",
]

[tool.poetry]
packages = [
    {include = "ampel"},
]
exclude = ["ampel/py.typed"]

[project.urls]
homepage = "https://ampelproject.github.io"
repository = "https://github.com/AmpelAstro/Ampel-LSST"

[build-system]
requires = ["poetry-core>=1.0.0", "setuptools >= 40.6.0", "wheel"]
build-backend = "poetry.core.masonry.api"

[tool.pytest.ini_options]
minversion = "6.0"
addopts = "--showlocals -ra"
filterwarnings = [
    "error",
    "ignore:pkg_resources is deprecated:DeprecationWarning",
    "default::urllib3.exceptions.InsecureRequestWarning",
]

[tool.mypy]
namespace_packages = true
packages = [
  "ampel"
]
plugins = [
  "pydantic.mypy",
]
show_error_codes = true
warn_unused_ignores = true
check_untyped_defs = true

[[tool.mypy.overrides]]
module = [
  "astropy.*",
  "bson.*",
  "confluent_kafka.*",
  "sncosmo.*"
]
ignore_missing_imports = true

[tool.ruff]
line-length = 88
target-version = "py312"

[tool.ruff.lint]
select = [
    "E",    # pycodestyle
    "F",    # pyflakes
    "I",    # isort
    "UP",   # pyupgrade
    "B",    # bugbear
    "DTZ",  # datetimez
    "T20",  # print
    "PT",   # pytest-style
    "RET",  # return
    "SLF",  # self
    "SIM",  # simplify
    "ARG",  # unused-arguments
    "PL",   # pylint
    "PERF", # perflint
    "RUF",  # ruff
]
ignore = [
    "E501",    # line too long
    "PLR09",   # too many (arguments|branches)
    "PLR2004", # Magic value used in comparison
    "RUF012",  # Mutable class attributes should be annotated with `typing.ClassVar`
               # fine for AmpelUnit, actually (ruff has a special case for pydantic)
]

[tool.ruff.lint.isort]
known-first-party = ["ampel"]

[tool.ruff.lint.per-file-ignores]
"tests/*" = [
    "RUF018",  # assignment in assert is just fine in tests
    "SLF001",  # allow private member access
    "T201",    # allow print()
]

[tool.ruff.lint.flake8-unused-arguments]
ignore-variadic-names = true
