import{D as h,l as g,a as m}from"./assert-cyW4mg7q.js";import{y as i,A as w,x as y,u as p,i as A}from"./deep-equal-BTW2ZN6S.js";import{G as b}from"./globe-viewport-tqhQW7C4.js";const E="set luma.log.level=1 (or higher) to trace rendering",c="No matching device found. Ensure `@luma.gl/webgl` and/or `@luma.gl/webgpu` modules are imported.";class n{static defaultProps={...h.defaultProps,type:"best-available",adapters:void 0,waitForPageLoad:!0};stats=g;log=i;VERSION="9.2.6";spector;preregisteredAdapters=new Map;constructor(){if(globalThis.luma){if(globalThis.luma.VERSION!==this.VERSION)throw i.error(`Found luma.gl ${globalThis.luma.VERSION} while initialzing ${this.VERSION}`)(),i.error("'yarn why @luma.gl/core' can help identify the source of the conflict")(),new Error("luma.gl - multiple versions detected: see console log");i.error("This version of luma.gl has already been initialized")()}i.log(1,`${this.VERSION} - ${E}`)(),globalThis.luma=this}async createDevice(e={}){const t={...n.defaultProps,...e},r=this.selectAdapter(t.type,t.adapters);if(!r)throw new Error(c);return t.waitForPageLoad&&await r.pageLoaded,await r.create(t)}async attachDevice(e,t){const r=this._getTypeFromHandle(e,t.adapters),s=r&&this.selectAdapter(r,t.adapters);if(!s)throw new Error(c);return await s?.attach?.(e,t)}registerAdapters(e){for(const t of e)this.preregisteredAdapters.set(t.type,t)}getSupportedAdapters(e=[]){const t=this._getAdapterMap(e);return Array.from(t).map(([,r])=>r).filter(r=>r.isSupported?.()).map(r=>r.type)}getBestAvailableAdapterType(e=[]){const t=["webgpu","webgl","null"],r=this._getAdapterMap(e);for(const s of t)if(r.get(s)?.isSupported?.())return s;return null}selectAdapter(e,t=[]){let r=e;e==="best-available"&&(r=this.getBestAvailableAdapterType(t));const s=this._getAdapterMap(t);return r&&s.get(r)||null}enforceWebGL2(e=!0,t=[]){const s=this._getAdapterMap(t).get("webgl");s||i.warn("enforceWebGL2: webgl adapter not found")(),s?.enforceWebGL2?.(e)}setDefaultDeviceProps(e){Object.assign(n.defaultProps,e)}_getAdapterMap(e=[]){const t=new Map(this.preregisteredAdapters);for(const r of e)t.set(r.type,r);return t}_getTypeFromHandle(e,t=[]){return e instanceof WebGL2RenderingContext?"webgl":typeof GPUDevice<"u"&&e instanceof GPUDevice||e?.queue?"webgpu":e===null?"null":(e instanceof WebGLRenderingContext?i.warn("WebGL1 is not supported",e)():i.warn("Unknown handle type",e)(),null)}}const V=new n;class v{constructor(e){const{compare:t,extract:r,required:s}=e;this._propsToCompare=t,this._propsToExtract=r||t,this._requiredProps=s}arePropsEqual(e,t){for(const r of this._propsToCompare)if(!(r in e)||!(r in t)||!w(e[r],t[r]))return!1;return!0}initializeProps(e,t){const r={},s={};for(const a of this._propsToExtract)(a in e||a in t)&&(r[a]=e[a],s[a]=t[a]);return this._checkRequiredProps(r),this._checkRequiredProps(s),{start:r,end:s}}getDuration(e,t){return t.transitionDuration}_checkRequiredProps(e){this._requiredProps&&this._requiredProps.forEach(t=>{const r=e[t];m(Number.isFinite(r)||Array.isArray(r),`${t} is required for transition`)})}}const P=["longitude","latitude","zoom","bearing","pitch"],T=["longitude","latitude","zoom"];class D extends v{constructor(e={}){const t=Array.isArray(e)?e:e.transitionProps,r=Array.isArray(e)?{}:e;r.transitionProps=Array.isArray(t)?{compare:t,required:t}:t||{compare:P,required:T},super(r.transitionProps),this.opts=r}initializeProps(e,t){const r=super.initializeProps(e,t),{makeViewport:s,around:a}=this.opts;if(s&&a)if(s(e)instanceof b)y.warn("around not supported in GlobeView")();else{const u=s(e),f=s(t),l=u.unproject(a);r.start.around=a,Object.assign(r.end,{around:f.project(l),aroundPosition:l,width:t.width,height:t.height})}return r}interpolateProps(e,t,r){const s={};for(const a of this._propsToExtract)s[a]=p(e[a]||0,t[a]||0,r);if(t.aroundPosition&&this.opts.makeViewport){const a=this.opts.makeViewport({...t,...s});Object.assign(s,a.panByPosition(t.aroundPosition,p(e.around,t.around,r)))}return s}}function d(o,e){e&&Object.entries(e).map(([t,r])=>{t.startsWith("--")?o.style.setProperty(t,r):o.style[t]=r})}function S(o,e){e&&Object.keys(e).map(t=>{t.startsWith("--")?o.style.removeProperty(t):o.style[t]=""})}class R{constructor(e){this.viewId=null,this.props={...this.constructor.defaultProps,...e},this.id=this.props.id}setProps(e){const t=this.props,r=this.rootElement;r&&t.className!==e.className&&(t.className&&r.classList.remove(t.className),e.className&&r.classList.add(e.className)),r&&!A(t.style,e.style,1)&&(S(r,t.style),d(r,e.style)),Object.assign(this.props,e),this.updateHTML()}updateHTML(){this.rootElement&&this.onRenderHTML(this.rootElement)}onCreateRootElement(){const e=["deck-widget",this.className,this.props.className],t=document.createElement("div");return e.filter(r=>typeof r=="string"&&r.length>0).forEach(r=>t.classList.add(r)),d(t,this.props.style),t}_onAdd(e){return this.onAdd(e)??this.onCreateRootElement()}onAdd(e){}onRemove(){}onViewportChange(e){}onRedraw(e){}onHover(e,t){}onClick(e,t){}onDrag(e,t){}onDragStart(e,t){}onDragEnd(e,t){}}R.defaultProps={id:"widget",style:{},_container:null,className:""};export{D as L,v as T,R as W,d as a,V as l,S as r};
//# sourceMappingURL=widget-BjgEeHAL.js.map
