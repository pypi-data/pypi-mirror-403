[project]
name = "ekfsm"
dependencies = [
    "yamale",
    "gpiod>=2.1.0",
    "smbus2",
    "anytree",
    "more-itertools",
    "crcmod",
    "munch",
    "click>=8.0.1",
    "hexdump",
    "termcolor>=3.0.1",
    "schema>=0.7.7",
    "io4edge_client>=2.4.3",
    "protobuf>=6.32.1",
]
readme = "README.md"
license-files = ["LICENSE"]
authors = [
    {name = "Jan Jansen", email = "jan@ekf.de"},
    {name = "Klaus Popp", email = "klaus.popp@ci4rail.com"},
    {name = "Felix Päßler", email = "fp@ekf.de"}
]
description = "The EKF System Management Library (ekfsm) is a sensor monitoring suite for Compact PCI Serial devices."
requires-python = ">=3.10"
version = "1.9.0-alpha.41"

[project.scripts]
ekfsm-cli = "ekfsm.cli:main"

[tool.uv]
package = false
default-groups = ["dev", "docs"]
override-dependencies = [
    "urllib3>=2.6.0",
    "requests>=2.32.4",
    "Jinja2>=3.1.6",
]

[[tool.uv.index]]
name = "testpypi"
url = "https://test.pypi.org/ekfsm/"
publish-url = "https://test.pypi.org/legacy/"
explicit = true

[tool.pytest]
norecursedirs = ".direnv/"

[tool.pytest.ini_options]
pythonpath = [
    "."
]

[build-system]
requires = ["hatchling"]
build-backend = "hatchling.build"

[dependency-groups]
dev = [
    "basedpyright>=1.24.0",
    "ipdb>=0.13.13",
    "mypy>=1.14.1",
    "pytest>=8.3.4",
    "sphinx>=8.1.3",
    "black>=25.1.0",
    "packaging",
    "bandit>=1.8.6",
    "pip-audit",
    "types-pyyaml>=6.0.12.20241230"
]
docs = [
    "sphinx>=8.1.3",
    "sphinx-autodoc-typehints>=3.0.1",
    "sphinx-rtd-theme>=3.0.2",
    "sphinx-click"
]

[tool.basedpyright]
include = ["ekfsm"]
exclude = ["**/node_modules",
    "**/__pycache__",
    "src/experimental",
    "docs/*",
]
ignore = []
defineConstant = { DEBUG = true }
typeCheckingMode = "standard"
reportMissingImports = "error"
reportMissingTypeStubs = false
reportAny = "none"
pythonVersion = "3.10"
pythonPlatform = "Linux"

[tool.mypy]
ignore_missing_imports = true
strict = false
disallow_untyped_defs = false
cache_dir = ".mypy_cache"
exclude = "docs/*"

[tool.ruff]
line-length = 120

[tool.coverage.run]
omit = [
    "/nix/*",
    ".devenv/*"
]
