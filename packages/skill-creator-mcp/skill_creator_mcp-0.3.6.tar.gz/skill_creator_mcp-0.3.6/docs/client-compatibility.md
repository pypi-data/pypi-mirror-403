# 回退机制说明

## 当前客户端限制

由于当前 Claude Code 客户端不支持 FastMCP 3.0+ 的高级 API，以下功能受限：

- ❌ **LLM Sampling**（`ctx.sample()`）：无法动态生成个性化问题
- ❌ **User Elicitation**（`ctx.elicit()`）：无法交互式收集用户输入

## 自动回退策略

| 功能 | 理想模式 | 回退模式 | 状态 |
|------|----------|----------|------|
| 动态问题生成 | LLM 根据上下文生成 | 预定义问题列表 | ✅ 已启用 |
| 交互式输入收集 | 一键完成所有输入 | 逐步问答模式 | ✅ 已启用 |
| 需求完整性分析 | LLM 智能判断 | 固定规则检查 | ✅ 已启用 |

## 用户实际体验

### 基础模式/完整模式
使用预定义的 5/10 步结构化问卷。

### 头脑风暴模式
使用 4 个探索性问题轮换提问：
1. 这个技能的核心价值主张是什么？
2. 它与现有解决方案有什么不同？
3. 用户最痛的场景是什么？
4. 您希望用户使用后有什么感受？

### 渐进式模式
根据答案数量选择相应的基础问题：
- 无答案 → 询问技能名称
- 有技能名称 → 询问主要功能
- 有功能 → 询问使用场景
- 有场景 → 询问模板类型

### 会话恢复
通过 `action="status"` 查询状态后继续。

## 不影响核心功能

- ✅ 所有关键信息仍然收集
- ✅ 输入验证正常工作
- ✅ 会话状态持久化
- ✅ 与 `init_skill` 集成完整

## 未来改进

当客户端支持以下能力时，功能将自动升级：

1. **LLM Sampling**：动态生成个性化问题
2. **User Elicitation**：一键交互式收集所有输入
