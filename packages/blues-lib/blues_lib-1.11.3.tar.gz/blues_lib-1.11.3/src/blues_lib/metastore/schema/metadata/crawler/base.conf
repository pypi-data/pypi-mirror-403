{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "description": "the metadata of the llm engine",
  "type": "object", 
  "required": ["summary","browser"],
  "oneOf": [
    { "required": ["crawler"] },
    { "required": ["child"] },
    { "required": ["children"] }
  ],
  "properties": {
    "tpl_id":{
      "type":"string",
      "pattern":"^[A-Za-z0-9.-_]+$",
      "$comment": "the instance id of the instance"
    },
    "summary": { "$ref":"#/$defs/summary" },
    "browser":{ "$ref":"#/$defs/browser" },
    "crawler":{ "$ref":"#/$defs/crawler" },
    "head_crawl":{ "$ref":"#/$defs/crawler" },
    "foot_crawl":{ "$ref":"#/$defs/crawler" },
    "page_crawl":{ "$ref":"#/$defs/crawler" },
    "child":{ "$ref":"#/$defs/crawler" },
    "children":{ "$ref":"#/$defs/crawler" }
  },
  "additionalProperties": false,
  "$defs": {
    "summary":{
      "type":"object",
      "required":["type"],
      "oneOf": [
        { "required": ["url"] },
        { "required": ["urls"] },
        { "required": ["entities"] }
      ],
      "properties":{
        "type":{
          "type":"string",
          "enum":["URL","FOR","PAGE","NEXT_PAGE","DEPTH"]
        },
        "url":{
          "type":"string",
          "pattern":"^https?://.*$"
        },
        "urls":{
          "type":"array",
          "items":{
            "type":"string",
            "pattern":"^https?://.*$"
          },
          "minItems":1
        },
        "entities":{
          "type":"array",
          "minItems":1,
          "items":{
            "type":"object",
            "properties":{
              "required":["url"],
              "url":{
                "type":"string",
                "pattern":"^https?://.*$"
              },
              "additionalProperties": true
            }
          }
        }
      }
    },
    "browser":{
      "type":"object",
      "required":["config","options"],
      "properties":{
        "config":{
          "type":["object","null"],
          "minProperties":1
        },
        "options":{
          "type":["object","null"],
          "minProperties":1
        }
      }
    },
    "crawler":{
      "oneOf":[
        {
          "type": "object",
          "minProperties": 1
        },
        {
          "type": "array",
          "items": {
            "type": "object",
            "minProperties": 1
          },
          "minItems": 1
        }
      ]
    }
  }
}