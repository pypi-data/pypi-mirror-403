{
  "tpl_id":"metadata.crawler.login.sms",

  "summary":{
    "type":"URL",
  },

  "browser":{
    "config":"{{browser_config}}",
    "options":"{{browser_options}}",
  },

  "crawler":{
    "open":[
      # open the login page
      {
        "_kind":"open",
        "url":"{{login_url}}",
      },
      # focus the login section [optional] 
      {
        "_kind":"click",
        "loc_or_elem":"{{focus_login_selector}}",
        "timeout":10,
      }, 
      # switch to sms mode [optional]
      {
        "_kind":"click",
        "loc_or_elem":"{{switch_sms_selector}}",
        "timeout":10,
      },
    ],
    # send the sms code
    "send":[
      # input the phone number
      {
        "_kind":"write_text",
        "loc_or_elem":"{{input_phone_selector}}", 
        "value":"{{phone_number}}",
      },
      # agree the protocal - [optional]
      {
        "_kind":"choice",
        "loc_or_elem":"{{agree_protocol_selector}}",
        "value":true
      },
      # send the sms code
      {
        "_kind":"click",
        "loc_or_elem":"{{send_sms_selector}}",
      },
    ],
    # send notification email
    "mail":[
      {
        "_kind":"email",
        "value":{
          "subject":"AutoLive : Submit your login code please",
          "paras":[
            {
              "type":"text",
              "value":"An SMS code has been sent for your {{domain}} account re-login. Please submit it within {{code_expire}} seconds.",
            },
            {
              "type":"link",
              "value":{
                "href":"http://deepbluenet.com/naps-upload-code.html?site={{domain}}&ts={{timestamp}}",
                "text":"Click to open the code submit page.",
              },
            },
          ],
        },
      },
    ],
    # input the verification code
    "input":[
      # adjust the code wrapper element style [optional]
      {
        "_kind":"css",
        "loc_or_elem":"{{enable_code_selector}}", 
        "value":"{{enable_code_css}}",
      },
      # input the sms code
      {
        "_kind":"auth_code_input",
        "resetable":"{{input_by_char}}", # weather input the code by char or not, if true, input one then clear one
        "loc_or_elem":"{{input_code_selector}}",
        "value":"__sentinel__", # the sntnl value will be replaced dynamically
        "code_expire":"{{code_expire}}",
        "domain":"{{domain}}",
        "timestamp":"{{timestamp}}",
      },
    ],
    # submit the sms code
    "submit":[
      {
        "_kind":"click",
        "loc_or_elem":"{{submit_code_selector}}",
      },
    ], 

    # save cookies to local file
    "save":[
      {
        "_kind":"file_cookie",
        "value":"__sentinel__", 
        "wait_time":"{{login_wait_time:-10}}", # must wait the page redirect
      }
    ],

    # output the login status
    "data":{
      "_kind":"ele_presents",
      "loc_or_elem":"{{logged_in_element}}", // check by element
      "wait_time":"{{login_wait_time:-5}}", // by default is 3 sconeds
    },

  },
}
