{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "description": "the behavior's config",
  "type": "object", 
  "properties": {
    
    # locator or WebElement object
    "loc_or_elem": {
      "$ref":"#/$defs/loc_or_elem"
    },
    "loc_or_elems": {
      "$ref":"#/$defs/loc_or_elems"
    },
    "parent_or_elem": {
      "$ref":"#/$defs/loc_or_elem"
    },
    
    # function
    "key": {
      "description": "for getter behavior",
      "type": "string",
      "minLength": 1
    },
    "value": {
      "description": "any type, for setter behavior",
    },
    
    # action
    "skip": {
      "description": "skip the behavior directly, do nothing",
      "type": "boolean", 
    },
    "scroll": {
      "description": "scroll the element into the viewport",
      "type": "boolean", 
    },
    
    # hook
    "before_invoked": {
      "$ref":"#/$defs/hook"
    },
    "after_invoked": {
      "$ref":"#/$defs/hook"
    },
    
    # time
    "wait_before": {
      "description": "wait before the behavior invoke, in seconds",
      "$ref":"#/$defs/wait"
    },
    "timeout": {
      "description": "the max waiting time for query the element, in seconds",
      "type": "number",
      "minimum": 0
    },
    "interval": {
      "$ref":"#/$defs/interval"
    },
    "wait_after": {
      "description": "wait after the behavior invoked, in seconds",
      "$ref":"#/$defs/wait"
    },

  },
  "additionalProperties": true,
  "$defs": { 
    "wait": {
      "anyOf": [ 
        {
          "type": "number",
          "minimum": 0
        },
        {
          "description": "wait time and title, e.g. [5, 'wait 5 seconds']",
          "type": "array",
          "items": [
            {"type": "number", "minimum": 0}, 
            {"type": "string", "minLength": 1} 
          ],
          "minItems": 2,        
          "maxItems": 2,        
          "additionalItems": false  
        },
        {
          "description": "wait time random in range and title, e.g. [2,6, 'wait 2-6 seconds']",
          "type": "array",
          "items": [
            {"type": "number", "minimum": 0}, 
            {"type": "number", "minimum": 1}, 
            {"type": "string", "minLength": 1} 
          ],
          "minItems": 3,        
          "maxItems": 3,
          "additionalItems": false  
        },
      ]
    },
    "interval": {
      "description": "support single int, int list or int with title",
      "anyOf": [ 
        {
          "type": "number",
          "minimum": 0
        },
        {
          "type": "array", 
          "items":{
            "anyOf":[
              { "type": "number", "minimum": 0 },
              {
                "type": "array",
                "items": [
                  {"type": "number", "minimum": 0}, 
                  {"type": "string", "minLength": 1} 
                ],
                "minItems": 2,        
                "maxItems": 2,        
                "additionalItems": false  
              } 
            ]
          }
        },
      ]
    },
    "loc_or_elem": {
      "description": "support locator string or WebElement object",
      "anyOf": [ 
        {
          "type": "string",
          "minLength": 1
        },
        {
          "type": "object",
          "minProperties": 1
        },
      ]
    },
    "loc_or_elems": {
      "description": "support locator string or string list or WebElement object list",
      "anyOf": [
        {
          "description": "will use find_elements to get WebElement object list, 遵循的是「元素在 HTML 文档中出现的先后顺序」",
          "type": "string",
          "minLength": 1
        },
        {
          "type": "array",
          "items": { "type": "string" },
          "minItems": 1, 
          "uniqueItems": false, # allow duplicate locator string
        },
        {
          "description": "support WebElements",
          "type": "array",
          "items": { "type": "object" },
          "minItems": 1,
          "uniqueItems": false, # allow duplicate WebElement object
        }
      ]
    },
    "hook":{
      "type": "array",
      "items": {
        "type": "object",
        "oneOf": [
          {
            "$comment": "Class type: kind/value are required, proc is optional",
            "properties": {
              "kind": { "type": "string", "const": "class" },
              "value": { "type": "string", "minLength": 1, "$comment": "Value for class type (e.g. 'Blocker')" },
              "proc": { "type": "object", "$comment": "Optional config object, no restrictions on internal properties" }
            },
            "required": ["kind", "value"],
            "additionalProperties": false
          },
          {
            "$comment": "Func type: only kind/value are required, proc field is not allowed",
            "properties": {
              "kind": { "type": "string", "const": "func" },
              "value": { 
                "type": "string", 
                "pattern": "^lambda\\s+[a-zA-Z_][a-zA-Z0-9_]*:\\s+.+$", 
                "$comment": "Value for func type (e.g. 'lambda x: not x')" 
              }
            },
            "required": ["kind", "value"],
            "additionalProperties": false
          }
        ]
      },
      "minItems": 1,
      "uniqueItems": true
    }
  }
}