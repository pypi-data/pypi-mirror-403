import{d as ee,b as ae,c as te,C as oe,r as m,at as ne,bu as se,o as ie,I as L,ax as P,as as re,L as le,e as V,f as k,h as G,i as n,s as h,l as a,O as ue,N as de,t as g,w as r,ad as _e,al as ce,ab as E,bs as pe,dc as O,Y as I,aw as me,ac as ge,B as fe,dd as ve,U as ye,W as he,aF as xe,k as be,m as Ge,cc as ke,n as we,X as ze,Z as Ne,de as Ce,df as $e,au as Le,dg as Ie,D as Me,E as Ue,a5 as Re}from"./index-DJskbzIk.js";import{_ as qe}from"./PaginationView.vue_vue_type_script_setup_true_lang-C5I4MAUI.js";import{A as Be}from"./Add-B9E6ooHy.js";import{N as Pe}from"./Switch-BTGJkP8J.js";import{_ as Ve}from"./DataTable-BkhITQT9.js";import{_ as Ee}from"./InputGroupLabel-DspqGwTB.js";import"./Pagination-MzAc_u8k.js";import"./prop-NnGblK-3.js";import"./Checkbox-B0NmEvB4.js";import"./RadioGroup-DFjU_ho_.js";import"./download-C2161hUv.js";const Oe={class:"flex"},Se={class:"text-xl mt-[26px] flex items-center gap-1"},Te={class:"flex justify-between items-center w-full"},Ae={class:"flex-1"},Fe={class:"text-xl"},je=ee({__name:"DeviceGroup",setup(De){const{t:s}=ae(),S=te(),w=oe(),f=m(!1),M=m(),c=m({description:void 0,device_group_name:void 0}),T={description:{required:!0,message:s("deviceGroup.descriptionErrMsg")},device_group_name:{required:!0,message:s("deviceGroup.groupNameErrMsg")}},z=()=>{f.value=!1,c.value={description:void 0,device_group_name:void 0}},A=()=>{var t;_.value||(_.value=!0,(t=M.value)==null||t.validate(async e=>{if(e){_.value=!1;return}const[i,u]=await Ce({...c.value,device_group_name:`${U.value}_${c.value.device_group_name}`,organization_id:l.value});_.value=!1,!i&&u&&u.status===0&&v()}))},F=t=>{t||z()},N=m(),d=ne({page:1,per_page:se,total:0}),_=m(!1),l=m(),v=async t=>{_.value=!0,N.value=void 0;const[e,i]=await $e({...Le(d),org_id:t||l.value});_.value=!1,!e&&i&&i.status===0&&(N.value=i.data.list,d.total=i.data.total),f.value&&z()},j=async(t,e)=>{const[i,u]=await Ie({device_id:e,hidden:!t});!i&&(u==null?void 0:u.status)===0&&v()},y=m(),D=async()=>{var i,u;const[t,e]=await Me();if(!t&&(e==null?void 0:e.status)===0){y.value=(i=e.data)==null?void 0:i.organizations;const x=(u=e.data)==null?void 0:u.organizations;if(w.query.org&&e.data.organizations.some(p=>p.organization_id===+(w.query.org||"")))l.value=+w.query.org,Ue(()=>{v()});else if(x&&x.length>0){const p=x[0].organization_id;p&&(l.value=p,v(p))}}};ie(()=>{D()});const H=[{title:s("deviceGroup.groupId"),key:"device_group_id"},{title:s("deviceGroup.groupName"),key:"device_group_name"},{title:s("deviceGroup.description"),key:"description"},{title:s("deviceGroup.createTime"),key:"create_time"},{title:s("createuser"),key:"user_name"},{title:s("deviceGroup.status"),key:"status",render:t=>{var e;if(t.status)return L(re,{type:((e=P[t.status])==null?void 0:e.type)||"default",bordered:!1},{default:()=>{var i;return s((i=P[t.status])==null?void 0:i.text)}})}},{title:s("deviceGroup.show2desktop"),key:"status",render:t=>{if(t.status)return L("div",{onClick:e=>e.stopPropagation()},L(Pe,{value:!t.hidden,onUpdateValue:e=>j(e,t.device_group_id)}))}}],K=({device_group_name:t})=>({class:"cursor-pointer",onClick:()=>{S.push({name:"overview",query:{device_group_name:t}})}}),U=le(()=>{var t,e;return(e=(t=y.value)==null?void 0:t.find(i=>i.organization_id==l.value))==null?void 0:e.organization_name});return(t,e)=>{var q,B;const i=de,u=pe,x=me,p=fe,W=Ve,X=xe,C=Ge,Y=Ee,R=we,Z=ke,J=be,Q=Ne;return k(),V("div",Oe,[G("div",null,[G("div",Se,[n(i,{component:a(ue)},null,8,["component"]),h(" "+g(a(s)("org.orgList")),1)]),n(x,{placement:"left","bar-width":300,type:"card",value:a(l),"onUpdate:value":[e[0]||(e[0]=o=>I(l)?l.value=o:null),v],class:"pr-5 mt-7"},{default:r(()=>[(k(!0),V(_e,null,ce(a(y),o=>(k(),E(u,{key:o.organization_id,name:o.organization_id,disabled:a(_),class:"min-w-[200px]"},{default:r(()=>[G("div",Te,[h(g(o.organization_name)+" ",1),n(O,{role:o.user_role},null,8,["role"])])]),_:2},1032,["name","disabled"]))),128))]),_:1},8,["value"])]),G("div",Ae,[n(ve,{title:(B=(q=a(y))==null?void 0:q.find(o=>o.organization_id==a(l)))==null?void 0:B.organization_name},{tag:r(()=>{var o,b;return[n(O,{role:(b=(o=a(y))==null?void 0:o.find($=>$.organization_id==a(l)))==null?void 0:b.user_role},null,8,["role"])]}),extra:r(()=>[n(p,{type:"primary",onClick:e[1]||(e[1]=o=>f.value=!0)},{icon:r(()=>[n(a(Be))]),default:r(()=>[h(" "+g(a(s)("deviceGroup.create")),1)]),_:1})]),_:1},8,["title"]),n(W,{columns:H,data:a(N),pagination:!1,loading:a(_),"row-props":K,"max-height":`calc(100vh - ${a(d).total>a(d).per_page?"285":"240"}px)`},null,8,["data","loading","max-height"]),a(d).total>a(d).per_page?(k(),E(qe,{key:0,"page-info":a(d),"onUpdate:pageInfo":e[2]||(e[2]=o=>I(d)?d.value=o:null),onUpdateList:v},null,8,["page-info"])):ge("",!0),n(Q,{show:a(f),"onUpdate:show":e[5]||(e[5]=o=>I(f)?f.value=o:null),"on-update:show":F,"auto-focus":!1},{default:r(()=>[n(ye,{style:{width:"600px"}},{default:r(()=>[n(he,null,{default:r(()=>[n(X,{type:"info",class:"mb-5",bordered:!1},{default:r(()=>[h(g(a(s)("deviceGroup.tips")),1)]),_:1}),n(J,{ref_key:"formRef",ref:M,model:a(c),rules:T},{default:r(()=>[n(C,{label:a(s)("deviceGroup.orgName"),path:"orgName"},{default:r(()=>{var o,b;return[G("div",Fe,g((b=(o=a(y))==null?void 0:o.find($=>$.organization_id==a(l)))==null?void 0:b.organization_name),1)]}),_:1},8,["label"]),n(C,{label:a(s)("deviceGroup.groupNameLabel"),path:"device_group_name"},{default:r(()=>[n(Z,null,{default:r(()=>[n(Y,null,{default:r(()=>[h(g(a(U))+"_ ",1)]),_:1}),n(R,{value:a(c).device_group_name,"onUpdate:value":e[3]||(e[3]=o=>a(c).device_group_name=o),placeholder:a(s)("deviceGroup.groupNamePlaceholder")},null,8,["value","placeholder"])]),_:1})]),_:1},8,["label"]),n(C,{label:a(s)("deviceGroup.descriptionLabel"),path:"description"},{default:r(()=>[n(R,{value:a(c).description,"onUpdate:value":e[4]||(e[4]=o=>a(c).description=o),placeholder:a(s)("deviceGroup.descriptionPlaceholder")},null,8,["value","placeholder"])]),_:1},8,["label"])]),_:1},8,["model"])]),_:1}),n(ze,{onCancel:z},{default:r(()=>[n(p,{type:"primary",loading:a(_),onClick:A},{default:r(()=>[h(g(a(s)("deviceGroup.create")),1)]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1},8,["show"])])])}}}),oa=Re(je,[["__scopeId","data-v-715496ee"]]);export{oa as default};
