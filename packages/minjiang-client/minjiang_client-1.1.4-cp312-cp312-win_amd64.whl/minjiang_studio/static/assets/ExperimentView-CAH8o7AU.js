import{u as W}from"./exp-fN6tgzBZ.js";import{d as P,e as A,f as w,bd as We,h,bn as Ke,a3 as ee,F as le,b as ne,C as Z,c as de,r as B,a6 as Me,o as _e,E as X,ab as D,w as a,i as o,bs as Xe,I as u,l as e,N as Q,Y as Ne,aw as Ye,L as ie,bl as Ze,am as qe,ad as et,al as tt,aA as Ve,s as f,t as d,aD as se,aG as te,ac as ae,O as at,aB as nt,aC as ot,as as Le,aE as Ae,af as st,B as fe,aF as lt,a5 as Pe,A as it,Z as rt,U as ct,V as pt,W as ut,ap as Oe,S as dt,X as _t,ay as je,K as ft,bx as He,by as mt,aR as xt,aH as gt,bz as oe,bA as Ee,bo as Y,bp as vt,bB as $e,j as wt,aa as yt,aT as Re,aU as ht,T as bt,aI as It,v as zt,aJ as kt,aK as St}from"./index-DJskbzIk.js";import{E as pe}from"./ExperimentTwotone-CUUKUJME.js";import{P as Ct}from"./WaveformPane.vue_vue_type_script_setup_true_lang-CYNgzszk.js";import{A as Be}from"./AppsListDetail24Filled-BGRUPGEn.js";import{A as qt}from"./Angle-CZ8Qpap6.js";import{N as Et}from"./Badge-BWKxQG2c.js";import{u as Ue}from"./groupDetail-grzpJhg1.js";import{E as $t,e as Rt,R as Dt}from"./ExpsTpl-Cy9MpRNK.js";import{_ as H,H as Ft,D as Tt}from"./InfoItem.vue_vue_type_script_setup_true_lang-BSRMWTP5.js";import{F as Mt}from"./Folder-DXQZcgnC.js";import{_ as Nt,a as Qe}from"./BreadcrumbItem-B0PCod7V.js";import{b as Vt,c as Lt,d as At,e as Pt,s as Ot,f as jt,h as Ht,i as Bt,j as Ut,k as Qt,a as Gt}from"./exp-Dzc8nAzP.js";import{F as De,A as Fe}from"./FileSaver.min-CWr_Rv27.js";import{u as Jt}from"./useInterval-CS7hQKQu.js";import{n as Wt}from"./index.browser-OxPLOBIU.js";import{o as re}from"./index-DAzX16xw.js";import{i as Kt}from"./json-editor-vue-cMpGPz9p.js";import{_ as Xt}from"./Image-CjHsT37c.js";import{_ as Yt}from"./Split-C27Gs15e.js";import"./installCanvasRenderer-DQ3trSBi.js";import"./Refresh-IIbt43T_.js";import"./Checkbox-B0NmEvB4.js";import"./DynamicForm-B5kgL0W4.js";import"./index-DDdGfEJ1.js";import"./InputNumber-CtZNiVVn.js";import"./RadioGroup-DFjU_ho_.js";import"./Switch-BTGJkP8J.js";import"./download-C2161hUv.js";const Zt={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 32 32"},ea=P({name:"QuadrantPlot",render:function(c,r){return w(),A("svg",Zt,r[0]||(r[0]=[We('<path d="M30 15H17V2h-2v13H2v2h13v13h2V17h13v-2z" fill="currentColor"></path><path d="M5 30a3 3 0 1 1 3-3a3.003 3.003 0 0 1-3 3zm0-4a1 1 0 1 0 1 1a1.001 1.001 0 0 0-1-1z" fill="currentColor"></path><path d="M8 8a3 3 0 1 1 3-3a3.003 3.003 0 0 1-3 3zm0-4a1 1 0 1 0 1 1a1.001 1.001 0 0 0-1-1z" fill="currentColor"></path><path d="M22 13a3 3 0 1 1 3-3a3.003 3.003 0 0 1-3 3zm0-4a1 1 0 1 0 1 1a1.001 1.001 0 0 0-1-1z" fill="currentColor"></path><circle cx="11" cy="11" r="2" fill="currentColor"></circle><circle cx="11" cy="21" r="2" fill="currentColor"></circle><circle cx="21" cy="21" r="2" fill="currentColor"></circle><circle cx="22" cy="28" r="2" fill="currentColor"></circle><circle cx="28" cy="24" r="2" fill="currentColor"></circle><circle cx="4" cy="11" r="2" fill="currentColor"></circle><circle cx="28" cy="4" r="2" fill="currentColor"></circle>',11)]))}}),ta={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 32 32"},aa=P({name:"ScriptReference",render:function(c,r){return w(),A("svg",ta,r[0]||(r[0]=[h("path",{d:"M4 20v2h4.586L2 28.586L3.414 30L10 23.414V28h2v-8H4z",fill:"currentColor"},null,-1),h("path",{d:"M27.17 26l-2.58 2.58L26 30l4-4l-4-4l-1.42 1.41L27.17 26z",fill:"currentColor"},null,-1),h("path",{d:"M18.83 26l2.58-2.58L20 22l-4 4l4 4l1.42-1.41L18.83 26z",fill:"currentColor"},null,-1),h("path",{d:"M25.7 9.3l-7-7A.909.909 0 0 0 18 2H8a2.006 2.006 0 0 0-2 2v12h2V4h8v6a2.006 2.006 0 0 0 2 2h6v6h2v-8a.91.91 0 0 0-.3-.7zM18 10V4.4l5.6 5.6z",fill:"currentColor"},null,-1)]))}}),na={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 1024 1024"},oa=P({name:"BellOutlined",render:function(c,r){return w(),A("svg",na,r[0]||(r[0]=[h("path",{d:"M816 768h-24V428c0-141.1-104.3-257.7-240-277.1V112c0-22.1-17.9-40-40-40s-40 17.9-40 40v38.9c-135.7 19.4-240 136-240 277.1v340h-24c-17.7 0-32 14.3-32 32v32c0 4.4 3.6 8 8 8h216c0 61.8 50.2 112 112 112s112-50.2 112-112h216c4.4 0 8-3.6 8-8v-32c0-17.7-14.3-32-32-32zM512 888c-26.5 0-48-21.5-48-48h96c0 26.5-21.5 48-48 48zM304 768V428c0-55.6 21.6-107.8 60.9-147.1S456.4 220 512 220c55.6 0 107.8 21.6 147.1 60.9S720 372.4 720 428v340H304z",fill:"currentColor"},null,-1)]))}}),sa={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 20 20"},la=P({name:"AttachArrowRight20Filled",render:function(c,r){return w(),A("svg",sa,r[0]||(r[0]=[h("g",{fill:"none"},[h("path",{d:"M5.28 10.609l5.304-5.304a2.75 2.75 0 0 1 4.064 3.697a5.487 5.487 0 0 1 1.611.285a4.252 4.252 0 0 0-6.736-5.042L4.22 9.548a.75.75 0 0 0 1.06 1.06zm2.829 4.95l.893-.894a5.48 5.48 0 0 0 .349 1.773l-.182.181A2.75 2.75 0 0 1 5.28 12.73l5.657-5.657a.75.75 0 1 1 1.06 1.06l-5.656 5.658a1.25 1.25 0 0 0 1.768 1.768zM19 14.5a4.5 4.5 0 1 1-9 0a4.5 4.5 0 0 1 9 0zm-2.147.354l.003-.003a.499.499 0 0 0 .144-.348v-.006a.5.5 0 0 0-.146-.35l-2-2a.5.5 0 0 0-.708.707L15.293 14H12.5a.5.5 0 0 0 0 1h2.793l-1.147 1.146a.5.5 0 0 0 .708.708l2-2z",fill:"currentColor"})],-1)]))}}),ia={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 24 24"},ra=P({name:"Play24Regular",render:function(c,r){return w(),A("svg",ia,r[0]||(r[0]=[h("g",{fill:"none"},[h("path",{d:"M7.608 4.615a.75.75 0 0 0-1.108.659v13.452a.75.75 0 0 0 1.108.659l12.362-6.726a.75.75 0 0 0 0-1.318L7.608 4.615zM5 5.274c0-1.707 1.826-2.792 3.325-1.977l12.362 6.726c1.566.853 1.566 3.101 0 3.953L8.325 20.702C6.826 21.518 5 20.432 5 18.726V5.274z",fill:"currentColor"})],-1)]))}});var ce,Te;function ca(){if(Te)return ce;Te=1;function z(c){return c===null}return ce=z,ce}var pa=ca();const ua=Ke(pa);function ue(z){var b,t,$,i,I,x,R,y,m,g,_,C,T,M,j,N,G,k,O,F,U,v,q,K,J;const c=W();c.expFolderId=String(z.data.exp_folder_id||"root"),c.expInfo=z.data,c.program={waveform_script:(t=(b=z.data)==null?void 0:b.exp)==null?void 0:t.waveform_script.map(s=>(ee(s,(n,p)=>{ua(n)&&(s[p]=void 0),typeof s.wave_names=="string"&&(s.wave_names=[s.wave_names]),typeof s.channels=="string"&&(s.channels=[s.channels]),typeof s.wave_ids=="string"&&(s.wave_ids=[s.wave_ids])}),s)),space_parameter_script:(i=($=z.data)==null?void 0:$.exp)==null?void 0:i.space_parameter_script},c.running={formValue:{title:(x=(I=z.data)==null?void 0:I.exp)==null?void 0:x.title,desc:(y=(R=z.data)==null?void 0:R.exp)==null?void 0:y.desc,...(g=(m=z.data)==null?void 0:m.exp)==null?void 0:g.options},paramsList:[]};const r=JSON.parse(JSON.stringify(c.allQubits));let l=[];ee((T=(C=(_=z.data)==null?void 0:_.exp)==null?void 0:C.wave_circuit)==null?void 0:T.gates,s=>{l=l.concat(s.entity)}),l.length>0&&r.forEach(s=>{l.includes(s.value)?s.visible=!0:s.visible=!1}),c.allQubits=r,le((N=(j=(M=z.data)==null?void 0:M.exp)==null?void 0:j.wave_circuit)==null?void 0:N.gates)||(c.gates=(O=(k=(G=z.data)==null?void 0:G.exp)==null?void 0:k.wave_circuit)==null?void 0:O.gates),le((v=(U=(F=z.data)==null?void 0:F.exp)==null?void 0:U.wave_circuit)==null?void 0:v.layers)||(c.layers=Object.values((J=(K=(q=z.data)==null?void 0:q.exp)==null?void 0:K.wave_circuit)==null?void 0:J.layers))}const da=P({__name:"HomeTabs",setup(z){const{t:c}=ne(),r=Z(),l=de(),b=W(),t=B(),$=i=>{l.push({name:i,query:r.query})};return Me(r,i=>{t.value=i.name},{deep:!0,immediate:!0}),_e(()=>{X(()=>{t.value=r.name})}),(i,I)=>{const x=Xe,R=Ye;return w(),D(R,{type:"card",animated:"",placement:"top",value:e(t),"onUpdate:value":I[0]||(I[0]=y=>Ne(t)?t.value=y:null),onUpdateValue:$},{default:a(()=>{var y,m,g,_,C,T;return[o(x,{name:"expSettings",tab:u("div",{class:"flex items-center gap-2"},[u("div",{class:"flex items-center"},u(e(Q),{size:20},{default:()=>u(e(pe))})),u("div",[u("div",{class:"font-bold"},e(c)("expInfo.expSettings"))])])},null,8,["tab"]),o(x,{name:"waveforms",tab:u("div",{class:"flex items-center gap-2"},[u("div",{class:"flex items-center"},u(e(Q),{size:20},{default:()=>u(e(Ct))})),u("div",[u("div",{class:"font-bold"},e(c)("expInfo.waveforms"))])])},null,8,["tab"]),o(x,{name:"program",tab:u("div",{class:"flex items-center gap-2"},[u("div",{class:"flex items-center"},u(e(Q),{size:20},{default:()=>u(e(aa))})),u("div",[u("div",{class:"font-bold"},e(c)("expInfo.program"))])])},null,8,["tab"]),o(x,{name:"expparams",tab:u("div",{class:"flex items-center gap-2"},[u("div",{class:"flex items-center"},u(e(Q),{size:20},{default:()=>u(e(Be))})),u("div",[u("div",{class:"font-bold"},e(c)("expInfo.expparams"))])])},null,8,["tab"]),o(x,{name:"finalSetting",disabled:!((y=e(b).expInfo)!=null&&y.exp_id),tab:u("div",{class:"flex items-center gap-2"},[u("div",{class:"flex items-center"},u(e(Q),{size:20},{default:()=>u(e(ea))})),u("div",[u("div",{class:"font-bold"},e(c)("expInfo.plotter"))])])},null,8,["disabled","tab"]),o(x,{name:"result",disabled:!((m=e(b).expInfo)!=null&&m.exp_id),tab:u("div",{class:"flex items-center gap-2"},[u("div",{class:"flex items-center"},u(e(Q),{size:20},{default:()=>u(e(qt))})),u("div",[u("div",{class:"font-bold"},e(c)("expInfo.fitting"))])])},null,8,["disabled","tab"]),o(x,{name:"attachment",disabled:!((g=e(b).expInfo)!=null&&g.exp_id),tab:u("div",{class:"flex items-center gap-2"},[u("div",{class:"flex items-center"},u(e(Q),{size:20},{default:()=>u(e(la))})),u("div",[u("div",{class:"font-bold"},e(c)("expInfo.attachment"))])])},null,8,["disabled","tab"]),o(x,{name:"expmsg",disabled:!((_=e(b).expInfo)!=null&&_.exp_id),tab:u("div",{class:"flex items-center gap-2"},[u("div",{class:"flex items-center"},u(e(Et),{max:15,value:(T=(C=e(b).expInfo)==null?void 0:C.exp_msg)==null?void 0:T.length,class:"cursor-pointer"},{default:()=>u(e(Q),{size:22,component:e(oa)})})),u("div",[u("div",{class:"font-bold"},e(c)("expInfo.msg"))])])},null,8,["disabled","tab"])]}),_:1},8,["value"])}}}),_a={class:"z-breadcrumb-item__link"},fa={class:"min-w-[300px]"},ma=P({__name:"BreadNav",props:{paths:{}},setup(z){const c=z,r=W(),l=Z(),{t:b}=ne(),t=({exp_folder_id:i},I)=>{const x={device_group_name:l.query.device_group_name,space_id:l.query.space_id};i&&(x.fid=String(i)||"");const R=new URLSearchParams(x);window.open(`/groupDetail/space/exps?${R.toString()}`,te(I))},$=ie(()=>c.paths?c.paths:Ze(r.expFolderTree||[],r.expFolderId==="root"?null:+r.expFolderId));return(i,I)=>{const x=Q,R=Ve,y=Qe,m=Nt;return w(),A("div",null,[o(m,{separator:">"},{default:a(()=>[qe(i.$slots,"default"),(w(!0),A(et,null,tt(e($),(g,_)=>(w(),D(y,{onClick:C=>t(g,C),separator:">",key:g.exp_folder_id},{default:a(()=>[h("span",_a,[o(R,{"show-arrow":!1,placement:"bottom-start"},{trigger:a(()=>[h("div",null,[_===0?(w(),D(x,{key:0,component:e(Ft)},null,8,["component"])):(w(),D(x,{key:1,component:e(Mt)},null,8,["component"])),f(" "+d(g.exp_folder_name),1)])]),default:a(()=>[h("div",fa,[o(H,null,{label:a(()=>[f(d(e(b)("groupDetail.exps.expFolderId")),1)]),default:a(()=>[f(" "+d(g.exp_folder_id||"-"),1)]),_:2},1024),o(H,null,{label:a(()=>[f(d(e(b)("groupDetail.exps.createTime")),1)]),default:a(()=>[f(" "+d(g.create_time?e(se)(g.create_time):"-"),1)]),_:2},1024),o(H,null,{label:a(()=>[f(d(e(b)("groupDetail.exps.updateTime")),1)]),default:a(()=>[f(" "+d(e(se)(g.update_time)?e(se)(g.update_time):"-"),1)]),_:2},1024),o(H,null,{label:a(()=>[f(d(e(b)("groupDetail.exps.creator")),1)]),default:a(()=>[f(" "+d(g.create_user_name||"-"),1)]),_:2},1024)])]),_:2},1024)])]),_:2},1032,["onClick"]))),128)),qe(i.$slots,"suffix")]),_:3})])}}}),xa={class:"flex justify-between items-center"},ga={class:"min-w-[400px]"},va={class:"z-breadcrumb-item__link !cursor-pointer"},wa={class:"min-w-[300px]"},ya={class:"flex mb-2 justify-between items-center gap-2"},ha={class:"font-bold inline-flex items-center gap-2"},ba={class:"text-xs opacity-70 italic"},Ia=P({__name:"HomeHeader",setup(z){const c=Ue(),r=W(),l=Z(),{t:b}=ne(),t=B(),$=()=>{var y;(y=t.value)==null||y.open()},i=y=>{var m,g;(m=c.groupInfo)!=null&&m.organization_id&&window.open(`/deviceGroup?org=${(g=c.groupInfo)==null?void 0:g.organization_id}`,te(y))},I=y=>{const m=l.query.device_group_name;m&&window.open(`/groupDetail/overview?device_group_name=${m}`,te(y))},x=ie(()=>{const y=l.query.space_id,m=c.spaceList;return m==null?void 0:m.find(g=>String(g.space_id)===String(y))}),R=y=>{var m;if((m=x.value)!=null&&m.space_id){const g=new URLSearchParams({device_group_name:l.query.device_group_name,space_id:String(x.value.space_id)});window.open(`/groupDetail/space/exps?${g.toString()}`,te(y))}};return(y,m)=>{const g=Q,_=Ve,C=Qe,T=Le,M=Ae,j=fe,N=st,G=lt;return w(),D(G,{type:"info","show-icon":!1,class:"!py-0 mb-2 !font-bold"},{default:a(()=>[h("div",xa,[o(ma,null,{suffix:a(()=>[o(C,null,{default:a(()=>{var k,O,F;return[o(g,{component:e(pe)},null,8,["component"]),(O=(k=e(r))==null?void 0:k.expInfo)!=null&&O.exp_id?(w(),D(T,{key:0,color:{color:"#7816ff",textColor:"#fff"},size:"tiny",class:"top-[-1px] relative ml-1"},{default:a(()=>{var U,v;return[f(d(e(b)("expInfo.exp"))+" "+d((v=(U=e(r))==null?void 0:U.expInfo)==null?void 0:v.exp_id),1)]}),_:1})):ae("",!0),f(" "+d((F=e(r).expInfo)==null?void 0:F.exp_title),1)]}),_:1})]),default:a(()=>[o(C,{onClick:m[0]||(m[0]=k=>i(k))},{default:a(()=>[o(_,{"show-arrow":!1,placement:"bottom-start"},{trigger:a(()=>{var k;return[h("div",null,[o(g,{component:e(at)},null,8,["component"]),f(" "+d((k=e(c).groupInfo)==null?void 0:k.organization_name),1)])]}),default:a(()=>[f(" "+d(e(b)("expInfo.org")),1)]),_:1})]),_:1}),o(C,{onClick:m[1]||(m[1]=k=>I(k))},{default:a(()=>[o(_,{"show-arrow":!1,placement:"bottom-start",delay:500},{trigger:a(()=>{var k;return[h("div",null,[o(g,{component:e(ot)},null,8,["component"]),f(" "+d((k=e(c).groupInfo)==null?void 0:k.device_group_name),1)])]}),default:a(()=>[h("div",ga,[e(c).groupInfo?(w(),D(nt,{key:0,card:e(c).groupInfo},null,8,["card"])):ae("",!0)])]),_:1})]),_:1}),e(x)?(w(),D(C,{key:0,onClick:m[2]||(m[2]=k=>R(k))},{default:a(()=>[h("span",va,[o(_,{"show-arrow":!1,placement:"bottom-start",delay:500},{trigger:a(()=>{var k;return[h("div",null,[o(g,{component:e(Be)},null,8,["component"]),f(" "+d((k=e(x))==null?void 0:k.space_name),1)])]}),default:a(()=>{var k,O;return[h("div",wa,[h("div",ya,[h("div",ha,[o(T,{size:"tiny",color:{textColor:"#fff",color:"#CA00FF"}},{default:a(()=>{var F;return[f("#"+d((F=e(x))==null?void 0:F.space_id),1)]}),_:1}),f(" "+d((k=e(x))==null?void 0:k.space_name),1)]),h("div",ba,d(e(se)((O=e(x))==null?void 0:O.create_time)),1)]),o(M,{class:"text-xs opacity-70 italic","line-clamp":1},{default:a(()=>{var F;return[f(d((F=e(x))==null?void 0:F.description),1)]}),_:1})])]}),_:1})])]),_:1})):ae("",!0)]),_:1}),o(N,null,{default:a(()=>[o(j,{type:"primary",size:"small",onClick:$},{icon:a(()=>[o(e(pe))]),default:a(()=>[f(" "+d(e(b)("expInfo.continueCreate")),1)]),_:1})]),_:1})]),o($t,{ref_key:"expsTplRef",ref:t,fid:e(r).expFolderId||"root"},null,8,["fid"])]),_:1})}}}),za=Pe(Ia,[["__scopeId","data-v-1d12ea59"]]),ka=P({__name:"TemplateData",props:{templateData:{}},setup(z,{expose:c}){const r=it(),l=B(!1),b=()=>{l.value=!0},t=()=>{l.value=!1};return c({open:b}),($,i)=>{const I=Oe,x=rt;return w(),D(x,{show:e(l),"onUpdate:show":i[0]||(i[0]=R=>Ne(l)?l.value=R:null),"auto-focus":!1},{default:a(()=>[o(ct,{style:{width:"700px"}},{default:a(()=>[o(pt,null,{default:a(()=>i[1]||(i[1]=[f(" Template Data ")])),_:1}),o(ut,null,{default:a(()=>[o(I,{style:{"max-height":"calc(100vh - 350px)","min-height":"200px"}},{default:a(()=>[o(e(Kt),{class:dt(["w-full",[e(r).baseColor==="#000"?"jse-theme-dark":""]]),"model-value":$.templateData,mode:"text",ref:"jsonEditorRef"},null,8,["class","model-value"])]),_:1})]),_:1}),o(_t,{onCancel:t})]),_:1})]),_:1},8,["show"])}}}),Sa=P({__name:"ExpInfoView",setup(z,{expose:c}){je();const r=ft(),l=Z(),b=de(),t=W(),$=Ue(),i=B(),I=()=>{var s,n,p;(n=(s=t.expInfo)==null?void 0:s.exp)!=null&&n.template&&((p=i.value)==null||p.open())},x=async()=>{const s=l.query.device_group_name;if(!s)return;const[n,p]=await gt({device_group_name:s});if(!n&&(p==null?void 0:p.status)===0){const{space_list:S,...E}=p.data;$.groupInfo=E;const V=[];ee(S,L=>{V.push({...L||{},label:L.space_name,value:L.space_id})}),$.spaceList=V}},R=async()=>{var p;if(l.query.exp_id===void 0||l.query.exp_id==="")return;const[s,n]=await Gt({exp_id:l.query.exp_id,device_group_name:l.query.device_group_name,space_id:l.query.space_id});!s&&(n==null?void 0:n.status)===0&&((p=n.data)!=null&&p.data&&(n.data.data=JSON.parse(n.data.data)),t.result=n.data)},y=async()=>{t.loading=!0;const{device_group_name:s,exp_id:n}=l.query;if(!s||!n){t.loading=!1;return}const[p,S]=await Ut({device_group_name:s,exp_id:n});t.loading=!1,!p&&(S==null?void 0:S.status)===0&&(ue(S),X(()=>{l.query.dup&&(G(),X(()=>{setTimeout(()=>{b.replace({name:"expSettings",query:re(l.query,["dup","fid"])})},300)}))}),l.query.dup||R())},m=async()=>{var p;if((p=t==null?void 0:t.expInfo)!=null&&p.status&&[Y.COMPLETE,Y.CANCELED,Y.ERROR].includes(t.expInfo.status)){C();return}if(!l.query.exp_id){C();return}const[s,n]=await Qt({device_group_name:l.query.device_group_name,exp_id:l.query.exp_id});!s&&(n==null?void 0:n.status)===0&&(t.expInfo={...t.expInfo,...n.data||{}})},g=async()=>{var p,S;const[s,n]=await Vt();if(!s&&(n==null?void 0:n.status)===0){const E={};Object.keys(n.data).forEach(L=>{E[L]=n.data[L].default?n.data[L].default:void 0});const V=(S=(p=t.expInfo)==null?void 0:p.exp)==null?void 0:S.options;t.expOptions=n.data,t.running={...t.running,formValue:{...t.running.formValue,...le(V)?E:{}}}}},{start:_,stop:C}=Jt(m,{isManual:!0,duration:3*1e3}),T=async()=>{const[s,n]=await Lt();!s&&(n==null?void 0:n.status)===0&&(t.waveCompiler=n.data)},M=async()=>{const[s,n]=await At();!s&&(n==null?void 0:n.status)===0&&(t.waveFunctions=n.data)},j=async()=>{const[s,n]=await Pt({device_group_name:l.query.device_group_name,space_id:l.query.space_id});if(!s&&(n==null?void 0:n.status)===0){let p=[];if(ee(n.data,(S,E)=>{p=p.concat(S.map((V,L)=>({id:Wt(),value:V,visible:L<10,type:E})))}),t.allQubits=p,!l.query.exp_id){const S=JSON.parse(JSON.stringify(t.allQubits));let E=[];ee(t==null?void 0:t.gates,V=>{E=E.concat(V.entity)}),E.length>0&&S.forEach(V=>{E.includes(V.value)?V.visible=!0:V.visible=!1}),t.allQubits=S;return}X(()=>{y(),_()})}},N=s=>{const n=new URLSearchParams({device_group_name:l.query.device_group_name,space_id:l.query.space_id,exp_id:l.query.exp_id,dup:String(1),fid:t.expFolderId||"root"});window.open(`/experiment/expSettings?${n.toString()}`,te(s))},G=()=>{const s=JSON.parse(JSON.stringify(t.expInfo));delete s.exp_id,delete s.progress,delete s.status,delete s.exp_msg,delete s.space_timestamp,t.expInfo=s,t.result=void 0,X(()=>{r.success("Duplicated successfully"),b.replace({name:"expSettings",query:re(l.query,["exp_id"])})})},k=async()=>{const[s,n]=await Ot({exp_id:l.query.exp_id});!s&&(n==null?void 0:n.status)===0&&r.success("实验终止成功")};_e(()=>{g(),j(),x(),J(),setTimeout(()=>{T(),M()},100)}),Me(l,s=>{if(s.query.create=="1"){const n=He("t"),p=s.query.fid;n&&(ue(n),X(()=>{setTimeout(()=>{b.replace({name:"expSettings",query:re(l.query,["create","fid"])}).then(()=>{p&&(t.expFolderId=p),localStorage.removeItem("t")})},200)}))}},{immediate:!0});const O=async()=>{var me,xe,ge,ve,we,ye,he,be,Ie,ze,ke,Se,Ce;if(t.showPlotParamsModal)return;t.showPlotParamsModal=!0;const s={};(me=t==null?void 0:t.layers)==null||me.forEach((Ge,Je)=>{s[String(Je)]=Ge});const{title:n,desc:p,...S}=(xe=t.running)==null?void 0:xe.formValue,E={template_name:(ve=(ge=t==null?void 0:t.expInfo)==null?void 0:ge.exp)==null?void 0:ve.template.split("/")[1],device_group_name:l.query.device_group_name,space_id:l.query.space_id,experiment_json:{...(t==null?void 0:t.expInfo)||{},title:n,desc:p,template:(ye=(we=t==null?void 0:t.expInfo)==null?void 0:we.exp)==null?void 0:ye.template,template_data:(be=(he=t==null?void 0:t.expInfo)==null?void 0:he.exp)==null?void 0:be.template_data,wave_circuit:{gates:(t==null?void 0:t.gates)||{},layers:s},waveform_script:((Ie=t==null?void 0:t.program)==null?void 0:Ie.waveform_script)||[],space_parameter_script:((ze=t==null?void 0:t.program)==null?void 0:ze.space_parameter_script)||[],options:S},exp_folder_id:t.expFolderId==="root"?null:t.expFolderId};(ke=E==null?void 0:E.experiment_json)!=null&&ke.exp&&((Se=E==null?void 0:E.experiment_json)==null||delete Se.exp),(Ce=E==null?void 0:E.experiment_json)==null||delete Ce.nr;const[V,L]=await jt(E);t.showPlotParamsModal=!1,!V&&(L==null?void 0:L.status)===0&&(r.success("Experiment Running"),b.replace({name:"finalSetting",query:{...l.query,exp_id:L.data.exp_id}}).then(()=>{window.location.reload()}))};mt(C);const F=async()=>{var p,S;const[s,n]=await Ht({group_name:l.query.device_group_name,exp_id:String((p=t==null?void 0:t.expInfo)==null?void 0:p.exp_id)});!s&&(n==null?void 0:n.status)===0&&De.saveAs(`${oe(location.origin)}/${oe((S=n==null?void 0:n.data)==null?void 0:S.filename)}`,Ee(n.data.filename))},U=async()=>{var p,S;const[s,n]=await Bt({group_name:l.query.device_group_name,space_id:l.query.space_id,version:String((p=t.expInfo)==null?void 0:p.space_timestamp)});!s&&(n==null?void 0:n.status)===0&&De.saveAs(`${oe(location.origin)}/${oe((S=n==null?void 0:n.data)==null?void 0:S.filename)}`,Ee(n.data.filename))};B(!1),B(),B();const v=B(!1),q=B(!1),K=()=>{var s;(s=t.expInfo)!=null&&s.exp_id?q.value=!0:v.value=!0},J=async()=>{if(!l.query.device_group_name)return;const[n,p]=await Rt({space_id:+(l.query.space_id||""),include_experiments:!1});!n&&p&&p.status===0&&(Array.isArray(p.data.folder_tree)||(p.data.folder_tree=[p.data.folder_tree]),t.expFolderTree=p.data.folder_tree)};return xt(()=>{J()}),c({downloadFile:F,downloadParams:U,openTemplateInfo:I,showParams:K,run:O,stop:k,duplicate:N}),(s,n)=>{var p,S,E;return w(),D(ka,{ref_key:"tempalteDataRef",ref:i,"template-data":(E=(S=(p=e(t))==null?void 0:p.expInfo)==null?void 0:S.exp)==null?void 0:E.template_data},null,8,["template-data"])}}}),Ca=Pe(Sa,[["__scopeId","data-v-6f817a07"]]),qa={style:{height:"calc(100vh - 310px)"}},Ea={class:"flex justify-center"},$a={class:"text-lg font-bold w-full text-center"},Ra={class:"mt-4 opacity-70 text-xs w-full italic text-center"},Da={key:1},Fa={key:1},Ta={key:1},Ma={class:"flex items-center"},Na={class:"break-all inline-block whitespace-pre-line leading-[1.2]"},Va={key:2},La={class:"inline-flex items-center"},Aa={class:"break-all inline-block whitespace-pre-line leading-[1.2]"},Pa=P({__name:"HomeInfo",setup(z,{expose:c}){const r=B(),l=Z(),b=de(),{t}=ne(),$=W(),{expInfo:i}=vt($),I=ie(()=>{var _;return $e(((_=$.result)==null?void 0:_.small_picture_url)||"","t",String(+new Date))}),x=ie(()=>{var _,C;return((_=$.result)==null?void 0:_.big_picture_url)||$e(((C=$.result)==null?void 0:C.small_picture_url)||"","t",String(+new Date))}),R=()=>{var _;(_=r.value)==null||_.downloadFile()},y=()=>{var _;(_=r.value)==null||_.downloadParams()},m=()=>{var _;(_=r.value)==null||_.openTemplateInfo()},g=()=>{b.push({name:"expparams",query:l.query})};return c({run:()=>{var _;return(_=r.value)==null?void 0:_.run()},stop:()=>{var _;return(_=r.value)==null?void 0:_.stop()},duplicate:_=>{var C;return(C=r.value)==null?void 0:C.duplicate(_)}}),(_,C)=>{var F,U;const T=Xt,M=Ae,j=wt,N=Le,G=fe,k=bt,O=Oe;return w(),A("div",qa,[o(Ca,{ref_key:"expInfoViewRef",ref:r},null,512),h("div",Ea,[(F=e($).result)!=null&&F.small_picture_url?(w(),D(T,{key:0,src:e(I),"preview-src":e(x),alt:"",class:"!w-[140px] !h-[140px] mb-2 cursor-pointer"},null,8,["src","preview-src"])):ae("",!0)]),h("div",$a,[o(M,null,{default:a(()=>{var v,q;return[f(d((q=(v=e(i))==null?void 0:v.exp)==null?void 0:q.title),1)]}),_:1})]),h("div",Ra,[o(M,null,{default:a(()=>{var v,q;return[f(d((q=(v=e(i))==null?void 0:v.exp)==null?void 0:q.desc),1)]}),_:1})]),o(j),o(O,{style:yt({maxHeight:`calc(100vh - ${(U=e($).result)!=null&&U.small_picture_url?556:408}px`})},{default:a(()=>[o(H,null,{label:a(()=>[f(d(e(t)("expInfo.expId")),1)]),default:a(()=>{var v;return[(v=e(i))!=null&&v.exp_id?(w(),D(N,{key:0,class:"flex justify-center items-center min-w-[150px]",color:{color:"#7816ff",textColor:"#fff"},size:"small"},{default:a(()=>{var q;return[f(d((q=e(i))==null?void 0:q.exp_id),1)]}),_:1})):(w(),D(N,{key:1,size:"small",bordered:!1,color:{color:"#f00",textColor:"#fff"},class:"flex justify-center items-center min-w-[150px]"},{default:a(()=>[f(d(e(t)("expInfo.unsumbit")),1)]),_:1}))]}),_:1}),o(H,null,{label:a(()=>[f(d(e(t)("groupDetail.exps.status")),1)]),default:a(()=>{var v;return[(v=e(i))!=null&&v.status?(w(),D(N,{key:0,color:{color:e(Re)[e(i).status].color,textColor:"#fff"},bordered:!1,size:"small",class:"min-w-[150px] flex justify-center"},{default:a(()=>[f(d(e(t)(e(Re)[e(i).status].text)),1)]),_:1},8,["color"])):(w(),A("span",Da,"-"))]}),_:1}),o(H,null,{label:a(()=>[f(d(e(t)("groupDetail.exps.progress")),1)]),default:a(()=>{var v;return[(v=e(i))!=null&&v.progress?(w(),D(N,{key:0,size:"small",type:"info",class:"flex justify-center items-center min-w-[150px]"},{default:a(()=>{var q;return[f(d(e(ht)((q=e(i))==null?void 0:q.progress,!0)),1)]}),_:1})):(w(),A("span",Fa,"-"))]}),_:1}),o(H,null,{label:a(()=>[f(d(e(t)("groupDetail.exps.source")),1)]),default:a(()=>{var v;return[(v=e(i))!=null&&v.source?(w(),D(N,{key:0,size:"small",type:"info",class:"flex justify-center items-center min-w-[150px]"},{default:a(()=>{var q;return[f(d((q=e(i))==null?void 0:q.source),1)]}),_:1})):(w(),A("span",Ta,"-"))]}),_:1}),o(H,null,{label:a(()=>[f(d(e(t)("groupDetail.exps.tpl")),1)]),default:a(()=>{var v,q,K,J;return[h("div",Ma,[(q=(v=e(i))==null?void 0:v.exp)!=null&&q.template?(w(),D(k,{key:0,trigger:"hover"},{trigger:a(()=>[o(G,{type:"info",class:"!mx-2",size:"tiny",onClick:R},{icon:a(()=>[o(e(Fe))]),_:1})]),default:a(()=>[f(" "+d(e(t)("expInfo.downloadExp")),1)]),_:1})):ae("",!0),(J=(K=e(i))==null?void 0:K.exp)!=null&&J.template?(w(),D(N,{key:1,type:"warning",size:"small",class:"!break-all flex justify-center items-center min-w-[150px] !cursor-pointer !h-auto !min-h-6 !py-1",onClick:m},{default:a(()=>[o(M,{"line-clamp":1,class:"max-w-[200px]"},{default:a(()=>{var s,n,p,S;return[h("span",Na,d(((n=(s=e(i))==null?void 0:s.exp)==null?void 0:n.template)==="-"?"No Template":(S=(p=e(i))==null?void 0:p.exp)==null?void 0:S.template),1)]}),_:1})]),_:1})):(w(),A("span",Va,"-"))])]}),_:1}),o(H,null,{label:a(()=>[f(d(e(t)("expInfo.space")),1)]),default:a(()=>[h("div",La,[o(k,{trigger:"hover"},{trigger:a(()=>[o(G,{type:"info",class:"!mx-2",size:"tiny",onClick:y},{icon:a(()=>[o(e(Fe))]),_:1})]),default:a(()=>[f(" "+d(e(t)("expInfo.downloadSpaceParams")),1)]),_:1}),o(N,{size:"small",class:"!cursor-pointer !h-auto !min-h-6 !py-1",type:"warning",onClick:g},{default:a(()=>[o(M,{"line-clamp":1,class:"max-w-[200px]"},{default:a(()=>{var v,q;return[h("span",Aa,d((v=e(i))==null?void 0:v.space_name)+" ( "+d((q=e(i))==null?void 0:q.space_time_str)+" ) ",1)]}),_:1})]),_:1})])]),_:1}),o(H,null,{label:a(()=>[f(d(e(t)("groupDetail.exps.createTime")),1)]),default:a(()=>{var v;return[f(" "+d((v=e(i))==null?void 0:v.create_time),1)]}),_:1})]),_:1},8,["style"])])}}}),Oa={class:"flex-1 flex flex-col gap-2 justify-between"},ja=P({__name:"HomeActions",emits:["duplicate","stop","run"],setup(z,{emit:c}){const r=c,{t:l}=ne(),b=Z(),t=W(),$=x=>{r("duplicate",x)},i=()=>{r("stop")},I=()=>{r("run")};return(x,R)=>{var m,g,_,C,T,M,j;const y=fe;return w(),A("div",Oa,[o(y,{type:"info",size:"small",class:"w-full",onClick:$,disabled:((_=(g=(m=e(t))==null?void 0:m.expInfo)==null?void 0:g.exp)==null?void 0:_.exp_mode)==="batch_circuit"||!e(b).query.exp_id},{icon:a(()=>[o(e(Tt))]),default:a(()=>[f(d(e(l)("expInfo.duplicate"))+" ",1)]),_:1},8,["disabled"]),o(y,{type:"info",size:"small",disabled:!((C=e(t).expInfo)!=null&&C.status)||![e(Y).SERVICE_QUEUING,e(Y).RUNNING,e(Y).HOST_DOWNLOADED].includes((T=e(t).expInfo)==null?void 0:T.status),onClick:i},{icon:a(()=>[o(e(Dt))]),default:a(()=>[f(d(e(l)("expInfo.stop"))+" ",1)]),_:1},8,["disabled"]),o(y,{type:"primary",size:"small",loading:e(t).showPlotParamsModal,onClick:I,disabled:!!((j=(M=e(t))==null?void 0:M.expInfo)!=null&&j.exp_id)},{icon:a(()=>[o(e(ra))]),default:a(()=>[f(d(e(l)("expInfo.run"))+" ",1)]),_:1},8,["loading","disabled"])])}}}),Ha={class:"flex flex-col gap-2"},yn=P({__name:"ExperimentView",setup(z){const c=B(),r=je(),l=W();_e(()=>{const i=He("t");if(le(i)||(l.reset(),X(()=>{ue(i),localStorage.removeItem("t")})),!r.expInfoSplitSize){const I=document.documentElement.clientWidth||document.body.clientWidth;r.expInfoSplitSize=1-(400/I>1?.9:400/I)}});const b=()=>{var i;(i=c.value)==null||i.run()},t=()=>{var i;(i=c.value)==null||i.stop()},$=i=>{var I;(I=c.value)==null||I.duplicate(i)};return(i,I)=>{const x=It("router-view"),R=zt,y=Yt;return w(),A("div",null,[o(za),o(y,{direction:"horizontal",style:{height:"calc(100vh - 165px)"},"resize-trigger-size":12,min:"150px",max:.9,size:e(r).expInfoSplitSize,"onUpdate:size":I[0]||(I[0]=m=>e(r).expInfoSplitSize=m)},{1:a(()=>[o(R,{"content-class":"!p-2 flex flex-col h-full",style:{minHeight:"calc(100vh - 165px"}},{default:a(()=>[o(da,{class:"!mb-2"}),o(x,null,{default:a(({Component:m})=>[(w(),D(kt,null,[(w(),D(St(m),{key:i.$route.fullPath}))],1024))]),_:1})]),_:1})]),2:a(()=>[h("div",Ha,[o(R,{"content-class":"!p-2"},{default:a(()=>[o(Pa,{ref_key:"homeInfoRef",ref:c},null,512)]),_:1}),o(R,{"content-class":"!p-2"},{default:a(()=>[o(ja,{onRun:b,onStop:t,onDuplicate:$})]),_:1})])]),"resize-trigger":a(()=>I[1]||(I[1]=[h("div",{class:"h-full !w-3"},null,-1)])),_:1},8,["size"])])}}});export{yn as default};
