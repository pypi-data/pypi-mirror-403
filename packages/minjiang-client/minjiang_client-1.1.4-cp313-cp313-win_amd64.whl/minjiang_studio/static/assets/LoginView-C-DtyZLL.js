import{G as L,u as v,P,d as U,a as j,b as q,c as V,r as f,g as E,o as M,e as N,f as R,h as c,i as l,w as u,_ as G,j as I,k as T,l as a,m as $,n as D,p as O,q as z,B as A,s as F,t as H,v as J,x as K,y as Q}from"./index-DJskbzIk.js";function W(p){return P(v.login,p)}function X(p){return L(v.clientStatus,p)}const Y={class:"h-full"},Z={class:"absolute top-1/2 left-1/2 -translate-1/2 rounded-2xl p-5 w-2xl"},ee={class:"flex items-center justify-between"},ne=U({__name:"LoginView",setup(p){const h=j(),{t,locale:b}=q(),k=V(),g=f(!1),m=f(null),n=f({default_language:E(),server_addr:"http://127.0.0.1:80",cache_dir:"~/minjiang_mc/client_cache"}),x={default_language:{required:!0},cache_dir:{required:!0,message:t("login.localCacheErrMsg")},user_token:{required:!0,message:t("login.tokenErrMsg")},server_addr:{required:!0,message:t("login.cloudServerErrMsg")}},y=o=>{K(o),b.value=o},w=()=>{var o;g.value||(g.value=!0,(o=m.value)==null||o.validate(async e=>{if(e){g.value=!1;return}const[s,r]=await W(n.value);if(g.value=!1,!s&&r&&r.status===0){const[d,_]=await Q({user_id:r.data.user_id});!d&&(_==null?void 0:_.status)===0&&h.$patch({info:{...r.data,..._.data}}),k.push({path:"/"})}}))};return M(async()=>{const[o,e]=await X({default_language:n.value.default_language});if(!o&&e&&e.status===0){const s=e.data;n.value={...n.value,default_language:s.default_language,cache_dir:s.cache_dir||"~/minjiang_mc/client_cache",user_token:s.set_user_token,server_addr:s.cloud_server_addr}}}),(o,e)=>{const s=I,r=D,d=$,_=O,C=A,S=T,B=J;return R(),N("div",Y,[e[6]||(e[6]=c("div",{class:"fixed inset-0 select-none h-screen w-screen",style:{"background-image":`linear-gradient(
          13deg,
          #cdd5e0,
          rgb(205, 213, 224),
          #e6e6e6,
          #bbc8d0
        )`}},null,-1)),c("div",Z,[l(B,null,{default:u(()=>[e[5]||(e[5]=c("div",{class:"flex items-center justify-center mb-5"},[c("img",{src:G,alt:"Logo",class:"h-12"})],-1)),l(s),l(S,{ref_key:"formRef",ref:m,model:a(n),rules:x},{default:u(()=>[l(d,{label:"Cloud Server",path:"server_addr"},{default:u(()=>[l(r,{value:a(n).server_addr,"onUpdate:value":e[0]||(e[0]=i=>a(n).server_addr=i),placeholder:a(t)("login.cloudServerPlaceholder")},null,8,["value","placeholder"])]),_:1}),l(d,{label:"Token",path:"user_token"},{default:u(()=>[l(r,{value:a(n).user_token,"onUpdate:value":e[1]||(e[1]=i=>a(n).user_token=i),placeholder:a(t)("login.tokenPlaceholder")},null,8,["value","placeholder"])]),_:1}),l(d,{label:a(t)("login.localCacheLabel"),path:"cache_dir"},{default:u(()=>[l(r,{value:a(n).cache_dir,"onUpdate:value":e[2]||(e[2]=i=>a(n).cache_dir=i),placeholder:a(t)("login.localCachePlaceholder")},null,8,["value","placeholder"])]),_:1},8,["label"]),l(d,{label:a(t)("login.language"),path:"default_language"},{default:u(()=>[l(_,{"onUpdate:value":[y,e[3]||(e[3]=i=>a(n).default_language=i)],placeholder:a(t)("login.languagePlaceholder"),value:a(n).default_language,options:a(z)},null,8,["placeholder","value","options"])]),_:1},8,["label"]),c("div",ee,[e[4]||(e[4]=c("div",{class:"flex items-center"},null,-1)),l(d,null,{default:u(()=>[l(C,{type:"primary",loading:a(g),onClick:w},{default:u(()=>[F(H(a(t)("login.submitBtn")),1)]),_:1},8,["loading"])]),_:1})])]),_:1},8,["model"])]),_:1})])])}}});export{ne as default};
