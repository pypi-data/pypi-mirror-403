import{d as P,J as G,r as U,b as H,A as K,at as Q,a6 as W,a3 as B,E as D,cz as s,ab as u,ac as m,l,f as n,w as y,e as k,ad as w,al as N,m as X,aF as Y,ar as Z,aa as F,i as O,af as g,s as ee,t as le,S as te,n as ae,k as ne,a5 as oe}from"./index-DJskbzIk.js";import{i as se}from"./json-editor-vue-cMpGPz9p.js";import{V as ue}from"./index-DDdGfEJ1.js";import{N as re}from"./InputNumber-CtZNiVVn.js";import{a as ie,_ as de}from"./Checkbox-B0NmEvB4.js";import{_ as pe,a as me}from"./RadioGroup-DFjU_ho_.js";import{N as _e}from"./Switch-BTGJkP8J.js";const ye=P({__name:"DynamicForm",props:{cfgs:{},disabled:{type:Boolean}},emits:["rerender"],setup(E,{expose:I,emit:R}){G(d=>({"2ccbb119":l(f).baseColor,"30db331a":l(f).primaryColor}));const V=U(!1),C=E,A=R,{t:T}=H(),f=K(),S=U(null),t=Q({}),J=U(),$=d=>new Promise((r,c)=>{var o;const _=()=>{const i=JSON.parse(JSON.stringify(t));return B(C.cfgs,(v,x)=>{if(v.dtype===s.dict||v.dtype===s.list)try{i[x]=typeof i[x]=="string"?JSON.parse(i[x]||"{}"):i[x]}catch(h){console.log(h),c(null)}}),i};if(d){const i=_();r(i)}else(o=S.value)==null||o.validate(i=>{if(i)c(null);else{const v=_();r(v)}})});W(()=>C.cfgs,d=>{if(d){const r=JSON.parse(JSON.stringify(d)),c={};B(t,(_,o)=>{delete t[o]}),D(()=>{B(r,(_,o)=>{c[o]={required:_.dtype!==s.text&&!!_.necessary,message:T("common.required")},r[o].default!==null&&(r[o].multi_choose?t[r[o].field]=Array.isArray(r[o].default)?r[o].default:[r[o].default]:t[r[o].field]=r[o].default)}),J.value=c,V.value=!0})}},{deep:!0,immediate:!0}),I({submit:$});const p=d=>{d.flag==="has_action"&&D(()=>{A("rerender")})};return(d,r)=>{const c=Y,_=de,o=g,i=ie,v=me,x=pe,h=ae,z=re,q=_e,j=X,L=ne;return l(V)?(n(),u(L,{key:0,model:l(t),rules:l(J),ref_key:"formRef",ref:S,disabled:d.disabled},{default:y(()=>[(n(!0),k(w,null,N(d.cfgs,(e,M)=>(n(),u(j,{key:M,label:e.dtype===l(s).text?"":e.title,path:e.field},{default:y(()=>[e.dtype===l(s).text?(n(),u(c,{key:0,class:"w-full",type:"info","show-icon":!1},{default:y(()=>[e.title?(n(),u(Z,{key:0,value:e.title||""},null,8,["value"])):m("",!0)]),_:2},1024)):m("",!0),e.dtype===l(s).enum&&e.options&&e.multi_choose?(n(),u(i,{key:1,"onUpdate:value":[()=>p(e),a=>l(t)[e.field]=a],value:l(t)[e.field],style:F({backgroundColor:l(f).dividerColor,padding:"6px 8px 6px 12px",borderRadius:"3px",width:"100%"})},{default:y(()=>[O(o,{size:"large",class:"!w-full"},{default:y(()=>[(n(!0),k(w,null,N(e.options,(a,b)=>(n(),u(_,{key:b,value:a},{default:y(()=>[ee(le(a),1)]),_:2},1032,["value"]))),128))]),_:2},1024)]),_:2},1032,["onUpdate:value","value","style"])):e.dtype===l(s).enum&&e.options?(n(),u(x,{key:2,value:l(t)[e.field],"onUpdate:value":[a=>l(t)[e.field]=a,()=>p(e)],style:F({backgroundColor:l(f).dividerColor,padding:"6px 8px 6px 12px",borderRadius:"3px",width:"100%"})},{default:y(()=>[O(o,{size:"large",class:"!w-full"},{default:y(()=>[(n(!0),k(w,null,N(e.options,(a,b)=>(n(),u(v,{key:b,value:b,label:a},null,8,["value","label"]))),128))]),_:2},1024)]),_:2},1032,["value","onUpdate:value","style"])):m("",!0),e.dtype===l(s).dict||e.dtype===l(s).list?(n(),u(l(se),{key:3,class:te(["w-full",[l(f).baseColor==="#000"?"jse-theme-dark":""]]),modelValue:l(t)[e.field],"onUpdate:modelValue":a=>l(t)[e.field]=a,mode:"text",onBlur:()=>p(e)},null,8,["class","modelValue","onUpdate:modelValue","onBlur"])):m("",!0),e.dtype===l(s).str&&e.is_python_script?(n(),u(l(ue),{key:4,height:"100px",value:l(t)[e.field],"onUpdate:value":a=>l(t)[e.field]=a,theme:"vs-dark",language:"python",onBlur:()=>p(e)},null,8,["value","onUpdate:value","onBlur"])):e.dtype===l(s).str&&e.multi_line?(n(),u(h,{key:5,value:l(t)[e.field],"onUpdate:value":a=>l(t)[e.field]=a,clearable:"",maxlength:e.max_length,type:"textarea",onBlur:()=>p(e)},null,8,["value","onUpdate:value","maxlength","onBlur"])):e.dtype===l(s).str?(n(),u(h,{key:6,value:l(t)[e.field],"onUpdate:value":a=>l(t)[e.field]=a,clearable:"",maxlength:e.max_length,onBlur:()=>p(e)},null,8,["value","onUpdate:value","maxlength","onBlur"])):m("",!0),e.dtype===l(s).int?(n(),u(z,{key:7,min:e.min,max:e.max,precision:0,class:"w-full",value:l(t)[e.field],"onUpdate:value":a=>l(t)[e.field]=a,onBlur:()=>p(e)},null,8,["min","max","value","onUpdate:value","onBlur"])):m("",!0),e.dtype===l(s).float?(n(),u(z,{key:8,min:e.min,max:e.max,value:l(t)[e.field],"onUpdate:value":a=>l(t)[e.field]=a,class:"w-full",onBlur:()=>p(e)},null,8,["min","max","value","onUpdate:value","onBlur"])):m("",!0),e.dtype===l(s).bool?(n(),u(q,{key:9,value:l(t)[e.field],"onUpdate:value":[a=>l(t)[e.field]=a,()=>p(e)]},null,8,["value","onUpdate:value"])):m("",!0)]),_:2},1032,["label","path"]))),128))]),_:1},8,["model","rules","disabled"])):m("",!0)}}}),Be=oe(ye,[["__scopeId","data-v-d4d46808"]]);export{Be as D};
