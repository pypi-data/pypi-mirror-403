[project]
name = "boneio"
description = "Python App for BoneIO"
readme = "README.md"
dynamic = ["version"]
authors = [
    { name = "PaweÅ‚ Szafer", email = "pszafer@gmail.com" },
]
dependencies = [
    "smbus2==0.4.3",
    "aiomqtt==2.4.0",
    "aiohttp==3.13.3",
    "Cerberus==1.3.7",
    "colorlog==6.9.0",
    "luma-core==2.5.1",
    "luma-oled==3.14.0",
    "pymodbus==3.11.3",
    "pyserial-asyncio-fast==0.16",
    "PyYAML==6.0.3",
    "psutil==7.1.0",
    "w1thermsensor[async]==2.3.0",
    "fastapi==0.118.0",
    "pydantic==2.11.9",
    "hypercorn==0.17.3",
    "websockets==15.0.1",
    "python-jose[cryptography]==3.5.0",
    "python-multipart==0.0.20",
    "qrcode==8.2",
    "gpiod==2.3.0",
    "requests==2.32.5",
    "packaging==25.0",
    "aioesphomeapi>=29.0.0",
    "zeroconf>=0.148.0"
]
requires-python = ">=3.13"
license = { text = "GNU General Public License v3.0" }

[project.urls]
Homepage = "https://boneio.eu"
Repository = "https://github.com/boneIO-eu/app_bbb"
Documentation = "https://boneio.eu/docs/intro/"
Changelog = "https://github.com/boneIO-eu/app_bbb/releases"

[project.scripts]
boneio = "boneio.bonecli:main"


[tool.pdm.dev-dependencies]
dev = [
    "black>=25.9.0",
    "isort>=6.1.0",
    "pre-commit>=4.3.0",
    "flake8>=7.3.0",
    "bandit>=1.8.6",
    "setuptools>=80.9.0",
]
test = [
    "pytest>=9.0.1",
    "pytest-asyncio>=1.3.0",
    "pytest-cov>=7.0.0",
]

[build-system]
requires = ["setuptools>=61.0", "wheel"]
build-backend = "setuptools.build_meta"

[tool.setuptools.packages.find]
where = ["."]
include = ["boneio*"]

[tool.setuptools.package-data]
"*" = ["*.json", "*.yaml", "*.yml", "*.ttf"]
"boneio.webui" = ["frontend-dist/**/*"]

[tool.setuptools.dynamic]
version = {attr = "boneio.version.__version__"}

[tool.black]
line-length = 88
exclude = '''
/(
    \.eggs
  | \.git
  | \.hg
  | \.mypy_cache
  | \.tox
  | \.venv
  | _build
  | buck-out
  | build
  | dist
  | pdm/_vendor
  | tests/fixtures
)/
'''

[tool.isort]
profile = "black"
atomic = true
filter_files = true
known_first_party = ["boneio"]

[tool.pdm.scripts]
lint = "pre-commit run --all-files"

[tool.pyright]
# BasedPyRight configuration - compatibility mode with PyRight
include = ["boneio", "tests"]
exclude = ["**/__pycache__", "**/node_modules"]
extraPaths = ["."]
# Use PyRight compatibility mode for fewer warnings
typeCheckingMode = "basic"
# Disable some strict checks for better compatibility
reportMissingTypeStubs = false
reportUnknownMemberType = false
reportUnknownVariableType = false
reportUnknownParameterType = false
reportUnknownLambdaType = false
reportUnknownArgumentType = false
reportUntypedFunctionDecorator = false
reportUntypedClassDef = false
reportUntypedFunctionDef = false
reportUntypedMethodSignature = false
reportUntypedProperty = false
reportUntypedNamedTuple = false
reportPrivateImportUsage = false
# Enable Python 3.13 features
pythonVersion = "3.13"
pythonPlatform = "Linux"

[tool.pytest.ini_options]
testpaths = ["tests"]
python_files = ["test_*.py"]
python_functions = ["test_*"]
asyncio_mode = "auto"
asyncio_default_fixture_loop_scope = "function"
markers = [
    "hardware: tests requiring real hardware (deselect with '-m not hardware')",
    "slow: slow running tests (deselect with '-m not slow')",
    "integration: integration tests",
]
filterwarnings = [
    "ignore::DeprecationWarning",
]
addopts = "-v --tb=short"
