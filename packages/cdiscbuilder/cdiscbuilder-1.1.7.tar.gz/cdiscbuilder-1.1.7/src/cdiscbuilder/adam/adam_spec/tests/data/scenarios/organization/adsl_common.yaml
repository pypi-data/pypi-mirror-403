domain: ADSL
key: [USUBJID]
schema: ../schema.yaml

columns: 

  - name: DOMAIN
    label: Domain Abbreviation 
    type: str
    derivation:
      constant: ADSL
    validation:
      maximum_missing_percentage: 0
      allowed_values: ["ADSL"]
    core: org-required

  - name: STUDYID
    label: Study Identifier
    type: str
    derivation:
      source: DM.STUDYID
    validation:
      maximum_missing_percentage: 0
    core: cdisc-required

  - name: USUBJID
    label: Unique Subject Identifier
    type: str
    derivation:
        source: DM.USUBJID
    validation:
      maximum_missing_percentage: 0
      unique: true
    core: cdisc-required

  - name: SUBJID
    label: Subject Identifier for the Study
    type: str
    derivation:
      source: DM.SUBJID
    validation:
      maximum_missing_percentage: 0
    core: cdisc-required

  - name: TRTSDT
    label: Date of First Exposure to Treatment
    type: str
    validation:
      format: date
    core: org-required

  - name: AGE
    label: Age
    type: int
    derivation:
      source: DM.AGE
    validation:
      maximum_missing_percentage: 5
      min: 0
      max: 120
    core: cdisc-required

  - name: AGEGRP1
    label: Age Group
    type: str
    derivation:
      source: AGE
      cut:
        "<18": "< 18"
        ">=18 and <65": ">= 18 & <65"
        ">=65": ">= 65"
    validation:
      maximum_missing_percentage: 5
    core: optional

  - name: AGEU
    label: Age Units
    type: str
    derivation:
      source: DM.AGEU
    validation:
      maximum_missing_percentage: 5
      allowed_values: ["YEARS", "MONTHS", "WEEKS", "DAYS", "HOURS"]
    core: cdisc-required 

  - name: SEX
    label: Sex
    type: str
    derivation:
      source: DM.SEX
    validation:
      maximum_missing_percentage: 0
      allowed_values: ["Male", "Female", "Unknown"]
    core: cdisc-required

  - name: WEIGHT
    label: Weight (kg)
    type: float
    derivation:
      source: VS.VSORRES
    validation:
      maximum_missing_percentage: 5
    core: org-required

  - name: HEIGHT
    label: Height (cm)
    type: float
    derivation:
      source: VS.VSORRES
    validation:
      maximum_missing_percentage: 5
    core: org-required

  - name: BMI
    label: BMI (kg/m^2)
    type: float
    derivation:
      function: adamyaml.adam_derivation.functions.get_bmi.get_bmi
      height: HEIGHT
      weight: WEIGHT
    validation:
      maximum_missing_percentage: 5
    core: org-required