{% load humanize %}
{% load helpers %}
{% load i18n %}

<p>
    {% if job.started %}
        {% trans "Started:" %} <strong>{{ job.started|isodatetime }}</strong>
    {% elif job.scheduled %}
        {% trans "Scheduled for:" %} <strong>{{ job.scheduled|isodatetime }}</strong> ({{ job.scheduled|naturaltime }})
    {% elif job %}
        {% trans "Created:" %} <strong>{{ job.created|isodatetime }}</strong>
    {% endif %}
    {% if job.completed %}
        {% trans "Duration:" %} <strong>{{ job.duration }}</strong>
    {% endif %}
<span id="pending-result-label">{% badge job.get_status_display job.get_status_color %}</span>
</p>
{% if job and not job.completed %}
    {% include 'ipfabric_netbox/inc/logs_pending.html' %}
{% endif %}
<div class="card">
<h5 class="card-header">{% trans "Sync Results" %}</h5>
<div class="card-body">
    <table class="table table-hover report">
    <thead>
        <tr class="table-headings">
        <th>{% trans "Time" %}</th>
        <th>{% trans "Level" %}</th>
        <th>{% trans "Object" %}</th>
        <th>{% trans "Message" %}</th>
        </tr>
    </thead>
    <tbody>
        {% for time, level, obj, url, message in job_results.logs %}
        <tr class="{% if level == 'failure' %}danger{% elif level %}{{ level }}{% endif %}">
        <td>{{ time }}</td>
        <td>
            <label class="badge bg-{% if level == 'failure' %}danger{% else %}{{ level }}{% endif %}">{{ level|title }}</label>
        </td>
        <td>
            {% if obj and url %}
            <a href="{{ url }}">{{ obj }}</a>
            {% elif obj %}
            {{ obj }}
            {% else %}
            {{ ''|placeholder }}
            {% endif %}
        </td>
        <td class="rendered-markdown">{{ message|markdown }}</td>
        </tr>
        {% endfor %}
    </tbody>
    </table>
</div>
