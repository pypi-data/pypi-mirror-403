"use strict";(self.webpackChunkjcjy_authing=self.webpackChunkjcjy_authing||[]).push([[509],{509(t,e,s){s.r(e),s.d(e,{default:()=>u});var n,o=s(931),a=s(165),i=s(247);!function(t){t.READY="JCJY_AUTHING_READY",t.DATA="JCJY_AUTHING_DATA"}(n||(n={}));let d={};const c=new Set;class r extends i.Widget{constructor(){super(),this.addClass("jcjy-status-item"),this.updateStatus(!1)}updateStatus(t){this.node.textContent="JCJY: "+(t?"LOGINED":"STANDBY"),this.node.style.color=t?"#4caf50":"#888888",this.node.style.fontWeight="bold",this.node.style.padding="0 5px",this.node.style.lineHeight="24px"}}const u={id:"jcjy-authing:plugin",description:"é¢„æ¤å…¥ JCJY_AUTHING_DATA ,å†…å«token å’Œç”¨æˆ·ä¿¡æ¯",autoStart:!0,requires:[o.INotebookTracker,a.IStatusBar],activate:(t,e,s)=>{console.log("jcjy-authing æ’ä»¶å·²æ¿€æ´»ï¼"),window.addEventListener("message",t=>{const{type:s,data:o}=t.data||{};console.log("jupyterlab ç›‘å¬åˆ°æ¶ˆæ¯:  ",t.data),s===n.DATA&&(d=o,e.forEach(t=>a(t)))}),window.parent.postMessage({type:n.READY},"*");const o=new r;s.registerStatusItem("jcjy-status",{item:o,align:"left",rank:900});const a=async(t,e=d)=>{var s;const n=t.context.sessionContext;if(!(null===(s=n.session)||void 0===s?void 0:s.kernel))return;const a=`JCJY_AUTHING_DATA = ${JSON.stringify(e)}`;try{await n.session.kernel.requestExecute({code:a}).done,o.updateStatus(!0)}catch(t){console.error("âŒ æ³¨å…¥å¤±è´¥:",t),o.updateStatus(!1)}};e.widgetAdded.connect((t,e)=>{const s=e.context.sessionContext;s.statusChanged.connect((t,n)=>{var i,d;const r=null===(d=null===(i=s.session)||void 0===i?void 0:i.kernel)||void 0===d?void 0:d.id;"idle"===n&&r?c.has(r)||(console.log(`ğŸš€ å†…æ ¸ ${r} å°±ç»ªï¼Œæ‰§è¡Œå•æ¬¡æ³¨å…¥`),a(e).then(()=>{c.add(r)})):"restarting"!==n&&"starting"!==n||(r&&c.delete(r),o.updateStatus(!1))})})}}}}]);