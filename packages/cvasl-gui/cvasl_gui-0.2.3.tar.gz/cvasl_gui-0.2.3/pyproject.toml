[tool.poetry]
name = "cvasl-gui"
version = "0.2.3"  # Managed by setuptools-scm
description = "A GUI for the cvasl package"
authors = ["Peter Kok <p.kok@esciencecenter.nl>"]
license = "Apache 2.0"
readme = "README.md"

[tool.poetry.dependencies]
python = ">=3.10,<3.14"
dash = "^2.18.2"
pandas = "^2.2.3"
python-dotenv = "^1.0.1"
waitress = "^3.0.2"
dash-bootstrap-components = "1.7.1"
cvasl = "==0.2.1"

[tool.poetry.group.dev.dependencies]
ipykernel = "^6.29.5"
pytest = "^8.3.4"
pytest-cov = "^4.0.0"
pyinstaller = "^6.11.0"

[tool.poetry.scripts]
cvasl-gui = "cvasl_gui.index:main"

[build-system]
requires = ["poetry-core>=1.0.0", "poetry-dynamic-versioning>=1.0.0,<2.0.0"]
build-backend = "poetry_dynamic_versioning.backend"

[tool.poetry-dynamic-versioning]
enable = false
vcs = "git"
style = "pep440"
dirty = true
fix-shallow-repository = true
format-jinja = """
    {%- if env.get("CI") -%}
        {# In CI, ignore dirty state for clean releases #}
        {%- if distance == 0 -%}
            {{ serialize_pep440(base, stage, revision) }}
        {%- else -%}
            {{ serialize_pep440(base, stage, revision, dev=distance, metadata=[commit]) }}
        {%- endif -%}
    {%- else -%}
        {# Local development: show dirty state #}
        {%- if distance == 0 and not dirty -%}
            {{ serialize_pep440(base, stage, revision) }}
        {%- elif distance == 0 and dirty -%}
            {{ serialize_pep440(base, stage, revision, dev=0, metadata=["dirty"]) }}
        {%- else -%}
            {{ serialize_pep440(base, stage, revision, dev=distance, metadata=[commit] + (["dirty"] if dirty else [])) }}
        {%- endif -%}
    {%- endif -%}
"""

[tool.poetry-dynamic-versioning.substitution]
files = ["src/cvasl_gui/__init__.py"]
