{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://github.com/rajanvijayan/agent.md/schema/agentmd.schema.json",
  "title": "AGENT.md Frontmatter",
  "description": "Schema for the YAML frontmatter of an AGENT.md file",
  "type": "object",
  "properties": {
    "version": {
      "type": "string",
      "description": "Schema version (e.g. 1.0). Required when frontmatter is present.",
      "pattern": "^[0-9]+\\.[0-9]+(\\.[0-9]+)?$"
    },
    "name": {
      "type": "string",
      "description": "Short, human-readable name for the agent profile"
    },
    "description": {
      "type": "string",
      "description": "One- or two-sentence description of the agent's purpose"
    },
    "role": {
      "type": "string",
      "description": "Persona or role (e.g. Senior backend engineer, Documentation specialist)"
    },
    "context": {
      "oneOf": [
        { "type": "string" },
        {
          "type": "object",
          "properties": {
            "project": { "type": "string" },
            "domain": { "type": "string" },
            "audience": { "type": "string" }
          },
          "additionalProperties": true
        }
      ],
      "description": "Project/domain context"
    },
    "priorities": {
      "type": "array",
      "items": { "type": "string" },
      "description": "Ordered list of priorities (e.g. correctness, security, performance)"
    },
    "tech": {
      "type": "object",
      "properties": {
        "stack": {
          "type": "array",
          "items": { "type": "string" },
          "description": "Main technologies (e.g. Node.js, React, PostgreSQL)"
        },
        "versions": {
          "type": "object",
          "additionalProperties": { "type": "string" },
          "description": "Version constraints per technology"
        },
        "constraints": {
          "type": "array",
          "items": { "type": "string" },
          "description": "Free-form technical constraints"
        }
      },
      "additionalProperties": true,
      "description": "Technology stack and constraints"
    },
    "rules": {
      "type": "array",
      "items": {
        "oneOf": [
          { "type": "string" },
          {
            "type": "object",
            "required": ["description"],
            "properties": {
              "description": { "type": "string" },
              "globs": {
                "oneOf": [
                  { "type": "string" },
                  { "type": "array", "items": { "type": "string" } }
                ]
              },
              "id": { "type": "string" }
            },
            "additionalProperties": true
          }
        ]
      },
      "description": "Rule items: strings or objects with description, optional globs and id"
    },
    "change-policy": {
      "type": "object",
      "properties": {
        "branching": { "type": "string", "description": "Branch naming pattern (e.g. feature/*)" },
        "commits": { "type": "string", "description": "Commit style (e.g. conventional, linear)" },
        "reviews": {
          "oneOf": [{ "type": "string" }, { "type": "boolean" }],
          "description": "Review requirements (required, true, false)"
        },
        "breaking": { "type": "string", "description": "How to handle breaking changes" }
      },
      "additionalProperties": true,
      "description": "Git and change workflow"
    },
    "output": {
      "type": "object",
      "properties": {
        "formats": {
          "type": "array",
          "items": { "type": "string" },
          "description": "Expected output formats (e.g. markdown, code)"
        },
        "conventions": {
          "type": "array",
          "items": { "type": "string" },
          "description": "Documentation and output conventions"
        },
        "docs": {
          "type": "boolean",
          "description": "Whether the agent should maintain or create documentation"
        }
      },
      "additionalProperties": true,
      "description": "Output and documentation expectations"
    },
    "extends": {
      "type": "string",
      "description": "Path or URL to a parent AGENT.md for inheritance"
    },
    "globs": {
      "oneOf": [
        { "type": "string" },
        { "type": "array", "items": { "type": "string" } }
      ],
      "description": "File patterns for path-scoped rules"
    },
    "alwaysApply": {
      "type": "boolean",
      "description": "If true, generators should mark as always-apply where supported"
    }
  },
  "required": ["version"],
  "additionalProperties": true
}
