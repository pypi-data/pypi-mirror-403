"use strict";(self.webpackChunkmitosheet=self.webpackChunkmitosheet||[]).push([[418],{418:(e,n,t)=>{t.r(n),t.d(n,{MitoMimeRenderer:()=>E,default:()=>N,rendererFactory:()=>C});var r=t(391),o=t(345),i=t.n(o),a=t(72),l=t.n(a),c=t(825),s=t.n(c),d=t(659),m=t.n(d),u=t(56),p=t.n(u),v=t(540),f=t.n(v),h=t(113),w=t.n(h),_=t(332),b={};b.styleTagTransform=w(),b.setAttributes=p(),b.insert=m().bind(null,"head"),b.domAPI=s(),b.insertStyleElement=f(),l()(_.A,b),_.A&&_.A.locals&&_.A.locals;let g=null,y=null,x="";const k=(e,n)=>{var t;const r=(g||(g=document.createElement("canvas"),y=g.getContext("2d")),y);if(!r){const r=parseInt((null===(t=n.match(/\d+/))||void 0===t?void 0:t[0])||"13",10);return e.length*r*.6}return x!==n&&(r.font=n,x=n),r.measureText(e).width},j=({payload:e})=>{var n,t;const[r,a]=(0,o.useState)(""),[l,c]=(0,o.useState)({columnIndex:null,direction:null}),s=(0,o.useRef)(null),d=JSON.parse(e.data),m=d.length<e.totalRows,u=null!==(n=e.indexLevels)&&void 0!==n?n:1,p=null!==(t=e.columnLevels)&&void 0!==t?t:1,v=(0,o.useMemo)((()=>function(e,n){const t=n.map((e=>e.dtype.includes("int")||e.dtype.includes("float"))),r=new Array(n.length).fill(0);return e.forEach((e=>{e.forEach(((e,n)=>{if(t[n]&&null!=e){const t=String(e),o=t.indexOf(".");if(-1!==o){const e=t.length-o-1;r[n]=Math.max(r[n],e)}}}))})),r}(d,e.columns)),[d,e.columns]),f=(0,o.useMemo)((()=>{if(!r.trim())return d;const e=r.toLowerCase();return d.filter((n=>n.some((n=>`${n}`.toLowerCase().includes(e)))))}),[d,r]),h=(0,o.useMemo)((()=>null===l.columnIndex||null===l.direction?f:[...f].sort(((e,n)=>{const t=e[l.columnIndex],r=n[l.columnIndex],o=parseFloat(t),i=parseFloat(r),a=!isNaN(o)&&null!=t,c=!isNaN(i)&&null!=r;if(a&&c)return"asc"===l.direction?o-i:i-o;if(null==t&&null==r)return 0;if(null==t)return"asc"===l.direction?-1:1;if(null==r)return"asc"===l.direction?1:-1;if(a&&!c)return"asc"===l.direction?-1:1;if(!a&&c)return"asc"===l.direction?1:-1;const s=String(t).localeCompare(String(r));return"asc"===l.direction?s:-s}))),[f,l]),{isResizing:w,handleResizeStart:_,getColumnWidth:b,calculateAndAutoResizeColumn:g}=((e={})=>{const{defaultWidth:n=200,minWidth:t=50,columns:r=[],data:i=[],indexLevels:a=1,columnLevels:l=1,tableContainerRef:c}=e,[s,d]=(0,o.useState)({}),[m,u]=(0,o.useState)(null),p=(0,o.useCallback)(((e,t)=>{const r=s[e]||n;u({columnIndex:e,startX:t,startWidth:r})}),[s,n]),v=(0,o.useCallback)((e=>{if(!m)return;const n=e.clientX-m.startX,r=Math.max(t,m.startWidth+n);d((e=>Object.assign(Object.assign({},e),{[m.columnIndex]:r})))}),[m,t]),f=(0,o.useCallback)((()=>{u(null)}),[]);(0,o.useEffect)((()=>{if(m)return document.addEventListener("mousemove",v),document.addEventListener("mouseup",f),()=>{document.removeEventListener("mousemove",v),document.removeEventListener("mouseup",f)}}),[m,v,f]);const h=(0,o.useCallback)((e=>s[e]||n),[s,n]),w=(0,o.useCallback)(((e,n)=>{const r=Math.max(t,n+24+10);d((n=>Object.assign(Object.assign({},n),{[e]:r})))}),[t]),_=(0,o.useCallback)((e=>{var n,t;const o=null==c?void 0:c.current,s=(e=>{if(e){const n=window.getComputedStyle(e);return`${n.fontSize} ${n.fontFamily}`}return"13px system-ui, -apple-system, sans-serif"})(o),d=(e=>{let n="13px";if(e){const t=window.getComputedStyle(e);return n=t.fontSize,`${n} ${t.getPropertyValue("--jp-code-font-family")||"monospace"}`}return`${n} monospace`})(o),m=(null===(n=r[e])||void 0===n?void 0:n.dtype.includes("int"))||(null===(t=r[e])||void 0===t?void 0:t.dtype.includes("float"));let u=0;if(e<r.length){const n=r[e],t=`${n.name[e<a?0:l-1]} (${n.dtype})`;u=Math.max(u,k(t,s)),u+=20}const p=i.length<=200?i:(()=>{const e=[];if(e.push(i[0]),i.length>2){const n=Math.ceil((i.length-2)/198);for(let t=1;t<i.length-1;t+=n)e.push(i[t])}return i.length>1&&e.push(i[i.length-1]),e})(),v=m?d:s;for(let n=0;n<p.length;n++){const t=p[n];if(e<t.length){const n=String(t[e]||""),r=k(n,v);r>u&&(u=r)}}return u}),[r,i,a,l,c]),b=(0,o.useCallback)((e=>{const n=_(e);w(e,n)}),[_,w]);return{columnWidths:s,isResizing:null!==m,handleResizeStart:p,getColumnWidth:h,autoResizeColumn:w,calculateAndAutoResizeColumn:b}})({columns:e.columns,data:h,indexLevels:u,columnLevels:p,tableContainerRef:s}),y=(n,t,r)=>i().createElement("th",{key:n,className:"mito-viewer__header-cell",title:`${t} (${e.columns[n].dtype})`,rowSpan:r,style:{width:b(n),minWidth:b(n)}},i().createElement("span",null,t),i().createElement("span",{className:"mito-viewer__sort-icon-container",onClick:e=>{e.stopPropagation(),x(n)}},j(n)),i().createElement("div",{className:"mito-viewer__column-dtype"},e.columns[n].dtype),i().createElement("div",{className:"mito-viewer__resize-handle",onMouseDown:e=>{e.stopPropagation(),_(n,e.clientX)},onClick:e=>e.stopPropagation(),onDoubleClick:e=>{e.stopPropagation(),E(n,e)}})),x=(0,o.useCallback)((e=>{c((n=>{if(n.columnIndex===e){if("asc"===n.direction)return{columnIndex:e,direction:"desc"};if("desc"===n.direction)return{columnIndex:null,direction:null}}return{columnIndex:e,direction:"asc"}}))}),[]),j=(0,o.useCallback)((e=>l.columnIndex!==e?i().createElement("span",{className:"mito-viewer__sort-icon mito-viewer__sort-icon-inactive"},"⇅"):"asc"===l.direction?i().createElement("span",{className:"mito-viewer__sort-icon active"},"↑"):"desc"===l.direction?i().createElement("span",{className:"mito-viewer__sort-icon active"},"↓"):null),[l]),E=(0,o.useCallback)(((e,n)=>{n.stopPropagation(),g(e)}),[g]);return i().createElement("div",{className:"mito-viewer"},i().createElement("div",{className:"mito-viewer__controls"},i().createElement("div",{className:"mito-viewer__row-info "+(m?"mito-viewer__row-info--warning":"")},m?i().createElement(i().Fragment,null,"⚠ Table truncated to first ",d.length," / ",e.totalRows," rows. Set pandas display.max_rows to configure total rows."):`Total Rows: ${e.totalRows}`),i().createElement("div",{className:"mito-viewer__search-container"},i().createElement("input",{type:"text",placeholder:"Search...",value:r,onChange:e=>a(e.target.value),className:"mito-viewer__search-input"}))),i().createElement("div",{ref:s,className:"mito-viewer__table-container "+(w?"mito-viewer__table-container--resizing":"")},i().createElement("table",{className:"mito-viewer__table"},i().createElement("thead",null,Array.from({length:p}).map(((n,t)=>{const r=t===p-1;return i().createElement("tr",{className:"mito-viewer__header-row",key:`column-level-${t}`},e.columns.map(((n,o)=>{if(o<u)return 0===t?y(o,n.name[0],p):null;if(p>1&&o>u&&e.columns[o-1].name.slice(0,t+1).every(((e,t)=>e===n.name[t])))return null;let a=1;if(p>1)for(let r=o+1;r<e.columns.length&&e.columns[r].name.slice(0,t+1).every(((e,t)=>e===n.name[t]));r++)a++;return r||1===p?y(o,n.name[r?t:0]):i().createElement("th",{key:o,className:"mito-viewer__header-cell-multiindex",colSpan:a},n.name[t])})))}))),(()=>{const n=e.columns.map((e=>e.dtype.includes("int")||e.dtype.includes("float"))),t=new Array(u).fill(0);return i().createElement("tbody",null,h.map(((r,o)=>i().createElement("tr",{key:o,className:o%2==0?"mito-viewer__body-row mito-viewer__body-row-even":"mito-viewer__body-row mito-viewer__body-row-odd"},r.map(((r,a)=>{let l;if(u>1&&a<u){if(0==t[a]&&t.slice(0,a).every((e=>e>0))){let e=1;for(let n=o+1;n<h.length&&h[n][a]===r;n++)e++;l=e,t[a]=e}const e=t[a]>0&&!l;if(t[a]--,e)return null}const c=null==(s=r)?"":"boolean"==typeof s?s?"True":"False":String(s);var s;const d=function(e,n,t){var r,o;if(!(null===(r=t[n])||void 0===r?void 0:r.dtype.includes("int"))&&!(null===(o=t[n])||void 0===o?void 0:o.dtype.includes("float")))return null;const i=parseFloat(e);if(isNaN(i))return null;const a=String(e),l=a.indexOf(".");return-1===l?{integerPart:a,decimalPart:"",hasDecimal:!1}:{integerPart:a.substring(0,l),decimalPart:a.substring(l+1),hasDecimal:!0}}(r,a,e.columns);let m="mito-viewer__body-cell mito-viewer__body-cell-"+(n[a]?"numeric":"text");a<u&&(m+=" mito-viewer__body-cell-index");const p=a<v.length?v[a]:0,f=p>0?`${p}ch`:"0ch",w=d&&p>0?i().createElement("span",{className:"mito-viewer__numeric-aligned"},i().createElement("span",{className:"mito-viewer__numeric-integer"},d.integerPart),d.hasDecimal&&i().createElement(i().Fragment,null,i().createElement("span",{className:"mito-viewer__numeric-decimal-separator"},"."),i().createElement("span",{className:"mito-viewer__numeric-decimal",style:{minWidth:f}},d.decimalPart)),!d.hasDecimal&&i().createElement(i().Fragment,null,i().createElement("span",{className:"mito-viewer__numeric-decimal-separator",style:{visibility:"hidden"}},"."),i().createElement("span",{className:"mito-viewer__numeric-decimal",style:{minWidth:f}}))):c;return i().createElement("td",{key:a,className:m,title:c,rowSpan:l,style:{width:b(a),minWidth:b(a)}},w)}))))))})())),0===h.length&&i().createElement("div",{className:"mito-viewer__empty-state"},"No rows match the search criteria"))};class E extends r.ReactWidget{constructor(e){super(),this._data=null,this._mimeType=e.mimeType,this.addClass("mito-mime-renderer"),this.node.style.overflow="auto"}async renderModel(e){var n;return this._data=e.data[this._mimeType],null!==(n=this.renderPromise)&&void 0!==n?n:Promise.resolve()}render(){return this._data?i().createElement(j,{payload:this._data}):null}}const C={safe:!0,mimeTypes:["application/x.mito+json"],createRenderer:e=>new E(e)},N={id:"mitosheet:viewer",description:"Mito DataFrame Viewer",rendererFactory:C,rank:0,dataType:"json"}},332:(e,n,t)=>{t.d(n,{A:()=>l});var r=t(601),o=t.n(r),i=t(314),a=t.n(i)()(o());a.push([e.id,"/*\n * Copyright (c) Saga Inc.\n * Distributed under the terms of the GNU Affero General Public License v3.0 License.\n */\n\n/* MitoViewer CSS Classes */\n\n/* Main container */\n.mito-viewer {\n  font-family: var(--jp-ui-font-family, system-ui, -apple-system, sans-serif);\n  font-size: var(--jp-ui-font-size1, 13px);\n  color: var(--jp-ui-font-color1, black);\n  background-color: var(--jp-layout-color0, white);\n  border-radius: 4px;\n}\n\n/* Controls container */\n.mito-viewer__controls {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  margin-bottom: 6px;\n  gap: 12px;\n}\n\n/* Row count info */\n.mito-viewer__row-info {\n  font-size: var(--jp-ui-font-size0, 11px);\n  color: var(--jp-ui-font-color2, #666);\n}\n\n/* Row info warning state (when truncated) */\n.mito-viewer__row-info--warning {\n  color: #a16207; /* yellow-700 */\n}\n\n/* Search container */\n.mito-viewer__search-container {\n  display: inline-flex;\n  flex: 0 0 200px;\n}\n\n/* Search input */\n.mito-viewer__search-input {\n  width: 100%;\n  padding: 4px 8px;\n  border: 1px solid var(--jp-border-color2, #e0e0e0);\n  border-radius: 4px;\n  font-size: var(--jp-ui-font-size1, 13px);\n  font-family: inherit;\n  background-color: var(--jp-input-background, white);\n  color: inherit;\n}\n\n/* Table container */\n.mito-viewer__table-container {\n  overflow-y: auto;\n  max-height: 400px; /* Approximately 10 rows + header */\n  border: 1px solid var(--jp-border-color2, #e0e0e0);\n  border-radius: 4px;\n  box-shadow: none;\n}\n\n.mito-viewer__table-container--resizing {\n  cursor: col-resize;\n  user-select: none;\n}\n\n/* Table */\n.mito-viewer__table {\n  width: 100%;\n  border-collapse: collapse;\n  font-size: inherit;\n  table-layout: fixed;\n}\n\n/* Table header - sticky at top when scrolling */\n.mito-viewer__table thead {\n  position: sticky;\n  top: 0;\n  z-index: 10;\n  background-color: var(--jp-rendermime-table-row-background);\n}\n\n/* Table header row */\n.mito-viewer__header-row {\n  background-color: var(--jp-rendermime-table-row-background);\n}\n\n/* Table header cells */\n.mito-viewer__header-cell,\n.mito-viewer__header-cell-multiindex {\n  padding: 8px 12px;\n  text-align: left;\n  font-weight: 600;\n  border-bottom: 1px solid var(--jp-border-color2, #e0e0e0);\n  border-right: 1px solid var(--jp-border-color1, #f0f0f0);\n  user-select: none;\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  max-width: 200px;\n  position: relative;\n  background-color: var(--jp-rendermime-table-row-background);\n}\n\n.mito-viewer__header-cell:last-child,\n.mito-viewer__header-cell-multiindex:last-child {\n  border-right: none;\n}\n\n/* Column dtype display */\n.mito-viewer__column-dtype {\n  font-size: var(--jp-ui-font-size0, 11px);\n  font-weight: normal;\n  color: var(--jp-ui-font-color2, #666);\n  margin-top: 2px;\n}\n\n/* Sort icon container - clickable area for sorting */\n.mito-viewer__sort-icon-container {\n  display: inline-flex;\n  align-items: center;\n  cursor: pointer;\n  padding: 2px 4px;\n  margin-left: 4px;\n  border-radius: 2px;\n  user-select: none;\n}\n\n.mito-viewer__sort-icon-container:hover {\n  background-color: var(--jp-layout-color2, rgba(0, 0, 0, 0.05));\n}\n\n/* Sort icons */\n.mito-viewer__sort-icon {\n  display: inline-block;\n}\n\n.mito-viewer__sort-icon.active {\n  color: var(--jp-brand-color1, #2196F3) !important;\n}\n\n.mito-viewer__sort-icon-inactive {\n  opacity: 0.3;\n}\n\n/* Resize handle */\n.mito-viewer__resize-handle {\n  position: absolute;\n  top: 0;\n  right: 0;\n  width: 4px;\n  height: 100%;\n  cursor: col-resize;\n  background-color: transparent;\n  z-index: 1;\n}\n\n.mito-viewer__header-cell:hover .mito-viewer__resize-handle:not(:hover) {\n  background-color: var(--jp-border-color2, #e0e0e0) !important;\n}\n\n.mito-viewer__resize-handle:hover {\n  background-color: var(--jp-brand-color1, #2196F3) !important;\n}\n\n/* Table body rows */\n.mito-viewer__body-row {\n  border-bottom: 1px solid var(--jp-border-color1, #f0f0f0);\n}\n\n.mito-viewer__body-row-even {\n  background-color: var(--jp-layout-color1, white);\n}\n\n.mito-viewer__body-row-odd {\n  background-color: var(--jp-rendermime-table-row-background);\n}\n\n.mito-viewer__body-row:last-child,\n.mito-viewer__body-row:last-child .mito-viewer__body-cell {\n  border-bottom: none;\n}\n\n/* Table body cells */\n.mito-viewer__body-cell {\n  padding: 6px 12px;\n  border-bottom: 1px solid var(--jp-border-color1, #f0f0f0);\n  border-right: 1px solid var(--jp-border-color1, #f0f0f0);\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  max-width: 200px;\n}\n\n.mito-viewer__body-cell:last-child {\n  border-right: none;\n}\n\n.mito-viewer__body-cell-numeric {\n  text-align: right;\n  font-family: var(--jp-code-font-family, monospace);\n  font-variant-numeric: tabular-nums;\n}\n\n/* Numeric alignment structure for decimal point alignment */\n.mito-viewer__numeric-aligned {\n  display: inline-flex;\n  align-items: baseline;\n  justify-content: flex-end;\n  width: 100%;\n  gap: 0;\n}\n\n.mito-viewer__numeric-integer {\n  text-align: right;\n  flex-shrink: 1;\n  min-width: 0;\n}\n\n.mito-viewer__numeric-decimal-separator {\n  flex-shrink: 0;\n  width: 1ch; /* Fixed width for the decimal point */\n}\n\n.mito-viewer__numeric-decimal {\n  text-align: left;\n  display: inline-block;\n  flex-shrink: 0;\n}\n\n.mito-viewer__body-cell-text {\n  text-align: left;\n}\n\n/* MultiIndex specific styles */\n.mito-viewer__group-header-row {\n  background-color: var(--jp-rendermime-table-row-background);\n  border-bottom: 1px solid var(--jp-border-color1, #f0f0f0);\n}\n\n.mito-viewer__index-cell {\n  padding: 6px 12px;\n  border-bottom: 1px solid var(--jp-border-color1, #f0f0f0);\n  border-right: 1px solid var(--jp-border-color1, #f0f0f0);\n  text-align: left;\n  font-weight: 600;\n  background-color: var(--jp-layout-color1, #f9f9f9);\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  max-width: 200px;\n}\n\n.mito-viewer__index-cell:last-child {\n  border-right: none;\n}\n\n.mito-viewer__empty-cell {\n  padding: 6px 12px;\n  border-bottom: 1px solid var(--jp-border-color1, #f0f0f0);\n  border-right: 1px solid var(--jp-border-color1, #f0f0f0);\n  background-color: var(--jp-layout-color1, #f9f9f9);\n}\n\n.mito-viewer__empty-cell:last-child {\n  border-right: none;\n}\n\n/* Empty state */\n.mito-viewer__empty-state {\n  text-align: center;\n  padding: 20px;\n  color: var(--jp-ui-font-color2, #666);\n  font-style: italic;\n}",""]);const l=a},314:e=>{e.exports=function(e){var n=[];return n.toString=function(){return this.map((function(n){var t="",r=void 0!==n[5];return n[4]&&(t+="@supports (".concat(n[4],") {")),n[2]&&(t+="@media ".concat(n[2]," {")),r&&(t+="@layer".concat(n[5].length>0?" ".concat(n[5]):""," {")),t+=e(n),r&&(t+="}"),n[2]&&(t+="}"),n[4]&&(t+="}"),t})).join("")},n.i=function(e,t,r,o,i){"string"==typeof e&&(e=[[null,e,void 0]]);var a={};if(r)for(var l=0;l<this.length;l++){var c=this[l][0];null!=c&&(a[c]=!0)}for(var s=0;s<e.length;s++){var d=[].concat(e[s]);r&&a[d[0]]||(void 0!==i&&(void 0===d[5]||(d[1]="@layer".concat(d[5].length>0?" ".concat(d[5]):""," {").concat(d[1],"}")),d[5]=i),t&&(d[2]?(d[1]="@media ".concat(d[2]," {").concat(d[1],"}"),d[2]=t):d[2]=t),o&&(d[4]?(d[1]="@supports (".concat(d[4],") {").concat(d[1],"}"),d[4]=o):d[4]="".concat(o)),n.push(d))}},n}},601:e=>{e.exports=function(e){return e[1]}},72:e=>{var n=[];function t(e){for(var t=-1,r=0;r<n.length;r++)if(n[r].identifier===e){t=r;break}return t}function r(e,r){for(var i={},a=[],l=0;l<e.length;l++){var c=e[l],s=r.base?c[0]+r.base:c[0],d=i[s]||0,m="".concat(s," ").concat(d);i[s]=d+1;var u=t(m),p={css:c[1],media:c[2],sourceMap:c[3],supports:c[4],layer:c[5]};if(-1!==u)n[u].references++,n[u].updater(p);else{var v=o(p,r);r.byIndex=l,n.splice(l,0,{identifier:m,updater:v,references:1})}a.push(m)}return a}function o(e,n){var t=n.domAPI(n);return t.update(e),function(n){if(n){if(n.css===e.css&&n.media===e.media&&n.sourceMap===e.sourceMap&&n.supports===e.supports&&n.layer===e.layer)return;t.update(e=n)}else t.remove()}}e.exports=function(e,o){var i=r(e=e||[],o=o||{});return function(e){e=e||[];for(var a=0;a<i.length;a++){var l=t(i[a]);n[l].references--}for(var c=r(e,o),s=0;s<i.length;s++){var d=t(i[s]);0===n[d].references&&(n[d].updater(),n.splice(d,1))}i=c}}},659:e=>{var n={};e.exports=function(e,t){var r=function(e){if(void 0===n[e]){var t=document.querySelector(e);if(window.HTMLIFrameElement&&t instanceof window.HTMLIFrameElement)try{t=t.contentDocument.head}catch(e){t=null}n[e]=t}return n[e]}(e);if(!r)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");r.appendChild(t)}},540:e=>{e.exports=function(e){var n=document.createElement("style");return e.setAttributes(n,e.attributes),e.insert(n,e.options),n}},56:(e,n,t)=>{e.exports=function(e){var n=t.nc;n&&e.setAttribute("nonce",n)}},825:e=>{e.exports=function(e){if("undefined"==typeof document)return{update:function(){},remove:function(){}};var n=e.insertStyleElement(e);return{update:function(t){!function(e,n,t){var r="";t.supports&&(r+="@supports (".concat(t.supports,") {")),t.media&&(r+="@media ".concat(t.media," {"));var o=void 0!==t.layer;o&&(r+="@layer".concat(t.layer.length>0?" ".concat(t.layer):""," {")),r+=t.css,o&&(r+="}"),t.media&&(r+="}"),t.supports&&(r+="}");var i=t.sourceMap;i&&"undefined"!=typeof btoa&&(r+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(i))))," */")),n.styleTagTransform(r,e,n.options)}(n,e,t)},remove:function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(n)}}}},113:e=>{e.exports=function(e,n){if(n.styleSheet)n.styleSheet.cssText=e;else{for(;n.firstChild;)n.removeChild(n.firstChild);n.appendChild(document.createTextNode(e))}}}}]);