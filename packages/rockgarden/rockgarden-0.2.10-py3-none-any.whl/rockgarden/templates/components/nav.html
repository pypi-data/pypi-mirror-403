{# Recursive macro for rendering nav tree nodes #}
{% macro render_node(node, default_state) %}
<li>
  {% if node.is_folder and node.children %}
  <details data-nav-path="{{ node.path }}" {{ 'open' if default_state == 'expanded' else '' }}>
    <summary>
      {%- if node.index_path -%}
      <a href="{{ node.index_path }}" class="nav-folder-link">{{ node.label }}</a>
      {%- else -%}
      {{ node.label }}
      {%- endif -%}
    </summary>
    <ul>
      {% for child in node.children %}
        {{ render_node(child, default_state) }}
      {% endfor %}
    </ul>
  </details>
  {% else %}
  <a href="{{ node.path }}">{{ node.label }}</a>
  {% endif %}
</li>
{% endmacro %}

<nav class="nav-tree" aria-label="Site navigation">
  <ul class="menu menu-sm bg-base-200 rounded-box w-full">
    {% for node in site.nav.children %}
      {{ render_node(node, site.nav_default_state) }}
    {% endfor %}
  </ul>
</nav>
