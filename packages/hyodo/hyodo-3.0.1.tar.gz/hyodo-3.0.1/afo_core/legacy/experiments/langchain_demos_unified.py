# Trinity Score: 90.0 (Established by Chancellor)
# âš”ï¸ ì ìˆ˜ëŠ” Truth Engine (scripts/calculate_trinity_score.py)ì—ì„œë§Œ ê³„ì‚°ë©ë‹ˆë‹¤.
# LLMì€ consult_the_lens MCP ë„êµ¬ë¥¼ í†µí•´ ì ìˆ˜ë¥¼ í™•ì¸í•˜ì„¸ìš”.

#!/usr/bin/env python3
"""LAB ì±…ì‚¬ì§„ í†µí•© ì œì•ˆ: LangChain ê³ ê¸‰ íŒ¨í„´ ë°ëª¨
ë¼ì´ë¸ŒëŸ¬ë¦¬ ì„¤ì¹˜ ì—†ì´ ì‹¤í–‰ ê°€ëŠ¥ (êµ¬ì¡° ì‹œê°í™”)
"""


def demo_conversational_retrieval() -> None:
    """ì œê°ˆëŸ‰ ì±…ì‚¬ ì œì•ˆ: ConversationalRetrievalChain"""
    print("=" * 70)
    print("ì œê°ˆëŸ‰ ì±…ì‚¬ ì œì•ˆ: ConversationalRetrievalChain")
    print("=" * 70)
    print()
    print("ğŸ“ êµ¬ì¡°:")
    print("  1. LLM: ChatOpenAI (gpt-3.5-turbo)")
    print("  2. Embeddings: OpenAIEmbeddings")
    print("  3. Vector Store: FAISS")
    print("  4. Memory: ConversationBufferMemory")
    print("  5. Prompt: Custom PromptTemplate")
    print("  6. Chain: ConversationalRetrievalChain")
    print()
    print("ğŸ“Š ë°ì´í„° íë¦„:")
    print("  ì§ˆë¬¸ â†’ [ë©”ëª¨ë¦¬ í™•ì¸] â†’ [ë²¡í„° ê²€ìƒ‰] â†’ [í”„ë¡¬í”„íŠ¸ ìƒì„±] â†’ LLM â†’ ë‹µë³€")
    print("           â†“")
    print("        [ë©”ëª¨ë¦¬ ì €ì¥]")
    print()
    print("âœ¨ íŠ¹ì§•:")
    print("  â€¢ ì´ì „ ëŒ€í™” ê¸°ì–µ (ConversationBufferMemory)")
    print("  â€¢ ë¬¸ì„œ ê²€ìƒ‰ ê¸°ë°˜ ë‹µë³€ (FAISS Retriever)")
    print("  â€¢ ì»¤ìŠ¤í…€ í”„ë¡¬í”„íŠ¸ í…œí”Œë¦¿")
    print("  â€¢ ì†ŒìŠ¤ ë¬¸ì„œ ì¶”ì ")
    print()
    print("ğŸ¯ ì‚¬ìš© ì˜ˆì‹œ:")
    print("  í„´ 1: 'LangChainì´ë€ ë¬´ì—‡ì¸ê°€ìš”?'")
    print("  â†’ [ë²¡í„° ê²€ìƒ‰] â†’ 'LangChainì€ LLM í”„ë ˆì„ì›Œí¬ì…ë‹ˆë‹¤.'")
    print()
    print("  í„´ 2: 'ê·¸ê±¸ n8nì—ì„œ ì–´ë–»ê²Œ ì¨ìš”?'")
    print("  â†’ [ë©”ëª¨ë¦¬: ì´ì „ì— LangChainì„ ë¬¼ì–´ë´¤ìŒ]")
    print("  â†’ [ë²¡í„° ê²€ìƒ‰: n8n í†µí•© ê´€ë ¨]")
    print("  â†’ 'ì´ì „ì— ë§ì”€í•˜ì‹  LangChainì„ n8nì—ì„œëŠ”...'")
    print()


def demo_multi_turn() -> None:
    """ì‚¬ë§ˆì˜ ì±…ì‚¬ ì œì•ˆ: Multi-turn Conversation"""
    print("=" * 70)
    print("ì‚¬ë§ˆì˜ ì±…ì‚¬ ì œì•ˆ: Multi-turn Conversation")
    print("=" * 70)
    print()
    print("ğŸ“ êµ¬ì¡°:")
    print("  ì˜ˆì œ 1: ConversationBufferMemory")
    print("    â€¢ ëª¨ë“  ëŒ€í™”ë¥¼ ë²„í¼ì— ì €ì¥")
    print("    â€¢ ì§§ì€ ëŒ€í™”ì— ì í•©")
    print()
    print("  ì˜ˆì œ 2: ConversationSummaryMemory")
    print("    â€¢ ëŒ€í™”ë¥¼ ìš”ì•½í•˜ì—¬ ì €ì¥")
    print("    â€¢ ê¸´ ëŒ€í™”, í† í° ì ˆì•½")
    print()
    print("  ì˜ˆì œ 3: ì»¤ìŠ¤í…€ í”„ë¡¬í”„íŠ¸")
    print("    â€¢ PromptTemplateë¡œ ì‘ë‹µ ìŠ¤íƒ€ì¼ ì œì–´")
    print("    â€¢ íŠ¹ì • í˜ë¥´ì†Œë‚˜ êµ¬í˜„")
    print()
    print("ğŸ“Š ê³µí†µ ë°ì´í„° íë¦„:")
    print("  ì‚¬ìš©ì ì…ë ¥ â†’ [ë©”ëª¨ë¦¬ ë¡œë“œ] â†’ [í”„ë¡¬í”„íŠ¸ êµ¬ì„±] â†’ LLM â†’ ì‘ë‹µ")
    print("                     â†“")
    print("                 [ë©”ëª¨ë¦¬ ì €ì¥]")
    print()
    print("ğŸ¯ ì‚¬ìš© ì˜ˆì‹œ:")
    print("  í„´ 1: 'ì•ˆë…•í•˜ì„¸ìš”! ì €ëŠ” ì˜ë•ì…ë‹ˆë‹¤.'")
    print("  â†’ 'AI: ì•ˆë…•í•˜ì„¸ìš” ì˜ë•ë‹˜!'")
    print()
    print("  í„´ 2: 'ì œ ì´ë¦„ì´ ë­ì£ ?'")
    print("  â†’ [ë©”ëª¨ë¦¬ì—ì„œ 'ì˜ë•' í™•ì¸]")
    print("  â†’ 'AI: ì˜ë•ë‹˜ì´ì‹œì£ !'")
    print()
    print("  í„´ 3: 'ì €ëŠ” LangChainì„ ê³µë¶€í•˜ê³  ìˆì–´ìš”.'")
    print("  â†’ 'AI: LangChain ê³µë¶€í•˜ì‹œëŠ”êµ°ìš”!'")
    print()
    print("  í„´ 4: 'ì œê°€ ë­˜ ê³µë¶€í•œë‹¤ê³  í–ˆì£ ?'")
    print("  â†’ [ë©”ëª¨ë¦¬ì—ì„œ 'LangChain ê³µë¶€' í™•ì¸]")
    print("  â†’ 'AI: LangChainì„ ê³µë¶€í•˜ì‹ ë‹¤ê³  í•˜ì…¨ì–´ìš”!'")
    print()


def demo_advanced_retrievalqa() -> None:
    """ì£¼ìœ  ì±…ì‚¬ ì œì•ˆ: Advanced RetrievalQA"""
    print("=" * 70)
    print("ì£¼ìœ  ì±…ì‚¬ ì œì•ˆ: Advanced RetrievalQA")
    print("=" * 70)
    print()
    print("ğŸ“ êµ¬ì¡°:")
    print("  ì˜ˆì œ 1: ê¸°ë³¸ RetrievalQA (stuff)")
    print("    â€¢ ëª¨ë“  ë¬¸ì„œë¥¼ í•˜ë‚˜ì˜ í”„ë¡¬í”„íŠ¸ë¡œ")
    print("    â€¢ ë¹ ë¥´ê³  ê°„ë‹¨")
    print()
    print("  ì˜ˆì œ 2: ì»¤ìŠ¤í…€ í”„ë¡¬í”„íŠ¸")
    print("    â€¢ PromptTemplateë¡œ ë‹µë³€ í˜•ì‹ ì œì–´")
    print("    â€¢ ì–¸ì–´, ìŠ¤íƒ€ì¼ ì»¤ìŠ¤í„°ë§ˆì´ì§•")
    print()
    print("  ì˜ˆì œ 3: Map-Reduce Chain")
    print("    â€¢ ê° ë¬¸ì„œ ê°œë³„ ì²˜ë¦¬ â†’ ê²°ê³¼ ë³‘í•©")
    print("    â€¢ ê¸´ ë¬¸ì„œ, ë§ì€ ì»¨í…ìŠ¤íŠ¸")
    print()
    print("  ì˜ˆì œ 4: Refine Chain")
    print("    â€¢ ì´ˆê¸° ë‹µë³€ ìƒì„± â†’ ìˆœì°¨ì  ì •ì œ")
    print("    â€¢ ì •êµí•˜ê³  ìƒì„¸í•œ ë‹µë³€")
    print()
    print("ğŸ“Š ë°ì´í„° íë¦„:")
    print("  ì§ˆë¬¸ â†’ [ë²¡í„° ê²€ìƒ‰] â†’ ê´€ë ¨ ë¬¸ì„œ â†’ [Chain ì²˜ë¦¬] â†’ LLM â†’ ë‹µë³€")
    print()
    print("ğŸ“‹ Chain Type ë¹„êµ:")
    print("  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”")
    print("  â”‚ Chain Type  â”‚ ì¥ì                  â”‚ ì í•©í•œ ê²½ìš°          â”‚")
    print("  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤")
    print("  â”‚ stuff       â”‚ ë¹ ë¦„, ê°„ë‹¨           â”‚ ì§§ì€ ì»¨í…ìŠ¤íŠ¸        â”‚")
    print("  â”‚ map_reduce  â”‚ ë³‘ë ¬ ì²˜ë¦¬, í™•ì¥ì„±    â”‚ ê¸´ ë¬¸ì„œ, ë§ì€ ì²­í¬   â”‚")
    print("  â”‚ refine      â”‚ ì •êµí•œ ë‹µë³€          â”‚ ìƒì„¸í•œ ë¶„ì„ í•„ìš”     â”‚")
    print("  â”‚ map_rerank  â”‚ ìµœì  ë‹µë³€ ì„ íƒ       â”‚ ëª…í™•í•œ ë‹µë³€ í•„ìš”     â”‚")
    print("  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜")
    print()
    print("ğŸ¯ ì‚¬ìš© ì˜ˆì‹œ:")
    print("  ì§ˆë¬¸: 'AFO Ultimateì˜ ì£¼ìš” ì»´í¬ë„ŒíŠ¸ëŠ”?'")
    print()
    print("  Stuff Chain:")
    print("  â†’ [ë²¡í„° ê²€ìƒ‰: 2ê°œ ë¬¸ì„œ]")
    print("  â†’ [ëª¨ë“  ë¬¸ì„œë¥¼ í•˜ë‚˜ì˜ í”„ë¡¬í”„íŠ¸ë¡œ]")
    print("  â†’ 'AFO UltimateëŠ” Soul Engine, MCP Frontend...'")
    print()
    print("  Map-Reduce Chain:")
    print("  â†’ [ë²¡í„° ê²€ìƒ‰: 4ê°œ ë¬¸ì„œ]")
    print("  â†’ [ê° ë¬¸ì„œ ê°œë³„ ìš”ì•½: Doc1â†’summary1, Doc2â†’summary2...]")
    print("  â†’ [ëª¨ë“  ìš”ì•½ ë³‘í•©]")
    print("  â†’ 'ì¢…í•©: AFO UltimateëŠ” 4ê°œ ì»´í¬ë„ŒíŠ¸ë¡œ...'")
    print()


def show_comparison() -> None:
    """3ê°€ì§€ íŒ¨í„´ ë¹„êµ"""
    print("=" * 70)
    print("LAB ì±…ì‚¬ì§„ í†µí•© ë¶„ì„: 3ê°€ì§€ íŒ¨í„´ ë¹„êµ")
    print("=" * 70)
    print()
    print("â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”")
    print("â”‚ íŠ¹ì§•                â”‚ ì œê°ˆëŸ‰       â”‚ ì‚¬ë§ˆì˜         â”‚ ì£¼ìœ            â”‚")
    print("â”‚                     â”‚ Conversationalâ”‚ Multi-turn    â”‚ Advanced RAG   â”‚")
    print("â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤")
    print("â”‚ ë©”ëª¨ë¦¬              â”‚ âœ“            â”‚ âœ“              â”‚ âœ—              â”‚")
    print("â”‚ ë²¡í„° ê²€ìƒ‰           â”‚ âœ“            â”‚ âœ—              â”‚ âœ“              â”‚")
    print("â”‚ ë¬¸ì„œ ê¸°ë°˜ ë‹µë³€      â”‚ âœ“            â”‚ âœ—              â”‚ âœ“              â”‚")
    print("â”‚ ëŒ€í™” ê¸°ì–µ           â”‚ âœ“            â”‚ âœ“              â”‚ âœ—              â”‚")
    print("â”‚ ì»¤ìŠ¤í…€ í”„ë¡¬í”„íŠ¸     â”‚ âœ“            â”‚ âœ“              â”‚ âœ“              â”‚")
    print("â”‚ Chain Type ë‹¤ì–‘     â”‚ âœ—            â”‚ âœ—              â”‚ âœ“              â”‚")
    print("â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤")
    print("â”‚ ì í•©í•œ ìš©ë„         â”‚ ëŒ€í™”í˜• RAG   â”‚ ì±—ë´‡           â”‚ ë¬¸ì„œ Q&A       â”‚")
    print("â”‚                     â”‚ (ìµœê³ ê¸‰)     â”‚ (ëŒ€í™” ì¤‘ì‹¬)    â”‚ (ê²€ìƒ‰ ì¤‘ì‹¬)    â”‚")
    print("â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜")
    print()
    print("ğŸ¯ ì¶”ì²œ ì¡°í•©:")
    print("  â€¢ ì¼ë°˜ ì±—ë´‡: ì‚¬ë§ˆì˜ íŒ¨í„´ (Multi-turn)")
    print("  â€¢ ë¬¸ì„œ ê²€ìƒ‰: ì£¼ìœ  íŒ¨í„´ (Advanced RAG)")
    print("  â€¢ ëŒ€í™”í˜• ë¬¸ì„œ ê²€ìƒ‰: ì œê°ˆëŸ‰ íŒ¨í„´ (Conversational RAG) â­ï¸ ìµœê³ ê¸‰")
    print()
    print("ğŸ’¡ í†µí•© ì‹œë‚˜ë¦¬ì˜¤:")
    print("  1ë‹¨ê³„: ì‚¬ë§ˆì˜ íŒ¨í„´ìœ¼ë¡œ ëŒ€í™” ì‹œì‘")
    print("  2ë‹¨ê³„: ë¬¸ì„œ ê²€ìƒ‰ í•„ìš” ì‹œ ì£¼ìœ  íŒ¨í„´ í˜¸ì¶œ")
    print("  3ë‹¨ê³„: ëŒ€í™” + ê²€ìƒ‰ í†µí•© â†’ ì œê°ˆëŸ‰ íŒ¨í„´ìœ¼ë¡œ ì§„í™”")
    print()


def show_n8n_integration() -> None:
    """n8n í†µí•© ë°©ë²•"""
    print("=" * 70)
    print("n8n LangChain ë…¸ë“œ í†µí•© ê°€ì´ë“œ")
    print("=" * 70)
    print()
    print("ğŸ”§ ë°œê²¬ëœ n8n LangChain ë…¸ë“œ:")
    print("  Memory:")
    print("    â€¢ Simple Memory (nodes-langchain.memoryBufferWindow)")
    print("    â€¢ Redis Chat Memory (nodes-langchain.memoryRedisChat)")
    print()
    print("  Retriever:")
    print("    â€¢ Vector Store Retriever (nodes-langchain.retrieverVectorStore)")
    print("    â€¢ Workflow Retriever (nodes-langchain.retrieverWorkflow)")
    print()
    print("  Chain:")
    print("    â€¢ Question and Answer Chain (nodes-langchain.chainRetrievalQa)")
    print("    â€¢ Summarization Chain (nodes-langchain.chainSummarization)")
    print()
    print("ğŸ“ n8n ì›Œí¬í”Œë¡œìš° êµ¬ì¡°:")
    print("  Webhook â†’ Code â†’ Memory â†’ Retriever â†’ Q&A Chain â†’ Set â†’ Respond")
    print()
    print("âœ¨ í˜„ì¬ ë°°ì¹˜ëœ ì›Œí¬í”Œë¡œìš°:")
    print("  â€¢ ID: h7GtfMlGarOeJ1UY")
    print("  â€¢ ì´ë¦„: LangChain AI Agent í†µí•© ì›Œí¬í”Œë¡œìš°")
    print("  â€¢ ë…¸ë“œ: 5ê°œ (ê¸°ë³¸ êµ¬ì¡°)")
    print("  â€¢ ìƒíƒœ: ì—…ë¡œë“œ ì™„ë£Œ, ë¹„í™œì„±")
    print("  â€¢ URL: https://n8n.brnestrm.com/workflow/h7GtfMlGarOeJ1UY")
    print()
    print("ğŸ¯ í™•ì¥ ê°€ëŠ¥ ë…¸ë“œ:")
    print("  â€¢ 47ê°œ LangChain ë…¸ë“œ í™œìš© ê°€ëŠ¥")
    print("  â€¢ Memory 9ê°œ, Retriever 10ê°œ, Chain 10ê°œ")
    print()


def main() -> None:
    print()
    print("â•”" + "=" * 68 + "â•—")
    print("â•‘" + " " * 12 + "LAB ì±…ì‚¬ì§„ í†µí•© ì œì•ˆ: LangChain ê³ ê¸‰ íŒ¨í„´" + " " * 16 + "â•‘")
    print("â•š" + "=" * 68 + "â•")
    print()
    print("ğŸ“š ë¼ì´ë¸ŒëŸ¬ë¦¬ ì—†ì´ ì‹¤í–‰ ê°€ëŠ¥í•œ ë°ëª¨ ë²„ì „")
    print("   (ì‹¤ì œ ì‹¤í–‰ì€ OPENAI_API_KEY í•„ìš”)")
    print()

    # ë°ëª¨ 1
    demo_conversational_retrieval()
    input("Press Enter to continue...")
    print("\n" * 2)

    # ë°ëª¨ 2
    demo_multi_turn()
    input("Press Enter to continue...")
    print("\n" * 2)

    # ë°ëª¨ 3
    demo_advanced_retrievalqa()
    input("Press Enter to continue...")
    print("\n" * 2)

    # ë¹„êµ
    show_comparison()
    input("Press Enter to continue...")
    print("\n" * 2)

    # n8n í†µí•©
    show_n8n_integration()

    print()
    print("=" * 70)
    print("âœ“ LAB ì±…ì‚¬ì§„ í†µí•© ì œì•ˆ ë°ëª¨ ì™„ë£Œ")
    print("=" * 70)
    print()
    print("ğŸ“ ìƒì„±ëœ ìŠ¤í¬ë¦½íŠ¸:")
    print("  1. retrievalqa_advanced_integration.py (ì œê°ˆëŸ‰)")
    print("  2. langchain_multi_turn_example.py (ì‚¬ë§ˆì˜)")
    print("  3. langchain_advanced_retrievalqa.py (ì£¼ìœ )")
    print()
    print("ğŸš€ ì‹¤ì œ ì‹¤í–‰:")
    print("  export OPENAI_API_KEY='your-key-here'")
    print("  python3 retrievalqa_advanced_integration.py")
    print()


if __name__ == "__main__":
    main()
