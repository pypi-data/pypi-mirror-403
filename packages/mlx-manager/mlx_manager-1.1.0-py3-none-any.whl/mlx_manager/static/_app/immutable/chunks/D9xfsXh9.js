var Vt=Object.defineProperty;var Ut=Object.getPrototypeOf;var Ht=Reflect.get;var nt=t=>{throw TypeError(t)};var jt=(t,e,r)=>e in t?Vt(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r;var L=(t,e,r)=>jt(t,typeof e!="symbol"?e+"":e,r),ot=(t,e,r)=>e.has(t)||nt("Cannot "+r);var f=(t,e,r)=>(ot(t,e,"read from private field"),r?r.call(t):e.get(t)),$=(t,e,r)=>e.has(t)?nt("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(t):e.set(t,r);var V=(t,e,r)=>(ot(t,e,"access private method"),r);var lt=(t,e,r)=>Ht(Ut(t),r,e);import{A as Ne,m as Pt,aO as bt,U as re,o as T,ah as Et,v as Le,g as y,a2 as Bt,Q as Kt,R as Jt,T as ft,V as G,C as x,ap as Wt,aK as Yt,av as ut,w as Ie,aP as K,B as he,F as xt,_ as Re,Y as Gt,aI as xe,aQ as At,aR as Zt,aS as Qt,aT as Xt,x as $t,z as Tt,aU as je,q as Ot,aE as er,aV as tr,aH as rr,y as ke,aW as sr,E as ir,aX as ar,Z as nr,W as Nt,aY as It,i as Ge,G as or,aZ as lr,a_ as fr,I as ur,a$ as cr,b0 as hr,b1 as dr,b2 as gr,b3 as vr,b4 as pr,b5 as mr,b6 as _r,b7 as wr,s as C,c as O,b8 as ze,ao as W,b as Ct,p as yr,a as Sr,k as ct,N as ae,d as Pr,e as br,r as Er,f as Ar,h as $r,b9 as Tr}from"./CNYbWU2B.js";import{b as Or,e as Nr,a as ht,c as Ir}from"./nUxvHMgL.js";import{i as Cr}from"./CiMb2DjI.js";import{i as Lr,a as $e,b as Rr,c as kr,d as zr,n as Mr,f as Fr}from"./BWpKPX3N.js";import{B as qr}from"./DP8WhnTp.js";import{l as dt,p as X}from"./CxfCsaSi.js";function Dr(t,e){return e}function Vr(t,e,r){for(var s=[],i=e.length,a,n=e.length,o=0;o<i;o++){let v=e[o];Tt(v,()=>{if(a){if(a.pending.delete(v),a.done.add(v),a.pending.size===0){var d=t.outrogroups;Ye(xe(a.done)),d.delete(a),d.size===0&&(t.outrogroups=null)}}else n-=1},!1)}if(n===0){var l=s.length===0&&r!==null;if(l){var h=r,c=h.parentNode;rr(c),c.append(h),t.items.clear()}Ye(e,!l)}else a={pending:new Set(e),done:new Set},(t.outrogroups??(t.outrogroups=new Set)).add(a)}function Ye(t,e=!0){for(var r=0;r<t.length;r++)ke(t[r],e)}var gt;function Ur(t,e,r,s,i,a=null){var n=t,o=new Map,l=(e&bt)!==0;if(l){var h=t;n=T?re(Et(h)):h.appendChild(Ne())}T&&Le();var c=null,v=Bt(()=>{var g=r();return At(g)?g:g==null?[]:xe(g)}),d,P=!0;function A(){u.fallback=c,Hr(u,d,n,e,s),c!==null&&(d.length===0?(c.f&K)===0?$t(c):(c.f^=K,fe(c,null,n)):Tt(c,()=>{c=null}))}var N=Pt(()=>{d=y(v);var g=d.length;let F=!1;if(T){var R=Kt(n)===Jt;R!==(g===0)&&(n=ft(),re(n),G(!1),F=!0)}for(var b=new Set,z=Ie,S=xt(),_=0;_<g;_+=1){T&&x.nodeType===Wt&&x.data===Yt&&(n=x,F=!0,G(!1));var I=d[_],k=s(I,_),E=P?null:o.get(k);E?(E.v&&ut(E.v,I),E.i&&ut(E.i,_),S&&z.skipped_effects.delete(E.e)):(E=jr(o,P?n:gt??(gt=Ne()),I,k,_,i,e,r),P||(E.e.f|=K),o.set(k,E)),b.add(k)}if(g===0&&a&&!c&&(P?c=he(()=>a(n)):(c=he(()=>a(gt??(gt=Ne()))),c.f|=K)),T&&g>0&&re(ft()),!P)if(S){for(const[Z,Q]of o)b.has(Z)||z.skipped_effects.add(Q.e);z.oncommit(A),z.ondiscard(()=>{})}else A();F&&G(!0),y(v)}),u={effect:N,items:o,outrogroups:null,fallback:c};P=!1,T&&(n=x)}function Hr(t,e,r,s,i){var E,Z,Q,Xe,et,tt,rt,st,it;var a=(s&tr)!==0,n=e.length,o=t.items,l=t.effect.first,h,c=null,v,d=[],P=[],A,N,u,g;if(a)for(g=0;g<n;g+=1)A=e[g],N=i(A,g),u=o.get(N).e,(u.f&K)===0&&((Z=(E=u.nodes)==null?void 0:E.a)==null||Z.measure(),(v??(v=new Set)).add(u));for(g=0;g<n;g+=1){if(A=e[g],N=i(A,g),u=o.get(N).e,t.outrogroups!==null)for(const j of t.outrogroups)j.pending.delete(u),j.done.delete(u);if((u.f&K)!==0)if(u.f^=K,u===l)fe(u,null,r);else{var F=c?c.next:l;u===t.effect.last&&(t.effect.last=u.prev),u.prev&&(u.prev.next=u.next),u.next&&(u.next.prev=u.prev),J(t,c,u),J(t,u,F),fe(u,F,r),c=u,d=[],P=[],l=c.next;continue}if((u.f&je)!==0&&($t(u),a&&((Xe=(Q=u.nodes)==null?void 0:Q.a)==null||Xe.unfix(),(v??(v=new Set)).delete(u))),u!==l){if(h!==void 0&&h.has(u)){if(d.length<P.length){var R=P[0],b;c=R.prev;var z=d[0],S=d[d.length-1];for(b=0;b<d.length;b+=1)fe(d[b],R,r);for(b=0;b<P.length;b+=1)h.delete(P[b]);J(t,z.prev,S.next),J(t,c,z),J(t,S,R),l=R,c=S,g-=1,d=[],P=[]}else h.delete(u),fe(u,l,r),J(t,u.prev,u.next),J(t,u,c===null?t.effect.first:c.next),J(t,c,u),c=u;continue}for(d=[],P=[];l!==null&&l!==u;)(h??(h=new Set)).add(l),P.push(l),l=l.next;if(l===null)continue}(u.f&K)===0&&d.push(u),c=u,l=u.next}if(t.outrogroups!==null){for(const j of t.outrogroups)j.pending.size===0&&(Ye(xe(j.done)),(et=t.outrogroups)==null||et.delete(j));t.outrogroups.size===0&&(t.outrogroups=null)}if(l!==null||h!==void 0){var _=[];if(h!==void 0)for(u of h)(u.f&je)===0&&_.push(u);for(;l!==null;)(l.f&je)===0&&l!==t.fallback&&_.push(l),l=l.next;var I=_.length;if(I>0){var k=(s&bt)!==0&&n===0?r:null;if(a){for(g=0;g<I;g+=1)(rt=(tt=_[g].nodes)==null?void 0:tt.a)==null||rt.measure();for(g=0;g<I;g+=1)(it=(st=_[g].nodes)==null?void 0:st.a)==null||it.fix()}Vr(t,_,k)}}a&&Ot(()=>{var j,at;if(v!==void 0)for(u of v)(at=(j=u.nodes)==null?void 0:j.a)==null||at.apply()})}function jr(t,e,r,s,i,a,n,o){var l=(n&Zt)!==0?(n&Qt)===0?Gt(r,!1,!1):Re(r):null,h=(n&Xt)!==0?Re(i):null;return{v:l,i:h,e:he(()=>(a(e,l??r,h??i,o),()=>{t.delete(s)}))}}function fe(t,e,r){if(t.nodes)for(var s=t.nodes.start,i=t.nodes.end,a=e&&(e.f&K)===0?e.nodes.start:r;s!==null;){var n=er(s);if(a.before(s),s===i)return;s=n}}function J(t,e,r){e===null?t.effect.first=r:e.next=r,r===null?t.effect.last=e:r.prev=e}function Br(t,e,r,s,i){var o;T&&Le();var a=(o=e.$$slots)==null?void 0:o[r],n=!1;a===!0&&(a=e.children,n=!0),a===void 0||a(t,n?()=>s:s)}function Kr(t,e,r,s,i,a){let n=T;T&&Le();var o=null;T&&x.nodeType===sr&&(o=x,Le());var l=T?x:t,h=new qr(l,!1);Pt(()=>{const c=e()||null;var v=ar;if(c===null){h.ensure(null,null),$e(!0);return}return h.ensure(c,d=>{if(c){if(o=T?o:document.createElementNS(v,c),Or(o,o),s){T&&Lr(c)&&o.append(document.createComment(""));var P=T?Et(o):o.appendChild(Ne());T&&(P===null?G(!1):re(P)),s(o,P)}nr.nodes.end=o,d.before(o)}T&&re(d)}),$e(!0),()=>{c&&$e(!1)}},ir),Nt(()=>{$e(!0)}),n&&(G(!0),re(l))}function Jr(t,e){var r=void 0,s;It(()=>{r!==(r=e())&&(s&&(ke(s),s=null),r&&(s=he(()=>{Ge(()=>r(t))})))})}function Lt(t){var e,r,s="";if(typeof t=="string"||typeof t=="number")s+=t;else if(typeof t=="object")if(Array.isArray(t)){var i=t.length;for(e=0;e<i;e++)t[e]&&(r=Lt(t[e]))&&(s&&(s+=" "),s+=r)}else for(r in t)t[r]&&(s&&(s+=" "),s+=r);return s}function Wr(){for(var t,e,r=0,s="",i=arguments.length;r<i;r++)(t=arguments[r])&&(e=Lt(t))&&(s&&(s+=" "),s+=e);return s}function Yr(t){return typeof t=="object"?Wr(t):t??""}const vt=[...` 	
\r\fÂ \v\uFEFF`];function xr(t,e,r){var s=t==null?"":""+t;if(r){for(var i in r)if(r[i])s=s?s+" "+i:i;else if(s.length)for(var a=i.length,n=0;(n=s.indexOf(i,n))>=0;){var o=n+a;(n===0||vt.includes(s[n-1]))&&(o===s.length||vt.includes(s[o]))?s=(n===0?"":s.substring(0,n))+s.substring(o+1):n=o}}return s===""?null:s}function pt(t,e=!1){var r=e?" !important;":";",s="";for(var i in t){var a=t[i];a!=null&&a!==""&&(s+=" "+i+": "+a+r)}return s}function Be(t){return t[0]!=="-"||t[1]!=="-"?t.toLowerCase():t}function Gr(t,e){if(e){var r="",s,i;if(Array.isArray(e)?(s=e[0],i=e[1]):s=e,t){t=String(t).replaceAll(/\s*\/\*.*?\*\/\s*/g,"").trim();var a=!1,n=0,o=!1,l=[];s&&l.push(...Object.keys(s).map(Be)),i&&l.push(...Object.keys(i).map(Be));var h=0,c=-1;const N=t.length;for(var v=0;v<N;v++){var d=t[v];if(o?d==="/"&&t[v-1]==="*"&&(o=!1):a?a===d&&(a=!1):d==="/"&&t[v+1]==="*"?o=!0:d==='"'||d==="'"?a=d:d==="("?n++:d===")"&&n--,!o&&a===!1&&n===0){if(d===":"&&c===-1)c=v;else if(d===";"||v===N-1){if(c!==-1){var P=Be(t.substring(h,c).trim());if(!l.includes(P)){d!==";"&&v++;var A=t.substring(h,v).trim();r+=" "+A+";"}}h=v+1,c=-1}}}}return s&&(r+=pt(s)),i&&(r+=pt(i,!0)),r=r.trim(),r===""?null:r}return t==null?null:String(t)}function Zr(t,e,r,s,i,a){var n=t.__className;if(T||n!==r||n===void 0){var o=xr(r,s,a);(!T||o!==t.getAttribute("class"))&&(o==null?t.removeAttribute("class"):e?t.className=o:t.setAttribute("class",o)),t.__className=r}else if(a&&i!==a)for(var l in a){var h=!!a[l];(i==null||h!==!!i[l])&&t.classList.toggle(l,h)}return a}function Ke(t,e={},r,s){for(var i in r){var a=r[i];e[i]!==a&&(r[i]==null?t.style.removeProperty(i):t.style.setProperty(i,a,s))}}function Qr(t,e,r,s){var i=t.__style;if(T||i!==e){var a=Gr(e,s);(!T||a!==t.getAttribute("style"))&&(a==null?t.removeAttribute("style"):t.style.cssText=a),t.__style=e}else s&&(Array.isArray(s)?(Ke(t,r==null?void 0:r[0],s[0]),Ke(t,r==null?void 0:r[1],s[1],"important")):Ke(t,r,s));return s}function Me(t,e,r=!1){if(t.multiple){if(e==null)return;if(!At(e))return lr();for(var s of t.options)s.selected=e.includes(ce(s));return}for(s of t.options){var i=ce(s);if(fr(i,e)){s.selected=!0;return}}(!r||e!==void 0)&&(t.selectedIndex=-1)}function Rt(t){var e=new MutationObserver(()=>{Me(t,t.__value)});e.observe(t,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),Nt(()=>{e.disconnect()})}function Es(t,e,r=e){var s=new WeakSet,i=!0;or(t,"change",a=>{var n=a?"[selected]":":checked",o;if(t.multiple)o=[].map.call(t.querySelectorAll(n),ce);else{var l=t.querySelector(n)??t.querySelector("option:not([disabled])");o=l&&ce(l)}r(o),Ie!==null&&s.add(Ie)}),Ge(()=>{var a=e();if(t===document.activeElement){var n=ur??Ie;if(s.has(n))return}if(Me(t,a,i),i&&a===void 0){var o=t.querySelector(":checked");o!==null&&(a=ce(o),r(a))}t.__value=a,i=!1}),Rt(t)}function ce(t){return"__value"in t?t.__value:t.value}const ne=Symbol("class"),oe=Symbol("style"),kt=Symbol("is custom element"),zt=Symbol("is html");function Xr(t){if(T){var e=!1,r=()=>{if(!e){if(e=!0,t.hasAttribute("value")){var s=t.value;Fe(t,"value",null),t.value=s}if(t.hasAttribute("checked")){var i=t.checked;Fe(t,"checked",null),t.checked=i}}};t.__on_r=r,Ot(r),wr()}}function As(t,e){var r=Ze(t);r.checked!==(r.checked=e??void 0)&&(t.checked=e)}function es(t,e){e?t.hasAttribute("selected")||t.setAttribute("selected",""):t.removeAttribute("selected")}function Fe(t,e,r,s){var i=Ze(t);T&&(i[e]=t.getAttribute(e),e==="src"||e==="srcset"||e==="href"&&t.nodeName==="LINK")||i[e]!==(i[e]=r)&&(e==="loading"&&(t[hr]=r),r==null?t.removeAttribute(e):typeof r!="string"&&Mt(t).includes(e)?t[e]=r:t.setAttribute(e,r))}function ts(t,e,r,s,i=!1,a=!1){if(T&&i&&t.tagName==="INPUT"){var n=t,o=n.type==="checkbox"?"defaultChecked":"defaultValue";o in r||Xr(n)}var l=Ze(t),h=l[kt],c=!l[zt];let v=T&&h;v&&G(!1);var d=e||{},P=t.tagName==="OPTION";for(var A in e)A in r||(r[A]=null);r.class?r.class=Yr(r.class):r[ne]&&(r.class=null),r[oe]&&(r.style??(r.style=null));var N=Mt(t);for(const S in r){let _=r[S];if(P&&S==="value"&&_==null){t.value=t.__value="",d[S]=_;continue}if(S==="class"){var u=t.namespaceURI==="http://www.w3.org/1999/xhtml";Zr(t,u,_,s,e==null?void 0:e[ne],r[ne]),d[S]=_,d[ne]=r[ne];continue}if(S==="style"){Qr(t,_,e==null?void 0:e[oe],r[oe]),d[S]=_,d[oe]=r[oe];continue}var g=d[S];if(!(_===g&&!(_===void 0&&t.hasAttribute(S)))){d[S]=_;var F=S[0]+S[1];if(F!=="$$")if(F==="on"){const I={},k="$$"+S;let E=S.slice(2);var R=Fr(E);if(Rr(E)&&(E=E.slice(0,-7),I.capture=!0),!R&&g){if(_!=null)continue;t.removeEventListener(E,d[k],I),d[k]=null}if(_!=null)if(R)t[`__${E}`]=_,zr([E]);else{let Z=function(Q){d[S].call(this,Q)};d[k]=kr(E,t,Z,I)}else R&&(t[`__${E}`]=void 0)}else if(S==="style")Fe(t,S,_);else if(S==="autofocus")mr(t,!!_);else if(!h&&(S==="__value"||S==="value"&&_!=null))t.value=t.__value=_;else if(S==="selected"&&P)es(t,_);else{var b=S;c||(b=Mr(b));var z=b==="defaultValue"||b==="defaultChecked";if(_==null&&!h&&!z)if(l[S]=null,b==="value"||b==="checked"){let I=t;const k=e===void 0;if(b==="value"){let E=I.defaultValue;I.removeAttribute(b),I.defaultValue=E,I.value=I.__value=k?E:null}else{let E=I.defaultChecked;I.removeAttribute(b),I.defaultChecked=E,I.checked=k?E:!1}}else t.removeAttribute(S);else z||N.includes(b)&&(h||typeof _!="string")?(t[b]=_,b in l&&(l[b]=_r)):typeof _!="function"&&Fe(t,b,_)}}}return v&&G(!0),d}function mt(t,e,r=[],s=[],i=[],a,n=!1,o=!1){cr(i,r,s,l=>{var h=void 0,c={},v=t.nodeName==="SELECT",d=!1;if(It(()=>{var A=e(...l.map(y)),N=ts(t,h,A,a,n,o);d&&v&&"value"in A&&Me(t,A.value);for(let g of Object.getOwnPropertySymbols(c))A[g]||ke(c[g]);for(let g of Object.getOwnPropertySymbols(A)){var u=A[g];g.description===vr&&(!h||u!==h[g])&&(c[g]&&ke(c[g]),c[g]=he(()=>Jr(t,()=>u))),N[g]=u}h=N}),v){var P=t;Ge(()=>{Me(P,h.value,!0),Rt(P)})}d=!0})}function Ze(t){return t.__attributes??(t.__attributes={[kt]:t.nodeName.includes("-"),[zt]:t.namespaceURI===dr})}var _t=new Map;function Mt(t){var e=t.getAttribute("is")||t.nodeName,r=_t.get(e);if(r)return r;_t.set(e,r=[]);for(var s,i=t,a=Element.prototype;a!==i;){s=pr(i);for(var n in s)s[n].set&&r.push(n);i=gr(i)}return r}const Je="mlx_auth_token",Te="mlx_auth_user";var de,ge,ve;class rs{constructor(){$(this,de,C(null));$(this,ge,C(null));$(this,ve,C(!0))}get token(){return y(f(this,de))}set token(e){O(f(this,de),e,!0)}get user(){return y(f(this,ge))}set user(e){O(f(this,ge),e,!0)}get loading(){return y(f(this,ve))}set loading(e){O(f(this,ve),e,!0)}get isAuthenticated(){return!!this.token&&!!this.user}get isAdmin(){var e;return((e=this.user)==null?void 0:e.is_admin)??!1}initialize(){if(typeof window>"u"){this.loading=!1;return}try{if(typeof localStorage>"u"||!localStorage.getItem){this.loading=!1;return}const e=localStorage.getItem(Je),r=localStorage.getItem(Te);e&&r&&(this.token=e,this.user=JSON.parse(r))}catch{this.token=null,this.user=null}finally{this.loading=!1}}setAuth(e,r){this.token=e,this.user=r,typeof window<"u"&&(localStorage.setItem(Je,e),localStorage.setItem(Te,JSON.stringify(r)))}clearAuth(){if(this.token=null,this.user=null,typeof window<"u")try{localStorage.removeItem(Je),localStorage.removeItem(Te)}catch{}}updateUser(e){this.user=e,typeof window<"u"&&localStorage.setItem(Te,JSON.stringify(e))}}de=new WeakMap,ge=new WeakMap,ve=new WeakMap;const qe=new rs;typeof window<"u"&&qe.initialize();const p="/api";class wt extends Error{constructor(e,r){super(r),this.status=e,this.name="ApiError"}}function w(){const t={"Content-Type":"application/json"};return qe.token&&(t.Authorization=`Bearer ${qe.token}`),t}async function m(t){if(t.status===401)throw qe.clearAuth(),typeof window<"u"&&(window.location.href="/login"),new wt(401,"Session expired");if(!t.ok){const e=await t.text();let r=e;try{const s=JSON.parse(e);Array.isArray(s.detail)?r=s.detail.map(i=>{var n;return`${((n=i.loc)==null?void 0:n.slice(-1)[0])||"field"}: ${i.msg||"validation error"}`}).join(", "):r=s.detail||s.message||e}catch{}throw new wt(t.status,r)}if(t.status!==204)return t.json()}const $s={register:async t=>{const e=await fetch(`${p}/auth/register`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});return m(e)},login:async(t,e)=>{const r=new URLSearchParams;r.append("username",t),r.append("password",e);const s=await fetch(`${p}/auth/login`,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:r});return m(s)},me:async()=>{const t=await fetch(`${p}/auth/me`,{headers:w()});return m(t)},listUsers:async()=>{const t=await fetch(`${p}/auth/users`,{headers:w()});return m(t)},getPendingCount:async()=>{const t=await fetch(`${p}/auth/users/pending/count`,{headers:w()});return m(t)},updateUser:async(t,e)=>{const r=await fetch(`${p}/auth/users/${t}`,{method:"PUT",headers:w(),body:JSON.stringify(e)});return m(r)},deleteUser:async t=>{const e=await fetch(`${p}/auth/users/${t}`,{method:"DELETE",headers:w()});return m(e)},resetPassword:async(t,e)=>{const r=await fetch(`${p}/auth/users/${t}/reset-password`,{method:"POST",headers:w(),body:JSON.stringify({password:e})});return m(r)}},ee={list:async()=>{const t=await fetch(`${p}/profiles`,{headers:w()});return m(t)},get:async t=>{const e=await fetch(`${p}/profiles/${t}`,{headers:w()});return m(e)},create:async t=>{const e=await fetch(`${p}/profiles`,{method:"POST",headers:w(),body:JSON.stringify(t)});return m(e)},update:async(t,e)=>{const r=await fetch(`${p}/profiles/${t}`,{method:"PUT",headers:w(),body:JSON.stringify(e)});return m(r)},delete:async t=>{const e=await fetch(`${p}/profiles/${t}`,{method:"DELETE",headers:w()});return m(e)},duplicate:async(t,e)=>{const r=await fetch(`${p}/profiles/${t}/duplicate?new_name=${encodeURIComponent(e)}`,{method:"POST",headers:w()});return m(r)},getNextPort:async()=>{const t=await fetch(`${p}/profiles/next-port`,{headers:w()});return m(t)}},Ts={search:async(t,e,r=20)=>{const s=new URLSearchParams({query:t,limit:r.toString()});e!==void 0&&s.set("max_size_gb",e.toString());const i=await fetch(`${p}/models/search?${s}`,{headers:w()});return m(i)},listLocal:async()=>{const t=await fetch(`${p}/models/local`,{headers:w()});return m(t)},startDownload:async t=>{const e=await fetch(`${p}/models/download`,{method:"POST",headers:w(),body:JSON.stringify({model_id:t})});return m(e)},getActiveDownloads:async()=>{const t=await fetch(`${p}/models/downloads/active`,{headers:w()});return m(t)},delete:async t=>{const e=await fetch(`${p}/models/${t}`,{method:"DELETE",headers:w()});return m(e)},detectOptions:async t=>{const e=await fetch(`${p}/models/detect-options/${t}`,{headers:w()});return m(e)},getAvailableParsers:async()=>{const t=await fetch(`${p}/models/available-parsers`,{headers:w()});return m(t)},getConfig:async(t,e)=>{let r=`${p}/models/config/${t}`;e&&e.length>0&&(r+=`?tags=${encodeURIComponent(e.join(","))}`);const s=await fetch(r,{headers:w()});return m(s)}},Oe={list:async()=>{const t=await fetch(`${p}/servers`,{headers:w()});return m(t)},start:async t=>{const e=await fetch(`${p}/servers/${t}/start`,{method:"POST",headers:w()});return m(e)},stop:async(t,e=!1)=>{const s=await fetch(`${p}/servers/${t}/stop${e?"?force=true":""}`,{method:"POST",headers:w()});return m(s)},restart:async t=>{const e=await fetch(`${p}/servers/${t}/restart`,{method:"POST",headers:w()});return m(e)},health:async t=>{const e=await fetch(`${p}/servers/${t}/health`,{headers:w()});return m(e)},status:async t=>{const e=await fetch(`${p}/servers/${t}/status`,{headers:w()});return m(e)}},yt={memory:async()=>{const t=await fetch(`${p}/system/memory`,{headers:w()});return m(t)},info:async()=>{const t=await fetch(`${p}/system/info`,{headers:w()});return m(t)},parserOptions:async()=>{const t=await fetch(`${p}/system/parser-options`,{headers:w()});return m(t)},launchd:{install:async t=>{const e=await fetch(`${p}/system/launchd/install/${t}`,{method:"POST",headers:w()});return m(e)},uninstall:async t=>{const e=await fetch(`${p}/system/launchd/uninstall/${t}`,{method:"POST",headers:w()});return m(e)},status:async t=>{const e=await fetch(`${p}/system/launchd/status/${t}`,{headers:w()});return m(e)}}},Os={listTools:async()=>{const t=await fetch(`${p}/mcp/tools`,{headers:w()});return m(t)},executeTool:async(t,e)=>{const r=await fetch(`${p}/mcp/execute`,{method:"POST",headers:w(),body:JSON.stringify({name:t,arguments:e})});return m(r)}};function ss(t,e){const r=Object.keys(t),s=Object.keys(e);if(r.length!==s.length)return!1;for(const i of r)if(t[i]!==e[i])return!1;return!0}function Ft(t,e,r){const{getKey:s,isEqual:i=ss}=r,a=new Map;t.forEach((h,c)=>{a.set(s(h),{item:h,index:c})});const n=new Set(e.map(s)),o=[];let l=!1;for(const h of e){const c=s(h),v=a.get(c);v?(i(v.item,h)||(Object.assign(v.item,h),l=!0),o.push(v.item)):(o.push(h),l=!0)}for(const[h]of a)if(!n.has(h)){l=!0;break}if(!l&&t.length===o.length){for(let h=0;h<t.length;h++)if(s(t[h])!==s(o[h])){l=!0;break}}return l||t.length!==o.length?(t.length=0,t.push(...o),!0):!1}class is{constructor(){L(this,"inFlight",new Map);L(this,"lastRefresh",new Map);L(this,"pollingState",new Map);L(this,"isVisible",!0);L(this,"globalPause",!1);L(this,"visibilityListenerAttached",!1);this.setupVisibilityListener()}setupVisibilityListener(){typeof document>"u"||this.visibilityListenerAttached||(this.isVisible=document.visibilityState==="visible",document.addEventListener("visibilitychange",()=>{const e=this.isVisible;this.isVisible=document.visibilityState==="visible",this.isVisible&&!e?this.resumeAll():!this.isVisible&&e&&this.pauseAll()}),this.visibilityListenerAttached=!0)}register(e,r){const s=this.pollingState.get(e);s?s.config=r:this.pollingState.set(e,{config:r,intervalId:null,paused:!1})}start(e){const r=this.pollingState.get(e);if(!r){console.warn(`[PollingCoordinator] No config registered for ${e}`);return}this.stop(e),r.paused=!1,this.refresh(e),r.intervalId=setInterval(()=>{this.shouldPoll(e)&&this.refresh(e)},r.config.interval)}stop(e){const r=this.pollingState.get(e);r!=null&&r.intervalId&&(clearInterval(r.intervalId),r.intervalId=null)}async refresh(e){const r=this.pollingState.get(e);if(!r){console.warn(`[PollingCoordinator] No config registered for ${e}`);return}const s=this.inFlight.get(e);if(s)return s;const i=this.lastRefresh.get(e)??0;if(Date.now()-i<r.config.minInterval)return;const n=r.config.refreshFn().catch(o=>{console.error(`[PollingCoordinator] Refresh failed for ${e}:`,o)}).finally(()=>{this.inFlight.delete(e),this.lastRefresh.set(e,Date.now())});return this.inFlight.set(e,n),n}shouldPoll(e){if(!this.isVisible||this.globalPause)return!1;const r=this.pollingState.get(e);return!(r!=null&&r.paused)}pauseAll(){for(const[,e]of this.pollingState)e.intervalId&&(clearInterval(e.intervalId),e.intervalId=null)}resumeAll(){for(const[e,r]of this.pollingState)!r.paused&&!r.intervalId&&(this.refresh(e),r.intervalId=setInterval(()=>{this.shouldPoll(e)&&this.refresh(e)},r.config.interval))}isRefreshing(e){return this.inFlight.has(e)}getTimeSinceRefresh(e){const r=this.lastRefresh.get(e);return r?Date.now()-r:1/0}setGlobalPause(e){this.globalPause=e,e?this.pauseAll():this.isVisible&&this.resumeAll()}pause(e){const r=this.pollingState.get(e);r&&(r.paused=!0,this.stop(e))}resume(e){const r=this.pollingState.get(e);r&&(r.paused=!1,this.isVisible&&!this.globalPause&&this.start(e))}isPolling(e){const r=this.pollingState.get(e);return(r==null?void 0:r.intervalId)!=null}destroy(){for(const[e]of this.pollingState)this.stop(e);this.pollingState.clear(),this.inFlight.clear(),this.lastRefresh.clear()}}const M=new is;var as=["forEach","isDisjointFrom","isSubsetOf","isSupersetOf"],ns=["difference","intersection","symmetricDifference","union"],St=!1,se,q,Y,Ve,ie,qt,Dt;const Ue=class Ue extends Set{constructor(r){super();$(this,ie);$(this,se,new Map);$(this,q,C(0));$(this,Y,C(0));$(this,Ve,ze||-1);if(r){for(var s of r)super.add(s);f(this,Y).v=super.size}St||V(this,ie,Dt).call(this)}has(r){var s=super.has(r),i=f(this,se),a=i.get(r);if(a===void 0){if(!s)return y(f(this,q)),!1;a=V(this,ie,qt).call(this,!0),i.set(r,a)}return y(a),s}add(r){return super.has(r)||(super.add(r),O(f(this,Y),super.size),W(f(this,q))),this}delete(r){var s=super.delete(r),i=f(this,se),a=i.get(r);return a!==void 0&&(i.delete(r),O(a,!1)),s&&(O(f(this,Y),super.size),W(f(this,q))),s}clear(){if(super.size!==0){super.clear();var r=f(this,se);for(var s of r.values())O(s,!1);r.clear(),O(f(this,Y),0),W(f(this,q))}}keys(){return this.values()}values(){return y(f(this,q)),super.values()}entries(){return y(f(this,q)),super.entries()}[Symbol.iterator](){return this.keys()}get size(){return y(f(this,Y))}};se=new WeakMap,q=new WeakMap,Y=new WeakMap,Ve=new WeakMap,ie=new WeakSet,qt=function(r){return ze===f(this,Ve)?C(r):Re(r)},Dt=function(){St=!0;var r=Ue.prototype,s=Set.prototype;for(const i of as)r[i]=function(...a){return y(f(this,q)),s[i].apply(this,a)};for(const i of ns)r[i]=function(...a){y(f(this,q));var n=s[i].apply(this,a);return new Ue(n)}};let te=Ue;var U,H,B,He,D,ue,Ce;const Qe=class Qe extends Map{constructor(r){super();$(this,D);$(this,U,new Map);$(this,H,C(0));$(this,B,C(0));$(this,He,ze||-1);if(r){for(var[s,i]of r)super.set(s,i);f(this,B).v=super.size}}has(r){var s=f(this,U),i=s.get(r);if(i===void 0){var a=super.get(r);if(a!==void 0)i=V(this,D,ue).call(this,0),s.set(r,i);else return y(f(this,H)),!1}return y(i),!0}forEach(r,s){V(this,D,Ce).call(this),super.forEach(r,s)}get(r){var s=f(this,U),i=s.get(r);if(i===void 0){var a=super.get(r);if(a!==void 0)i=V(this,D,ue).call(this,0),s.set(r,i);else{y(f(this,H));return}}return y(i),super.get(r)}set(r,s){var v;var i=f(this,U),a=i.get(r),n=super.get(r),o=super.set(r,s),l=f(this,H);if(a===void 0)a=V(this,D,ue).call(this,0),i.set(r,a),O(f(this,B),super.size),W(l);else if(n!==s){W(a);var h=l.reactions===null?null:new Set(l.reactions),c=h===null||!((v=a.reactions)!=null&&v.every(d=>h.has(d)));c&&W(l)}return o}delete(r){var s=f(this,U),i=s.get(r),a=super.delete(r);return i!==void 0&&(s.delete(r),O(f(this,B),super.size),O(i,-1),W(f(this,H))),a}clear(){if(super.size!==0){super.clear();var r=f(this,U);O(f(this,B),0);for(var s of r.values())O(s,-1);W(f(this,H)),r.clear()}}keys(){return y(f(this,H)),super.keys()}values(){return V(this,D,Ce).call(this),super.values()}entries(){return V(this,D,Ce).call(this),super.entries()}[Symbol.iterator](){return this.entries()}get size(){return y(f(this,B)),super.size}};U=new WeakMap,H=new WeakMap,B=new WeakMap,He=new WeakMap,D=new WeakSet,ue=function(r){return ze===f(this,He)?C(r):Re(r)},Ce=function(){y(f(this,H));var r=f(this,U);if(f(this,B).v!==r.size){for(var s of lt(Qe.prototype,this,"keys").call(this))if(!r.has(s)){var i=V(this,D,ue).call(this,0);r.set(s,i)}}for([,i]of f(this,U))y(i)};let De=Qe;function os(t,e){return t.profile_id===e.profile_id&&t.profile_name===e.profile_name&&t.pid===e.pid&&t.port===e.port&&t.health_status===e.health_status&&Math.abs(t.uptime_seconds-e.uptime_seconds)<2&&Math.abs(t.memory_mb-e.memory_mb)<1}const We="__serverStoreHmrState";function ls(){if(typeof window<"u"){const t=window;return t[We]||(t[We]={servers:[],startingProfiles:new te,failedProfiles:new De,restartingProfiles:new te,pollingProfiles:new Set}),t[We]}return{servers:[],startingProfiles:new te,failedProfiles:new De,restartingProfiles:new te,pollingProfiles:new Set}}const le=ls();var pe,me,_e;class fs{constructor(){$(this,pe,C(Ct(le.servers)));$(this,me,C(!1));$(this,_e,C(null));L(this,"startingProfiles",le.startingProfiles);L(this,"failedProfiles",le.failedProfiles);L(this,"restartingProfiles",le.restartingProfiles);L(this,"pollingProfiles",le.pollingProfiles);L(this,"pollingInitialized",!1);L(this,"initialLoadComplete",!1);M.register("servers",{interval:5e3,minInterval:1e3,refreshFn:()=>this.doRefresh()})}get servers(){return y(f(this,pe))}set servers(e){O(f(this,pe),e,!0)}get loading(){return y(f(this,me))}set loading(e){O(f(this,me),e,!0)}get error(){return y(f(this,_e))}set error(e){O(f(this,_e),e,!0)}async doRefresh(){const e=!this.initialLoadComplete;e&&(this.loading=!0);try{const r=await Oe.list();Ft(this.servers,r,{getKey:s=>s.profile_id,isEqual:os}),this.initialLoadComplete=!0,this.error!==null&&(this.error=null)}catch(r){const s=r instanceof Error?r.message:"Failed to fetch servers";this.error!==s&&(this.error=s)}finally{e&&(this.loading=!1)}}async refresh(){return M.refresh("servers")}startPolling(){this.pollingInitialized||(M.start("servers"),this.pollingInitialized=!0)}stopPolling(){M.stop("servers"),this.pollingInitialized=!1}async start(e){this.startingProfiles.add(e),this.failedProfiles.delete(e),await Oe.start(e)}async stop(e,r=!1){this.startingProfiles.delete(e),this.failedProfiles.delete(e),await Oe.stop(e,r),await this.refresh()}async restart(e){this.restartingProfiles.add(e),this.failedProfiles.delete(e),await Oe.restart(e),this.restartingProfiles.delete(e),this.startingProfiles.add(e)}markStartupSuccess(e){const r=this.startingProfiles.has(e),s=this.failedProfiles.has(e),i=this.restartingProfiles.has(e);!r&&!s&&!i||(this.startingProfiles.delete(e),this.failedProfiles.delete(e),this.restartingProfiles.delete(e),this.refresh())}markStartupFailed(e,r,s=null){const i=this.failedProfiles.get(e),a=(i==null?void 0:i.error)===r&&(i==null?void 0:i.details)===s,n=this.startingProfiles.has(e),o=this.restartingProfiles.has(e);if(a&&!n&&!o)return;this.startingProfiles.delete(e),this.restartingProfiles.delete(e);const l=(i==null?void 0:i.detailsOpen)??!1;this.failedProfiles.set(e,{error:r,details:s,detailsOpen:l}),this.refresh()}toggleDetailsOpen(e){const r=this.failedProfiles.get(e);r&&this.failedProfiles.set(e,{...r,detailsOpen:!r.detailsOpen})}clearFailure(e){this.failedProfiles.delete(e)}isRunning(e){return this.servers.some(r=>r.profile_id===e)&&!this.startingProfiles.has(e)}isStarting(e){return this.startingProfiles.has(e)}isRestarting(e){return this.restartingProfiles.has(e)}isFailed(e){return this.failedProfiles.has(e)}getFailure(e){return this.failedProfiles.get(e)}getServer(e){return this.servers.find(r=>r.profile_id===e)}isProfilePolling(e){return this.pollingProfiles.has(e)}startProfilePolling(e){return this.pollingProfiles.has(e)?!1:(this.pollingProfiles.add(e),!0)}stopProfilePolling(e){this.pollingProfiles.delete(e)}}pe=new WeakMap,me=new WeakMap,_e=new WeakMap;const Ns=new fs;function us(t,e){return t.id===e.id&&t.name===e.name&&t.description===e.description&&t.model_path===e.model_path&&t.model_type===e.model_type&&t.port===e.port&&t.host===e.host&&t.context_length===e.context_length&&t.max_concurrency===e.max_concurrency&&t.queue_timeout===e.queue_timeout&&t.queue_size===e.queue_size&&t.tool_call_parser===e.tool_call_parser&&t.reasoning_parser===e.reasoning_parser&&t.enable_auto_tool_choice===e.enable_auto_tool_choice&&t.trust_remote_code===e.trust_remote_code&&t.chat_template_file===e.chat_template_file&&t.log_level===e.log_level&&t.log_file===e.log_file&&t.no_log_file===e.no_log_file&&t.auto_start===e.auto_start&&t.launchd_installed===e.launchd_installed&&t.created_at===e.created_at&&t.updated_at===e.updated_at}var we,ye,Se;class cs{constructor(){$(this,we,C(Ct([])));$(this,ye,C(!1));$(this,Se,C(null));L(this,"pollingInitialized",!1);L(this,"initialLoadComplete",!1);M.register("profiles",{interval:1e4,minInterval:1e3,refreshFn:()=>this.doRefresh()})}get profiles(){return y(f(this,we))}set profiles(e){O(f(this,we),e,!0)}get loading(){return y(f(this,ye))}set loading(e){O(f(this,ye),e,!0)}get error(){return y(f(this,Se))}set error(e){O(f(this,Se),e,!0)}async doRefresh(){const e=!this.initialLoadComplete;e&&(this.loading=!0);try{const r=await ee.list();Ft(this.profiles,r,{getKey:s=>s.id,isEqual:us}),this.initialLoadComplete=!0,this.error&&(this.error=null)}catch(r){this.error=r instanceof Error?r.message:"Failed to fetch profiles"}finally{e&&(this.loading=!1)}}async refresh(){return M.refresh("profiles")}startPolling(){this.pollingInitialized||(M.start("profiles"),this.pollingInitialized=!0)}stopPolling(){M.stop("profiles"),this.pollingInitialized=!1}async create(e){const r=await ee.create(e);return await this.refresh(),r}async update(e,r){const s=await ee.update(e,r);return await this.refresh(),s}async delete(e){await ee.delete(e),await this.refresh()}async duplicate(e,r){const s=await ee.duplicate(e,r);return await this.refresh(),s}async getNextPort(){return(await ee.getNextPort()).port}getProfile(e){return this.profiles.find(r=>r.id===e)}}we=new WeakMap,ye=new WeakMap,Se=new WeakMap;const Is=new cs;function hs(t,e){return t===null?!1:t.total_gb===e.total_gb&&t.available_gb===e.available_gb&&t.used_gb===e.used_gb&&t.percent_used===e.percent_used&&t.mlx_recommended_gb===e.mlx_recommended_gb}function ds(t,e){return t===null?!1:t.os_version===e.os_version&&t.chip===e.chip&&t.memory_gb===e.memory_gb&&t.python_version===e.python_version&&t.mlx_version===e.mlx_version&&t.mlx_openai_server_version===e.mlx_openai_server_version}var Pe,be,Ee,Ae;class gs{constructor(){$(this,Pe,C(null));$(this,be,C(null));$(this,Ee,C(!1));$(this,Ae,C(null));M.register("system-memory",{interval:3e4,minInterval:5e3,refreshFn:()=>this.doRefreshMemory()})}get memory(){return y(f(this,Pe))}set memory(e){O(f(this,Pe),e,!0)}get info(){return y(f(this,be))}set info(e){O(f(this,be),e,!0)}get loading(){return y(f(this,Ee))}set loading(e){O(f(this,Ee),e,!0)}get error(){return y(f(this,Ae))}set error(e){O(f(this,Ae),e,!0)}async doRefreshMemory(){try{const e=await yt.memory();hs(this.memory,e)||(this.memory=e)}catch(e){console.error("Failed to fetch memory:",e)}}async refreshMemory(){return M.refresh("system-memory")}startMemoryPolling(){M.start("system-memory")}stopMemoryPolling(){M.stop("system-memory")}async refreshInfo(){this.loading=!0;try{const e=await yt.info();ds(this.info,e)||(this.info=e)}catch(e){this.error=e instanceof Error?e.message:"Failed to fetch system info"}finally{this.loading=!1}}async refresh(){await Promise.all([this.refreshMemory(),this.refreshInfo()])}}Pe=new WeakMap,be=new WeakMap,Ee=new WeakMap,Ae=new WeakMap;const Cs=new gs;/**
 * @license lucide-svelte v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vs={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":2,"stroke-linecap":"round","stroke-linejoin":"round"};var ps=Nr("<svg><!><!></svg>");function Ls(t,e){const r=dt(e,["children","$$slots","$$events","$$legacy"]),s=dt(r,["name","color","size","strokeWidth","absoluteStrokeWidth","iconNode"]);yr(e,!1);let i=X(e,"name",8,void 0),a=X(e,"color",8,"currentColor"),n=X(e,"size",8,24),o=X(e,"strokeWidth",8,2),l=X(e,"absoluteStrokeWidth",8,!1),h=X(e,"iconNode",24,()=>[]);const c=(...A)=>A.filter((N,u,g)=>!!N&&g.indexOf(N)===u).join(" ");Cr();var v=ps();mt(v,(A,N)=>({...vs,...s,width:n(),height:n(),stroke:a(),"stroke-width":A,class:N}),[()=>(ae(l()),ae(o()),ae(n()),ct(()=>l()?Number(o())*24/Number(n()):o())),()=>(ae(i()),ae(r),ct(()=>c("lucide-icon","lucide",i()?`lucide-${i()}`:"",r.class)))]);var d=Pr(v);Ur(d,1,h,Dr,(A,N)=>{var u=$r(()=>Tr(y(N),2));let g=()=>y(u)[0],F=()=>y(u)[1];var R=Ir(),b=Ar(R);Kr(b,g,!0,(z,S)=>{mt(z,()=>({...F()}))}),ht(A,R)});var P=br(d);Br(P,e,"default",{}),Er(v),ht(t,v),Sr()}export{Ls as I,De as S,Ns as a,ee as b,Yr as c,Zr as d,Ur as e,Fe as f,$s as g,qe as h,yt as i,Oe as j,Os as k,Qr as l,Ts as m,mt as n,Dr as o,Is as p,Wr as q,Xr as r,Br as s,Es as t,Cs as u,M as v,As as w};
