(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,16715,e=>{"use strict";let t=(0,e.i(75254).default)("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);e.s(["RefreshCw",()=>t],16715)},94179,e=>{"use strict";var t=e.i(43476),a=e.i(91918),s=e.i(25913),i=e.i(47163);let r=(0,s.cva)("inline-flex items-center justify-center rounded-md border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&>svg]:size-3 gap-1 [&>svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground [a&]:hover:bg-primary/90",secondary:"border-transparent bg-secondary text-secondary-foreground [a&]:hover:bg-secondary/90",destructive:"border-transparent bg-destructive text-white [a&]:hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"text-foreground [a&]:hover:bg-accent [a&]:hover:text-accent-foreground"}},defaultVariants:{variant:"default"}});function l({className:e,variant:s,asChild:l=!1,...n}){let d=l?a.Slot:"span";return(0,t.jsx)(d,{"data-slot":"badge",className:(0,i.cn)(r({variant:s}),e),...n})}e.s(["Badge",()=>l])},20682,e=>{"use strict";var t=e.i(71645);let a=0,s=new Map,i=e=>{if(s.has(e))return;let t=setTimeout(()=>{s.delete(e),n({type:"REMOVE_TOAST",toastId:e})},1e6);s.set(e,t)},r=[],l={toasts:[]};function n(e){l=((e,t)=>{switch(t.type){case"ADD_TOAST":return{...e,toasts:[t.toast,...e.toasts].slice(0,1)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(e=>e.id===t.toast.id?{...e,...t.toast}:e)};case"DISMISS_TOAST":{let{toastId:a}=t;return a?i(a):e.toasts.forEach(e=>{i(e.id)}),{...e,toasts:e.toasts.map(e=>e.id===a||void 0===a?{...e,open:!1}:e)}}case"REMOVE_TOAST":if(void 0===t.toastId)return{...e,toasts:[]};return{...e,toasts:e.toasts.filter(e=>e.id!==t.toastId)}}})(l,e),r.forEach(e=>{e(l)})}function d({...e}){let t=(a=(a+1)%Number.MAX_SAFE_INTEGER).toString(),s=()=>n({type:"DISMISS_TOAST",toastId:t});return n({type:"ADD_TOAST",toast:{...e,id:t,open:!0,onOpenChange:e=>{e||s()}}}),{id:t,dismiss:s,update:e=>n({type:"UPDATE_TOAST",toast:{...e,id:t}})}}function o(){let[e,a]=t.useState(l);return t.useEffect(()=>(r.push(a),()=>{let e=r.indexOf(a);e>-1&&r.splice(e,1)}),[e]),{...e,toast:d,dismiss:e=>n({type:"DISMISS_TOAST",toastId:e})}}e.s(["useToast",()=>o])},47627,e=>{"use strict";var t=e.i(43476),a=e.i(47163);function s({className:e,...s}){return(0,t.jsx)("div",{"data-slot":"table-container",className:"relative w-full overflow-x-auto",children:(0,t.jsx)("table",{"data-slot":"table",className:(0,a.cn)("w-full caption-bottom text-sm",e),...s})})}function i({className:e,...s}){return(0,t.jsx)("thead",{"data-slot":"table-header",className:(0,a.cn)("[&_tr]:border-b",e),...s})}function r({className:e,...s}){return(0,t.jsx)("tbody",{"data-slot":"table-body",className:(0,a.cn)("[&_tr:last-child]:border-0",e),...s})}function l({className:e,...s}){return(0,t.jsx)("tr",{"data-slot":"table-row",className:(0,a.cn)("hover:bg-muted/50 data-[state=selected]:bg-muted border-b transition-colors",e),...s})}function n({className:e,...s}){return(0,t.jsx)("th",{"data-slot":"table-head",className:(0,a.cn)("text-foreground h-10 px-2 text-left align-middle font-medium whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",e),...s})}function d({className:e,...s}){return(0,t.jsx)("td",{"data-slot":"table-cell",className:(0,a.cn)("p-2 align-middle whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",e),...s})}e.s(["Table",()=>s,"TableBody",()=>r,"TableCell",()=>d,"TableHead",()=>n,"TableHeader",()=>i,"TableRow",()=>l])},7233,e=>{"use strict";let t=(0,e.i(75254).default)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);e.s(["Plus",()=>t],7233)},73375,e=>{"use strict";let t=(0,e.i(75254).default)("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);e.s(["ChevronLeft",()=>t],73375)},51364,e=>{"use strict";var t=e.i(43476),a=e.i(71645),s=e.i(18566),i=e.i(54858),r=e.i(54458),l=e.i(67881),n=e.i(23750),d=e.i(94179),o=e.i(47627),c=e.i(62870),u=e.i(30374),h=e.i(10708),m=e.i(55436),x=e.i(16715),p=e.i(73375),v=e.i(63059),b=e.i(7233),g=e.i(31278);let j=(0,e.i(75254).default)("LogIn",[["path",{d:"M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4",key:"u53s6r"}],["polyline",{points:"10 17 15 12 10 7",key:"1ail0h"}],["line",{x1:"15",x2:"3",y1:"12",y2:"12",key:"v6grx8"}]]);var f=e.i(20682),y=e.i(38036);function S(){let e=(0,s.useRouter)(),{toast:S}=(0,f.useToast)(),{showTestData:T}=(0,r.useAdminSettings)(),{startImpersonation:N,user:w}=(0,y.useAuth)(),[C,k]=(0,a.useState)([]),[A,I]=(0,a.useState)(!0),[_,E]=(0,a.useState)(0),[R,D]=(0,a.useState)(0),[M]=(0,a.useState)(20),[O,B]=(0,a.useState)(!1),[L,P]=(0,a.useState)(""),[H,F]=(0,a.useState)(""),[U,$]=(0,a.useState)("created_at"),[V,z]=(0,a.useState)("desc"),[K,q]=(0,a.useState)(!1),[G,J]=(0,a.useState)(null),[X,Y]=(0,a.useState)(""),[Q,W]=(0,a.useState)(""),[Z,ee]=(0,a.useState)(!1),[et,ea]=(0,a.useState)(null),es=(0,a.useCallback)(async()=>{try{I(!0);let e=await i.adminApi.listUsers({limit:M,offset:R,search:L||void 0,sort_by:U,sort_order:V,exclude_test:!T});k(e.users),E(e.total),B(e.has_more)}catch(e){console.error("Failed to load users:",e),S({title:"Error",description:e.message||"Failed to load users",variant:"destructive"})}finally{I(!1)}},[M,R,L,U,V,T,S]);(0,a.useEffect)(()=>{es()},[es]);let ei=()=>{D(0),P(H)},er=async()=>{if(!G||!X||!Q)return;let e=parseInt(X.trim(),10);if(!Number.isInteger(e)||e<1||e>1e5)return void S({title:"Invalid Amount",description:"Please enter a valid amount between 1 and 100,000",variant:"destructive"});try{ee(!0),await i.adminApi.addCredits(G.email,e,Q),S({title:"Credits Added",description:`Added ${X} credits to ${G.email}`}),q(!1),Y(""),W(""),J(null),es()}catch(e){S({title:"Error",description:e.message||"Failed to add credits",variant:"destructive"})}finally{ee(!1)}},el=async t=>{if(t.email===w?.email)return void S({title:"Cannot Impersonate",description:"You cannot impersonate yourself",variant:"destructive"});ea(t.email);try{if(await N(t.email))S({title:"Impersonating User",description:`Now viewing as ${t.email}`}),e.push("/app");else{let e=y.useAuth.getState().error;S({title:"Impersonation Failed",description:e||"Unable to impersonate user. Please try again.",variant:"destructive"})}}catch(e){S({title:"Error",description:e.message||"Failed to impersonate user",variant:"destructive"})}finally{ea(null)}};return(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-2xl font-bold tracking-tight",children:"Users"}),(0,t.jsx)("p",{className:"text-muted-foreground",children:"Manage user accounts and credits"})]}),(0,t.jsxs)(l.Button,{variant:"outline",size:"sm",onClick:es,disabled:A,children:[(0,t.jsx)(x.RefreshCw,{className:`w-4 h-4 mr-2 ${A?"animate-spin":""}`}),"Refresh"]})]}),(0,t.jsxs)("div",{className:"flex flex-col sm:flex-row gap-4",children:[(0,t.jsxs)("div",{className:"flex-1 flex gap-2",children:[(0,t.jsx)(n.Input,{placeholder:"Search by email...",value:H,onChange:e=>F(e.target.value),onKeyPress:e=>{"Enter"===e.key&&ei()},className:"max-w-sm"}),(0,t.jsx)(l.Button,{variant:"secondary",onClick:ei,children:(0,t.jsx)(m.Search,{className:"w-4 h-4"})})]}),(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsxs)(c.Select,{value:U,onValueChange:e=>$(e),children:[(0,t.jsx)(c.SelectTrigger,{className:"w-[140px]",children:(0,t.jsx)(c.SelectValue,{placeholder:"Sort by"})}),(0,t.jsxs)(c.SelectContent,{children:[(0,t.jsx)(c.SelectItem,{value:"created_at",children:"Created"}),(0,t.jsx)(c.SelectItem,{value:"last_login_at",children:"Last Login"}),(0,t.jsx)(c.SelectItem,{value:"credits",children:"Credits"}),(0,t.jsx)(c.SelectItem,{value:"email",children:"Email"})]})]}),(0,t.jsxs)(c.Select,{value:V,onValueChange:e=>z(e),children:[(0,t.jsx)(c.SelectTrigger,{className:"w-[100px]",children:(0,t.jsx)(c.SelectValue,{placeholder:"Order"})}),(0,t.jsxs)(c.SelectContent,{children:[(0,t.jsx)(c.SelectItem,{value:"desc",children:"Desc"}),(0,t.jsx)(c.SelectItem,{value:"asc",children:"Asc"})]})]})]})]}),(0,t.jsx)("div",{className:"rounded-md border",children:(0,t.jsxs)(o.Table,{children:[(0,t.jsx)(o.TableHeader,{children:(0,t.jsxs)(o.TableRow,{children:[(0,t.jsx)(o.TableHead,{children:"Email"}),(0,t.jsx)(o.TableHead,{children:"Role"}),(0,t.jsx)(o.TableHead,{className:"text-right",children:"Credits"}),(0,t.jsx)(o.TableHead,{className:"text-right",children:"Jobs"}),(0,t.jsx)(o.TableHead,{className:"text-right",children:"Actions"})]})}),(0,t.jsx)(o.TableBody,{children:A?(0,t.jsx)(o.TableRow,{children:(0,t.jsx)(o.TableCell,{colSpan:5,className:"text-center py-8",children:(0,t.jsx)(g.Loader2,{className:"w-6 h-6 animate-spin mx-auto text-muted-foreground"})})}):0===C.length?(0,t.jsx)(o.TableRow,{children:(0,t.jsx)(o.TableCell,{colSpan:5,className:"text-center py-8 text-muted-foreground",children:"No users found"})}):C.map(a=>(0,t.jsxs)(o.TableRow,{className:"cursor-pointer hover:bg-muted/50",onClick:()=>e.push(`/admin/users/detail?email=${encodeURIComponent(a.email)}`),children:[(0,t.jsxs)(o.TableCell,{className:"font-medium",children:[a.display_name||a.email,a.display_name&&(0,t.jsx)("span",{className:"text-muted-foreground text-sm block",children:a.email})]}),(0,t.jsx)(o.TableCell,{children:(0,t.jsx)(d.Badge,{variant:"admin"===a.role?"default":"secondary",children:a.role})}),(0,t.jsx)(o.TableCell,{className:"text-right",children:a.credits}),(0,t.jsxs)(o.TableCell,{className:"text-right",children:[a.total_jobs_created??0," / ",a.total_jobs_completed??0]}),(0,t.jsx)(o.TableCell,{className:"text-right",children:(0,t.jsxs)("div",{className:"flex justify-end gap-1",onClick:e=>e.stopPropagation(),children:[(0,t.jsx)(l.Button,{variant:"ghost",size:"icon",onClick:()=>{J(a),q(!0)},title:"Add credits",children:(0,t.jsx)(b.Plus,{className:"w-4 h-4"})}),(0,t.jsx)(l.Button,{variant:"ghost",size:"icon",onClick:()=>el(a),title:"Impersonate user",disabled:a.email===w?.email||null!==et,children:et===a.email?(0,t.jsx)(g.Loader2,{className:"w-4 h-4 animate-spin"}):(0,t.jsx)(j,{className:"w-4 h-4"})})]})})]},a.email))})]})}),(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:0===_?"No users found":`Showing ${R+1}-${Math.min(R+C.length,_)} of ${_} users`}),(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsxs)(l.Button,{variant:"outline",size:"sm",onClick:()=>D(Math.max(0,R-M)),disabled:0===R,children:[(0,t.jsx)(p.ChevronLeft,{className:"w-4 h-4"}),"Previous"]}),(0,t.jsxs)(l.Button,{variant:"outline",size:"sm",onClick:()=>D(R+M),disabled:!O,children:["Next",(0,t.jsx)(v.ChevronRight,{className:"w-4 h-4"})]})]})]}),(0,t.jsx)(u.Dialog,{open:K,onOpenChange:q,children:(0,t.jsxs)(u.DialogContent,{children:[(0,t.jsxs)(u.DialogHeader,{children:[(0,t.jsx)(u.DialogTitle,{children:"Add Credits"}),(0,t.jsxs)(u.DialogDescription,{children:["Add credits to ",G?.email]})]}),(0,t.jsxs)("div",{className:"space-y-4 py-4",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(h.Label,{htmlFor:"amount",children:"Amount"}),(0,t.jsx)(n.Input,{id:"amount",type:"number",min:"1",placeholder:"Enter amount",value:X,onChange:e=>Y(e.target.value)})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(h.Label,{htmlFor:"reason",children:"Reason"}),(0,t.jsx)(n.Input,{id:"reason",placeholder:"e.g., Beta reward, Support credit",value:Q,onChange:e=>W(e.target.value)})]})]}),(0,t.jsxs)(u.DialogFooter,{children:[(0,t.jsx)(l.Button,{variant:"outline",onClick:()=>q(!1),children:"Cancel"}),(0,t.jsxs)(l.Button,{onClick:er,disabled:!X||!Q||Z,children:[Z&&(0,t.jsx)(g.Loader2,{className:"w-4 h-4 mr-2 animate-spin"}),"Add Credits"]})]})]})})]})}e.s(["default",()=>S],51364)}]);