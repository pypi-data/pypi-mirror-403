name: Check Documentation Updates

on:
  pull_request:
    branches: [ main ]
    types: [opened, synchronize, reopened, labeled, unlabeled]

jobs:
  check-docs:
    runs-on: ubuntu-latest
    permissions:
      contents: read
    if: github.head_ref != 'main' && !contains(join(github.event.pull_request.labels.*.name, ','), 'skip docs')
    steps:
      - name: Check out code
        uses: actions/checkout@v4
        with:
          fetch-depth: 0

      - name: Check for documentation changes
        run: |
          BASE_BRANCH=${GITHUB_BASE_REF:-main}
          if git diff --name-only origin/$BASE_BRANCH...HEAD | grep -q "^docs/"; then
            echo "âœ… Documentation has been updated"
          else
            echo "::error::No documentation changes detected. Please update at least one file in the /docs/ directory or add the 'skip docs' label to skip this check."
            exit 1
          fi
