Name                                                          Stmts   Miss  Cover
---------------------------------------------------------------------------------
src/mcp_agent_mail/__init__.py                                    9      0   100%
src/mcp_agent_mail/app.py                                      3363   2573    23%
src/mcp_agent_mail/cli.py                                      1807   1635    10%
src/mcp_agent_mail/config.py                                    183      7    96%
src/mcp_agent_mail/db.py                                        168     76    55%
src/mcp_agent_mail/guard.py                                      19      9    53%
src/mcp_agent_mail/http.py                                     1262   1211     4%
src/mcp_agent_mail/llm.py                                       173    141    18%
src/mcp_agent_mail/models.py                                     83      0   100%
src/mcp_agent_mail/rich_logger.py                               412    245    41%
src/mcp_agent_mail/share.py                                     966    851    12%
src/mcp_agent_mail/slack_integration.py                         280    198    29%
src/mcp_agent_mail/slots.py                                      11      4    64%
src/mcp_agent_mail/storage.py                                    64     23    64%
src/mcp_agent_mail/utils.py                                      36     16    56%
tests/__init__.py                                                 0      0   100%
tests/conftest.py                                                64     64     0%
tests/integration/conftest.py                                    23     11    52%
tests/integration/test_closed_resource_error_integration.py     118     91    23%
tests/integration/test_mailbox_share_integration.py             132    108    18%
tests/integration/test_mcp_mail_crud.py                         310    241    22%
tests/integration/test_mcp_mail_messaging.py                    184    154    16%
tests/integration/test_message_latency.py                       277    237    14%
tests/integration/test_multi_agent_workflows.py                 165    141    15%
tests/integration/test_resources_and_macros.py                  162    135    17%
tests/integration/test_search_mailbox_mcp_mail.py                88     70    20%
tests/integration/test_since_ts_filter.py                        60     47    22%
tests/integration/test_slack_mcp_mail_integration.py            288    244    15%
tests/integration/test_slack_webhook_api.py                      67     50    25%
tests/manual/manual_scenarios_fixed.py                          126     16    87%
tests/manual/test_instrumented_registration.py                   98     17    83%
tests/manual/test_manual_scenarios_fixed.py                       5      0   100%
tests/test_ack_views_details.py                                  15      9    40%
tests/test_agent_contact_policy_field.py                         58     45    22%
tests/test_agent_discovery_ux.py                                121     89    26%
tests/test_agent_message_reading_after_registration.py           50     40    20%
tests/test_agent_name_sanitization.py                            61     41    33%
tests/test_app_helpers.py                                        37     27    27%
tests/test_attachment_policy.py                                  20     11    45%
tests/test_attachments_extended.py                               53     40    25%
tests/test_build_slots.py                                       154    125    19%
tests/test_claim_overlap_and_macro_failures.py                   15      9    40%
tests/test_cli.py                                                62     51    18%
tests/test_cli_acks_and_errors.py                                41     31    24%
tests/test_cli_additional.py                                     42     33    21%
tests/test_cli_extended.py                                       60     48    20%
tests/test_cli_integration.py                                   222    184    17%
tests/test_cli_list_acks_and_main.py                             39     30    23%
tests/test_db_migrations_and_http_main.py                        35     24    31%
tests/test_e2e_workflows.py                                     206    180    13%
tests/test_entry_and_llm_errors.py                                9      4    56%
tests/test_entrypoints_and_llm.py                                50     42    16%
tests/test_global_agent_uniqueness_modes.py                     125    103    18%
tests/test_global_inbox_scanning.py                             101     82    19%
tests/test_global_inbox_ttl.py                                   73     58    21%
tests/test_guard_edges.py                                        36     26    28%
tests/test_guard_integration.py                                  49     34    31%
tests/test_guard_tools.py                                        23     15    35%
tests/test_http_auth_rate_limit.py                               37     28    24%
tests/test_http_closed_resource_error.py                        127    106    17%
tests/test_http_logging_and_errors.py                            49     35    29%
tests/test_http_negative_jwt.py                                  86     68    21%
tests/test_http_redis_rate_limit.py                              36     24    33%
tests/test_http_transport.py                                    114     91    20%
tests/test_http_unit.py                                          20     14    30%
tests/test_http_workers_and_options.py                           66     50    24%
tests/test_identity_markers.py                                   52     43    17%
tests/test_identity_resources.py                                143    118    17%
tests/test_lazy_loading.py                                       67     51    24%
tests/test_llm_and_utils.py                                      49     38    22%
tests/test_logging_and_redis_fallback.py                         38     27    29%
tests/test_macro_start_session_with_claims.py                    42     35    17%
tests/test_macros.py                                             45     33    27%
tests/test_mailbox_with_commits.py                               14      8    43%
tests/test_main_http_entry.py                                     7      4    43%
tests/test_materialized_views.py                                155    140    10%
tests/test_messaging_semantics.py                                53     43    19%
tests/test_more_resources.py                                     23     17    26%
tests/test_multiagent_registration_session_bug.py                56     46    18%
tests/test_negative_inputs.py                                    30     22    27%
tests/test_outbox_and_claims.py                                  45     34    24%
tests/test_pathspec_overlap.py                                   11      7    36%
tests/test_performance_benchmarks.py                            151    119    21%
tests/test_placeholder_agents.py                                 93     73    22%
tests/test_prepush_guard.py                                     163    136    17%
tests/test_project_informative_only.py                           52     38    27%
tests/test_pseudonymization_export_salt.py                       34     24    29%
tests/test_query_locality.py                                    131    112    15%
tests/test_reply_and_threads.py                                  35     27    23%
tests/test_resource_edges.py                                     28     22    21%
tests/test_resources_mailbox.py                                  53     40    25%
tests/test_search_mailbox.py                                    121    104    14%
tests/test_search_mailbox_edge_cases.py                         165    136    18%
tests/test_search_mailbox_integration.py                        119    100    16%
tests/test_server.py                                            307    266    13%
tests/test_share_export.py                                      615    559     9%
tests/test_share_indexes.py                                      31     23    26%
tests/test_share_update.py                                      193    177     8%
tests/test_slack_mirror.py                                       63     57    10%
tests/test_storage_edges.py                                      21     13    38%
tests/test_storage_inline_fallback.py                            15      9    40%
tests/test_summarize_threads_extended.py                         18     12    33%
tests/test_summarize_threads_llm_off.py                          22     14    36%
tests/test_summarize_threads_llm_on.py                           31     22    29%
tests/test_thread_resource_query_params.py                       45     35    22%
tests/test_tooling_and_views_resources.py                        27     19    30%
tests/test_tooling_resources.py                                  77     61    21%
tests/test_utils_config_db_edges.py                              21     13    38%
tests/test_utils_validation.py                                   92     71    23%
tests/test_viewer_storage.py                                     22     14    36%
tests/test_xss_corpus.py                                         75     57    24%
---------------------------------------------------------------------------------
TOTAL                                                         16945  13431    21%
