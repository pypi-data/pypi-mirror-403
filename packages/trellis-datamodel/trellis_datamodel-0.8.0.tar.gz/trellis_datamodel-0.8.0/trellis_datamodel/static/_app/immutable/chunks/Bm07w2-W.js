import{D as $e,aT as ki,bk as Si,br as Ei,h as Ci,a5 as Ni,aG as Pi,r as fr,f as hr,u as et,R as Mi,W as zi,y as oe,bp as zt,O as Ai,J as re,H as j,I as U,C as a,M as m,V as bt,a0 as Lt,w as ae,L as ne,x as le,K as Bt,bs as gr,B as rt,z as ge,F as H,bq as an,b3 as io,bt as we,bu as Se,bv as Di,A as Eo}from"./QnYduk6G.js";import{s as Ii}from"./CZmMB171.js";import{f as ie,a as K,b as he,t as Yn,q as Xn,e as ln,d as so,c as me}from"./CjZGm4I-.js";import{s as Ce}from"./CelXzvVb.js";import{p as R,r as qe,i as se,s as Ye}from"./DjhwXl_d.js";import{g as Ge,C as ao,S as _n,s as J,b as Ue,c as lt,d as Ne}from"./9BfctgED.js";import{b as Kt}from"./6fX-1bKn.js";import{e as nt,I as Ti,i as In}from"./CfnWWzkx.js";import{i as Oi}from"./Cghq3m_P.js";import{c as kn}from"./D_CnFxQq.js";import{s as xe,c as Hi}from"./B9JYo02m.js";var Ri="font-weight: bold",Vi="font-weight: normal";function Co(e){$e?console.warn(`%c[svelte] state_snapshot_uncloneable
%c${e?`The following properties cannot be cloned with \`$state.snapshot\` — the return value contains the originals:

${e}`:"Value cannot be cloned with `$state.snapshot` — the original value was returned"}
https://svelte.dev/e/state_snapshot_uncloneable`,Ri,Vi):console.warn("https://svelte.dev/e/state_snapshot_uncloneable")}const Li=[];function mr(e,t=!1,n=!1){if($e&&!t){const o=[],r=Pt(e,new Map,"",o,null,n);if(o.length===1&&o[0]==="")Co();else if(o.length>0){const i=o.length>10?o.slice(0,7):o.slice(0,10),s=o.length-i.length;let l=i.map(d=>`- <value>${d}`).join(`
`);s>0&&(l+=`
- ...and ${s} more`),Co(l)}return r}return Pt(e,new Map,"",Li,null,n)}function Pt(e,t,n,o,r=null,i=!1){if(typeof e=="object"&&e!==null){var s=t.get(e);if(s!==void 0)return s;if(e instanceof Map)return new Map(e);if(e instanceof Set)return new Set(e);if(ki(e)){var l=Array(e.length);t.set(e,l),r!==null&&t.set(r,l);for(var d=0;d<e.length;d+=1){var c=e[d];d in e&&(l[d]=Pt(c,t,$e?`${n}[${d}]`:n,o,null,i))}return l}if(Si(e)===Ei){l={},t.set(e,l),r!==null&&t.set(r,l);for(var u in e)l[u]=Pt(e[u],t,$e?`${n}.${u}`:n,o,null,i);return l}if(e instanceof Date)return structuredClone(e);if(typeof e.toJSON=="function"&&!i)return Pt(e.toJSON(),t,$e?`${n}.toJSON()`:n,o,e)}if(e instanceof EventTarget)return e;try{return structuredClone(e)}catch{return $e&&o.push(n),e}}function Bi(e,t){Ci&&Ni(Pi(e)),fr(()=>{var n=t();for(var o in n){var r=n[o];r?e.style.setProperty(o,r):e.style.removeProperty(o)}})}function pe(e,t,n){hr(()=>{var o=et(()=>t(e,n?.())||{});if(n&&o?.update){var r=!1,i={};fr(()=>{var s=n();Mi(s),r&&zi(i,s)&&(i=s,o.update(s))}),r=!0}if(o?.destroy)return()=>o.destroy()})}class lo{#e=new WeakMap;#t;#n;static entries=new WeakMap;constructor(t){this.#n=t}observe(t,n){var o=this.#e.get(t)||new Set;return o.add(n),this.#e.set(t,o),this.#o().observe(t,this.#n),()=>{var r=this.#e.get(t);r.delete(n),r.size===0&&(this.#e.delete(t),this.#t.unobserve(t))}}#o(){return this.#t??(this.#t=new ResizeObserver(t=>{for(var n of t){lo.entries.set(n.target,n);for(var o of this.#e.get(n.target)||[])o(n)}}))}}var Ki=new lo({box:"border-box"});function No(e,t,n){var o=Ki.observe(e,()=>n(e[t]));hr(()=>(et(()=>n(e[t])),o))}const yr=()=>{const e=Ii;return{page:{subscribe:e.page.subscribe},navigating:{subscribe:e.navigating.subscribe},updated:e.updated}},Cf={subscribe(e){return($e?Zi("page"):yr().page).subscribe(e)}};function Zi(e){try{return yr()[e]}catch{throw new Error(`Cannot subscribe to '${e}' store on the server outside of a Svelte component, as it is bound to the current request via component context. This prevents state from leaking between users.For more information, see https://svelte.dev/docs/kit/state-management#avoid-shared-state-on-the-server`)}}var Fi={value:()=>{}};function Sn(){for(var e=0,t=arguments.length,n={},o;e<t;++e){if(!(o=arguments[e]+"")||o in n||/[\s.]/.test(o))throw new Error("illegal type: "+o);n[o]=[]}return new tn(n)}function tn(e){this._=e}function Yi(e,t){return e.trim().split(/^|\s+/).map(function(n){var o="",r=n.indexOf(".");if(r>=0&&(o=n.slice(r+1),n=n.slice(0,r)),n&&!t.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:o}})}tn.prototype=Sn.prototype={constructor:tn,on:function(e,t){var n=this._,o=Yi(e+"",n),r,i=-1,s=o.length;if(arguments.length<2){for(;++i<s;)if((r=(e=o[i]).type)&&(r=Xi(n[r],e.name)))return r;return}if(t!=null&&typeof t!="function")throw new Error("invalid callback: "+t);for(;++i<s;)if(r=(e=o[i]).type)n[r]=Po(n[r],e.name,t);else if(t==null)for(r in n)n[r]=Po(n[r],e.name,null);return this},copy:function(){var e={},t=this._;for(var n in t)e[n]=t[n].slice();return new tn(e)},call:function(e,t){if((r=arguments.length-2)>0)for(var n=new Array(r),o=0,r,i;o<r;++o)n[o]=arguments[o+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(i=this._[e],o=0,r=i.length;o<r;++o)i[o].value.apply(t,n)},apply:function(e,t,n){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var o=this._[e],r=0,i=o.length;r<i;++r)o[r].value.apply(t,n)}};function Xi(e,t){for(var n=0,o=e.length,r;n<o;++n)if((r=e[n]).name===t)return r.value}function Po(e,t,n){for(var o=0,r=e.length;o<r;++o)if(e[o].name===t){e[o]=Fi,e=e.slice(0,o).concat(e.slice(o+1));break}return n!=null&&e.push({name:t,value:n}),e}var Wn="http://www.w3.org/1999/xhtml";const Mo={svg:"http://www.w3.org/2000/svg",xhtml:Wn,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function En(e){var t=e+="",n=t.indexOf(":");return n>=0&&(t=e.slice(0,n))!=="xmlns"&&(e=e.slice(n+1)),Mo.hasOwnProperty(t)?{space:Mo[t],local:e}:e}function Wi(e){return function(){var t=this.ownerDocument,n=this.namespaceURI;return n===Wn&&t.documentElement.namespaceURI===Wn?t.createElement(e):t.createElementNS(n,e)}}function qi(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}function vr(e){var t=En(e);return(t.local?qi:Wi)(t)}function Gi(){}function co(e){return e==null?Gi:function(){return this.querySelector(e)}}function Ui(e){typeof e!="function"&&(e=co(e));for(var t=this._groups,n=t.length,o=new Array(n),r=0;r<n;++r)for(var i=t[r],s=i.length,l=o[r]=new Array(s),d,c,u=0;u<s;++u)(d=i[u])&&(c=e.call(d,d.__data__,u,i))&&("__data__"in d&&(c.__data__=d.__data__),l[u]=c);return new ke(o,this._parents)}function Qi(e){return e==null?[]:Array.isArray(e)?e:Array.from(e)}function Ji(){return[]}function wr(e){return e==null?Ji:function(){return this.querySelectorAll(e)}}function ji(e){return function(){return Qi(e.apply(this,arguments))}}function $i(e){typeof e=="function"?e=ji(e):e=wr(e);for(var t=this._groups,n=t.length,o=[],r=[],i=0;i<n;++i)for(var s=t[i],l=s.length,d,c=0;c<l;++c)(d=s[c])&&(o.push(e.call(d,d.__data__,c,s)),r.push(d));return new ke(o,r)}function pr(e){return function(){return this.matches(e)}}function xr(e){return function(t){return t.matches(e)}}var es=Array.prototype.find;function ts(e){return function(){return es.call(this.children,e)}}function ns(){return this.firstElementChild}function os(e){return this.select(e==null?ns:ts(typeof e=="function"?e:xr(e)))}var rs=Array.prototype.filter;function is(){return Array.from(this.children)}function ss(e){return function(){return rs.call(this.children,e)}}function as(e){return this.selectAll(e==null?is:ss(typeof e=="function"?e:xr(e)))}function ls(e){typeof e!="function"&&(e=pr(e));for(var t=this._groups,n=t.length,o=new Array(n),r=0;r<n;++r)for(var i=t[r],s=i.length,l=o[r]=[],d,c=0;c<s;++c)(d=i[c])&&e.call(d,d.__data__,c,i)&&l.push(d);return new ke(o,this._parents)}function br(e){return new Array(e.length)}function cs(){return new ke(this._enter||this._groups.map(br),this._parents)}function cn(e,t){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=t}cn.prototype={constructor:cn,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,t){return this._parent.insertBefore(e,t)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};function us(e){return function(){return e}}function ds(e,t,n,o,r,i){for(var s=0,l,d=t.length,c=i.length;s<c;++s)(l=t[s])?(l.__data__=i[s],o[s]=l):n[s]=new cn(e,i[s]);for(;s<d;++s)(l=t[s])&&(r[s]=l)}function fs(e,t,n,o,r,i,s){var l,d,c=new Map,u=t.length,h=i.length,f=new Array(u),y;for(l=0;l<u;++l)(d=t[l])&&(f[l]=y=s.call(d,d.__data__,l,t)+"",c.has(y)?r[l]=d:c.set(y,d));for(l=0;l<h;++l)y=s.call(e,i[l],l,i)+"",(d=c.get(y))?(o[l]=d,d.__data__=i[l],c.delete(y)):n[l]=new cn(e,i[l]);for(l=0;l<u;++l)(d=t[l])&&c.get(f[l])===d&&(r[l]=d)}function hs(e){return e.__data__}function gs(e,t){if(!arguments.length)return Array.from(this,hs);var n=t?fs:ds,o=this._parents,r=this._groups;typeof e!="function"&&(e=us(e));for(var i=r.length,s=new Array(i),l=new Array(i),d=new Array(i),c=0;c<i;++c){var u=o[c],h=r[c],f=h.length,y=ms(e.call(u,u&&u.__data__,c,o)),w=y.length,p=l[c]=new Array(w),S=s[c]=new Array(w),C=d[c]=new Array(f);n(u,h,p,S,C,y,t);for(var P=0,M=0,_,V;P<w;++P)if(_=p[P]){for(P>=M&&(M=P+1);!(V=S[M])&&++M<w;);_._next=V||null}}return s=new ke(s,o),s._enter=l,s._exit=d,s}function ms(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function ys(){return new ke(this._exit||this._groups.map(br),this._parents)}function vs(e,t,n){var o=this.enter(),r=this,i=this.exit();return typeof e=="function"?(o=e(o),o&&(o=o.selection())):o=o.append(e+""),t!=null&&(r=t(r),r&&(r=r.selection())),n==null?i.remove():n(i),o&&r?o.merge(r).order():r}function ws(e){for(var t=e.selection?e.selection():e,n=this._groups,o=t._groups,r=n.length,i=o.length,s=Math.min(r,i),l=new Array(r),d=0;d<s;++d)for(var c=n[d],u=o[d],h=c.length,f=l[d]=new Array(h),y,w=0;w<h;++w)(y=c[w]||u[w])&&(f[w]=y);for(;d<r;++d)l[d]=n[d];return new ke(l,this._parents)}function ps(){for(var e=this._groups,t=-1,n=e.length;++t<n;)for(var o=e[t],r=o.length-1,i=o[r],s;--r>=0;)(s=o[r])&&(i&&s.compareDocumentPosition(i)^4&&i.parentNode.insertBefore(s,i),i=s);return this}function xs(e){e||(e=bs);function t(h,f){return h&&f?e(h.__data__,f.__data__):!h-!f}for(var n=this._groups,o=n.length,r=new Array(o),i=0;i<o;++i){for(var s=n[i],l=s.length,d=r[i]=new Array(l),c,u=0;u<l;++u)(c=s[u])&&(d[u]=c);d.sort(t)}return new ke(r,this._parents).order()}function bs(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function _s(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this}function ks(){return Array.from(this)}function Ss(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var o=e[t],r=0,i=o.length;r<i;++r){var s=o[r];if(s)return s}return null}function Es(){let e=0;for(const t of this)++e;return e}function Cs(){return!this.node()}function Ns(e){for(var t=this._groups,n=0,o=t.length;n<o;++n)for(var r=t[n],i=0,s=r.length,l;i<s;++i)(l=r[i])&&e.call(l,l.__data__,i,r);return this}function Ps(e){return function(){this.removeAttribute(e)}}function Ms(e){return function(){this.removeAttributeNS(e.space,e.local)}}function zs(e,t){return function(){this.setAttribute(e,t)}}function As(e,t){return function(){this.setAttributeNS(e.space,e.local,t)}}function Ds(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttribute(e):this.setAttribute(e,n)}}function Is(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,n)}}function Ts(e,t){var n=En(e);if(arguments.length<2){var o=this.node();return n.local?o.getAttributeNS(n.space,n.local):o.getAttribute(n)}return this.each((t==null?n.local?Ms:Ps:typeof t=="function"?n.local?Is:Ds:n.local?As:zs)(n,t))}function _r(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}function Os(e){return function(){this.style.removeProperty(e)}}function Hs(e,t,n){return function(){this.style.setProperty(e,t,n)}}function Rs(e,t,n){return function(){var o=t.apply(this,arguments);o==null?this.style.removeProperty(e):this.style.setProperty(e,o,n)}}function Vs(e,t,n){return arguments.length>1?this.each((t==null?Os:typeof t=="function"?Rs:Hs)(e,t,n??"")):mt(this.node(),e)}function mt(e,t){return e.style.getPropertyValue(t)||_r(e).getComputedStyle(e,null).getPropertyValue(t)}function Ls(e){return function(){delete this[e]}}function Bs(e,t){return function(){this[e]=t}}function Ks(e,t){return function(){var n=t.apply(this,arguments);n==null?delete this[e]:this[e]=n}}function Zs(e,t){return arguments.length>1?this.each((t==null?Ls:typeof t=="function"?Ks:Bs)(e,t)):this.node()[e]}function kr(e){return e.trim().split(/^|\s+/)}function uo(e){return e.classList||new Sr(e)}function Sr(e){this._node=e,this._names=kr(e.getAttribute("class")||"")}Sr.prototype={add:function(e){var t=this._names.indexOf(e);t<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var t=this._names.indexOf(e);t>=0&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};function Er(e,t){for(var n=uo(e),o=-1,r=t.length;++o<r;)n.add(t[o])}function Cr(e,t){for(var n=uo(e),o=-1,r=t.length;++o<r;)n.remove(t[o])}function Fs(e){return function(){Er(this,e)}}function Ys(e){return function(){Cr(this,e)}}function Xs(e,t){return function(){(t.apply(this,arguments)?Er:Cr)(this,e)}}function Ws(e,t){var n=kr(e+"");if(arguments.length<2){for(var o=uo(this.node()),r=-1,i=n.length;++r<i;)if(!o.contains(n[r]))return!1;return!0}return this.each((typeof t=="function"?Xs:t?Fs:Ys)(n,t))}function qs(){this.textContent=""}function Gs(e){return function(){this.textContent=e}}function Us(e){return function(){var t=e.apply(this,arguments);this.textContent=t??""}}function Qs(e){return arguments.length?this.each(e==null?qs:(typeof e=="function"?Us:Gs)(e)):this.node().textContent}function Js(){this.innerHTML=""}function js(e){return function(){this.innerHTML=e}}function $s(e){return function(){var t=e.apply(this,arguments);this.innerHTML=t??""}}function ea(e){return arguments.length?this.each(e==null?Js:(typeof e=="function"?$s:js)(e)):this.node().innerHTML}function ta(){this.nextSibling&&this.parentNode.appendChild(this)}function na(){return this.each(ta)}function oa(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function ra(){return this.each(oa)}function ia(e){var t=typeof e=="function"?e:vr(e);return this.select(function(){return this.appendChild(t.apply(this,arguments))})}function sa(){return null}function aa(e,t){var n=typeof e=="function"?e:vr(e),o=t==null?sa:typeof t=="function"?t:co(t);return this.select(function(){return this.insertBefore(n.apply(this,arguments),o.apply(this,arguments)||null)})}function la(){var e=this.parentNode;e&&e.removeChild(this)}function ca(){return this.each(la)}function ua(){var e=this.cloneNode(!1),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function da(){var e=this.cloneNode(!0),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function fa(e){return this.select(e?da:ua)}function ha(e){return arguments.length?this.property("__data__",e):this.node().__data__}function ga(e){return function(t){e.call(this,t,this.__data__)}}function ma(e){return e.trim().split(/^|\s+/).map(function(t){var n="",o=t.indexOf(".");return o>=0&&(n=t.slice(o+1),t=t.slice(0,o)),{type:t,name:n}})}function ya(e){return function(){var t=this.__on;if(t){for(var n=0,o=-1,r=t.length,i;n<r;++n)i=t[n],(!e.type||i.type===e.type)&&i.name===e.name?this.removeEventListener(i.type,i.listener,i.options):t[++o]=i;++o?t.length=o:delete this.__on}}}function va(e,t,n){return function(){var o=this.__on,r,i=ga(t);if(o){for(var s=0,l=o.length;s<l;++s)if((r=o[s]).type===e.type&&r.name===e.name){this.removeEventListener(r.type,r.listener,r.options),this.addEventListener(r.type,r.listener=i,r.options=n),r.value=t;return}}this.addEventListener(e.type,i,n),r={type:e.type,name:e.name,value:t,listener:i,options:n},o?o.push(r):this.__on=[r]}}function wa(e,t,n){var o=ma(e+""),r,i=o.length,s;if(arguments.length<2){var l=this.node().__on;if(l){for(var d=0,c=l.length,u;d<c;++d)for(r=0,u=l[d];r<i;++r)if((s=o[r]).type===u.type&&s.name===u.name)return u.value}return}for(l=t?va:ya,r=0;r<i;++r)this.each(l(o[r],t,n));return this}function Nr(e,t,n){var o=_r(e),r=o.CustomEvent;typeof r=="function"?r=new r(t,n):(r=o.document.createEvent("Event"),n?(r.initEvent(t,n.bubbles,n.cancelable),r.detail=n.detail):r.initEvent(t,!1,!1)),e.dispatchEvent(r)}function pa(e,t){return function(){return Nr(this,e,t)}}function xa(e,t){return function(){return Nr(this,e,t.apply(this,arguments))}}function ba(e,t){return this.each((typeof t=="function"?xa:pa)(e,t))}function*_a(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var o=e[t],r=0,i=o.length,s;r<i;++r)(s=o[r])&&(yield s)}var Pr=[null];function ke(e,t){this._groups=e,this._parents=t}function Zt(){return new ke([[document.documentElement]],Pr)}function ka(){return this}ke.prototype=Zt.prototype={constructor:ke,select:Ui,selectAll:$i,selectChild:os,selectChildren:as,filter:ls,data:gs,enter:cs,exit:ys,join:vs,merge:ws,selection:ka,order:ps,sort:xs,call:_s,nodes:ks,node:Ss,size:Es,empty:Cs,each:Ns,attr:Ts,style:Vs,property:Zs,classed:Ws,text:Qs,html:ea,raise:na,lower:ra,append:ia,insert:aa,remove:ca,clone:fa,datum:ha,on:wa,dispatch:ba,[Symbol.iterator]:_a};function Ee(e){return typeof e=="string"?new ke([[document.querySelector(e)]],[document.documentElement]):new ke([[e]],Pr)}function Sa(e){let t;for(;t=e.sourceEvent;)e=t;return e}function Pe(e,t){if(e=Sa(e),t===void 0&&(t=e.currentTarget),t){var n=t.ownerSVGElement||t;if(n.createSVGPoint){var o=n.createSVGPoint();return o.x=e.clientX,o.y=e.clientY,o=o.matrixTransform(t.getScreenCTM().inverse()),[o.x,o.y]}if(t.getBoundingClientRect){var r=t.getBoundingClientRect();return[e.clientX-r.left-t.clientLeft,e.clientY-r.top-t.clientTop]}}return[e.pageX,e.pageY]}const Ea={passive:!1},At={capture:!0,passive:!1};function Tn(e){e.stopImmediatePropagation()}function ft(e){e.preventDefault(),e.stopImmediatePropagation()}function Mr(e){var t=e.document.documentElement,n=Ee(e).on("dragstart.drag",ft,At);"onselectstart"in t?n.on("selectstart.drag",ft,At):(t.__noselect=t.style.MozUserSelect,t.style.MozUserSelect="none")}function zr(e,t){var n=e.document.documentElement,o=Ee(e).on("dragstart.drag",null);t&&(o.on("click.drag",ft,At),setTimeout(function(){o.on("click.drag",null)},0)),"onselectstart"in n?o.on("selectstart.drag",null):(n.style.MozUserSelect=n.__noselect,delete n.__noselect)}const Gt=e=>()=>e;function qn(e,{sourceEvent:t,subject:n,target:o,identifier:r,active:i,x:s,y:l,dx:d,dy:c,dispatch:u}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},subject:{value:n,enumerable:!0,configurable:!0},target:{value:o,enumerable:!0,configurable:!0},identifier:{value:r,enumerable:!0,configurable:!0},active:{value:i,enumerable:!0,configurable:!0},x:{value:s,enumerable:!0,configurable:!0},y:{value:l,enumerable:!0,configurable:!0},dx:{value:d,enumerable:!0,configurable:!0},dy:{value:c,enumerable:!0,configurable:!0},_:{value:u}})}qn.prototype.on=function(){var e=this._.on.apply(this._,arguments);return e===this._?this:e};function Ca(e){return!e.ctrlKey&&!e.button}function Na(){return this.parentNode}function Pa(e,t){return t??{x:e.x,y:e.y}}function Ma(){return navigator.maxTouchPoints||"ontouchstart"in this}function za(){var e=Ca,t=Na,n=Pa,o=Ma,r={},i=Sn("start","drag","end"),s=0,l,d,c,u,h=0;function f(_){_.on("mousedown.drag",y).filter(o).on("touchstart.drag",S).on("touchmove.drag",C,Ea).on("touchend.drag touchcancel.drag",P).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function y(_,V){if(!(u||!e.call(this,_,V))){var T=M(this,t.call(this,_,V),_,V,"mouse");T&&(Ee(_.view).on("mousemove.drag",w,At).on("mouseup.drag",p,At),Mr(_.view),Tn(_),c=!1,l=_.clientX,d=_.clientY,T("start",_))}}function w(_){if(ft(_),!c){var V=_.clientX-l,T=_.clientY-d;c=V*V+T*T>h}r.mouse("drag",_)}function p(_){Ee(_.view).on("mousemove.drag mouseup.drag",null),zr(_.view,c),ft(_),r.mouse("end",_)}function S(_,V){if(e.call(this,_,V)){var T=_.changedTouches,L=t.call(this,_,V),A=T.length,B,W;for(B=0;B<A;++B)(W=M(this,L,_,V,T[B].identifier,T[B]))&&(Tn(_),W("start",_,T[B]))}}function C(_){var V=_.changedTouches,T=V.length,L,A;for(L=0;L<T;++L)(A=r[V[L].identifier])&&(ft(_),A("drag",_,V[L]))}function P(_){var V=_.changedTouches,T=V.length,L,A;for(u&&clearTimeout(u),u=setTimeout(function(){u=null},500),L=0;L<T;++L)(A=r[V[L].identifier])&&(Tn(_),A("end",_,V[L]))}function M(_,V,T,L,A,B){var W=i.copy(),k=Pe(B||T,V),v,E,g;if((g=n.call(_,new qn("beforestart",{sourceEvent:T,target:f,identifier:A,active:s,x:k[0],y:k[1],dx:0,dy:0,dispatch:W}),L))!=null)return v=g.x-k[0]||0,E=g.y-k[1]||0,function b(x,N,D){var z=k,I;switch(x){case"start":r[A]=b,I=s++;break;case"end":delete r[A],--s;case"drag":k=Pe(D||N,V),I=s;break}W.call(x,_,new qn(x,{sourceEvent:N,subject:g,target:f,identifier:A,active:I,x:k[0]+v,y:k[1]+E,dx:k[0]-z[0],dy:k[1]-z[1],dispatch:W}),L)}}return f.filter=function(_){return arguments.length?(e=typeof _=="function"?_:Gt(!!_),f):e},f.container=function(_){return arguments.length?(t=typeof _=="function"?_:Gt(_),f):t},f.subject=function(_){return arguments.length?(n=typeof _=="function"?_:Gt(_),f):n},f.touchable=function(_){return arguments.length?(o=typeof _=="function"?_:Gt(!!_),f):o},f.on=function(){var _=i.on.apply(i,arguments);return _===i?f:_},f.clickDistance=function(_){return arguments.length?(h=(_=+_)*_,f):Math.sqrt(h)},f}function fo(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function Ar(e,t){var n=Object.create(e.prototype);for(var o in t)n[o]=t[o];return n}function Ft(){}var Dt=.7,un=1/Dt,ht="\\s*([+-]?\\d+)\\s*",It="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Oe="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Aa=/^#([0-9a-f]{3,8})$/,Da=new RegExp(`^rgb\\(${ht},${ht},${ht}\\)$`),Ia=new RegExp(`^rgb\\(${Oe},${Oe},${Oe}\\)$`),Ta=new RegExp(`^rgba\\(${ht},${ht},${ht},${It}\\)$`),Oa=new RegExp(`^rgba\\(${Oe},${Oe},${Oe},${It}\\)$`),Ha=new RegExp(`^hsl\\(${It},${Oe},${Oe}\\)$`),Ra=new RegExp(`^hsla\\(${It},${Oe},${Oe},${It}\\)$`),zo={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};fo(Ft,it,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:Ao,formatHex:Ao,formatHex8:Va,formatHsl:La,formatRgb:Do,toString:Do});function Ao(){return this.rgb().formatHex()}function Va(){return this.rgb().formatHex8()}function La(){return Dr(this).formatHsl()}function Do(){return this.rgb().formatRgb()}function it(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=Aa.exec(e))?(n=t[1].length,t=parseInt(t[1],16),n===6?Io(t):n===3?new _e(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):n===8?Ut(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):n===4?Ut(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=Da.exec(e))?new _e(t[1],t[2],t[3],1):(t=Ia.exec(e))?new _e(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=Ta.exec(e))?Ut(t[1],t[2],t[3],t[4]):(t=Oa.exec(e))?Ut(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=Ha.exec(e))?Ho(t[1],t[2]/100,t[3]/100,1):(t=Ra.exec(e))?Ho(t[1],t[2]/100,t[3]/100,t[4]):zo.hasOwnProperty(e)?Io(zo[e]):e==="transparent"?new _e(NaN,NaN,NaN,0):null}function Io(e){return new _e(e>>16&255,e>>8&255,e&255,1)}function Ut(e,t,n,o){return o<=0&&(e=t=n=NaN),new _e(e,t,n,o)}function Ba(e){return e instanceof Ft||(e=it(e)),e?(e=e.rgb(),new _e(e.r,e.g,e.b,e.opacity)):new _e}function Gn(e,t,n,o){return arguments.length===1?Ba(e):new _e(e,t,n,o??1)}function _e(e,t,n,o){this.r=+e,this.g=+t,this.b=+n,this.opacity=+o}fo(_e,Gn,Ar(Ft,{brighter(e){return e=e==null?un:Math.pow(un,e),new _e(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?Dt:Math.pow(Dt,e),new _e(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new _e(ot(this.r),ot(this.g),ot(this.b),dn(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:To,formatHex:To,formatHex8:Ka,formatRgb:Oo,toString:Oo}));function To(){return`#${tt(this.r)}${tt(this.g)}${tt(this.b)}`}function Ka(){return`#${tt(this.r)}${tt(this.g)}${tt(this.b)}${tt((isNaN(this.opacity)?1:this.opacity)*255)}`}function Oo(){const e=dn(this.opacity);return`${e===1?"rgb(":"rgba("}${ot(this.r)}, ${ot(this.g)}, ${ot(this.b)}${e===1?")":`, ${e})`}`}function dn(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function ot(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function tt(e){return e=ot(e),(e<16?"0":"")+e.toString(16)}function Ho(e,t,n,o){return o<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new Me(e,t,n,o)}function Dr(e){if(e instanceof Me)return new Me(e.h,e.s,e.l,e.opacity);if(e instanceof Ft||(e=it(e)),!e)return new Me;if(e instanceof Me)return e;e=e.rgb();var t=e.r/255,n=e.g/255,o=e.b/255,r=Math.min(t,n,o),i=Math.max(t,n,o),s=NaN,l=i-r,d=(i+r)/2;return l?(t===i?s=(n-o)/l+(n<o)*6:n===i?s=(o-t)/l+2:s=(t-n)/l+4,l/=d<.5?i+r:2-i-r,s*=60):l=d>0&&d<1?0:s,new Me(s,l,d,e.opacity)}function Za(e,t,n,o){return arguments.length===1?Dr(e):new Me(e,t,n,o??1)}function Me(e,t,n,o){this.h=+e,this.s=+t,this.l=+n,this.opacity=+o}fo(Me,Za,Ar(Ft,{brighter(e){return e=e==null?un:Math.pow(un,e),new Me(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?Dt:Math.pow(Dt,e),new Me(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,o=n+(n<.5?n:1-n)*t,r=2*n-o;return new _e(On(e>=240?e-240:e+120,r,o),On(e,r,o),On(e<120?e+240:e-120,r,o),this.opacity)},clamp(){return new Me(Ro(this.h),Qt(this.s),Qt(this.l),dn(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=dn(this.opacity);return`${e===1?"hsl(":"hsla("}${Ro(this.h)}, ${Qt(this.s)*100}%, ${Qt(this.l)*100}%${e===1?")":`, ${e})`}`}}));function Ro(e){return e=(e||0)%360,e<0?e+360:e}function Qt(e){return Math.max(0,Math.min(1,e||0))}function On(e,t,n){return(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)*255}const ho=e=>()=>e;function Fa(e,t){return function(n){return e+n*t}}function Ya(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(o){return Math.pow(e+o*t,n)}}function Xa(e){return(e=+e)==1?Ir:function(t,n){return n-t?Ya(t,n,e):ho(isNaN(t)?n:t)}}function Ir(e,t){var n=t-e;return n?Fa(e,n):ho(isNaN(e)?t:e)}const fn=(function e(t){var n=Xa(t);function o(r,i){var s=n((r=Gn(r)).r,(i=Gn(i)).r),l=n(r.g,i.g),d=n(r.b,i.b),c=Ir(r.opacity,i.opacity);return function(u){return r.r=s(u),r.g=l(u),r.b=d(u),r.opacity=c(u),r+""}}return o.gamma=e,o})(1);function Wa(e,t){t||(t=[]);var n=e?Math.min(t.length,e.length):0,o=t.slice(),r;return function(i){for(r=0;r<n;++r)o[r]=e[r]*(1-i)+t[r]*i;return o}}function qa(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function Ga(e,t){var n=t?t.length:0,o=e?Math.min(n,e.length):0,r=new Array(o),i=new Array(n),s;for(s=0;s<o;++s)r[s]=Mt(e[s],t[s]);for(;s<n;++s)i[s]=t[s];return function(l){for(s=0;s<o;++s)i[s]=r[s](l);return i}}function Ua(e,t){var n=new Date;return e=+e,t=+t,function(o){return n.setTime(e*(1-o)+t*o),n}}function Te(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}function Qa(e,t){var n={},o={},r;(e===null||typeof e!="object")&&(e={}),(t===null||typeof t!="object")&&(t={});for(r in t)r in e?n[r]=Mt(e[r],t[r]):o[r]=t[r];return function(i){for(r in n)o[r]=n[r](i);return o}}var Un=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Hn=new RegExp(Un.source,"g");function Ja(e){return function(){return e}}function ja(e){return function(t){return e(t)+""}}function Tr(e,t){var n=Un.lastIndex=Hn.lastIndex=0,o,r,i,s=-1,l=[],d=[];for(e=e+"",t=t+"";(o=Un.exec(e))&&(r=Hn.exec(t));)(i=r.index)>n&&(i=t.slice(n,i),l[s]?l[s]+=i:l[++s]=i),(o=o[0])===(r=r[0])?l[s]?l[s]+=r:l[++s]=r:(l[++s]=null,d.push({i:s,x:Te(o,r)})),n=Hn.lastIndex;return n<t.length&&(i=t.slice(n),l[s]?l[s]+=i:l[++s]=i),l.length<2?d[0]?ja(d[0].x):Ja(t):(t=d.length,function(c){for(var u=0,h;u<t;++u)l[(h=d[u]).i]=h.x(c);return l.join("")})}function Mt(e,t){var n=typeof t,o;return t==null||n==="boolean"?ho(t):(n==="number"?Te:n==="string"?(o=it(t))?(t=o,fn):Tr:t instanceof it?fn:t instanceof Date?Ua:qa(t)?Wa:Array.isArray(t)?Ga:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?Qa:Te)(e,t)}var Vo=180/Math.PI,Qn={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function Or(e,t,n,o,r,i){var s,l,d;return(s=Math.sqrt(e*e+t*t))&&(e/=s,t/=s),(d=e*n+t*o)&&(n-=e*d,o-=t*d),(l=Math.sqrt(n*n+o*o))&&(n/=l,o/=l,d/=l),e*o<t*n&&(e=-e,t=-t,d=-d,s=-s),{translateX:r,translateY:i,rotate:Math.atan2(t,e)*Vo,skewX:Math.atan(d)*Vo,scaleX:s,scaleY:l}}var Jt;function $a(e){const t=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?Qn:Or(t.a,t.b,t.c,t.d,t.e,t.f)}function el(e){return e==null||(Jt||(Jt=document.createElementNS("http://www.w3.org/2000/svg","g")),Jt.setAttribute("transform",e),!(e=Jt.transform.baseVal.consolidate()))?Qn:(e=e.matrix,Or(e.a,e.b,e.c,e.d,e.e,e.f))}function Hr(e,t,n,o){function r(c){return c.length?c.pop()+" ":""}function i(c,u,h,f,y,w){if(c!==h||u!==f){var p=y.push("translate(",null,t,null,n);w.push({i:p-4,x:Te(c,h)},{i:p-2,x:Te(u,f)})}else(h||f)&&y.push("translate("+h+t+f+n)}function s(c,u,h,f){c!==u?(c-u>180?u+=360:u-c>180&&(c+=360),f.push({i:h.push(r(h)+"rotate(",null,o)-2,x:Te(c,u)})):u&&h.push(r(h)+"rotate("+u+o)}function l(c,u,h,f){c!==u?f.push({i:h.push(r(h)+"skewX(",null,o)-2,x:Te(c,u)}):u&&h.push(r(h)+"skewX("+u+o)}function d(c,u,h,f,y,w){if(c!==h||u!==f){var p=y.push(r(y)+"scale(",null,",",null,")");w.push({i:p-4,x:Te(c,h)},{i:p-2,x:Te(u,f)})}else(h!==1||f!==1)&&y.push(r(y)+"scale("+h+","+f+")")}return function(c,u){var h=[],f=[];return c=e(c),u=e(u),i(c.translateX,c.translateY,u.translateX,u.translateY,h,f),s(c.rotate,u.rotate,h,f),l(c.skewX,u.skewX,h,f),d(c.scaleX,c.scaleY,u.scaleX,u.scaleY,h,f),c=u=null,function(y){for(var w=-1,p=f.length,S;++w<p;)h[(S=f[w]).i]=S.x(y);return h.join("")}}}var tl=Hr($a,"px, ","px)","deg)"),nl=Hr(el,", ",")",")"),ol=1e-12;function Lo(e){return((e=Math.exp(e))+1/e)/2}function rl(e){return((e=Math.exp(e))-1/e)/2}function il(e){return((e=Math.exp(2*e))-1)/(e+1)}const nn=(function e(t,n,o){function r(i,s){var l=i[0],d=i[1],c=i[2],u=s[0],h=s[1],f=s[2],y=u-l,w=h-d,p=y*y+w*w,S,C;if(p<ol)C=Math.log(f/c)/t,S=function(L){return[l+L*y,d+L*w,c*Math.exp(t*L*C)]};else{var P=Math.sqrt(p),M=(f*f-c*c+o*p)/(2*c*n*P),_=(f*f-c*c-o*p)/(2*f*n*P),V=Math.log(Math.sqrt(M*M+1)-M),T=Math.log(Math.sqrt(_*_+1)-_);C=(T-V)/t,S=function(L){var A=L*C,B=Lo(V),W=c/(n*P)*(B*il(t*A+V)-rl(V));return[l+W*y,d+W*w,c*B/Lo(t*A+V)]}}return S.duration=C*1e3*t/Math.SQRT2,S}return r.rho=function(i){var s=Math.max(.001,+i),l=s*s,d=l*l;return e(s,l,d)},r})(Math.SQRT2,2,4);var yt=0,Ct=0,St=0,Rr=1e3,hn,Nt,gn=0,st=0,Cn=0,Tt=typeof performance=="object"&&performance.now?performance:Date,Vr=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function go(){return st||(Vr(sl),st=Tt.now()+Cn)}function sl(){st=0}function mn(){this._call=this._time=this._next=null}mn.prototype=Lr.prototype={constructor:mn,restart:function(e,t,n){if(typeof e!="function")throw new TypeError("callback is not a function");n=(n==null?go():+n)+(t==null?0:+t),!this._next&&Nt!==this&&(Nt?Nt._next=this:hn=this,Nt=this),this._call=e,this._time=n,Jn()},stop:function(){this._call&&(this._call=null,this._time=1/0,Jn())}};function Lr(e,t,n){var o=new mn;return o.restart(e,t,n),o}function al(){go(),++yt;for(var e=hn,t;e;)(t=st-e._time)>=0&&e._call.call(void 0,t),e=e._next;--yt}function Bo(){st=(gn=Tt.now())+Cn,yt=Ct=0;try{al()}finally{yt=0,cl(),st=0}}function ll(){var e=Tt.now(),t=e-gn;t>Rr&&(Cn-=t,gn=e)}function cl(){for(var e,t=hn,n,o=1/0;t;)t._call?(o>t._time&&(o=t._time),e=t,t=t._next):(n=t._next,t._next=null,t=e?e._next=n:hn=n);Nt=e,Jn(o)}function Jn(e){if(!yt){Ct&&(Ct=clearTimeout(Ct));var t=e-st;t>24?(e<1/0&&(Ct=setTimeout(Bo,e-Tt.now()-Cn)),St&&(St=clearInterval(St))):(St||(gn=Tt.now(),St=setInterval(ll,Rr)),yt=1,Vr(Bo))}}function Ko(e,t,n){var o=new mn;return t=t==null?0:+t,o.restart(r=>{o.stop(),e(r+t)},t,n),o}var ul=Sn("start","end","cancel","interrupt"),dl=[],Br=0,Zo=1,jn=2,on=3,Fo=4,$n=5,rn=6;function Nn(e,t,n,o,r,i){var s=e.__transition;if(!s)e.__transition={};else if(n in s)return;fl(e,n,{name:t,index:o,group:r,on:ul,tween:dl,time:i.time,delay:i.delay,duration:i.duration,ease:i.ease,timer:null,state:Br})}function mo(e,t){var n=Ae(e,t);if(n.state>Br)throw new Error("too late; already scheduled");return n}function Re(e,t){var n=Ae(e,t);if(n.state>on)throw new Error("too late; already running");return n}function Ae(e,t){var n=e.__transition;if(!n||!(n=n[t]))throw new Error("transition not found");return n}function fl(e,t,n){var o=e.__transition,r;o[t]=n,n.timer=Lr(i,0,n.time);function i(c){n.state=Zo,n.timer.restart(s,n.delay,n.time),n.delay<=c&&s(c-n.delay)}function s(c){var u,h,f,y;if(n.state!==Zo)return d();for(u in o)if(y=o[u],y.name===n.name){if(y.state===on)return Ko(s);y.state===Fo?(y.state=rn,y.timer.stop(),y.on.call("interrupt",e,e.__data__,y.index,y.group),delete o[u]):+u<t&&(y.state=rn,y.timer.stop(),y.on.call("cancel",e,e.__data__,y.index,y.group),delete o[u])}if(Ko(function(){n.state===on&&(n.state=Fo,n.timer.restart(l,n.delay,n.time),l(c))}),n.state=jn,n.on.call("start",e,e.__data__,n.index,n.group),n.state===jn){for(n.state=on,r=new Array(f=n.tween.length),u=0,h=-1;u<f;++u)(y=n.tween[u].value.call(e,e.__data__,n.index,n.group))&&(r[++h]=y);r.length=h+1}}function l(c){for(var u=c<n.duration?n.ease.call(null,c/n.duration):(n.timer.restart(d),n.state=$n,1),h=-1,f=r.length;++h<f;)r[h].call(e,u);n.state===$n&&(n.on.call("end",e,e.__data__,n.index,n.group),d())}function d(){n.state=rn,n.timer.stop(),delete o[t];for(var c in o)return;delete e.__transition}}function sn(e,t){var n=e.__transition,o,r,i=!0,s;if(n){t=t==null?null:t+"";for(s in n){if((o=n[s]).name!==t){i=!1;continue}r=o.state>jn&&o.state<$n,o.state=rn,o.timer.stop(),o.on.call(r?"interrupt":"cancel",e,e.__data__,o.index,o.group),delete n[s]}i&&delete e.__transition}}function hl(e){return this.each(function(){sn(this,e)})}function gl(e,t){var n,o;return function(){var r=Re(this,e),i=r.tween;if(i!==n){o=n=i;for(var s=0,l=o.length;s<l;++s)if(o[s].name===t){o=o.slice(),o.splice(s,1);break}}r.tween=o}}function ml(e,t,n){var o,r;if(typeof n!="function")throw new Error;return function(){var i=Re(this,e),s=i.tween;if(s!==o){r=(o=s).slice();for(var l={name:t,value:n},d=0,c=r.length;d<c;++d)if(r[d].name===t){r[d]=l;break}d===c&&r.push(l)}i.tween=r}}function yl(e,t){var n=this._id;if(e+="",arguments.length<2){for(var o=Ae(this.node(),n).tween,r=0,i=o.length,s;r<i;++r)if((s=o[r]).name===e)return s.value;return null}return this.each((t==null?gl:ml)(n,e,t))}function yo(e,t,n){var o=e._id;return e.each(function(){var r=Re(this,o);(r.value||(r.value={}))[t]=n.apply(this,arguments)}),function(r){return Ae(r,o).value[t]}}function Kr(e,t){var n;return(typeof t=="number"?Te:t instanceof it?fn:(n=it(t))?(t=n,fn):Tr)(e,t)}function vl(e){return function(){this.removeAttribute(e)}}function wl(e){return function(){this.removeAttributeNS(e.space,e.local)}}function pl(e,t,n){var o,r=n+"",i;return function(){var s=this.getAttribute(e);return s===r?null:s===o?i:i=t(o=s,n)}}function xl(e,t,n){var o,r=n+"",i;return function(){var s=this.getAttributeNS(e.space,e.local);return s===r?null:s===o?i:i=t(o=s,n)}}function bl(e,t,n){var o,r,i;return function(){var s,l=n(this),d;return l==null?void this.removeAttribute(e):(s=this.getAttribute(e),d=l+"",s===d?null:s===o&&d===r?i:(r=d,i=t(o=s,l)))}}function _l(e,t,n){var o,r,i;return function(){var s,l=n(this),d;return l==null?void this.removeAttributeNS(e.space,e.local):(s=this.getAttributeNS(e.space,e.local),d=l+"",s===d?null:s===o&&d===r?i:(r=d,i=t(o=s,l)))}}function kl(e,t){var n=En(e),o=n==="transform"?nl:Kr;return this.attrTween(e,typeof t=="function"?(n.local?_l:bl)(n,o,yo(this,"attr."+e,t)):t==null?(n.local?wl:vl)(n):(n.local?xl:pl)(n,o,t))}function Sl(e,t){return function(n){this.setAttribute(e,t.call(this,n))}}function El(e,t){return function(n){this.setAttributeNS(e.space,e.local,t.call(this,n))}}function Cl(e,t){var n,o;function r(){var i=t.apply(this,arguments);return i!==o&&(n=(o=i)&&El(e,i)),n}return r._value=t,r}function Nl(e,t){var n,o;function r(){var i=t.apply(this,arguments);return i!==o&&(n=(o=i)&&Sl(e,i)),n}return r._value=t,r}function Pl(e,t){var n="attr."+e;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(t==null)return this.tween(n,null);if(typeof t!="function")throw new Error;var o=En(e);return this.tween(n,(o.local?Cl:Nl)(o,t))}function Ml(e,t){return function(){mo(this,e).delay=+t.apply(this,arguments)}}function zl(e,t){return t=+t,function(){mo(this,e).delay=t}}function Al(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?Ml:zl)(t,e)):Ae(this.node(),t).delay}function Dl(e,t){return function(){Re(this,e).duration=+t.apply(this,arguments)}}function Il(e,t){return t=+t,function(){Re(this,e).duration=t}}function Tl(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?Dl:Il)(t,e)):Ae(this.node(),t).duration}function Ol(e,t){if(typeof t!="function")throw new Error;return function(){Re(this,e).ease=t}}function Hl(e){var t=this._id;return arguments.length?this.each(Ol(t,e)):Ae(this.node(),t).ease}function Rl(e,t){return function(){var n=t.apply(this,arguments);if(typeof n!="function")throw new Error;Re(this,e).ease=n}}function Vl(e){if(typeof e!="function")throw new Error;return this.each(Rl(this._id,e))}function Ll(e){typeof e!="function"&&(e=pr(e));for(var t=this._groups,n=t.length,o=new Array(n),r=0;r<n;++r)for(var i=t[r],s=i.length,l=o[r]=[],d,c=0;c<s;++c)(d=i[c])&&e.call(d,d.__data__,c,i)&&l.push(d);return new Ke(o,this._parents,this._name,this._id)}function Bl(e){if(e._id!==this._id)throw new Error;for(var t=this._groups,n=e._groups,o=t.length,r=n.length,i=Math.min(o,r),s=new Array(o),l=0;l<i;++l)for(var d=t[l],c=n[l],u=d.length,h=s[l]=new Array(u),f,y=0;y<u;++y)(f=d[y]||c[y])&&(h[y]=f);for(;l<o;++l)s[l]=t[l];return new Ke(s,this._parents,this._name,this._id)}function Kl(e){return(e+"").trim().split(/^|\s+/).every(function(t){var n=t.indexOf(".");return n>=0&&(t=t.slice(0,n)),!t||t==="start"})}function Zl(e,t,n){var o,r,i=Kl(t)?mo:Re;return function(){var s=i(this,e),l=s.on;l!==o&&(r=(o=l).copy()).on(t,n),s.on=r}}function Fl(e,t){var n=this._id;return arguments.length<2?Ae(this.node(),n).on.on(e):this.each(Zl(n,e,t))}function Yl(e){return function(){var t=this.parentNode;for(var n in this.__transition)if(+n!==e)return;t&&t.removeChild(this)}}function Xl(){return this.on("end.remove",Yl(this._id))}function Wl(e){var t=this._name,n=this._id;typeof e!="function"&&(e=co(e));for(var o=this._groups,r=o.length,i=new Array(r),s=0;s<r;++s)for(var l=o[s],d=l.length,c=i[s]=new Array(d),u,h,f=0;f<d;++f)(u=l[f])&&(h=e.call(u,u.__data__,f,l))&&("__data__"in u&&(h.__data__=u.__data__),c[f]=h,Nn(c[f],t,n,f,c,Ae(u,n)));return new Ke(i,this._parents,t,n)}function ql(e){var t=this._name,n=this._id;typeof e!="function"&&(e=wr(e));for(var o=this._groups,r=o.length,i=[],s=[],l=0;l<r;++l)for(var d=o[l],c=d.length,u,h=0;h<c;++h)if(u=d[h]){for(var f=e.call(u,u.__data__,h,d),y,w=Ae(u,n),p=0,S=f.length;p<S;++p)(y=f[p])&&Nn(y,t,n,p,f,w);i.push(f),s.push(u)}return new Ke(i,s,t,n)}var Gl=Zt.prototype.constructor;function Ul(){return new Gl(this._groups,this._parents)}function Ql(e,t){var n,o,r;return function(){var i=mt(this,e),s=(this.style.removeProperty(e),mt(this,e));return i===s?null:i===n&&s===o?r:r=t(n=i,o=s)}}function Zr(e){return function(){this.style.removeProperty(e)}}function Jl(e,t,n){var o,r=n+"",i;return function(){var s=mt(this,e);return s===r?null:s===o?i:i=t(o=s,n)}}function jl(e,t,n){var o,r,i;return function(){var s=mt(this,e),l=n(this),d=l+"";return l==null&&(d=l=(this.style.removeProperty(e),mt(this,e))),s===d?null:s===o&&d===r?i:(r=d,i=t(o=s,l))}}function $l(e,t){var n,o,r,i="style."+t,s="end."+i,l;return function(){var d=Re(this,e),c=d.on,u=d.value[i]==null?l||(l=Zr(t)):void 0;(c!==n||r!==u)&&(o=(n=c).copy()).on(s,r=u),d.on=o}}function ec(e,t,n){var o=(e+="")=="transform"?tl:Kr;return t==null?this.styleTween(e,Ql(e,o)).on("end.style."+e,Zr(e)):typeof t=="function"?this.styleTween(e,jl(e,o,yo(this,"style."+e,t))).each($l(this._id,e)):this.styleTween(e,Jl(e,o,t),n).on("end.style."+e,null)}function tc(e,t,n){return function(o){this.style.setProperty(e,t.call(this,o),n)}}function nc(e,t,n){var o,r;function i(){var s=t.apply(this,arguments);return s!==r&&(o=(r=s)&&tc(e,s,n)),o}return i._value=t,i}function oc(e,t,n){var o="style."+(e+="");if(arguments.length<2)return(o=this.tween(o))&&o._value;if(t==null)return this.tween(o,null);if(typeof t!="function")throw new Error;return this.tween(o,nc(e,t,n??""))}function rc(e){return function(){this.textContent=e}}function ic(e){return function(){var t=e(this);this.textContent=t??""}}function sc(e){return this.tween("text",typeof e=="function"?ic(yo(this,"text",e)):rc(e==null?"":e+""))}function ac(e){return function(t){this.textContent=e.call(this,t)}}function lc(e){var t,n;function o(){var r=e.apply(this,arguments);return r!==n&&(t=(n=r)&&ac(r)),t}return o._value=e,o}function cc(e){var t="text";if(arguments.length<1)return(t=this.tween(t))&&t._value;if(e==null)return this.tween(t,null);if(typeof e!="function")throw new Error;return this.tween(t,lc(e))}function uc(){for(var e=this._name,t=this._id,n=Fr(),o=this._groups,r=o.length,i=0;i<r;++i)for(var s=o[i],l=s.length,d,c=0;c<l;++c)if(d=s[c]){var u=Ae(d,t);Nn(d,e,n,c,s,{time:u.time+u.delay+u.duration,delay:0,duration:u.duration,ease:u.ease})}return new Ke(o,this._parents,e,n)}function dc(){var e,t,n=this,o=n._id,r=n.size();return new Promise(function(i,s){var l={value:s},d={value:function(){--r===0&&i()}};n.each(function(){var c=Re(this,o),u=c.on;u!==e&&(t=(e=u).copy(),t._.cancel.push(l),t._.interrupt.push(l),t._.end.push(d)),c.on=t}),r===0&&i()})}var fc=0;function Ke(e,t,n,o){this._groups=e,this._parents=t,this._name=n,this._id=o}function Fr(){return++fc}var Ve=Zt.prototype;Ke.prototype={constructor:Ke,select:Wl,selectAll:ql,selectChild:Ve.selectChild,selectChildren:Ve.selectChildren,filter:Ll,merge:Bl,selection:Ul,transition:uc,call:Ve.call,nodes:Ve.nodes,node:Ve.node,size:Ve.size,empty:Ve.empty,each:Ve.each,on:Fl,attr:kl,attrTween:Pl,style:ec,styleTween:oc,text:sc,textTween:cc,remove:Xl,tween:yl,delay:Al,duration:Tl,ease:Hl,easeVarying:Vl,end:dc,[Symbol.iterator]:Ve[Symbol.iterator]};function hc(e){return((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2}var gc={time:null,delay:0,duration:250,ease:hc};function mc(e,t){for(var n;!(n=e.__transition)||!(n=n[t]);)if(!(e=e.parentNode))throw new Error(`transition ${t} not found`);return n}function yc(e){var t,n;e instanceof Ke?(t=e._id,e=e._name):(t=Fr(),(n=gc).time=go(),e=e==null?null:e+"");for(var o=this._groups,r=o.length,i=0;i<r;++i)for(var s=o[i],l=s.length,d,c=0;c<l;++c)(d=s[c])&&Nn(d,e,t,c,s,n||mc(d,t));return new Ke(o,this._parents,e,t)}Zt.prototype.interrupt=hl;Zt.prototype.transition=yc;const jt=e=>()=>e;function vc(e,{sourceEvent:t,target:n,transform:o,dispatch:r}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},target:{value:n,enumerable:!0,configurable:!0},transform:{value:o,enumerable:!0,configurable:!0},_:{value:r}})}function Le(e,t,n){this.k=e,this.x=t,this.y=n}Le.prototype={constructor:Le,scale:function(e){return e===1?this:new Le(this.k*e,this.x,this.y)},translate:function(e,t){return e===0&t===0?this:new Le(this.k,this.x+this.k*e,this.y+this.k*t)},apply:function(e){return[e[0]*this.k+this.x,e[1]*this.k+this.y]},applyX:function(e){return e*this.k+this.x},applyY:function(e){return e*this.k+this.y},invert:function(e){return[(e[0]-this.x)/this.k,(e[1]-this.y)/this.k]},invertX:function(e){return(e-this.x)/this.k},invertY:function(e){return(e-this.y)/this.k},rescaleX:function(e){return e.copy().domain(e.range().map(this.invertX,this).map(e.invert,e))},rescaleY:function(e){return e.copy().domain(e.range().map(this.invertY,this).map(e.invert,e))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var Pn=new Le(1,0,0);Yr.prototype=Le.prototype;function Yr(e){for(;!e.__zoom;)if(!(e=e.parentNode))return Pn;return e.__zoom}function Rn(e){e.stopImmediatePropagation()}function Et(e){e.preventDefault(),e.stopImmediatePropagation()}function wc(e){return(!e.ctrlKey||e.type==="wheel")&&!e.button}function pc(){var e=this;return e instanceof SVGElement?(e=e.ownerSVGElement||e,e.hasAttribute("viewBox")?(e=e.viewBox.baseVal,[[e.x,e.y],[e.x+e.width,e.y+e.height]]):[[0,0],[e.width.baseVal.value,e.height.baseVal.value]]):[[0,0],[e.clientWidth,e.clientHeight]]}function Yo(){return this.__zoom||Pn}function xc(e){return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*(e.ctrlKey?10:1)}function bc(){return navigator.maxTouchPoints||"ontouchstart"in this}function _c(e,t,n){var o=e.invertX(t[0][0])-n[0][0],r=e.invertX(t[1][0])-n[1][0],i=e.invertY(t[0][1])-n[0][1],s=e.invertY(t[1][1])-n[1][1];return e.translate(r>o?(o+r)/2:Math.min(0,o)||Math.max(0,r),s>i?(i+s)/2:Math.min(0,i)||Math.max(0,s))}function Xr(){var e=wc,t=pc,n=_c,o=xc,r=bc,i=[0,1/0],s=[[-1/0,-1/0],[1/0,1/0]],l=250,d=nn,c=Sn("start","zoom","end"),u,h,f,y=500,w=150,p=0,S=10;function C(g){g.property("__zoom",Yo).on("wheel.zoom",A,{passive:!1}).on("mousedown.zoom",B).on("dblclick.zoom",W).filter(r).on("touchstart.zoom",k).on("touchmove.zoom",v).on("touchend.zoom touchcancel.zoom",E).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}C.transform=function(g,b,x,N){var D=g.selection?g.selection():g;D.property("__zoom",Yo),g!==D?V(g,b,x,N):D.interrupt().each(function(){T(this,arguments).event(N).start().zoom(null,typeof b=="function"?b.apply(this,arguments):b).end()})},C.scaleBy=function(g,b,x,N){C.scaleTo(g,function(){var D=this.__zoom.k,z=typeof b=="function"?b.apply(this,arguments):b;return D*z},x,N)},C.scaleTo=function(g,b,x,N){C.transform(g,function(){var D=t.apply(this,arguments),z=this.__zoom,I=x==null?_(D):typeof x=="function"?x.apply(this,arguments):x,O=z.invert(I),X=typeof b=="function"?b.apply(this,arguments):b;return n(M(P(z,X),I,O),D,s)},x,N)},C.translateBy=function(g,b,x,N){C.transform(g,function(){return n(this.__zoom.translate(typeof b=="function"?b.apply(this,arguments):b,typeof x=="function"?x.apply(this,arguments):x),t.apply(this,arguments),s)},null,N)},C.translateTo=function(g,b,x,N,D){C.transform(g,function(){var z=t.apply(this,arguments),I=this.__zoom,O=N==null?_(z):typeof N=="function"?N.apply(this,arguments):N;return n(Pn.translate(O[0],O[1]).scale(I.k).translate(typeof b=="function"?-b.apply(this,arguments):-b,typeof x=="function"?-x.apply(this,arguments):-x),z,s)},N,D)};function P(g,b){return b=Math.max(i[0],Math.min(i[1],b)),b===g.k?g:new Le(b,g.x,g.y)}function M(g,b,x){var N=b[0]-x[0]*g.k,D=b[1]-x[1]*g.k;return N===g.x&&D===g.y?g:new Le(g.k,N,D)}function _(g){return[(+g[0][0]+ +g[1][0])/2,(+g[0][1]+ +g[1][1])/2]}function V(g,b,x,N){g.on("start.zoom",function(){T(this,arguments).event(N).start()}).on("interrupt.zoom end.zoom",function(){T(this,arguments).event(N).end()}).tween("zoom",function(){var D=this,z=arguments,I=T(D,z).event(N),O=t.apply(D,z),X=x==null?_(O):typeof x=="function"?x.apply(D,z):x,F=Math.max(O[1][0]-O[0][0],O[1][1]-O[0][1]),Z=D.__zoom,q=typeof b=="function"?b.apply(D,z):b,Y=d(Z.invert(X).concat(F/Z.k),q.invert(X).concat(F/q.k));return function(G){if(G===1)G=q;else{var Q=Y(G),ue=F/Q[2];G=new Le(ue,X[0]-Q[0]*ue,X[1]-Q[1]*ue)}I.zoom(null,G)}})}function T(g,b,x){return!x&&g.__zooming||new L(g,b)}function L(g,b){this.that=g,this.args=b,this.active=0,this.sourceEvent=null,this.extent=t.apply(g,b),this.taps=0}L.prototype={event:function(g){return g&&(this.sourceEvent=g),this},start:function(){return++this.active===1&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(g,b){return this.mouse&&g!=="mouse"&&(this.mouse[1]=b.invert(this.mouse[0])),this.touch0&&g!=="touch"&&(this.touch0[1]=b.invert(this.touch0[0])),this.touch1&&g!=="touch"&&(this.touch1[1]=b.invert(this.touch1[0])),this.that.__zoom=b,this.emit("zoom"),this},end:function(){return--this.active===0&&(delete this.that.__zooming,this.emit("end")),this},emit:function(g){var b=Ee(this.that).datum();c.call(g,this.that,new vc(g,{sourceEvent:this.sourceEvent,target:C,transform:this.that.__zoom,dispatch:c}),b)}};function A(g,...b){if(!e.apply(this,arguments))return;var x=T(this,b).event(g),N=this.__zoom,D=Math.max(i[0],Math.min(i[1],N.k*Math.pow(2,o.apply(this,arguments)))),z=Pe(g);if(x.wheel)(x.mouse[0][0]!==z[0]||x.mouse[0][1]!==z[1])&&(x.mouse[1]=N.invert(x.mouse[0]=z)),clearTimeout(x.wheel);else{if(N.k===D)return;x.mouse=[z,N.invert(z)],sn(this),x.start()}Et(g),x.wheel=setTimeout(I,w),x.zoom("mouse",n(M(P(N,D),x.mouse[0],x.mouse[1]),x.extent,s));function I(){x.wheel=null,x.end()}}function B(g,...b){if(f||!e.apply(this,arguments))return;var x=g.currentTarget,N=T(this,b,!0).event(g),D=Ee(g.view).on("mousemove.zoom",X,!0).on("mouseup.zoom",F,!0),z=Pe(g,x),I=g.clientX,O=g.clientY;Mr(g.view),Rn(g),N.mouse=[z,this.__zoom.invert(z)],sn(this),N.start();function X(Z){if(Et(Z),!N.moved){var q=Z.clientX-I,Y=Z.clientY-O;N.moved=q*q+Y*Y>p}N.event(Z).zoom("mouse",n(M(N.that.__zoom,N.mouse[0]=Pe(Z,x),N.mouse[1]),N.extent,s))}function F(Z){D.on("mousemove.zoom mouseup.zoom",null),zr(Z.view,N.moved),Et(Z),N.event(Z).end()}}function W(g,...b){if(e.apply(this,arguments)){var x=this.__zoom,N=Pe(g.changedTouches?g.changedTouches[0]:g,this),D=x.invert(N),z=x.k*(g.shiftKey?.5:2),I=n(M(P(x,z),N,D),t.apply(this,b),s);Et(g),l>0?Ee(this).transition().duration(l).call(V,I,N,g):Ee(this).call(C.transform,I,N,g)}}function k(g,...b){if(e.apply(this,arguments)){var x=g.touches,N=x.length,D=T(this,b,g.changedTouches.length===N).event(g),z,I,O,X;for(Rn(g),I=0;I<N;++I)O=x[I],X=Pe(O,this),X=[X,this.__zoom.invert(X),O.identifier],D.touch0?!D.touch1&&D.touch0[2]!==X[2]&&(D.touch1=X,D.taps=0):(D.touch0=X,z=!0,D.taps=1+!!u);u&&(u=clearTimeout(u)),z&&(D.taps<2&&(h=X[0],u=setTimeout(function(){u=null},y)),sn(this),D.start())}}function v(g,...b){if(this.__zooming){var x=T(this,b).event(g),N=g.changedTouches,D=N.length,z,I,O,X;for(Et(g),z=0;z<D;++z)I=N[z],O=Pe(I,this),x.touch0&&x.touch0[2]===I.identifier?x.touch0[0]=O:x.touch1&&x.touch1[2]===I.identifier&&(x.touch1[0]=O);if(I=x.that.__zoom,x.touch1){var F=x.touch0[0],Z=x.touch0[1],q=x.touch1[0],Y=x.touch1[1],G=(G=q[0]-F[0])*G+(G=q[1]-F[1])*G,Q=(Q=Y[0]-Z[0])*Q+(Q=Y[1]-Z[1])*Q;I=P(I,Math.sqrt(G/Q)),O=[(F[0]+q[0])/2,(F[1]+q[1])/2],X=[(Z[0]+Y[0])/2,(Z[1]+Y[1])/2]}else if(x.touch0)O=x.touch0[0],X=x.touch0[1];else return;x.zoom("touch",n(M(I,O,X),x.extent,s))}}function E(g,...b){if(this.__zooming){var x=T(this,b).event(g),N=g.changedTouches,D=N.length,z,I;for(Rn(g),f&&clearTimeout(f),f=setTimeout(function(){f=null},y),z=0;z<D;++z)I=N[z],x.touch0&&x.touch0[2]===I.identifier?delete x.touch0:x.touch1&&x.touch1[2]===I.identifier&&delete x.touch1;if(x.touch1&&!x.touch0&&(x.touch0=x.touch1,delete x.touch1),x.touch0)x.touch0[1]=this.__zoom.invert(x.touch0[0]);else if(x.end(),x.taps===2&&(I=Pe(I,this),Math.hypot(h[0]-I[0],h[1]-I[1])<S)){var O=Ee(this).on("dblclick.zoom");O&&O.apply(this,arguments)}}}return C.wheelDelta=function(g){return arguments.length?(o=typeof g=="function"?g:jt(+g),C):o},C.filter=function(g){return arguments.length?(e=typeof g=="function"?g:jt(!!g),C):e},C.touchable=function(g){return arguments.length?(r=typeof g=="function"?g:jt(!!g),C):r},C.extent=function(g){return arguments.length?(t=typeof g=="function"?g:jt([[+g[0][0],+g[0][1]],[+g[1][0],+g[1][1]]]),C):t},C.scaleExtent=function(g){return arguments.length?(i[0]=+g[0],i[1]=+g[1],C):[i[0],i[1]]},C.translateExtent=function(g){return arguments.length?(s[0][0]=+g[0][0],s[1][0]=+g[1][0],s[0][1]=+g[0][1],s[1][1]=+g[1][1],C):[[s[0][0],s[0][1]],[s[1][0],s[1][1]]]},C.constrain=function(g){return arguments.length?(n=g,C):n},C.duration=function(g){return arguments.length?(l=+g,C):l},C.interpolate=function(g){return arguments.length?(d=g,C):d},C.on=function(){var g=c.on.apply(c,arguments);return g===c?C:g},C.clickDistance=function(g){return arguments.length?(p=(g=+g)*g,C):Math.sqrt(p)},C.tapDistance=function(g){return arguments.length?(S=+g,C):S},C}const Ot={error001:()=>"[React Flow]: Seems like you have not used zustand provider as an ancestor. Help: https://reactflow.dev/error#001",error002:()=>"It looks like you've created a new nodeTypes or edgeTypes object. If this wasn't on purpose please define the nodeTypes/edgeTypes outside of the component or memoize them.",error003:e=>`Node type "${e}" not found. Using fallback type "default".`,error004:()=>"The React Flow parent container needs a width and a height to render the graph.",error005:()=>"Only child nodes can use a parent extent.",error006:()=>"Can't create edge. An edge needs a source and a target.",error007:e=>`The old edge with id=${e} does not exist.`,error009:e=>`Marker type "${e}" doesn't exist.`,error008:(e,{id:t,sourceHandle:n,targetHandle:o})=>`Couldn't create edge for ${e} handle id: "${e==="source"?n:o}", edge id: ${t}.`,error010:()=>"Handle: No node id found. Make sure to only use a Handle inside a custom Node.",error011:e=>`Edge type "${e}" not found. Using fallback type "default".`,error012:e=>`Node with id "${e}" does not exist, it may have been removed. This can happen when a node is deleted before the "onNodeClick" handler is called.`,error013:(e="react")=>`It seems that you haven't loaded the styles. Please import '@xyflow/${e}/dist/style.css' or base.css to make sure everything is working properly.`,error014:()=>"useNodeConnections: No node ID found. Call useNodeConnections inside a custom Node or provide a node ID.",error015:()=>"It seems that you are trying to drag a node that is not initialized. Please use onNodesChange as explained in the docs."},eo=[[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY],[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY]],Wr=["Enter"," ","Escape"],kc={"node.a11yDescription.default":"Press enter or space to select a node. Press delete to remove it and escape to cancel.","node.a11yDescription.keyboardDisabled":"Press enter or space to select a node. You can then use the arrow keys to move the node around. Press delete to remove it and escape to cancel.","node.a11yDescription.ariaLiveMessage":({direction:e,x:t,y:n})=>`Moved selected node ${e}. New position, x: ${t}, y: ${n}`,"edge.a11yDescription.default":"Press enter or space to select an edge. You can then press delete to remove it or escape to cancel.","controls.ariaLabel":"Control Panel","controls.zoomIn.ariaLabel":"Zoom In","controls.zoomOut.ariaLabel":"Zoom Out","controls.fitView.ariaLabel":"Fit View","controls.interactive.ariaLabel":"Toggle Interactivity","minimap.ariaLabel":"Mini Map","handle.ariaLabel":"Handle"};var vt;(function(e){e.Strict="strict",e.Loose="loose"})(vt||(vt={}));var gt;(function(e){e.Free="free",e.Vertical="vertical",e.Horizontal="horizontal"})(gt||(gt={}));var yn;(function(e){e.Partial="partial",e.Full="full"})(yn||(yn={}));const to={inProgress:!1,isValid:null,from:null,fromHandle:null,fromPosition:null,fromNode:null,to:null,toHandle:null,toPosition:null,toNode:null,pointer:null};var Xe;(function(e){e.Bezier="default",e.Straight="straight",e.Step="step",e.SmoothStep="smoothstep",e.SimpleBezier="simplebezier"})(Xe||(Xe={}));var vn;(function(e){e.Arrow="arrow",e.ArrowClosed="arrowclosed"})(vn||(vn={}));var $;(function(e){e.Left="left",e.Top="top",e.Right="right",e.Bottom="bottom"})($||($={}));const Xo={[$.Left]:$.Right,[$.Right]:$.Left,[$.Top]:$.Bottom,[$.Bottom]:$.Top};function Sc(e,t){if(!e&&!t)return!0;if(!e||!t||e.size!==t.size)return!1;if(!e.size&&!t.size)return!0;for(const n of e.keys())if(!t.has(n))return!1;return!0}function Wo(e,t,n){if(!n)return;const o=[];e.forEach((r,i)=>{t?.has(i)||o.push(r)}),o.length&&n(o)}function Ec(e){return e===null?null:e?"valid":"invalid"}const qr=e=>"id"in e&&"source"in e&&"target"in e,Cc=e=>"id"in e&&"position"in e&&!("source"in e)&&!("target"in e),vo=e=>"id"in e&&"internals"in e&&!("source"in e)&&!("target"in e),Yt=(e,t=[0,0])=>{const{width:n,height:o}=Qe(e),r=e.origin??t,i=n*r[0],s=o*r[1];return{x:e.position.x-i,y:e.position.y-s}},Nc=(e,t={nodeOrigin:[0,0]})=>{if(e.length===0)return{x:0,y:0,width:0,height:0};const n=e.reduce((o,r)=>{const i=typeof r=="string";let s=!t.nodeLookup&&!i?r:void 0;t.nodeLookup&&(s=i?t.nodeLookup.get(r):vo(r)?r:t.nodeLookup.get(r.id));const l=s?wn(s,t.nodeOrigin):{x:0,y:0,x2:0,y2:0};return Mn(o,l)},{x:1/0,y:1/0,x2:-1/0,y2:-1/0});return zn(n)},Xt=(e,t={})=>{let n={x:1/0,y:1/0,x2:-1/0,y2:-1/0},o=!1;return e.forEach(r=>{(t.filter===void 0||t.filter(r))&&(n=Mn(n,wn(r)),o=!0)}),o?zn(n):{x:0,y:0,width:0,height:0}},wo=(e,t,[n,o,r]=[0,0,1],i=!1,s=!1)=>{const l={...qt(t,[n,o,r]),width:t.width/r,height:t.height/r},d=[];for(const c of e.values()){const{measured:u,selectable:h=!0,hidden:f=!1}=c;if(s&&!h||f)continue;const y=u.width??c.width??c.initialWidth??null,w=u.height??c.height??c.initialHeight??null,p=Ht(l,pt(c)),S=(y??0)*(w??0),C=i&&p>0;(!c.internals.handleBounds||C||p>=S||c.dragging)&&d.push(c)}return d},Pc=(e,t)=>{const n=new Set;return e.forEach(o=>{n.add(o.id)}),t.filter(o=>n.has(o.source)||n.has(o.target))};function Mc(e,t){const n=new Map,o=t?.nodes?new Set(t.nodes.map(r=>r.id)):null;return e.forEach(r=>{r.measured.width&&r.measured.height&&(t?.includeHiddenNodes||!r.hidden)&&(!o||o.has(r.id))&&n.set(r.id,r)}),n}async function zc({nodes:e,width:t,height:n,panZoom:o,minZoom:r,maxZoom:i},s){if(e.size===0)return Promise.resolve(!0);const l=Mc(e,s),d=Xt(l),c=po(d,t,n,s?.minZoom??r,s?.maxZoom??i,s?.padding??.1);return await o.setViewport(c,{duration:s?.duration,ease:s?.ease,interpolate:s?.interpolate}),Promise.resolve(!0)}function Gr({nodeId:e,nextPosition:t,nodeLookup:n,nodeOrigin:o=[0,0],nodeExtent:r,onError:i}){const s=n.get(e),l=s.parentId?n.get(s.parentId):void 0,{x:d,y:c}=l?l.internals.positionAbsolute:{x:0,y:0},u=s.origin??o;let h=s.extent||r;if(s.extent==="parent"&&!s.expandParent)if(!l)i?.("005",Ot.error005());else{const y=l.measured.width,w=l.measured.height;y&&w&&(h=[[d,c],[d+y,c+w]])}else l&&xt(s.extent)&&(h=[[s.extent[0][0]+d,s.extent[0][1]+c],[s.extent[1][0]+d,s.extent[1][1]+c]]);const f=xt(h)?at(t,h,s.measured):t;return(s.measured.width===void 0||s.measured.height===void 0)&&i?.("015",Ot.error015()),{position:{x:f.x-d+(s.measured.width??0)*u[0],y:f.y-c+(s.measured.height??0)*u[1]},positionAbsolute:f}}async function Ac({nodesToRemove:e=[],edgesToRemove:t=[],nodes:n,edges:o,onBeforeDelete:r}){const i=new Set(e.map(f=>f.id)),s=[];for(const f of n){if(f.deletable===!1)continue;const y=i.has(f.id),w=!y&&f.parentId&&s.find(p=>p.id===f.parentId);(y||w)&&s.push(f)}const l=new Set(t.map(f=>f.id)),d=o.filter(f=>f.deletable!==!1),u=Pc(s,d);for(const f of d)l.has(f.id)&&!u.find(w=>w.id===f.id)&&u.push(f);if(!r)return{edges:u,nodes:s};const h=await r({nodes:s,edges:u});return typeof h=="boolean"?h?{edges:u,nodes:s}:{edges:[],nodes:[]}:h}const wt=(e,t=0,n=1)=>Math.min(Math.max(e,t),n),at=(e={x:0,y:0},t,n)=>({x:wt(e.x,t[0][0],t[1][0]-(n?.width??0)),y:wt(e.y,t[0][1],t[1][1]-(n?.height??0))});function Ur(e,t,n){const{width:o,height:r}=Qe(n),{x:i,y:s}=n.internals.positionAbsolute;return at(e,[[i,s],[i+o,s+r]],t)}const qo=(e,t,n)=>e<t?wt(Math.abs(e-t),1,t)/t:e>n?-wt(Math.abs(e-n),1,t)/t:0,Qr=(e,t,n=15,o=40)=>{const r=qo(e.x,o,t.width-o)*n,i=qo(e.y,o,t.height-o)*n;return[r,i]},Mn=(e,t)=>({x:Math.min(e.x,t.x),y:Math.min(e.y,t.y),x2:Math.max(e.x2,t.x2),y2:Math.max(e.y2,t.y2)}),no=({x:e,y:t,width:n,height:o})=>({x:e,y:t,x2:e+n,y2:t+o}),zn=({x:e,y:t,x2:n,y2:o})=>({x:e,y:t,width:n-e,height:o-t}),pt=(e,t=[0,0])=>{const{x:n,y:o}=vo(e)?e.internals.positionAbsolute:Yt(e,t);return{x:n,y:o,width:e.measured?.width??e.width??e.initialWidth??0,height:e.measured?.height??e.height??e.initialHeight??0}},wn=(e,t=[0,0])=>{const{x:n,y:o}=vo(e)?e.internals.positionAbsolute:Yt(e,t);return{x:n,y:o,x2:n+(e.measured?.width??e.width??e.initialWidth??0),y2:o+(e.measured?.height??e.height??e.initialHeight??0)}},Jr=(e,t)=>zn(Mn(no(e),no(t))),Ht=(e,t)=>{const n=Math.max(0,Math.min(e.x+e.width,t.x+t.width)-Math.max(e.x,t.x)),o=Math.max(0,Math.min(e.y+e.height,t.y+t.height)-Math.max(e.y,t.y));return Math.ceil(n*o)},Go=e=>Be(e.width)&&Be(e.height)&&Be(e.x)&&Be(e.y),Be=e=>!isNaN(e)&&isFinite(e),Dc=(e,t)=>{},Wt=(e,t=[1,1])=>({x:t[0]*Math.round(e.x/t[0]),y:t[1]*Math.round(e.y/t[1])}),qt=({x:e,y:t},[n,o,r],i=!1,s=[1,1])=>{const l={x:(e-n)/r,y:(t-o)/r};return i?Wt(l,s):l},pn=({x:e,y:t},[n,o,r])=>({x:e*r+n,y:t*r+o});function ut(e,t){if(typeof e=="number")return Math.floor((t-t/(1+e))*.5);if(typeof e=="string"&&e.endsWith("px")){const n=parseFloat(e);if(!Number.isNaN(n))return Math.floor(n)}if(typeof e=="string"&&e.endsWith("%")){const n=parseFloat(e);if(!Number.isNaN(n))return Math.floor(t*n*.01)}return console.error(`[React Flow] The padding value "${e}" is invalid. Please provide a number or a string with a valid unit (px or %).`),0}function Ic(e,t,n){if(typeof e=="string"||typeof e=="number"){const o=ut(e,n),r=ut(e,t);return{top:o,right:r,bottom:o,left:r,x:r*2,y:o*2}}if(typeof e=="object"){const o=ut(e.top??e.y??0,n),r=ut(e.bottom??e.y??0,n),i=ut(e.left??e.x??0,t),s=ut(e.right??e.x??0,t);return{top:o,right:s,bottom:r,left:i,x:i+s,y:o+r}}return{top:0,right:0,bottom:0,left:0,x:0,y:0}}function Tc(e,t,n,o,r,i){const{x:s,y:l}=pn(e,[t,n,o]),{x:d,y:c}=pn({x:e.x+e.width,y:e.y+e.height},[t,n,o]),u=r-d,h=i-c;return{left:Math.floor(s),top:Math.floor(l),right:Math.floor(u),bottom:Math.floor(h)}}const po=(e,t,n,o,r,i)=>{const s=Ic(i,t,n),l=(t-s.x)/e.width,d=(n-s.y)/e.height,c=Math.min(l,d),u=wt(c,o,r),h=e.x+e.width/2,f=e.y+e.height/2,y=t/2-h*u,w=n/2-f*u,p=Tc(e,y,w,u,t,n),S={left:Math.min(p.left-s.left,0),top:Math.min(p.top-s.top,0),right:Math.min(p.right-s.right,0),bottom:Math.min(p.bottom-s.bottom,0)};return{x:y-S.left+S.right,y:w-S.top+S.bottom,zoom:u}},Rt=()=>typeof navigator<"u"&&navigator?.userAgent?.indexOf("Mac")>=0;function xt(e){return e!=null&&e!=="parent"}function Qe(e){return{width:e.measured?.width??e.width??e.initialWidth??0,height:e.measured?.height??e.height??e.initialHeight??0}}function jr(e){return(e.measured?.width??e.width??e.initialWidth)!==void 0&&(e.measured?.height??e.height??e.initialHeight)!==void 0}function Oc(e,t={width:0,height:0},n,o,r){const i={...e},s=o.get(n);if(s){const l=s.origin||r;i.x+=s.internals.positionAbsolute.x-(t.width??0)*l[0],i.y+=s.internals.positionAbsolute.y-(t.height??0)*l[1]}return i}function Hc(e){return{...kc,...e||{}}}function Vn(e,{snapGrid:t=[0,0],snapToGrid:n=!1,transform:o,containerBounds:r}){const{x:i,y:s}=ze(e),l=qt({x:i-(r?.left??0),y:s-(r?.top??0)},o),{x:d,y:c}=n?Wt(l,t):l;return{xSnapped:d,ySnapped:c,...l}}const $r=e=>({width:e.offsetWidth,height:e.offsetHeight}),ei=e=>e?.getRootNode?.()||window?.document,Rc=["INPUT","SELECT","TEXTAREA"];function ti(e){const t=e.composedPath?.()?.[0]||e.target;return t?.nodeType!==1?!1:Rc.includes(t.nodeName)||t.hasAttribute("contenteditable")||!!t.closest(".nokey")}const ni=e=>"clientX"in e,ze=(e,t)=>{const n=ni(e),o=n?e.clientX:e.touches?.[0].clientX,r=n?e.clientY:e.touches?.[0].clientY;return{x:o-(t?.left??0),y:r-(t?.top??0)}},Uo=(e,t,n,o,r)=>{const i=t.querySelectorAll(`.${e}`);return!i||!i.length?null:Array.from(i).map(s=>{const l=s.getBoundingClientRect();return{id:s.getAttribute("data-handleid"),type:e,nodeId:r,position:s.getAttribute("data-handlepos"),x:(l.left-n.left)/o,y:(l.top-n.top)/o,...$r(s)}})};function Vc({sourceX:e,sourceY:t,targetX:n,targetY:o,sourceControlX:r,sourceControlY:i,targetControlX:s,targetControlY:l}){const d=e*.125+r*.375+s*.375+n*.125,c=t*.125+i*.375+l*.375+o*.125,u=Math.abs(d-e),h=Math.abs(c-t);return[d,c,u,h]}function $t(e,t){return e>=0?.5*e:t*25*Math.sqrt(-e)}function Qo({pos:e,x1:t,y1:n,x2:o,y2:r,c:i}){switch(e){case $.Left:return[t-$t(t-o,i),n];case $.Right:return[t+$t(o-t,i),n];case $.Top:return[t,n-$t(n-r,i)];case $.Bottom:return[t,n+$t(r-n,i)]}}function oi({sourceX:e,sourceY:t,sourcePosition:n=$.Bottom,targetX:o,targetY:r,targetPosition:i=$.Top,curvature:s=.25}){const[l,d]=Qo({pos:n,x1:e,y1:t,x2:o,y2:r,c:s}),[c,u]=Qo({pos:i,x1:o,y1:r,x2:e,y2:t,c:s}),[h,f,y,w]=Vc({sourceX:e,sourceY:t,targetX:o,targetY:r,sourceControlX:l,sourceControlY:d,targetControlX:c,targetControlY:u});return[`M${e},${t} C${l},${d} ${c},${u} ${o},${r}`,h,f,y,w]}function ri({sourceX:e,sourceY:t,targetX:n,targetY:o}){const r=Math.abs(n-e)/2,i=n<e?n+r:n-r,s=Math.abs(o-t)/2,l=o<t?o+s:o-s;return[i,l,r,s]}function Lc({sourceNode:e,targetNode:t,selected:n=!1,zIndex:o,elevateOnSelect:r=!1}){if(o!==void 0)return o;const i=r&&n?1e3:0,s=Math.max(e.parentId||r&&e.selected?e.internals.z:0,t.parentId||r&&t.selected?t.internals.z:0);return i+s}function Bc({sourceNode:e,targetNode:t,width:n,height:o,transform:r}){const i=Mn(wn(e),wn(t));i.x===i.x2&&(i.x2+=1),i.y===i.y2&&(i.y2+=1);const s={x:-r[0]/r[2],y:-r[1]/r[2],width:n/r[2],height:o/r[2]};return Ht(s,zn(i))>0}const Kc=({source:e,sourceHandle:t,target:n,targetHandle:o})=>`xy-edge__${e}${t||""}-${n}${o||""}`,Zc=(e,t)=>t.some(n=>n.source===e.source&&n.target===e.target&&(n.sourceHandle===e.sourceHandle||!n.sourceHandle&&!e.sourceHandle)&&(n.targetHandle===e.targetHandle||!n.targetHandle&&!e.targetHandle)),Fc=(e,t)=>{if(!e.source||!e.target)return t;let n;return qr(e)?n={...e}:n={...e,id:Kc(e)},Zc(n,t)?t:(n.sourceHandle===null&&delete n.sourceHandle,n.targetHandle===null&&delete n.targetHandle,t.concat(n))};function ii({sourceX:e,sourceY:t,targetX:n,targetY:o}){const[r,i,s,l]=ri({sourceX:e,sourceY:t,targetX:n,targetY:o});return[`M ${e},${t}L ${n},${o}`,r,i,s,l]}const Jo={[$.Left]:{x:-1,y:0},[$.Right]:{x:1,y:0},[$.Top]:{x:0,y:-1},[$.Bottom]:{x:0,y:1}},Yc=({source:e,sourcePosition:t=$.Bottom,target:n})=>t===$.Left||t===$.Right?e.x<n.x?{x:1,y:0}:{x:-1,y:0}:e.y<n.y?{x:0,y:1}:{x:0,y:-1},jo=(e,t)=>Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2));function Xc({source:e,sourcePosition:t=$.Bottom,target:n,targetPosition:o=$.Top,center:r,offset:i,stepPosition:s}){const l=Jo[t],d=Jo[o],c={x:e.x+l.x*i,y:e.y+l.y*i},u={x:n.x+d.x*i,y:n.y+d.y*i},h=Yc({source:c,sourcePosition:t,target:u}),f=h.x!==0?"x":"y",y=h[f];let w=[],p,S;const C={x:0,y:0},P={x:0,y:0},[,,M,_]=ri({sourceX:e.x,sourceY:e.y,targetX:n.x,targetY:n.y});if(l[f]*d[f]===-1){f==="x"?(p=r.x??c.x+(u.x-c.x)*s,S=r.y??(c.y+u.y)/2):(p=r.x??(c.x+u.x)/2,S=r.y??c.y+(u.y-c.y)*s);const T=[{x:p,y:c.y},{x:p,y:u.y}],L=[{x:c.x,y:S},{x:u.x,y:S}];l[f]===y?w=f==="x"?T:L:w=f==="x"?L:T}else{const T=[{x:c.x,y:u.y}],L=[{x:u.x,y:c.y}];if(f==="x"?w=l.x===y?L:T:w=l.y===y?T:L,t===o){const v=Math.abs(e[f]-n[f]);if(v<=i){const E=Math.min(i-1,i-v);l[f]===y?C[f]=(c[f]>e[f]?-1:1)*E:P[f]=(u[f]>n[f]?-1:1)*E}}if(t!==o){const v=f==="x"?"y":"x",E=l[f]===d[v],g=c[v]>u[v],b=c[v]<u[v];(l[f]===1&&(!E&&g||E&&b)||l[f]!==1&&(!E&&b||E&&g))&&(w=f==="x"?T:L)}const A={x:c.x+C.x,y:c.y+C.y},B={x:u.x+P.x,y:u.y+P.y},W=Math.max(Math.abs(A.x-w[0].x),Math.abs(B.x-w[0].x)),k=Math.max(Math.abs(A.y-w[0].y),Math.abs(B.y-w[0].y));W>=k?(p=(A.x+B.x)/2,S=w[0].y):(p=w[0].x,S=(A.y+B.y)/2)}return[[e,{x:c.x+C.x,y:c.y+C.y},...w,{x:u.x+P.x,y:u.y+P.y},n],p,S,M,_]}function Wc(e,t,n,o){const r=Math.min(jo(e,t)/2,jo(t,n)/2,o),{x:i,y:s}=t;if(e.x===i&&i===n.x||e.y===s&&s===n.y)return`L${i} ${s}`;if(e.y===s){const c=e.x<n.x?-1:1,u=e.y<n.y?1:-1;return`L ${i+r*c},${s}Q ${i},${s} ${i},${s+r*u}`}const l=e.x<n.x?1:-1,d=e.y<n.y?-1:1;return`L ${i},${s+r*d}Q ${i},${s} ${i+r*l},${s}`}function xo({sourceX:e,sourceY:t,sourcePosition:n=$.Bottom,targetX:o,targetY:r,targetPosition:i=$.Top,borderRadius:s=5,centerX:l,centerY:d,offset:c=20,stepPosition:u=.5}){const[h,f,y,w,p]=Xc({source:{x:e,y:t},sourcePosition:n,target:{x:o,y:r},targetPosition:i,center:{x:l,y:d},offset:c,stepPosition:u});return[h.reduce((C,P,M)=>{let _="";return M>0&&M<h.length-1?_=Wc(h[M-1],P,h[M+1],s):_=`${M===0?"M":"L"}${P.x} ${P.y}`,C+=_,C},""),f,y,w,p]}function $o(e){return e&&!!(e.internals.handleBounds||e.handles?.length)&&!!(e.measured.width||e.width||e.initialWidth)}function qc(e){const{sourceNode:t,targetNode:n}=e;if(!$o(t)||!$o(n))return null;const o=t.internals.handleBounds||er(t.handles),r=n.internals.handleBounds||er(n.handles),i=tr(o?.source??[],e.sourceHandle),s=tr(e.connectionMode===vt.Strict?r?.target??[]:(r?.target??[]).concat(r?.source??[]),e.targetHandle);if(!i||!s)return e.onError?.("008",Ot.error008(i?"target":"source",{id:e.id,sourceHandle:e.sourceHandle,targetHandle:e.targetHandle})),null;const l=i?.position||$.Bottom,d=s?.position||$.Top,c=Vt(t,i,l),u=Vt(n,s,d);return{sourceX:c.x,sourceY:c.y,targetX:u.x,targetY:u.y,sourcePosition:l,targetPosition:d}}function er(e){if(!e)return null;const t=[],n=[];for(const o of e)o.width=o.width??1,o.height=o.height??1,o.type==="source"?t.push(o):o.type==="target"&&n.push(o);return{source:t,target:n}}function Vt(e,t,n=$.Left,o=!1){const r=(t?.x??0)+e.internals.positionAbsolute.x,i=(t?.y??0)+e.internals.positionAbsolute.y,{width:s,height:l}=t??Qe(e);if(o)return{x:r+s/2,y:i+l/2};switch(t?.position??n){case $.Top:return{x:r+s/2,y:i};case $.Right:return{x:r+s,y:i+l/2};case $.Bottom:return{x:r+s/2,y:i+l};case $.Left:return{x:r,y:i+l/2}}}function tr(e,t){return e&&(t?e.find(n=>n.id===t):e[0])||null}function oo(e,t){return e?typeof e=="string"?e:`${t?`${t}__`:""}${Object.keys(e).sort().map(o=>`${o}=${e[o]}`).join("&")}`:""}function Gc(e,{id:t,defaultColor:n,defaultMarkerStart:o,defaultMarkerEnd:r}){const i=new Set;return e.reduce((s,l)=>([l.markerStart||o,l.markerEnd||r].forEach(d=>{if(d&&typeof d=="object"){const c=oo(d,t);i.has(c)||(s.push({id:c,color:d.color||n,...d}),i.add(c))}}),s),[]).sort((s,l)=>s.id.localeCompare(l.id))}const si=1e3,Uc=10,bo={nodeOrigin:[0,0],nodeExtent:eo,elevateNodesOnSelect:!0,defaults:{}},Qc={...bo,checkEquality:!0};function _o(e,t){const n={...e};for(const o in t)t[o]!==void 0&&(n[o]=t[o]);return n}function Jc(e,t,n){const o=_o(bo,n);for(const r of e.values())if(r.parentId)ko(r,e,t,o);else{const i=Yt(r,o.nodeOrigin),s=xt(r.extent)?r.extent:o.nodeExtent,l=at(i,s,Qe(r));r.internals.positionAbsolute=l}}function jc(e,t){if(!e.handles)return e.measured?t?.internals.handleBounds:void 0;const n=[],o=[];for(const r of e.handles){const i={id:r.id,width:r.width??1,height:r.height??1,nodeId:e.id,x:r.x,y:r.y,position:r.position,type:r.type};r.type==="source"?n.push(i):r.type==="target"&&o.push(i)}return{source:n,target:o}}function $c(e,t,n,o){const r=_o(Qc,o);let i={i:-1},s=e.length>0;const l=new Map(t),d=r?.elevateNodesOnSelect?si:0;t.clear(),n.clear();for(const c of e){let u=l.get(c.id);if(r.checkEquality&&c===u?.internals.userNode)t.set(c.id,u);else{const h=Yt(c,r.nodeOrigin),f=xt(c.extent)?c.extent:r.nodeExtent,y=at(h,f,Qe(c));u={...r.defaults,...c,measured:{width:c.measured?.width,height:c.measured?.height},internals:{positionAbsolute:y,handleBounds:jc(c,u),z:ai(c,d),userNode:c}},t.set(c.id,u)}(u.measured===void 0||u.measured.width===void 0||u.measured.height===void 0)&&!u.hidden&&(s=!1),c.parentId&&ko(u,t,n,o,i)}return s}function eu(e,t){if(!e.parentId)return;const n=t.get(e.parentId);n?n.set(e.id,e):t.set(e.parentId,new Map([[e.id,e]]))}function ko(e,t,n,o,r){const{elevateNodesOnSelect:i,nodeOrigin:s,nodeExtent:l}=_o(bo,o),d=e.parentId,c=t.get(d);if(!c){console.warn(`Parent node ${d} not found. Please make sure that parent nodes are in front of their child nodes in the nodes array.`);return}eu(e,n),r&&!c.parentId&&c.internals.rootParentIndex===void 0&&(c.internals.rootParentIndex=++r.i,c.internals.z=c.internals.z+r.i*Uc),r&&c.internals.rootParentIndex!==void 0&&(r.i=c.internals.rootParentIndex);const u=i?si:0,{x:h,y:f,z:y}=tu(e,c,s,l,u),{positionAbsolute:w}=e.internals,p=h!==w.x||f!==w.y;(p||y!==e.internals.z)&&t.set(e.id,{...e,internals:{...e.internals,positionAbsolute:p?{x:h,y:f}:w,z:y}})}function ai(e,t){return(Be(e.zIndex)?e.zIndex:0)+(e.selected?t:0)}function tu(e,t,n,o,r){const{x:i,y:s}=t.internals.positionAbsolute,l=Qe(e),d=Yt(e,n),c=xt(e.extent)?at(d,e.extent,l):d;let u=at({x:i+c.x,y:s+c.y},o,l);e.extent==="parent"&&(u=Ur(u,l,t));const h=ai(e,r),f=t.internals.z??0;return{x:u.x,y:u.y,z:f>=h?f+1:h}}function nu(e,t,n,o=[0,0]){const r=[],i=new Map;for(const s of e){const l=t.get(s.parentId);if(!l)continue;const d=i.get(s.parentId)?.expandedRect??pt(l),c=Jr(d,s.rect);i.set(s.parentId,{expandedRect:c,parent:l})}return i.size>0&&i.forEach(({expandedRect:s,parent:l},d)=>{const c=l.internals.positionAbsolute,u=Qe(l),h=l.origin??o,f=s.x<c.x?Math.round(Math.abs(c.x-s.x)):0,y=s.y<c.y?Math.round(Math.abs(c.y-s.y)):0,w=Math.max(u.width,Math.round(s.width)),p=Math.max(u.height,Math.round(s.height)),S=(w-u.width)*h[0],C=(p-u.height)*h[1];(f>0||y>0||S||C)&&(r.push({id:d,type:"position",position:{x:l.position.x-f+S,y:l.position.y-y+C}}),n.get(d)?.forEach(P=>{e.some(M=>M.id===P.id)||r.push({id:P.id,type:"position",position:{x:P.position.x+f,y:P.position.y+y}})})),(u.width<s.width||u.height<s.height||f||y)&&r.push({id:d,type:"dimensions",setAttributes:!0,dimensions:{width:w+(f?h[0]*f-S:0),height:p+(y?h[1]*y-C:0)}})}),r}function ou(e,t,n,o,r,i){const s=o?.querySelector(".xyflow__viewport");let l=!1;if(!s)return{changes:[],updatedInternals:l};const d=[],c=window.getComputedStyle(s),{m22:u}=new window.DOMMatrixReadOnly(c.transform),h=[];for(const f of e.values()){const y=t.get(f.id);if(!y)continue;if(y.hidden){t.set(y.id,{...y,internals:{...y.internals,handleBounds:void 0}}),l=!0;continue}const w=$r(f.nodeElement),p=y.measured.width!==w.width||y.measured.height!==w.height;if(!!(w.width&&w.height&&(p||!y.internals.handleBounds||f.force))){const C=f.nodeElement.getBoundingClientRect(),P=xt(y.extent)?y.extent:i;let{positionAbsolute:M}=y.internals;y.parentId&&y.extent==="parent"?M=Ur(M,w,t.get(y.parentId)):P&&(M=at(M,P,w));const _={...y,measured:w,internals:{...y.internals,positionAbsolute:M,handleBounds:{source:Uo("source",f.nodeElement,C,u,y.id),target:Uo("target",f.nodeElement,C,u,y.id)}}};t.set(y.id,_),y.parentId&&ko(_,t,n,{nodeOrigin:r}),l=!0,p&&(d.push({id:y.id,type:"dimensions",dimensions:w}),y.expandParent&&y.parentId&&h.push({id:y.id,parentId:y.parentId,rect:pt(_,r)}))}}if(h.length>0){const f=nu(h,t,n,r);d.push(...f)}return{changes:d,updatedInternals:l}}async function ru({delta:e,panZoom:t,transform:n,translateExtent:o,width:r,height:i}){if(!t||!e.x&&!e.y)return Promise.resolve(!1);const s=await t.setViewportConstrained({x:n[0]+e.x,y:n[1]+e.y,zoom:n[2]},[[0,0],[r,i]],o),l=!!s&&(s.x!==n[0]||s.y!==n[1]||s.k!==n[2]);return Promise.resolve(l)}function nr(e,t,n,o,r,i){let s=r;const l=o.get(s)||new Map;o.set(s,l.set(n,t)),s=`${r}-${e}`;const d=o.get(s)||new Map;if(o.set(s,d.set(n,t)),i){s=`${r}-${e}-${i}`;const c=o.get(s)||new Map;o.set(s,c.set(n,t))}}function iu(e,t,n){e.clear(),t.clear();for(const o of n){const{source:r,target:i,sourceHandle:s=null,targetHandle:l=null}=o,d={edgeId:o.id,source:r,target:i,sourceHandle:s,targetHandle:l},c=`${r}-${s}--${i}-${l}`,u=`${i}-${l}--${r}-${s}`;nr("source",d,u,e,r,s),nr("target",d,c,e,i,l),t.set(o.id,o)}}function li(e,t){if(!e.parentId)return!1;const n=t.get(e.parentId);return n?n.selected?!0:li(n,t):!1}function or(e,t,n){let o=e;do{if(o?.matches?.(t))return!0;if(o===n)return!1;o=o?.parentElement}while(o);return!1}function su(e,t,n,o){const r=new Map;for(const[i,s]of e)if((s.selected||s.id===o)&&(!s.parentId||!li(s,e))&&(s.draggable||t&&typeof s.draggable>"u")){const l=e.get(i);l&&r.set(i,{id:i,position:l.position||{x:0,y:0},distance:{x:n.x-l.internals.positionAbsolute.x,y:n.y-l.internals.positionAbsolute.y},extent:l.extent,parentId:l.parentId,origin:l.origin,expandParent:l.expandParent,internals:{positionAbsolute:l.internals.positionAbsolute||{x:0,y:0}},measured:{width:l.measured.width??0,height:l.measured.height??0}})}return r}function Ln({nodeId:e,dragItems:t,nodeLookup:n,dragging:o=!0}){const r=[];for(const[s,l]of t){const d=n.get(s)?.internals.userNode;d&&r.push({...d,position:l.position,dragging:o})}if(!e)return[r[0],r];const i=n.get(e)?.internals.userNode;return[i?{...i,position:t.get(e)?.position||i.position,dragging:o}:r[0],r]}function au({dragItems:e,snapGrid:t,x:n,y:o}){const r=e.values().next().value;if(!r)return null;const i={x:n-r.distance.x,y:o-r.distance.y},s=Wt(i,t);return{x:s.x-i.x,y:s.y-i.y}}function lu({onNodeMouseDown:e,getStoreItems:t,onDragStart:n,onDrag:o,onDragStop:r}){let i={x:null,y:null},s=0,l=new Map,d=!1,c={x:0,y:0},u=null,h=!1,f=null,y=!1,w=!1,p=null;function S({noDragClassName:P,handleSelector:M,domNode:_,isSelectable:V,nodeId:T,nodeClickDistance:L=0}){f=Ee(_);function A({x:v,y:E}){const{nodeLookup:g,nodeExtent:b,snapGrid:x,snapToGrid:N,nodeOrigin:D,onNodeDrag:z,onSelectionDrag:I,onError:O,updateNodePositions:X}=t();i={x:v,y:E};let F=!1;const Z=l.size>1,q=Z&&b?no(Xt(l)):null,Y=Z&&N?au({dragItems:l,snapGrid:x,x:v,y:E}):null;for(const[G,Q]of l){if(!g.has(G))continue;let ue={x:v-Q.distance.x,y:E-Q.distance.y};N&&(ue=Y?{x:Math.round(ue.x+Y.x),y:Math.round(ue.y+Y.y)}:Wt(ue,x));let ve=null;if(Z&&b&&!Q.extent&&q){const{positionAbsolute:te}=Q.internals,be=te.x-q.x+b[0][0],Ze=te.x+Q.measured.width-q.x2+b[1][0],je=te.y-q.y+b[0][1],De=te.y+Q.measured.height-q.y2+b[1][1];ve=[[be,je],[Ze,De]]}const{position:ee,positionAbsolute:de}=Gr({nodeId:G,nextPosition:ue,nodeLookup:g,nodeExtent:ve||b,nodeOrigin:D,onError:O});F=F||Q.position.x!==ee.x||Q.position.y!==ee.y,Q.position=ee,Q.internals.positionAbsolute=de}if(w=w||F,!!F&&(X(l,!0),p&&(o||z||!T&&I))){const[G,Q]=Ln({nodeId:T,dragItems:l,nodeLookup:g});o?.(p,l,G,Q),z?.(p,G,Q),T||I?.(p,Q)}}async function B(){if(!u)return;const{transform:v,panBy:E,autoPanSpeed:g,autoPanOnNodeDrag:b}=t();if(!b){d=!1,cancelAnimationFrame(s);return}const[x,N]=Qr(c,u,g);(x!==0||N!==0)&&(i.x=(i.x??0)-x/v[2],i.y=(i.y??0)-N/v[2],await E({x,y:N})&&A(i)),s=requestAnimationFrame(B)}function W(v){const{nodeLookup:E,multiSelectionActive:g,nodesDraggable:b,transform:x,snapGrid:N,snapToGrid:D,selectNodesOnDrag:z,onNodeDragStart:I,onSelectionDragStart:O,unselectNodesAndEdges:X}=t();h=!0,(!z||!V)&&!g&&T&&(E.get(T)?.selected||X()),V&&z&&T&&e?.(T);const F=Vn(v.sourceEvent,{transform:x,snapGrid:N,snapToGrid:D,containerBounds:u});if(i=F,l=su(E,b,F,T),l.size>0&&(n||I||!T&&O)){const[Z,q]=Ln({nodeId:T,dragItems:l,nodeLookup:E});n?.(v.sourceEvent,l,Z,q),I?.(v.sourceEvent,Z,q),T||O?.(v.sourceEvent,q)}}const k=za().clickDistance(L).on("start",v=>{const{domNode:E,nodeDragThreshold:g,transform:b,snapGrid:x,snapToGrid:N}=t();u=E?.getBoundingClientRect()||null,y=!1,w=!1,p=v.sourceEvent,g===0&&W(v),i=Vn(v.sourceEvent,{transform:b,snapGrid:x,snapToGrid:N,containerBounds:u}),c=ze(v.sourceEvent,u)}).on("drag",v=>{const{autoPanOnNodeDrag:E,transform:g,snapGrid:b,snapToGrid:x,nodeDragThreshold:N,nodeLookup:D}=t(),z=Vn(v.sourceEvent,{transform:g,snapGrid:b,snapToGrid:x,containerBounds:u});if(p=v.sourceEvent,(v.sourceEvent.type==="touchmove"&&v.sourceEvent.touches.length>1||T&&!D.has(T))&&(y=!0),!y){if(!d&&E&&h&&(d=!0,B()),!h){const I=ze(v.sourceEvent,u),O=I.x-c.x,X=I.y-c.y;Math.sqrt(O*O+X*X)>N&&W(v)}(i.x!==z.xSnapped||i.y!==z.ySnapped)&&l&&h&&(c=ze(v.sourceEvent,u),A(z))}}).on("end",v=>{if(!(!h||y)&&(d=!1,h=!1,cancelAnimationFrame(s),l.size>0)){const{nodeLookup:E,updateNodePositions:g,onNodeDragStop:b,onSelectionDragStop:x}=t();if(w&&(g(l,!1),w=!1),r||b||!T&&x){const[N,D]=Ln({nodeId:T,dragItems:l,nodeLookup:E,dragging:!1});r?.(v.sourceEvent,l,N,D),b?.(v.sourceEvent,N,D),T||x?.(v.sourceEvent,D)}}}).filter(v=>{const E=v.target;return!v.button&&(!P||!or(E,`.${P}`,_))&&(!M||or(E,M,_))});f.call(k)}function C(){f?.on(".drag",null)}return{update:S,destroy:C}}function cu(e,t,n){const o=[],r={x:e.x-n,y:e.y-n,width:n*2,height:n*2};for(const i of t.values())Ht(r,pt(i))>0&&o.push(i);return o}const uu=250;function du(e,t,n,o){let r=[],i=1/0;const s=cu(e,n,t+uu);for(const l of s){const d=[...l.internals.handleBounds?.source??[],...l.internals.handleBounds?.target??[]];for(const c of d){if(o.nodeId===c.nodeId&&o.type===c.type&&o.id===c.id)continue;const{x:u,y:h}=Vt(l,c,c.position,!0),f=Math.sqrt(Math.pow(u-e.x,2)+Math.pow(h-e.y,2));f>t||(f<i?(r=[{...c,x:u,y:h}],i=f):f===i&&r.push({...c,x:u,y:h}))}}if(!r.length)return null;if(r.length>1){const l=o.type==="source"?"target":"source";return r.find(d=>d.type===l)??r[0]}return r[0]}function ci(e,t,n,o,r,i=!1){const s=o.get(e);if(!s)return null;const l=r==="strict"?s.internals.handleBounds?.[t]:[...s.internals.handleBounds?.source??[],...s.internals.handleBounds?.target??[]],d=(n?l?.find(c=>c.id===n):l?.[0])??null;return d&&i?{...d,...Vt(s,d,d.position,!0)}:d}function ui(e,t){return e||(t?.classList.contains("target")?"target":t?.classList.contains("source")?"source":null)}function fu(e,t){let n=null;return t?n=!0:e&&!t&&(n=!1),n}const di=()=>!0;function hu(e,{connectionMode:t,connectionRadius:n,handleId:o,nodeId:r,edgeUpdaterType:i,isTarget:s,domNode:l,nodeLookup:d,lib:c,autoPanOnConnect:u,flowId:h,panBy:f,cancelConnection:y,onConnectStart:w,onConnect:p,onConnectEnd:S,isValidConnection:C=di,onReconnectEnd:P,updateConnection:M,getTransform:_,getFromHandle:V,autoPanSpeed:T,dragThreshold:L=1,handleDomNode:A}){const B=ei(e.target);let W=0,k;const{x:v,y:E}=ze(e),g=ui(i,A),b=l?.getBoundingClientRect();let x=!1;if(!b||!g)return;const N=ci(r,g,o,d,t);if(!N)return;let D=ze(e,b),z=!1,I=null,O=!1,X=null;function F(){if(!u||!b)return;const[ee,de]=Qr(D,b,T);f({x:ee,y:de}),W=requestAnimationFrame(F)}const Z={...N,nodeId:r,type:g,position:N.position},q=d.get(r);let G={inProgress:!0,isValid:null,from:Vt(q,Z,$.Left,!0),fromHandle:Z,fromPosition:Z.position,fromNode:q,to:D,toHandle:null,toPosition:Xo[Z.position],toNode:null,pointer:D};function Q(){x=!0,M(G),w?.(e,{nodeId:r,handleId:o,handleType:g})}L===0&&Q();function ue(ee){if(!x){const{x:Ze,y:je}=ze(ee),De=Ze-v,ce=je-E;if(!(De*De+ce*ce>L*L))return;Q()}if(!V()||!Z){ve(ee);return}const de=_();D=ze(ee,b),k=du(qt(D,de,!1,[1,1]),n,d,Z),z||(F(),z=!0);const te=fi(ee,{handle:k,connectionMode:t,fromNodeId:r,fromHandleId:o,fromType:s?"target":"source",isValidConnection:C,doc:B,lib:c,flowId:h,nodeLookup:d});X=te.handleDomNode,I=te.connection,O=fu(!!k,te.isValid);const be={...G,isValid:O,to:te.toHandle&&O?pn({x:te.toHandle.x,y:te.toHandle.y},de):D,toHandle:te.toHandle,toPosition:O&&te.toHandle?te.toHandle.position:Xo[Z.position],toNode:te.toHandle?d.get(te.toHandle.nodeId):null,pointer:D};M(be),G=be}function ve(ee){if(!("touches"in ee&&ee.touches.length>0)){if(x){(k||X)&&I&&O&&p?.(I);const{inProgress:de,...te}=G,be={...te,toPosition:G.toHandle?G.toPosition:null};S?.(ee,be),i&&P?.(ee,be)}y(),cancelAnimationFrame(W),z=!1,O=!1,I=null,X=null,B.removeEventListener("mousemove",ue),B.removeEventListener("mouseup",ve),B.removeEventListener("touchmove",ue),B.removeEventListener("touchend",ve)}}B.addEventListener("mousemove",ue),B.addEventListener("mouseup",ve),B.addEventListener("touchmove",ue),B.addEventListener("touchend",ve)}function fi(e,{handle:t,connectionMode:n,fromNodeId:o,fromHandleId:r,fromType:i,doc:s,lib:l,flowId:d,isValidConnection:c=di,nodeLookup:u}){const h=i==="target",f=t?s.querySelector(`.${l}-flow__handle[data-id="${d}-${t?.nodeId}-${t?.id}-${t?.type}"]`):null,{x:y,y:w}=ze(e),p=s.elementFromPoint(y,w),S=p?.classList.contains(`${l}-flow__handle`)?p:f,C={handleDomNode:S,isValid:!1,connection:null,toHandle:null};if(S){const P=ui(void 0,S),M=S.getAttribute("data-nodeid"),_=S.getAttribute("data-handleid"),V=S.classList.contains("connectable"),T=S.classList.contains("connectableend");if(!M||!P)return C;const L={source:h?M:o,sourceHandle:h?_:r,target:h?o:M,targetHandle:h?r:_};C.connection=L;const B=V&&T&&(n===vt.Strict?h&&P==="source"||!h&&P==="target":M!==o||_!==r);C.isValid=B&&c(L),C.toHandle=ci(M,P,_,u,n,!0)}return C}const rr={onPointerDown:hu,isValid:fi};function gu({domNode:e,panZoom:t,getTransform:n,getViewScale:o}){const r=Ee(e);function i({translateExtent:l,width:d,height:c,zoomStep:u=1,pannable:h=!0,zoomable:f=!0,inversePan:y=!1}){const w=M=>{if(M.sourceEvent.type!=="wheel"||!t)return;const _=n(),V=M.sourceEvent.ctrlKey&&Rt()?10:1,T=-M.sourceEvent.deltaY*(M.sourceEvent.deltaMode===1?.05:M.sourceEvent.deltaMode?1:.002)*u,L=_[2]*Math.pow(2,T*V);t.scaleTo(L)};let p=[0,0];const S=M=>{(M.sourceEvent.type==="mousedown"||M.sourceEvent.type==="touchstart")&&(p=[M.sourceEvent.clientX??M.sourceEvent.touches[0].clientX,M.sourceEvent.clientY??M.sourceEvent.touches[0].clientY])},C=M=>{const _=n();if(M.sourceEvent.type!=="mousemove"&&M.sourceEvent.type!=="touchmove"||!t)return;const V=[M.sourceEvent.clientX??M.sourceEvent.touches[0].clientX,M.sourceEvent.clientY??M.sourceEvent.touches[0].clientY],T=[V[0]-p[0],V[1]-p[1]];p=V;const L=o()*Math.max(_[2],Math.log(_[2]))*(y?-1:1),A={x:_[0]-T[0]*L,y:_[1]-T[1]*L},B=[[0,0],[d,c]];t.setViewportConstrained({x:A.x,y:A.y,zoom:_[2]},B,l)},P=Xr().on("start",S).on("zoom",h?C:null).on("zoom.wheel",f?w:null);r.call(P,{})}function s(){r.on("zoom",null)}return{update:i,destroy:s,pointer:Pe}}const An=e=>({x:e.x,y:e.y,zoom:e.k}),Bn=({x:e,y:t,zoom:n})=>Pn.translate(e,t).scale(n),dt=(e,t)=>e.target.closest(`.${t}`),hi=(e,t)=>t===2&&Array.isArray(e)&&e.includes(2),mu=e=>((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2,Kn=(e,t=0,n=mu,o=()=>{})=>{const r=typeof t=="number"&&t>0;return r||o(),r?e.transition().duration(t).ease(n).on("end",o):e},gi=e=>{const t=e.ctrlKey&&Rt()?10:1;return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*t};function yu({zoomPanValues:e,noWheelClassName:t,d3Selection:n,d3Zoom:o,panOnScrollMode:r,panOnScrollSpeed:i,zoomOnPinch:s,onPanZoomStart:l,onPanZoom:d,onPanZoomEnd:c}){return u=>{if(dt(u,t))return u.ctrlKey&&u.preventDefault(),!1;u.preventDefault(),u.stopImmediatePropagation();const h=n.property("__zoom").k||1;if(u.ctrlKey&&s){const S=Pe(u),C=gi(u),P=h*Math.pow(2,C);o.scaleTo(n,P,S,u);return}const f=u.deltaMode===1?20:1;let y=r===gt.Vertical?0:u.deltaX*f,w=r===gt.Horizontal?0:u.deltaY*f;!Rt()&&u.shiftKey&&r!==gt.Vertical&&(y=u.deltaY*f,w=0),o.translateBy(n,-(y/h)*i,-(w/h)*i,{internal:!0});const p=An(n.property("__zoom"));clearTimeout(e.panScrollTimeout),e.isPanScrolling?(d?.(u,p),e.panScrollTimeout=setTimeout(()=>{c?.(u,p),e.isPanScrolling=!1},150)):(e.isPanScrolling=!0,l?.(u,p))}}function vu({noWheelClassName:e,preventScrolling:t,d3ZoomHandler:n}){return function(o,r){const i=o.type==="wheel",s=!t&&i&&!o.ctrlKey,l=dt(o,e);if(o.ctrlKey&&i&&l&&o.preventDefault(),s||l)return null;o.preventDefault(),n.call(this,o,r)}}function wu({zoomPanValues:e,onDraggingChange:t,onPanZoomStart:n}){return o=>{if(o.sourceEvent?.internal)return;const r=An(o.transform);e.mouseButton=o.sourceEvent?.button||0,e.isZoomingOrPanning=!0,e.prevViewport=r,o.sourceEvent?.type==="mousedown"&&t(!0),n&&n?.(o.sourceEvent,r)}}function pu({zoomPanValues:e,panOnDrag:t,onPaneContextMenu:n,onTransformChange:o,onPanZoom:r}){return i=>{e.usedRightMouseButton=!!(n&&hi(t,e.mouseButton??0)),i.sourceEvent?.sync||o([i.transform.x,i.transform.y,i.transform.k]),r&&!i.sourceEvent?.internal&&r?.(i.sourceEvent,An(i.transform))}}function xu({zoomPanValues:e,panOnDrag:t,panOnScroll:n,onDraggingChange:o,onPanZoomEnd:r,onPaneContextMenu:i}){return s=>{if(!s.sourceEvent?.internal&&(e.isZoomingOrPanning=!1,i&&hi(t,e.mouseButton??0)&&!e.usedRightMouseButton&&s.sourceEvent&&i(s.sourceEvent),e.usedRightMouseButton=!1,o(!1),r)){const l=An(s.transform);e.prevViewport=l,clearTimeout(e.timerId),e.timerId=setTimeout(()=>{r?.(s.sourceEvent,l)},n?150:0)}}}function bu({zoomActivationKeyPressed:e,zoomOnScroll:t,zoomOnPinch:n,panOnDrag:o,panOnScroll:r,zoomOnDoubleClick:i,userSelectionActive:s,noWheelClassName:l,noPanClassName:d,lib:c,connectionInProgress:u}){return h=>{const f=e||t,y=n&&h.ctrlKey,w=h.type==="wheel";if(h.button===1&&h.type==="mousedown"&&(dt(h,`${c}-flow__node`)||dt(h,`${c}-flow__edge`)))return!0;if(!o&&!f&&!r&&!i&&!n||s||u&&!w||dt(h,l)&&w||dt(h,d)&&(!w||r&&w&&!e)||!n&&h.ctrlKey&&w)return!1;if(!n&&h.type==="touchstart"&&h.touches?.length>1)return h.preventDefault(),!1;if(!f&&!r&&!y&&w||!o&&(h.type==="mousedown"||h.type==="touchstart")||Array.isArray(o)&&!o.includes(h.button)&&h.type==="mousedown")return!1;const p=Array.isArray(o)&&o.includes(h.button)||!h.button||h.button<=1;return(!h.ctrlKey||w)&&p}}function _u({domNode:e,minZoom:t,maxZoom:n,translateExtent:o,viewport:r,onPanZoom:i,onPanZoomStart:s,onPanZoomEnd:l,onDraggingChange:d}){const c={isZoomingOrPanning:!1,usedRightMouseButton:!1,prevViewport:{},mouseButton:0,timerId:void 0,panScrollTimeout:void 0,isPanScrolling:!1},u=e.getBoundingClientRect(),h=Xr().scaleExtent([t,n]).translateExtent(o),f=Ee(e).call(h);P({x:r.x,y:r.y,zoom:wt(r.zoom,t,n)},[[0,0],[u.width,u.height]],o);const y=f.on("wheel.zoom"),w=f.on("dblclick.zoom");h.wheelDelta(gi);function p(k,v){return f?new Promise(E=>{h?.interpolate(v?.interpolate==="linear"?Mt:nn).transform(Kn(f,v?.duration,v?.ease,()=>E(!0)),k)}):Promise.resolve(!1)}function S({noWheelClassName:k,noPanClassName:v,onPaneContextMenu:E,userSelectionActive:g,panOnScroll:b,panOnDrag:x,panOnScrollMode:N,panOnScrollSpeed:D,preventScrolling:z,zoomOnPinch:I,zoomOnScroll:O,zoomOnDoubleClick:X,zoomActivationKeyPressed:F,lib:Z,onTransformChange:q,connectionInProgress:Y,paneClickDistance:G,selectionOnDrag:Q}){g&&!c.isZoomingOrPanning&&C();const ue=b&&!F&&!g;h.clickDistance(Q?1/0:!Be(G)||G<0?0:G);const ve=ue?yu({zoomPanValues:c,noWheelClassName:k,d3Selection:f,d3Zoom:h,panOnScrollMode:N,panOnScrollSpeed:D,zoomOnPinch:I,onPanZoomStart:s,onPanZoom:i,onPanZoomEnd:l}):vu({noWheelClassName:k,preventScrolling:z,d3ZoomHandler:y});if(f.on("wheel.zoom",ve,{passive:!1}),!g){const de=wu({zoomPanValues:c,onDraggingChange:d,onPanZoomStart:s});h.on("start",de);const te=pu({zoomPanValues:c,panOnDrag:x,onPaneContextMenu:!!E,onPanZoom:i,onTransformChange:q});h.on("zoom",te);const be=xu({zoomPanValues:c,panOnDrag:x,panOnScroll:b,onPaneContextMenu:E,onPanZoomEnd:l,onDraggingChange:d});h.on("end",be)}const ee=bu({zoomActivationKeyPressed:F,panOnDrag:x,zoomOnScroll:O,panOnScroll:b,zoomOnDoubleClick:X,zoomOnPinch:I,userSelectionActive:g,noPanClassName:v,noWheelClassName:k,lib:Z,connectionInProgress:Y});h.filter(ee),X?f.on("dblclick.zoom",w):f.on("dblclick.zoom",null)}function C(){h.on("zoom",null)}async function P(k,v,E){const g=Bn(k),b=h?.constrain()(g,v,E);return b&&await p(b),new Promise(x=>x(b))}async function M(k,v){const E=Bn(k);return await p(E,v),new Promise(g=>g(E))}function _(k){if(f){const v=Bn(k),E=f.property("__zoom");(E.k!==k.zoom||E.x!==k.x||E.y!==k.y)&&h?.transform(f,v,null,{sync:!0})}}function V(){const k=f?Yr(f.node()):{x:0,y:0,k:1};return{x:k.x,y:k.y,zoom:k.k}}function T(k,v){return f?new Promise(E=>{h?.interpolate(v?.interpolate==="linear"?Mt:nn).scaleTo(Kn(f,v?.duration,v?.ease,()=>E(!0)),k)}):Promise.resolve(!1)}function L(k,v){return f?new Promise(E=>{h?.interpolate(v?.interpolate==="linear"?Mt:nn).scaleBy(Kn(f,v?.duration,v?.ease,()=>E(!0)),k)}):Promise.resolve(!1)}function A(k){h?.scaleExtent(k)}function B(k){h?.translateExtent(k)}function W(k){const v=!Be(k)||k<0?0:k;h?.clickDistance(v)}return{update:S,destroy:C,setViewport:M,setViewportConstrained:P,getViewport:V,scaleTo:T,scaleBy:L,setScaleExtent:A,setTranslateExtent:B,syncViewport:_,setClickDistance:W}}var ir;(function(e){e.Line="line",e.Handle="handle"})(ir||(ir={}));var ku=ie("<div><!></div>");function xn(e,t){oe(t,!0);let n=R(t,"id",3,null),o=R(t,"type",3,"source"),r=R(t,"position",19,()=>$.Top),i=R(t,"isConnectableStart",3,!0),s=R(t,"isConnectableEnd",3,!0),l=qe(t,["$$slots","$$events","$$legacy","id","type","position","style","class","isConnectable","isConnectableStart","isConnectableEnd","isValidConnection","onconnect","ondisconnect","children"]);const d=zt("svelteflow__node_id"),c=zt("svelteflow__node_connectable");let u=m(()=>o()==="target"),h=m(()=>t.isConnectable!==void 0?t.isConnectable:c.value),f=Je(),y=m(()=>f.ariaLabelConfig),w=null;Ai(()=>{if(t.onconnect||t.ondisconnect){f.edges;let v=f.connectionLookup.get(`${d}-${o()}${n()?`-${n()}`:""}`);if(w&&!Sc(v,w)){const E=v??new Map;Wo(w,E,t.ondisconnect),Wo(E,w,t.onconnect)}w=new Map(v)}});let p=m(()=>{if(!f.connection.inProgress)return[!1,!1,!1,!1,null];const{fromHandle:v,toHandle:E,isValid:g}=f.connection,b=v&&v.nodeId===d&&v.type===o()&&v.id===n(),x=E&&E.nodeId===d&&E.type===o()&&E.id===n(),N=f.connectionMode===vt.Strict?v?.type!==o():d!==v?.nodeId||n()!==v?.id;return[!0,b,x,N,x&&g]}),S=m(()=>Lt(a(p),5)),C=m(()=>a(S)[0]),P=m(()=>a(S)[1]),M=m(()=>a(S)[2]),_=m(()=>a(S)[3]),V=m(()=>a(S)[4]);function T(v){const E=f.onbeforeconnect?f.onbeforeconnect(v):v;E&&(f.addEdge(E),f.onconnect?.(v))}function L(v){const E=ni(v);v.currentTarget&&(E&&v.button===0||!E)&&rr.onPointerDown(v,{handleId:n(),nodeId:d,isTarget:a(u),connectionRadius:f.connectionRadius,domNode:f.domNode,nodeLookup:f.nodeLookup,connectionMode:f.connectionMode,lib:"svelte",autoPanOnConnect:f.autoPanOnConnect,autoPanSpeed:f.autoPanSpeed,flowId:f.flowId,isValidConnection:t.isValidConnection??f.isValidConnection,updateConnection:f.updateConnection,cancelConnection:f.cancelConnection,panBy:f.panBy,onConnect:T,onConnectStart:(g,b)=>{f.onconnectstart?.(g,{nodeId:b.nodeId,handleId:b.handleId,handleType:b.handleType})},onConnectEnd:(g,b)=>{f.onconnectend?.(g,b)},getTransform:()=>[f.viewport.x,f.viewport.y,f.viewport.zoom],getFromHandle:()=>f.connection.fromHandle,dragThreshold:f.connectionDragThreshold,handleDomNode:v.currentTarget})}function A(v){if(!d||!f.clickConnectStartHandle&&!i())return;if(!f.clickConnectStartHandle){f.onclickconnectstart?.(v,{nodeId:d,handleId:n(),handleType:o()}),f.clickConnectStartHandle={nodeId:d,type:o(),id:n()};return}const E=ei(v.target),g=t.isValidConnection??f.isValidConnection,{connectionMode:b,clickConnectStartHandle:x,flowId:N,nodeLookup:D}=f,{connection:z,isValid:I}=rr.isValid(v,{handle:{nodeId:d,id:n(),type:o()},connectionMode:b,fromNodeId:x.nodeId,fromHandleId:x.id??null,fromType:x.type,isValidConnection:g,flowId:N,doc:E,lib:"svelte",nodeLookup:D});I&&z&&T(z);const O=structuredClone(mr(f.connection));delete O.inProgress,O.toPosition=O.toHandle?O.toHandle.position:null,f.onclickconnectend?.(v,O),f.clickConnectStartHandle=null}var B=ku(),W=()=>{};Ge(B,()=>({"data-handleid":n(),"data-nodeid":d,"data-handlepos":r(),"data-id":`${f.flowId??""}-${d??""}-${n()??"null"??""}-${o()??""}`,class:["svelte-flow__handle",`svelte-flow__handle-${r()}`,f.noDragClass,f.noPanClass,r(),t.class],onmousedown:L,ontouchstart:L,onclick:f.clickConnect?A:void 0,onkeypress:W,style:t.style,role:"button","aria-label":a(y)["handle.ariaLabel"],tabindex:"-1",...l,[ao]:{valid:a(V),connectingto:a(M),connectingfrom:a(P),source:!a(u),target:a(u),connectablestart:i(),connectableend:s(),connectable:a(h),connectionindicator:a(h)&&(!a(C)||a(_))&&(a(C)||f.clickConnectStartHandle?s():i())}}));var k=j(B);Ce(k,()=>t.children??bt),U(B),K(e,B),re()}var Su=ie("<!> <!>",1);function mi(e,t){oe(t,!0);let n=R(t,"targetPosition",19,()=>$.Top),o=R(t,"sourcePosition",19,()=>$.Bottom);var r=Su(),i=ae(r);xn(i,{type:"target",get position(){return n()}});var s=ne(i),l=ne(s);xn(l,{type:"source",get position(){return o()}}),le(()=>xe(s,` ${t.data?.label??""} `)),K(e,r),re()}var Eu=ie(" <!>",1);function Cu(e,t){oe(t,!0);let n=R(t,"data",19,()=>({label:"Node"})),o=R(t,"sourcePosition",19,()=>$.Bottom);Bt();var r=Eu(),i=ae(r),s=ne(i);xn(s,{type:"source",get position(){return o()}}),le(()=>xe(i,`${n()?.label??""} `)),K(e,r),re()}var Nu=ie(" <!>",1);function Pu(e,t){oe(t,!0);let n=R(t,"data",19,()=>({label:"Node"})),o=R(t,"targetPosition",19,()=>$.Top);Bt();var r=Nu(),i=ae(r),s=ne(i);xn(s,{type:"target",get position(){return o()}}),le(()=>xe(i,`${n()?.label??""} `)),K(e,r),re()}function Mu(e,t){}function Zn(e,t,n){if(!n||!t)return;const o=n==="root"?t:t.querySelector(`.svelte-flow__${n}`);o&&o.appendChild(e)}function zu(e,t){const n=m(Je),o=m(()=>a(n).domNode);let r;return a(o)?Zn(e,a(o),t):r=gr(()=>{rt(()=>{Zn(e,a(o),t),r?.()})}),{async update(i){Zn(e,a(o),i)},destroy(){e.parentNode&&e.parentNode.removeChild(e),r?.()}}}function Au(){let e=ge(typeof window>"u");if(a(e)){const t=gr(()=>{rt(()=>{H(e,!1),t?.()})})}return{get value(){return a(e)}}}const sr=e=>Cc(e),Du=e=>qr(e);function He(e){return e===void 0?void 0:`${e}px`}const bn={ArrowUp:{x:0,y:-1},ArrowDown:{x:0,y:1},ArrowLeft:{x:-1,y:0},ArrowRight:{x:1,y:0}};var Iu=ie("<div><!></div>");function Tu(e,t){oe(t,!0);let n=R(t,"x",3,0),o=R(t,"y",3,0),r=R(t,"selectEdgeOnClick",3,!1),i=R(t,"transparent",3,!1),s=qe(t,["$$slots","$$events","$$legacy","x","y","width","height","selectEdgeOnClick","transparent","class","children"]);const l=Je(),d=zt("svelteflow__edge_id");if(!d)throw new Error("EdgeLabel must be used within an edge");let c=m(()=>l.visible.edges.get(d)?.zIndex);var u=Iu(),h=()=>{r()&&l.handleEdgeSelection(d)};Ge(u,y=>({class:["svelte-flow__edge-label",{transparent:i()},t.class],tabindex:"-1",onclick:h,...s,[_n]:y}),[()=>({display:Au().value?"none":void 0,cursor:r()?"pointer":void 0,transform:`translate(-50%, -50%) translate(${n()??""}px,${o()??""}px)`,"pointer-events":"all",width:He(t.width),height:He(t.height),"z-index":a(c)})],void 0,void 0,"svelte-1wg91mu");var f=j(u);Ce(f,()=>t.children??bt),U(u),pe(u,(y,w)=>zu?.(y,w),()=>"edge-labels"),K(e,u),re()}var Ou=he("<path></path>"),Hu=he('<path fill="none"></path><!><!>',1);function Dn(e,t){let n=R(t,"interactionWidth",3,20),o=qe(t,["$$slots","$$events","$$legacy","id","path","label","labelX","labelY","labelStyle","markerStart","markerEnd","style","interactionWidth","class"]);var r=Hu(),i=ae(r),s=ne(i);{var l=u=>{var h=Ou();Ge(h,()=>({d:t.path,"stroke-opacity":0,"stroke-width":n(),fill:"none",class:"svelte-flow__edge-interaction",...o})),K(u,h)};se(s,u=>{n()>0&&u(l)})}var d=ne(s);{var c=u=>{Tu(u,{get x(){return t.labelX},get y(){return t.labelY},get style(){return t.labelStyle},selectEdgeOnClick:!0,children:(h,f)=>{Bt();var y=Yn();le(()=>xe(y,t.label)),K(h,y)},$$slots:{default:!0}})};se(d,u=>{t.label&&u(c)})}le(()=>{J(i,"id",t.id),J(i,"d",t.path),Ue(i,0,lt(["svelte-flow__edge-path",t.class])),J(i,"marker-start",t.markerStart),J(i,"marker-end",t.markerEnd),Ne(i,t.style)}),K(e,r)}function yi(e,t){oe(t,!0);let n=m(()=>oi({sourceX:t.sourceX,sourceY:t.sourceY,targetX:t.targetX,targetY:t.targetY,sourcePosition:t.sourcePosition,targetPosition:t.targetPosition,curvature:t.pathOptions?.curvature})),o=m(()=>Lt(a(n),3)),r=m(()=>a(o)[0]),i=m(()=>a(o)[1]),s=m(()=>a(o)[2]);Dn(e,{get id(){return t.id},get path(){return a(r)},get labelX(){return a(i)},get labelY(){return a(s)},get label(){return t.label},get labelStyle(){return t.labelStyle},get markerStart(){return t.markerStart},get markerEnd(){return t.markerEnd},get interactionWidth(){return t.interactionWidth},get style(){return t.style}}),re()}function Ru(e,t){oe(t,!0);let n=m(()=>xo({sourceX:t.sourceX,sourceY:t.sourceY,targetX:t.targetX,targetY:t.targetY,sourcePosition:t.sourcePosition,targetPosition:t.targetPosition})),o=m(()=>Lt(a(n),3)),r=m(()=>a(o)[0]),i=m(()=>a(o)[1]),s=m(()=>a(o)[2]);Dn(e,{get path(){return a(r)},get labelX(){return a(i)},get labelY(){return a(s)},get label(){return t.label},get labelStyle(){return t.labelStyle},get markerStart(){return t.markerStart},get markerEnd(){return t.markerEnd},get interactionWidth(){return t.interactionWidth},get style(){return t.style}}),re()}function Vu(e,t){oe(t,!0);let n=m(()=>ii({sourceX:t.sourceX,sourceY:t.sourceY,targetX:t.targetX,targetY:t.targetY})),o=m(()=>Lt(a(n),3)),r=m(()=>a(o)[0]),i=m(()=>a(o)[1]),s=m(()=>a(o)[2]);Dn(e,{get path(){return a(r)},get labelX(){return a(i)},get labelY(){return a(s)},get label(){return t.label},get labelStyle(){return t.labelStyle},get markerStart(){return t.markerStart},get markerEnd(){return t.markerEnd},get interactionWidth(){return t.interactionWidth},get style(){return t.style}}),re()}function Lu(e,t){oe(t,!0);let n=m(()=>xo({sourceX:t.sourceX,sourceY:t.sourceY,targetX:t.targetX,targetY:t.targetY,sourcePosition:t.sourcePosition,targetPosition:t.targetPosition,borderRadius:0})),o=m(()=>Lt(a(n),3)),r=m(()=>a(o)[0]),i=m(()=>a(o)[1]),s=m(()=>a(o)[2]);Dn(e,{get path(){return a(r)},get labelX(){return a(i)},get labelY(){return a(s)},get label(){return t.label},get labelStyle(){return t.labelStyle},get markerStart(){return t.markerStart},get markerEnd(){return t.markerEnd},get interactionWidth(){return t.interactionWidth},get style(){return t.style}}),re()}class Bu{#e;#t;constructor(t,n){this.#e=t,this.#t=Hi(n)}get current(){return this.#t(),this.#e()}}const Ku=/\(.+\)/,Zu=new Set(["all","print","screen","and","or","not","only"]);class Fu extends Bu{constructor(t,n){let o=Ku.test(t)||t.split(/[\s,]+/).some(i=>Zu.has(i.trim()))?t:`(${t})`;const r=window.matchMedia(o);super(()=>r.matches,i=>Xn(r,"change",i))}}function Yu(e,t,n,o){const r=new Map;return wo(e,{x:0,y:0,width:n,height:o},t,!0).forEach(i=>{r.set(i.id,i)}),r}function ar(e){const{edges:t,defaultEdgeOptions:n,nodeLookup:o,previousEdges:r,connectionMode:i,onerror:s,onlyRenderVisible:l,elevateEdgesOnSelect:d}=e,c=new Map;for(const u of t){const h=o.get(u.source),f=o.get(u.target);if(!h||!f)continue;if(l){const{visibleNodes:p,transform:S,width:C,height:P}=e;if(Bc({sourceNode:h,targetNode:f,width:C,height:P,transform:S}))p.set(h.id,h),p.set(f.id,f);else continue}const y=r.get(u.id);if(y&&u===y.edge&&h==y.sourceNode&&f==y.targetNode){c.set(u.id,y);continue}const w=qc({id:u.id,sourceNode:h,targetNode:f,sourceHandle:u.sourceHandle||null,targetHandle:u.targetHandle||null,connectionMode:i,onError:s});w&&c.set(u.id,{...n,...u,...w,zIndex:Lc({selected:u.selected,zIndex:u.zIndex??n.zIndex,sourceNode:h,targetNode:f,elevateOnSelect:d}),sourceNode:h,targetNode:f,edge:u})}return c}const vi={input:Cu,output:Pu,default:mi,group:Mu},wi={straight:Vu,smoothstep:Ru,default:yi,step:Lu};function Xu(e,t,n,o,r,i){if(t&&!n&&o&&r){const s=Xt(i,{filter:l=>!!((l.width||l.initialWidth)&&(l.height||l.initialHeight))});return po(s,o,r,.5,2,.1)}else return n??{x:0,y:0,zoom:1}}function Wu(e){class t{#e=m(()=>e.props.id??"1");get flowId(){return a(this.#e)}set flowId(o){H(this.#e,o)}#t=ge(null);get domNode(){return a(this.#t)}set domNode(o){H(this.#t,o)}#n=ge(null);get panZoom(){return a(this.#n)}set panZoom(o){H(this.#n,o)}#o=ge(e.width??0);get width(){return a(this.#o)}set width(o){H(this.#o,o)}#r=ge(e.height??0);get height(){return a(this.#r)}set height(o){H(this.#r,o)}#i=m(()=>{const o=$c(e.nodes,this.nodeLookup,this.parentLookup,{nodeExtent:this.nodeExtent,nodeOrigin:this.nodeOrigin,elevateNodesOnSelect:e.props.elevateNodesOnSelect??!0,checkEquality:!0});return this.fitViewQueued&&o&&(this.fitViewOptions?.duration?this.resolveFitView():queueMicrotask(()=>{this.resolveFitView()})),o});get nodesInitialized(){return a(this.#i)}set nodesInitialized(o){H(this.#i,o)}#s=m(()=>this.panZoom!==null);get viewportInitialized(){return a(this.#s)}set viewportInitialized(o){H(this.#s,o)}#a=m(()=>(iu(this.connectionLookup,this.edgeLookup,e.edges),e.edges));get _edges(){return a(this.#a)}set _edges(o){H(this.#a,o)}get nodes(){return this.nodesInitialized,e.nodes}set nodes(o){e.nodes=o}get edges(){return this._edges}set edges(o){e.edges=o}_prevSelectedNodes=[];_prevSelectedNodeIds=new Set;#l=m(()=>{const o=this._prevSelectedNodeIds.size,r=new Set,i=this.nodes.filter(s=>(s.selected&&(r.add(s.id),this._prevSelectedNodeIds.delete(s.id)),s.selected));return(o!==r.size||this._prevSelectedNodeIds.size>0)&&(this._prevSelectedNodes=i),this._prevSelectedNodeIds=r,this._prevSelectedNodes});get selectedNodes(){return a(this.#l)}set selectedNodes(o){H(this.#l,o)}_prevSelectedEdges=[];_prevSelectedEdgeIds=new Set;#c=m(()=>{const o=this._prevSelectedEdgeIds.size,r=new Set,i=this.edges.filter(s=>(s.selected&&(r.add(s.id),this._prevSelectedEdgeIds.delete(s.id)),s.selected));return(o!==r.size||this._prevSelectedEdgeIds.size>0)&&(this._prevSelectedEdges=i),this._prevSelectedEdgeIds=r,this._prevSelectedEdges});get selectedEdges(){return a(this.#c)}set selectedEdges(o){H(this.#c,o)}selectionChangeHandlers=new Map;nodeLookup=new Map;parentLookup=new Map;connectionLookup=new Map;edgeLookup=new Map;_prevVisibleEdges=new Map;#u=m(()=>{const{nodes:o,_edges:r,_prevVisibleEdges:i,nodeLookup:s,connectionMode:l,onerror:d,onlyRenderVisibleElements:c,defaultEdgeOptions:u}=this;let h,f;const y={edges:r,defaultEdgeOptions:u,previousEdges:i,nodeLookup:s,connectionMode:l,elevateEdgesOnSelect:e.props.elevateEdgesOnSelect??!0,onerror:d};if(c){const{viewport:w,width:p,height:S}=this,C=[w.x,w.y,w.zoom];h=Yu(s,C,p,S),f=ar({...y,onlyRenderVisible:!0,visibleNodes:h,transform:C,width:p,height:S})}else h=this.nodeLookup,f=ar(y);return{nodes:h,edges:f}});get visible(){return a(this.#u)}set visible(o){H(this.#u,o)}#d=m(()=>e.props.nodesDraggable??!0);get nodesDraggable(){return a(this.#d)}set nodesDraggable(o){H(this.#d,o)}#f=m(()=>e.props.nodesConnectable??!0);get nodesConnectable(){return a(this.#f)}set nodesConnectable(o){H(this.#f,o)}#h=m(()=>e.props.elementsSelectable??!0);get elementsSelectable(){return a(this.#h)}set elementsSelectable(o){H(this.#h,o)}#g=m(()=>e.props.nodesFocusable??!0);get nodesFocusable(){return a(this.#g)}set nodesFocusable(o){H(this.#g,o)}#m=m(()=>e.props.edgesFocusable??!0);get edgesFocusable(){return a(this.#m)}set edgesFocusable(o){H(this.#m,o)}#y=m(()=>e.props.disableKeyboardA11y??!1);get disableKeyboardA11y(){return a(this.#y)}set disableKeyboardA11y(o){H(this.#y,o)}#v=m(()=>e.props.minZoom??.5);get minZoom(){return a(this.#v)}set minZoom(o){H(this.#v,o)}#w=m(()=>e.props.maxZoom??2);get maxZoom(){return a(this.#w)}set maxZoom(o){H(this.#w,o)}#p=m(()=>e.props.nodeOrigin??[0,0]);get nodeOrigin(){return a(this.#p)}set nodeOrigin(o){H(this.#p,o)}#x=m(()=>e.props.nodeExtent??eo);get nodeExtent(){return a(this.#x)}set nodeExtent(o){H(this.#x,o)}#b=m(()=>e.props.translateExtent??eo);get translateExtent(){return a(this.#b)}set translateExtent(o){H(this.#b,o)}#_=m(()=>e.props.defaultEdgeOptions??{});get defaultEdgeOptions(){return a(this.#_)}set defaultEdgeOptions(o){H(this.#_,o)}#k=m(()=>e.props.nodeDragThreshold??1);get nodeDragThreshold(){return a(this.#k)}set nodeDragThreshold(o){H(this.#k,o)}#S=m(()=>e.props.autoPanOnNodeDrag??!0);get autoPanOnNodeDrag(){return a(this.#S)}set autoPanOnNodeDrag(o){H(this.#S,o)}#E=m(()=>e.props.autoPanOnConnect??!0);get autoPanOnConnect(){return a(this.#E)}set autoPanOnConnect(o){H(this.#E,o)}#C=m(()=>e.props.autoPanOnNodeFocus??!0);get autoPanOnNodeFocus(){return a(this.#C)}set autoPanOnNodeFocus(o){H(this.#C,o)}#N=m(()=>e.props.autoPanSpeed??15);get autoPanSpeed(){return a(this.#N)}set autoPanSpeed(o){H(this.#N,o)}#P=m(()=>e.props.connectionDragThreshold??1);get connectionDragThreshold(){return a(this.#P)}set connectionDragThreshold(o){H(this.#P,o)}fitViewQueued=e.props.fitView??!1;fitViewOptions=e.props.fitViewOptions;fitViewResolver=null;#M=m(()=>e.props.snapGrid??null);get snapGrid(){return a(this.#M)}set snapGrid(o){H(this.#M,o)}#z=ge(!1);get dragging(){return a(this.#z)}set dragging(o){H(this.#z,o)}#A=ge(null);get selectionRect(){return a(this.#A)}set selectionRect(o){H(this.#A,o)}#D=ge(!1);get selectionKeyPressed(){return a(this.#D)}set selectionKeyPressed(o){H(this.#D,o)}#I=ge(!1);get multiselectionKeyPressed(){return a(this.#I)}set multiselectionKeyPressed(o){H(this.#I,o)}#T=ge(!1);get deleteKeyPressed(){return a(this.#T)}set deleteKeyPressed(o){H(this.#T,o)}#O=ge(!1);get panActivationKeyPressed(){return a(this.#O)}set panActivationKeyPressed(o){H(this.#O,o)}#H=ge(!1);get zoomActivationKeyPressed(){return a(this.#H)}set zoomActivationKeyPressed(o){H(this.#H,o)}#R=ge(null);get selectionRectMode(){return a(this.#R)}set selectionRectMode(o){H(this.#R,o)}#V=ge("");get ariaLiveMessage(){return a(this.#V)}set ariaLiveMessage(o){H(this.#V,o)}#L=m(()=>e.props.selectionMode??yn.Partial);get selectionMode(){return a(this.#L)}set selectionMode(o){H(this.#L,o)}#B=m(()=>({...vi,...e.props.nodeTypes}));get nodeTypes(){return a(this.#B)}set nodeTypes(o){H(this.#B,o)}#K=m(()=>({...wi,...e.props.edgeTypes}));get edgeTypes(){return a(this.#K)}set edgeTypes(o){H(this.#K,o)}#Z=m(()=>e.props.noPanClass??"nopan");get noPanClass(){return a(this.#Z)}set noPanClass(o){H(this.#Z,o)}#F=m(()=>e.props.noDragClass??"nodrag");get noDragClass(){return a(this.#F)}set noDragClass(o){H(this.#F,o)}#Y=m(()=>e.props.noWheelClass??"nowheel");get noWheelClass(){return a(this.#Y)}set noWheelClass(o){H(this.#Y,o)}#X=m(()=>Hc(e.props.ariaLabelConfig));get ariaLabelConfig(){return a(this.#X)}set ariaLabelConfig(o){H(this.#X,o)}#W=ge(Xu(this.nodesInitialized,e.props.fitView,e.props.initialViewport,this.width,this.height,this.nodeLookup));get _viewport(){return a(this.#W)}set _viewport(o){H(this.#W,o)}get viewport(){return e.viewport??this._viewport}set viewport(o){e.viewport&&(e.viewport=o),this._viewport=o}#q=ge(to);get _connection(){return a(this.#q)}set _connection(o){H(this.#q,o)}#G=m(()=>this._connection.inProgress?{...this._connection,to:qt(this._connection.to,[this.viewport.x,this.viewport.y,this.viewport.zoom])}:this._connection);get connection(){return a(this.#G)}set connection(o){H(this.#G,o)}#U=m(()=>e.props.connectionMode??vt.Strict);get connectionMode(){return a(this.#U)}set connectionMode(o){H(this.#U,o)}#Q=m(()=>e.props.connectionRadius??20);get connectionRadius(){return a(this.#Q)}set connectionRadius(o){H(this.#Q,o)}#J=m(()=>e.props.isValidConnection??(()=>!0));get isValidConnection(){return a(this.#J)}set isValidConnection(o){H(this.#J,o)}#j=m(()=>e.props.selectNodesOnDrag??!0);get selectNodesOnDrag(){return a(this.#j)}set selectNodesOnDrag(o){H(this.#j,o)}#$=m(()=>e.props.defaultMarkerColor===void 0?"#b1b1b7":e.props.defaultMarkerColor);get defaultMarkerColor(){return a(this.#$)}set defaultMarkerColor(o){H(this.#$,o)}#ee=m(()=>Gc(e.edges,{defaultColor:this.defaultMarkerColor,id:this.flowId,defaultMarkerStart:this.defaultEdgeOptions.markerStart,defaultMarkerEnd:this.defaultEdgeOptions.markerEnd}));get markers(){return a(this.#ee)}set markers(o){H(this.#ee,o)}#te=m(()=>e.props.onlyRenderVisibleElements??!1);get onlyRenderVisibleElements(){return a(this.#te)}set onlyRenderVisibleElements(o){H(this.#te,o)}#ne=m(()=>e.props.onflowerror??Dc);get onerror(){return a(this.#ne)}set onerror(o){H(this.#ne,o)}#oe=m(()=>e.props.ondelete);get ondelete(){return a(this.#oe)}set ondelete(o){H(this.#oe,o)}#re=m(()=>e.props.onbeforedelete);get onbeforedelete(){return a(this.#re)}set onbeforedelete(o){H(this.#re,o)}#ie=m(()=>e.props.onbeforeconnect);get onbeforeconnect(){return a(this.#ie)}set onbeforeconnect(o){H(this.#ie,o)}#se=m(()=>e.props.onconnect);get onconnect(){return a(this.#se)}set onconnect(o){H(this.#se,o)}#ae=m(()=>e.props.onconnectstart);get onconnectstart(){return a(this.#ae)}set onconnectstart(o){H(this.#ae,o)}#le=m(()=>e.props.onconnectend);get onconnectend(){return a(this.#le)}set onconnectend(o){H(this.#le,o)}#ce=m(()=>e.props.onbeforereconnect);get onbeforereconnect(){return a(this.#ce)}set onbeforereconnect(o){H(this.#ce,o)}#ue=m(()=>e.props.onreconnect);get onreconnect(){return a(this.#ue)}set onreconnect(o){H(this.#ue,o)}#de=m(()=>e.props.onreconnectstart);get onreconnectstart(){return a(this.#de)}set onreconnectstart(o){H(this.#de,o)}#fe=m(()=>e.props.onreconnectend);get onreconnectend(){return a(this.#fe)}set onreconnectend(o){H(this.#fe,o)}#he=m(()=>e.props.clickConnect??!0);get clickConnect(){return a(this.#he)}set clickConnect(o){H(this.#he,o)}#ge=m(()=>e.props.onclickconnectstart);get onclickconnectstart(){return a(this.#ge)}set onclickconnectstart(o){H(this.#ge,o)}#me=m(()=>e.props.onclickconnectend);get onclickconnectend(){return a(this.#me)}set onclickconnectend(o){H(this.#me,o)}#ye=ge(null);get clickConnectStartHandle(){return a(this.#ye)}set clickConnectStartHandle(o){H(this.#ye,o)}#ve=m(()=>e.props.onselectiondrag);get onselectiondrag(){return a(this.#ve)}set onselectiondrag(o){H(this.#ve,o)}#we=m(()=>e.props.onselectiondragstart);get onselectiondragstart(){return a(this.#we)}set onselectiondragstart(o){H(this.#we,o)}#pe=m(()=>e.props.onselectiondragstop);get onselectiondragstop(){return a(this.#pe)}set onselectiondragstop(o){H(this.#pe,o)}resolveFitView=async()=>{this.panZoom&&(await zc({nodes:this.nodeLookup,width:this.width,height:this.height,panZoom:this.panZoom,minZoom:this.minZoom,maxZoom:this.maxZoom},this.fitViewOptions),this.fitViewResolver?.resolve(!0),this.fitViewQueued=!1,this.fitViewOptions=void 0,this.fitViewResolver=null)};_prefersDark=new Fu("(prefers-color-scheme: dark)",e.props.colorModeSSR==="dark");#xe=m(()=>e.props.colorMode==="system"?this._prefersDark.current?"dark":"light":e.props.colorMode??"light");get colorMode(){return a(this.#xe)}set colorMode(o){H(this.#xe,o)}constructor(){}resetStoreValues(){this.dragging=!1,this.selectionRect=null,this.selectionRectMode=null,this.selectionKeyPressed=!1,this.multiselectionKeyPressed=!1,this.deleteKeyPressed=!1,this.panActivationKeyPressed=!1,this.zoomActivationKeyPressed=!1,this._connection=to,this.clickConnectStartHandle=null,this.viewport=e.props.initialViewport??{x:0,y:0,zoom:1},this.ariaLiveMessage=""}}return new t}function Je(){const e=zt(ro);if(!e)throw new Error("To call useStore outside of <SvelteFlow /> you need to wrap your component in a <SvelteFlowProvider />");return e.getStore()}const ro=Symbol();function qu(e){const t=Wu(e);function n(k){t.nodeTypes={...vi,...k}}function o(k){t.edgeTypes={...wi,...k}}function r(k){t.edges=Fc(k,t.edges)}const i=(k,v=!1)=>{t.nodes=t.nodes.map(E=>{const g=k.get(E.id);return g?{...E,position:g.position,dragging:v}:E})};function s(k){const{changes:v,updatedInternals:E}=ou(k,t.nodeLookup,t.parentLookup,t.domNode,t.nodeOrigin);if(!E)return;Jc(t.nodeLookup,t.parentLookup,{nodeOrigin:t.nodeOrigin,nodeExtent:t.nodeExtent}),t.fitViewQueued&&t.resolveFitView();const g=new Map;for(const b of v){const x=t.nodeLookup.get(b.id)?.internals.userNode;if(!x)continue;const N={...x};switch(b.type){case"dimensions":{const D={...N.measured,...b.dimensions};b.setAttributes&&(N.width=b.dimensions?.width??N.width,N.height=b.dimensions?.height??N.height),N.measured=D;break}case"position":N.position=b.position??N.position;break}g.set(b.id,N)}t.nodes=t.nodes.map(b=>g.get(b.id)??b)}function l(k){const v=t.fitViewResolver??Promise.withResolvers();return t.fitViewQueued=!0,t.fitViewOptions=k,t.fitViewResolver=v,t.nodes=[...t.nodes],v.promise}async function d(k,v,E){const g=typeof E?.zoom<"u"?E.zoom:t.maxZoom,b=t.panZoom;return b?(await b.setViewport({x:t.width/2-k*g,y:t.height/2-v*g,zoom:g},{duration:E?.duration,ease:E?.ease,interpolate:E?.interpolate}),Promise.resolve(!0)):Promise.resolve(!1)}function c(k,v){const E=t.panZoom;return E?E.scaleBy(k,v):Promise.resolve(!1)}function u(k){return c(1.2,k)}function h(k){return c(1/1.2,k)}function f(k){const v=t.panZoom;v&&(v.setScaleExtent([k,t.maxZoom]),t.minZoom=k)}function y(k){const v=t.panZoom;v&&(v.setScaleExtent([t.minZoom,k]),t.maxZoom=k)}function w(k){const v=t.panZoom;v&&(v.setTranslateExtent(k),t.translateExtent=k)}function p(k,v=null){let E=!1;const g=k.map(b=>(v?v.has(b.id):!0)&&b.selected?(E=!0,{...b,selected:!1}):b);return[E,g]}function S(k){const v=k?.nodes?new Set(k.nodes.map(D=>D.id)):null,[E,g]=p(t.nodes,v);E&&(t.nodes=g);const b=k?.edges?new Set(k.edges.map(D=>D.id)):null,[x,N]=p(t.edges,b);x&&(t.edges=N)}function C(k){const v=t.multiselectionKeyPressed;t.nodes=t.nodes.map(E=>{const g=k.includes(E.id),b=v&&E.selected||g;return!!E.selected!==b?{...E,selected:b}:E}),v||S({nodes:[]})}function P(k){const v=t.multiselectionKeyPressed;t.edges=t.edges.map(E=>{const g=k.includes(E.id),b=v&&E.selected||g;return!!E.selected!==b?{...E,selected:b}:E}),v||S({edges:[]})}function M(k,v,E){const g=t.nodeLookup.get(k);if(!g){console.warn("012",Ot.error012(k));return}t.selectionRect=null,t.selectionRectMode=null,g.selected?(v||g.selected&&t.multiselectionKeyPressed)&&(S({nodes:[g],edges:[]}),requestAnimationFrame(()=>E?.blur())):C([k])}function _(k){const v=t.edgeLookup.get(k);if(!v){console.warn("012",Ot.error012(k));return}(v.selectable||t.elementsSelectable&&typeof v.selectable>"u")&&(t.selectionRect=null,t.selectionRectMode=null,v.selected?v.selected&&t.multiselectionKeyPressed&&S({nodes:[],edges:[v]}):P([k]))}function V(k,v){const{nodeExtent:E,snapGrid:g,nodeOrigin:b,nodeLookup:x,nodesDraggable:N,onerror:D}=t,z=new Map,I=g?.[0]??5,O=g?.[1]??5,X=k.x*I*v,F=k.y*O*v;for(const Z of x.values()){if(!(Z.selected&&(Z.draggable||N&&typeof Z.draggable>"u")))continue;let Y={x:Z.internals.positionAbsolute.x+X,y:Z.internals.positionAbsolute.y+F};g&&(Y=Wt(Y,g));const{position:G,positionAbsolute:Q}=Gr({nodeId:Z.id,nextPosition:Y,nodeLookup:x,nodeExtent:E,nodeOrigin:b,onError:D});Z.position=G,Z.internals.positionAbsolute=Q,z.set(Z.id,Z)}i(z)}function T(k){return ru({delta:k,panZoom:t.panZoom,transform:[t.viewport.x,t.viewport.y,t.viewport.zoom],translateExtent:t.translateExtent,width:t.width,height:t.height})}const L=k=>{t._connection={...k}};function A(){t._connection=to}function B(){t.resetStoreValues(),S()}return Object.assign(t,{setNodeTypes:n,setEdgeTypes:o,addEdge:r,updateNodePositions:i,updateNodeInternals:s,zoomIn:u,zoomOut:h,fitView:l,setCenter:d,setMinZoom:f,setMaxZoom:y,setTranslateExtent:w,unselectNodesAndEdges:S,addSelectedNodes:C,addSelectedEdges:P,handleNodeSelection:M,handleEdgeSelection:_,moveSelectedNodes:V,panBy:T,updateConnection:L,cancelConnection:A,reset:B})}function Gu(e,t){const{minZoom:n,maxZoom:o,initialViewport:r,onPanZoomStart:i,onPanZoom:s,onPanZoomEnd:l,translateExtent:d,setPanZoomInstance:c,onDraggingChange:u,onTransformChange:h}=t,f=_u({domNode:e,minZoom:n,maxZoom:o,translateExtent:d,viewport:r,onPanZoom:s,onPanZoomStart:i,onPanZoomEnd:l,onDraggingChange:u}),y=f.getViewport();return(r.x!==y.x||r.y!==y.y||r.zoom!==y.zoom)&&h([y.x,y.y,y.zoom]),c(f),f.update(t),{update(w){f.update(w)}}}var Uu=ie('<div class="svelte-flow__zoom svelte-flow__container"><!></div>');function Qu(e,t){oe(t,!0);let n=R(t,"store",15),o=m(()=>n().panActivationKeyPressed||t.panOnDrag),r=m(()=>n().panActivationKeyPressed||t.panOnScroll);const{viewport:i}=n();let s=!1;rt(()=>{!s&&n().viewportInitialized&&(t.oninit?.(),s=!0)});var l=Uu(),d=j(l);Ce(d,()=>t.children),U(l),pe(l,(c,u)=>Gu?.(c,u),()=>({viewport:n().viewport,minZoom:n().minZoom,maxZoom:n().maxZoom,initialViewport:i,onDraggingChange:c=>{n(n().dragging=c,!0)},setPanZoomInstance:c=>{n(n().panZoom=c,!0)},onPanZoomStart:t.onmovestart,onPanZoom:t.onmove,onPanZoomEnd:t.onmoveend,zoomOnScroll:t.zoomOnScroll,zoomOnDoubleClick:t.zoomOnDoubleClick,zoomOnPinch:t.zoomOnPinch,panOnScroll:a(r),panOnDrag:a(o),panOnScrollSpeed:t.panOnScrollSpeed,panOnScrollMode:t.panOnScrollMode,zoomActivationKeyPressed:n().zoomActivationKeyPressed,preventScrolling:typeof t.preventScrolling=="boolean"?t.preventScrolling:!0,noPanClassName:n().noPanClass,noWheelClassName:n().noWheelClass,userSelectionActive:!!n().selectionRect,translateExtent:n().translateExtent,lib:"svelte",paneClickDistance:t.paneClickDistance,selectionOnDrag:t.selectionOnDrag,onTransformChange:c=>{n(n().viewport={x:c[0],y:c[1],zoom:c[2]},!0)},connectionInProgress:n().connection.inProgress})),K(e,l),re()}function lr(e,t){return n=>{n.target===t&&e?.(n)}}function cr(e){return t=>{const n=e.has(t.id);return!!t.selected!==n?{...t,selected:n}:t}}function ur(e,t){if(e.size!==t.size)return!1;for(const n of e)if(!t.has(n))return!1;return!0}var Ju=ie("<div><!></div>");function ju(e,t){oe(t,!0);let n=R(t,"store",15),o=R(t,"panOnDrag",3,!0),r=R(t,"paneClickDistance",3,1),i,s=null,l=new Set,d=new Set,c=m(()=>n().panActivationKeyPressed||o()),u=m(()=>n().selectionKeyPressed||!!n().selectionRect||t.selectionOnDrag&&a(c)!==!0),h=m(()=>n().elementsSelectable&&(a(u)||n().selectionRectMode==="user")),f=!1;function y(A){if(s=i?.getBoundingClientRect(),!s)return;const B=A.target===i,W=!B&&!!A.target.closest(".nokey"),k=t.selectionOnDrag&&B||n().selectionKeyPressed;if(W||!a(u)||!k||A.button!==0||!A.isPrimary)return;A.target?.setPointerCapture?.(A.pointerId),f=!1;const{x:v,y:E}=ze(A,s);n(n().selectionRect={width:0,height:0,startX:v,startY:E,x:v,y:E},!0),B||(A.stopPropagation(),A.preventDefault())}function w(A){if(!a(u)||!s||!n().selectionRect)return;const B=ze(A,s),{startX:W=0,startY:k=0}=n().selectionRect;if(!f){const x=n().selectionKeyPressed?0:r();if(Math.hypot(B.x-W,B.y-k)<=x)return;n().unselectNodesAndEdges(),t.onselectionstart?.(A)}f=!0;const v={...n().selectionRect,x:B.x<W?B.x:W,y:B.y<k?B.y:k,width:Math.abs(B.x-W),height:Math.abs(B.y-k)},E=l,g=d;l=new Set(wo(n().nodeLookup,v,[n().viewport.x,n().viewport.y,n().viewport.zoom],n().selectionMode===yn.Partial,!0).map(x=>x.id));const b=n().defaultEdgeOptions.selectable??!0;d=new Set;for(const x of l){const N=n().connectionLookup.get(x);if(N)for(const{edgeId:D}of N.values()){const z=n().edgeLookup.get(D);z&&(z.selectable??b)&&d.add(D)}}ur(E,l)||n(n().nodes=n().nodes.map(cr(l)),!0),ur(g,d)||n(n().edges=n().edges.map(cr(d)),!0),n(n().selectionRectMode="user",!0),n(n().selectionRect=v,!0)}function p(A){A.button===0&&(A.target?.releasePointerCapture?.(A.pointerId),!f&&A.target===i&&P?.(A),n(n().selectionRect=null,!0),f&&n(n().selectionRectMode=l.size>0?"nodes":null,!0),f&&t.onselectionend?.(A))}const S=A=>{if(Array.isArray(a(c))&&a(c).includes(2)){A.preventDefault();return}t.onpanecontextmenu?.({event:A})},C=A=>{f&&(A.stopPropagation(),f=!1)};function P(A){if(f||n().connection.inProgress){f=!1;return}t.onpaneclick?.({event:A}),n().unselectNodesAndEdges(),n(n().selectionRectMode=null,!0),n(n().selectionRect=null,!0)}var M=Ju();let _;var V=m(()=>a(h)?void 0:lr(P,i));M.__click=function(...A){a(V)?.apply(this,A)},M.__pointermove=function(...A){(a(h)?w:void 0)?.apply(this,A)},M.__pointerup=function(...A){(a(h)?p:void 0)?.apply(this,A)};var T=m(()=>lr(S,i));M.__contextmenu=function(...A){a(T)?.apply(this,A)};var L=j(M);Ce(L,()=>t.children),U(M),Kt(M,A=>i=A,()=>i),le(A=>_=Ue(M,1,"svelte-flow__pane svelte-flow__container",null,_,A),[()=>({draggable:o()===!0||Array.isArray(o())&&o().includes(0),dragging:n().dragging,selection:a(u)})]),ln("pointerdown",M,function(...A){(a(h)?y:void 0)?.apply(this,A)},!0),ln("click",M,function(...A){(a(h)?C:void 0)?.apply(this,A)},!0),K(e,M),re()}so(["click","pointermove","pointerup","contextmenu"]);var $u=ie('<div class="svelte-flow__viewport xyflow__viewport svelte-flow__container"><!></div>');function ed(e,t){oe(t,!0);var n=$u();let o;var r=j(n);Ce(r,()=>t.children),U(n),le(()=>o=Ne(n,"",o,{transform:`translate(${t.store.viewport.x??""}px, ${t.store.viewport.y??""}px) scale(${t.store.viewport.zoom??""})`})),K(e,n),re()}function pi(e,t){const{store:n,onDrag:o,onDragStart:r,onDragStop:i,onNodeMouseDown:s}=t,l=lu({onDrag:o,onDragStart:r,onDragStop:i,onNodeMouseDown:s,getStoreItems:()=>{const{snapGrid:c,viewport:u}=n;return{nodes:n.nodes,nodeLookup:n.nodeLookup,edges:n.edges,nodeExtent:n.nodeExtent,snapGrid:c||[0,0],snapToGrid:!!c,nodeOrigin:n.nodeOrigin,multiSelectionActive:n.multiselectionKeyPressed,domNode:n.domNode,transform:[u.x,u.y,u.zoom],autoPanOnNodeDrag:n.autoPanOnNodeDrag,nodesDraggable:n.nodesDraggable,selectNodesOnDrag:n.selectNodesOnDrag,nodeDragThreshold:n.nodeDragThreshold,unselectNodesAndEdges:n.unselectNodesAndEdges,updateNodePositions:n.updateNodePositions,onSelectionDrag:n.onselectiondrag,onSelectionDragStart:n.onselectiondragstart,onSelectionDragStop:n.onselectiondragstop,panBy:n.panBy}}});function d(c,u){if(u.disabled){l.destroy();return}l.update({domNode:c,noDragClassName:u.noDragClass,handleSelector:u.handleSelector,nodeId:u.nodeId,isSelectable:u.isSelectable,nodeClickDistance:u.nodeClickDistance})}return d(e,t),{update(c){d(e,c)},destroy(){l.destroy()}}}var td=ie('<div aria-live="assertive" aria-atomic="true" class="a11y-live-msg svelte-13pq11u"> </div>'),nd=ie('<div class="a11y-hidden svelte-13pq11u"> </div> <div class="a11y-hidden svelte-13pq11u"> </div> <!>',1);function od(e,t){oe(t,!0);var n=nd(),o=ae(n),r=j(o,!0);U(o);var i=ne(o,2),s=j(i,!0);U(i);var l=ne(i,2);{var d=c=>{var u=td(),h=j(u,!0);U(u),le(()=>{J(u,"id",`${rd}-${t.store.flowId}`),xe(h,t.store.ariaLiveMessage)}),K(c,u)};se(l,c=>{t.store.disableKeyboardA11y||c(d)})}le(()=>{J(o,"id",`${xi}-${t.store.flowId}`),xe(r,t.store.disableKeyboardA11y?t.store.ariaLabelConfig["node.a11yDescription.default"]:t.store.ariaLabelConfig["node.a11yDescription.keyboardDisabled"]),J(i,"id",`${bi}-${t.store.flowId}`),xe(s,t.store.ariaLabelConfig["edge.a11yDescription.default"])}),K(e,n),re()}const xi="svelte-flow__node-desc",bi="svelte-flow__edge-desc",rd="svelte-flow__aria-live";var id=ie("<div><!></div>");function sd(e,t){oe(t,!0);let n=R(t,"store",15),o=m(()=>we(t.node.data,()=>({}),!0)),r=m(()=>we(t.node.selected,!1)),i=m(()=>t.node.draggable),s=m(()=>t.node.selectable),l=m(()=>we(t.node.deletable,!0)),d=m(()=>t.node.connectable),c=m(()=>t.node.focusable),u=m(()=>we(t.node.hidden,!1)),h=m(()=>we(t.node.dragging,!1)),f=m(()=>we(t.node.style,"")),y=m(()=>t.node.class),w=m(()=>we(t.node.type,"default")),p=m(()=>t.node.parentId),S=m(()=>t.node.sourcePosition),C=m(()=>t.node.targetPosition),P=m(()=>we(t.node.measured,()=>({width:0,height:0}),!0).width),M=m(()=>we(t.node.measured,()=>({width:0,height:0}),!0).height),_=m(()=>t.node.initialWidth),V=m(()=>t.node.initialHeight),T=m(()=>t.node.width),L=m(()=>t.node.height),A=m(()=>t.node.dragHandle),B=m(()=>we(t.node.internals.z,0)),W=m(()=>t.node.internals.positionAbsolute.x),k=m(()=>t.node.internals.positionAbsolute.y),v=m(()=>t.node.internals.userNode),{id:E}=t.node,g=m(()=>a(i)??n().nodesDraggable),b=m(()=>a(s)??n().elementsSelectable),x=m(()=>a(d)??n().nodesConnectable),N=m(()=>jr(t.node)),D=m(()=>!!t.node.internals.handleBounds),z=m(()=>a(N)&&a(D)),I=m(()=>a(c)??n().nodesFocusable);function O(ce){return n().parentLookup.has(ce)}let X=m(()=>O(E)),F=ge(null),Z=null,q=a(w),Y=a(S),G=a(C),Q=m(()=>n().nodeTypes[a(w)]??mi),ue=m(()=>n().ariaLabelConfig);an("svelteflow__node_connectable",{get value(){return a(x)}}),an("svelteflow__node_id",E);let ee=m(()=>{const ce=a(P)===void 0?a(T)??a(_):a(T),ye=a(M)===void 0?a(L)??a(V):a(L);if(!(ce===void 0&&ye===void 0&&a(f)===void 0))return`${a(f)};${ce?`width:${He(ce)};`:""}${ye?`height:${He(ye)};`:""}`});rt(()=>{(a(w)!==q||a(S)!==Y||a(C)!==G)&&a(F)!==null&&requestAnimationFrame(()=>{a(F)!==null&&n().updateNodeInternals(new Map([[E,{id:E,nodeElement:a(F),force:!0}]]))}),q=a(w),Y=a(S),G=a(C)}),rt(()=>{t.resizeObserver&&(!a(z)||a(F)!==Z)&&(Z&&t.resizeObserver.unobserve(Z),a(F)&&t.resizeObserver.observe(a(F)),Z=a(F))}),io(()=>{Z&&t.resizeObserver?.unobserve(Z)});function de(ce){a(b)&&(!n().selectNodesOnDrag||!a(g)||n().nodeDragThreshold>0)&&n().handleNodeSelection(E),t.onnodeclick?.({node:a(v),event:ce})}function te(ce){if(!(ti(ce)||n().disableKeyboardA11y))if(Wr.includes(ce.key)&&a(b)){const ye=ce.key==="Escape";n().handleNodeSelection(E,ye,a(F))}else a(g)&&t.node.selected&&Object.prototype.hasOwnProperty.call(bn,ce.key)&&(ce.preventDefault(),n(n().ariaLiveMessage=a(ue)["node.a11yDescription.ariaLiveMessage"]({direction:ce.key.replace("Arrow","").toLowerCase(),x:~~t.node.internals.positionAbsolute.x,y:~~t.node.internals.positionAbsolute.y}),!0),n().moveSelectedNodes(bn[ce.key],ce.shiftKey?4:1))}const be=()=>{if(n().disableKeyboardA11y||!n().autoPanOnNodeFocus||!a(F)?.matches(":focus-visible"))return;const{width:ce,height:ye,viewport:Fe}=n();wo(new Map([[E,t.node]]),{x:0,y:0,width:ce,height:ye},[Fe.x,Fe.y,Fe.zoom],!0).length>0||n().setCenter(t.node.position.x+(t.node.measured.width??0)/2,t.node.position.y+(t.node.measured.height??0)/2,{zoom:Fe.zoom})};var Ze=me(),je=ae(Ze);{var De=ce=>{var ye=id();Ge(ye,()=>({"data-id":E,class:["svelte-flow__node",`svelte-flow__node-${a(w)}`,a(y)],style:a(ee),onclick:de,onpointerenter:t.onnodepointerenter?fe=>t.onnodepointerenter({node:a(v),event:fe}):void 0,onpointerleave:t.onnodepointerleave?fe=>t.onnodepointerleave({node:a(v),event:fe}):void 0,onpointermove:t.onnodepointermove?fe=>t.onnodepointermove({node:a(v),event:fe}):void 0,oncontextmenu:t.onnodecontextmenu?fe=>t.onnodecontextmenu({node:a(v),event:fe}):void 0,onkeydown:a(I)?te:void 0,onfocus:a(I)?be:void 0,tabIndex:a(I)?0:void 0,role:t.node.ariaRole??(a(I)?"group":void 0),"aria-roledescription":"node","aria-describedby":n().disableKeyboardA11y?void 0:`${xi}-${n().flowId}`,...t.node.domAttributes,[ao]:{dragging:a(h),selected:a(r),draggable:a(g),connectable:a(x),selectable:a(b),nopan:a(g),parent:a(X)},[_n]:{"z-index":a(B),transform:`translate(${a(W)??""}px, ${a(k)??""}px)`,visibility:a(N)?"visible":"hidden"}}));var Fe=j(ye);kn(Fe,()=>a(Q),(fe,ct)=>{ct(fe,{get data(){return a(o)},get id(){return E},get selected(){return a(r)},get selectable(){return a(b)},get deletable(){return a(l)},get sourcePosition(){return a(S)},get targetPosition(){return a(C)},get zIndex(){return a(B)},get dragging(){return a(h)},get draggable(){return a(g)},get dragHandle(){return a(A)},get parentId(){return a(p)},get type(){return a(w)},get isConnectable(){return a(x)},get positionAbsoluteX(){return a(W)},get positionAbsoluteY(){return a(k)},get width(){return a(T)},get height(){return a(L)}})}),U(ye),pe(ye,(fe,ct)=>pi?.(fe,ct),()=>({nodeId:E,isSelectable:a(b),disabled:!a(g),handleSelector:a(A),noDragClass:n().noDragClass,nodeClickDistance:t.nodeClickDistance,onNodeMouseDown:n().handleNodeSelection,onDrag:(fe,ct,_t,kt)=>{t.onnodedrag?.({event:fe,targetNode:_t,nodes:kt})},onDragStart:(fe,ct,_t,kt)=>{t.onnodedragstart?.({event:fe,targetNode:_t,nodes:kt})},onDragStop:(fe,ct,_t,kt)=>{t.onnodedragstop?.({event:fe,targetNode:_t,nodes:kt})},store:n()})),Kt(ye,fe=>H(F,fe),()=>a(F)),K(ce,ye)};se(je,ce=>{a(u)||ce(De)})}K(e,Ze),re()}var ad=ie('<div class="svelte-flow__nodes"></div>');function ld(e,t){oe(t,!0);let n=R(t,"store",15);const o=typeof ResizeObserver>"u"?null:new ResizeObserver(i=>{const s=new Map;i.forEach(l=>{const d=l.target.getAttribute("data-id");s.set(d,{id:d,nodeElement:l.target,force:!0})}),n().updateNodeInternals(s)});io(()=>{o?.disconnect()});var r=ad();nt(r,21,()=>n().visible.nodes.values(),i=>i.id,(i,s)=>{sd(i,{get node(){return a(s)},get resizeObserver(){return o},get nodeClickDistance(){return t.nodeClickDistance},get onnodeclick(){return t.onnodeclick},get onnodepointerenter(){return t.onnodepointerenter},get onnodepointermove(){return t.onnodepointermove},get onnodepointerleave(){return t.onnodepointerleave},get onnodedrag(){return t.onnodedrag},get onnodedragstart(){return t.onnodedragstart},get onnodedragstop(){return t.onnodedragstop},get onnodecontextmenu(){return t.onnodecontextmenu},get store(){return n()},set store(l){n(l)}})}),U(r),K(e,r),re()}var cd=he('<svg class="svelte-flow__edge-wrapper"><g><!></g></svg>');function ud(e,t){oe(t,!0);let n=m(()=>t.edge.source),o=m(()=>t.edge.target),r=m(()=>t.edge.sourceX),i=m(()=>t.edge.sourceY),s=m(()=>t.edge.targetX),l=m(()=>t.edge.targetY),d=m(()=>t.edge.sourcePosition),c=m(()=>t.edge.targetPosition),u=m(()=>we(t.edge.animated,!1)),h=m(()=>we(t.edge.selected,!1)),f=m(()=>t.edge.label),y=m(()=>t.edge.labelStyle),w=m(()=>we(t.edge.data,()=>({}),!0)),p=m(()=>t.edge.style),S=m(()=>t.edge.interactionWidth),C=m(()=>we(t.edge.type,"default")),P=m(()=>t.edge.sourceHandle),M=m(()=>t.edge.targetHandle),_=m(()=>t.edge.markerStart),V=m(()=>t.edge.markerEnd),T=m(()=>t.edge.selectable),L=m(()=>t.edge.focusable),A=m(()=>we(t.edge.deletable,!0)),B=m(()=>t.edge.hidden),W=m(()=>t.edge.zIndex),k=m(()=>t.edge.class),v=m(()=>t.edge.ariaLabel),E=null;const{id:g}=t.edge;an("svelteflow__edge_id",g);let b=m(()=>a(T)??t.store.elementsSelectable),x=m(()=>a(L)??t.store.edgesFocusable),N=m(()=>t.store.edgeTypes[a(C)]??yi),D=m(()=>a(_)?`url('#${oo(a(_),t.store.flowId)}')`:void 0),z=m(()=>a(V)?`url('#${oo(a(V),t.store.flowId)}')`:void 0);function I(Y){const G=t.store.edgeLookup.get(g);G&&(a(b)&&t.store.handleEdgeSelection(g),t.onedgeclick?.({event:Y,edge:G}))}function O(Y,G){const Q=t.store.edgeLookup.get(g);Q&&G({event:Y,edge:Q})}function X(Y){if(!t.store.disableKeyboardA11y&&Wr.includes(Y.key)&&a(b)){const{unselectNodesAndEdges:G,addSelectedEdges:Q}=t.store;Y.key==="Escape"?(E?.blur(),G({edges:[t.edge]})):Q([g])}}var F=me(),Z=ae(F);{var q=Y=>{var G=cd();let Q;var ue=j(G);Ge(ue,()=>({class:["svelte-flow__edge",a(k)],"data-id":g,onclick:I,oncontextmenu:t.onedgecontextmenu?ee=>{O(ee,t.onedgecontextmenu)}:void 0,onpointerenter:t.onedgepointerenter?ee=>{O(ee,t.onedgepointerenter)}:void 0,onpointerleave:t.onedgepointerleave?ee=>{O(ee,t.onedgepointerleave)}:void 0,"aria-label":a(v)===null?void 0:a(v)?a(v):`Edge from ${a(n)} to ${a(o)}`,"aria-describedby":a(x)?`${bi}-${t.store.flowId}`:void 0,role:t.edge.ariaRole??(a(x)?"group":"img"),"aria-roledescription":"edge",onkeydown:a(x)?X:void 0,tabindex:a(x)?0:void 0,...t.edge.domAttributes,[ao]:{animated:a(u),selected:a(h),selectable:a(b)}}));var ve=j(ue);kn(ve,()=>a(N),(ee,de)=>{de(ee,{get id(){return g},get source(){return a(n)},get target(){return a(o)},get sourceX(){return a(r)},get sourceY(){return a(i)},get targetX(){return a(s)},get targetY(){return a(l)},get sourcePosition(){return a(d)},get targetPosition(){return a(c)},get animated(){return a(u)},get selected(){return a(h)},get label(){return a(f)},get labelStyle(){return a(y)},get data(){return a(w)},get style(){return a(p)},get interactionWidth(){return a(S)},get selectable(){return a(b)},get deletable(){return a(A)},get type(){return a(C)},get sourceHandleId(){return a(P)},get targetHandleId(){return a(M)},get markerStart(){return a(D)},get markerEnd(){return a(z)}})}),U(ue),Kt(ue,ee=>E=ee,()=>E),U(G),le(()=>Q=Ne(G,"",Q,{"z-index":a(W)})),K(Y,G)};se(Z,Y=>{a(B)||Y(q)})}K(e,F),re()}var dd=he("<defs></defs>");function fd(e,t){oe(t,!1);const n=Je();Oi();var o=dd();nt(o,5,()=>n.markers,r=>r.id,(r,i)=>{yd(r,Ye(()=>a(i)))}),U(o),K(e,o),re()}var hd=he('<polyline class="arrow" fill="none" stroke-linecap="round" stroke-linejoin="round" points="-5,-4 0,0 -5,4"></polyline>'),gd=he('<polyline class="arrowclosed" stroke-linecap="round" stroke-linejoin="round" points="-5,-4 0,0 -5,4 -5,-4"></polyline>'),md=he('<marker class="svelte-flow__arrowhead" viewBox="-10 -10 20 20" refX="0" refY="0"><!></marker>');function yd(e,t){oe(t,!0);let n=R(t,"width",3,12.5),o=R(t,"height",3,12.5),r=R(t,"markerUnits",3,"strokeWidth"),i=R(t,"orient",3,"auto-start-reverse"),s=R(t,"color",3,"none");var l=md(),d=j(l);{var c=h=>{var f=hd();let y;le(()=>{J(f,"stroke-width",t.strokeWidth),y=Ne(f,"",y,{stroke:s()})}),K(h,f)},u=h=>{var f=me(),y=ae(f);{var w=p=>{var S=gd();let C;le(()=>{J(S,"stroke-width",t.strokeWidth),C=Ne(S,"",C,{stroke:s(),fill:s()})}),K(p,S)};se(y,p=>{t.type===vn.ArrowClosed&&p(w)},!0)}K(h,f)};se(d,h=>{t.type===vn.Arrow?h(c):h(u,!1)})}U(l),le(()=>{J(l,"id",t.id),J(l,"markerWidth",`${n()}`),J(l,"markerHeight",`${o()}`),J(l,"markerUnits",r()),J(l,"orient",i())}),K(e,l),re()}var vd=ie('<div class="svelte-flow__edges"><svg class="svelte-flow__marker"><!></svg> <!></div>');function wd(e,t){oe(t,!0);let n=R(t,"store",15);var o=vd(),r=j(o),i=j(r);fd(i,{}),U(r);var s=ne(r,2);nt(s,17,()=>n().visible.edges.values(),l=>l.id,(l,d)=>{ud(l,{get edge(){return a(d)},get onedgeclick(){return t.onedgeclick},get onedgecontextmenu(){return t.onedgecontextmenu},get onedgepointerenter(){return t.onedgepointerenter},get onedgepointerleave(){return t.onedgepointerleave},get store(){return n()},set store(c){n(c)}})}),U(o),K(e,o),re()}var pd=ie('<div class="svelte-flow__selection svelte-1vr3gfi"></div>');function _i(e,t){oe(t,!0);let n=R(t,"x",3,0),o=R(t,"y",3,0),r=R(t,"width",3,0),i=R(t,"height",3,0),s=R(t,"isVisible",3,!0);var l=me(),d=ae(l);{var c=u=>{var h=pd();let f;le(y=>f=Ne(h,"",f,y),[()=>({width:typeof r()=="string"?r():He(r()),height:typeof i()=="string"?i():He(i()),transform:`translate(${n()}px, ${o()}px)`})]),K(u,h)};se(d,u=>{s()&&u(c)})}K(e,l),re()}var xd=ie("<div><!></div>");function bd(e,t){oe(t,!0);let n=ge(void 0);rt(()=>{t.store.disableKeyboardA11y||a(n)?.focus({preventScroll:!0})});let o=m(()=>{if(t.store.selectionRectMode==="nodes"){t.store.nodes;const u=Xt(t.store.nodeLookup,{filter:h=>!!h.selected});if(u.width>0&&u.height>0)return u}return null});function r(u){const h=t.store.nodes.filter(f=>f.selected);t.onselectioncontextmenu?.({nodes:h,event:u})}function i(u){const h=t.store.nodes.filter(f=>f.selected);t.onselectionclick?.({nodes:h,event:u})}function s(u){Object.prototype.hasOwnProperty.call(bn,u.key)&&(u.preventDefault(),t.store.moveSelectedNodes(bn[u.key],u.shiftKey?4:1))}var l=me(),d=ae(l);{var c=u=>{var h=xd();h.__contextmenu=r,h.__click=i,h.__keydown=function(...w){(t.store.disableKeyboardA11y?void 0:s)?.apply(this,w)};let f;var y=j(h);_i(y,{width:"100%",height:"100%",x:0,y:0}),U(h),pe(h,(w,p)=>pi?.(w,p),()=>({disabled:!1,store:t.store,onDrag:(w,p,S,C)=>{t.onnodedrag?.({event:w,targetNode:null,nodes:C})},onDragStart:(w,p,S,C)=>{t.onnodedragstart?.({event:w,targetNode:null,nodes:C})},onDragStop:(w,p,S,C)=>{t.onnodedragstop?.({event:w,targetNode:null,nodes:C})}})),Kt(h,w=>H(n,w),()=>a(n)),le(w=>{Ue(h,1,lt(["svelte-flow__selection-wrapper",t.store.noPanClass]),"svelte-sf2y5e"),J(h,"role",t.store.disableKeyboardA11y?void 0:"button"),J(h,"tabindex",t.store.disableKeyboardA11y?void 0:-1),f=Ne(h,"",f,w)},[()=>({width:He(a(o).width),height:He(a(o).height),transform:`translate(${a(o).x??""}px, ${a(o).y??""}px)`})]),K(u,h)};se(d,u=>{t.store.selectionRectMode==="nodes"&&a(o)&&Be(a(o).x)&&Be(a(o).y)&&u(c)})}K(e,l),re()}so(["contextmenu","click","keydown"]);function _d(e){switch(e){case"ctrl":return 8;case"shift":return 4;case"alt":return 2;case"meta":return 1}}function Ie(e,t){let{enabled:n=!0,trigger:o,type:r="keydown"}=t;function i(l){const d=Array.isArray(o)?o:[o],c=[l.metaKey,l.altKey,l.shiftKey,l.ctrlKey].reduce((u,h,f)=>h?u|1<<f:u,0);for(const u of d){const h={preventDefault:!1,enabled:!0,...u},{modifier:f,key:y,callback:w,preventDefault:p,enabled:S}=h;if(S){if(l.key!==y)continue;if(f===null||f===!1){if(c!==0)continue}else if(f!==void 0&&f?.[0]?.length>0){const P=Array.isArray(f)?f:[f];let M=!1;for(const _ of P)if((Array.isArray(_)?_:[_]).reduce((T,L)=>T|_d(L),0)===c){M=!0;break}if(!M)continue}p&&l.preventDefault();const C={node:e,trigger:h,originalEvent:l};e.dispatchEvent(new CustomEvent("shortcut",{detail:C})),w?.(C)}}}let s;return n&&(s=Xn(e,r,i)),{update:l=>{const{enabled:d=!0,type:c="keydown"}=l;n&&(!d||r!==c)?s?.():!n&&d&&(s=Xn(e,c,i)),n=d,r=c,o=l.trigger},destroy:()=>{s?.()}}}function kd(){const e=m(Je),t=i=>{const s=sr(i)?i:a(e).nodeLookup.get(i.id),l=s.parentId?Oc(s.position,s.measured,s.parentId,a(e).nodeLookup,a(e).nodeOrigin):s.position,d={...s,position:l,width:s.measured?.width??s.width,height:s.measured?.height??s.height};return pt(d)};function n(i,s,l={replace:!1}){a(e).nodes=et(()=>a(e).nodes).map(d=>{if(d.id===i){const c=typeof s=="function"?s(d):s;return l?.replace&&sr(c)?c:{...d,...c}}return d})}function o(i,s,l={replace:!1}){a(e).edges=et(()=>a(e).edges).map(d=>{if(d.id===i){const c=typeof s=="function"?s(d):s;return l.replace&&Du(c)?c:{...d,...c}}return d})}const r=i=>a(e).nodeLookup.get(i);return{zoomIn:a(e).zoomIn,zoomOut:a(e).zoomOut,getInternalNode:r,getNode:i=>r(i)?.internals.userNode,getNodes:i=>i===void 0?a(e).nodes:dr(a(e).nodeLookup,i),getEdge:i=>a(e).edgeLookup.get(i),getEdges:i=>i===void 0?a(e).edges:dr(a(e).edgeLookup,i),setZoom:(i,s)=>{const l=a(e).panZoom;return l?l.scaleTo(i,{duration:s?.duration}):Promise.resolve(!1)},getZoom:()=>a(e).viewport.zoom,setViewport:async(i,s)=>{const l=a(e).viewport;return a(e).panZoom?(await a(e).panZoom.setViewport({x:i.x??l.x,y:i.y??l.y,zoom:i.zoom??l.zoom},s),Promise.resolve(!0)):Promise.resolve(!1)},getViewport:()=>mr(a(e).viewport),setCenter:async(i,s,l)=>a(e).setCenter(i,s,l),fitView:i=>a(e).fitView(i),fitBounds:async(i,s)=>{if(!a(e).panZoom)return Promise.resolve(!1);const l=po(i,a(e).width,a(e).height,a(e).minZoom,a(e).maxZoom,s?.padding??.1);return await a(e).panZoom.setViewport(l,{duration:s?.duration,ease:s?.ease,interpolate:s?.interpolate}),Promise.resolve(!0)},getIntersectingNodes:(i,s=!0,l)=>{const d=Go(i),c=d?i:t(i);return c?(l||a(e).nodes).filter(u=>{const h=a(e).nodeLookup.get(u.id);if(!h||!d&&u.id===i.id)return!1;const f=pt(h),y=Ht(f,c);return s&&y>0||y>=f.width*f.height||y>=c.width*c.height}):[]},isNodeIntersecting:(i,s,l=!0)=>{const c=Go(i)?i:t(i);if(!c)return!1;const u=Ht(c,s);return l&&u>0||u>=s.width*s.height||u>=c.width*c.height},deleteElements:async({nodes:i=[],edges:s=[]})=>{const{nodes:l,edges:d}=await Ac({nodesToRemove:i,edgesToRemove:s,nodes:a(e).nodes,edges:a(e).edges,onBeforeDelete:a(e).onbeforedelete});return l&&(a(e).nodes=et(()=>a(e).nodes).filter(c=>!l.some(({id:u})=>u===c.id))),d&&(a(e).edges=et(()=>a(e).edges).filter(c=>!d.some(({id:u})=>u===c.id))),(l.length>0||d.length>0)&&a(e).ondelete?.({nodes:l,edges:d}),{deletedNodes:l,deletedEdges:d}},screenToFlowPosition:(i,s={snapToGrid:!0})=>{if(!a(e).domNode)return i;const l=s.snapToGrid?a(e).snapGrid:!1,{x:d,y:c,zoom:u}=a(e).viewport,{x:h,y:f}=a(e).domNode.getBoundingClientRect(),y={x:i.x-h,y:i.y-f};return qt(y,[d,c,u],l!==null,l||[1,1])},flowToScreenPosition:i=>{if(!a(e).domNode)return i;const{x:s,y:l,zoom:d}=a(e).viewport,{x:c,y:u}=a(e).domNode.getBoundingClientRect(),h=pn(i,[s,l,d]);return{x:h.x+c,y:h.y+u}},toObject:()=>structuredClone({nodes:[...a(e).nodes],edges:[...a(e).edges],viewport:{...a(e).viewport}}),updateNode:n,updateNodeData:(i,s,l)=>{const d=a(e).nodeLookup.get(i)?.internals.userNode;if(!d)return;const c=typeof s=="function"?s(d):s;n(i,u=>({...u,data:l?.replace?c:{...u.data,...c}}))},updateEdge:o,getNodesBounds:i=>Nc(i,{nodeLookup:a(e).nodeLookup,nodeOrigin:a(e).nodeOrigin}),getHandleConnections:({type:i,id:s,nodeId:l})=>Array.from(a(e).connectionLookup.get(`${l}-${i}-${s??null}`)?.values()??[])}}function dr(e,t){const n=[];for(const o of t){const r=e.get(o);if(r){const i="internals"in r?r.internals?.userNode:r;n.push(i)}}return n}function Sd(e,t){oe(t,!0);let n=R(t,"store",15),o=R(t,"selectionKey",3,"Shift"),r=R(t,"multiSelectionKey",19,()=>Rt()?"Meta":"Control"),i=R(t,"deleteKey",3,"Backspace"),s=R(t,"panActivationKey",3," "),l=R(t,"zoomActivationKey",19,()=>Rt()?"Meta":"Control"),{deleteElements:d}=kd();function c(p){return p!==null&&typeof p=="object"}function u(p){return c(p)?p.modifier||[]:[]}function h(p){return p==null?"":c(p)?p.key:p}function f(p,S){return(Array.isArray(p)?p:[p]).map(P=>{const M=h(P);return{key:M,modifier:u(P),enabled:M!==null,callback:S}})}function y(){n(n().selectionRect=null,!0),n(n().selectionKeyPressed=!1,!0),n(n().multiselectionKeyPressed=!1,!0),n(n().deleteKeyPressed=!1,!0),n(n().panActivationKeyPressed=!1,!0),n(n().zoomActivationKeyPressed=!1,!0)}function w(){const p=n().nodes.filter(C=>C.selected),S=n().edges.filter(C=>C.selected);d({nodes:p,edges:S})}ln("blur",Se,y),ln("contextmenu",Se,y),pe(Se,(p,S)=>Ie?.(p,S),()=>({trigger:f(o(),()=>n(n().selectionKeyPressed=!0,!0)),type:"keydown"})),pe(Se,(p,S)=>Ie?.(p,S),()=>({trigger:f(o(),()=>n(n().selectionKeyPressed=!1,!0)),type:"keyup"})),pe(Se,(p,S)=>Ie?.(p,S),()=>({trigger:f(r(),()=>{n(n().multiselectionKeyPressed=!0,!0)}),type:"keydown"})),pe(Se,(p,S)=>Ie?.(p,S),()=>({trigger:f(r(),()=>n(n().multiselectionKeyPressed=!1,!0)),type:"keyup"})),pe(Se,(p,S)=>Ie?.(p,S),()=>({trigger:f(i(),p=>{!(p.originalEvent.ctrlKey||p.originalEvent.metaKey||p.originalEvent.shiftKey)&&!ti(p.originalEvent)&&(n(n().deleteKeyPressed=!0,!0),w())}),type:"keydown"})),pe(Se,(p,S)=>Ie?.(p,S),()=>({trigger:f(i(),()=>n(n().deleteKeyPressed=!1,!0)),type:"keyup"})),pe(Se,(p,S)=>Ie?.(p,S),()=>({trigger:f(s(),()=>n(n().panActivationKeyPressed=!0,!0)),type:"keydown"})),pe(Se,(p,S)=>Ie?.(p,S),()=>({trigger:f(s(),()=>n(n().panActivationKeyPressed=!1,!0)),type:"keyup"})),pe(Se,(p,S)=>Ie?.(p,S),()=>({trigger:f(l(),()=>n(n().zoomActivationKeyPressed=!0,!0)),type:"keydown"})),pe(Se,(p,S)=>Ie?.(p,S),()=>({trigger:f(l(),()=>n(n().zoomActivationKeyPressed=!1,!0)),type:"keyup"})),re()}var Ed=he('<path fill="none" class="svelte-flow__connection-path"></path>'),Cd=he('<svg class="svelte-flow__connectionline"><g><!></g></svg>');function Nd(e,t){oe(t,!0);let n=m(()=>{if(!t.store.connection.inProgress)return"";const s={sourceX:t.store.connection.from.x,sourceY:t.store.connection.from.y,sourcePosition:t.store.connection.fromPosition,targetX:t.store.connection.to.x,targetY:t.store.connection.to.y,targetPosition:t.store.connection.toPosition};switch(t.type){case Xe.Bezier:{const[l]=oi(s);return l}case Xe.Straight:{const[l]=ii(s);return l}case Xe.Step:case Xe.SmoothStep:{const[l]=xo({...s,borderRadius:t.type===Xe.Step?0:void 0});return l}}});var o=me(),r=ae(o);{var i=s=>{var l=Cd(),d=j(l),c=j(d);{var u=f=>{var y=me(),w=ae(y);kn(w,()=>t.LineComponent,(p,S)=>{S(p,{})}),K(f,y)},h=f=>{var y=Ed();le(()=>{J(y,"d",a(n)),Ne(y,t.style)}),K(f,y)};se(c,f=>{t.LineComponent?f(u):f(h,!1)})}U(d),U(l),le(f=>{J(l,"width",t.store.width),J(l,"height",t.store.height),Ne(l,t.containerStyle),Ue(d,0,f)},[()=>lt(["svelte-flow__connection",Ec(t.store.connection.isValid)])]),K(s,l)};se(r,s=>{t.store.connection.inProgress&&s(i)})}K(e,o),re()}var Pd=ie("<div><!></div>");function So(e,t){oe(t,!0);let n=R(t,"position",3,"top-right"),o=qe(t,["$$slots","$$events","$$legacy","position","style","class","children"]),r=m(()=>`${n()}`.split("-"));var i=Pd();Ge(i,l=>({class:l,style:t.style,...o}),[()=>["svelte-flow__panel",t.class,...a(r)]]);var s=j(i);Ce(s,()=>t.children??bt),U(i),K(e,i),re()}var Md=ie('<a href="https://svelteflow.dev" target="_blank" rel="noopener noreferrer" aria-label="Svelte Flow attribution">Svelte Flow</a>');function zd(e,t){oe(t,!0);let n=R(t,"position",3,"bottom-right");var o=me(),r=ae(o);{var i=s=>{So(s,{get position(){return n()},class:"svelte-flow__attribution","data-message":"Feel free to remove the attribution or check out how you could support us: https://svelteflow.dev/support-us",children:(l,d)=>{var c=Md();K(l,c)},$$slots:{default:!0}})};se(r,s=>{t.proOptions?.hideAttribution||s(i)})}K(e,o),re()}var Ad=ie("<div><!></div>");function Dd(e,t){oe(t,!0);let n=R(t,"domNode",15),o=R(t,"clientWidth",15),r=R(t,"clientHeight",15),i=m(()=>t.rest.class),s=m(()=>Di(t.rest,["id","class","nodeTypes","edgeTypes","colorMode","isValidConnection","onmove","onmovestart","onmoveend","onflowerror","ondelete","onbeforedelete","onbeforeconnect","onconnect","onconnectstart","onconnectend","onbeforereconnect","onreconnect","onreconnectstart","onreconnectend","onclickconnectstart","onclickconnectend","oninit","onselectionchange","onselectiondragstart","onselectiondrag","onselectiondragstop","onselectionstart","onselectionend","clickConnect","fitView","fitViewOptions","nodeOrigin","nodeDragThreshold","connectionDragThreshold","minZoom","maxZoom","initialViewport","connectionRadius","connectionMode","selectionMode","selectNodesOnDrag","snapGrid","defaultMarkerColor","translateExtent","nodeExtent","onlyRenderVisibleElements","autoPanOnConnect","autoPanOnNodeDrag","colorModeSSR","defaultEdgeOptions","elevateNodesOnSelect","elevateEdgesOnSelect","nodesDraggable","autoPanOnNodeFocus","nodesConnectable","elementsSelectable","nodesFocusable","edgesFocusable","disableKeyboardA11y","noDragClass","noPanClass","noWheelClass","ariaLabelConfig","autoPanSpeed","panOnScrollSpeed"]));function l(u){u.currentTarget.scrollTo({top:0,left:0,behavior:"auto"}),t.rest.onscroll&&t.rest.onscroll(u)}var d=Ad();Ge(d,u=>({class:["svelte-flow","svelte-flow__container",a(i),t.colorMode],"data-testid":"svelte-flow__wrapper",role:"application",onscroll:l,...a(s),[_n]:u}),[()=>({width:He(t.width),height:He(t.height)})],void 0,void 0,"svelte-mkap6j");var c=j(d);Ce(c,()=>t.children??bt),U(d),Kt(d,u=>n(u),()=>n()),No(d,"clientHeight",r),No(d,"clientWidth",o),K(e,d),re()}var Id=ie('<div class="svelte-flow__viewport-back svelte-flow__container"></div> <!> <div class="svelte-flow__edge-labels svelte-flow__container"></div> <!> <!> <!> <div class="svelte-flow__viewport-front svelte-flow__container"></div>',1),Td=ie("<!> <!>",1),Od=ie("<!> <!> <!> <!> <!>",1);function Nf(e,t){oe(t,!0);let n=R(t,"paneClickDistance",3,1),o=R(t,"nodeClickDistance",3,1),r=R(t,"panOnScrollMode",19,()=>gt.Free),i=R(t,"preventScrolling",3,!0),s=R(t,"zoomOnScroll",3,!0),l=R(t,"zoomOnDoubleClick",3,!0),d=R(t,"zoomOnPinch",3,!0),c=R(t,"panOnScroll",3,!1),u=R(t,"panOnScrollSpeed",3,.5),h=R(t,"panOnDrag",3,!0),f=R(t,"selectionOnDrag",3,!1),y=R(t,"connectionLineType",19,()=>Xe.Bezier),w=R(t,"nodes",31,()=>Eo([])),p=R(t,"edges",31,()=>Eo([])),S=R(t,"viewport",15,void 0),C=qe(t,["$$slots","$$events","$$legacy","width","height","proOptions","selectionKey","deleteKey","panActivationKey","multiSelectionKey","zoomActivationKey","paneClickDistance","nodeClickDistance","onmovestart","onmoveend","onmove","oninit","onnodeclick","onnodecontextmenu","onnodedrag","onnodedragstart","onnodedragstop","onnodepointerenter","onnodepointermove","onnodepointerleave","onselectionclick","onselectioncontextmenu","onselectionstart","onselectionend","onedgeclick","onedgecontextmenu","onedgepointerenter","onedgepointerleave","onpaneclick","onpanecontextmenu","panOnScrollMode","preventScrolling","zoomOnScroll","zoomOnDoubleClick","zoomOnPinch","panOnScroll","panOnScrollSpeed","panOnDrag","selectionOnDrag","connectionLineComponent","connectionLineStyle","connectionLineContainerStyle","connectionLineType","attributionPosition","children","nodes","edges","viewport"]),P=qu({props:C,width:t.width,height:t.height,get nodes(){return w()},set nodes(_){w(_)},get edges(){return p()},set edges(_){p(_)},get viewport(){return S()},set viewport(_){S(_)}});const M=zt(ro);M&&M.setStore&&M.setStore(P),an(ro,{provider:!1,getStore(){return P}}),rt(()=>{const _={nodes:P.selectedNodes,edges:P.selectedEdges};et(()=>t.onselectionchange)?.(_);for(const V of P.selectionChangeHandlers.values())V(_)}),io(()=>{P.reset()}),Dd(e,{get colorMode(){return P.colorMode},get width(){return t.width},get height(){return t.height},get rest(){return C},get domNode(){return P.domNode},set domNode(_){P.domNode=_},get clientWidth(){return P.width},set clientWidth(_){P.width=_},get clientHeight(){return P.height},set clientHeight(_){P.height=_},children:(_,V)=>{var T=Od(),L=ae(T);Sd(L,{get selectionKey(){return t.selectionKey},get deleteKey(){return t.deleteKey},get panActivationKey(){return t.panActivationKey},get multiSelectionKey(){return t.multiSelectionKey},get zoomActivationKey(){return t.zoomActivationKey},get store(){return P},set store(v){P=v}});var A=ne(L,2);Qu(A,{get panOnScrollMode(){return r()},get preventScrolling(){return i()},get zoomOnScroll(){return s()},get zoomOnDoubleClick(){return l()},get zoomOnPinch(){return d()},get panOnScroll(){return c()},get panOnScrollSpeed(){return u()},get panOnDrag(){return h()},get paneClickDistance(){return n()},get selectionOnDrag(){return f()},get onmovestart(){return t.onmovestart},get onmove(){return t.onmove},get onmoveend(){return t.onmoveend},get oninit(){return t.oninit},get store(){return P},set store(v){P=v},children:(v,E)=>{ju(v,{get onpaneclick(){return t.onpaneclick},get onpanecontextmenu(){return t.onpanecontextmenu},get onselectionstart(){return t.onselectionstart},get onselectionend(){return t.onselectionend},get panOnDrag(){return h()},get paneClickDistance(){return n()},get selectionOnDrag(){return f()},get store(){return P},set store(g){P=g},children:(g,b)=>{var x=Td(),N=ae(x);ed(N,{get store(){return P},set store(z){P=z},children:(z,I)=>{var O=Id(),X=ne(ae(O),2);wd(X,{get onedgeclick(){return t.onedgeclick},get onedgecontextmenu(){return t.onedgecontextmenu},get onedgepointerenter(){return t.onedgepointerenter},get onedgepointerleave(){return t.onedgepointerleave},get store(){return P},set store(Y){P=Y}});var F=ne(X,4);Nd(F,{get type(){return y()},get LineComponent(){return t.connectionLineComponent},get containerStyle(){return t.connectionLineContainerStyle},get style(){return t.connectionLineStyle},get store(){return P},set store(Y){P=Y}});var Z=ne(F,2);ld(Z,{get nodeClickDistance(){return o()},get onnodeclick(){return t.onnodeclick},get onnodecontextmenu(){return t.onnodecontextmenu},get onnodepointerenter(){return t.onnodepointerenter},get onnodepointermove(){return t.onnodepointermove},get onnodepointerleave(){return t.onnodepointerleave},get onnodedrag(){return t.onnodedrag},get onnodedragstart(){return t.onnodedragstart},get onnodedragstop(){return t.onnodedragstop},get store(){return P},set store(Y){P=Y}});var q=ne(Z,2);bd(q,{get onselectionclick(){return t.onselectionclick},get onselectioncontextmenu(){return t.onselectioncontextmenu},get onnodedrag(){return t.onnodedrag},get onnodedragstart(){return t.onnodedragstart},get onnodedragstop(){return t.onnodedragstop},get store(){return P},set store(Y){P=Y}}),Bt(2),K(z,O)},$$slots:{default:!0}});var D=ne(N,2);{let z=m(()=>!!(P.selectionRect&&P.selectionRectMode==="user")),I=m(()=>P.selectionRect?.width),O=m(()=>P.selectionRect?.height),X=m(()=>P.selectionRect?.x),F=m(()=>P.selectionRect?.y);_i(D,{get isVisible(){return a(z)},get width(){return a(I)},get height(){return a(O)},get x(){return a(X)},get y(){return a(F)}})}K(g,x)},$$slots:{default:!0}})},$$slots:{default:!0}});var B=ne(A,2);zd(B,{get proOptions(){return t.proOptions},get position(){return t.attributionPosition}});var W=ne(B,2);od(W,{get store(){return P}});var k=ne(W,2);Ce(k,()=>t.children??bt),K(_,T)},$$slots:{default:!0}}),re()}var Hd=ie("<button><!></button>");function en(e,t){let n=qe(t,["$$slots","$$events","$$legacy","class","bgColor","bgColorHover","color","colorHover","borderColor","onclick","children"]);var o=Hd();Ge(o,()=>({type:"button",onclick:t.onclick,class:["svelte-flow__controls-button",t.class],...n,[_n]:{"--xy-controls-button-background-color-props":t.bgColor,"--xy-controls-button-background-color-hover-props":t.bgColorHover,"--xy-controls-button-color-props":t.color,"--xy-controls-button-color-hover-props":t.colorHover,"--xy-controls-button-border-color-props":t.borderColor}}));var r=j(o);Ce(r,()=>t.children??bt),U(o),K(e,o)}var Rd=he('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"><path d="M32 18.133H18.133V32h-4.266V18.133H0v-4.266h13.867V0h4.266v13.867H32z"></path></svg>');function Vd(e){var t=Rd();K(e,t)}var Ld=he('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 5"><path d="M0 0h32v4.2H0z"></path></svg>');function Bd(e){var t=Ld();K(e,t)}var Kd=he('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 30"><path d="M3.692 4.63c0-.53.4-.938.939-.938h5.215V0H4.708C2.13 0 0 2.054 0 4.63v5.216h3.692V4.631zM27.354 0h-5.2v3.692h5.17c.53 0 .984.4.984.939v5.215H32V4.631A4.624 4.624 0 0027.354 0zm.954 24.83c0 .532-.4.94-.939.94h-5.215v3.768h5.215c2.577 0 4.631-2.13 4.631-4.707v-5.139h-3.692v5.139zm-23.677.94c-.531 0-.939-.4-.939-.94v-5.138H0v5.139c0 2.577 2.13 4.707 4.708 4.707h5.138V25.77H4.631z"></path></svg>');function Zd(e){var t=Kd();K(e,t)}var Fd=he('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 25 32"><path d="M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0 8 0 4.571 3.429 4.571 7.619v3.048H3.048A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047zm4.724-13.866H7.467V7.619c0-2.59 2.133-4.724 4.723-4.724 2.591 0 4.724 2.133 4.724 4.724v3.048z"></path></svg>');function Yd(e){var t=Fd();K(e,t)}var Xd=he('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 25 32"><path d="M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0c-4.114 1.828-1.37 2.133.305 2.438 1.676.305 4.42 2.59 4.42 5.181v3.048H3.047A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047z"></path></svg>');function Wd(e){var t=Xd();K(e,t)}var qd=ie("<!> <!>",1),Gd=ie("<!> <!> <!> <!> <!> <!>",1);function Pf(e,t){oe(t,!0);let n=R(t,"position",3,"bottom-left"),o=R(t,"orientation",3,"vertical"),r=R(t,"showZoom",3,!0),i=R(t,"showFitView",3,!0),s=R(t,"showLock",3,!0),l=qe(t,["$$slots","$$events","$$legacy","position","orientation","showZoom","showFitView","showLock","style","class","buttonBgColor","buttonBgColorHover","buttonColor","buttonColorHover","buttonBorderColor","fitViewOptions","children","before","after"]),d=m(Je);const c={bgColor:t.buttonBgColor,bgColorHover:t.buttonBgColorHover,color:t.buttonColor,colorHover:t.buttonColorHover,borderColor:t.buttonBorderColor};let u=m(()=>a(d).nodesDraggable||a(d).nodesConnectable||a(d).elementsSelectable),h=m(()=>a(d).viewport.zoom<=a(d).minZoom),f=m(()=>a(d).viewport.zoom>=a(d).maxZoom),y=m(()=>a(d).ariaLabelConfig),w=m(()=>o()==="horizontal"?"horizontal":"vertical");const p=()=>{a(d).zoomIn()},S=()=>{a(d).zoomOut()},C=()=>{a(d).fitView(t.fitViewOptions)},P=()=>{let M=!a(u);a(d).nodesDraggable=M,a(d).nodesConnectable=M,a(d).elementsSelectable=M};{let M=m(()=>["svelte-flow__controls",a(w),t.class]);So(e,Ye({get class(){return a(M)},get position(){return n()},"data-testid":"svelte-flow__controls",get"aria-label"(){return a(y)["controls.ariaLabel"]},get style(){return t.style}},()=>l,{children:(_,V)=>{var T=Gd(),L=ae(T);{var A=z=>{var I=me(),O=ae(I);Ce(O,()=>t.before),K(z,I)};se(L,z=>{t.before&&z(A)})}var B=ne(L,2);{var W=z=>{var I=qd(),O=ae(I);en(O,Ye({onclick:p,class:"svelte-flow__controls-zoomin",get title(){return a(y)["controls.zoomIn.ariaLabel"]},get"aria-label"(){return a(y)["controls.zoomIn.ariaLabel"]},get disabled(){return a(f)}},()=>c,{children:(F,Z)=>{Vd(F)},$$slots:{default:!0}}));var X=ne(O,2);en(X,Ye({onclick:S,class:"svelte-flow__controls-zoomout",get title(){return a(y)["controls.zoomOut.ariaLabel"]},get"aria-label"(){return a(y)["controls.zoomOut.ariaLabel"]},get disabled(){return a(h)}},()=>c,{children:(F,Z)=>{Bd(F)},$$slots:{default:!0}})),K(z,I)};se(B,z=>{r()&&z(W)})}var k=ne(B,2);{var v=z=>{en(z,Ye({class:"svelte-flow__controls-fitview",onclick:C,get title(){return a(y)["controls.fitView.ariaLabel"]},get"aria-label"(){return a(y)["controls.fitView.ariaLabel"]}},()=>c,{children:(I,O)=>{Zd(I)},$$slots:{default:!0}}))};se(k,z=>{i()&&z(v)})}var E=ne(k,2);{var g=z=>{en(z,Ye({class:"svelte-flow__controls-interactive",onclick:P,get title(){return a(y)["controls.interactive.ariaLabel"]},get"aria-label"(){return a(y)["controls.interactive.ariaLabel"]}},()=>c,{children:(I,O)=>{var X=me(),F=ae(X);{var Z=Y=>{Wd(Y)},q=Y=>{Yd(Y)};se(F,Y=>{a(u)?Y(Z):Y(q,!1)})}K(I,X)},$$slots:{default:!0}}))};se(E,z=>{s()&&z(g)})}var b=ne(E,2);{var x=z=>{var I=me(),O=ae(I);Ce(O,()=>t.children),K(z,I)};se(b,z=>{t.children&&z(x)})}var N=ne(b,2);{var D=z=>{var I=me(),O=ae(I);Ce(O,()=>t.after),K(z,I)};se(N,z=>{t.after&&z(D)})}K(_,T)},$$slots:{default:!0}}))}re()}var We;(function(e){e.Lines="lines",e.Dots="dots",e.Cross="cross"})(We||(We={}));var Ud=he("<circle></circle>");function Qd(e,t){var n=Ud();le(()=>{J(n,"cx",t.radius),J(n,"cy",t.radius),J(n,"r",t.radius),Ue(n,0,lt(["svelte-flow__background-pattern","dots",t.class]))}),K(e,n)}var Jd=he("<path></path>");function jd(e,t){oe(t,!0);var n=Jd();le(()=>{J(n,"stroke-width",t.lineWidth),J(n,"d",`M${t.dimensions[0]/2} 0 V${t.dimensions[1]} M0 ${t.dimensions[1]/2} H${t.dimensions[0]}`),Ue(n,0,lt(["svelte-flow__background-pattern",t.variant,t.class]))}),K(e,n),re()}const $d={[We.Dots]:1,[We.Lines]:1,[We.Cross]:6};var ef=he('<svg data-testid="svelte-flow__background"><pattern patternUnits="userSpaceOnUse"><!></pattern><rect x="0" y="0" width="100%" height="100%"></rect></svg>');function Mf(e,t){oe(t,!0);let n=R(t,"variant",19,()=>We.Dots),o=R(t,"gap",3,20),r=R(t,"lineWidth",3,1),i=m(Je),s=m(()=>n()===We.Dots),l=m(()=>n()===We.Cross),d=m(()=>Array.isArray(o())?o():[o(),o()]),c=m(()=>`background-pattern-${a(i).flowId}-${t.id??""}`),u=m(()=>[a(d)[0]*a(i).viewport.zoom||1,a(d)[1]*a(i).viewport.zoom||1]),h=m(()=>(t.size??$d[n()])*a(i).viewport.zoom),f=m(()=>a(l)?[a(h),a(h)]:a(u)),y=m(()=>a(s)?[a(h)/2,a(h)/2]:[a(f)[0]/2,a(f)[1]/2]);var w=ef();let p;var S=j(w),C=j(S);{var P=V=>{{let T=m(()=>a(h)/2);Qd(V,{get radius(){return a(T)},get class(){return t.patternClass}})}},M=V=>{jd(V,{get dimensions(){return a(f)},get variant(){return n()},get lineWidth(){return r()},get class(){return t.patternClass}})};se(C,V=>{a(s)?V(P):V(M,!1)})}U(S);var _=ne(S);U(w),le(()=>{Ue(w,0,lt(["svelte-flow__background","svelte-flow__container",t.class])),p=Ne(w,"",p,{"--xy-background-color-props":t.bgColor,"--xy-background-pattern-color-props":t.patternColor}),J(S,"id",a(c)),J(S,"x",a(i).viewport.x%a(u)[0]),J(S,"y",a(i).viewport.y%a(u)[1]),J(S,"width",a(u)[0]),J(S,"height",a(u)[1]),J(S,"patternTransform",`translate(-${a(y)[0]},-${a(y)[1]})`),J(_,"fill",`url(#${a(c)})`)}),K(e,w),re()}var tf=he("<rect></rect>");function nf(e,t){let n=R(t,"borderRadius",3,5),o=R(t,"strokeWidth",3,2);var r=me(),i=ae(r);{var s=d=>{const c=m(()=>t.nodeComponent);var u=me(),h=ae(u);kn(h,()=>a(c),(f,y)=>{y(f,{get id(){return t.id},get x(){return t.x},get y(){return t.y},get width(){return t.width},get height(){return t.height},get borderRadius(){return n()},get class(){return t.class},get color(){return t.color},get shapeRendering(){return t.shapeRendering},get strokeColor(){return t.strokeColor},get strokeWidth(){return o()},get selected(){return t.selected}})}),K(d,u)},l=d=>{var c=tf();let u,h;le(()=>{u=Ue(c,0,lt(["svelte-flow__minimap-node",t.class]),null,u,{selected:t.selected}),J(c,"x",t.x),J(c,"y",t.y),J(c,"rx",n()),J(c,"ry",n()),J(c,"width",t.width),J(c,"height",t.height),J(c,"shape-rendering",t.shapeRendering),h=Ne(c,"",h,{fill:t.color,stroke:t.strokeColor,"stroke-width":o()})}),K(d,c)};se(i,d=>{t.nodeComponent?d(s):d(l,!1)})}K(e,r)}function of(e,t){const n=gu({domNode:e,panZoom:t.panZoom,getTransform:()=>{const{viewport:r}=t.store;return[r.x,r.y,r.zoom]},getViewScale:t.getViewScale});n.update({translateExtent:t.translateExtent,width:t.width,height:t.height,inversePan:t.inversePan,zoomStep:t.zoomStep,pannable:t.pannable,zoomable:t.zoomable});function o(r){n.update({translateExtent:r.translateExtent,width:r.width,height:r.height,inversePan:r.inversePan,zoomStep:r.zoomStep,pannable:r.pannable,zoomable:r.zoomable})}return{update:o,destroy(){n.destroy()}}}const Fn=e=>e instanceof Function?e:()=>e;var rf=he("<title> </title>"),sf=he('<svg class="svelte-flow__minimap-svg" role="img"><!><!><path class="svelte-flow__minimap-mask" fill-rule="evenodd" pointer-events="none"></path></svg>'),af=ie('<svelte-css-wrapper style="display: contents"><!></svelte-css-wrapper>',1);function zf(e,t){oe(t,!0);let n=R(t,"position",3,"bottom-right"),o=R(t,"nodeStrokeColor",3,"transparent"),r=R(t,"nodeClass",3,""),i=R(t,"nodeBorderRadius",3,5),s=R(t,"nodeStrokeWidth",3,2),l=R(t,"width",3,200),d=R(t,"height",3,150),c=R(t,"pannable",3,!0),u=R(t,"zoomable",3,!0),h=qe(t,["$$slots","$$events","$$legacy","position","ariaLabel","nodeStrokeColor","nodeColor","nodeClass","nodeBorderRadius","nodeStrokeWidth","nodeComponent","bgColor","maskColor","maskStrokeColor","maskStrokeWidth","width","height","pannable","zoomable","inversePan","zoomStep","class"]),f=m(Je),y=m(()=>a(f).ariaLabelConfig);const w=t.nodeColor===void 0?void 0:Fn(t.nodeColor),p=Fn(o()),S=Fn(r()),C=typeof window>"u"||window.chrome?"crispEdges":"geometricPrecision";let P=m(()=>`svelte-flow__minimap-desc-${a(f).flowId}`),M=m(()=>({x:-a(f).viewport.x/a(f).viewport.zoom,y:-a(f).viewport.y/a(f).viewport.zoom,width:a(f).width/a(f).viewport.zoom,height:a(f).height/a(f).viewport.zoom})),_=m(()=>Jr(Xt(a(f).nodeLookup,{filter:D=>!D.hidden}),a(M))),V=m(()=>a(_).width/l()),T=m(()=>a(_).height/d()),L=m(()=>Math.max(a(V),a(T))),A=m(()=>a(L)*l()),B=m(()=>a(L)*d()),W=m(()=>5*a(L)),k=m(()=>a(_).x-(a(A)-a(_).width)/2-a(W)),v=m(()=>a(_).y-(a(B)-a(_).height)/2-a(W)),E=m(()=>a(A)+a(W)*2),g=m(()=>a(B)+a(W)*2);const b=()=>a(L);var x=af(),N=ae(x);{let D=m(()=>["svelte-flow__minimap",t.class]);Bi(N,()=>({"--xy-minimap-background-color-props":t.bgColor})),So(N.lastChild,Ye({get position(){return n()},get class(){return a(D)},"data-testid":"svelte-flow__minimap"},()=>h,{children:(z,I)=>{var O=me(),X=ae(O);{var F=Z=>{var q=sf();let Y;var G=j(q);{var Q=ee=>{var de=rf(),te=j(de,!0);U(de),le(()=>{J(de,"id",a(P)),xe(te,t.ariaLabel??a(y)["minimap.ariaLabel"])}),K(ee,de)};se(G,ee=>{(t.ariaLabel??a(y)["minimap.ariaLabel"])&&ee(Q)})}var ue=ne(G);nt(ue,17,()=>a(f).nodes,ee=>ee.id,(ee,de)=>{const te=m(()=>a(f).nodeLookup.get(a(de).id));var be=me(),Ze=ae(be);{var je=De=>{const ce=m(()=>Qe(a(te)));{let ye=m(()=>w?.(a(te))),Fe=m(()=>p(a(te))),fe=m(()=>S(a(te)));nf(De,Ye({get id(){return a(te).id},get x(){return a(te).internals.positionAbsolute.x},get y(){return a(te).internals.positionAbsolute.y}},()=>a(ce),{get selected(){return a(te).selected},get nodeComponent(){return t.nodeComponent},get color(){return a(ye)},get borderRadius(){return i()},get strokeColor(){return a(Fe)},get strokeWidth(){return s()},get shapeRendering(){return C},get class(){return a(fe)}}))}};se(Ze,De=>{a(te)&&jr(a(te))&&!a(te).hidden&&De(je)})}K(ee,be)});var ve=ne(ue);U(q),pe(q,(ee,de)=>of?.(ee,de),()=>({store:a(f),panZoom:a(f).panZoom,getViewScale:b,translateExtent:a(f).translateExtent,width:a(f).width,height:a(f).height,inversePan:t.inversePan,zoomStep:t.zoomStep,pannable:c(),zoomable:u()})),le(()=>{J(q,"width",l()),J(q,"height",d()),J(q,"viewBox",`${a(k)??""} ${a(v)??""} ${a(E)??""} ${a(g)??""}`),J(q,"aria-labelledby",a(P)),Y=Ne(q,"",Y,{"--xy-minimap-mask-background-color-props":t.maskColor,"--xy-minimap-mask-stroke-color-props":t.maskStrokeColor,"--xy-minimap-mask-stroke-width-props":t.maskStrokeWidth?t.maskStrokeWidth*a(L):void 0}),J(ve,"d",`M${a(k)-a(W)},${a(v)-a(W)}h${a(E)+a(W)*2}v${a(g)+a(W)*2}h${-a(E)-a(W)*2}z
      M${a(M).x??""},${a(M).y??""}h${a(M).width??""}v${a(M).height??""}h${-a(M).width}z`)}),K(Z,q)};se(X,Z=>{a(f).panZoom&&Z(F)})}K(z,O)},$$slots:{default:!0}})),U(N)}K(e,x),re()}var lf=ie('<span class="text-gray-500 ml-2 text-xs"> </span>'),cf=ie('<li class="px-3 py-1.5 text-sm pl-6"><span class="font-mono text-gray-700"> </span></li>'),uf=ie('<div class="border-b border-gray-200 last:border-b-0"><div class="px-3 py-2 bg-gray-50"><span class="font-medium text-gray-900"> </span> <!> <span class="text-gray-500 text-xs ml-2"> </span></div> <ul class="divide-y divide-gray-100"></ul></div>'),df=ie('<div class="mb-6 max-h-64 overflow-y-auto border border-gray-200 rounded-md"></div>'),ff=ie('<li class="px-3 py-2 text-sm"><span class="font-medium text-gray-900 font-mono"> </span></li>'),hf=ie('<div class="mb-6 max-h-48 overflow-y-auto border border-gray-200 rounded-md"><ul class="divide-y divide-gray-200"></ul></div>'),gf=ie('<div class="fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center backdrop-blur-sm" role="dialog" tabindex="-1" aria-modal="true" aria-labelledby="warning-modal-title"><div class="bg-white rounded-lg shadow-xl p-8 max-w-lg w-full mx-4" role="document" tabindex="-1" aria-label="Warning about attributes without descriptions"><div class="flex items-start gap-3 mb-6"><div class="flex-shrink-0"><!></div> <div class="flex-1"><h2 id="warning-modal-title" class="text-xl font-semibold text-gray-900 mb-3">⚠️ Attributes Without Descriptions</h2> <p class="text-sm text-gray-600 mb-6"><!> They will be saved without descriptions.</p></div></div> <!> <div class="flex justify-end gap-4"><button class="px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500">Cancel</button> <button class="px-4 py-2 text-sm font-medium text-white bg-amber-600 rounded-md hover:bg-amber-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-amber-500">Continue Anyway</button></div></div></div>');function Af(e,t){oe(t,!0);let n=m(()=>!!t.entitiesWithAttributes&&t.entitiesWithAttributes.length>0),o=m(()=>a(n)?t.entitiesWithAttributes.reduce((u,h)=>u+h.attributeNames.length,0):t.attributeNames?.length||0);function r(u){u.key==="Escape"&&t.onCancel()}function i(u){u.target===u.currentTarget&&t.onCancel()}function s(){t.onConfirm()}var l=me(),d=ae(l);{var c=u=>{var h=gf();h.__click=i,h.__keydown=r;var f=j(h),y=j(f),w=j(y),p=j(w);Ti(p,{icon:"lucide:alert-triangle",class:"w-6 h-6 text-amber-600"}),U(w);var S=ne(w,2),C=ne(j(S),2),P=j(C);{var M=k=>{var v=Yn();le(()=>xe(v,`${t.entitiesWithAttributes.length??""} ${t.entitiesWithAttributes.length===1?"entity has":"entities have"} ${a(o)??""} ${a(o)===1?"attribute":"attributes"} without descriptions.`)),K(k,v)},_=k=>{var v=Yn();le(()=>xe(v,`${a(o)??""} ${a(o)===1?"attribute is":"attributes are"} missing descriptions.`)),K(k,v)};se(P,k=>{a(n)?k(M):k(_,!1)})}Bt(),U(C),U(S),U(y);var V=ne(y,2);{var T=k=>{var v=df();nt(v,21,()=>t.entitiesWithAttributes,In,(E,g)=>{var b=uf(),x=j(b),N=j(x),D=j(N,!0);U(N);var z=ne(N,2);{var I=Z=>{var q=lf(),Y=j(q);U(q),le(()=>xe(Y,`(${a(g).entityId??""})`)),K(Z,q)};se(z,Z=>{a(g).entityId!==a(g).entityLabel&&Z(I)})}var O=ne(z,2),X=j(O);U(O),U(x);var F=ne(x,2);nt(F,21,()=>a(g).attributeNames,In,(Z,q)=>{var Y=cf(),G=j(Y),Q=j(G,!0);U(G),U(Y),le(()=>xe(Q,a(q))),K(Z,Y)}),U(F),U(b),le(()=>{xe(D,a(g).entityLabel),xe(X,`(${a(g).attributeNames.length??""} ${a(g).attributeNames.length===1?"attribute":"attributes"})`)}),K(E,b)}),U(v),K(k,v)},L=k=>{var v=me(),E=ae(v);{var g=b=>{var x=hf(),N=j(x);nt(N,21,()=>t.attributeNames,In,(D,z)=>{var I=ff(),O=j(I),X=j(O,!0);U(O),U(I),le(()=>xe(X,a(z))),K(D,I)}),U(N),U(x),K(b,x)};se(E,b=>{t.attributeNames&&t.attributeNames.length>0&&b(g)},!0)}K(k,v)};se(V,k=>{a(n)?k(T):k(L,!1)})}var A=ne(V,2),B=j(A);B.__click=function(...k){t.onCancel?.apply(this,k)};var W=ne(B,2);W.__click=s,U(A),U(f),U(h),K(u,h)};se(d,u=>{t.open&&u(c)})}K(e,l),re()}so(["click","keydown"]);export{Dn as B,Pf as C,Tu as E,xn as H,zf as M,$ as P,Nf as S,Af as U,Mf as a,We as b,Cf as p,kd as u};
