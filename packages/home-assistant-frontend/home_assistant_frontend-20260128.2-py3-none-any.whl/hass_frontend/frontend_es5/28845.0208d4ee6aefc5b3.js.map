{"version":3,"file":"28845.0208d4ee6aefc5b3.js","sources":["https://raw.githubusercontent.com/home-assistant/frontend/20260128.2/src/components/ha-assist-chat.ts","https://raw.githubusercontent.com/home-assistant/frontend/20260128.2/src/data/conversation.ts","https://raw.githubusercontent.com/home-assistant/frontend/20260128.2/src/util/audio-recorder.ts"],"names":["HaAssistChat","LitElement","willUpdate","changedProperties","this","hasUpdated","has","_conversation","who","text","hass","localize","firstUpdated","super","startListening","pipeline","stt_engine","AudioRecorder","_toggleListening","setTimeout","_messageInput","focus","updated","changedProps","_scrollMessagesBottom","disconnectedCallback","_this$_audioRecorder","_audioRecorder","close","_unloadAudio","render","_this$pipeline","_this$_audioRecorder2","controlHA","prefer_local_intents","states","conversation_engine","supportsFeature","ConversationEntityFeature","supportsMicrophone","supportsSTT","disableSpeech","html","_t","_","nothing","_t2","map","message","_t3","classMap","error","_handleKeyUp","_handleInput","_showSendButton","_t4","_handleSendMessage","_processing","_t5","active","_t6","_handleListeningButton","_t7","lastChatMessage","_lastChatMessage","updateComplete","_lastChatMessageImage","naturalHeight","decode","err","console","warn","getBoundingClientRect","y","top","scrollIntoView","behavior","block","ev","input","target","key","value","_processText","trim","stopPropagation","preventDefault","_this$_audioRecorder3","_stopListening","_startListening","_showNotSupportedMessage","_addMessage","_t8","documentation_link","_t9","documentationUrl","audio","_audioBuffer","push","_sendAudioChunk","_stt_binary_handler_id","undefined","userMessage","start","hassMessageProcesser","_createAddHassMessageProcessor","_this$pipeline2","_this$pipeline3","unsub","runAssistPipeline","event","type","data","runner_data","stt_binary_handler_id","_audio","Audio","tts_output","url","play","addEventListener","continueConversation","_this$_audio","showAlertDialog","title","buffer","stt_output","requestUpdate","addMessage","startsWith","processEvent","setError","start_stage","end_stage","tts_engine","sample_rate","sampleRate","id","conversation_id","_conversationId","_this$_audioRecorder4","stop","chunk","Int16Array","connection","socket","binaryType","Uint8Array","length","set","send","_this$pipeline4","_unused","currentDeltaRole","progressToNextMessage","progress","hassMessage","substring","tools","chat_log_delta","delta","role","content","tool_calls","toolCall","tool_call_id","_event$data$intent_ou","intent_output","continue_conversation","response","speech","plain","response_type","args","pause","removeAttribute","styles","css","_t0","attribute","Boolean","listAgents","language","country","callWS","debugAgent","sentences","device_id","ensureArray","getLanguageScores","_active","_this$_context","_context","isSupported","window","isSecureContext","AudioContext","webkitAudioContext","_stream","_source","_recorder","getTracks","enabled","resume","_createContext","_this$_context2","suspend","_this$_stream","_this$_source","_this$_context3","port","onmessage","disconnect","context","navigator","mediaDevices","getUserMedia","audioWorklet","addModule","URL","createMediaStreamSource","AudioWorkletNode","e","_callback","connect","constructor","callback"],"mappings":"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"}