export const __rspack_esm_id="44619";export const __rspack_esm_ids=["44619"];export const __webpack_modules__={84334(e,t,i){i.d(t,{H:()=>r,R:()=>s});const s=(e,t,i)=>e.subscribeMessage(e=>t(e),{type:"render_template",...i}),r=(e,t,i,s,r)=>e.connection.subscribeMessage(r,{type:"template/start_preview",flow_id:t,flow_type:i,user_input:s})},67334(e,t,i){i.r(t),i.d(t,{HuiMarkdownCard:()=>p});var s=i(62826),r=i(96196),o=i(44457),n=i(94333),a=i(30015),h=i.n(a),c=i(42372),d=i(1087),l=(i(38962),i(76776),i(3587),i(84334));const _=new(i(996).G)(1e3);class p extends r.WF{static async getConfigElement(){return await i.e("90742").then(i.bind(i,4757)),document.createElement("hui-markdown-card-editor")}static getStubConfig(){return{type:"markdown",content:"The **Markdown** card allows you to write any text. You can style it **bold**, *italicized*, ~strikethrough~ etc. You can do images, links, and more.\n\nFor more information see the [Markdown Cheatsheet](https://commonmark.org/help)."}}getCardSize(){return void 0===this._config?3:void 0===this._config.card_size?Math.round(this._config.content.split("\n").length/2)+(this._config.title?1:0):this._config.card_size}setConfig(e){if(!e.content)throw new Error("Content required");this._config?.content!==e.content&&this._tryDisconnect(),this._config=e}connectedCallback(){super.connectedCallback(),this._tryConnect()}_computeCacheKey(){return h()(this._config)}disconnectedCallback(){if(super.disconnectedCallback(),this._tryDisconnect(),this._config&&this._templateResult){const e=this._computeCacheKey();_.set(e,this._templateResult)}}willUpdate(e){if(super.willUpdate(e),this._config&&!this._templateResult){const e=this._computeCacheKey();_.has(e)&&(this._templateResult=_.get(e))}}render(){return this._config?r.qy` ${this._error?r.qy` <ha-alert .alertType="${this._errorLevel?.toLowerCase()||"error"}"> ${this._error} </ha-alert> `:r.s6} <ha-card .header="${this._config.text_only?void 0:this._config.title}" class="${(0,n.H)({"with-header":!!this._config.title,"text-only":this._config.text_only??!1})}"> <ha-markdown cache breaks .content="${this._templateResult?.result}"></ha-markdown> </ha-card> `:r.s6}updated(e){if(super.updated(e),!this._config||!this.hass)return;e.has("_config")&&this._tryConnect();const t=!!this._templateResult&&!1===this._config.show_empty&&0===this._templateResult.result.length;t!==this.hidden&&(this.style.display=t?"none":"",this.toggleAttribute("hidden",t),(0,d.r)(this,"card-visibility-changed",{value:!t}));const i=e.get("hass"),s=e.get("_config");i&&s&&i.themes===this.hass.themes&&s.theme===this._config.theme||(0,c.Q)(this,this.hass.themes,this._config.theme)}async _tryConnect(){if(void 0===this._unsubRenderTemplate&&this.hass&&this._config){this._error=void 0,this._errorLevel=void 0;try{this._unsubRenderTemplate=(0,l.R)(this.hass.connection,e=>{"error"in e?"ERROR"!==e.level&&"ERROR"===this._errorLevel||(this._error=e.error,this._errorLevel=e.level):this._templateResult=e},{template:this._config.content,entity_ids:this._config.entity_id,variables:{config:this._config,user:this.hass.user.name},strict:!0,report_errors:this.preview}),await this._unsubRenderTemplate}catch(e){this.preview&&(this._error=e.message,this._errorLevel=void 0),this._templateResult={result:this._config.content,listeners:{all:!1,domains:[],entities:[],time:!1}},this._unsubRenderTemplate=void 0}}}async _tryDisconnect(){this._unsubRenderTemplate&&(this._unsubRenderTemplate.then(e=>e()).catch(),this._unsubRenderTemplate=void 0,this._error=void 0,this._errorLevel=void 0)}constructor(...e){super(...e),this.preview=!1}}p.styles=r.AH`ha-card{height:100%;overflow-y:auto}ha-alert{margin-bottom:8px}ha-markdown{padding:16px;word-wrap:break-word;text-align:var(--card-text-align,inherit)}.with-header ha-markdown{padding:0 16px 16px}.text-only{background:0 0;box-shadow:none;border:none}.text-only ha-markdown{padding:2px 4px}`,(0,s.Cg)([(0,o.MZ)({attribute:!1})],p.prototype,"hass",void 0),(0,s.Cg)([(0,o.MZ)({type:Boolean})],p.prototype,"preview",void 0),(0,s.Cg)([(0,o.wk)()],p.prototype,"_config",void 0),(0,s.Cg)([(0,o.wk)()],p.prototype,"_error",void 0),(0,s.Cg)([(0,o.wk)()],p.prototype,"_errorLevel",void 0),(0,s.Cg)([(0,o.wk)()],p.prototype,"_templateResult",void 0),p=(0,s.Cg)([(0,o.EM)("hui-markdown-card")],p)}};
//# sourceMappingURL=44619.fd7ef7862fbb25be.js.map