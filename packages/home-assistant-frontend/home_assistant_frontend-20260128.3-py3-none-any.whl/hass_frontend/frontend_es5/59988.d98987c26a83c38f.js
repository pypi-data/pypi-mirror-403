"use strict";(self.webpackChunkhome_assistant_frontend=self.webpackChunkhome_assistant_frontend||[]).push([["59988"],{71938:function(t,i,e){e.a(t,async function(t,i){try{e(74423),e(18111),e(22489),e(61701),e(3362),e(62953);var s=e(40445),a=e(96196),n=e(77845),c=e(4937),o=e(1087),l=e(81423),r=t([l]);l=(r.then?(await r)():r)[0];let u,d,h,p,_=t=>t;class m extends a.WF{render(){if(!this.hass)return a.s6;const t=this.ignoreRestrictionsOnFirstStatistic&&this._currentStatistics.length<=1,i=t?void 0:this.includeStatisticsUnitOfMeasurement,e=t?void 0:this.includeUnitClass,s=t?void 0:this.includeDeviceClass,n=t?void 0:this.statisticTypes;return(0,a.qy)(u||(u=_` ${0} ${0} <div> <ha-statistic-picker .hass="${0}" .includeStatisticsUnitOfMeasurement="${0}" .includeUnitClass="${0}" .includeDeviceClass="${0}" .statisticTypes="${0}" .statisticIds="${0}" .placeholder="${0}" .excludeStatistics="${0}" .allowCustomEntity="${0}" @value-changed="${0}"></ha-statistic-picker> </div> `),this.label?(0,a.qy)(d||(d=_`<label>${0}</label>`),this.label):a.s6,(0,c.u)(this._currentStatistics,t=>t,t=>(0,a.qy)(h||(h=_` <div> <ha-statistic-picker .curValue="${0}" .hass="${0}" .includeStatisticsUnitOfMeasurement="${0}" .includeUnitClass="${0}" .includeDeviceClass="${0}" .value="${0}" .statisticTypes="${0}" .statisticIds="${0}" .excludeStatistics="${0}" .allowCustomEntity="${0}" @value-changed="${0}"></ha-statistic-picker> </div> `),t,this.hass,i,e,s,t,n,this.statisticIds,this.value,this.allowCustomEntity,this._statisticChanged)),this.hass,this.includeStatisticsUnitOfMeasurement,this.includeUnitClass,this.includeDeviceClass,this.statisticTypes,this.statisticIds,this.placeholder,this.value,this.allowCustomEntity,this._addStatistic)}get _currentStatistics(){return this.value||[]}async _updateStatistics(t){this.value=t,(0,o.r)(this,"value-changed",{value:t})}_statisticChanged(t){t.stopPropagation();const i=t.currentTarget.curValue,e=t.detail.value;if(e===i)return;const s=this._currentStatistics;e&&!s.includes(e)?this._updateStatistics(s.map(t=>t===i?e:t)):this._updateStatistics(s.filter(t=>t!==i))}async _addStatistic(t){t.stopPropagation();const i=t.detail.value;if(!i)return;if(t.currentTarget.value="",!i)return;const e=this._currentStatistics;e.includes(i)||this._updateStatistics([...e,i])}constructor(...t){super(...t),this.ignoreRestrictionsOnFirstStatistic=!1}}m.styles=(0,a.AH)(p||(p=_`:host{display:block}ha-statistic-picker{display:block;width:100%;margin-top:8px}label{display:block;margin-bottom:0 0 8px}`)),(0,s.Cg)([(0,n.MZ)({attribute:!1})],m.prototype,"hass",void 0),(0,s.Cg)([(0,n.MZ)({type:Array})],m.prototype,"value",void 0),(0,s.Cg)([(0,n.MZ)({attribute:!1,type:Array})],m.prototype,"statisticIds",void 0),(0,s.Cg)([(0,n.MZ)({attribute:"statistic-types"})],m.prototype,"statisticTypes",void 0),(0,s.Cg)([(0,n.MZ)({type:String})],m.prototype,"label",void 0),(0,s.Cg)([(0,n.MZ)({type:String})],m.prototype,"placeholder",void 0),(0,s.Cg)([(0,n.MZ)({type:Boolean,attribute:"allow-custom-entity"})],m.prototype,"allowCustomEntity",void 0),(0,s.Cg)([(0,n.MZ)({attribute:"include-statistics-unit-of-measurement"})],m.prototype,"includeStatisticsUnitOfMeasurement",void 0),(0,s.Cg)([(0,n.MZ)({attribute:"include-unit-class"})],m.prototype,"includeUnitClass",void 0),(0,s.Cg)([(0,n.MZ)({attribute:"include-device-class"})],m.prototype,"includeDeviceClass",void 0),(0,s.Cg)([(0,n.MZ)({type:Boolean,attribute:"ignore-restrictions-on-first-statistic"})],m.prototype,"ignoreRestrictionsOnFirstStatistic",void 0),m=(0,s.Cg)([(0,n.EM)("ha-statistics-picker")],m),i()}catch(u){i(u)}})},9169:function(t,i,e){e.d(i,{j:function(){return s}});const s=["relative","total","date","time","datetime"]},9562:function(t,i,e){e.a(t,async function(t,s){try{e.r(i),e.d(i,{HuiStatisticsGraphCardEditor:function(){return w}});e(44114),e(18111),e(22489),e(20116),e(7588),e(61701),e(13579),e(3362),e(17642),e(58004),e(33853),e(45876),e(32475),e(15024),e(31698),e(62953);var a=e(40445),n=e(96196),c=e(77845),o=e(22786),l=e(63533),r=e(44537),u=e(1087),d=e(19459),h=e(36525),p=e(71938),_=(e(52763),e(23528)),m=e(20939),g=e(84698),y=e(20507),v=e(3515),f=t([p,v,_,h]);[p,v,_,h]=f.then?(await f)():f;let b,C,$=t=>t;const q=(0,l.KC)([(0,l.eu)("state"),(0,l.eu)("sum"),(0,l.eu)("change"),(0,l.eu)("min"),(0,l.eu)("max"),(0,l.eu)("mean")]),k=(0,l.kp)(g.H,(0,l.Ik)({entities:(0,l.YO)(y.l),title:(0,l.lq)((0,l.Yj)()),days_to_show:(0,l.lq)((0,l.ai)()),period:(0,l.lq)((0,l.KC)([(0,l.eu)("5minute"),(0,l.eu)("hour"),(0,l.eu)("day"),(0,l.eu)("week"),(0,l.eu)("month")])),chart_type:(0,l.lq)((0,l.KC)([(0,l.eu)("bar"),(0,l.eu)("line")])),stat_types:(0,l.lq)((0,l.KC)([(0,l.YO)(q),q])),unit:(0,l.lq)((0,l.Yj)()),hide_legend:(0,l.lq)((0,l.zM)()),logarithmic_scale:(0,l.lq)((0,l.zM)()),min_y_axis:(0,l.lq)((0,l.ai)()),max_y_axis:(0,l.lq)((0,l.ai)()),fit_y_data:(0,l.lq)((0,l.zM)())})),S=["5minute","hour","day","week","month"],M=["mean","min","max","sum","state","change"];class w extends n.WF{setConfig(t){(0,l.vA)(t,k),this._config=t,this._configEntities=t.entities?(0,m.L)(t.entities,!1).map(t=>t.entity):[]}willUpdate(t){var i;t.has("_configEntities")&&!(0,d.b)(this._configEntities,t.get("_configEntities"))&&(this._metaDatas=void 0,null!==(i=this._configEntities)&&void 0!==i&&i.length&&this._getStatisticsMetaData(this._configEntities))}render(){var t,i;if(!this.hass||!this._config)return n.s6;const e=this._schema(this.hass.localize,this._configEntities,this._metaDatas,void 0!==this._config.min_y_axis||void 0!==this._config.max_y_axis),s=this._config.stat_types?(0,r.e)(this._config.stat_types):M.filter(t=>{var i;return null===(i=this._metaDatas)||void 0===i?void 0:i.some(i=>(0,_.nN)(i,t))}),a=Object.assign(Object.assign({chart_type:"line",period:"hour"},this._config),{},{stat_types:s}),c=null===(t=this._metaDatas)||void 0===t||null===(t=t[0])||void 0===t?void 0:t.unit_class,o=c||null===(i=this._metaDatas)||void 0===i||null===(i=i[0])||void 0===i?void 0:i.statistics_unit_of_measurement;return(0,n.qy)(b||(b=$` <ha-form .hass="${0}" .data="${0}" .schema="${0}" .computeLabel="${0}" @value-changed="${0}"></ha-form> <ha-statistics-picker .hass="${0}" .placeholder="${0}" .label="${0}" .includeStatisticsUnitOfMeasurement="${0}" .includeUnitClass="${0}" .ignoreRestrictionsOnFirstStatistic="${0}" .value="${0}" .configValue="${0}" @value-changed="${0}"></ha-statistics-picker> `),this.hass,a,e,this._computeLabelCallback,this._valueChanged,this.hass,this.hass.localize("ui.panel.lovelace.editor.card.statistics-graph.pick_statistic"),this.hass.localize("ui.panel.lovelace.editor.card.statistics-graph.picked_statistic"),o,c,!0,this._configEntities,"entities",this._entitiesChanged)}_valueChanged(t){(0,u.r)(this,"config-changed",{config:t.detail.value})}async _entitiesChanged(t){const i=t.detail.value,e=i.map(t=>{const i=this._config.entities.find(i=>"string"!=typeof i&&i.entity===t);return null!=i?i:t}),s=Object.assign(Object.assign({},this._config),{},{entities:e});null!=i&&i.some(t=>(0,_.OQ)(t))&&"5minute"===s.period&&delete s.period;const a=s.stat_types||s.unit?await(0,_.Wr)(this.hass,i):void 0;s.stat_types&&s.entities.length&&(s.stat_types=(0,r.e)(s.stat_types).filter(t=>a.some(i=>(0,_.nN)(i,t))),s.stat_types.length||delete s.stat_types),s.unit&&!a.some(t=>(0,_.JE)(this.hass,null==t?void 0:t.statistic_id,t)===s.unit)&&delete s.unit,(0,u.r)(this,"config-changed",{config:s})}constructor(...t){super(...t),this._getStatisticsMetaData=async t=>{this._metaDatas=await(0,_.Wr)(this.hass,t||[])},this._schema=(0,o.A)((t,i,e,s)=>{const a=new Set;null==e||e.forEach(t=>{const i=(0,_.JE)(this.hass,t.statistic_id,t);i&&a.add(i)});const n=[{name:"title",selector:{text:{}}},{name:"",type:"grid",schema:[{name:"period",required:!0,selector:{select:{options:S.map(e=>({value:e,label:t(`ui.panel.lovelace.editor.card.statistics-graph.periods.${e}`),disabled:"5minute"===e&&(null==i?void 0:i.some(t=>(0,_.OQ)(t)))}))}}},{name:"days_to_show",default:v.DEFAULT_DAYS_TO_SHOW,selector:{number:{min:1,mode:"box"}}},{name:"stat_types",required:!0,selector:{select:{multiple:!0,mode:"list",options:M.map(i=>({value:i,label:t(`ui.panel.lovelace.editor.card.statistics-graph.stat_type_labels.${i}`),disabled:!e||!e.some(t=>(0,_.nN)(t,h.n[i]))}))}}},{name:"chart_type",required:!0,type:"select",options:[["line",t("ui.panel.lovelace.editor.card.statistics-graph.chart_type_labels.line")],["bar",t("ui.panel.lovelace.editor.card.statistics-graph.chart_type_labels.bar")]]},{name:"",type:"grid",schema:[{name:"min_y_axis",required:!1,selector:{number:{mode:"box",step:"any"}}},{name:"max_y_axis",required:!1,selector:{number:{mode:"box",step:"any"}}}]},...s?[{name:"fit_y_data",required:!1,selector:{boolean:{}}}]:[],{name:"hide_legend",required:!1,selector:{boolean:{}}},{name:"logarithmic_scale",required:!1,selector:{boolean:{}}}]}];return a.size>1&&n[1].schema.push({name:"unit",required:!1,selector:{select:{options:Array.from(a).map(t=>({value:t,label:t}))}}}),n}),this._computeLabelCallback=t=>{switch(t.name){case"chart_type":case"stat_types":case"period":case"unit":case"hide_legend":case"logarithmic_scale":case"min_y_axis":case"max_y_axis":case"fit_y_data":return this.hass.localize(`ui.panel.lovelace.editor.card.statistics-graph.${t.name}`);default:return this.hass.localize(`ui.panel.lovelace.editor.card.generic.${t.name}`)}}}}w.styles=(0,n.AH)(C||(C=$`ha-statistics-picker{width:100%}`)),(0,a.Cg)([(0,c.MZ)({attribute:!1})],w.prototype,"hass",void 0),(0,a.Cg)([(0,c.wk)()],w.prototype,"_config",void 0),(0,a.Cg)([(0,c.wk)()],w.prototype,"_configEntities",void 0),(0,a.Cg)([(0,c.wk)()],w.prototype,"_metaDatas",void 0),w=(0,a.Cg)([(0,c.EM)("hui-statistics-graph-card-editor")],w),s()}catch(b){s(b)}})},84698:function(t,i,e){e.d(i,{H:function(){return a}});var s=e(63533);const a=(0,s.Ik)({type:(0,s.Yj)(),view_layout:(0,s.bz)(),layout_options:(0,s.bz)(),grid_options:(0,s.bz)(),visibility:(0,s.bz)(),disabled:(0,s.lq)((0,s.zM)())})},20507:function(t,i,e){e.d(i,{l:function(){return o}});var s=e(63533),a=e(9169),n=e(91408),c=e(44155);const o=(0,s.KC)([(0,s.Ik)({entity:(0,s.Yj)(),name:(0,s.lq)(c.q),icon:(0,s.lq)((0,s.Yj)()),image:(0,s.lq)((0,s.Yj)()),secondary_info:(0,s.lq)((0,s.Yj)()),format:(0,s.lq)((0,s.vP)(a.j)),state_color:(0,s.lq)((0,s.zM)()),tap_action:(0,s.lq)(n.kn),hold_action:(0,s.lq)(n.kn),double_tap_action:(0,s.lq)(n.kn),confirmation:(0,s.lq)(n.dk),show_last_changed:(0,s.lq)((0,s.zM)()),show_state:(0,s.lq)((0,s.zM)())}),(0,s.Yj)()])},6116:function(t,i,e){e.d(i,{o:function(){return n}});var s=e(6439),a=e(83339);function n(t,i,e){const n=(0,a.b)(t,i)/6e4;return(0,s.u)(null==e?void 0:e.roundingMethod)(n)}}}]);
//# sourceMappingURL=59988.d98987c26a83c38f.js.map