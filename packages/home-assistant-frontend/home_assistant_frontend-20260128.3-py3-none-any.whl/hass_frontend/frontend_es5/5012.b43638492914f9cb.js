"use strict";(self.webpackChunkhome_assistant_frontend=self.webpackChunkhome_assistant_frontend||[]).push([["5012"],{90433:function(e,t,i){i.d(t,{Vy:function(){return n},fI:function(){return o},ux:function(){return h}});var a=i(22786),s=i(79468);const r=54;function n(e,t){const i=e%r+1;return t.getPropertyValue(`--color-${i}`)}function o(e,t){const i=t.getPropertyValue(`--graph-color-${e+1}`)||n(e,t);return(0,s.RQ)(i)}const h=(0,a.A)(e=>Array.from({length:r},(t,i)=>o(i,e)),(e,t)=>e[0].getPropertyValue("--graph-color-1")===t[0].getPropertyValue("--graph-color-1")&&e[0].getPropertyValue("--color-1")===t[0].getPropertyValue("--color-1"))},68159:function(e,t,i){i.a(e,async function(e,a){try{i.r(t),i.d(t,{HuiCalendarCard:function(){return z}});var s=i(69235),r=(i(16280),i(18111),i(61701),i(3362),i(62953),i(40445)),n=i(96196),o=i(94333),h=i(77845),d=i(78870),l=i(90433),c=i(42372),g=i(9899),u=(i(76776),i(65829)),_=i(55156),v=i(59241),p=i(54706),f=i(63556),y=i(13632),w=(i(85979),e([s,u,f]));[s,u,f]=w.then?(await w)():w;let b,C,m,k,x=e=>e;class z extends((0,p.E)(n.WF)){static async getConfigElement(){return await Promise.all([i.e("1535"),i.e("89652")]).then(i.bind(i,6534)),document.createElement("hui-calendar-card-editor")}static getStubConfig(e,t,i){return{entities:(0,y.B)(e,2,t,i,["calendar"])}}setConfig(e){var t,i;if(null===(t=e.entities)||void 0===t||!t.length)throw new Error("Entities must be specified");if(!Array.isArray(e.entities))throw new Error("Entities need to be an array");(null===(i=this._config)||void 0===i?void 0:i.entities)!==e.entities&&this._fetchCalendarEvents(),this._config=Object.assign({initial_view:"dayGridMonth"},e)}willUpdate(e){var t;if(super.willUpdate(e),this._entityRegistry&&((e.has("_config")||e.has("_entityRegistry"))&&(this._eventsLoaded=!1),!this.hasUpdated||e.has("_config")&&null!==(t=this._config)&&void 0!==t&&t.entities||e.has("_entityRegistry"))){var i,a,s;const e=getComputedStyle(this),t=new Map(null!==(i=null===(a=this._entityRegistry)||void 0===a?void 0:a.map(e=>[e.entity_id,e.options]))&&void 0!==i?i:[]);null!==(s=this._config)&&void 0!==s&&s.entities&&(this._calendars=this._config.entities.map((i,a)=>{var s;const r=null===(s=t.get(i))||void 0===s||null===(s=s.calendar)||void 0===s?void 0:s.color;let n;return n=r&&(0,d.dc)(r)?(0,d.MP)(r):(0,l.Vy)(a,e),{entity_id:i,backgroundColor:n}}))}}getCardSize(){return 12}getGridOptions(){return{rows:6,columns:12,min_columns:4,min_rows:4}}hassSubscribe(){return[(0,v.Bz)(this.hass.connection,e=>{this._entityRegistry=e})]}connectedCallback(){super.connectedCallback(),this.updateComplete.then(()=>this._attachObserver())}disconnectedCallback(){super.disconnectedCallback(),this._resizeObserver&&this._resizeObserver.disconnect()}render(){if(!this._config||!this.hass)return n.s6;const e=!this._entityRegistry||!this._eventsLoaded;return(0,n.qy)(b||(b=x` <ha-card> ${0} <ha-full-calendar class="${0}" .narrow="${0}" .events="${0}" .calendars="${0}" .hass="${0}" .views="${0}" .initialView="${0}" .error="${0}" @view-changed="${0}"></ha-full-calendar> ${0} </ha-card> `),this._config.title?(0,n.qy)(C||(C=x`<div class="header">${0}</div>`),this._config.title):n.s6,(0,o.H)({"is-grid":"grid"===this.layout,"is-panel":"panel"===this.layout,"has-title":!!this._config.title,loading:e}),this._narrow,this._events,this._calendars,this.hass,["dayGridMonth","dayGridDay","listWeek"],this._config.initial_view,this._error,this._handleViewChanged,e?(0,n.qy)(m||(m=x`<div class="loading"> <ha-spinner></ha-spinner> </div>`)):n.s6)}updated(e){if(super.updated(e),!this._config||!this.hass)return;e.has("_entityRegistry")&&this._entityRegistry&&this._fetchCalendarEvents(),!this._entityRegistry||this._calendars.length||this._eventsLoaded||(this._eventsLoaded=!0);const t=e.get("hass"),i=e.get("_config");(!t||!i||e.has("hass")&&t.themes!==this.hass.themes||e.has("_config")&&i.theme!==this._config.theme)&&(0,c.Q)(this,this.hass.themes,this._config.theme)}_handleViewChanged(e){this._startDate=e.detail.start,this._endDate=e.detail.end,this._eventsLoaded=!1,this._fetchCalendarEvents()}async _fetchCalendarEvents(){if(!this._startDate||!this._endDate)return;this._error=void 0;const e=await(0,_.ms)(this.hass,this._startDate,this._endDate,this._calendars);this._events=e.events,this.updateComplete.then(()=>{requestAnimationFrame(()=>{this._eventsLoaded=!0})}),e.errors.length>0&&(this._error=`${this.hass.localize("ui.components.calendar.event_retrieval_error")}`)}_measureCard(){const e=this.shadowRoot.querySelector("ha-card");e&&(this._narrow=e.offsetWidth<870)}async _attachObserver(){this._resizeObserver||(this._resizeObserver=new ResizeObserver((0,g.s)(()=>this._measureCard(),250,!1)));const e=this.shadowRoot.querySelector("ha-card");e&&this._resizeObserver.observe(e)}constructor(...e){super(...e),this._events=[],this._calendars=[],this._narrow=!1,this._error=void 0,this._eventsLoaded=!1}}z.styles=(0,n.AH)(k||(k=x`ha-card{position:relative;padding:0 8px 8px;box-sizing:border-box;height:100%;overflow:hidden}.header{color:var(--ha-card-header-color,var(--primary-text-color));font-size:var(--ha-card-header-font-size, var(--ha-font-size-2xl));line-height:var(--ha-line-height-condensed);padding-top:16px;padding-left:8px;padding-inline-start:8px;direction:var(--direction);white-space:nowrap;text-overflow:ellipsis}ha-full-calendar{--calendar-height:400px;display:block;width:100%;height:var(--calendar-height);min-height:var(--calendar-height)}ha-full-calendar.loading{visibility:hidden}ha-full-calendar.is-grid,ha-full-calendar.is-panel{--calendar-height:calc(100% - 16px)}ha-full-calendar.is-grid.has-title,ha-full-calendar.is-panel.has-title{--calendar-height:calc(
        100% - var(--ha-card-header-font-size, var(--ha-font-size-2xl)) - 22px
      )}.loading{position:absolute;inset:0;display:flex;align-items:center;justify-content:center;background:var(--card-background-color,var(--ha-card-background));z-index:1}`)),(0,r.Cg)([(0,h.MZ)({attribute:!1})],z.prototype,"hass",void 0),(0,r.Cg)([(0,h.MZ)({attribute:!1})],z.prototype,"layout",void 0),(0,r.Cg)([(0,h.wk)()],z.prototype,"_events",void 0),(0,r.Cg)([(0,h.wk)()],z.prototype,"_config",void 0),(0,r.Cg)([(0,h.wk)()],z.prototype,"_calendars",void 0),(0,r.Cg)([(0,h.wk)()],z.prototype,"_narrow",void 0),(0,r.Cg)([(0,h.wk)()],z.prototype,"_error",void 0),(0,r.Cg)([(0,h.wk)()],z.prototype,"_entityRegistry",void 0),(0,r.Cg)([(0,h.wk)()],z.prototype,"_eventsLoaded",void 0),z=(0,r.Cg)([(0,h.EM)("hui-calendar-card")],z),a()}catch(b){a(b)}})}}]);
//# sourceMappingURL=5012.b43638492914f9cb.js.map