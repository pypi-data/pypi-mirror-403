export const __rspack_esm_id="91903";export const __rspack_esm_ids=["91903"];export const __webpack_modules__={91069(e,t,s){s.a(e,async function(e,i){try{s.d(t,{EO:()=>D,Yq:()=>O,_U:()=>k,eE:()=>b,fU:()=>C,ol:()=>v,xo:()=>w});var a=s(78016),o=s(31810),n=s(49134),r=s(81977),l=s(36307),c=s(35932),h=s(73983),d=s(6946),_=s(92913),p=s(83339),g=s(77972),u=s(31886),f=s(46927),m=e([u]);u=(m.then?(await m)():m)[0];const y=(e,t,s,i)=>{const a=s(new u.BB(e,t),i);return a instanceof Date?new Date(a.getTime()):a},v=(e,t,s,i,a)=>s.time_zone===f.Wj.server?y(e,i.time_zone,t,a):t(e,a),w=(e,t,s,i,a)=>s.time_zone===f.Wj.server?y(e,i.time_zone,t,a):t(e,a),D=(e,t,s,i,a)=>w(e,s,i,a,i.time_zone===f.Wj.server?new u.BB(t,a.time_zone):t),b=(e,t,s,i,u)=>{let f,m;if(w(e,a.e,i,u)&&w(t,o.c,i,u)){const a=(D(t,e,n.W,i,u)+1)*(s?1:-1);f=v(e,r.P,i,u,a),m=v(v(t,r.P,i,u,a),l.p,i,u)}else if(w(e,e=>(0,c.o)(e).getMilliseconds()===e.getMilliseconds(),i,u)&&w(t,e=>(0,h.D)(e).getMilliseconds()===e.getMilliseconds(),i,u)){const a=(D(t,e,d.c,i,u)+1)*(s?1:-1);f=v(e,_.f,i,u,a),m=v(t,_.f,i,u,a)}else{const a=D(t,e,p.b,i,u)*(s?1:-1);f=v(e,g.A,i,u,a),m=v(t,g.A,i,u,a)}return{start:f,end:m}},k=(e,t)=>{const s=new u.BB(e,t);return new Date(s.getTime())},O=(e,t)=>new u.BB(e,t).toISOString().split("T")[0],C=(e,t)=>new u.BB(e,t).toISOString().split("T")[1].split(".")[0];i()}catch(e){i(e)}})},46223(e,t,s){s.a(e,async function(e,i){try{s.d(t,{b:()=>D});var a=s(35932),o=s(73983),n=s(92913),r=s(52640),l=s(69137),c=s(35660),h=s(36307),d=s(11650),_=s(15797),p=s(33977),g=s(69748),u=s(55144),f=s(21828),m=s(66708),y=s(91069),v=s(380),w=e([y]);y=(w.then?(await w)():w)[0];const D=(e,t)=>{const s=new Date,i=(0,v.P)(e.locale);switch(t){case"today":return[(0,y.ol)(s,a.o,e.locale,e.config,{weekStartsOn:i}),(0,y.ol)(s,o.D,e.locale,e.config,{weekStartsOn:i})];case"yesterday":return[(0,y.ol)((0,n.f)(s,-1),a.o,e.locale,e.config,{weekStartsOn:i}),(0,y.ol)((0,n.f)(s,-1),o.D,e.locale,e.config,{weekStartsOn:i})];case"this_week":return[(0,y.ol)(s,r.k,e.locale,e.config,{weekStartsOn:i}),(0,y.ol)(s,l.$,e.locale,e.config,{weekStartsOn:i})];case"this_month":return[(0,y.ol)(s,c.w,e.locale,e.config),(0,y.ol)(s,h.p,e.locale,e.config)];case"this_quarter":return[(0,y.ol)(s,d.a,e.locale,e.config),(0,y.ol)(s,_.j,e.locale,e.config)];case"this_year":return[(0,y.ol)(s,p.D,e.locale,e.config),(0,y.ol)(s,g.Q,e.locale,e.config)];case"now-7d":return[(0,y.ol)(s,u.e,e.locale,e.config,7),(0,y.ol)(s,u.e,e.locale,e.config,0)];case"now-30d":return[(0,y.ol)(s,u.e,e.locale,e.config,30),(0,y.ol)(s,u.e,e.locale,e.config,0)];case"now-12m":return[(0,y.ol)(s,f.a,e.locale,e.config,12),(0,y.ol)(s,f.a,e.locale,e.config,0)];case"now-1h":return[(0,y.ol)(s,m.O,e.locale,e.config,1),(0,y.ol)(s,m.O,e.locale,e.config,0)];case"now-12h":return[(0,y.ol)(s,m.O,e.locale,e.config,12),(0,y.ol)(s,m.O,e.locale,e.config,0)];case"now-24h":return[(0,y.ol)(s,m.O,e.locale,e.config,24),(0,y.ol)(s,m.O,e.locale,e.config,0)]}return[s,s]};i()}catch(e){i(e)}})},23528(e,t,s){s.d(t,{$3:()=>u,$O:()=>k,$j:()=>f,ED:()=>o,JE:()=>O,OQ:()=>C,PU:()=>x,Ph:()=>p,Uf:()=>b,W1:()=>g,Wr:()=>h,Z:()=>l,gF:()=>m,iY:()=>y,jU:()=>n,nN:()=>D,p3:()=>c,pJ:()=>_,r_:()=>r,sz:()=>d});s(18111),s(13579);var i=s(28978),a=s(380),o=function(e){return e[e.NONE=0]="NONE",e[e.ARITHMETIC=1]="ARITHMETIC",e[e.CIRCULAR=2]="CIRCULAR",e}({});const n=["entity_not_recorded","entity_no_longer_recorded","state_class_removed","units_changed","mean_type_changed","no_state"],r=["L","gal","ft³","m³","CCF","MCF"],l=e=>e.sendMessagePromise({type:"recorder/info"}),c=(e,t)=>e.callWS({type:"recorder/list_statistic_ids",statistic_type:t}),h=(e,t)=>e.callWS({type:"recorder/get_statistics_metadata",statistic_ids:t}),d=(e,t,s,i,a="hour",o,n)=>e.callWS({type:"recorder/statistics_during_period",start_time:t.toISOString(),end_time:s?.toISOString(),statistic_ids:i,period:a,units:o,types:n}),_=(e,t,s,i)=>e.callWS({type:"recorder/statistic_during_period",statistic_id:t,units:i,fixed_period:s.fixed_period?{start_time:s.fixed_period.start instanceof Date?s.fixed_period.start.toISOString():s.fixed_period.start,end_time:s.fixed_period.end instanceof Date?s.fixed_period.end.toISOString():s.fixed_period.end}:void 0,calendar:s.calendar?{..."week"===s.calendar.period?{first_weekday:(0,a.D)(e.locale).substring(0,3)}:{},...s.calendar}:void 0,rolling_window:s.rolling_window}),p=e=>e.callWS({type:"recorder/validate_statistics"}),g=(e,t,s,i)=>e.callWS({type:"recorder/update_statistics_metadata",statistic_id:t,unit_of_measurement:s,unit_class:i}),u=(e,t)=>e.callWS({type:"recorder/clear_statistics",statistic_ids:t}),f=e=>{let t=null;if(!e)return null;for(const s of e)null!==s.change&&void 0!==s.change&&(null===t?t=s.change:t+=s.change);return t},m=(e,t)=>{let s=null;for(const i of t){if(!(i in e))continue;const t=f(e[i]);null!==t&&(null===s?s=t:s+=t)}return s},y=(e,t)=>e.some(e=>void 0!==e[t]&&null!==e[t]),v=["mean","min","max"],w=["sum","state","change"],D=(e,t)=>!(!v.includes(t)||0===e.mean_type)||!(!w.includes(t)||!e.has_sum),b=(e,t,s,i,a)=>{const o=new Date(s).toISOString();return e.callWS({type:"recorder/adjust_sum_statistics",statistic_id:t,start_time:o,adjustment:i,adjustment_unit_of_measurement:a})},k=(e,t,s)=>{const a=e.states[t];return a?(0,i.u)(a):s?.name||t},O=(e,t,s)=>{let i;return t&&(i=e.states[t]?.attributes.unit_of_measurement),void 0===i?s?.statistics_unit_of_measurement:i},C=e=>e.includes(":"),x=e=>e.callWS({type:"recorder/update_statistics_issues"})},56342(e,t,s){s.a(e,async function(e,i){try{s.r(t),s.d(t,{HuiEnergyDateSelectionCard:()=>h});var a=s(62826),o=s(96196),n=s(44457),r=(s(76776),s(784)),l=s(73887),c=e([l]);l=(c.then?(await c)():c)[0];class h extends o.WF{getCardSize(){return 1}getGridOptions(){return{rows:1,columns:12}}setConfig(e){this._config=e}shouldUpdate(e){return(0,r.xP)(this,e)||e.size>1||!e.has("hass")}render(){return this.hass&&this._config?o.qy` <ha-card> <div class="card-content"> <hui-energy-period-selector .hass="${this.hass}" .collectionKey="${this._config.collection_key}"></hui-energy-period-selector> </div> </ha-card> `:o.s6}}h.styles=o.AH`ha-card{height:100%;display:flex;flex-direction:column;justify-content:center}`,(0,a.Cg)([(0,n.MZ)({attribute:!1})],h.prototype,"hass",void 0),(0,a.Cg)([(0,n.wk)()],h.prototype,"_config",void 0),h=(0,a.Cg)([(0,n.EM)("hui-energy-date-selection-card")],h),i()}catch(e){i(e)}})},73887(e,t,s){s.a(e,async function(e,t){try{var i=s(62826),a=s(35932),o=s(73983),n=s(52640),r=s(69137),l=s(6946),c=s(55144),h=s(40600),d=s(78016),_=s(31810),p=s(49134),g=s(96196),u=s(44457),f=s(94333),m=s(22786),y=s(91069),v=s(46223),w=s(380),D=s(72487),b=s(9899),k=s(18350),O=s(15397),C=s(29823),x=(s(70947),s(25440),s(45100),s(67094),s(38114)),S=s(54706),$=e([k,O,C,D,v,x,y]);[k,O,C,D,v,x,y]=$.then?(await $)():$;const z="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z",M="M12,16A2,2 0 0,1 14,18A2,2 0 0,1 12,20A2,2 0 0,1 10,18A2,2 0 0,1 12,16M12,10A2,2 0 0,1 14,12A2,2 0 0,1 12,14A2,2 0 0,1 10,12A2,2 0 0,1 12,10M12,4A2,2 0 0,1 14,6A2,2 0 0,1 12,8A2,2 0 0,1 10,6A2,2 0 0,1 12,4Z",A=["today","yesterday","this_week","this_month","this_quarter","this_year","now-7d","now-30d","now-12m"];class W extends((0,S.E)(g.WF)){hassSubscribe(){return[(0,x.tb)(this.hass,{key:this.collectionKey}).subscribe(e=>this._updateDates(e))]}_measure(){this.narrow=this.offsetWidth<450}async _attachObserver(){this._resizeObserver||(this._resizeObserver=new ResizeObserver((0,b.s)(()=>this._measure(),250,!1))),this._resizeObserver.observe(this)}firstUpdated(){this._attachObserver()}connectedCallback(){super.connectedCallback(),this.updateComplete.then(()=>this._attachObserver())}disconnectedCallback(){super.disconnectedCallback(),this._resizeObserver&&this._resizeObserver.disconnect()}willUpdate(e){super.willUpdate(e),this.hasUpdated||this._measure(),(!this.hasUpdated||e.has("hass")&&this.hass?.localize!==e.get("hass")?.localize)&&(this._ranges={},A.forEach(e=>{this._ranges[this.hass.localize(`ui.components.date-range-picker.ranges.${e}`)]=(0,v.b)(this.hass,e)}))}render(){if(!this.hass||!this._startDate)return g.s6;const e=this._simpleRange(this._startDate,this._endDate,this.hass.locale,this.hass.config);return g.qy` <div class="${(0,f.H)({row:!0,"datepicker-open":this._datepickerOpen})}"> <div class="backdrop"></div> <div class="label"> ${"day"===e?this.narrow?(0,D.kz)(this._startDate,this.hass.locale,this.hass.config):(0,D.Yq)(this._startDate,this.hass.locale,this.hass.config):"month"===e?(0,D.fr)(this._startDate,this.hass.locale,this.hass.config):"year"===e?(0,D.Pm)(this._startDate,this.hass.locale,this.hass.config):`${(0,D.sl)(this._startDate,this.hass.locale,this.hass.config)} – ${(0,D.sl)(this._endDate||new Date,this.hass.locale,this.hass.config)}`} </div> <div class="time-handle"> <ha-icon-button-prev .label="${this.hass.localize("ui.panel.lovelace.components.energy_period_selector.previous")}" @click="${this._pickPrevious}"></ha-icon-button-prev> <ha-icon-button-next .label="${this.hass.localize("ui.panel.lovelace.components.energy_period_selector.next")}" @click="${this._pickNext}"></ha-icon-button-next> <ha-date-range-picker .hass="${this.hass}" .startDate="${this._startDate}" .endDate="${this._endDate||new Date}" .ranges="${this._ranges}" @value-changed="${this._dateRangeChanged}" @preset-selected="${this._presetSelected}" @toggle="${this._handleDatepickerToggle}" minimal header-position .verticalOpeningDirection="${this.verticalOpeningDirection}"></ha-date-range-picker> </div> ${this.narrow?g.s6:g.qy`<ha-button appearance="filled" size="small" @click="${this._pickNow}"> ${this.hass.localize("ui.panel.lovelace.components.energy_period_selector.now")} </ha-button>`} <ha-dropdown placement="bottom-end" @wa-select="${this._handleMenuAction}"> <ha-icon-button slot="trigger" .label="${this.hass.localize("ui.common.menu")}" .path="${M}"></ha-icon-button> ${this.allowCompare?g.qy`<ha-dropdown-item value="toggle-compare"> ${this._compare?g.qy`<ha-svg-icon slot="icon" .path="${z}"></ha-svg-icon>`:g.s6} ${this.hass.localize("ui.panel.lovelace.components.energy_period_selector.compare")} </ha-dropdown-item>`:g.s6} <slot name="overflow-menu"></slot> </ha-dropdown> </div> `}_updateCollectionPeriod(){const e=(0,x.tb)(this.hass,{key:this.collectionKey});e.setPeriod(this._startDate,this._endDate),e.refresh()}_dateRangeChanged(e){this._startDate=(0,y.ol)(e.detail.value.startDate,a.o,this.hass.locale,this.hass.config),this._endDate=(0,y.ol)(e.detail.value.endDate,o.D,this.hass.locale,this.hass.config),this._updateCollectionPeriod()}_presetSelected(e){localStorage.setItem(`energy-default-period-_${this.collectionKey||"energy"}`,A[e.detail.index])}_pickNow(){if(!this._startDate)return;const e=this._simpleRange(this._startDate,this._endDate,this.hass.locale,this.hass.config),t=new Date;if("month"===e)[this._startDate,this._endDate]=(0,v.b)(this.hass,"this_month");else if("quarter"===e)[this._startDate,this._endDate]=(0,v.b)(this.hass,"this_quarter");else if("year"===e)[this._startDate,this._endDate]=(0,v.b)(this.hass,"this_year");else{const e=(0,w.P)(this.hass.locale),s=(0,y.ol)(this._endDate,n.k,this.hass.locale,this.hass.config,{weekStartsOn:e}),i=(0,y.ol)(this._endDate,r.$,this.hass.locale,this.hass.config,{weekStartsOn:e});if(this._startDate.getTime()===s.getTime()&&this._endDate.getTime()===i.getTime())[this._startDate,this._endDate]=(0,v.b)(this.hass,"this_week");else{const s=(0,y.EO)(this._endDate,this._startDate,l.c,this.hass.locale,this.hass.config);this._startDate=(0,y.ol)((0,y.ol)(t,c.e,this.hass.locale,this.hass.config,s),a.o,this.hass.locale,this.hass.config,{weekStartsOn:e}),this._endDate=(0,y.ol)(t,o.D,this.hass.locale,this.hass.config,{weekStartsOn:e})}}this._updateCollectionPeriod()}_pickPrevious(){this._shift(!1)}_pickNext(){this._shift(!0)}_shift(e){if(!this._startDate)return;const{start:t,end:s}=(0,y.eE)(this._startDate,this._endDate,e,this.hass.locale,this.hass.config);this._startDate=t,this._endDate=s,this._updateCollectionPeriod()}_updateDates(e){this._compare=void 0!==e.startCompare,this._startDate=e.start,this._endDate=e.end||(0,h.o)()}_handleDatepickerToggle(e){this._datepickerOpen=e.detail.open}_handleMenuAction(e){"toggle-compare"===e.detail.item.value&&this._toggleCompare()}_toggleCompare(){this._compare=!this._compare;const e=(0,x.tb)(this.hass,{key:this.collectionKey});e.setCompare(this._compare?x.lh.PREVIOUS:x.lh.NONE),e.refresh()}constructor(...e){super(...e),this.allowCompare=!0,this._datepickerOpen=!1,this._ranges={},this._compare=!1,this._simpleRange=(0,m.A)((e,t,s,i)=>{if(0===(0,l.c)(t,e))return"day";if((0,y.xo)(e,d.e,s,i)&&(0,y.xo)(t,_.c,s,i)){if(0===(0,y.EO)(t,e,p.W,s,i))return"month";if(2===(0,y.EO)(t,e,p.W,s,i)&&e.getMonth()%3==0)return"quarter"}return(0,y.xo)(e,d.e,s,i)&&(0,y.xo)(t,_.c,s,i)&&11===(0,y.EO)(t,e,p.W,s,i)?"year":"other"})}}W.styles=g.AH`.row{display:flex;align-items:center;justify-content:space-between}:host .time-handle{display:flex;justify-content:flex-end;align-items:center}:host([narrow]) .time-handle{margin-left:auto;margin-inline-start:auto;margin-inline-end:initial}.label{display:flex;align-items:center;justify-content:flex-end;font-size:var(--ha-font-size-xl);margin-left:auto;margin-inline-start:auto;margin-inline-end:initial}:host([fixed]) .label,:host([narrow]) .label{margin-left:unset;margin-inline-start:unset;margin-inline-end:initial}ha-button{margin-left:8px;margin-inline-start:8px;margin-inline-end:initial;flex-shrink:0;--ha-button-theme-color:currentColor}.backdrop{position:fixed;top:0;left:0;right:0;bottom:0;z-index:var(--dialog-z-index,8);-webkit-backdrop-filter:var(--ha-dialog-scrim-backdrop-filter,var(--dialog-backdrop-filter));backdrop-filter:var(--ha-dialog-scrim-backdrop-filter,var(--dialog-backdrop-filter));pointer-events:none;opacity:0;transition:opacity var(--ha-animation-base-duration) ease-in-out}.datepicker-open .backdrop{opacity:1;pointer-events:auto}`,(0,i.Cg)([(0,u.MZ)({attribute:!1})],W.prototype,"hass",void 0),(0,i.Cg)([(0,u.MZ)({attribute:"collection-key"})],W.prototype,"collectionKey",void 0),(0,i.Cg)([(0,u.MZ)({type:Boolean,reflect:!0})],W.prototype,"narrow",void 0),(0,i.Cg)([(0,u.MZ)({type:Boolean,reflect:!0})],W.prototype,"fixed",void 0),(0,i.Cg)([(0,u.MZ)({type:Boolean,attribute:"allow-compare"})],W.prototype,"allowCompare",void 0),(0,i.Cg)([(0,u.MZ)({attribute:"vertical-opening-direction"})],W.prototype,"verticalOpeningDirection",void 0),(0,i.Cg)([(0,u.wk)()],W.prototype,"_datepickerOpen",void 0),(0,i.Cg)([(0,u.wk)()],W.prototype,"_startDate",void 0),(0,i.Cg)([(0,u.wk)()],W.prototype,"_endDate",void 0),(0,i.Cg)([(0,u.wk)()],W.prototype,"_ranges",void 0),(0,i.Cg)([(0,u.wk)()],W.prototype,"_compare",void 0),W=(0,i.Cg)([(0,u.EM)("hui-energy-period-selector")],W),t()}catch(e){t(e)}})},56434(e,t,s){s.d(t,{e:()=>a});var i=s(81977);function a(e,t,s){return(0,i.P)(e,12*t,s)}},40600(e,t,s){s.d(t,{o:()=>a});var i=s(73983);function a(e){return(0,i.D)(Date.now(),e)}}};
//# sourceMappingURL=91903.ce3629d0b5d96ad3.js.map