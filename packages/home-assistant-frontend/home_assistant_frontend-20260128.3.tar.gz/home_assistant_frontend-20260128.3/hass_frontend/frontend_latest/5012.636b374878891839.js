export const __rspack_esm_id="5012";export const __rspack_esm_ids=["5012"];export const __webpack_modules__={90433(e,t,i){i.d(t,{Vy:()=>r,fI:()=>n,ux:()=>o});var s=i(22786),a=i(79468);function r(e,t){const i=e%54+1;return t.getPropertyValue(`--color-${i}`)}function n(e,t){const i=t.getPropertyValue(`--graph-color-${e+1}`)||r(e,t);return(0,a.RQ)(i)}const o=(0,s.A)(e=>Array.from({length:54},(t,i)=>n(i,e)),(e,t)=>e[0].getPropertyValue("--graph-color-1")===t[0].getPropertyValue("--graph-color-1")&&e[0].getPropertyValue("--color-1")===t[0].getPropertyValue("--color-1"))},68159(e,t,i){i.a(e,async function(e,s){try{i.r(t),i.d(t,{HuiCalendarCard:()=>w});i(18111),i(61701);var a=i(62826),r=i(96196),n=i(94333),o=i(44457),h=i(78870),d=i(90433),c=i(42372),l=i(9899),_=(i(76776),i(65829)),g=i(55156),p=i(59241),u=i(54706),y=i(63556),v=i(13632),f=(i(85979),e([_,y]));[_,y]=f.then?(await f)():f;class w extends((0,u.E)(r.WF)){static async getConfigElement(){return await i.e("96139").then(i.bind(i,6534)),document.createElement("hui-calendar-card-editor")}static getStubConfig(e,t,i){return{entities:(0,v.B)(e,2,t,i,["calendar"])}}setConfig(e){if(!e.entities?.length)throw new Error("Entities must be specified");if(!Array.isArray(e.entities))throw new Error("Entities need to be an array");this._config?.entities!==e.entities&&this._fetchCalendarEvents(),this._config={initial_view:"dayGridMonth",...e}}willUpdate(e){if(super.willUpdate(e),this._entityRegistry&&((e.has("_config")||e.has("_entityRegistry"))&&(this._eventsLoaded=!1),!this.hasUpdated||e.has("_config")&&this._config?.entities||e.has("_entityRegistry"))){const e=getComputedStyle(this),t=new Map(this._entityRegistry?.map(e=>[e.entity_id,e.options])??[]);this._config?.entities&&(this._calendars=this._config.entities.map((i,s)=>{const a=t.get(i)?.calendar?.color;let r;return r=a&&(0,h.dc)(a)?(0,h.MP)(a):(0,d.Vy)(s,e),{entity_id:i,backgroundColor:r}}))}}getCardSize(){return 12}getGridOptions(){return{rows:6,columns:12,min_columns:4,min_rows:4}}hassSubscribe(){return[(0,p.Bz)(this.hass.connection,e=>{this._entityRegistry=e})]}connectedCallback(){super.connectedCallback(),this.updateComplete.then(()=>this._attachObserver())}disconnectedCallback(){super.disconnectedCallback(),this._resizeObserver&&this._resizeObserver.disconnect()}render(){if(!this._config||!this.hass)return r.s6;const e=!this._entityRegistry||!this._eventsLoaded;return r.qy` <ha-card> ${this._config.title?r.qy`<div class="header">${this._config.title}</div>`:r.s6} <ha-full-calendar class="${(0,n.H)({"is-grid":"grid"===this.layout,"is-panel":"panel"===this.layout,"has-title":!!this._config.title,loading:e})}" .narrow="${this._narrow}" .events="${this._events}" .calendars="${this._calendars}" .hass="${this.hass}" .views="${["dayGridMonth","dayGridDay","listWeek"]}" .initialView="${this._config.initial_view}" .error="${this._error}" @view-changed="${this._handleViewChanged}"></ha-full-calendar> ${e?r.qy`<div class="loading"> <ha-spinner></ha-spinner> </div>`:r.s6} </ha-card> `}updated(e){if(super.updated(e),!this._config||!this.hass)return;e.has("_entityRegistry")&&this._entityRegistry&&this._fetchCalendarEvents(),!this._entityRegistry||this._calendars.length||this._eventsLoaded||(this._eventsLoaded=!0);const t=e.get("hass"),i=e.get("_config");(!t||!i||e.has("hass")&&t.themes!==this.hass.themes||e.has("_config")&&i.theme!==this._config.theme)&&(0,c.Q)(this,this.hass.themes,this._config.theme)}_handleViewChanged(e){this._startDate=e.detail.start,this._endDate=e.detail.end,this._eventsLoaded=!1,this._fetchCalendarEvents()}async _fetchCalendarEvents(){if(!this._startDate||!this._endDate)return;this._error=void 0;const e=await(0,g.ms)(this.hass,this._startDate,this._endDate,this._calendars);this._events=e.events,this.updateComplete.then(()=>{requestAnimationFrame(()=>{this._eventsLoaded=!0})}),e.errors.length>0&&(this._error=`${this.hass.localize("ui.components.calendar.event_retrieval_error")}`)}_measureCard(){const e=this.shadowRoot.querySelector("ha-card");e&&(this._narrow=e.offsetWidth<870)}async _attachObserver(){this._resizeObserver||(this._resizeObserver=new ResizeObserver((0,l.s)(()=>this._measureCard(),250,!1)));const e=this.shadowRoot.querySelector("ha-card");e&&this._resizeObserver.observe(e)}constructor(...e){super(...e),this._events=[],this._calendars=[],this._narrow=!1,this._error=void 0,this._eventsLoaded=!1}}w.styles=r.AH`ha-card{position:relative;padding:0 8px 8px;box-sizing:border-box;height:100%;overflow:hidden}.header{color:var(--ha-card-header-color,var(--primary-text-color));font-size:var(--ha-card-header-font-size, var(--ha-font-size-2xl));line-height:var(--ha-line-height-condensed);padding-top:16px;padding-left:8px;padding-inline-start:8px;direction:var(--direction);white-space:nowrap;text-overflow:ellipsis}ha-full-calendar{--calendar-height:400px;display:block;width:100%;height:var(--calendar-height);min-height:var(--calendar-height)}ha-full-calendar.loading{visibility:hidden}ha-full-calendar.is-grid,ha-full-calendar.is-panel{--calendar-height:calc(100% - 16px)}ha-full-calendar.is-grid.has-title,ha-full-calendar.is-panel.has-title{--calendar-height:calc(
        100% - var(--ha-card-header-font-size, var(--ha-font-size-2xl)) - 22px
      )}.loading{position:absolute;inset:0;display:flex;align-items:center;justify-content:center;background:var(--card-background-color,var(--ha-card-background));z-index:1}`,(0,a.Cg)([(0,o.MZ)({attribute:!1})],w.prototype,"hass",void 0),(0,a.Cg)([(0,o.MZ)({attribute:!1})],w.prototype,"layout",void 0),(0,a.Cg)([(0,o.wk)()],w.prototype,"_events",void 0),(0,a.Cg)([(0,o.wk)()],w.prototype,"_config",void 0),(0,a.Cg)([(0,o.wk)()],w.prototype,"_calendars",void 0),(0,a.Cg)([(0,o.wk)()],w.prototype,"_narrow",void 0),(0,a.Cg)([(0,o.wk)()],w.prototype,"_error",void 0),(0,a.Cg)([(0,o.wk)()],w.prototype,"_entityRegistry",void 0),(0,a.Cg)([(0,o.wk)()],w.prototype,"_eventsLoaded",void 0),w=(0,a.Cg)([(0,o.EM)("hui-calendar-card")],w),s()}catch(e){s(e)}})}};
//# sourceMappingURL=5012.636b374878891839.js.map