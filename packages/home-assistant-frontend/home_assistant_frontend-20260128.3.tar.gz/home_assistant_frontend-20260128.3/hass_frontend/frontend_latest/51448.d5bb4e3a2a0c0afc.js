export const __rspack_esm_id="51448";export const __rspack_esm_ids=["51448"];export const __webpack_modules__={32656(t,e,i){var s=i(62826),a=i(96196),o=i(44457),l=i(32288),n=i(1087),r=i(57237);i(26300),i(3449),i(28732),i(606),i(75709);class h extends a.WF{render(){return a.qy` ${this.label?a.qy`<label>${this.label}${this.required?" *":""}</label>`:a.s6} <div class="time-input-wrap-wrap"> <div class="time-input-wrap"> ${this.enableDay?a.qy` <ha-textfield id="day" type="number" inputmode="numeric" .value="${this.days.toFixed()}" .label="${this.dayLabel}" name="days" @change="${this._valueChanged}" @focusin="${this._onFocus}" no-spinner .required="${this.required}" .autoValidate="${this.autoValidate}" min="0" .disabled="${this.disabled}" suffix=":" class="hasSuffix"> </ha-textfield> `:a.s6} <ha-textfield id="hour" type="number" inputmode="numeric" .value="${this.hours.toFixed()}" .label="${this.hourLabel}" name="hours" @change="${this._valueChanged}" @focusin="${this._onFocus}" no-spinner .required="${this.required}" .autoValidate="${this.autoValidate}" maxlength="2" max="${(0,l.J)(this._hourMax)}" min="0" .disabled="${this.disabled}" suffix=":" class="hasSuffix"> </ha-textfield> <ha-textfield id="min" type="number" inputmode="numeric" .value="${this._formatValue(this.minutes)}" .label="${this.minLabel}" @change="${this._valueChanged}" @focusin="${this._onFocus}" name="minutes" no-spinner .required="${this.required}" .autoValidate="${this.autoValidate}" maxlength="2" max="59" min="0" .disabled="${this.disabled}" .suffix="${this.enableSecond?":":""}" class="${this.enableSecond?"has-suffix":""}"> </ha-textfield> ${this.enableSecond?a.qy`<ha-textfield id="sec" type="number" inputmode="decimal" step="any" .value="${this._formatValue(this.seconds)}" .label="${this.secLabel}" @change="${this._valueChanged}" @focusin="${this._onFocus}" name="seconds" no-spinner .required="${this.required}" .autoValidate="${this.autoValidate}" max="59" min="0" .disabled="${this.disabled}" .suffix="${this.enableMillisecond?":":""}" class="${this.enableMillisecond?"has-suffix":""}"> </ha-textfield>`:a.s6} ${this.enableMillisecond?a.qy`<ha-textfield id="millisec" type="number" .value="${this._formatValue(this.milliseconds,3)}" .label="${this.millisecLabel}" @change="${this._valueChanged}" @focusin="${this._onFocus}" name="milliseconds" no-spinner .required="${this.required}" .autoValidate="${this.autoValidate}" maxlength="3" max="999" min="0" .disabled="${this.disabled}"> </ha-textfield>`:a.s6} ${!this.clearable||this.required||this.disabled?a.s6:a.qy`<ha-icon-button label="clear" @click="${this._clearValue}" .path="${"M19,6.41L17.59,5L12,10.59L6.41,5L5,6.41L10.59,12L5,17.59L6.41,19L12,13.41L17.59,19L19,17.59L13.41,12L19,6.41Z"}"></ha-icon-button>`} </div> ${24===this.format?a.s6:a.qy`<ha-select .required="${this.required}" .value="${this.amPm}" .disabled="${this.disabled}" name="amPm" naturalMenuWidth fixedMenuPosition @selected="${this._valueChanged}" @closed="${r.d}"> <ha-list-item value="AM">AM</ha-list-item> <ha-list-item value="PM">PM</ha-list-item> </ha-select>`} </div> ${this.helper?a.qy`<ha-input-helper-text .disabled="${this.disabled}">${this.helper}</ha-input-helper-text>`:a.s6} `}_clearValue(){(0,n.r)(this,"value-changed")}_valueChanged(t){const e=t.currentTarget;this[e.name]="amPm"===e.name?e.value:Number(e.value);const i={hours:this.hours,minutes:this.minutes,seconds:this.seconds,milliseconds:this.milliseconds};this.enableDay&&(i.days=this.days),12===this.format&&(i.amPm=this.amPm),(0,n.r)(this,"value-changed",{value:i})}_onFocus(t){t.currentTarget.select()}_formatValue(t,e=2){const i=t.toString();return i.includes(".")?i:i.padStart(e,"0")}get _hourMax(){if(!this.noHoursLimit)return 12===this.format?12:23}constructor(...t){super(...t),this.autoValidate=!1,this.required=!1,this.format=12,this.disabled=!1,this.days=0,this.hours=0,this.minutes=0,this.seconds=0,this.milliseconds=0,this.dayLabel="",this.hourLabel="",this.minLabel="",this.secLabel="",this.millisecLabel="",this.enableSecond=!1,this.enableMillisecond=!1,this.enableDay=!1,this.noHoursLimit=!1,this.amPm="AM"}}h.styles=a.AH`:host([clearable]){position:relative}.time-input-wrap-wrap{display:flex}.time-input-wrap{display:flex;flex:var(--time-input-flex,unset);border-radius:var(--mdc-shape-small,var(--ha-border-radius-sm)) var(--mdc-shape-small,var(--ha-border-radius-sm)) var(--ha-border-radius-square) var(--ha-border-radius-square);overflow:hidden;position:relative;direction:ltr;padding-right:3px}ha-textfield{width:60px;flex-grow:1;text-align:center;--mdc-shape-small:0;--text-field-appearance:none;--text-field-padding:0 4px;--text-field-suffix-padding-left:2px;--text-field-suffix-padding-right:0;--text-field-text-align:center}ha-textfield.hasSuffix{--text-field-padding:0 0 0 4px}ha-textfield:first-child{--text-field-border-top-left-radius:var(--mdc-shape-medium)}ha-textfield:last-child{--text-field-border-top-right-radius:var(--mdc-shape-medium)}ha-select{--mdc-shape-small:0;width:85px}:host([clearable]) .mdc-select__anchor{padding-inline-end:var(--select-selected-text-padding-end,12px)}ha-icon-button{position:relative;--mdc-icon-button-size:36px;--mdc-icon-size:20px;color:var(--secondary-text-color);direction:var(--direction);display:flex;align-items:center;background-color:var(--mdc-text-field-fill-color,#f5f5f5);border-bottom-style:solid;border-bottom-width:1px}label{-moz-osx-font-smoothing:var(--ha-moz-osx-font-smoothing);-webkit-font-smoothing:var(--ha-font-smoothing);font-family:var(
        --mdc-typography-body2-font-family,
        var(--mdc-typography-font-family, var(--ha-font-family-body))
      );font-size:var(--mdc-typography-body2-font-size, var(--ha-font-size-s));line-height:var(
        --mdc-typography-body2-line-height,
        var(--ha-line-height-condensed)
      );font-weight:var(--mdc-typography-body2-font-weight,var(--ha-font-weight-normal));letter-spacing:var(
        --mdc-typography-body2-letter-spacing,
        .0178571429em
      );text-decoration:var(--mdc-typography-body2-text-decoration,inherit);text-transform:var(--mdc-typography-body2-text-transform,inherit);color:var(--mdc-theme-text-primary-on-background,rgba(0,0,0,.87));padding-left:4px;padding-inline-start:4px;padding-inline-end:initial}ha-input-helper-text{padding-top:8px;line-height:var(--ha-line-height-condensed)}`,(0,s.Cg)([(0,o.MZ)()],h.prototype,"label",void 0),(0,s.Cg)([(0,o.MZ)()],h.prototype,"helper",void 0),(0,s.Cg)([(0,o.MZ)({attribute:"auto-validate",type:Boolean})],h.prototype,"autoValidate",void 0),(0,s.Cg)([(0,o.MZ)({type:Boolean})],h.prototype,"required",void 0),(0,s.Cg)([(0,o.MZ)({type:Number})],h.prototype,"format",void 0),(0,s.Cg)([(0,o.MZ)({type:Boolean})],h.prototype,"disabled",void 0),(0,s.Cg)([(0,o.MZ)({type:Number})],h.prototype,"days",void 0),(0,s.Cg)([(0,o.MZ)({type:Number})],h.prototype,"hours",void 0),(0,s.Cg)([(0,o.MZ)({type:Number})],h.prototype,"minutes",void 0),(0,s.Cg)([(0,o.MZ)({type:Number})],h.prototype,"seconds",void 0),(0,s.Cg)([(0,o.MZ)({type:Number})],h.prototype,"milliseconds",void 0),(0,s.Cg)([(0,o.MZ)({type:String,attribute:"day-label"})],h.prototype,"dayLabel",void 0),(0,s.Cg)([(0,o.MZ)({type:String,attribute:"hour-label"})],h.prototype,"hourLabel",void 0),(0,s.Cg)([(0,o.MZ)({type:String,attribute:"min-label"})],h.prototype,"minLabel",void 0),(0,s.Cg)([(0,o.MZ)({type:String,attribute:"sec-label"})],h.prototype,"secLabel",void 0),(0,s.Cg)([(0,o.MZ)({type:String,attribute:"ms-label"})],h.prototype,"millisecLabel",void 0),(0,s.Cg)([(0,o.MZ)({attribute:"enable-second",type:Boolean})],h.prototype,"enableSecond",void 0),(0,s.Cg)([(0,o.MZ)({attribute:"enable-millisecond",type:Boolean})],h.prototype,"enableMillisecond",void 0),(0,s.Cg)([(0,o.MZ)({attribute:"enable-day",type:Boolean})],h.prototype,"enableDay",void 0),(0,s.Cg)([(0,o.MZ)({attribute:"no-hours-limit",type:Boolean})],h.prototype,"noHoursLimit",void 0),(0,s.Cg)([(0,o.MZ)({attribute:!1})],h.prototype,"amPm",void 0),(0,s.Cg)([(0,o.MZ)({type:Boolean,reflect:!0})],h.prototype,"clearable",void 0),h=(0,s.Cg)([(0,o.EM)("ha-base-time-input")],h)},19463(t,e,i){i.a(t,async function(t,e){try{var s=i(62826),a=i(96196),o=i(44457),l=i(380),n=i(72487),r=i(1087),h=i(46927),d=(i(67094),i(75709),t([n]));n=(d.then?(await d)():d)[0];const u="M19,19H5V8H19M16,1V3H8V1H6V3H5C3.89,3 3,3.89 3,5V19A2,2 0 0,0 5,21H19A2,2 0 0,0 21,19V5C21,3.89 20.1,3 19,3H18V1M17,12H12V17H17V12Z",c=()=>Promise.all([i.e("93785"),i.e("12036"),i.e("80557"),i.e("70082"),i.e("92371")]).then(i.bind(i,85858)),p=(t,e)=>{(0,r.r)(t,"show-dialog",{dialogTag:"ha-dialog-date-picker",dialogImport:c,dialogParams:e})};class m extends a.WF{render(){return a.qy`<ha-textfield .label="${this.label}" .helper="${this.helper}" .disabled="${this.disabled}" iconTrailing helperPersistent readonly="readonly" @click="${this._openDialog}" @keydown="${this._keyDown}" .value="${this.value?(0,n.zB)(new Date(`${this.value.split("T")[0]}T00:00:00`),{...this.locale,time_zone:h.Wj.local},{}):""}" .required="${this.required}"> <ha-svg-icon slot="trailingIcon" .path="${u}"></ha-svg-icon> </ha-textfield>`}_openDialog(){this.disabled||p(this,{min:this.min||"1970-01-01",max:this.max,value:this.value,canClear:this.canClear,onChange:t=>this._valueChanged(t),locale:this.locale.language,firstWeekday:(0,l.P)(this.locale)})}_keyDown(t){if(["Space","Enter"].includes(t.code))return t.preventDefault(),t.stopPropagation(),void this._openDialog();this.canClear&&["Backspace","Delete"].includes(t.key)&&this._valueChanged(void 0)}_valueChanged(t){this.value!==t&&(this.value=t,(0,r.r)(this,"change"),(0,r.r)(this,"value-changed",{value:t}))}constructor(...t){super(...t),this.disabled=!1,this.required=!1,this.canClear=!1}}m.styles=a.AH`ha-svg-icon{color:var(--secondary-text-color)}ha-textfield{display:block}`,(0,s.Cg)([(0,o.MZ)({attribute:!1})],m.prototype,"locale",void 0),(0,s.Cg)([(0,o.MZ)()],m.prototype,"value",void 0),(0,s.Cg)([(0,o.MZ)()],m.prototype,"min",void 0),(0,s.Cg)([(0,o.MZ)()],m.prototype,"max",void 0),(0,s.Cg)([(0,o.MZ)({type:Boolean})],m.prototype,"disabled",void 0),(0,s.Cg)([(0,o.MZ)({type:Boolean})],m.prototype,"required",void 0),(0,s.Cg)([(0,o.MZ)()],m.prototype,"label",void 0),(0,s.Cg)([(0,o.MZ)()],m.prototype,"helper",void 0),(0,s.Cg)([(0,o.MZ)({attribute:"can-clear",type:Boolean})],m.prototype,"canClear",void 0),m=(0,s.Cg)([(0,o.EM)("ha-date-input")],m),e()}catch(t){e(t)}})},39045(t,e,i){i.a(t,async function(t,s){try{i.r(e),i.d(e,{HaDateTimeSelector:()=>d});var a=i(62826),o=i(96196),l=i(44457),n=i(1087),r=i(19463),h=(i(50286),i(3449),t([r]));r=(h.then?(await h)():h)[0];class d extends o.WF{render(){const t="string"==typeof this.value?this.value.split(" "):void 0;return o.qy` <div class="input"> <ha-date-input .label="${this.label}" .locale="${this.hass.locale}" .disabled="${this.disabled}" .required="${this.required}" .value="${t?.[0]}" @value-changed="${this._valueChanged}"> </ha-date-input> <ha-time-input enable-second .value="${t?.[1]||"00:00:00"}" .locale="${this.hass.locale}" .disabled="${this.disabled}" .required="${this.required}" @value-changed="${this._valueChanged}"></ha-time-input> </div> ${this.helper?o.qy`<ha-input-helper-text .disabled="${this.disabled}">${this.helper}</ha-input-helper-text>`:""} `}_valueChanged(t){t.stopPropagation(),this._dateInput.value&&this._timeInput.value&&(0,n.r)(this,"value-changed",{value:`${this._dateInput.value} ${this._timeInput.value}`})}constructor(...t){super(...t),this.disabled=!1,this.required=!0}}d.styles=o.AH`.input{display:flex;align-items:center;flex-direction:row}ha-date-input{min-width:150px;margin-right:4px;margin-inline-end:4px;margin-inline-start:initial}`,(0,a.Cg)([(0,l.MZ)({attribute:!1})],d.prototype,"hass",void 0),(0,a.Cg)([(0,l.MZ)({attribute:!1})],d.prototype,"selector",void 0),(0,a.Cg)([(0,l.MZ)()],d.prototype,"value",void 0),(0,a.Cg)([(0,l.MZ)()],d.prototype,"label",void 0),(0,a.Cg)([(0,l.MZ)()],d.prototype,"helper",void 0),(0,a.Cg)([(0,l.MZ)({type:Boolean,reflect:!0})],d.prototype,"disabled",void 0),(0,a.Cg)([(0,l.MZ)({type:Boolean})],d.prototype,"required",void 0),(0,a.Cg)([(0,l.P)("ha-date-input")],d.prototype,"_dateInput",void 0),(0,a.Cg)([(0,l.P)("ha-time-input")],d.prototype,"_timeInput",void 0),d=(0,a.Cg)([(0,l.EM)("ha-selector-datetime")],d),s()}catch(t){s(t)}})},31157(t,e,i){i.a(t,async function(t,s){try{i.r(e),i.d(e,{HaNumberSelector:()=>u});var a=i(62826),o=i(96196),l=i(44457),n=i(94333),r=i(1087),h=(i(3449),i(70759)),d=(i(75709),t([h]));h=(d.then?(await d)():d)[0];class u extends o.WF{willUpdate(t){t.has("value")&&(""!==this._valueStr&&this.value===Number(this._valueStr)||(this._valueStr=null==this.value||isNaN(this.value)?"":this.value.toString()))}render(){const t="box"===this.selector.number?.mode||void 0===this.selector.number?.min||void 0===this.selector.number?.max;let e;if(!t&&(e=this.selector.number.step??1,"any"===e)){e=1;const t=(this.selector.number.max-this.selector.number.min)/100;for(;e>t;)e/=10}const i=this.selector.number?.translation_key;let s=this.selector.number?.unit_of_measurement;return t&&s&&this.localizeValue&&i&&(s=this.localizeValue(`${i}.unit_of_measurement.${s}`)||s),o.qy` ${this.label&&!t?o.qy`${this.label}${this.required?"*":""}`:o.s6} <div class="input"> ${t?o.s6:o.qy` <ha-slider labeled .min="${this.selector.number.min}" .max="${this.selector.number.max}" .value="${this.value}" .step="${e}" .disabled="${this.disabled}" .required="${this.required}" @change="${this._handleSliderChange}" .withMarkers="${this.selector.number?.slider_ticks||!1}"> </ha-slider> `} <ha-textfield .inputMode="${"any"===this.selector.number?.step||(this.selector.number?.step??1)%1!=0?"decimal":"numeric"}" .label="${t?this.label:void 0}" .placeholder="${this.placeholder}" class="${(0,n.H)({single:t})}" .min="${this.selector.number?.min}" .max="${this.selector.number?.max}" .value="${this._valueStr??""}" .step="${this.selector.number?.step??1}" helperPersistent .helper="${t?this.helper:void 0}" .disabled="${this.disabled}" .required="${this.required}" .suffix="${s}" type="number" autoValidate ?no-spinner="${!t}" @input="${this._handleInputChange}"> </ha-textfield> </div> ${!t&&this.helper?o.qy`<ha-input-helper-text .disabled="${this.disabled}">${this.helper}</ha-input-helper-text>`:o.s6} `}_handleInputChange(t){t.stopPropagation(),this._valueStr=t.target.value;const e=""===t.target.value||isNaN(t.target.value)?void 0:Number(t.target.value);this.value!==e&&(0,r.r)(this,"value-changed",{value:e})}_handleSliderChange(t){t.stopPropagation();const e=Number(t.target.value);this.value!==e&&(0,r.r)(this,"value-changed",{value:e})}constructor(...t){super(...t),this.required=!0,this.disabled=!1,this._valueStr=""}}u.styles=o.AH`.input{display:flex;justify-content:space-between;align-items:center;direction:ltr}ha-slider{flex:1;margin-right:16px;margin-inline-end:16px;margin-inline-start:0}ha-textfield{--ha-textfield-input-width:40px}.single{--ha-textfield-input-width:unset;flex:1}`,(0,a.Cg)([(0,l.MZ)({attribute:!1})],u.prototype,"hass",void 0),(0,a.Cg)([(0,l.MZ)({attribute:!1})],u.prototype,"selector",void 0),(0,a.Cg)([(0,l.MZ)({type:Number})],u.prototype,"value",void 0),(0,a.Cg)([(0,l.MZ)({type:Number})],u.prototype,"placeholder",void 0),(0,a.Cg)([(0,l.MZ)()],u.prototype,"label",void 0),(0,a.Cg)([(0,l.MZ)()],u.prototype,"helper",void 0),(0,a.Cg)([(0,l.MZ)({attribute:!1})],u.prototype,"localizeValue",void 0),(0,a.Cg)([(0,l.MZ)({type:Boolean})],u.prototype,"required",void 0),(0,a.Cg)([(0,l.MZ)({type:Boolean})],u.prototype,"disabled",void 0),u=(0,a.Cg)([(0,l.EM)("ha-selector-number")],u),s()}catch(t){s(t)}})},50286(t,e,i){var s=i(62826),a=i(96196),o=i(44457),l=i(69543),n=i(1087);i(32656);class r extends a.WF{render(){const t=(0,l.J)(this.locale);let e=NaN,i=NaN,s=NaN,o=0;if(this.value){const a=this.value?.split(":")||[];i=a[1]?Number(a[1]):0,s=a[2]?Number(a[2]):0,e=a[0]?Number(a[0]):0,o=e,o&&t&&o>12&&o<24&&(e=o-12),t&&0===o&&(e=12)}return a.qy` <ha-base-time-input .label="${this.label}" .hours="${e}" .minutes="${i}" .seconds="${s}" .format="${t?12:24}" .amPm="${t&&o>=12?"PM":"AM"}" .disabled="${this.disabled}" @value-changed="${this._timeChanged}" .enableSecond="${this.enableSecond}" .required="${this.required}" .clearable="${this.clearable&&void 0!==this.value}" .helper="${this.helper}" day-label="dd" hour-label="hh" min-label="mm" sec-label="ss" ms-label="ms"></ha-base-time-input> `}_timeChanged(t){t.stopPropagation();const e=t.detail.value,i=(0,l.J)(this.locale);let s;if(!(void 0===e||isNaN(e.hours)&&isNaN(e.minutes)&&isNaN(e.seconds))){let t=e.hours||0;e&&i&&("PM"===e.amPm&&t<12&&(t+=12),"AM"===e.amPm&&12===t&&(t=0)),s=`${t.toString().padStart(2,"0")}:${e.minutes?e.minutes.toString().padStart(2,"0"):"00"}:${e.seconds?e.seconds.toString().padStart(2,"0"):"00"}`}s!==this.value&&(this.value=s,(0,n.r)(this,"change"),(0,n.r)(this,"value-changed",{value:s}))}constructor(...t){super(...t),this.disabled=!1,this.required=!1,this.enableSecond=!1}}(0,s.Cg)([(0,o.MZ)({attribute:!1})],r.prototype,"locale",void 0),(0,s.Cg)([(0,o.MZ)()],r.prototype,"value",void 0),(0,s.Cg)([(0,o.MZ)()],r.prototype,"label",void 0),(0,s.Cg)([(0,o.MZ)()],r.prototype,"helper",void 0),(0,s.Cg)([(0,o.MZ)({type:Boolean})],r.prototype,"disabled",void 0),(0,s.Cg)([(0,o.MZ)({type:Boolean})],r.prototype,"required",void 0),(0,s.Cg)([(0,o.MZ)({type:Boolean,attribute:"enable-second"})],r.prototype,"enableSecond",void 0),(0,s.Cg)([(0,o.MZ)({type:Boolean,reflect:!0})],r.prototype,"clearable",void 0),r=(0,s.Cg)([(0,o.EM)("ha-time-input")],r)},19691(t,e,i){i.a(t,async function(t,s){try{i.r(e),i.d(e,{DialogStatisticsFixUnsupportedUnitMetadata:()=>_});i(44114),i(18111),i(7588);var a=i(62826),o=i(76331),l=i(96196),n=i(44457),r=i(22786),h=i(95747),d=i(1087),u=i(65829),c=(i(72554),i(18350)),p=(i(52763),i(43661),i(28732),i(39045)),m=i(31157),g=(i(67094),i(23528)),b=i(65063),v=i(14503),y=i(81619),f=t([u,c,p,m,h]);[u,c,p,m,h]=f.then?(await f)():f;class _ extends l.WF{showDialog(t){this._params=t;const e=new Date;e.setMinutes(e.getMinutes()-e.getMinutes()%5,0),this._moment=(0,o.s)(e),this._fetchStats()}closeDialog(){this._params=void 0,this._moment=void 0,this._stats5min=void 0,this._statsHour=void 0,this._origAmount=void 0,this._amount=void 0,this._chosenStat=void 0,this._busy=!1,(0,d.r)(this,"dialog-closed",{dialog:this.localName})}render(){if(!this._params)return l.s6;let t;return t=this._chosenStat?this._renderAdjustStat():this._renderPickStatistic(),l.qy` <ha-dialog open scrimClickAction escapeKeyAction @closed="${this.closeDialog}" .heading="${this.hass.localize("ui.panel.config.developer-tools.tabs.statistics.fix_issue.adjust_sum.title")}"> ${t} </ha-dialog> `}shouldUpdate(t){if(1!==t.size||!t.has("hass"))return!0;const e=t.get("hass");return!e||e.localize!==this.hass.localize}_renderPickStatistic(){let t;if(this._stats5min&&this._statsHour)if(this._statsHour.length<1&&this._stats5min.length<1)t=l.qy`<p> ${this.hass.localize("ui.panel.config.developer-tools.tabs.statistics.fix_issue.adjust_sum.no_statistics_found")} </p>`;else{const e=this._stats5min.length>=1?this._stats5min:this._statsHour,i=(0,g.JE)(this.hass,this._params.statistic.statistic_id,this._params.statistic),s=[];for(const t of e){const e=Math.round(100*t.change)/100;s.push(l.qy` <ha-list-item twoline hasMeta .stat="${t}" @click="${this._setChosenStatistic}"> <span>${e} ${i}</span> <span slot="secondary"> ${(0,h.r6)(new Date(t.start),this.hass.locale,this.hass.config)} </span> <ha-icon-next slot="meta"></ha-icon-next> </ha-list-item> `)}t=l.qy`${s}`}else t=l.qy`<ha-spinner></ha-spinner>`;return l.qy` <div class="text-content"> ${this.hass.localize("ui.panel.config.developer-tools.tabs.statistics.fix_issue.adjust_sum.info_text_1")} </div> <div class="text-content"> <b>${this.hass.localize("ui.panel.config.developer-tools.tabs.statistics.fix_issue.adjust_sum.statistic")}</b> ${this._params.statistic.statistic_id} </div> <ha-selector-datetime .label="${this.hass.localize("ui.panel.config.developer-tools.tabs.statistics.fix_issue.adjust_sum.pick_a_time")}" .hass="${this.hass}" .selector="${this._dateTimeSelector}" .value="${this._moment}" @value-changed="${this._dateTimeSelectorChanged}"></ha-selector-datetime> <div class="stat-list">${t}</div> <ha-button appearance="plain" slot="secondaryAction" @click="${this._fetchOutliers}"> ${this.hass.localize("ui.panel.config.developer-tools.tabs.statistics.fix_issue.adjust_sum.outliers")} </ha-button> <ha-button slot="primaryAction" dialogAction="cancel"> ${this.hass.localize("ui.common.close")} </ha-button> `}_clearChosenStatistic(){this._chosenStat=void 0}_setChosenStatistic(t){const e=t.currentTarget.stat,i=Math.round(100*e.change)/100;this._chosenStat=e,this._origAmount=i,this._amount=i}_dateTimeSelectorChanged(t){this._moment=t.detail.value,this._fetchStats()}_renderAdjustStat(){const t=(0,g.JE)(this.hass,this._params.statistic.statistic_id,this._params.statistic);return l.qy` <div class="text-content"> <b>${this.hass.localize("ui.panel.config.developer-tools.tabs.statistics.fix_issue.adjust_sum.statistic")}</b> ${this._params.statistic.statistic_id} </div> <div class="table-row"> <span>${this.hass.localize("ui.panel.config.developer-tools.tabs.statistics.fix_issue.adjust_sum.start")}</span> <span>${(0,h.r6)(new Date(this._chosenStat.start),this.hass.locale,this.hass.config)}</span> </div> <div class="table-row"> <span>${this.hass.localize("ui.panel.config.developer-tools.tabs.statistics.fix_issue.adjust_sum.end")}</span> <span>${(0,h.r6)(new Date(this._chosenStat.end),this.hass.locale,this.hass.config)}</span> </div> <ha-selector-number .label="${this.hass.localize("ui.panel.config.developer-tools.tabs.statistics.fix_issue.adjust_sum.new_value")}" .hass="${this.hass}" .selector="${this._amountSelector(t||void 0)}" .value="${this._amount}" .disabled="${this._busy}" @value-changed="${this._amountChanged}"></ha-selector-number> <ha-button slot="secondaryAction" .disabled="${this._busy}" @click="${this._clearChosenStatistic}" appearance="plain"> ${this.hass.localize("ui.common.back")}</ha-button> <ha-button slot="primaryAction" .disabled="${this._busy}" @click="${this._fixIssue}"> ${this.hass.localize("ui.panel.config.developer-tools.tabs.statistics.fix_issue.adjust_sum.adjust")}</ha-button> `}_amountChanged(t){this._amount=t.detail.value}async _fetchStats(){this._stats5min=void 0,this._statsHour=void 0;const t=this._params.statistic.statistic_id,e=new Date(this._moment.replace(" ","T")),i=new Date(e.getTime());i.setTime(i.getTime()-72e5);const s=new Date(e.getTime());s.setTime(s.getTime()+108e5);const a=await(0,g.sz)(this.hass,i,s,[t],"hour");if(this._statsHour=t in a?a[t].slice(0,5):[],0===this._statsHour.length)return void(this._stats5min=[]);const o=new Date(e.getTime());o.setTime(o.getTime()-6e5);const l=new Date(e.getTime());l.setTime(l.getTime()+9e5);const n=await(0,g.sz)(this.hass,o,l,[t],"5minute");this._stats5min=t in n?n[t].slice(0,5):[]}async _fetchOutliers(){this._stats5min=void 0,this._statsHour=void 0;const t=this._params.statistic.statistic_id,e=new Date(0),i=new Date,s=await(0,g.sz)(this.hass,e,i,[t],"hour"),a=t in s?s[t]:[];if(0===a.length)return;const o=await(0,g.sz)(this.hass,e,i,[t],"5minute"),l=t in o?o[t]:[];l.shift();const n=[];a.forEach(t=>{n.push({hour:t,fiveMin:[]})});const r={hour:null,fiveMin:[]};let h=0;l.forEach(t=>{let e=!1;for(;h<n.length;h++){const i=n[h].hour;if(i&&t.start>=i.start&&t.end<=i.end){n[h].fiveMin.push(t),e=!0;break}}e||r.fiveMin.push(t)}),n.push(r);let d=[],u=0;const c=t=>{const e=Math.abs(t.change??0);(d.length<10||e>u)&&(d.push(t),d=d.sort((t,e)=>Math.abs(e.change??0)-Math.abs(t.change??0)),d=d.slice(0,10),u=d[d.length-1].change??0)};n.forEach(t=>{0===t.fiveMin.length&&t.hour?c(t.hour):t.fiveMin.forEach(t=>{c(t)})}),this._statsHour=d,this._stats5min=[]}async _fixIssue(){const t=(0,g.JE)(this.hass,this._params.statistic.statistic_id,this._params.statistic);this._busy=!0;try{await(0,g.Uf)(this.hass,this._params.statistic.statistic_id,this._chosenStat.start,this._amount-this._origAmount,t||null)}catch(t){return this._busy=!1,void(0,b.showAlertDialog)(this,{text:this.hass.localize("ui.panel.config.developer-tools.tabs.statistics.fix_issue.adjust_sum.error_sum_adjusted",{message:t.message||t})})}(0,y.P)(this,{message:this.hass.localize("ui.panel.config.developer-tools.tabs.statistics.fix_issue.adjust_sum.sum_adjusted")}),this.closeDialog()}static get styles(){return[v.RF,v.nA,l.AH`@media all and (max-width:450px),all and (max-height:500px){ha-dialog{--mdc-dialog-max-height:100%;height:100%}}@media all and (min-width:850px){ha-dialog{--mdc-dialog-max-height:80%;--mdc-dialog-max-height:80%}}@media all and (min-width:451px) and (min-height:501px){ha-dialog{--mdc-dialog-max-width:480px}}.text-content,ha-selector-datetime,ha-selector-number{margin-bottom:var(--ha-space-5)}ha-list-item{margin:0 -24px;--mdc-list-side-padding:24px}.table-row{display:flex;justify-content:space-between;margin-bottom:var(--ha-space-5)}.stat-list{min-height:360px;display:flex;flex-direction:column}.stat-list ha-spinner{margin:0 auto}`]}constructor(...t){super(...t),this._busy=!1,this._dateTimeSelector={datetime:{}},this._amountSelector=(0,r.A)(t=>({number:{step:.01,unit_of_measurement:t,mode:"box"}}))}}(0,a.Cg)([(0,n.MZ)({attribute:!1})],_.prototype,"hass",void 0),(0,a.Cg)([(0,n.wk)()],_.prototype,"_params",void 0),(0,a.Cg)([(0,n.wk)()],_.prototype,"_busy",void 0),(0,a.Cg)([(0,n.wk)()],_.prototype,"_moment",void 0),(0,a.Cg)([(0,n.wk)()],_.prototype,"_stats5min",void 0),(0,a.Cg)([(0,n.wk)()],_.prototype,"_statsHour",void 0),(0,a.Cg)([(0,n.wk)()],_.prototype,"_chosenStat",void 0),(0,a.Cg)([(0,n.wk)()],_.prototype,"_amount",void 0),_=(0,a.Cg)([(0,n.EM)("dialog-statistics-adjust-sum")],_),s()}catch(t){s(t)}})},43332(t,e,i){function s(t,e){return(t<0?"-":"")+Math.abs(t).toString().padStart(e,"0")}i.d(e,{F:()=>s})},76331(t,e,i){i.d(e,{s:()=>l});var s=i(43332),a=i(94864),o=i(83504);function l(t,e){const i=(0,o.a)(t,e?.in);if(!(0,a.f)(i))throw new RangeError("Invalid time value");const l=e?.format??"extended",n=e?.representation??"complete";let r="";const h="extended"===l?"-":"",d="extended"===l?":":"";if("time"!==n){const t=(0,s.F)(i.getDate(),2),e=(0,s.F)(i.getMonth()+1,2);r=`${(0,s.F)(i.getFullYear(),4)}${h}${e}${h}${t}`}if("date"!==n){r=`${r}${""===r?"":" "}${(0,s.F)(i.getHours(),2)}${d}${(0,s.F)(i.getMinutes(),2)}${d}${(0,s.F)(i.getSeconds(),2)}`}return r}},94864(t,e,i){function s(t){return t instanceof Date||"object"==typeof t&&"[object Date]"===Object.prototype.toString.call(t)}i.d(e,{f:()=>o});var a=i(83504);function o(t){return!(!s(t)&&"number"!=typeof t||isNaN(+(0,a.a)(t)))}}};
//# sourceMappingURL=51448.d5bb4e3a2a0c0afc.js.map