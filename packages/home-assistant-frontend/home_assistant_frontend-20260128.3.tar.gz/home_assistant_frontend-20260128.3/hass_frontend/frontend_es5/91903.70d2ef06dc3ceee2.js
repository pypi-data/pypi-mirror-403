"use strict";(self.webpackChunkhome_assistant_frontend=self.webpackChunkhome_assistant_frontend||[]).push([["91903"],{91069:function(t,e,i){i.a(t,async function(t,s){try{i.d(e,{EO:function(){return D},Yq:function(){return O},_U:function(){return k},eE:function(){return b},fU:function(){return C},ol:function(){return v},xo:function(){return w}});var n=i(78016),a=i(31810),o=i(49134),r=i(81977),c=i(36307),l=i(35932),h=i(73983),d=i(6946),u=i(92913),_=i(83339),p=i(77972),f=i(31886),g=i(46927),m=t([f]);f=(m.then?(await m)():m)[0];const y=(t,e,i,s)=>{const n=i(new f.BB(t,e),s);return n instanceof Date?new Date(n.getTime()):n},v=(t,e,i,s,n)=>i.time_zone===g.Wj.server?y(t,s.time_zone,e,n):e(t,n),w=(t,e,i,s,n)=>i.time_zone===g.Wj.server?y(t,s.time_zone,e,n):e(t,n),D=(t,e,i,s,n)=>w(t,i,s,n,s.time_zone===g.Wj.server?new f.BB(e,n.time_zone):e),b=(t,e,i,s,f)=>{let g,m;if(w(t,n.e,s,f)&&w(e,a.c,s,f)){const n=(D(e,t,o.W,s,f)+1)*(i?1:-1);g=v(t,r.P,s,f,n),m=v(v(e,r.P,s,f,n),c.p,s,f)}else if(w(t,t=>(0,l.o)(t).getMilliseconds()===t.getMilliseconds(),s,f)&&w(e,t=>(0,h.D)(t).getMilliseconds()===t.getMilliseconds(),s,f)){const n=(D(e,t,d.c,s,f)+1)*(i?1:-1);g=v(t,u.f,s,f,n),m=v(e,u.f,s,f,n)}else{const n=D(e,t,_.b,s,f)*(i?1:-1);g=v(t,p.A,s,f,n),m=v(e,p.A,s,f,n)}return{start:g,end:m}},k=(t,e)=>{const i=new f.BB(t,e);return new Date(i.getTime())},O=(t,e)=>new f.BB(t,e).toISOString().split("T")[0],C=(t,e)=>new f.BB(t,e).toISOString().split("T")[1].split(".")[0];s()}catch(y){s(y)}})},46223:function(t,e,i){i.a(t,async function(t,s){try{i.d(e,{b:function(){return D}});var n=i(35932),a=i(73983),o=i(92913),r=i(52640),c=i(69137),l=i(35660),h=i(36307),d=i(11650),u=i(15797),_=i(33977),p=i(69748),f=i(55144),g=i(21828),m=i(66708),y=i(91069),v=i(380),w=t([v,y]);[v,y]=w.then?(await w)():w;const D=(t,e)=>{const i=new Date,s=(0,v.P)(t.locale);switch(e){case"today":return[(0,y.ol)(i,n.o,t.locale,t.config,{weekStartsOn:s}),(0,y.ol)(i,a.D,t.locale,t.config,{weekStartsOn:s})];case"yesterday":return[(0,y.ol)((0,o.f)(i,-1),n.o,t.locale,t.config,{weekStartsOn:s}),(0,y.ol)((0,o.f)(i,-1),a.D,t.locale,t.config,{weekStartsOn:s})];case"this_week":return[(0,y.ol)(i,r.k,t.locale,t.config,{weekStartsOn:s}),(0,y.ol)(i,c.$,t.locale,t.config,{weekStartsOn:s})];case"this_month":return[(0,y.ol)(i,l.w,t.locale,t.config),(0,y.ol)(i,h.p,t.locale,t.config)];case"this_quarter":return[(0,y.ol)(i,d.a,t.locale,t.config),(0,y.ol)(i,u.j,t.locale,t.config)];case"this_year":return[(0,y.ol)(i,_.D,t.locale,t.config),(0,y.ol)(i,p.Q,t.locale,t.config)];case"now-7d":return[(0,y.ol)(i,f.e,t.locale,t.config,7),(0,y.ol)(i,f.e,t.locale,t.config,0)];case"now-30d":return[(0,y.ol)(i,f.e,t.locale,t.config,30),(0,y.ol)(i,f.e,t.locale,t.config,0)];case"now-12m":return[(0,y.ol)(i,g.a,t.locale,t.config,12),(0,y.ol)(i,g.a,t.locale,t.config,0)];case"now-1h":return[(0,y.ol)(i,m.O,t.locale,t.config,1),(0,y.ol)(i,m.O,t.locale,t.config,0)];case"now-12h":return[(0,y.ol)(i,m.O,t.locale,t.config,12),(0,y.ol)(i,m.O,t.locale,t.config,0)];case"now-24h":return[(0,y.ol)(i,m.O,t.locale,t.config,24),(0,y.ol)(i,m.O,t.locale,t.config,0)]}return[i,i]};s()}catch(D){s(D)}})},23528:function(t,e,i){i.a(t,async function(t,s){try{i.d(e,{$3:function(){return m},$O:function(){return C},$j:function(){return y},ED:function(){return r},JE:function(){return S},OQ:function(){return x},PU:function(){return $},Ph:function(){return f},Uf:function(){return O},W1:function(){return g},Wr:function(){return u},Z:function(){return h},gF:function(){return v},iY:function(){return w},jU:function(){return c},nN:function(){return k},p3:function(){return d},pJ:function(){return p},r_:function(){return l},sz:function(){return _}});i(74423),i(18111),i(13579),i(62953);var n=i(28978),a=i(380),o=t([a]);a=(o.then?(await o)():o)[0];var r=function(t){return t[t.NONE=0]="NONE",t[t.ARITHMETIC=1]="ARITHMETIC",t[t.CIRCULAR=2]="CIRCULAR",t}({});const c=["entity_not_recorded","entity_no_longer_recorded","state_class_removed","units_changed","mean_type_changed","no_state"],l=["L","gal","ft³","m³","CCF","MCF"],h=t=>t.sendMessagePromise({type:"recorder/info"}),d=(t,e)=>t.callWS({type:"recorder/list_statistic_ids",statistic_type:e}),u=(t,e)=>t.callWS({type:"recorder/get_statistics_metadata",statistic_ids:e}),_=(t,e,i,s,n="hour",a,o)=>t.callWS({type:"recorder/statistics_during_period",start_time:e.toISOString(),end_time:null==i?void 0:i.toISOString(),statistic_ids:s,period:n,units:a,types:o}),p=(t,e,i,s)=>t.callWS({type:"recorder/statistic_during_period",statistic_id:e,units:s,fixed_period:i.fixed_period?{start_time:i.fixed_period.start instanceof Date?i.fixed_period.start.toISOString():i.fixed_period.start,end_time:i.fixed_period.end instanceof Date?i.fixed_period.end.toISOString():i.fixed_period.end}:void 0,calendar:i.calendar?Object.assign(Object.assign({},"week"===i.calendar.period?{first_weekday:(0,a.D)(t.locale).substring(0,3)}:{}),i.calendar):void 0,rolling_window:i.rolling_window}),f=t=>t.callWS({type:"recorder/validate_statistics"}),g=(t,e,i,s)=>t.callWS({type:"recorder/update_statistics_metadata",statistic_id:e,unit_of_measurement:i,unit_class:s}),m=(t,e)=>t.callWS({type:"recorder/clear_statistics",statistic_ids:e}),y=t=>{let e=null;if(!t)return null;for(const i of t)null!==i.change&&void 0!==i.change&&(null===e?e=i.change:e+=i.change);return e},v=(t,e)=>{let i=null;for(const s of e){if(!(s in t))continue;const e=y(t[s]);null!==e&&(null===i?i=e:i+=e)}return i},w=(t,e)=>t.some(t=>void 0!==t[e]&&null!==t[e]),D=["mean","min","max"],b=["sum","state","change"],k=(t,e)=>!(!D.includes(e)||0===t.mean_type)||!(!b.includes(e)||!t.has_sum),O=(t,e,i,s,n)=>{const a=new Date(i).toISOString();return t.callWS({type:"recorder/adjust_sum_statistics",statistic_id:e,start_time:a,adjustment:s,adjustment_unit_of_measurement:n})},C=(t,e,i)=>{const s=t.states[e];return s?(0,n.u)(s):(null==i?void 0:i.name)||e},S=(t,e,i)=>{let s;var n;e&&(s=null===(n=t.states[e])||void 0===n?void 0:n.attributes.unit_of_measurement);return void 0===s?null==i?void 0:i.statistics_unit_of_measurement:s},x=t=>t.includes(":"),$=t=>t.callWS({type:"recorder/update_statistics_issues"});s()}catch(c){s(c)}})},56342:function(t,e,i){i.a(t,async function(t,s){try{i.r(e),i.d(e,{HuiEnergyDateSelectionCard:function(){return _}});var n=i(40445),a=i(96196),o=i(77845),r=(i(76776),i(784)),c=i(73887),l=t([c]);c=(l.then?(await l)():l)[0];let h,d,u=t=>t;class _ extends a.WF{getCardSize(){return 1}getGridOptions(){return{rows:1,columns:12}}setConfig(t){this._config=t}shouldUpdate(t){return(0,r.xP)(this,t)||t.size>1||!t.has("hass")}render(){return this.hass&&this._config?(0,a.qy)(h||(h=u` <ha-card> <div class="card-content"> <hui-energy-period-selector .hass="${0}" .collectionKey="${0}"></hui-energy-period-selector> </div> </ha-card> `),this.hass,this._config.collection_key):a.s6}}_.styles=(0,a.AH)(d||(d=u`ha-card{height:100%;display:flex;flex-direction:column;justify-content:center}`)),(0,n.Cg)([(0,o.MZ)({attribute:!1})],_.prototype,"hass",void 0),(0,n.Cg)([(0,o.wk)()],_.prototype,"_config",void 0),_=(0,n.Cg)([(0,o.EM)("hui-energy-date-selection-card")],_),s()}catch(h){s(h)}})},73887:function(t,e,i){i.a(t,async function(t,e){try{var s=i(69235),n=(i(3362),i(62953),i(40445)),a=i(35932),o=i(73983),r=i(52640),c=i(69137),l=i(6946),h=i(55144),d=i(40600),u=i(78016),_=i(31810),p=i(49134),f=i(96196),g=i(77845),m=i(94333),y=i(22786),v=i(91069),w=i(46223),D=i(380),b=i(72487),k=i(9899),O=i(18350),C=i(15397),S=i(29823),x=(i(70947),i(3059),i(45100),i(67094),i(38114)),$=i(54706),z=t([s,O,C,S,b,D,w,x,v]);[s,O,C,S,b,D,w,x,v]=z.then?(await z)():z;let M,A,W,E,P,j=t=>t;const I="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z",T="M12,16A2,2 0 0,1 14,18A2,2 0 0,1 12,20A2,2 0 0,1 10,18A2,2 0 0,1 12,16M12,10A2,2 0 0,1 14,12A2,2 0 0,1 12,14A2,2 0 0,1 10,12A2,2 0 0,1 12,10M12,4A2,2 0 0,1 14,6A2,2 0 0,1 12,8A2,2 0 0,1 10,6A2,2 0 0,1 12,4Z",U=["today","yesterday","this_week","this_month","this_quarter","this_year","now-7d","now-30d","now-12m"];class B extends((0,$.E)(f.WF)){hassSubscribe(){return[(0,x.tb)(this.hass,{key:this.collectionKey}).subscribe(t=>this._updateDates(t))]}_measure(){this.narrow=this.offsetWidth<450}async _attachObserver(){this._resizeObserver||(this._resizeObserver=new ResizeObserver((0,k.s)(()=>this._measure(),250,!1))),this._resizeObserver.observe(this)}firstUpdated(){this._attachObserver()}connectedCallback(){super.connectedCallback(),this.updateComplete.then(()=>this._attachObserver())}disconnectedCallback(){super.disconnectedCallback(),this._resizeObserver&&this._resizeObserver.disconnect()}willUpdate(t){var e,i;super.willUpdate(t),this.hasUpdated||this._measure(),(!this.hasUpdated||t.has("hass")&&(null===(e=this.hass)||void 0===e?void 0:e.localize)!==(null===(i=t.get("hass"))||void 0===i?void 0:i.localize))&&(this._ranges={},U.forEach(t=>{this._ranges[this.hass.localize(`ui.components.date-range-picker.ranges.${t}`)]=(0,w.b)(this.hass,t)}))}render(){if(!this.hass||!this._startDate)return f.s6;const t=this._simpleRange(this._startDate,this._endDate,this.hass.locale,this.hass.config);return(0,f.qy)(M||(M=j` <div class="${0}"> <div class="backdrop"></div> <div class="label"> ${0} </div> <div class="time-handle"> <ha-icon-button-prev .label="${0}" @click="${0}"></ha-icon-button-prev> <ha-icon-button-next .label="${0}" @click="${0}"></ha-icon-button-next> <ha-date-range-picker .hass="${0}" .startDate="${0}" .endDate="${0}" .ranges="${0}" @value-changed="${0}" @preset-selected="${0}" @toggle="${0}" minimal header-position .verticalOpeningDirection="${0}"></ha-date-range-picker> </div> ${0} <ha-dropdown placement="bottom-end" @wa-select="${0}"> <ha-icon-button slot="trigger" .label="${0}" .path="${0}"></ha-icon-button> ${0} <slot name="overflow-menu"></slot> </ha-dropdown> </div> `),(0,m.H)({row:!0,"datepicker-open":this._datepickerOpen}),"day"===t?this.narrow?(0,b.kz)(this._startDate,this.hass.locale,this.hass.config):(0,b.Yq)(this._startDate,this.hass.locale,this.hass.config):"month"===t?(0,b.fr)(this._startDate,this.hass.locale,this.hass.config):"year"===t?(0,b.Pm)(this._startDate,this.hass.locale,this.hass.config):`${(0,b.sl)(this._startDate,this.hass.locale,this.hass.config)} – ${(0,b.sl)(this._endDate||new Date,this.hass.locale,this.hass.config)}`,this.hass.localize("ui.panel.lovelace.components.energy_period_selector.previous"),this._pickPrevious,this.hass.localize("ui.panel.lovelace.components.energy_period_selector.next"),this._pickNext,this.hass,this._startDate,this._endDate||new Date,this._ranges,this._dateRangeChanged,this._presetSelected,this._handleDatepickerToggle,this.verticalOpeningDirection,this.narrow?f.s6:(0,f.qy)(A||(A=j`<ha-button appearance="filled" size="small" @click="${0}"> ${0} </ha-button>`),this._pickNow,this.hass.localize("ui.panel.lovelace.components.energy_period_selector.now")),this._handleMenuAction,this.hass.localize("ui.common.menu"),T,this.allowCompare?(0,f.qy)(W||(W=j`<ha-dropdown-item value="toggle-compare"> ${0} ${0} </ha-dropdown-item>`),this._compare?(0,f.qy)(E||(E=j`<ha-svg-icon slot="icon" .path="${0}"></ha-svg-icon>`),I):f.s6,this.hass.localize("ui.panel.lovelace.components.energy_period_selector.compare")):f.s6)}_updateCollectionPeriod(){const t=(0,x.tb)(this.hass,{key:this.collectionKey});t.setPeriod(this._startDate,this._endDate),t.refresh()}_dateRangeChanged(t){this._startDate=(0,v.ol)(t.detail.value.startDate,a.o,this.hass.locale,this.hass.config),this._endDate=(0,v.ol)(t.detail.value.endDate,o.D,this.hass.locale,this.hass.config),this._updateCollectionPeriod()}_presetSelected(t){localStorage.setItem(`energy-default-period-_${this.collectionKey||"energy"}`,U[t.detail.index])}_pickNow(){if(!this._startDate)return;const t=this._simpleRange(this._startDate,this._endDate,this.hass.locale,this.hass.config),e=new Date;if("month"===t)[this._startDate,this._endDate]=(0,w.b)(this.hass,"this_month");else if("quarter"===t)[this._startDate,this._endDate]=(0,w.b)(this.hass,"this_quarter");else if("year"===t)[this._startDate,this._endDate]=(0,w.b)(this.hass,"this_year");else{const t=(0,D.P)(this.hass.locale),i=(0,v.ol)(this._endDate,r.k,this.hass.locale,this.hass.config,{weekStartsOn:t}),s=(0,v.ol)(this._endDate,c.$,this.hass.locale,this.hass.config,{weekStartsOn:t});if(this._startDate.getTime()===i.getTime()&&this._endDate.getTime()===s.getTime())[this._startDate,this._endDate]=(0,w.b)(this.hass,"this_week");else{const i=(0,v.EO)(this._endDate,this._startDate,l.c,this.hass.locale,this.hass.config);this._startDate=(0,v.ol)((0,v.ol)(e,h.e,this.hass.locale,this.hass.config,i),a.o,this.hass.locale,this.hass.config,{weekStartsOn:t}),this._endDate=(0,v.ol)(e,o.D,this.hass.locale,this.hass.config,{weekStartsOn:t})}}this._updateCollectionPeriod()}_pickPrevious(){this._shift(!1)}_pickNext(){this._shift(!0)}_shift(t){if(!this._startDate)return;const{start:e,end:i}=(0,v.eE)(this._startDate,this._endDate,t,this.hass.locale,this.hass.config);this._startDate=e,this._endDate=i,this._updateCollectionPeriod()}_updateDates(t){this._compare=void 0!==t.startCompare,this._startDate=t.start,this._endDate=t.end||(0,d.o)()}_handleDatepickerToggle(t){this._datepickerOpen=t.detail.open}_handleMenuAction(t){"toggle-compare"===t.detail.item.value&&this._toggleCompare()}_toggleCompare(){this._compare=!this._compare;const t=(0,x.tb)(this.hass,{key:this.collectionKey});t.setCompare(this._compare?x.lh.PREVIOUS:x.lh.NONE),t.refresh()}constructor(...t){super(...t),this.allowCompare=!0,this._datepickerOpen=!1,this._ranges={},this._compare=!1,this._simpleRange=(0,y.A)((t,e,i,s)=>{if(0===(0,l.c)(e,t))return"day";if((0,v.xo)(t,u.e,i,s)&&(0,v.xo)(e,_.c,i,s)){if(0===(0,v.EO)(e,t,p.W,i,s))return"month";if(2===(0,v.EO)(e,t,p.W,i,s)&&t.getMonth()%3==0)return"quarter"}return(0,v.xo)(t,u.e,i,s)&&(0,v.xo)(e,_.c,i,s)&&11===(0,v.EO)(e,t,p.W,i,s)?"year":"other"})}}B.styles=(0,f.AH)(P||(P=j`.row{display:flex;align-items:center;justify-content:space-between}:host .time-handle{display:flex;justify-content:flex-end;align-items:center}:host([narrow]) .time-handle{margin-left:auto;margin-inline-start:auto;margin-inline-end:initial}.label{display:flex;align-items:center;justify-content:flex-end;font-size:var(--ha-font-size-xl);margin-left:auto;margin-inline-start:auto;margin-inline-end:initial}:host([fixed]) .label,:host([narrow]) .label{margin-left:unset;margin-inline-start:unset;margin-inline-end:initial}ha-button{margin-left:8px;margin-inline-start:8px;margin-inline-end:initial;flex-shrink:0;--ha-button-theme-color:currentColor}.backdrop{position:fixed;top:0;left:0;right:0;bottom:0;z-index:var(--dialog-z-index,8);-webkit-backdrop-filter:var(--ha-dialog-scrim-backdrop-filter,var(--dialog-backdrop-filter));backdrop-filter:var(--ha-dialog-scrim-backdrop-filter,var(--dialog-backdrop-filter));pointer-events:none;opacity:0;transition:opacity var(--ha-animation-base-duration) ease-in-out}.datepicker-open .backdrop{opacity:1;pointer-events:auto}`)),(0,n.Cg)([(0,g.MZ)({attribute:!1})],B.prototype,"hass",void 0),(0,n.Cg)([(0,g.MZ)({attribute:"collection-key"})],B.prototype,"collectionKey",void 0),(0,n.Cg)([(0,g.MZ)({type:Boolean,reflect:!0})],B.prototype,"narrow",void 0),(0,n.Cg)([(0,g.MZ)({type:Boolean,reflect:!0})],B.prototype,"fixed",void 0),(0,n.Cg)([(0,g.MZ)({type:Boolean,attribute:"allow-compare"})],B.prototype,"allowCompare",void 0),(0,n.Cg)([(0,g.MZ)({attribute:"vertical-opening-direction"})],B.prototype,"verticalOpeningDirection",void 0),(0,n.Cg)([(0,g.wk)()],B.prototype,"_datepickerOpen",void 0),(0,n.Cg)([(0,g.wk)()],B.prototype,"_startDate",void 0),(0,n.Cg)([(0,g.wk)()],B.prototype,"_endDate",void 0),(0,n.Cg)([(0,g.wk)()],B.prototype,"_ranges",void 0),(0,n.Cg)([(0,g.wk)()],B.prototype,"_compare",void 0),B=(0,n.Cg)([(0,g.EM)("hui-energy-period-selector")],B),e()}catch(M){e(M)}})},56434:function(t,e,i){i.d(e,{e:function(){return n}});var s=i(81977);function n(t,e,i){return(0,s.P)(t,12*e,i)}},40600:function(t,e,i){i.d(e,{o:function(){return n}});var s=i(73983);function n(t){return(0,s.D)(Date.now(),t)}}}]);
//# sourceMappingURL=91903.70d2ef06dc3ceee2.js.map