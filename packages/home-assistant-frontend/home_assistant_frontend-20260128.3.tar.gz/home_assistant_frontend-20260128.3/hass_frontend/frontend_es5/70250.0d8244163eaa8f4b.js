"use strict";(self.webpackChunkhome_assistant_frontend=self.webpackChunkhome_assistant_frontend||[]).push([["70250"],{67084:function(t,i,e){e.d(i,{A:function(){return s}});const a=(t,i=2)=>{let e=""+t;for(let a=1;a<i;a++)e=parseInt(e)<10**a?`0${e}`:e;return e};function s(t){const i=Math.floor(t/1e3/3600),e=Math.floor(t/1e3%3600/60),s=Math.floor(t/1e3%3600%60),o=Math.floor(t%1e3);return i>0?`${i}:${a(e)}:${a(s)}`:e>0?`${e}:${a(s)}`:s>0||o>0?`${s}${o>0?`.${a(o,3)}`:""}`:null}},75428:function(t,i,e){e.d(i,{D:function(){return o}});var a=e(75158),s=e.n(a);const o=t=>s()(t,{whiteList:{},stripIgnoreTag:!0,stripIgnoreTagBody:!0})},23577:function(t,i,e){e.a(t,async function(t,i){try{e(44114),e(18111),e(20116),e(7588),e(13579),e(17642),e(58004),e(33853),e(45876),e(32475),e(15024),e(31698),e(62953);var a=e(40445),s=e(96196),o=e(77845),h=e(6415),n=e(90433),r=e(15638),l=e(44439),d=e(95747),c=e(20058),m=e(3461),u=e(1087),p=e(38279),y=e(8549),g=e(75428),_=t([l,d,c]);[l,d,c]=_.then?(await _)():_;let v,x=t=>t;const f=t=>{const i=parseFloat(t);return isFinite(i)?i:null};class b extends s.WF{render(){return(0,s.qy)(v||(v=x` <ha-chart-base .hass="${0}" .data="${0}" .options="${0}" .height="${0}" style="${0}" @dataset-hidden="${0}" @dataset-unhidden="${0}" @chart-zoom="${0}" .expandLegend="${0}" .hideResetButton="${0}"></ha-chart-base> `),this.hass,this._chartData,this._chartOptions,this.height,(0,h.W)({height:this.height}),this._datasetHidden,this._datasetUnhidden,this._handleDataZoom,this.expandLegend,this.hideResetButton)}_datasetHidden(t){this._hiddenStats.add(t.detail.id)}_datasetUnhidden(t){this._hiddenStats.delete(t.detail.id)}zoom(t,i){this.shadowRoot.querySelector("ha-chart-base").zoom(t,i,!0)}_handleDataZoom(t){var i,e;(0,u.r)(this,"chart-zoom-with-index",{start:null!==(i=t.detail.start)&&void 0!==i?i:0,end:null!==(e=t.detail.end)&&void 0!==e?e:100,chartIndex:this.chartIndex})}willUpdate(t){if((t.has("data")||t.has("startTime")||t.has("endTime")||this._chartTime<new Date(this.endTime.getTime()-l.p))&&this._generateData(),!this.hasUpdated||t.has("showNames")||t.has("startTime")||t.has("endTime")||t.has("unit")||t.has("logarithmicScale")||t.has("minYAxis")||t.has("maxYAxis")||t.has("fitYData")||t.has("paddingYAxis")||t.has("_visualMap")||t.has("_yWidth")){const t=(0,r.qC)(this.hass);let i=this.minYAxis,e=this.maxYAxis;"number"==typeof i?this.fitYData&&(i=({min:t})=>Math.min(this._roundYAxis(t,Math.floor),this.minYAxis)):this.logarithmicScale&&(i=({min:t})=>{const i=t>0?.95*t:1.05*t;return this._roundYAxis(i,Math.floor)}),"number"==typeof e?this.fitYData&&(e=({max:t})=>Math.max(this._roundYAxis(t,Math.ceil),this.maxYAxis)):this.logarithmicScale&&(e=({max:t})=>{const i=t>0?1.05*t:.95*t;return this._roundYAxis(i,Math.ceil)}),this._chartOptions={xAxis:{type:"time",min:this.startTime,max:this.endTime},yAxis:{type:this.logarithmicScale?"log":"value",name:this.unit,min:this._clampYAxis(i),max:this._clampYAxis(e),position:t?"right":"left",scale:!0,nameGap:2,nameTextStyle:{align:"left"},axisLine:{show:!1},axisLabel:{margin:5,formatter:this._formatYAxisLabel}},legend:{type:"custom",show:this.showNames},grid:{top:15,left:t?1:Math.max(this.paddingYAxis,this._yWidth),right:t?Math.max(this.paddingYAxis,this._yWidth):1,bottom:20},visualMap:this._visualMap,tooltip:{trigger:"axis",appendTo:document.body,formatter:this._renderTooltip}}}}_generateData(){let t=0;const i=getComputedStyle(this),e=this.data,a=[],s=[],o=[];if(0===e.length)return;this._chartTime=new Date;const h=this.endTime,r=this.names||{};e.forEach((e,l)=>{const d=e.domain,c=r[e.entity_id]||e.name;let m=null;const u=[],y=(t,i)=>{i&&(t>h||(u.forEach((e,a)=>{null===i[a]&&m&&null!==m[a]&&e.data.push([t,m[a]]),e.data.push([t,i[a]])}),m=i))},g=(a,h,r,d=!1)=>{r||(r=(0,n.fI)(t,i),t++),u.push({id:a,data:[],type:"line",cursor:"default",name:h,color:r,symbol:"circle",symbolSize:1,step:"end",sampling:"minmax",animationDurationUpdate:0,lineStyle:{width:d?0:1.5},areaStyle:d?{color:r+"7F"}:void 0,tooltip:{show:!d}}),s.push(e.entity_id),o.push(l)};if("thermostat"===d||"climate"===d||"water_heater"===d){const t=e.states.some(t=>{var i;return null===(i=t.attributes)||void 0===i?void 0:i.hvac_action}),a="climate"===d&&t?t=>{var i;return"heat"===p.sx[null===(i=t.attributes)||void 0===i?void 0:i.hvac_action]}:t=>"heat"===t.state,s="climate"===d&&t?t=>{var i;return"cool"===p.sx[null===(i=t.attributes)||void 0===i?void 0:i.hvac_action]}:t=>"cool"===t.state,o=e.states.some(a),h=e.states.some(s),n=e.states.some(t=>t.attributes&&t.attributes.target_temp_high!==t.attributes.target_temp_low);g(e.entity_id+"-current_temperature",this.showNames?this.hass.localize("ui.card.climate.current_temperature",{name:c}):this.hass.localize("component.climate.entity_component._.state_attributes.current_temperature.name")),o&&g(e.entity_id+"-heating",this.showNames?this.hass.localize("ui.card.climate.heating",{name:c}):this.hass.localize("component.climate.entity_component._.state_attributes.hvac_action.state.heating"),i.getPropertyValue("--state-climate-heat-color"),!0),h&&g(e.entity_id+"-cooling",this.showNames?this.hass.localize("ui.card.climate.cooling",{name:c}):this.hass.localize("component.climate.entity_component._.state_attributes.hvac_action.state.cooling"),i.getPropertyValue("--state-climate-cool-color"),!0),n?(g(e.entity_id+"-target_temperature_mode",this.showNames?this.hass.localize("ui.card.climate.target_temperature_mode",{name:c,mode:this.hass.localize("ui.card.climate.high")}):this.hass.localize("component.climate.entity_component._.state_attributes.target_temp_high.name")),g(e.entity_id+"-target_temperature_mode_low",this.showNames?this.hass.localize("ui.card.climate.target_temperature_mode",{name:c,mode:this.hass.localize("ui.card.climate.low")}):this.hass.localize("component.climate.entity_component._.state_attributes.target_temp_low.name"))):g(e.entity_id+"-target_temperature",this.showNames?this.hass.localize("ui.card.climate.target_temperature_entity",{name:c}):this.hass.localize("component.climate.entity_component._.state_attributes.temperature.name")),e.states.forEach(t=>{if(!t.attributes)return;const i=f(t.attributes.current_temperature),e=[i];if(o&&e.push(a(t)?i:null),h&&e.push(s(t)?i:null),n){const i=f(t.attributes.target_temp_high),a=f(t.attributes.target_temp_low);e.push(i,a),y(new Date(t.last_changed),e)}else{const i=f(t.attributes.temperature);e.push(i),y(new Date(t.last_changed),e)}})}else if("humidifier"===d){const t=e.states.some(t=>{var i;return null===(i=t.attributes)||void 0===i?void 0:i.action}),a=e.states.some(t=>{var i;return null===(i=t.attributes)||void 0===i?void 0:i.current_humidity}),s=t&&e.states.some(t=>{var i;return"humidifying"===(null===(i=t.attributes)||void 0===i?void 0:i.action)}),o=t&&e.states.some(t=>{var i;return"drying"===(null===(i=t.attributes)||void 0===i?void 0:i.action)});g(e.entity_id+"-target_humidity",this.showNames?this.hass.localize("ui.card.humidifier.target_humidity_entity",{name:c}):this.hass.localize("component.humidifier.entity_component._.state_attributes.humidity.name")),a&&g(e.entity_id+"-current_humidity",this.showNames?this.hass.localize("ui.card.humidifier.current_humidity_entity",{name:c}):this.hass.localize("component.humidifier.entity_component._.state_attributes.current_humidity.name")),s?g(e.entity_id+"-humidifying",this.showNames?this.hass.localize("ui.card.humidifier.humidifying",{name:c}):this.hass.localize("component.humidifier.entity_component._.state_attributes.action.state.humidifying"),i.getPropertyValue("--state-humidifier-on-color"),!0):o?g(e.entity_id+"-drying",this.showNames?this.hass.localize("ui.card.humidifier.drying",{name:c}):this.hass.localize("component.humidifier.entity_component._.state_attributes.action.state.drying"),i.getPropertyValue("--state-humidifier-on-color"),!0):g(e.entity_id+"-on",this.showNames?this.hass.localize("ui.card.humidifier.on_entity",{name:c}):this.hass.localize("component.humidifier.entity_component._.state.on"),void 0,!0),e.states.forEach(t=>{var i;if(!t.attributes)return;const e=f(t.attributes.humidity),h=a?f(null===(i=t.attributes)||void 0===i?void 0:i.current_humidity):e,n=[e];var r;if(a&&n.push(h),s)n.push("humidifying"===(null===(r=t.attributes)||void 0===r?void 0:r.action)?h:null);else if(o){var l;n.push("drying"===(null===(l=t.attributes)||void 0===l?void 0:l.action)?h:null)}else n.push("on"===t.state?h:null);y(new Date(t.last_changed),n)})}else{let t,i;g(e.entity_id,c);let a=null;const s=e=>{const s=f(e.state),o=new Date(e.last_changed);if(null!==s&&a){var h;const e=o.getTime(),n=a.getTime(),r=null===(h=i)||void 0===h?void 0:h.getTime();y(a,[(n-r)/(e-r)*(s-t)+t]),y(new Date(n+1),[null]),y(o,[s]),i=o,t=s,a=null}else null!==s&&null===a?(y(o,[s]),i=o,t=s):null===s&&null===a&&void 0!==t&&(a=o)};if(e.statistics){const t=e.states&&0!==e.states.length?e.states[0].last_changed:0;for(const i of e.statistics){if(t&&i.last_changed>=t)break;s(i)}}e.states.forEach(t=>{s(t)}),null!==a&&y(a,[null])}y(h,m),Array.prototype.push.apply(a,u)}),this._chartData=a,this._entityIds=s,this._datasetToDataIndex=o;const l=[];this._chartData.forEach((t,i)=>{var e,a;const s=this._datasetToDataIndex[i],o=this.data[s];if(!o.statistics||0===o.statistics.length)return;const h=null!==(e=null===(a=o.states[0])||void 0===a?void 0:a.last_changed)&&void 0!==e?e:this.endTime.getTime();l.push({show:!1,seriesIndex:i,dimension:0,pieces:[{max:h-.01,colorAlpha:.5},{min:h,colorAlpha:1}]})}),this._visualMap=l.length>0?l:void 0}_clampYAxis(t){if(this.logarithmicScale){if("number"==typeof t)return Math.max(t,Number.EPSILON);if("function"==typeof t)return i=>Math.max(t(i),Number.EPSILON)}return t}_roundYAxis(t,i){return Math.abs(t)<1?t:i(t)}constructor(...t){super(...t),this.data=[],this.showNames=!0,this.clickForMoreInfo=!0,this.paddingYAxis=0,this.logarithmicScale=!1,this.fitYData=!1,this._chartData=[],this._entityIds=[],this._datasetToDataIndex=[],this._hiddenStats=new Set,this._yWidth=25,this._chartTime=new Date,this._previousYAxisLabelValue=0,this._yAxisMaximumFractionDigits=0,this._renderTooltip=t=>{const i=t[0].axisValue,e=(0,d.yg)(new Date(i),this.hass.locale,this.hass.config)+"<br>",a=[];this._chartData.forEach((e,s)=>{var o;if(!1===(null===(o=e.tooltip)||void 0===o?void 0:o.show)||this._hiddenStats.has(e.id))return;const h=t.find(t=>t.seriesIndex===s);if(h)return void a.push(h);let n;const r=e.data||[];for(let t=r.length-1;t>=0;t--){const e=r[t];if(e&&e[0]<=i&&"number"==typeof e[1]){n=e;break}}n&&a.push({seriesName:e.name,seriesIndex:s,value:n,marker:`<span style="display:inline-block;margin-right:4px;margin-inline-end:4px;margin-inline-start:initial;border-radius:10px;width:10px;height:10px;background-color:${e.color};"></span>`})});const s=this.unit?`${(0,y.A)(this.unit,this.hass.locale)}${this.unit}`:"";return e+a.map(t=>{const i=this._entityIds[t.seriesIndex],e=this.hass.states[i],a=this.hass.entities[i],o=String(t.value[1]);let h=e?this.hass.formatEntityState(e,o):`${(0,c.ZV)(o,this.hass.locale,(0,c.ZQ)(void 0,a))}${s}`;const n=this._datasetToDataIndex[t.seriesIndex],r=this.data[n];if(r.statistics&&r.statistics.length>0){h+="<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;";h+=0===r.states.length||t.value[0]<r.states[0].last_changed?`${this.hass.localize("ui.components.history_charts.source_stats")}`:`${this.hass.localize("ui.components.history_charts.source_history")}`}return t.seriesName?`${t.marker} ${(0,g.D)(t.seriesName)}: ${h}`:`${t.marker} ${h}`}).join("<br>")},this._formatYAxisLabel=t=>{const i=Math.max(1,-Math.floor(Math.log10(Math.abs(t-this._previousYAxisLabelValue||1))));this._yAxisMaximumFractionDigits=Math.max(this._yAxisMaximumFractionDigits,i);const e=(0,c.ZV)(t,this.hass.locale,{maximumFractionDigits:this._yAxisMaximumFractionDigits}),a=(0,m.W)(e,12)+5;return a>this._yWidth&&(this._yWidth=a,(0,u.r)(this,"y-width-changed",{value:this._yWidth,chartIndex:this.chartIndex})),this._previousYAxisLabelValue=t,e}}}(0,a.Cg)([(0,o.MZ)({attribute:!1})],b.prototype,"hass",void 0),(0,a.Cg)([(0,o.MZ)({attribute:!1})],b.prototype,"data",void 0),(0,a.Cg)([(0,o.MZ)({attribute:!1})],b.prototype,"names",void 0),(0,a.Cg)([(0,o.MZ)()],b.prototype,"unit",void 0),(0,a.Cg)([(0,o.MZ)()],b.prototype,"identifier",void 0),(0,a.Cg)([(0,o.MZ)({attribute:"show-names",type:Boolean})],b.prototype,"showNames",void 0),(0,a.Cg)([(0,o.MZ)({attribute:"click-for-more-info",type:Boolean})],b.prototype,"clickForMoreInfo",void 0),(0,a.Cg)([(0,o.MZ)({attribute:!1})],b.prototype,"startTime",void 0),(0,a.Cg)([(0,o.MZ)({attribute:!1})],b.prototype,"endTime",void 0),(0,a.Cg)([(0,o.MZ)({attribute:!1,type:Number})],b.prototype,"paddingYAxis",void 0),(0,a.Cg)([(0,o.MZ)({attribute:!1,type:Number})],b.prototype,"chartIndex",void 0),(0,a.Cg)([(0,o.MZ)({attribute:"logarithmic-scale",type:Boolean})],b.prototype,"logarithmicScale",void 0),(0,a.Cg)([(0,o.MZ)({attribute:!1,type:Number})],b.prototype,"minYAxis",void 0),(0,a.Cg)([(0,o.MZ)({attribute:!1,type:Number})],b.prototype,"maxYAxis",void 0),(0,a.Cg)([(0,o.MZ)({attribute:"fit-y-data",type:Boolean})],b.prototype,"fitYData",void 0),(0,a.Cg)([(0,o.MZ)({type:String})],b.prototype,"height",void 0),(0,a.Cg)([(0,o.MZ)({attribute:"expand-legend",type:Boolean})],b.prototype,"expandLegend",void 0),(0,a.Cg)([(0,o.MZ)({attribute:"hide-reset-button",type:Boolean})],b.prototype,"hideResetButton",void 0),(0,a.Cg)([(0,o.wk)()],b.prototype,"_chartData",void 0),(0,a.Cg)([(0,o.wk)()],b.prototype,"_entityIds",void 0),(0,a.Cg)([(0,o.wk)()],b.prototype,"_chartOptions",void 0),(0,a.Cg)([(0,o.wk)()],b.prototype,"_yWidth",void 0),(0,a.Cg)([(0,o.wk)()],b.prototype,"_visualMap",void 0),b=(0,a.Cg)([(0,o.EM)("state-history-chart-line")],b),i()}catch(v){i(v)}})},13672:function(t,i,e){e.a(t,async function(t,i){try{e(44114),e(18111),e(20116),e(7588),e(27495),e(25440),e(79978),e(62953);var a=e(40445),s=e(96196),o=e(77845),h=e(95747),n=e(67084),r=e(15638),l=e(44439),d=e(72190),c=e(71578),m=e(79622),u=e(79468),p=e(3461),y=e(1087),g=t([l,h]);[l,h]=g.then?(await g)():g;let _,v,x=t=>t;class f extends s.WF{render(){return(0,s.qy)(_||(_=x` <ha-chart-base .hass="${0}" .options="${0}" .height="${0}" .data="${0}" small-controls @chart-click="${0}" @chart-zoom="${0}" .hideResetButton="${0}"></ha-chart-base> `),this.hass,this._chartOptions,30*this.data.length+30+"px",this._chartData,this._handleChartClick,this._handleDataZoom,this.hideResetButton)}willUpdate(t){(t.has("startTime")||t.has("endTime")||t.has("data")||this._chartTime<new Date(this.endTime.getTime()-l.p))&&this._generateData(),(!this.hasUpdated||t.has("startTime")||t.has("endTime")||t.has("showNames")||t.has("paddingYAxis")||t.has("_yWidth"))&&this._createOptions()}_createOptions(){const t=this.narrow,i=this.chunked||this.showNames,e=t?105:185,a=i?Math.max(this.paddingYAxis,this._yWidth):0,s=(0,r.qC)(this.hass);this._chartOptions={xAxis:{type:"time",min:this.startTime,max:this.endTime,axisTick:{show:!0},splitLine:{show:!1}},yAxis:{type:"category",inverse:!0,position:s?"right":"left",triggerEvent:!0,axisTick:{show:!1},axisLine:{show:!1},axisLabel:{show:i,width:a,overflow:"truncate",margin:5,formatter:t=>{var i;const a=null===(i=this._chartData.find(i=>i.id===t))||void 0===i?void 0:i.name,s=a?Math.min((0,p.W)(a,12)+5,e):0;return s>this._yWidth&&(this._yWidth=s,(0,y.r)(this,"y-width-changed",{value:this._yWidth,chartIndex:this.chartIndex})),a},hideOverlap:!0}},grid:{top:10,bottom:30,left:s?1:a,right:s?a:1},tooltip:{appendTo:document.body,formatter:this._renderTooltip}}}zoom(t,i){this.shadowRoot.querySelector("ha-chart-base").zoom(t,i,!0)}_handleDataZoom(t){var i,e;(0,y.r)(this,"chart-zoom-with-index",{start:null!==(i=t.detail.start)&&void 0!==i?i:0,end:null!==(e=t.detail.end)&&void 0!==e?e:100,chartIndex:this.chartIndex})}_generateData(){const t=getComputedStyle(this);let i=this.data;i||(i=[]),this._chartTime=new Date;const e=this.startTime,a=this.endTime,s=[],o=this.names||{};i.forEach(i=>{let h,n=null,r=null,l=e;const c=this.showNames?o[i.entity_id]||i.name||i.entity_id:"",p=[];if(i.data.forEach(e=>{let s=e.state;if(s||(s=null),!(new Date(e.last_changed)>a))if(null===n)n=s,r=e.state_localize,l=new Date(e.last_changed);else if(s!==n){h=new Date(e.last_changed);const a=(0,d.c)(n,t,this.hass.states[i.entity_id]);p.push({value:[i.entity_id,l,h,r,a,(0,m.EP)((0,u.xp)(a))>.5?"#000":"#fff"],itemStyle:{color:a}}),n=s,r=e.state_localize,l=h}}),null!==n){const e=(0,d.c)(n,t,this.hass.states[i.entity_id]);p.push({value:[i.entity_id,l,a,r,e,(0,m.EP)((0,u.xp)(e))>.5?"#000":"#fff"],itemStyle:{color:e}})}s.push({id:i.entity_id,data:p,name:c,dimensions:["id","start","end","name","color","textColor"],type:"custom",encode:{x:[1,2],y:0,itemName:3},renderItem:this._renderItem,progressive:0})}),this._chartData=s}_handleChartClick(t){if("axisLabel"===t.detail.targetType){const i=this._chartData[t.detail.dataIndex];i&&(0,y.r)(this,"hass-more-info",{entityId:i.id})}}constructor(...t){super(...t),this.data=[],this.narrow=!1,this.showNames=!0,this.clickForMoreInfo=!0,this.chunked=!1,this.paddingYAxis=0,this._chartData=[],this._yWidth=0,this._chartTime=new Date,this._renderItem=(t,i)=>{const e=i.value(0),a=i.coord([i.value(1),e]),s=i.coord([i.value(2),e]),o=t.coordSys,h=c.default.graphic.clipRectByRect({x:a[0],y:a[1]-10,width:s[0]-a[0],height:20},{x:o.x,y:o.y,width:o.width,height:o.height});if(!h)return null;const n={type:"rect",transition:"shape",shape:h,style:{fill:i.value(4)}},r=i.value(3).replaceAll("\n"," ");return(0,p.W)(r,12)<h.width-8?{type:"group",children:[n,{type:"text",style:Object.assign(Object.assign({},h),{},{x:h.x+4,text:r,fill:i.value(5),fontSize:12,lineHeight:h.height})}]}:n},this._renderTooltip=t=>{const{value:i,name:e,marker:a,seriesName:s,color:o}=Array.isArray(t)?t[0]:t,l=s?`<h4 style="text-align: center; margin: 0;">${s}</h4>`:"",d=i[2]-i[1],c=`${this.hass.localize("ui.components.history_charts.duration")}: ${(0,n.A)(d)}`;return[l,[((0,r.qC)(this.hass)?`<span style="direction: rtl;display:inline-block;margin-right:4px;margin-inline-end:4px;border-radius:10px;width:10px;height:10px;background-color:${o};"></span>`:a)+e,(0,h.yg)(new Date(i[1]),this.hass.locale,this.hass.config),(0,h.yg)(new Date(i[2]),this.hass.locale,this.hass.config),c].join("<br>")].join("")}}}f.styles=(0,s.AH)(v||(v=x`ha-chart-base{--chart-max-height:none}`)),(0,a.Cg)([(0,o.MZ)({attribute:!1})],f.prototype,"hass",void 0),(0,a.Cg)([(0,o.MZ)({attribute:!1})],f.prototype,"data",void 0),(0,a.Cg)([(0,o.MZ)({type:Boolean})],f.prototype,"narrow",void 0),(0,a.Cg)([(0,o.MZ)({attribute:!1})],f.prototype,"names",void 0),(0,a.Cg)([(0,o.MZ)()],f.prototype,"unit",void 0),(0,a.Cg)([(0,o.MZ)()],f.prototype,"identifier",void 0),(0,a.Cg)([(0,o.MZ)({attribute:"show-names",type:Boolean})],f.prototype,"showNames",void 0),(0,a.Cg)([(0,o.MZ)({attribute:"click-for-more-info",type:Boolean})],f.prototype,"clickForMoreInfo",void 0),(0,a.Cg)([(0,o.MZ)({type:Boolean})],f.prototype,"chunked",void 0),(0,a.Cg)([(0,o.MZ)({attribute:!1})],f.prototype,"startTime",void 0),(0,a.Cg)([(0,o.MZ)({attribute:!1})],f.prototype,"endTime",void 0),(0,a.Cg)([(0,o.MZ)({attribute:!1,type:Number})],f.prototype,"paddingYAxis",void 0),(0,a.Cg)([(0,o.MZ)({attribute:!1,type:Number})],f.prototype,"chartIndex",void 0),(0,a.Cg)([(0,o.MZ)({attribute:"hide-reset-button",type:Boolean})],f.prototype,"hideResetButton",void 0),(0,a.Cg)([(0,o.wk)()],f.prototype,"_chartData",void 0),(0,a.Cg)([(0,o.wk)()],f.prototype,"_chartOptions",void 0),(0,a.Cg)([(0,o.wk)()],f.prototype,"_yWidth",void 0),f=(0,a.Cg)([(0,o.EM)("state-history-chart-timeline")],f),i()}catch(_){i(_)}})},66737:function(t,i,e){e.a(t,async function(t,i){try{e(74423),e(44114),e(72712),e(18111),e(7588),e(61701),e(18237),e(62953);var a=e(40445),s=e(96196),o=e(77845),h=e(36312),n=e(26218),r=e(85614),l=(e(27661),e(67094),e(23577)),d=e(13672),c=t([l,d]);[l,d]=c.then?(await c)():c;let m,u,p,y,g,_,v,x,f,b,w,C=t=>t;const M="M12,4C14.1,4 16.1,4.8 17.6,6.3C20.7,9.4 20.7,14.5 17.6,17.6C15.8,19.5 13.3,20.2 10.9,19.9L11.4,17.9C13.1,18.1 14.9,17.5 16.2,16.2C18.5,13.9 18.5,10.1 16.2,7.7C15.1,6.6 13.5,6 12,6V10.6L7,5.6L12,0.6V4M6.3,17.6C3.7,15 3.3,11 5.1,7.9L6.6,9.4C5.5,11.6 5.9,14.4 7.8,16.2C8.3,16.7 8.9,17.1 9.6,17.4L9,19.4C8,19 7.1,18.4 6.3,17.6Z",$=10,T=(t,i)=>t.reduce((t,e,a)=>{const s=Math.floor(a/i);return t[s]||(t[s]=[]),t[s].push(e),t},[]);class D extends s.WF{render(){if(!(0,h.x)(this.hass,"history"))return(0,s.qy)(m||(m=C`<div class="info"> ${0} </div>`),this.hass.localize("ui.components.history_charts.history_disabled"));if(this.isLoadingData&&!this.historyData)return(0,s.qy)(u||(u=C`<div class="info"> ${0} </div>`),this.hass.localize("ui.components.history_charts.loading_history"));if(this._isHistoryEmpty())return(0,s.qy)(p||(p=C`<div class="info"> ${0} </div>`),this.hass.localize("ui.components.history_charts.no_history_found"));const t=this.historyData.timeline.length?(this.virtualize?T(this.historyData.timeline,$):[this.historyData.timeline]).concat(this.historyData.line):this.historyData.line;return this._chartCount=t.length,(0,s.qy)(y||(y=C` ${0} ${0} `),this.virtualize?(0,s.qy)(g||(g=C`<div class="container ha-scrollbar" @scroll="${0}"> <lit-virtualizer scroller class="ha-scrollbar" .items="${0}" .renderItem="${0}"> </lit-virtualizer> </div>`),this._saveScrollPos,t,this._renderHistoryItem):(0,s.qy)(_||(_=C`${0}`),t.map((t,i)=>this._renderHistoryItem(t,i))),this.syncCharts&&this._hasZoomedCharts?(0,s.qy)(v||(v=C`<ha-fab slot="fab" class="reset-button" .label="${0}" @click="${0}"> <ha-svg-icon slot="icon" .path="${0}"></ha-svg-icon> </ha-fab>`),this.hass.localize("ui.components.history_charts.zoom_reset"),this._handleGlobalZoomReset,M):s.s6)}shouldUpdate(t){return(1!==t.size||!t.has("hass"))&&(1!==t.size||!t.has("_maxYWidth")||t.get("_maxYWidth")!==this._maxYWidth)}willUpdate(t){if(this.hasUpdated||(0,r.i)(),[...t.keys()].some(t=>!["_maxYWidth","_childYWidths","_chartCount"].includes(t))){const t=new Date;if(this._computedEndTime=this.upToNow||!this.endTime||this.endTime>t?t:this.endTime,this.startTime)this._computedStartTime=this.startTime;else if(this.hoursToShow)this._computedStartTime=new Date((new Date).getTime()-3600*this.hoursToShow*1e3);else{var i,e,a,s;let t=(null!==(i=null===(e=this.historyData)||void 0===e?void 0:e.timeline)&&void 0!==i?i:[]).reduce((t,i)=>Math.min(t,new Date(i.data[0].last_changed).getTime()),(new Date).getTime());t=(null!==(a=null===(s=this.historyData)||void 0===s?void 0:s.line)&&void 0!==a?a:[]).reduce((t,i)=>Math.min(t,i.data.reduce((t,i)=>Math.min(t,new Date(i.states[0].last_changed).getTime()),t)),t),this._computedStartTime=new Date(t)}}}updated(t){t.has("_chartCount")&&this._chartCount<this._childYWidths.length&&(this._childYWidths.length=this._chartCount,this._maxYWidth=Math.max(...Object.values(this._childYWidths),0))}_yWidthChanged(t){this._childYWidths[t.detail.chartIndex]=t.detail.value,this._maxYWidth=Math.max(...Object.values(this._childYWidths),0)}_handleTimelineSync(t){if(!this.syncCharts||this._isSyncing)return;const{start:i,end:e,chartIndex:a}=t.detail;this._hasZoomedCharts=0!==i||100!==e,this._syncZoomToAllCharts(i,e,a)}_syncZoomToAllCharts(t,i,e){this._isSyncing=!0,requestAnimationFrame(()=>{this.renderRoot.querySelectorAll("state-history-chart-line, state-history-chart-timeline").forEach((a,s)=>{s!==e&&"zoom"in a&&a.zoom(t,i)}),this._isSyncing=!1})}_handleGlobalZoomReset(){this._hasZoomedCharts=!1,this._isSyncing=!0,requestAnimationFrame(()=>{this.renderRoot.querySelectorAll("state-history-chart-line, state-history-chart-timeline").forEach(t=>{var i;const e=null===(i=t.renderRoot)||void 0===i?void 0:i.querySelector("ha-chart-base");e&&e.chart&&e.zoom(0,100)}),this._isSyncing=!1})}_isHistoryEmpty(){const t=!this.historyData||!this.historyData.timeline||!this.historyData.line||0===this.historyData.timeline.length&&0===this.historyData.line.length;return!this.isLoadingData&&t}_saveScrollPos(t){this._savedScrollPos=t.target.scrollTop}constructor(...t){super(...t),this.narrow=!1,this.virtualize=!1,this.upToNow=!1,this.showNames=!0,this.clickForMoreInfo=!0,this.isLoadingData=!1,this.logarithmicScale=!1,this.fitYData=!1,this.syncCharts=!1,this._maxYWidth=0,this._childYWidths=[],this._chartCount=0,this._hasZoomedCharts=!1,this._isSyncing=!1,this._renderHistoryItem=(t,i)=>t&&void 0!==i?Array.isArray(t)?(0,s.qy)(b||(b=C`<div class="entry-container timeline"> <state-history-chart-timeline .hass="${0}" .data="${0}" .startTime="${0}" .endTime="${0}" .showNames="${0}" .names="${0}" .narrow="${0}" .chunked="${0}" .paddingYAxis="${0}" .chartIndex="${0}" .clickForMoreInfo="${0}" @y-width-changed="${0}" @chart-zoom-with-index="${0}" ?hide-reset-button="${0}"></state-history-chart-timeline> </div> `),this.hass,t,this._computedStartTime,this._computedEndTime,this.showNames,this.names,this.narrow,this.virtualize,this._maxYWidth,i,this.clickForMoreInfo,this._yWidthChanged,this._handleTimelineSync,this.syncCharts):(0,s.qy)(f||(f=C`<div class="entry-container line"> <state-history-chart-line .hass="${0}" .unit="${0}" .data="${0}" .identifier="${0}" .showNames="${0}" .startTime="${0}" .endTime="${0}" .paddingYAxis="${0}" .names="${0}" .chartIndex="${0}" .clickForMoreInfo="${0}" .logarithmicScale="${0}" .minYAxis="${0}" .maxYAxis="${0}" .fitYData="${0}" @y-width-changed="${0}" @chart-zoom-with-index="${0}" .height="${0}" .expandLegend="${0}" ?hide-reset-button="${0}"></state-history-chart-line> </div> `),this.hass,t.unit,t.data,t.identifier,this.showNames,this._computedStartTime,this._computedEndTime,this._maxYWidth,this.names,i,this.clickForMoreInfo,this.logarithmicScale,this.minYAxis,this.maxYAxis,this.fitYData,this._yWidthChanged,this._handleTimelineSync,this.virtualize?void 0:this.height,this.expandLegend,this.syncCharts):(0,s.qy)(x||(x=C``))}}D.styles=(0,s.AH)(w||(w=C`:host{display:flex;flex-direction:column;min-height:60px}:host([virtualize]){height:100%}.info{text-align:center;line-height:60px;color:var(--secondary-text-color)}.container{max-height:var(--history-max-height)}.entry-container{width:100%}.entry-container.line{flex:1;padding-top:8px;overflow:hidden}.entry-container:hover{z-index:1}:host([virtualize]) .entry-container{padding-left:1px;padding-right:1px;padding-inline-start:1px;padding-inline-end:1px}.entry-container.timeline:first-child{margin-top:var(--timeline-top-margin)}.entry-container:not(:first-child){border-top:2px solid var(--divider-color);margin-top:16px}.container,lit-virtualizer{height:100%;width:100%}lit-virtualizer{contain:size layout!important}state-history-chart-line,state-history-chart-timeline{width:100%}.reset-button{position:fixed;bottom:calc(24px + var(--safe-area-inset-bottom));right:calc(24px + var(--safe-area-inset-bottom));z-index:1}`)),(0,a.Cg)([(0,o.MZ)({attribute:!1})],D.prototype,"hass",void 0),(0,a.Cg)([(0,o.MZ)({attribute:!1})],D.prototype,"historyData",void 0),(0,a.Cg)([(0,o.MZ)({type:Boolean})],D.prototype,"narrow",void 0),(0,a.Cg)([(0,o.MZ)({attribute:!1})],D.prototype,"names",void 0),(0,a.Cg)([(0,o.MZ)({type:Boolean,reflect:!0})],D.prototype,"virtualize",void 0),(0,a.Cg)([(0,o.MZ)({attribute:!1})],D.prototype,"endTime",void 0),(0,a.Cg)([(0,o.MZ)({attribute:!1})],D.prototype,"startTime",void 0),(0,a.Cg)([(0,o.MZ)({type:Boolean,attribute:"up-to-now"})],D.prototype,"upToNow",void 0),(0,a.Cg)([(0,o.MZ)({attribute:!1,type:Number})],D.prototype,"hoursToShow",void 0),(0,a.Cg)([(0,o.MZ)({attribute:"show-names",type:Boolean})],D.prototype,"showNames",void 0),(0,a.Cg)([(0,o.MZ)({attribute:"click-for-more-info",type:Boolean})],D.prototype,"clickForMoreInfo",void 0),(0,a.Cg)([(0,o.MZ)({attribute:"is-loading-data",type:Boolean})],D.prototype,"isLoadingData",void 0),(0,a.Cg)([(0,o.MZ)({attribute:"logarithmic-scale",type:Boolean})],D.prototype,"logarithmicScale",void 0),(0,a.Cg)([(0,o.MZ)({attribute:!1,type:Number})],D.prototype,"minYAxis",void 0),(0,a.Cg)([(0,o.MZ)({attribute:!1,type:Number})],D.prototype,"maxYAxis",void 0),(0,a.Cg)([(0,o.MZ)({attribute:"fit-y-data",type:Boolean})],D.prototype,"fitYData",void 0),(0,a.Cg)([(0,o.MZ)({type:String})],D.prototype,"height",void 0),(0,a.Cg)([(0,o.MZ)({attribute:"expand-legend",type:Boolean})],D.prototype,"expandLegend",void 0),(0,a.Cg)([(0,o.MZ)({attribute:"sync-charts",type:Boolean})],D.prototype,"syncCharts",void 0),(0,a.Cg)([(0,o.wk)()],D.prototype,"_maxYWidth",void 0),(0,a.Cg)([(0,o.wk)()],D.prototype,"_childYWidths",void 0),(0,a.Cg)([(0,o.wk)()],D.prototype,"_chartCount",void 0),(0,a.Cg)([(0,o.wk)()],D.prototype,"_hasZoomedCharts",void 0),(0,a.Cg)([(0,n.a)(".container")],D.prototype,"_savedScrollPos",void 0),(0,a.Cg)([(0,o.Ls)({passive:!0})],D.prototype,"_saveScrollPos",null),D=(0,a.Cg)([(0,o.EM)("state-history-charts")],D),i()}catch(m){i(m)}})},71578:function(t,i,e){e.r(i),e.d(i,{LinearGradient:function(){return x.A}});var a=e(88648),s=e(59126),o=e(25636),h=e(2403),n=e(3650),r=e(30137),l=e(69913),d=e(43401),c=e(87370),m=e(57610),u=e(44390),p=e(11069),y=e(88132),g=e(6036),_=e(88298),v=e(15490),x=e(67665);a.Y([o.a,h.a,n.a,r.a,l.a,d.a,c.a,m.a,u.a,p.a,g._,_.i,v.a,y.a]),i.default=s},3461:function(t,i,e){let a;function s(t,i,e="Roboto, Noto, sans-serif"){a||(a=document.createElement("canvas"));const s=a.getContext("2d");if(!s)return 0;s.font=`${i}px ${e}`;const o=s.measureText(t);return Math.ceil(Math.max(o.actualBoundingBoxRight+o.actualBoundingBoxLeft,o.width))}e.d(i,{W:function(){return s}})}}]);
//# sourceMappingURL=70250.0d8244163eaa8f4b.js.map