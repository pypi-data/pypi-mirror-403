export const __rspack_esm_id="43287";export const __rspack_esm_ids=["43287"];export const __webpack_modules__={91069(e,t,a){a.a(e,async function(e,r){try{a.d(t,{EO:()=>$,Yq:()=>C,_U:()=>k,eE:()=>v,fU:()=>S,ol:()=>f,xo:()=>w});var s=a(78016),l=a(31810),o=a(49134),c=a(81977),n=a(36307),i=a(35932),d=a(73983),_=a(6946),h=a(92913),u=a(83339),g=a(77972),m=a(31886),y=a(46927),p=e([m]);m=(p.then?(await p)():p)[0];const b=(e,t,a,r)=>{const s=a(new m.BB(e,t),r);return s instanceof Date?new Date(s.getTime()):s},f=(e,t,a,r,s)=>a.time_zone===y.Wj.server?b(e,r.time_zone,t,s):t(e,s),w=(e,t,a,r,s)=>a.time_zone===y.Wj.server?b(e,r.time_zone,t,s):t(e,s),$=(e,t,a,r,s)=>w(e,a,r,s,r.time_zone===y.Wj.server?new m.BB(t,s.time_zone):t),v=(e,t,a,r,m)=>{let y,p;if(w(e,s.e,r,m)&&w(t,l.c,r,m)){const s=($(t,e,o.W,r,m)+1)*(a?1:-1);y=f(e,c.P,r,m,s),p=f(f(t,c.P,r,m,s),n.p,r,m)}else if(w(e,e=>(0,i.o)(e).getMilliseconds()===e.getMilliseconds(),r,m)&&w(t,e=>(0,d.D)(e).getMilliseconds()===e.getMilliseconds(),r,m)){const s=($(t,e,_.c,r,m)+1)*(a?1:-1);y=f(e,h.f,r,m,s),p=f(t,h.f,r,m,s)}else{const s=$(t,e,u.b,r,m)*(a?1:-1);y=f(e,g.A,r,m,s),p=f(t,g.A,r,m,s)}return{start:y,end:p}},k=(e,t)=>{const a=new m.BB(e,t);return new Date(a.getTime())},C=(e,t)=>new m.BB(e,t).toISOString().split("T")[0],S=(e,t)=>new m.BB(e,t).toISOString().split("T")[1].split(".")[0];r()}catch(e){r(e)}})},46223(e,t,a){a.a(e,async function(e,r){try{a.d(t,{b:()=>$});var s=a(35932),l=a(73983),o=a(92913),c=a(52640),n=a(69137),i=a(35660),d=a(36307),_=a(11650),h=a(15797),u=a(33977),g=a(69748),m=a(55144),y=a(21828),p=a(66708),b=a(91069),f=a(380),w=e([b]);b=(w.then?(await w)():w)[0];const $=(e,t)=>{const a=new Date,r=(0,f.P)(e.locale);switch(t){case"today":return[(0,b.ol)(a,s.o,e.locale,e.config,{weekStartsOn:r}),(0,b.ol)(a,l.D,e.locale,e.config,{weekStartsOn:r})];case"yesterday":return[(0,b.ol)((0,o.f)(a,-1),s.o,e.locale,e.config,{weekStartsOn:r}),(0,b.ol)((0,o.f)(a,-1),l.D,e.locale,e.config,{weekStartsOn:r})];case"this_week":return[(0,b.ol)(a,c.k,e.locale,e.config,{weekStartsOn:r}),(0,b.ol)(a,n.$,e.locale,e.config,{weekStartsOn:r})];case"this_month":return[(0,b.ol)(a,i.w,e.locale,e.config),(0,b.ol)(a,d.p,e.locale,e.config)];case"this_quarter":return[(0,b.ol)(a,_.a,e.locale,e.config),(0,b.ol)(a,h.j,e.locale,e.config)];case"this_year":return[(0,b.ol)(a,u.D,e.locale,e.config),(0,b.ol)(a,g.Q,e.locale,e.config)];case"now-7d":return[(0,b.ol)(a,m.e,e.locale,e.config,7),(0,b.ol)(a,m.e,e.locale,e.config,0)];case"now-30d":return[(0,b.ol)(a,m.e,e.locale,e.config,30),(0,b.ol)(a,m.e,e.locale,e.config,0)];case"now-12m":return[(0,b.ol)(a,y.a,e.locale,e.config,12),(0,b.ol)(a,y.a,e.locale,e.config,0)];case"now-1h":return[(0,b.ol)(a,p.O,e.locale,e.config,1),(0,b.ol)(a,p.O,e.locale,e.config,0)];case"now-12h":return[(0,b.ol)(a,p.O,e.locale,e.config,12),(0,b.ol)(a,p.O,e.locale,e.config,0)];case"now-24h":return[(0,b.ol)(a,p.O,e.locale,e.config,24),(0,b.ol)(a,p.O,e.locale,e.config,0)]}return[a,a]};r()}catch(e){r(e)}})},23528(e,t,a){a.d(t,{$3:()=>m,$O:()=>k,$j:()=>y,ED:()=>l,JE:()=>C,OQ:()=>S,PU:()=>O,Ph:()=>u,Uf:()=>v,W1:()=>g,Wr:()=>d,Z:()=>n,gF:()=>p,iY:()=>b,jU:()=>o,nN:()=>$,p3:()=>i,pJ:()=>h,r_:()=>c,sz:()=>_});a(18111),a(13579);var r=a(28978),s=a(380),l=function(e){return e[e.NONE=0]="NONE",e[e.ARITHMETIC=1]="ARITHMETIC",e[e.CIRCULAR=2]="CIRCULAR",e}({});const o=["entity_not_recorded","entity_no_longer_recorded","state_class_removed","units_changed","mean_type_changed","no_state"],c=["L","gal","ft³","m³","CCF","MCF"],n=e=>e.sendMessagePromise({type:"recorder/info"}),i=(e,t)=>e.callWS({type:"recorder/list_statistic_ids",statistic_type:t}),d=(e,t)=>e.callWS({type:"recorder/get_statistics_metadata",statistic_ids:t}),_=(e,t,a,r,s="hour",l,o)=>e.callWS({type:"recorder/statistics_during_period",start_time:t.toISOString(),end_time:a?.toISOString(),statistic_ids:r,period:s,units:l,types:o}),h=(e,t,a,r)=>e.callWS({type:"recorder/statistic_during_period",statistic_id:t,units:r,fixed_period:a.fixed_period?{start_time:a.fixed_period.start instanceof Date?a.fixed_period.start.toISOString():a.fixed_period.start,end_time:a.fixed_period.end instanceof Date?a.fixed_period.end.toISOString():a.fixed_period.end}:void 0,calendar:a.calendar?{..."week"===a.calendar.period?{first_weekday:(0,s.D)(e.locale).substring(0,3)}:{},...a.calendar}:void 0,rolling_window:a.rolling_window}),u=e=>e.callWS({type:"recorder/validate_statistics"}),g=(e,t,a,r)=>e.callWS({type:"recorder/update_statistics_metadata",statistic_id:t,unit_of_measurement:a,unit_class:r}),m=(e,t)=>e.callWS({type:"recorder/clear_statistics",statistic_ids:t}),y=e=>{let t=null;if(!e)return null;for(const a of e)null!==a.change&&void 0!==a.change&&(null===t?t=a.change:t+=a.change);return t},p=(e,t)=>{let a=null;for(const r of t){if(!(r in e))continue;const t=y(e[r]);null!==t&&(null===a?a=t:a+=t)}return a},b=(e,t)=>e.some(e=>void 0!==e[t]&&null!==e[t]),f=["mean","min","max"],w=["sum","state","change"],$=(e,t)=>!(!f.includes(t)||0===e.mean_type)||!(!w.includes(t)||!e.has_sum),v=(e,t,a,r,s)=>{const l=new Date(a).toISOString();return e.callWS({type:"recorder/adjust_sum_statistics",statistic_id:t,start_time:l,adjustment:r,adjustment_unit_of_measurement:s})},k=(e,t,a)=>{const s=e.states[t];return s?(0,r.u)(s):a?.name||t},C=(e,t,a)=>{let r;return t&&(r=e.states[t]?.attributes.unit_of_measurement),void 0===r?a?.statistics_unit_of_measurement:r},S=e=>e.includes(":"),O=e=>e.callWS({type:"recorder/update_statistics_issues"})},18427(e,t,a){a.d(t,{g:()=>l});var r=a(79468),s=a(39274);function l(e,t,a,l,o,c){const n=e.getPropertyValue(o+"-"+c).trim(),i=n.length>0?n:e.getPropertyValue(o).trim();let d=(0,r.RQ)(i);return 0===n.length&&c&&(d=(0,r.v2)((0,r.BE)(t?(0,s.T)((0,r.Nc)((0,r.xp)(d)),c):(0,s.d)((0,r.Nc)((0,r.xp)(d)),c)))),l?d+=a?"32":"7F":a&&(d+="7F"),d}},24408(e,t,a){a.a(e,async function(e,r){try{a.r(t),a.d(t,{HuiEnergySourcesTableCard:()=>f});a(18111),a(22489),a(61701),a(13579);var s=a(62826),l=a(68560),o=a(96196),c=a(44457),n=a(94333),i=a(6415),d=a(20058),_=a(18427),h=(a(76776),a(38114)),u=a(23528),g=a(54706),m=a(784),y=a(1087),p=e([d,h]);[d,h]=p.then?(await p)():p;const b={grid_return:"--energy-grid-return-color",grid_consumption:"--energy-grid-consumption-color",battery_in:"--energy-battery-in-color",battery_out:"--energy-battery-out-color",solar:"--energy-solar-color",gas:"--energy-gas-color",water:"--energy-water-color"};class f extends((0,g.E)(o.WF)){hassSubscribe(){return[(0,h.tb)(this.hass,{key:this._config?.collection_key}).subscribe(e=>{this._data=e})]}getCardSize(){return 3}setConfig(e){this._config=e}shouldUpdate(e){return(0,m.xP)(this,e)||e.size>1||!e.has("hass")}_renderRow(e,t,a,r,s,l,c,h,g,m,y){return o.qy`<tr class="mdc-data-table__row ${(0,n.H)({clickable:!(0,u.OQ)(a)})}" @click="${this._handleMoreInfo}" .entity="${a}"> <td class="mdc-data-table__cell cell-bullet"> <div class="bullet" style="${(0,i.W)({borderColor:(0,_.g)(e,this.hass.themes.darkMode,!1,!1,b[t],r),backgroundColor:(0,_.g)(e,this.hass.themes.darkMode,!0,!1,b[t],r)})}"></div> </td> <th class="mdc-data-table__cell" scope="row"> ${(0,u.$O)(this.hass,a,this._data?.statsMetadata[a])} </th> ${y?o.qy`<td class="mdc-data-table__cell mdc-data-table__cell--numeric"> ${(0,d.ZV)(l,this.hass.locale)} ${c} </td> ${m?o.qy`<td class="mdc-data-table__cell mdc-data-table__cell--numeric"> ${null!==g?(0,d.ZV)(g,this.hass.locale,{style:"currency",currency:this.hass.config.currency}):""} </td>`:""}`:""} <td class="mdc-data-table__cell mdc-data-table__cell--numeric"> ${(0,d.ZV)(s,this.hass.locale)} ${c} </td> ${m?o.qy` <td class="mdc-data-table__cell mdc-data-table__cell--numeric"> ${null!==h?(0,d.ZV)(h,this.hass.locale,{style:"currency",currency:this.hass.config.currency}):""} </td>`:""} </tr>`}_renderTotalRow(e,t,a,r,s,l,c,n,_,h){return o.qy` <tr class="mdc-data-table__row ${_&&!h?"":"total"}"> <td class="mdc-data-table__cell cell-bullet"> ${_?o.qy`<div class="bullet" style="${(0,i.W)({borderColor:_.border,backgroundColor:_.background})}"></div>`:o.s6} </td> <th class="mdc-data-table__cell" scope="row">${e}</th> ${n?o.qy`<td class="mdc-data-table__cell mdc-data-table__cell--numeric"> ${null===a?"":`${(0,d.ZV)(a,this.hass.locale)} ${r}`} </td> ${c?o.qy`<td class="mdc-data-table__cell mdc-data-table__cell--numeric"> ${null!==l?(0,d.ZV)(l,this.hass.locale,{style:"currency",currency:this.hass.config.currency}):""} </td>`:""}`:""} <td class="mdc-data-table__cell mdc-data-table__cell--numeric"> ${null===t?"":`${(0,d.ZV)(t,this.hass.locale)} ${r}`} </td> ${c?o.qy`<td class="mdc-data-table__cell mdc-data-table__cell--numeric"> ${null!==s?(0,d.ZV)(s,this.hass.locale,{style:"currency",currency:this.hass.config.currency}):""} </td>`:""} </tr>`}render(){if(!this.hass||!this._config)return o.s6;if(!this._data)return o.qy`${this.hass.localize("ui.panel.lovelace.cards.energy.loading")}`;let e=0,t=0,a=0,r=!1,s=0,l=0,c=0;const n={gas:0,water:0,solar:0},i={gas:0,water:0,solar:0},d={gas:0,water:0},g={gas:0,water:0},m={gas:!1,water:!1},y=(0,h.E$)(this._data.prefs),p=this._config?.types,f=p?Object.fromEntries(Object.entries(y).filter(([e])=>p.includes(e))):y,w=getComputedStyle(this),$=!!(f.grid?.[0].flow_from.some(e=>e.stat_cost||e.entity_energy_price||e.number_energy_price)||f.grid?.[0].flow_to.some(e=>e.stat_compensation||e.entity_energy_price||e.number_energy_price)||f.gas?.some(e=>e.stat_cost||e.entity_energy_price||e.number_energy_price)||f.water?.some(e=>e.stat_cost||e.entity_energy_price||e.number_energy_price)),v={solar:"kWh",gas:this._data.gasUnit,water:this._data.waterUnit},k=void 0!==this._data.statsCompare,C=(e,t)=>{const a=(0,u.$j)(this._data.stats[e]),r=k&&(0,u.$j)(this._data.statsCompare[e]),s=t&&(0,u.$j)(this._data.stats[t])||0,l=k&&t&&(0,u.$j)(this._data.statsCompare[t])||0;return null!==a||k&&null!==r?{hasData:!0,energy:a||0,energyCompare:r||0,cost:s,costCompare:l}:{hasData:!1,energy:a||0,energyCompare:r||0,cost:s,costCompare:l}},S=this._config.show_only_totals,O=e=>o.qy` ${f[e]?.map((t,a)=>{const r=e in m&&(t.stat_cost||this._data.info.cost_sensors[t.stat_energy_from]),{hasData:s,energy:l,energyCompare:c,cost:_,costCompare:h}=C(t.stat_energy_from,r||null);return s||_||h?(n[e]+=l,i[e]+=c,r&&(m[e]=!0,d[e]+=_,g[e]+=h),S?o.s6:this._renderRow(w,e,t.stat_energy_from,a,l,c,v[e],r?_:null,r?h:null,$,k)):o.s6})} ${f[e]?this._renderTotalRow(this.hass.localize(`ui.panel.lovelace.cards.energy.energy_sources_table.${e}_total`),n[e],i[e],v[e],m[e]?d[e]:null,m[e]?g[e]:null,$,k,S?{border:(0,_.g)(w,this.hass.themes.darkMode,!1,!1,b[e],0),background:(0,_.g)(w,this.hass.themes.darkMode,!0,!1,b[e],0)}:void 0):""}`;return o.qy` <ha-card> ${this._config.title?o.qy`<h1 class="card-header">${this._config.title}</h1>`:""} <div class="mdc-data-table"> <div class="mdc-data-table__table-container"> <table class="mdc-data-table__table" aria-label="Energy sources"> <thead> <tr class="mdc-data-table__header-row"> <th class="mdc-data-table__header-cell"></th> <th class="mdc-data-table__header-cell" role="columnheader" scope="col"> ${this.hass.localize("ui.panel.lovelace.cards.energy.energy_sources_table.source")} </th> ${k?o.qy`<th class="mdc-data-table__header-cell mdc-data-table__header-cell--numeric" role="columnheader" scope="col"> ${this.hass.localize("ui.panel.lovelace.cards.energy.energy_sources_table.previous_energy")} </th> ${$?o.qy`<th class="mdc-data-table__header-cell mdc-data-table__header-cell--numeric" role="columnheader" scope="col"> ${this.hass.localize("ui.panel.lovelace.cards.energy.energy_sources_table.previous_cost")} </th>`:""}`:""} <th class="mdc-data-table__header-cell mdc-data-table__header-cell--numeric" role="columnheader" scope="col"> ${this.hass.localize("ui.panel.lovelace.cards.energy.energy_sources_table.energy")} </th> ${$?o.qy` <th class="mdc-data-table__header-cell mdc-data-table__header-cell--numeric" role="columnheader" scope="col"> ${this.hass.localize("ui.panel.lovelace.cards.energy.energy_sources_table.cost")} </th>`:""} </tr> </thead> <tbody class="mdc-data-table__content"> ${O("solar")} ${f.battery?.map((e,t)=>{const{hasData:r,energy:s,energyCompare:l}=C(e.stat_energy_from,null),{hasData:n,energy:i,energyCompare:d}=C(e.stat_energy_to,null);return r||n?(a+=s-i,c+=l-d,S?o.s6:o.qy` ${this._renderRow(w,"battery_out",e.stat_energy_from,t,s,l,"kWh",null,null,$,k)}${this._renderRow(w,"battery_in",e.stat_energy_to,t,-i,-d,"kWh",null,null,$,k)}`):o.s6})} ${f.battery?this._renderTotalRow(this.hass.localize("ui.panel.lovelace.cards.energy.energy_sources_table.battery_total"),a,c,"kWh",null,null,$,k,S?{border:(0,_.g)(w,this.hass.themes.darkMode,!1,!1,b.battery_out,0),background:(0,_.g)(w,this.hass.themes.darkMode,!0,!1,b.battery_out,0)}:void 0):""} ${f.grid?.map(a=>o.qy`${a.flow_from.map((a,c)=>{const n=a.stat_cost||this._data.info.cost_sensors[a.stat_energy_from],{hasData:i,energy:d,energyCompare:_,cost:h,costCompare:u}=C(a.stat_energy_from,n||null);return i||h||u?(e+=d,s+=_,n&&(r=!0,t+=h,l+=u),S?o.s6:this._renderRow(w,"grid_consumption",a.stat_energy_from,c,d,_,"kWh",h,u,$,k)):o.s6})} ${a.flow_to.map((a,c)=>{const n=a.stat_compensation||this._data.info.cost_sensors[a.stat_energy_to],{hasData:i,energy:d,energyCompare:_,cost:h,costCompare:u}=C(a.stat_energy_to,n||null);return i||h||u?(e-=d,s-=_,null!==n&&(r=!0,t-=h,l-=u),S?o.s6:this._renderRow(w,"grid_return",a.stat_energy_to,c,-d,-_,"kWh",-h,-u,$,k)):o.s6})}`)} ${f.grid&&(f.grid?.[0].flow_from?.length||f.grid?.[0].flow_to?.length)?this._renderTotalRow(this.hass.localize("ui.panel.lovelace.cards.energy.energy_sources_table.grid_total"),e,s,"kWh",r?t:null,r?l:null,$,k,S?{border:(0,_.g)(w,this.hass.themes.darkMode,!1,!1,b.grid_consumption,0),background:(0,_.g)(w,this.hass.themes.darkMode,!0,!1,b.grid_consumption,0)}:void 0):""} ${O("gas")} ${O("water")} ${[m.gas,m.water,r].filter(Boolean).length>1?this._renderTotalRow(this.hass.localize("ui.panel.lovelace.cards.energy.energy_sources_table.total_costs"),null,null,"",d.gas+t+d.water,g.gas+l+g.water,$,k,void 0,!0):""} </tbody> </table> </div> </div> </ha-card>`}_handleMoreInfo(e){const t=e.currentTarget?.entity;t&&!(0,u.OQ)(t)&&(0,y.r)(this,"hass-more-info",{entityId:t})}static get styles(){return o.AH`${(0,o.iz)(l)} .mdc-data-table{width:100%;border:0}.mdc-data-table__cell,.mdc-data-table__header-cell{color:var(--primary-text-color);border-bottom-color:var(--divider-color);text-align:var(--float-start)}.mdc-data-table__row:not(.mdc-data-table__row--selected):hover{background-color:rgba(var(--rgb-primary-text-color),.04)}.clickable{cursor:pointer}.total{--mdc-typography-body2-font-weight:var(--ha-font-weight-medium)}.total .mdc-data-table__cell{border-top:1px solid var(--divider-color)}ha-card{max-height:100%;overflow:auto}.card-header{padding-bottom:0}.content{padding:16px}.has-header{padding-top:0}.cell-bullet{width:32px;padding-right:0;padding-inline-end:0;padding-inline-start:16px;direction:var(--direction)}.bullet{border-width:1px;border-style:solid;border-radius:var(--ha-border-radius-sm);height:16px;width:32px}.mdc-data-table__cell--numeric{direction:ltr}`}constructor(...e){super(...e),this.hassSubscribeRequiredHostProps=["_config"]}}(0,s.Cg)([(0,c.MZ)({attribute:!1})],f.prototype,"hass",void 0),(0,s.Cg)([(0,c.wk)()],f.prototype,"_config",void 0),(0,s.Cg)([(0,c.wk)()],f.prototype,"_data",void 0),f=(0,s.Cg)([(0,c.EM)("hui-energy-sources-table-card")],f),r()}catch(e){r(e)}})}};
//# sourceMappingURL=43287.ad892c0a8898ddc2.js.map