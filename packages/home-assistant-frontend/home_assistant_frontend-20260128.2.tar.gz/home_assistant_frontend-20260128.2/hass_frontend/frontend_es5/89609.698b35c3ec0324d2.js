"use strict";(self.webpackChunkhome_assistant_frontend=self.webpackChunkhome_assistant_frontend||[]).push([["89609"],{91069:function(t,e,i){i.a(t,async function(t,n){try{i.d(e,{EO:function(){return S},Yq:function(){return x},_U:function(){return E},eE:function(){return b},fU:function(){return k},ol:function(){return v},xo:function(){return w}});var s=i(78016),r=i(31810),o=i(49134),a=i(81977),c=i(36307),l=i(35932),h=i(73983),d=i(6946),u=i(92913),f=i(83339),_=i(77972),g=i(31886),p=i(46927),y=t([g]);g=(y.then?(await y)():y)[0];const m=(t,e,i,n)=>{const s=i(new g.BB(t,e),n);return s instanceof Date?new Date(s.getTime()):s},v=(t,e,i,n,s)=>i.time_zone===p.Wj.server?m(t,n.time_zone,e,s):e(t,s),w=(t,e,i,n,s)=>i.time_zone===p.Wj.server?m(t,n.time_zone,e,s):e(t,s),S=(t,e,i,n,s)=>w(t,i,n,s,n.time_zone===p.Wj.server?new g.BB(e,s.time_zone):e),b=(t,e,i,n,g)=>{let p,y;if(w(t,s.e,n,g)&&w(e,r.c,n,g)){const s=(S(e,t,o.W,n,g)+1)*(i?1:-1);p=v(t,a.P,n,g,s),y=v(v(e,a.P,n,g,s),c.p,n,g)}else if(w(t,t=>(0,l.o)(t).getMilliseconds()===t.getMilliseconds(),n,g)&&w(e,t=>(0,h.D)(t).getMilliseconds()===t.getMilliseconds(),n,g)){const s=(S(e,t,d.c,n,g)+1)*(i?1:-1);p=v(t,u.f,n,g,s),y=v(e,u.f,n,g,s)}else{const s=S(e,t,f.b,n,g)*(i?1:-1);p=v(t,_.A,n,g,s),y=v(e,_.A,n,g,s)}return{start:p,end:y}},E=(t,e)=>{const i=new g.BB(t,e);return new Date(i.getTime())},x=(t,e)=>new g.BB(t,e).toISOString().split("T")[0],k=(t,e)=>new g.BB(t,e).toISOString().split("T")[1].split(".")[0];n()}catch(m){n(m)}})},46223:function(t,e,i){i.a(t,async function(t,n){try{i.d(e,{b:function(){return S}});var s=i(35932),r=i(73983),o=i(92913),a=i(52640),c=i(69137),l=i(35660),h=i(36307),d=i(11650),u=i(15797),f=i(33977),_=i(69748),g=i(55144),p=i(21828),y=i(66708),m=i(91069),v=i(380),w=t([v,m]);[v,m]=w.then?(await w)():w;const S=(t,e)=>{const i=new Date,n=(0,v.P)(t.locale);switch(e){case"today":return[(0,m.ol)(i,s.o,t.locale,t.config,{weekStartsOn:n}),(0,m.ol)(i,r.D,t.locale,t.config,{weekStartsOn:n})];case"yesterday":return[(0,m.ol)((0,o.f)(i,-1),s.o,t.locale,t.config,{weekStartsOn:n}),(0,m.ol)((0,o.f)(i,-1),r.D,t.locale,t.config,{weekStartsOn:n})];case"this_week":return[(0,m.ol)(i,a.k,t.locale,t.config,{weekStartsOn:n}),(0,m.ol)(i,c.$,t.locale,t.config,{weekStartsOn:n})];case"this_month":return[(0,m.ol)(i,l.w,t.locale,t.config),(0,m.ol)(i,h.p,t.locale,t.config)];case"this_quarter":return[(0,m.ol)(i,d.a,t.locale,t.config),(0,m.ol)(i,u.j,t.locale,t.config)];case"this_year":return[(0,m.ol)(i,f.D,t.locale,t.config),(0,m.ol)(i,_.Q,t.locale,t.config)];case"now-7d":return[(0,m.ol)(i,g.e,t.locale,t.config,7),(0,m.ol)(i,g.e,t.locale,t.config,0)];case"now-30d":return[(0,m.ol)(i,g.e,t.locale,t.config,30),(0,m.ol)(i,g.e,t.locale,t.config,0)];case"now-12m":return[(0,m.ol)(i,p.a,t.locale,t.config,12),(0,m.ol)(i,p.a,t.locale,t.config,0)];case"now-1h":return[(0,m.ol)(i,y.O,t.locale,t.config,1),(0,m.ol)(i,y.O,t.locale,t.config,0)];case"now-12h":return[(0,m.ol)(i,y.O,t.locale,t.config,12),(0,m.ol)(i,y.O,t.locale,t.config,0)];case"now-24h":return[(0,m.ol)(i,y.O,t.locale,t.config,24),(0,m.ol)(i,y.O,t.locale,t.config,0)]}return[i,i]};n()}catch(S){n(S)}})},23528:function(t,e,i){i.a(t,async function(t,n){try{i.d(e,{$3:function(){return y},$O:function(){return k},$j:function(){return m},ED:function(){return a},JE:function(){return O},OQ:function(){return C},PU:function(){return I},Ph:function(){return g},Uf:function(){return x},W1:function(){return p},Wr:function(){return u},Z:function(){return h},gF:function(){return v},iY:function(){return w},jU:function(){return c},nN:function(){return E},p3:function(){return d},pJ:function(){return _},r_:function(){return l},sz:function(){return f}});i(74423),i(18111),i(13579),i(62953);var s=i(28978),r=i(380),o=t([r]);r=(o.then?(await o)():o)[0];var a=function(t){return t[t.NONE=0]="NONE",t[t.ARITHMETIC=1]="ARITHMETIC",t[t.CIRCULAR=2]="CIRCULAR",t}({});const c=["entity_not_recorded","entity_no_longer_recorded","state_class_removed","units_changed","mean_type_changed","no_state"],l=["L","gal","ft³","m³","CCF","MCF"],h=t=>t.sendMessagePromise({type:"recorder/info"}),d=(t,e)=>t.callWS({type:"recorder/list_statistic_ids",statistic_type:e}),u=(t,e)=>t.callWS({type:"recorder/get_statistics_metadata",statistic_ids:e}),f=(t,e,i,n,s="hour",r,o)=>t.callWS({type:"recorder/statistics_during_period",start_time:e.toISOString(),end_time:null==i?void 0:i.toISOString(),statistic_ids:n,period:s,units:r,types:o}),_=(t,e,i,n)=>t.callWS({type:"recorder/statistic_during_period",statistic_id:e,units:n,fixed_period:i.fixed_period?{start_time:i.fixed_period.start instanceof Date?i.fixed_period.start.toISOString():i.fixed_period.start,end_time:i.fixed_period.end instanceof Date?i.fixed_period.end.toISOString():i.fixed_period.end}:void 0,calendar:i.calendar?Object.assign(Object.assign({},"week"===i.calendar.period?{first_weekday:(0,r.D)(t.locale).substring(0,3)}:{}),i.calendar):void 0,rolling_window:i.rolling_window}),g=t=>t.callWS({type:"recorder/validate_statistics"}),p=(t,e,i,n)=>t.callWS({type:"recorder/update_statistics_metadata",statistic_id:e,unit_of_measurement:i,unit_class:n}),y=(t,e)=>t.callWS({type:"recorder/clear_statistics",statistic_ids:e}),m=t=>{let e=null;if(!t)return null;for(const i of t)null!==i.change&&void 0!==i.change&&(null===e?e=i.change:e+=i.change);return e},v=(t,e)=>{let i=null;for(const n of e){if(!(n in t))continue;const e=m(t[n]);null!==e&&(null===i?i=e:i+=e)}return i},w=(t,e)=>t.some(t=>void 0!==t[e]&&null!==t[e]),S=["mean","min","max"],b=["sum","state","change"],E=(t,e)=>!(!S.includes(e)||0===t.mean_type)||!(!b.includes(e)||!t.has_sum),x=(t,e,i,n,s)=>{const r=new Date(i).toISOString();return t.callWS({type:"recorder/adjust_sum_statistics",statistic_id:e,start_time:r,adjustment:n,adjustment_unit_of_measurement:s})},k=(t,e,i)=>{const n=t.states[e];return n?(0,s.u)(n):(null==i?void 0:i.name)||e},O=(t,e,i)=>{let n;var s;e&&(n=null===(s=t.states[e])||void 0===s?void 0:s.attributes.unit_of_measurement);return void 0===n?null==i?void 0:i.statistics_unit_of_measurement:n},C=t=>t.includes(":"),I=t=>t.callWS({type:"recorder/update_statistics_issues"});n()}catch(c){n(c)}})},89029:function(t,e,i){i.a(t,async function(t,n){try{i.r(e),i.d(e,{HuiStatisticCard:function(){return k},PERIOD_ENERGY:function(){return x}});i(16280),i(3362),i(62953);var s=i(40445),r=i(96196),o=i(77845),a=i(42372),c=i(1087),l=i(78649),h=i(20058),d=(i(38962),i(76776),i(93367)),u=i(38114),f=i(23528),_=i(33121),g=i(37642),p=i(13632),y=i(784),m=i(83938),v=t([d,u,h,f]);[d,u,h,f]=v.then?(await v)():v;let w,S,b,E=t=>t;const x="energy_date_selection";class k extends r.WF{static async getConfigElement(){return await i.e("90303").then(i.bind(i,46754)),document.createElement("hui-statistic-card-editor")}static getStubConfig(t,e,i){return{entity:(0,p.B)(t,1,e,i,["sensor"],t=>"state_class"in t.attributes)[0]||"",period:{calendar:{period:"month"}}}}disconnectedCallback(){super.disconnectedCallback(),this._unsubscribeEnergy(),clearInterval(this._interval)}connectedCallback(){var t;super.connectedCallback(),(null===(t=this._config)||void 0===t?void 0:t.period)===x?this._subscribeEnergy():this._setFetchStatisticTimer()}_subscribeEnergy(){var t;this._energySub||(this._energySub=(0,u.tb)(this.hass,{key:null===(t=this._config)||void 0===t?void 0:t.collection_key}).subscribe(t=>{this._energyStart=t.start;let e=t.end;e&&999===e.getMilliseconds()&&(e=new Date(e),e.setMilliseconds(1e3)),this._energyEnd=e,this._fetchStatistic()}))}_unsubscribeEnergy(){this._energySub&&(this._energySub(),this._energySub=void 0),this._energyStart=void 0,this._energyEnd=void 0}setConfig(t){if(!t.entity)throw new Error("Entity must be specified");if(!t.stat_type)throw new Error("Statistic type must be specified");if(!t.period)throw new Error("Period must be specified");if(t.entity&&!(0,f.OQ)(t.entity)&&!(0,l.n)(t.entity))throw new Error("Invalid entity");this._config=t,this._error=void 0,this._config.footer?this._footerElement=(0,m.x)(this._config.footer):this._footerElement&&(this._footerElement=void 0)}async getCardSize(){let t=2;if(this._footerElement){const e=(0,_.Z)(this._footerElement);t+=e instanceof Promise?await e:e}return t}render(){if(!this._config||!this.hass)return r.s6;if(this._error)return(0,r.qy)(w||(w=E` <ha-alert alert-type="error">${0}</ha-alert> `),this._error);const t=this.hass.states[this._config.entity],e=(this._config.name?(0,g.v)(this.hass,t,this._config.name):"")||(0,f.$O)(this.hass,this._config.entity,this._metadata);return(0,r.qy)(S||(S=E` <ha-card @click="${0}" tabindex="0"> <div class="header"> <div class="name" .title="${0}">${0}</div> <div class="icon"> <ha-state-icon .icon="${0}" .stateObj="${0}" .hass="${0}"></ha-state-icon> </div> </div> <div class="info"> <span class="value">${0}</span> <span class="measurement">${0}</span> </div> ${0} </ha-card> `),this._handleClick,e,e,this._config.icon,t,this.hass,void 0===this._value?"":null===this._value?"?":(0,h.ZV)(this._value,this.hass.locale),this._config.unit||(0,f.JE)(this.hass,this._config.entity,this._metadata),this._footerElement)}shouldUpdate(t){return this._footerElement&&(this._footerElement.hass=this.hass),!!(t.has("_value")||t.has("_metadata")||t.has("_error")||t.has("_energyStart")||t.has("_energyEnd"))||(!this._config||(0,y.LX)(this,t))}willUpdate(t){if(super.willUpdate(t),!this._config||!t.has("_config"))return;const e=t.get("_config");if(this.hass){if(this._config.period===x&&!this._energySub)return void this._subscribeEnergy();if(this._config.period!==x&&this._energySub)return this._unsubscribeEnergy(),void this._setFetchStatisticTimer();this._config.period===x&&this._energySub&&t.has("_config")&&(null==e?void 0:e.collection_key)!==this._config.collection_key&&(this._unsubscribeEnergy(),this._subscribeEnergy())}t.has("_config")&&(null==e?void 0:e.entity)!==this._config.entity&&this._fetchMetadata().then(()=>{this._setFetchStatisticTimer()})}firstUpdated(){this._fetchStatistic(),this._fetchMetadata()}updated(t){if(super.updated(t),!this._config||!this.hass)return;const e=t.get("hass"),i=t.get("_config");e&&i&&e.themes===this.hass.themes&&i.theme===this._config.theme||(0,a.Q)(this,this.hass.themes,this._config.theme)}_setFetchStatisticTimer(){var t;this._fetchStatistic(),clearInterval(this._interval),(null===(t=this._config)||void 0===t?void 0:t.period)!==x&&(this._interval=window.setInterval(()=>this._fetchStatistic(),3e5))}async _fetchStatistic(){if(this.hass&&this._config)try{var t,e;const i=await(0,f.pJ)(this.hass,this._config.entity,this._energyStart&&this._energyEnd?{fixed_period:{start:this._energyStart,end:this._energyEnd}}:"object"==typeof(null===(t=this._config)||void 0===t?void 0:t.period)?null===(e=this._config)||void 0===e?void 0:e.period:{});this._value=i[this._config.stat_type],this._error=void 0}catch(i){this._error=i.message}}async _fetchMetadata(){if(this.hass&&this._config)try{var t;this._metadata=null===(t=await(0,f.Wr)(this.hass,[this._config.entity]))||void 0===t?void 0:t[0]}catch(e){this._error=e.message}}_handleClick(){(0,c.r)(this,"hass-more-info",{entityId:this._config.entity})}getGridOptions(){return{columns:6,rows:2,min_columns:6,min_rows:2}}static get styles(){return[(0,r.AH)(b||(b=E`ha-card{height:100%;display:flex;flex-direction:column;justify-content:space-between;cursor:pointer;outline:0}.header{display:flex;padding:8px 16px 0;justify-content:space-between}.name{color:var(--secondary-text-color);line-height:var(--ha-line-height-expanded);font-size:var(--ha-font-size-l);font-weight:var(--ha-font-weight-medium);overflow:hidden;white-space:nowrap;text-overflow:ellipsis}.icon{color:var(--state-icon-color,#44739e);line-height:40px}.info{padding:0px 16px 16px;margin-top:-4px;overflow:hidden;white-space:nowrap;text-overflow:ellipsis;line-height:var(--ha-line-height-expanded)}.value{font-size:var(--ha-font-size-3xl);margin-right:4px;margin-inline-end:4px;margin-inline-start:initial}.measurement{font-size:var(--ha-font-size-l);color:var(--secondary-text-color)}`))]}}(0,s.Cg)([(0,o.MZ)({attribute:!1})],k.prototype,"hass",void 0),(0,s.Cg)([(0,o.wk)()],k.prototype,"_config",void 0),(0,s.Cg)([(0,o.wk)()],k.prototype,"_value",void 0),(0,s.Cg)([(0,o.wk)()],k.prototype,"_metadata",void 0),(0,s.Cg)([(0,o.wk)()],k.prototype,"_error",void 0),(0,s.Cg)([(0,o.wk)()],k.prototype,"_energyStart",void 0),(0,s.Cg)([(0,o.wk)()],k.prototype,"_energyEnd",void 0),k=(0,s.Cg)([(0,o.EM)("hui-statistic-card")],k),n()}catch(w){n(w)}})},56434:function(t,e,i){i.d(e,{e:function(){return s}});var n=i(81977);function s(t,e,i){return(0,n.P)(t,12*e,i)}}}]);
//# sourceMappingURL=89609.698b35c3ec0324d2.js.map