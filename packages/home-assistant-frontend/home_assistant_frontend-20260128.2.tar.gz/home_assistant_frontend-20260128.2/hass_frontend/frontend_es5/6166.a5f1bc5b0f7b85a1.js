"use strict";(self.webpackChunkhome_assistant_frontend=self.webpackChunkhome_assistant_frontend||[]).push([["6166"],{57094:function(t,n,e){e.d(n,{g:function(){return i},x:function(){return s}});e(44114),e(72712),e(18111),e(18237),e(62953);function i(t){return t.reduce((t,n)=>("conditions"in n&&n.conditions&&t.push(...i(n.conditions)),"screen"===n.condition&&n.media_query&&t.push(n.media_query),t),[])}function s(t){return t.reduce((t,n)=>("conditions"in n&&n.conditions&&t.push(...s(n.conditions)),"time"===n.condition&&t.push(n),t),[])}},43574:function(t,n,e){e.a(t,async function(t,i){try{e.d(n,{b:function(){return d},m:function(){return f}});e(18111),e(7588);var s=e(71769),r=e(14487),o=e(57094),c=e(25075),a=t([c,r]);[c,r]=a.then?(await a)():a;const l=2147483647;function d(t,n,e,i){const c=(0,o.g)(t);if(0===c.length)return;const a=1===t.length&&"screen"===t[0].condition&&!!t[0].media_query;c.forEach(o=>{const c=(0,s.m)(o,e=>{if(a)i(e);else{const e=(0,r.XH)(t,n);i(e)}});e(c)})}function f(t,n,e,i){const s=(0,o.x)(t);0!==s.length&&s.forEach(s=>{let o;const a=()=>{const e=(0,c.S)(n,s);if(void 0===e)return;const u=Math.min(e,l);o=setTimeout(()=>{if(e<=l){const e=(0,r.XH)(t,n);i(e)}a()},u)};e(()=>{void 0!==o&&clearTimeout(o)}),a()})}i()}catch(u){i(u)}})},25075:function(t,n,e){e.a(t,async function(t,i){try{e.d(n,{S:function(){return p}});e(44114),e(72712);var s=e(74487),r=e(31886),o=e(92913),c=e(35932),a=e(78733),u=e(83339),l=e(46927),d=e(82447),f=t([s,r,d]);function p(t,{after:n,before:e,weekdays:i}){const s=t.locale.time_zone===l.Wj.server?t.config.time_zone:Intl.DateTimeFormat().resolvedOptions().timeZone,f=new r.BB(new Date,s),h=[];if(n){let t=(0,d.MV)(n,s);t<=f&&(t=(0,o.f)(t,1)),h.push(t)}if(e){let t=(0,d.MV)(e,s);t<=f&&(t=(0,o.f)(t,1)),h.push(t)}if(i&&i.length>0&&i.length<7){const t=(0,o.f)(f,1),n=(0,c.o)(t);h.push(n)}if(0===h.length)return;const p=h.reduce((t,n)=>n<t?n:t),v=(0,a.z)(p,1);return(0,u.b)(v,f)}[s,r,d]=f.then?(await f)():f,i()}catch(h){i(h)}})},82447:function(t,n,e){e.a(t,async function(t,i){try{e.d(n,{MV:function(){return p},Uo:function(){return v},fn:function(){return h}});var s=e(74487),r=(e(74423),e(18111),e(81148),e(27495),e(42762),e(31886)),o=e(7562),c=e(72659),a=e(20687),u=e(46927),l=e(96029),d=t([s,r]);function h(t){if(!t||""===t.trim())return!1;const n=t.split(":");if(n.length<2||n.length>3)return!1;if(!n.every(t=>/^\d+$/.test(t)))return!1;const e=parseInt(n[0],10),i=parseInt(n[1],10),s=3===n.length?parseInt(n[2],10):0;return!(isNaN(e)||isNaN(i)||isNaN(s))&&(e>=0&&e<=23&&i>=0&&i<=59&&s>=0&&s<=59)}[s,r]=d.then?(await d)():d;const p=(t,n)=>{const e=t.split(":"),i=parseInt(e[0],10),s=parseInt(e[1],10),o=3===e.length?parseInt(e[2],10):0,c=new r.BB(new Date,n),a=new r.BB(c.getFullYear(),c.getMonth(),c.getDate(),i,s,o,0,n);return new Date(a.getTime())},v=(t,{after:n,before:e,weekdays:i})=>{const s=t.locale.time_zone===u.Wj.server?t.config.time_zone:Intl.DateTimeFormat().resolvedOptions().timeZone,d=new r.BB(new Date,s);if(i&&i.length>0){const t=l.sj[d.getDay()];if(!i.includes(t))return!1}if(!n&&!e)return!0;const f=n?p(n,s):void 0,h=e?p(e,s):void 0;return f&&h?(0,o.Y)(h,f)?!(0,o.Y)(d,f)||!(0,c.d)(d,h):(0,a.v)(d,{start:f,end:h}):f?!(0,o.Y)(d,f):!h||!(0,c.d)(d,h)};i()}catch(f){i(f)}})},71769:function(t,n,e){e.d(n,{m:function(){return i}});const i=(t,n)=>{const e=matchMedia(t),i=t=>n(t.matches);return e.addListener(i),n(e.matches),()=>e.removeListener(i)}},85547:function(t,n,e){e.d(n,{Fj:function(){return s},Gu:function(){return r},H2:function(){return c},xA:function(){return u},xs:function(){return o}});e(18111),e(20116);var i=e(69093);const s=t=>t.callWS({type:"person/list"}),r=(t,n)=>t.callWS(Object.assign({type:"person/create"},n)),o=(t,n,e)=>t.callWS(Object.assign({type:"person/update",person_id:n},e)),c=(t,n)=>t.callWS({type:"person/delete",person_id:n}),a={},u=t=>{var n;if(null===(n=t.user)||void 0===n||!n.id)return;const e=a[t.user.id];if(e){const n=t.states[e];if(n&&n.attributes.user_id===t.user.id)return n}const s=Object.values(t.states).find(n=>n.attributes.user_id===t.user.id&&"person"===(0,i.t)(n));return s&&(a[t.user.id]=s.entity_id),s}},91263:function(t,n,e){e.a(t,async function(t,i){try{e.d(n,{M:function(){return o}});e(44114),e(18111),e(7588),e(62953);var s=e(43574),r=t([s]);s=(r.then?(await r)():r)[0];const o=t=>class extends t{connectedCallback(){super.connectedCallback(),this.setupConditionalListeners()}disconnectedCallback(){super.disconnectedCallback(),this.clearConditionalListeners()}clearConditionalListeners(){this.__listeners.forEach(t=>t()),this.__listeners=[]}addConditionalListener(t){this.__listeners.push(t)}setupConditionalListeners(t){const n=this.config||this._config,e=t||(null==n?void 0:n.visibility);if(!e||!this.hass)return;const i=t=>{this._updateVisibility?this._updateVisibility(t):this._updateElement&&n&&this._updateElement(n)};(0,s.b)(e,this.hass,t=>this.addConditionalListener(t),i),(0,s.m)(e,this.hass,t=>this.addConditionalListener(t),i)}constructor(...t){super(...t),this.__listeners=[]}};i()}catch(o){i(o)}})},14487:function(t,n,e){e.a(t,async function(t,i){try{e.d(n,{Wx:function(){return C},XH:function(){return g},db:function(){return D},lB:function(){return x}});e(74423),e(44114),e(18111),e(81148),e(22489),e(61701),e(13579),e(17642),e(58004),e(33853),e(45876),e(32475),e(15024),e(31698),e(62953);var s=e(44537),r=e(82447),o=e(96029),c=e(78649),a=e(22675),u=e(85547),l=t([r]);function f(t,n){var e;if((0,c.n)(n)&&t.states[n])return null===(e=t.states[n])||void 0===e?void 0:e.state}function h(t,n){var e;const i=t.entity&&n.states[t.entity]?n.states[t.entity].state:a.HV;let r=null!==(e=t.state)&&void 0!==e?e:t.state_not;if(void 0===r)return!1;if(Array.isArray(r)){const t=r.map(t=>f(n,t)).filter(t=>void 0!==t);r=[...r,...t]}else if("string"==typeof r){const t=f(n,r);r=[r],t&&r.push(t)}return null!=t.state?(0,s.e)(r).includes(i):!(0,s.e)(r).includes(i)}function p(t,n){var e;const i=null===(e=t.entity?n.states[t.entity]:void 0)||void 0===e?void 0:e.state;let s=t.above,r=t.below;var o,c;"string"==typeof s&&(s=null!==(o=f(n,s))&&void 0!==o?o:s);"string"==typeof r&&(r=null!==(c=f(n,r))&&void 0!==c?c:r);const a=Number(i),u=Number(s),l=Number(r);return!isNaN(a)&&((null==t.above||isNaN(u)||u<a)&&(null==t.below||isNaN(l)||l>a))}function v(t,n){return(0,r.Uo)(n,t)}function y(t,n){var e;const i=(0,u.xA)(n);return!!i&&(null===(e=t.locations)||void 0===e?void 0:e.includes(i.state))}function m(t,n){var e;return!(!t.users||null===(e=n.user)||void 0===e||!e.id)&&t.users.includes(n.user.id)}function b(t,n){return!t.conditions||g(t.conditions,n)}function _(t,n){return!t.conditions||!g(t.conditions,n)}function w(t,n){return!t.conditions||t.conditions.some(t=>g([t],n))}function g(t,n){return t.every(t=>{if("condition"in t)switch(t.condition){case"time":return v(t,n);case"screen":return!!(e=t).media_query&&matchMedia(e.media_query).matches;case"user":return m(t,n);case"location":return y(t,n);case"numeric_state":return p(t,n);case"and":return b(t,n);case"not":return _(t,n);case"or":return w(t,n);default:return h(t,n)}var e;return h(t,n)})}function C(t){const n=new Set;for(const r of t)if("numeric_state"===r.condition)r.entity&&n.add(r.entity),"string"==typeof r.above&&(0,c.n)(r.above)&&n.add(r.above),"string"==typeof r.below&&(0,c.n)(r.below)&&n.add(r.below);else if("state"===r.condition){var e,i;r.entity&&n.add(r.entity),[...null!==(e=(0,s.e)(r.state))&&void 0!==e?e:[],...null!==(i=(0,s.e)(r.state_not))&&void 0!==i?i:[]].forEach(t=>{t&&(0,c.n)(t)&&n.add(t)})}else if("conditions"in r&&r.conditions)return new Set([...n,...C(r.conditions)]);return n}function N(t){return null!=t.entity&&(null!=t.state||null!=t.state_not)}function k(t){const n=null!=t.after&&""!==t.after,e=null!=t.before&&""!==t.before,i=n||e,s=null!=t.weekdays&&t.weekdays.length>0,c=!s||t.weekdays.every(t=>o.ZV.includes(t)),a=(!n||(0,r.fn)(t.after))&&(!e||(0,r.fn)(t.before)),u=!n||!e||t.after!==t.before;return(i||s)&&c&&a&&u}function E(t){return null!=t.users}function V(t){return null!=t.locations}function B(t){return null!=t.conditions}function L(t){return null!=t.conditions}function M(t){return null!=t.conditions}function j(t){return null!=t.entity&&(null!=t.above||null!=t.below)}function D(t){return t.every(t=>{if("condition"in t)switch(t.condition){case"screen":return null!=t.media_query;case"time":return k(t);case"user":return E(t);case"location":return V(t);case"numeric_state":return j(t);case"and":return B(t);case"not":return L(t);case"or":return M(t);default:return N(t)}return N(t)})}function x(t,n){return"conditions"in t&&t.conditions?Object.assign(Object.assign({},t),{},{conditions:t.conditions.map(t=>x(t,n))}):"state"===t.condition||"numeric_state"===t.condition?Object.assign({entity:n},t):t}r=(l.then?(await l)():l)[0],i()}catch(d){i(d)}})},37693:function(t,n,e){e.a(t,async function(t,i){try{e.d(n,{E:function(){return l}});e(49255),e(16280),e(18111),e(22489),e(62953);var s=e(40445),r=e(96196),o=e(77845),c=e(91263),a=e(14487),u=t([c,a]);[c,a]=u.then?(await u)():u;class l extends((0,c.M)(r.mN)){createRenderRoot(){return this}validateConfig(t){if(!t.conditions)throw new Error("No conditions configured");if(!Array.isArray(t.conditions))throw new Error("Conditions need to be an array");if(!(0,a.db)(t.conditions))throw new Error("Conditions are invalid");this.lastChild&&this.removeChild(this.lastChild),this._config=t}disconnectedCallback(){super.disconnectedCallback()}connectedCallback(){super.connectedCallback(),this._updateVisibility()}setupConditionalListeners(){if(!this._config||!this.hass)return;const t=this._config.conditions.filter(t=>"condition"in t);super.setupConditionalListeners(t)}update(t){super.update(t),(t.has("_element")||t.has("_config")||t.has("hass")||t.has("preview"))&&(this.clearConditionalListeners(),this.setupConditionalListeners(),this._updateVisibility())}_updateVisibility(t){if(!this._element||!this.hass||!this._config)return;this._element.preview=this.preview;const n=null!=t?t:(0,a.XH)(this._config.conditions,this.hass);this.setVisibility(n)}setVisibility(t){if(!this._element||!this.hass)return;const n=this.preview||t;this.hidden!==!n&&(this.toggleAttribute("hidden",!n),this.style.setProperty("display",n?"":"none")),n?(this._element.hass=this.hass,this._element.parentElement||this.appendChild(this._element)):this._element.parentElement&&this.removeChild(this._element)}constructor(...t){super(...t),this.preview=!1}}(0,s.Cg)([(0,o.MZ)({attribute:!1})],l.prototype,"hass",void 0),(0,s.Cg)([(0,o.MZ)({type:Boolean})],l.prototype,"preview",void 0),(0,s.Cg)([(0,o.wk)()],l.prototype,"_config",void 0),l=(0,s.Cg)([(0,o.EM)("hui-conditional-base")],l),i()}catch(l){i(l)}})},80725:function(t,n,e){e.a(t,async function(t,i){try{e.r(n);e(16280);var s=e(40445),r=e(77845),o=e(37693),c=e(94225),a=e(1087),u=t([o,c]);[o,c]=u.then?(await u)():u;class l extends o.E{setConfig(t){if(this.validateConfig(t),!t.row)throw new Error("No row configured");this._element=(0,c.T)(t.state_color?Object.assign({state_color:!0},t.row):t.row)}setVisibility(t){const n=this.preview||t,e=this.hidden;super.setVisibility(t),e!==this.hidden&&(0,a.r)(this,"row-visibility-changed",{row:this,value:n})}}l=(0,s.Cg)([(0,r.EM)("hui-conditional-row")],l),i()}catch(l){i(l)}})},31886:function(t,n,e){e.a(t,async function(t,i){try{e.d(n,{BB:function(){return s.B}});e(38744);var s=e(88775),r=e(49232),o=e(78713),c=e(53834),a=e(35204),u=e(5806),l=t([s,r,o,c,a,u]);[s,r,o,c,a,u]=l.then?(await l)():l,i()}catch(d){i(d)}})},92913:function(t,n,e){e.d(n,{f:function(){return r}});var i=e(51039),s=e(83504);function r(t,n,e){const r=(0,s.a)(t,null==e?void 0:e.in);return isNaN(n)?(0,i.w)((null==e?void 0:e.in)||t,NaN):n?(r.setDate(r.getDate()+n),r):r}},78733:function(t,n,e){e.d(n,{z:function(){return s}});var i=e(83504);function s(t,n,e){const s=(0,i.a)(t,null==e?void 0:e.in);return s.setTime(s.getTime()+6e4*n),s}},83339:function(t,n,e){e.d(n,{b:function(){return s}});var i=e(83504);function s(t,n){return+(0,i.a)(t)-+(0,i.a)(n)}}}]);
//# sourceMappingURL=6166.a5f1bc5b0f7b85a1.js.map