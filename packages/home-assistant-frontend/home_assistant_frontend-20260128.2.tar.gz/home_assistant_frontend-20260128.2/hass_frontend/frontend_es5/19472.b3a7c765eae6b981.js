"use strict";(self.webpackChunkhome_assistant_frontend=self.webpackChunkhome_assistant_frontend||[]).push([["19472"],{90433:function(e,t,i){i.d(t,{Vy:function(){return r},fI:function(){return l},ux:function(){return o}});var s=i(22786),n=i(79468);const a=54;function r(e,t){const i=e%a+1;return t.getPropertyValue(`--color-${i}`)}function l(e,t){const i=t.getPropertyValue(`--graph-color-${e+1}`)||r(e,t);return(0,n.RQ)(i)}const o=(0,s.A)(e=>Array.from({length:a},(t,i)=>l(i,e)),(e,t)=>e[0].getPropertyValue("--graph-color-1")===t[0].getPropertyValue("--graph-color-1")&&e[0].getPropertyValue("--color-1")===t[0].getPropertyValue("--color-1"))},96832:function(e,t,i){i.a(e,async function(e,t){try{i(89463),i(74423),i(72712),i(18111),i(61701),i(18237),i(62953);var s=i(40445),n=i(96196),a=i(77845),r=i(94333),l=i(6415),o=i(1087),d=i(34127),c=e([d]);d=(c.then?(await c)():c)[0];let h,g,p,u,y,b,m,v=e=>e;class f extends n.WF{render(){const e=this.segments.reduce((e,t,i)=>{var s;return null!==(s=this.hiddenSegments)&&void 0!==s&&s.includes(i)?e:e+t.value},0);return(0,n.qy)(h||(h=v` <div class="container"> ${0} <div class="bar"> ${0} </div> ${0} </div> `),this.heading||this.description?(0,n.qy)(g||(g=v` <div class="heading"> <div class="title"> <span>${0}</span> <span>${0}</span> </div> <slot name="extra"></slot> </div> `),this.heading,this.description):n.s6,this.segments.map((t,i)=>{var s;return(0,n.qy)(p||(p=v` ${0} <div id="segment-${0}" class="${0}" data-index="${0}" @click="${0}" style="${0}"></div> `),this.hideTooltip||!t.label?n.s6:(0,n.qy)(u||(u=v` <ha-tooltip for="segment-${0}" placement="top"> ${0} </ha-tooltip> `),i,t.label),i,(0,r.H)({clickable:this.barClickable}),i,this.barClickable?this._handleSegmentClick:n.s6,(0,l.W)({width:t.value/e*100+"%",backgroundColor:t.color,display:null!==(s=this.hiddenSegments)&&void 0!==s&&s.includes(i)?"none":"block"}))}),this.hideLegend?n.s6:(0,n.qy)(y||(y=v` <ul class="legend"> ${0} </ul> `),this.segments.map((e,t)=>{var i;return e.label?(0,n.qy)(b||(b=v` <li class="${0}" data-index="${0}" @click="${0}"> <div class="bullet" style="${0}"></div> <span class="label">${0}</span> </li> `),(0,r.H)({clickable:this.clickable,hidden:null===(i=this.hiddenSegments)||void 0===i?void 0:i.includes(t)}),t,this.clickable?this._handleLegendClick:n.s6,(0,l.W)({backgroundColor:e.color}),e.label):n.s6})))}_handleSegmentClick(e){const t=e.currentTarget,i=Number(t.dataset.index),s=this.segments[i];s&&(0,o.r)(this,"segment-clicked",{index:i,segment:s})}_handleLegendClick(e){const t=e.currentTarget,i=Number(t.dataset.index),s=this.segments[i];s&&(0,o.r)(this,"legend-item-clicked",{index:i,segment:s})}constructor(...e){super(...e),this.hideLegend=!1,this.hideTooltip=!1,this.clickable=!1,this.barClickable=!1}}f.styles=(0,n.AH)(m||(m=v`.container{width:100%}.heading{display:flex;flex-direction:row;gap:var(--ha-space-2)}.heading .title{flex:1}.heading .title span{color:var(--secondary-text-color);line-height:var(--ha-line-height-expanded);margin-right:8px}.heading .title span:first-child{color:var(--primary-text-color)}.bar{display:flex;overflow:hidden;border-radius:var(--ha-bar-border-radius,var(--ha-border-radius-sm));width:100%;height:12px;margin:2px 0;background-color:var(--ha-bar-background-color,var(--secondary-background-color))}.bar div{height:100%}.bar div.clickable{cursor:pointer}.bar div.clickable:hover{opacity:.8}.legend{display:flex;flex-direction:row;flex-wrap:wrap;gap:var(--ha-space-3);margin:12px 0;padding:0;list-style:none}.legend li{display:flex;align-items:center;gap:var(--ha-space-1);font-size:var(--ha-font-size-s)}.legend li .bullet{width:12px;height:12px;border-radius:var(--ha-border-radius-circle)}.spacer{flex:1}.legend li.clickable{cursor:pointer}.legend li.clickable:hover{opacity:.8}.legend li.hidden{opacity:.5}.legend li.hidden .label{text-decoration:line-through}`)),(0,s.Cg)([(0,a.MZ)({attribute:!1})],f.prototype,"segments",void 0),(0,s.Cg)([(0,a.MZ)({type:String})],f.prototype,"heading",void 0),(0,s.Cg)([(0,a.MZ)({type:String})],f.prototype,"description",void 0),(0,s.Cg)([(0,a.MZ)({type:Boolean,attribute:"hide-legend"})],f.prototype,"hideLegend",void 0),(0,s.Cg)([(0,a.MZ)({type:Boolean,attribute:"hide-tooltip"})],f.prototype,"hideTooltip",void 0),(0,s.Cg)([(0,a.MZ)({type:Boolean})],f.prototype,"clickable",void 0),(0,s.Cg)([(0,a.MZ)({type:Boolean,attribute:"bar-clickable"})],f.prototype,"barClickable",void 0),(0,s.Cg)([(0,a.MZ)({attribute:!1})],f.prototype,"hiddenSegments",void 0),f=(0,s.Cg)([(0,a.EM)("ha-segmented-bar")],f),t()}catch(h){t(h)}})},48949:function(e,t,i){i.d(t,{Q:function(){return l}});i(62953);var s=i(40445),n=i(77845),a=i(84187),r=i(71769);const l=e=>{class t extends e{connectedCallback(){super.connectedCallback(),this._unsubMql=(0,r.m)("all and (max-width: 450px), all and (max-height: 500px)",e=>{this._isMobileSize=e})}disconnectedCallback(){var e;super.disconnectedCallback(),null===(e=this._unsubMql)||void 0===e||e.call(this),this._unsubMql=void 0}constructor(...e){super(...e),this._isMobileSize=!1,this._isMobileClient=a.M}}return(0,s.Cg)([(0,n.wk)()],t.prototype,"_isMobileSize",void 0),t}},62707:function(e,t,i){i.a(e,async function(e,s){try{i.r(t),i.d(t,{HuiDistributionCard:function(){return A}});i(44114),i(18111),i(22489),i(7588),i(61701),i(3362),i(17642),i(58004),i(33853),i(45876),i(32475),i(15024),i(31698),i(62953);var n=i(40445),a=i(96196),r=i(77845),l=i(94333),o=i(6415),d=i(22786),c=i(1087),h=i(90433),g=i(71727),p=i(48949),u=i(37642),y=(i(34296),i(76776),i(96832)),b=(i(67094),i(85979)),m=i(20939),v=i(13632),f=e([y]);y=(f.then?(await f)():f)[0];let _,x,k,$,C,w,L,E,M,S,q,H,V=e=>e;const z="M19 3H5C3.9 3 3 3.9 3 5V19C3 20.1 3.9 21 5 21H19C20.1 21 21 20.1 21 19V5C21 3.9 20.1 3 19 3M9 17H7V10H9V17M13 17H11V7H13V17M17 17H15V13H17V17Z",I="M7.41,8.58L12,13.17L16.59,8.58L18,10L12,16L6,10L7.41,8.58Z",N="M7.41,15.41L12,10.83L16.59,15.41L18,14L12,8L6,14L7.41,15.41Z",Z=10,D=6;class A extends((0,p.Q)(a.WF)){static async getConfigElement(){return await Promise.all([i.e("99143"),i.e("66990"),i.e("38076"),i.e("43762")]).then(i.bind(i,35722)),document.createElement("hui-distribution-card-editor")}static getStubConfig(e,t,i){let s=(0,v.B)(e,3,t,i,["sensor"],e=>{const t=e.attributes.unit_of_measurement,i=Number(e.state);return("W"===t||"kW"===t)&&!isNaN(i)});if(s.length<2){const t=i.filter(t=>{if(!t.startsWith("sensor."))return!1;const i=e.states[t];if(!i)return!1;const s=Number(i.state);return!isNaN(s)}),n=new Map;t.forEach(t=>{const i=e.states[t].attributes.device_class||"none";n.has(i)||n.set(i,[]),n.get(i).push(t)});let a=[];n.forEach(e=>{e.length>a.length&&(a=e)}),a.length>=2&&(s=a.slice(0,3))}return{type:"distribution",entities:s}}setConfig(e){if(this._config=e,!e.entities||0===e.entities.length)return void(this._configEntities=[]);const t=(0,m.L)(e.entities);this._configEntities=t.map(e=>({entity:e.entity,name:e.name}))}getCardSize(){return 3}getGridOptions(){return{columns:12,rows:"auto",min_columns:3,fixed_rows:!0}}_convertToSegments(){const e=getComputedStyle(this),t=[],i=[];if(!this._configEntities||!this.hass)return{segments:t,hiddenIndices:i};return this._configEntities.map((e,t)=>Object.assign(Object.assign({},e),{},{originalIndex:t})).forEach(s=>{const n=this.hass.states[s.entity];if(!n)return;const r=Number(n.state);if(r<=0||isNaN(r))return;const l=(0,h.fI)(s.originalIndex,e),o=(0,u.v)(this.hass,n,s.name),d=this.hass.formatEntityState(n);t.push({value:r,color:l,label:(0,a.qy)(_||(_=V`${0} <span style="color:var(--secondary-text-color)">${0}</span>`),o,d),entityId:s.entity}),this._hiddenEntities.has(s.entity)&&i.push(t.length-1)}),{segments:t,hiddenIndices:i}}_computeLegendItems(){if(!this._configEntities||!this.hass)return[];const e=getComputedStyle(this);return this._configEntities.map((t,i)=>{const s=this.hass.states[t.entity],n=s?Number(s.state):0,a=this._hiddenEntities.has(t.entity),r=!s||n<=0||isNaN(n),l=s?(0,u.v)(this.hass,s,t.name):t.entity,o=s?this.hass.formatEntityState(s):"";return{entity:t.entity,name:l,value:n,formattedValue:o,color:(0,h.fI)(i,e),isHidden:a,isDisabled:r}})}_toggleEntity(e){const t=new Set(this._hiddenEntities);t.has(e)?t.delete(e):t.add(e),this._hiddenEntities=t}_handleSegmentClick(e){const{segment:t}=e.detail;t.entityId&&(0,c.r)(this,"hass-more-info",{entityId:t.entityId})}_handleLegendClick(e){const t=e.currentTarget,i=t.dataset.entity,s="true"===t.dataset.disabled;i&&!s&&this._toggleEntity(i)}_handleLegendKeydown(e){"Enter"!==e.key&&" "!==e.key||(e.preventDefault(),this._handleLegendClick(e))}_toggleExpandLegend(){this._expandLegend=!this._expandLegend}_renderLegend(){const e=this._computeLegendItems(),t=this._isMobileSize?D:Z;return(0,a.qy)(x||(x=V` <ul class="legend"> ${0} ${0} </ul> `),e.map((e,i)=>!this._expandLegend&&i>=t?a.s6:(0,a.qy)(k||(k=V` <li class="${0}" data-entity="${0}" data-disabled="${0}" role="button" aria-pressed="${0}" aria-disabled="${0}" aria-label="${0}" tabindex="${0}" @click="${0}" @keydown="${0}"> <div class="bullet" style="${0}"></div> <span class="label">${0}</span> ${0} </li> `),(0,l.H)({"legend-item":!0,hidden:e.isHidden,disabled:e.isDisabled}),e.entity,e.isDisabled,!e.isHidden,e.isDisabled,e.isDisabled?`${e.name} (unavailable)`:e.isHidden?`Show ${e.name}`:`Hide ${e.name}`,e.isDisabled?-1:0,this._handleLegendClick,this._handleLegendKeydown,(0,o.W)({backgroundColor:e.color}),e.name,e.formattedValue?(0,a.qy)($||($=V`<span class="value">${0}</span>`),e.formattedValue):a.s6)),e.length>t?(0,a.qy)(C||(C=V` <li> <ha-assist-chip @click="${0}" filled .label="${0}"> <ha-svg-icon slot="trailing-icon" .path="${0}"></ha-svg-icon> </ha-assist-chip> </li> `),this._toggleExpandLegend,this._expandLegend?this.hass.localize("ui.components.history_charts.collapse_legend"):`${this.hass.localize("ui.components.history_charts.expand_legend")} (${e.length-t})`,this._expandLegend?N:I):a.s6)}render(){if(!this._config||!this.hass)return a.s6;if(!this._configEntities||0===this._configEntities.length)return(0,a.qy)(w||(w=V` <ha-card .header="${0}"> <div class="card-content"> <div class="empty-state"> <ha-svg-icon .path="${0}"></ha-svg-icon> <p> ${0} </p> </div> </div> </ha-card> `),this._config.title,z,this.hass.localize("ui.panel.lovelace.cards.distribution.add_entities"));const e=this._configEntities.filter(e=>!this.hass.states[e.entity]);if(e.length===this._configEntities.length)return(0,a.qy)(L||(L=V` <hui-warning .hass="${0}"> ${0} </hui-warning> `),this.hass,e.map(e=>(0,b.j)(this.hass,e.entity)));const t=this._validateDeviceClasses(this._configEntities,this.hass);if(t)return(0,a.qy)(E||(E=V` <hui-warning .hass="${0}"> <ha-alert alert-type="error">${0}</ha-alert> </hui-warning> `),this.hass,t);const i=this._convertToSegments();return(0,a.qy)(M||(M=V` <ha-card .header="${0}"> <div class="card-content"> ${0} ${0} </div> </ha-card> `),this._config.title,0===i.segments.length?(0,a.qy)(S||(S=V` <div class="empty-state"> ${0} </div> `),this.hass.localize("ui.panel.lovelace.cards.distribution.no_data")):(0,a.qy)(q||(q=V` <ha-segmented-bar .heading="${0}" .segments="${0}" .hiddenSegments="${0}" bar-clickable hide-legend @segment-clicked="${0}"></ha-segmented-bar> `),"",i.segments,i.hiddenIndices,this._handleSegmentClick),this._renderLegend())}constructor(...e){super(...e),this._hiddenEntities=new Set,this._expandLegend=!1,this._validateDeviceClasses=(0,d.A)((e,t)=>{const i=new Set,s=new Set;return e.forEach(e=>{const n=t.states[e.entity];if(n){const t=(0,g.m)(e.entity);i.add(t);const a=n.attributes.device_class||"none";s.add(a)}}),i.size>1?t.localize("ui.panel.lovelace.cards.distribution.domain_mismatch",{domains:Array.from(i).join(", ")}):s.size>1?t.localize("ui.panel.lovelace.cards.distribution.device_class_mismatch",{classes:Array.from(s).join(", ")}):null})}}A.styles=(0,a.AH)(H||(H=V`:host{display:block}ha-alert{display:block;word-wrap:break-word;overflow-wrap:break-word}.card-content{padding:var(--ha-space-4)}.legend{display:flex;flex-direction:row;flex-wrap:wrap;gap:var(--ha-space-3);margin:var(--ha-space-3) 0 0 0;padding:0;list-style:none}.legend-item{display:flex;align-items:center;gap:var(--ha-space-1);font-size:var(--ha-font-size-s);cursor:pointer;opacity:1;transition:opacity .2s}.legend-item:hover{opacity:.8}.legend-item:focus{outline:2px solid var(--primary-color);outline-offset:2px;opacity:.8}.legend-item.hidden{opacity:.5}.legend-item.hidden .label{text-decoration:line-through}.legend-item.disabled{opacity:.5;cursor:default}.legend-item .bullet{width:12px;height:12px;border-radius:var(--ha-border-radius-circle);flex-shrink:0}.legend-item .label{flex:0 1 auto}.legend-item .value{color:var(--secondary-text-color);margin-left:var(--ha-space-1);flex-shrink:0}.empty-state{text-align:center;color:var(--secondary-text-color);padding:var(--ha-space-4) 0}.empty-state ha-svg-icon{display:block;margin:0 auto var(--ha-space-2);width:48px;height:48px;opacity:.3}.empty-state p{margin:0}@media (max-width:600px){.card-content{padding:var(--ha-space-2)}}ha-assist-chip{height:24px;--_label-text-weight:500;--_leading-space:8px;--_trailing-space:8px;--_icon-label-space:4px}.legend li:has(ha-assist-chip){cursor:default}`)),(0,n.Cg)([(0,r.MZ)({attribute:!1})],A.prototype,"hass",void 0),(0,n.Cg)([(0,r.wk)()],A.prototype,"_config",void 0),(0,n.Cg)([(0,r.wk)()],A.prototype,"_configEntities",void 0),(0,n.Cg)([(0,r.wk)()],A.prototype,"_hiddenEntities",void 0),(0,n.Cg)([(0,r.wk)()],A.prototype,"_expandLegend",void 0),A=(0,n.Cg)([(0,r.EM)("hui-distribution-card")],A),s()}catch(_){s(_)}})},84187:function(e,t,i){i.d(t,{M:function(){return s}});i(27495);const s=/(?:iphone|android|ipad)/i.test(navigator.userAgent)}}]);
//# sourceMappingURL=19472.b3a7c765eae6b981.js.map