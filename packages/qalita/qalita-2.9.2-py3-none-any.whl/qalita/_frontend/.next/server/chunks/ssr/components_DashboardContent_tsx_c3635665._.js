module.exports=[49309,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(38246);function e(){{let a=process.env.HOSTNAME||"localhost",b=process.env.PORT||"7070";return`http://${a}:${b}/api`}}async function f(){let a=await fetch(`${e()}/worker/status`);if(!a.ok){let b=await a.text();throw Error(`Failed to get worker status: ${a.status} - ${b.substring(0,100)}`)}let b=a.headers.get("content-type")||"";if(!b.includes("application/json")){let c=await a.text();throw Error(`Expected JSON but got ${b}: ${c.substring(0,100)}`)}return a.json()}async function g(){return(await fetch(`${e()}/worker/start`,{method:"POST"})).json()}async function h(){return(await fetch(`${e()}/worker/stop`,{method:"POST"})).json()}async function i(){await fetch(`${e()}/validate`,{method:"POST"})}async function j(){await fetch(`${e()}/push`,{method:"POST"})}async function k(a){let b=new FormData;b.append("pack_dir",a);let c=await fetch(`${e()}/pack/push`,{method:"POST",body:b});if(!c.ok){let a=await c.text();throw Error(`Failed to push pack: ${c.status} - ${a.substring(0,100)}`)}return c.json()}function l(){let[a,d]=(0,c.useState)(!1),[e,i]=(0,c.useState)(!0);(0,c.useEffect)(()=>{j();let a=setInterval(j,2e3);return()=>clearInterval(a)},[]);let j=async()=>{try{let a=await f();d(a.running||!1)}catch{}finally{i(!1)}},k=async()=>{try{a?await h():await g(),await j()}catch{}};return e?(0,b.jsx)("span",{className:"muted -mt-[13px]",children:"(loading...)"}):(0,b.jsxs)("div",{className:"flex gap-5 items-center",children:[(0,b.jsx)("div",{id:"worker_switch",className:`-mt-[11px] relative w-[46px] h-[26px] rounded-full cursor-pointer inline-block transition-colors duration-150 ${a?"bg-green-600":"bg-gray-200"}`,onClick:k,children:(0,b.jsx)("div",{id:"worker_knob",className:`absolute top-[3px] w-5 h-5 bg-white rounded-[35%] shadow-sm transition-all duration-150 ${a?"left-[23px]":"left-[3px]"}`})}),(0,b.jsxs)("span",{className:"muted -mt-[13px]",children:["(",a?"running":"stopped",")"]})]})}var m=a.i(71987);function n({isOpen:a,onClose:c,onConfirm:d,title:e,message:f,itemName:g}){return a?(0,b.jsx)("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-[1000]",onClick:c,children:(0,b.jsxs)("div",{className:"card min-w-[400px] max-w-[90%] bg-white dark:bg-gray-800 p-6",onClick:a=>a.stopPropagation(),children:[(0,b.jsx)("h2",{className:"mt-0 dark:text-white",children:e}),(0,b.jsx)("p",{className:"dark:text-gray-300",children:f}),g&&(0,b.jsx)("p",{className:"font-bold text-danger",children:g}),(0,b.jsxs)("div",{className:"actions mt-5 justify-end",children:[(0,b.jsx)("button",{className:"btn secondary",onClick:c,type:"button",children:"Cancel"}),(0,b.jsx)("button",{className:"btn danger",onClick:d,type:"button",children:"Delete"})]})]})}):null}let o={file:"file.svg",csv:"csv.svg",excel:"excel.svg",folder:"folder.svg",postgresql:"postgresql.svg",mysql:"mysql.svg",oracle:"oracle.svg",mssql:"mssql.svg",sqlite:"sqlite.svg",mongodb:"mongodb.svg",s3:"s3.svg",gcs:"gcs.png",azure_blob:"azure_blob.svg",hdfs:"hdfs.svg"};function p({sources:a,platformUrl:e}){let[f,g]=(0,c.useState)({isOpen:!1,sourceName:null}),h=async()=>{if(f.sourceName)try{await fetch(`/api/sources/delete/${encodeURIComponent(f.sourceName)}`,{method:"POST"}),window.location.reload()}catch{}finally{g({isOpen:!1,sourceName:null})}};return(0,b.jsxs)("div",{className:"card",children:[(0,b.jsxs)("table",{children:[(0,b.jsx)("thead",{children:(0,b.jsxs)("tr",{children:[(0,b.jsx)("th",{children:"Name"}),(0,b.jsx)("th",{children:"Type"}),(0,b.jsx)("th",{children:"Visibility"}),(0,b.jsx)("th",{children:"Check"}),(0,b.jsx)("th",{})]})}),(0,b.jsx)("tbody",{children:a.map(a=>{let c=o[a.type]||"folder.svg",f=(a.visibility||"").toLowerCase(),h=(a.validate||"").toLowerCase();return(0,b.jsxs)("tr",{children:[(0,b.jsxs)("td",{className:"dark:text-gray-200",children:[a.id&&e?(0,b.jsx)("a",{href:`${e}/home/data-engineering/sources/${a.id}`,target:"_blank",rel:"noopener noreferrer",children:a.name}):a.name,a.description&&(0,b.jsx)("div",{className:"subtle",children:a.description})]}),(0,b.jsx)("td",{className:"dark:text-gray-200",children:(0,b.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,b.jsx)(m.default,{src:`/sources-logos/${c}`,alt:a.type,width:20,height:20,className:"h-5 max-w-[30px] rounded"}),(0,b.jsx)("span",{children:a.type})]})}),(0,b.jsxs)("td",{children:["private"===f&&(0,b.jsxs)("span",{title:"private",className:"badge badge-private dark:text-gray-400",children:[(0,b.jsxs)("svg",{width:"16",height:"16",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,b.jsx)("rect",{x:"3",y:"9",width:"14",height:"8",rx:"2",stroke:"currentColor",strokeWidth:"2"}),(0,b.jsx)("path",{d:"M6 9V7a4 4 0 1 1 8 0v2",stroke:"currentColor",strokeWidth:"2",fill:"none"})]}),"Private"]}),"internal"===f&&(0,b.jsxs)("span",{title:"internal",className:"badge badge-internal",children:[(0,b.jsxs)("svg",{width:"16",height:"16",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,b.jsx)("rect",{x:"3",y:"6",width:"14",height:"10",rx:"2",stroke:"currentColor",strokeWidth:"2"}),(0,b.jsx)("path",{d:"M7 6V4h6v2",stroke:"currentColor",strokeWidth:"2"})]}),"Internal"]}),"public"===f&&(0,b.jsxs)("span",{title:"public",className:"badge badge-public",children:[(0,b.jsxs)("svg",{width:"16",height:"16",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,b.jsx)("circle",{cx:"10",cy:"10",r:"8",stroke:"currentColor",strokeWidth:"2"}),(0,b.jsx)("path",{d:"M2 10h16M10 2a12 12 0 0 1 0 16M10 2a12 12 0 0 0 0 16",stroke:"currentColor",strokeWidth:"2"})]}),"Public"]}),!["private","internal","public"].includes(f)&&(0,b.jsx)("span",{className:"muted",children:a.visibility})]}),(0,b.jsxs)("td",{children:["valid"===h&&(0,b.jsxs)("span",{title:"valid",className:"badge badge-valid",children:[(0,b.jsxs)("svg",{width:"16",height:"16",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,b.jsx)("circle",{cx:"10",cy:"10",r:"9",stroke:"currentColor",strokeWidth:"2"}),(0,b.jsx)("path",{d:"M6 10.5l2.5 2.5L14 7.5",stroke:"currentColor",strokeWidth:"2",fill:"none",strokeLinecap:"round",strokeLinejoin:"round"})]}),"Reachable"]}),"invalid"===h&&(0,b.jsxs)("span",{title:"invalid",className:"badge badge-invalid",children:[(0,b.jsxs)("svg",{width:"16",height:"16",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,b.jsx)("circle",{cx:"10",cy:"10",r:"9",stroke:"currentColor",strokeWidth:"2"}),(0,b.jsx)("path",{d:"M7 7l6 6M13 7l-6 6",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round"})]}),"Unreachable"]}),!["valid","invalid"].includes(h)&&(0,b.jsx)("span",{className:"muted",children:a.validate||""})]}),(0,b.jsx)("td",{className:"muted"}),(0,b.jsx)("td",{children:(0,b.jsxs)("div",{className:"actions",children:[a.id?(0,b.jsx)(d.default,{className:"btn secondary",href:`/sources/edit/${encodeURIComponent(a.id)}`,children:"Edit"}):(0,b.jsx)("span",{className:"btn secondary opacity-50 cursor-not-allowed",title:"Source ID not available",children:"Edit"}),(0,b.jsx)("button",{className:"btn danger",type:"button",onClick:()=>{g({isOpen:!0,sourceName:a.name})},children:"Delete"})]})})]},a.name)})})]}),(0,b.jsx)(n,{isOpen:f.isOpen,onClose:()=>{g({isOpen:!1,sourceName:null})},onConfirm:h,title:"Delete Source",message:"Are you sure you want to delete this source? This action cannot be undone.",itemName:f.sourceName||void 0})]})}function q({initialData:a}){let[e,f]=(0,c.useState)(null),g=async()=>{try{await i(),f({message:"Validation completed",level:"info"}),setTimeout(()=>window.location.reload(),1e3)}catch(a){f({message:"Validation failed",level:"error"})}},h=async()=>{try{await j(),f({message:"Push completed",level:"info"}),setTimeout(()=>window.location.reload(),1e3)}catch(a){f({message:"Push failed",level:"error"})}},m=async a=>{a.preventDefault();let b=new FormData(a.currentTarget).get("pack_dir");if(!b)return void f({message:"Please select a pack folder",level:"error"});try{let a=await k(b);f({message:a.message||(a.ok?"Pack pushed successfully":"Pack push failed"),level:a.level||(a.ok?"info":"error")}),a.ok&&setTimeout(()=>window.location.reload(),1e3)}catch(a){f({message:`Pack push failed: ${a instanceof Error?a.message:"Unknown error"}`,level:"error"})}};return(0,b.jsxs)("div",{className:"container mt-3",children:[e&&(0,b.jsx)("div",{className:`alert ${"error"===e.level?"alert-error":"alert-info"} mb-3`,children:e.message}),(0,b.jsxs)("div",{className:"grid",children:[(0,b.jsxs)("div",{children:[(0,b.jsxs)("div",{className:"flex items-center justify-start gap-3 mb-3",children:[(0,b.jsx)("h2",{className:"m-0 dark:text-white",children:"Sources"}),(0,b.jsxs)("div",{className:"actions",children:[(0,b.jsx)(d.default,{className:"btn",href:"/sources/add",children:"Add source"}),(0,b.jsx)("form",{className:"inline",onSubmit:a=>{a.preventDefault(),g()},children:(0,b.jsx)("button",{className:"btn secondary",type:"submit",children:"Validate"})}),(0,b.jsx)("form",{className:"inline",onSubmit:a=>{a.preventDefault(),h()},children:(0,b.jsx)("button",{className:"btn secondary",type:"submit",children:"Push"})})]})]}),(0,b.jsx)(p,{sources:a.sources,platformUrl:a.platform_url})]}),(0,b.jsxs)("div",{className:"mt-3",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2.5",children:[(0,b.jsx)("h2",{className:"dark:text-white",children:"Worker"}),(0,b.jsx)(l,{})]}),(0,b.jsx)("div",{className:"card mb-6",children:a.worker_conf?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)("div",{className:"grid grid-cols-[160px_1fr] gap-y-2 gap-x-3",children:[(0,b.jsx)("div",{className:"muted",children:"Name"}),(0,b.jsx)("div",{"data-worker-name":!0,className:"dark:text-gray-200",children:a.platform_url?(0,b.jsx)("a",{href:`${a.platform_url}/home/data-engineering/workers/?worker=${a.worker_conf.name||""}`,target:"_blank",rel:"noopener noreferrer",children:a.worker_conf.name||""}):a.worker_conf.name||""}),(0,b.jsx)("div",{className:"muted",children:"Mode"}),(0,b.jsx)("div",{"data-worker-mode":!0,className:"dark:text-gray-200",children:a.worker_conf.mode||""}),(0,b.jsx)("div",{className:"muted",children:"Backend URL"}),(0,b.jsx)("div",{"data-worker-url":!0,className:"dark:text-gray-200",children:(0,b.jsx)("a",{href:a.worker_conf.url||"",target:"_blank",rel:"noopener noreferrer",children:a.worker_conf.url||""})}),(0,b.jsx)("div",{className:"muted",children:"Worker ID"}),(0,b.jsx)("div",{"data-worker-id":!0,className:"dark:text-gray-200",children:a.worker_conf.worker_id||""})]}),(0,b.jsxs)("div",{className:"mt-3",children:[(0,b.jsx)("div",{className:"muted mb-1.5",children:"Worker Runs"}),a.worker_runs_page&&a.worker_runs_page.length>0?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("ul",{className:"m-0 pl-[18px] dark:text-gray-200",children:a.worker_runs_page.map(a=>(0,b.jsxs)("li",{children:[(0,b.jsx)("span",{className:"muted",children:a.when})," —"," ",(0,b.jsx)("code",{className:"dark:bg-gray-700 dark:text-gray-200 px-1 rounded",children:(0,b.jsx)("a",{href:`/api/worker/run/${a.name}`,onClick:async b=>{b.preventDefault();try{await fetch(`/api/worker/run/${a.name}`)}catch{}},className:"cursor-pointer",children:a.name})})]},a.name))}),(0,b.jsxs)("div",{className:"flex items-center justify-between mt-2",children:[(0,b.jsxs)("div",{className:"muted",children:["Showing ",a.runs_start,"–",a.runs_end," of ",a.runs_total]}),(0,b.jsxs)("div",{className:"actions flex gap-2",children:[a.runs_has_prev?(0,b.jsx)(d.default,{className:"btn secondary",href:`/?runs_page=${a.runs_page-1}&runs_per_page=${a.runs_per_page}`,children:"Prev"}):(0,b.jsx)("button",{className:"btn secondary",disabled:!0,children:"Prev"}),a.runs_has_next?(0,b.jsx)(d.default,{className:"btn secondary",href:`/?runs_page=${a.runs_page+1}&runs_per_page=${a.runs_per_page}`,children:"Next"}):(0,b.jsx)("button",{className:"btn secondary",disabled:!0,children:"Next"})]})]})]}):(0,b.jsx)("div",{className:"muted",children:"No runs found."})]})]}):(0,b.jsx)("div",{className:"muted",children:'No worker configuration found. Use "qalita worker login" to configure.'})}),a.platform_url&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("h2",{className:"dark:text-white",children:"Pack"}),(0,b.jsx)("div",{className:"card mb-6",children:(0,b.jsxs)("form",{onSubmit:m,children:[(0,b.jsx)("label",{className:"mt-0 mb-2",htmlFor:"pack_dir",children:"Pack folder"}),(0,b.jsxs)("div",{className:"flex gap-2 items-stretch",children:[(0,b.jsx)("input",{id:"pack_dir",name:"pack_dir",type:"text",placeholder:"/path/to/your_pack",className:"flex-1 !mt-0 h-[38px]"}),(0,b.jsx)("button",{type:"button",className:"btn secondary h-[38px] shrink-0",id:"browse_pack",onClick:async()=>{try{let a=await fetch("/api/sources/pick-folder"),b=await a.json();if(b.path){let a=document.getElementById("pack_dir");a&&(a.value=b.path)}}catch{}},children:"Browse…"})]}),(0,b.jsx)("div",{className:"flex justify-end mt-4",children:(0,b.jsx)("button",{className:"btn h-[38px]",type:"submit",children:"Push Pack"})})]})})]})]})]})]})}a.s(["default",()=>q],49309)}];

//# sourceMappingURL=components_DashboardContent_tsx_c3635665._.js.map