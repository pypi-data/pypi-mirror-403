(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,33525,(e,s,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"warnOnce",{enumerable:!0,get:function(){return t}});let t=e=>{}},10887,e=>{"use strict";var s=e.i(43476),r=e.i(71645),t=e.i(22016);function a(){return"/api"}async function n(){let e=await fetch(`${a()}/worker/status`);if(!e.ok){let s=await e.text();throw Error(`Failed to get worker status: ${e.status} - ${s.substring(0,100)}`)}let s=e.headers.get("content-type")||"";if(!s.includes("application/json")){let r=await e.text();throw Error(`Expected JSON but got ${s}: ${r.substring(0,100)}`)}return e.json()}async function l(){return(await fetch(`${a()}/worker/start`,{method:"POST"})).json()}async function i(){return(await fetch(`${a()}/worker/stop`,{method:"POST"})).json()}async function c(){await fetch(`${a()}/validate`,{method:"POST"})}async function o(){await fetch(`${a()}/push`,{method:"POST"})}async function d(e){let s=new FormData;s.append("pack_dir",e);let r=await fetch(`${a()}/pack/push`,{method:"POST",body:s});if(!r.ok){let e=await r.text();throw Error(`Failed to push pack: ${r.status} - ${e.substring(0,100)}`)}return r.json()}function h(){let[e,t]=(0,r.useState)(!1),[a,c]=(0,r.useState)(!0);(0,r.useEffect)(()=>{o();let e=setInterval(o,2e3);return()=>clearInterval(e)},[]);let o=async()=>{try{let e=await n();t(e.running||!1)}catch{}finally{c(!1)}},d=async()=>{try{e?await i():await l(),await o()}catch{}};return a?(0,s.jsx)("span",{className:"muted -mt-[13px]",children:"(loading...)"}):(0,s.jsxs)("div",{className:"flex gap-5 items-center",children:[(0,s.jsx)("div",{id:"worker_switch",className:`-mt-[11px] relative w-[46px] h-[26px] rounded-full cursor-pointer inline-block transition-colors duration-150 ${e?"bg-green-600":"bg-gray-200"}`,onClick:d,children:(0,s.jsx)("div",{id:"worker_knob",className:`absolute top-[3px] w-5 h-5 bg-white rounded-[35%] shadow-sm transition-all duration-150 ${e?"left-[23px]":"left-[3px]"}`})}),(0,s.jsxs)("span",{className:"muted -mt-[13px]",children:["(",e?"running":"stopped",")"]})]})}var m=e.i(57688);function u({isOpen:e,onClose:r,onConfirm:t,title:a,message:n,itemName:l}){return e?(0,s.jsx)("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-[1000]",onClick:r,children:(0,s.jsxs)("div",{className:"card min-w-[400px] max-w-[90%] bg-white dark:bg-gray-800 p-6",onClick:e=>e.stopPropagation(),children:[(0,s.jsx)("h2",{className:"mt-0 dark:text-white",children:a}),(0,s.jsx)("p",{className:"dark:text-gray-300",children:n}),l&&(0,s.jsx)("p",{className:"font-bold text-danger",children:l}),(0,s.jsxs)("div",{className:"actions mt-5 justify-end",children:[(0,s.jsx)("button",{className:"btn secondary",onClick:r,type:"button",children:"Cancel"}),(0,s.jsx)("button",{className:"btn danger",onClick:t,type:"button",children:"Delete"})]})]})}):null}let x={file:"file.svg",csv:"csv.svg",excel:"excel.svg",folder:"folder.svg",postgresql:"postgresql.svg",mysql:"mysql.svg",oracle:"oracle.svg",mssql:"mssql.svg",sqlite:"sqlite.svg",mongodb:"mongodb.svg",s3:"s3.svg",gcs:"gcs.png",azure_blob:"azure_blob.svg",hdfs:"hdfs.svg"};function p({sources:e,platformUrl:a}){let[n,l]=(0,r.useState)({isOpen:!1,sourceName:null}),i=async()=>{if(n.sourceName)try{await fetch(`/api/sources/delete/${encodeURIComponent(n.sourceName)}`,{method:"POST"}),window.location.reload()}catch{}finally{l({isOpen:!1,sourceName:null})}};return(0,s.jsxs)("div",{className:"card",children:[(0,s.jsxs)("table",{children:[(0,s.jsx)("thead",{children:(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{children:"Name"}),(0,s.jsx)("th",{children:"Type"}),(0,s.jsx)("th",{children:"Visibility"}),(0,s.jsx)("th",{children:"Check"}),(0,s.jsx)("th",{})]})}),(0,s.jsx)("tbody",{children:e.map(e=>{let r=x[e.type]||"folder.svg",n=(e.visibility||"").toLowerCase(),i=(e.validate||"").toLowerCase();return(0,s.jsxs)("tr",{children:[(0,s.jsxs)("td",{className:"dark:text-gray-200",children:[e.id&&a?(0,s.jsx)("a",{href:`${a}/home/data-engineering/sources/${e.id}`,target:"_blank",rel:"noopener noreferrer",children:e.name}):e.name,e.description&&(0,s.jsx)("div",{className:"subtle",children:e.description})]}),(0,s.jsx)("td",{className:"dark:text-gray-200",children:(0,s.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,s.jsx)(m.default,{src:`/sources-logos/${r}`,alt:e.type,width:20,height:20,className:"h-5 max-w-[30px] rounded"}),(0,s.jsx)("span",{children:e.type})]})}),(0,s.jsxs)("td",{children:["private"===n&&(0,s.jsxs)("span",{title:"private",className:"badge badge-private dark:text-gray-400",children:[(0,s.jsxs)("svg",{width:"16",height:"16",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,s.jsx)("rect",{x:"3",y:"9",width:"14",height:"8",rx:"2",stroke:"currentColor",strokeWidth:"2"}),(0,s.jsx)("path",{d:"M6 9V7a4 4 0 1 1 8 0v2",stroke:"currentColor",strokeWidth:"2",fill:"none"})]}),"Private"]}),"internal"===n&&(0,s.jsxs)("span",{title:"internal",className:"badge badge-internal",children:[(0,s.jsxs)("svg",{width:"16",height:"16",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,s.jsx)("rect",{x:"3",y:"6",width:"14",height:"10",rx:"2",stroke:"currentColor",strokeWidth:"2"}),(0,s.jsx)("path",{d:"M7 6V4h6v2",stroke:"currentColor",strokeWidth:"2"})]}),"Internal"]}),"public"===n&&(0,s.jsxs)("span",{title:"public",className:"badge badge-public",children:[(0,s.jsxs)("svg",{width:"16",height:"16",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,s.jsx)("circle",{cx:"10",cy:"10",r:"8",stroke:"currentColor",strokeWidth:"2"}),(0,s.jsx)("path",{d:"M2 10h16M10 2a12 12 0 0 1 0 16M10 2a12 12 0 0 0 0 16",stroke:"currentColor",strokeWidth:"2"})]}),"Public"]}),!["private","internal","public"].includes(n)&&(0,s.jsx)("span",{className:"muted",children:e.visibility})]}),(0,s.jsxs)("td",{children:["valid"===i&&(0,s.jsxs)("span",{title:"valid",className:"badge badge-valid",children:[(0,s.jsxs)("svg",{width:"16",height:"16",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,s.jsx)("circle",{cx:"10",cy:"10",r:"9",stroke:"currentColor",strokeWidth:"2"}),(0,s.jsx)("path",{d:"M6 10.5l2.5 2.5L14 7.5",stroke:"currentColor",strokeWidth:"2",fill:"none",strokeLinecap:"round",strokeLinejoin:"round"})]}),"Reachable"]}),"invalid"===i&&(0,s.jsxs)("span",{title:"invalid",className:"badge badge-invalid",children:[(0,s.jsxs)("svg",{width:"16",height:"16",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,s.jsx)("circle",{cx:"10",cy:"10",r:"9",stroke:"currentColor",strokeWidth:"2"}),(0,s.jsx)("path",{d:"M7 7l6 6M13 7l-6 6",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round"})]}),"Unreachable"]}),!["valid","invalid"].includes(i)&&(0,s.jsx)("span",{className:"muted",children:e.validate||""})]}),(0,s.jsx)("td",{className:"muted"}),(0,s.jsx)("td",{children:(0,s.jsxs)("div",{className:"actions",children:[e.id?(0,s.jsx)(t.default,{className:"btn secondary",href:`/sources/edit/${encodeURIComponent(e.id)}`,children:"Edit"}):(0,s.jsx)("span",{className:"btn secondary opacity-50 cursor-not-allowed",title:"Source ID not available",children:"Edit"}),(0,s.jsx)("button",{className:"btn danger",type:"button",onClick:()=>{l({isOpen:!0,sourceName:e.name})},children:"Delete"})]})})]},e.name)})})]}),(0,s.jsx)(u,{isOpen:n.isOpen,onClose:()=>{l({isOpen:!1,sourceName:null})},onConfirm:i,title:"Delete Source",message:"Are you sure you want to delete this source? This action cannot be undone.",itemName:n.sourceName||void 0})]})}function g({initialData:e}){let[a,n]=(0,r.useState)(null),l=async()=>{try{await c(),n({message:"Validation completed",level:"info"}),setTimeout(()=>window.location.reload(),1e3)}catch(e){n({message:"Validation failed",level:"error"})}},i=async()=>{try{await o(),n({message:"Push completed",level:"info"}),setTimeout(()=>window.location.reload(),1e3)}catch(e){n({message:"Push failed",level:"error"})}},m=async e=>{e.preventDefault();let s=new FormData(e.currentTarget).get("pack_dir");if(!s)return void n({message:"Please select a pack folder",level:"error"});try{let e=await d(s);n({message:e.message||(e.ok?"Pack pushed successfully":"Pack push failed"),level:e.level||(e.ok?"info":"error")}),e.ok&&setTimeout(()=>window.location.reload(),1e3)}catch(e){n({message:`Pack push failed: ${e instanceof Error?e.message:"Unknown error"}`,level:"error"})}};return(0,s.jsxs)("div",{className:"container mt-3",children:[a&&(0,s.jsx)("div",{className:`alert ${"error"===a.level?"alert-error":"alert-info"} mb-3`,children:a.message}),(0,s.jsxs)("div",{className:"grid",children:[(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{className:"flex items-center justify-start gap-3 mb-3",children:[(0,s.jsx)("h2",{className:"m-0 dark:text-white",children:"Sources"}),(0,s.jsxs)("div",{className:"actions",children:[(0,s.jsx)(t.default,{className:"btn",href:"/sources/add",children:"Add source"}),(0,s.jsx)("form",{className:"inline",onSubmit:e=>{e.preventDefault(),l()},children:(0,s.jsx)("button",{className:"btn secondary",type:"submit",children:"Validate"})}),(0,s.jsx)("form",{className:"inline",onSubmit:e=>{e.preventDefault(),i()},children:(0,s.jsx)("button",{className:"btn secondary",type:"submit",children:"Push"})})]})]}),(0,s.jsx)(p,{sources:e.sources,platformUrl:e.platform_url})]}),(0,s.jsxs)("div",{className:"mt-3",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2.5",children:[(0,s.jsx)("h2",{className:"dark:text-white",children:"Worker"}),(0,s.jsx)(h,{})]}),(0,s.jsx)("div",{className:"card mb-6",children:e.worker_conf?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"grid grid-cols-[160px_1fr] gap-y-2 gap-x-3",children:[(0,s.jsx)("div",{className:"muted",children:"Name"}),(0,s.jsx)("div",{"data-worker-name":!0,className:"dark:text-gray-200",children:e.platform_url?(0,s.jsx)("a",{href:`${e.platform_url}/home/data-engineering/workers/?worker=${e.worker_conf.name||""}`,target:"_blank",rel:"noopener noreferrer",children:e.worker_conf.name||""}):e.worker_conf.name||""}),(0,s.jsx)("div",{className:"muted",children:"Mode"}),(0,s.jsx)("div",{"data-worker-mode":!0,className:"dark:text-gray-200",children:e.worker_conf.mode||""}),(0,s.jsx)("div",{className:"muted",children:"Backend URL"}),(0,s.jsx)("div",{"data-worker-url":!0,className:"dark:text-gray-200",children:(0,s.jsx)("a",{href:e.worker_conf.url||"",target:"_blank",rel:"noopener noreferrer",children:e.worker_conf.url||""})}),(0,s.jsx)("div",{className:"muted",children:"Worker ID"}),(0,s.jsx)("div",{"data-worker-id":!0,className:"dark:text-gray-200",children:e.worker_conf.worker_id||""})]}),(0,s.jsxs)("div",{className:"mt-3",children:[(0,s.jsx)("div",{className:"muted mb-1.5",children:"Worker Runs"}),e.worker_runs_page&&e.worker_runs_page.length>0?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("ul",{className:"m-0 pl-[18px] dark:text-gray-200",children:e.worker_runs_page.map(e=>(0,s.jsxs)("li",{children:[(0,s.jsx)("span",{className:"muted",children:e.when})," —"," ",(0,s.jsx)("code",{className:"dark:bg-gray-700 dark:text-gray-200 px-1 rounded",children:(0,s.jsx)("a",{href:`/api/worker/run/${e.name}`,onClick:async s=>{s.preventDefault();try{await fetch(`/api/worker/run/${e.name}`)}catch{}},className:"cursor-pointer",children:e.name})})]},e.name))}),(0,s.jsxs)("div",{className:"flex items-center justify-between mt-2",children:[(0,s.jsxs)("div",{className:"muted",children:["Showing ",e.runs_start,"–",e.runs_end," of ",e.runs_total]}),(0,s.jsxs)("div",{className:"actions flex gap-2",children:[e.runs_has_prev?(0,s.jsx)(t.default,{className:"btn secondary",href:`/?runs_page=${e.runs_page-1}&runs_per_page=${e.runs_per_page}`,children:"Prev"}):(0,s.jsx)("button",{className:"btn secondary",disabled:!0,children:"Prev"}),e.runs_has_next?(0,s.jsx)(t.default,{className:"btn secondary",href:`/?runs_page=${e.runs_page+1}&runs_per_page=${e.runs_per_page}`,children:"Next"}):(0,s.jsx)("button",{className:"btn secondary",disabled:!0,children:"Next"})]})]})]}):(0,s.jsx)("div",{className:"muted",children:"No runs found."})]})]}):(0,s.jsx)("div",{className:"muted",children:'No worker configuration found. Use "qalita worker login" to configure.'})}),e.platform_url&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("h2",{className:"dark:text-white",children:"Pack"}),(0,s.jsx)("div",{className:"card mb-6",children:(0,s.jsxs)("form",{onSubmit:m,children:[(0,s.jsx)("label",{className:"mt-0 mb-2",htmlFor:"pack_dir",children:"Pack folder"}),(0,s.jsxs)("div",{className:"flex gap-2 items-stretch",children:[(0,s.jsx)("input",{id:"pack_dir",name:"pack_dir",type:"text",placeholder:"/path/to/your_pack",className:"flex-1 !mt-0 h-[38px]"}),(0,s.jsx)("button",{type:"button",className:"btn secondary h-[38px] shrink-0",id:"browse_pack",onClick:async()=>{try{let e=await fetch("/api/sources/pick-folder"),s=await e.json();if(s.path){let e=document.getElementById("pack_dir");e&&(e.value=s.path)}}catch{}},children:"Browse…"})]}),(0,s.jsx)("div",{className:"flex justify-end mt-4",children:(0,s.jsx)("button",{className:"btn h-[38px]",type:"submit",children:"Push Pack"})})]})})]})]})]})]})}e.s(["default",()=>g],10887)}]);