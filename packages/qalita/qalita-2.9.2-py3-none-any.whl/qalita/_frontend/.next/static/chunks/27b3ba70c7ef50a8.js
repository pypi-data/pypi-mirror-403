(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,33525,(e,s,a)=>{"use strict";Object.defineProperty(a,"__esModule",{value:!0}),Object.defineProperty(a,"warnOnce",{enumerable:!0,get:function(){return t}});let t=e=>{}},18566,(e,s,a)=>{s.exports=e.r(76562)},84198,e=>{"use strict";var s=e.i(43476),a=e.i(71645),t=e.i(18566),n=e.i(57688);let l=["file","csv","excel","folder","postgresql","mysql","oracle","mssql","sqlite","mongodb","s3","gcs","azure_blob","hdfs"],r={file:"file.svg",csv:"csv.svg",excel:"excel.svg",folder:"folder.svg",postgresql:"postgresql.svg",mysql:"mysql.svg",oracle:"oracle.svg",mssql:"mssql.svg",sqlite:"sqlite.svg",mongodb:"mongodb.svg",s3:"s3.svg",gcs:"gcs.png",azure_blob:"azure_blob.svg",hdfs:"hdfs.svg"};function i(e,s){let a={name:e?.name||"",type:e?.type||s||"file",description:e?.description||"",visibility:e?.visibility||"private",reference:e?.config?.reference||!1,sensitive:e?.config?.sensitive||!1};if(!e?.config)return a;let t=e.config,n=e.type||s||"file",l={...a};return"file"===n&&t.path?l.file_path=t.path:"csv"===n&&t.path?(l.csv_path=t.path,l.csv_delimiter=t.delimiter||",",l.csv_encoding=t.encoding||"utf-8",l.csv_header=t.has_header||!1):"excel"===n&&t.path?(l.excel_path=t.path,l.excel_sheet=t.sheet||"",l.excel_header_row=t.header_row||"1"):"sqlite"===n&&t.file_path?l.sqlite_file_path=t.file_path:"folder"===n&&t.path&&(l.folder_path=t.path),["postgresql","mysql","oracle","mssql"].includes(n)&&(t.host&&(l.db_host=t.host),t.port&&(l.db_port=t.port),t.username&&(l.db_username=t.username),t.password&&(l.db_password=t.password),t.database&&(l.db_database=t.database),t.table_or_query&&(l.db_table_or_query=t.table_or_query),("postgresql"===n||"oracle"===n)&&t.schema&&(l.db_schema=t.schema)),"mongodb"===n&&(t.host&&(l.mongo_host=t.host),t.port&&(l.mongo_port=t.port),t.username&&(l.mongo_username=t.username),t.password&&(l.mongo_password=t.password),t.database&&(l.mongo_database=t.database)),"s3"===n&&(t.bucket&&(l.s3_bucket=t.bucket),t.prefix&&(l.s3_prefix=t.prefix),t.access_key&&(l.s3_access_key=t.access_key),t.secret_key&&(l.s3_secret_key=t.secret_key),t.region&&(l.s3_region=t.region)),"gcs"===n&&(t.bucket&&(l.gcs_bucket=t.bucket),t.prefix&&(l.gcs_prefix=t.prefix),t.credentials&&(l.gcs_credentials=t.credentials)),"azure_blob"===n&&(t.container&&(l.azure_blob_container=t.container),t.prefix&&(l.azure_blob_prefix=t.prefix),t.account_name&&(l.azure_blob_account_name=t.account_name),t.account_key&&(l.azure_blob_account_key=t.account_key)),"hdfs"===n&&(t.path&&(l.hdfs_path=t.path),t.namenode&&(l.hdfs_namenode=t.namenode)),l}function c({source:e,preselectedType:c,onSuccess:o}){let d=(0,t.useRouter)(),[h,p]=(0,a.useState)(()=>i(e,c)),[x,u]=(0,a.useState)(null),[m,b]=(0,a.useState)(!1),[g,_]=(0,a.useState)(null);(0,a.useEffect)(()=>{e&&p(i(e,c))},[e,c]);let j=e=>{let{name:s,value:a,type:t}=e.target;if("checkbox"===t){let a=e.target.checked;p(e=>({...e,[s]:a}))}else p(e=>({...e,[s]:a}))},v=async()=>{try{let e=await fetch("/api/sources/pick-file"),s=await e.json();if(s.path){let e="csv"===h.type?"csv_path":"excel"===h.type?"excel_path":"sqlite"===h.type?"sqlite_file_path":"file_path";p(a=>({...a,[e]:s.path}))}}catch{}},f=async()=>{try{let e=await fetch("/api/sources/pick-folder"),s=await e.json();s.path&&p(e=>({...e,folder_path:s.path}))}catch{}},y=async()=>{b(!0),_(null);try{let s,a=new FormData;Object.entries(h).forEach(([e,s])=>{null!=s&&a.append(e,String(s))}),e&&a.append("original_name",e.name);let t=await fetch("/api/sources/validate",{method:"POST",body:a}),n=await t.text();try{s=JSON.parse(n)}catch(e){_({message:`Validation failed: ${t.status} ${t.statusText}. ${n.substring(0,100)}`,ok:!1});return}_({message:s.message||(s.ok?"Valid.":"Invalid."),ok:s.ok||!1})}catch(e){_({message:`Validation failed due to a network error: ${e instanceof Error?e.message:String(e)}`,ok:!1})}finally{b(!1)}},w=async s=>{s.preventDefault(),u(null);try{let s=new FormData;Object.entries(h).forEach(([e,a])=>{null!=a&&("boolean"==typeof a?a&&s.append(e,"on"):s.append(e,String(a)))}),e&&s.append("original_name",e.name);let a=e&&e.name?`/api/sources/edit/${encodeURIComponent(e.name)}`:"/api/sources/add",t=await fetch(a,{method:"POST",body:s});if(t.ok)o();else{let e=await t.text();try{let s=JSON.parse(e);u(s.error||s.message||"Failed to save source")}catch{u("Failed to save source")}}}catch(e){u("Failed to save source")}},k=h.type,C=r[k]||"folder.svg";return(0,s.jsxs)("form",{onSubmit:w,children:[x&&(0,s.jsx)("div",{className:"alert alert-error mb-3",children:x}),g&&(0,s.jsx)("div",{className:`alert ${g.ok?"alert-info":"alert-error"} mb-3`,children:g.message}),(0,s.jsxs)("label",{className:"mt-0",children:["Name",(0,s.jsx)("input",{type:"text",name:"name",value:h.name,onChange:j,required:!0})]}),(0,s.jsxs)("label",{children:["Description",(0,s.jsx)("input",{type:"text",name:"description",value:h.description,onChange:j})]}),(0,s.jsxs)("label",{children:["Type",(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(n.default,{src:`/sources-logos/${C}`,alt:k,width:24,height:24,className:"w-6 h-6"}),(0,s.jsx)("select",{name:"type",value:h.type,onChange:j,required:!0,children:l.map(e=>(0,s.jsx)("option",{value:e,children:e},e))})]})]}),["file","csv","excel","sqlite"].includes(k)&&(0,s.jsxs)("label",{children:["csv"===k?"CSV file path":"excel"===k?"Excel file path":"sqlite"===k?"SQLite file path":"File path",(0,s.jsxs)("div",{className:"grid grid-cols-[1fr_auto] gap-2 items-end",children:[(0,s.jsx)("input",{type:"text",name:"csv"===k?"csv_path":"excel"===k?"excel_path":"sqlite"===k?"sqlite_file_path":"file_path",value:h["csv"===k?"csv_path":"excel"===k?"excel_path":"sqlite"===k?"sqlite_file_path":"file_path"]||"",onChange:j,className:"w-full"}),(0,s.jsx)("button",{type:"button",className:"btn secondary",onClick:v,children:"Browse…"})]})]}),"csv"===k&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"row",children:[(0,s.jsx)("div",{children:(0,s.jsxs)("label",{children:["Delimiter",(0,s.jsx)("input",{type:"text",name:"csv_delimiter",value:h.csv_delimiter||",",onChange:j})]})}),(0,s.jsx)("div",{children:(0,s.jsxs)("label",{children:["Encoding",(0,s.jsx)("input",{type:"text",name:"csv_encoding",value:h.csv_encoding||"utf-8",onChange:j})]})})]}),(0,s.jsxs)("label",{children:[(0,s.jsx)("input",{type:"checkbox",name:"csv_header",checked:h.csv_header||!1,onChange:j}),"Has header row"]})]}),"excel"===k&&(0,s.jsxs)("div",{className:"row",children:[(0,s.jsx)("div",{children:(0,s.jsxs)("label",{children:["Sheet name",(0,s.jsx)("input",{type:"text",name:"excel_sheet",value:h.excel_sheet||"",onChange:j})]})}),(0,s.jsx)("div",{children:(0,s.jsxs)("label",{children:["Header row index",(0,s.jsx)("input",{type:"number",name:"excel_header_row",value:h.excel_header_row||1,onChange:j})]})})]}),"folder"===k&&(0,s.jsxs)("label",{children:["Folder path",(0,s.jsxs)("div",{className:"grid grid-cols-[1fr_auto] gap-2 items-end",children:[(0,s.jsx)("input",{type:"text",name:"folder_path",value:h.folder_path||"",onChange:j}),(0,s.jsx)("button",{type:"button",className:"btn secondary",onClick:f,children:"Browse…"})]})]}),["postgresql","mysql","oracle","mssql"].includes(k)&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"row",children:[(0,s.jsx)("div",{children:(0,s.jsxs)("label",{children:["Host",(0,s.jsx)("input",{type:"text",name:"db_host",value:h.db_host||"",onChange:j})]})}),(0,s.jsx)("div",{children:(0,s.jsxs)("label",{children:["Port",(0,s.jsx)("input",{type:"number",name:"db_port",value:h.db_port||"",onChange:j})]})})]}),(0,s.jsxs)("div",{className:"row",children:[(0,s.jsx)("div",{children:(0,s.jsxs)("label",{children:["Username",(0,s.jsx)("input",{type:"text",name:"db_username",value:h.db_username||"",onChange:j})]})}),(0,s.jsx)("div",{children:(0,s.jsxs)("label",{children:["Password",(0,s.jsx)("input",{type:"password",name:"db_password",value:h.db_password||"",onChange:j})]})})]}),(0,s.jsxs)("label",{children:["Database",(0,s.jsx)("input",{type:"text",name:"db_database",value:h.db_database||"",onChange:j})]}),("postgresql"===k||"oracle"===k)&&(0,s.jsxs)("label",{children:["Schema",(0,s.jsx)("input",{type:"text",name:"db_schema",value:h.db_schema||"",onChange:j})]}),(0,s.jsxs)("label",{children:["Tables or SQL (default '*')",(0,s.jsx)("input",{type:"text",name:"db_table_or_query",value:h.db_table_or_query||"*",onChange:j})]})]}),"mongodb"===k&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"row",children:[(0,s.jsx)("div",{children:(0,s.jsxs)("label",{children:["Host",(0,s.jsx)("input",{type:"text",name:"mongo_host",value:h.mongo_host||"",onChange:j})]})}),(0,s.jsx)("div",{children:(0,s.jsxs)("label",{children:["Port",(0,s.jsx)("input",{type:"number",name:"mongo_port",value:h.mongo_port||"",onChange:j})]})})]}),(0,s.jsxs)("div",{className:"row",children:[(0,s.jsx)("div",{children:(0,s.jsxs)("label",{children:["Username",(0,s.jsx)("input",{type:"text",name:"mongo_username",value:h.mongo_username||"",onChange:j})]})}),(0,s.jsx)("div",{children:(0,s.jsxs)("label",{children:["Password",(0,s.jsx)("input",{type:"password",name:"mongo_password",value:h.mongo_password||"",onChange:j})]})})]}),(0,s.jsxs)("label",{children:["Database",(0,s.jsx)("input",{type:"text",name:"mongo_database",value:h.mongo_database||"",onChange:j})]})]}),"s3"===k&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("label",{children:["Bucket",(0,s.jsx)("input",{type:"text",name:"s3_bucket",value:h.s3_bucket||"",onChange:j})]}),(0,s.jsxs)("label",{children:["Prefix",(0,s.jsx)("input",{type:"text",name:"s3_prefix",value:h.s3_prefix||"",onChange:j})]}),(0,s.jsxs)("div",{className:"row",children:[(0,s.jsx)("div",{children:(0,s.jsxs)("label",{children:["Access key",(0,s.jsx)("input",{type:"text",name:"s3_access_key",value:h.s3_access_key||"",onChange:j})]})}),(0,s.jsx)("div",{children:(0,s.jsxs)("label",{children:["Secret key",(0,s.jsx)("input",{type:"password",name:"s3_secret_key",value:h.s3_secret_key||"",onChange:j})]})})]}),(0,s.jsxs)("label",{children:["Region",(0,s.jsx)("input",{type:"text",name:"s3_region",value:h.s3_region||"",onChange:j})]})]}),"gcs"===k&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("label",{children:["Bucket",(0,s.jsx)("input",{type:"text",name:"gcs_bucket",value:h.gcs_bucket||"",onChange:j})]}),(0,s.jsxs)("label",{children:["Prefix",(0,s.jsx)("input",{type:"text",name:"gcs_prefix",value:h.gcs_prefix||"",onChange:j})]}),(0,s.jsxs)("label",{children:["Credentials JSON path",(0,s.jsx)("input",{type:"text",name:"gcs_credentials",value:h.gcs_credentials||"",onChange:j})]})]}),"azure_blob"===k&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("label",{children:["Container",(0,s.jsx)("input",{type:"text",name:"az_container",value:h.az_container||"",onChange:j})]}),(0,s.jsxs)("label",{children:["Prefix",(0,s.jsx)("input",{type:"text",name:"az_prefix",value:h.az_prefix||"",onChange:j})]}),(0,s.jsxs)("label",{children:["Connection string",(0,s.jsx)("input",{type:"password",name:"az_connection",value:h.az_connection||"",onChange:j})]})]}),"hdfs"===k&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("label",{children:["Namenode host",(0,s.jsx)("input",{type:"text",name:"hdfs_namenode",value:h.hdfs_namenode||"",onChange:j})]}),(0,s.jsxs)("label",{children:["Port",(0,s.jsx)("input",{type:"number",name:"hdfs_port",value:h.hdfs_port||"",onChange:j})]}),(0,s.jsxs)("label",{children:["User",(0,s.jsx)("input",{type:"text",name:"hdfs_user",value:h.hdfs_user||"",onChange:j})]}),(0,s.jsxs)("label",{children:["Path",(0,s.jsx)("input",{type:"text",name:"hdfs_path",value:h.hdfs_path||"",onChange:j})]})]}),(0,s.jsxs)("div",{className:"row mb-3",children:[(0,s.jsx)("div",{children:(0,s.jsxs)("label",{children:["Visibility",(0,s.jsxs)("select",{name:"visibility",value:h.visibility,onChange:j,children:[(0,s.jsx)("option",{value:"private",children:"Private"}),(0,s.jsx)("option",{value:"internal",children:"Internal"}),(0,s.jsx)("option",{value:"public",children:"Public"})]})]})}),(0,s.jsxs)("div",{className:"flex flex-col gap-3 mt-3.5",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)("div",{className:`relative w-[46px] h-[26px] rounded-full cursor-pointer inline-block transition-colors duration-150 ${h.reference?"bg-primary-500":"bg-gray-200 dark:bg-gray-600"}`,onClick:()=>p(e=>({...e,reference:!e.reference})),children:(0,s.jsx)("div",{className:`absolute top-[3px] w-5 h-5 bg-white rounded-[35%] shadow-sm transition-all duration-150 ${h.reference?"left-[23px]":"left-[3px]"}`})}),(0,s.jsx)("span",{className:"text-gray-900 dark:text-gray-200",children:"Reference"})]}),(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)("div",{className:`relative w-[46px] h-[26px] rounded-full cursor-pointer inline-block transition-colors duration-150 ${h.sensitive?"bg-primary-500":"bg-gray-200 dark:bg-gray-600"}`,onClick:()=>p(e=>({...e,sensitive:!e.sensitive})),children:(0,s.jsx)("div",{className:`absolute top-[3px] w-5 h-5 bg-white rounded-[35%] shadow-sm transition-all duration-150 ${h.sensitive?"left-[23px]":"left-[3px]"}`})}),(0,s.jsx)("span",{className:"text-gray-900 dark:text-gray-200",children:"Sensitive"})]})]})]}),(0,s.jsxs)("div",{className:"actions",children:[(0,s.jsx)("button",{type:"button",className:"btn secondary",onClick:y,disabled:m,children:m?"Validating...":"Validate"}),(0,s.jsx)("button",{type:"submit",className:"btn",children:"Save"}),(0,s.jsx)("button",{type:"button",className:"btn secondary",onClick:()=>d.push("/"),children:"Cancel"})]})]})}e.s(["default",()=>c])},28592,e=>{"use strict";var s=e.i(43476),a=e.i(18566),t=e.i(71645),n=e.i(62319),l=e.i(56691),r=e.i(84198);function i(){let e=(0,a.useParams)(),i=(0,a.useRouter)(),c=e.id,[o,d]=(0,t.useState)(null),[h,p]=(0,t.useState)(!0);return((0,t.useEffect)(()=>{async function e(){try{let e=encodeURIComponent(c),s=await fetch(`/api/sources/${e}`);if(s.ok){let e=await s.json();d(e)}}catch{}finally{p(!1)}}c&&e()},[c]),h)?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.default,{}),(0,s.jsx)("div",{className:"container-form",children:(0,s.jsx)("div",{className:"card",children:"Loading..."})}),(0,s.jsx)(l.default,{})]}):o?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.default,{}),(0,s.jsxs)("div",{className:"container-form",children:[(0,s.jsx)("h1",{children:"Edit source"}),(0,s.jsx)("div",{className:"card",children:(0,s.jsx)(r.default,{source:o,preselectedType:"",onSuccess:()=>i.push("/")})})]}),(0,s.jsx)(l.default,{})]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.default,{}),(0,s.jsx)("div",{className:"container-form",children:(0,s.jsxs)("div",{className:"card",children:[(0,s.jsx)("h2",{children:"Source not found"}),(0,s.jsxs)("p",{children:["Source ID: ",c]}),(0,s.jsx)("p",{children:"Check the browser console for debug information."})]})}),(0,s.jsx)(l.default,{})]})}e.s(["default",()=>i])}]);