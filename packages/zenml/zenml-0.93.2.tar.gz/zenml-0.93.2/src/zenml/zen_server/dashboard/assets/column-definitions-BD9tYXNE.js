import{j as t}from"./@radix-Da0HZyg8.js";import{P as g}from"./Pagination-CbsJYd8L.js";import{ah as x,e as m,aa as j,B as y,a9 as v,bn as S,r as u,a6 as p,bg as D,ai as b,al as N,am as C}from"./index-5CE1yoTL.js";import{b as h}from"./@tanstack-BRZ8pkCt.js";import{c as P}from"./helper-BkxAcFl_.js";import{S as w}from"./SearchField-iVWx0Oy7.js";import{B as F}from"./button-group-basic-Bk-90YSv.js";import{f as R,L as d}from"./@react-router-BEwS6i40.js";import{z as r}from"./@zod-yP6IINRw.js";import{D as T}from"./deployment-status-tag-DLuEOChP.js";import{P as k}from"./pipeline-link-CCg7j5YZ.js";const{ContextProvider:J,useContext:c}=P();function K({params:e,columns:s}){const{rowSelection:a,setRowSelection:n}=c(),o=h({...x.list(e),throwOnError:!0});if(o.isPending)return t.jsxs("div",{className:"flex flex-col items-center gap-5",children:[t.jsx("div",{className:"w-full",children:t.jsx(m,{className:"h-[500px] w-full"})}),t.jsx(m,{className:"h-[36px] w-[300px]"})]});if(o.isError)return t.jsx("p",{children:"Error fetching deployments"});const i=o.data;return t.jsxs("div",{className:"flex flex-col items-center gap-5",children:[t.jsx("div",{className:"w-full",children:t.jsx(j,{columns:s,data:i.items,rowSelection:a,onRowSelectionChange:n,getRowId:f=>f.id})}),i.total_pages>1&&t.jsx(g,{searchParams:e,paginate:i})]})}function B(){const{selectedRowCount:e}=c();async function s(){}return t.jsx(F,{itemName:"Pipeline Snapshot",selectedItemCount:e,onDeleteSelected:s})}function M({params:e}){const{refetch:s}=h({...x.list(e),throwOnError:!0}),{selectedRowCount:a}=c();return t.jsxs("div",{className:"flex items-center justify-between",children:[a?t.jsx(B,{}):t.jsx(w,{searchParams:e}),t.jsxs(y,{intent:"primary",emphasis:"subtle",size:"md",onClick:()=>s(),children:[t.jsx(v,{className:"h-5 w-5 fill-theme-text-brand"}),"Refresh"]})]})}const l=1,E=r.object({page:r.coerce.number().min(l).optional().default(l).catch(l),name:r.string().optional(),operator:r.enum(["and","or"]).optional()});function V(){const[e]=R(),{page:s,name:a,operator:n}=E.parse({page:e.get("page")||void 0,name:e.get("name")||void 0});return{page:s,name:a,logical_operator:n}}function W(){return{id:"name",header:"Deployment",accessorFn:e=>e.name,cell:({row:e})=>{const s=e.original.name,a=e.original.id;return t.jsxs("div",{className:"group/copybutton flex min-w-[10rem] items-center gap-2",children:[t.jsx(S,{className:"h-5 w-5 shrink-0 fill-primary-400"}),t.jsxs("div",{children:[t.jsxs("div",{className:"flex items-center gap-1",children:[t.jsx(d,{to:u.projects.deployments.detail.overview(a),className:"grid grid-cols-1 items-center gap-1",children:t.jsx("span",{className:"truncate text-text-md font-semibold text-theme-text-primary",children:s??"Unnamed"})}),t.jsx(p,{copyText:s??""})]}),t.jsxs("div",{className:"flex items-center gap-1",children:[t.jsx(d,{to:u.projects.deployments.detail.overview(a),className:"flex items-center gap-1",children:t.jsx("p",{className:"text-text-xs text-theme-text-secondary",children:D(a)})}),t.jsx(p,{copyText:a})]})]})]})}}}function X(){return{id:"status",header:"Status",accessorFn:e=>e.body?.status,cell:({row:e})=>{const s=e.original.body?.status;return s?t.jsx(T,{size:"sm",status:s}):t.jsx("div",{children:"No status"})}}}function Y(){return{id:"pipeline",header:"Pipeline",accessorFn:e=>e.resources?.pipeline?.name,cell:({row:e})=>{const s=e.original.resources?.pipeline;return s?t.jsx(k,{pipelineId:s.id,pipelineName:s.name}):null}}}function Z(){return{id:"snapshot",header:"Snapshot",accessorFn:e=>e.resources?.snapshot?.name,cell:({row:e})=>{const s=e.original.resources?.snapshot,a=s?.name,n=s?.id;return!a||!n?null:t.jsx(b,{size:"sm",snapshotId:n,snapshotName:a})}}}function $(){return{id:"author",header:"Author",accessorFn:e=>e.resources?.user?.name,cell:({row:e})=>{const s=e.original.resources?.user;return s?t.jsx(N,{username:s.name,isServiceAccount:!!s.body?.is_service_account,avatarUrl:s.body?.avatar_url??void 0}):null}}}function ee(){return{id:"created",header:"Created at",accessorFn:e=>({date:e.body?.created}),cell:({getValue:e})=>{const{date:s}=e();return t.jsx(C,{dateString:s})}}}export{M as D,K as P,X as a,Z as b,W as c,$ as d,ee as e,J as f,Y as g,V as u};
