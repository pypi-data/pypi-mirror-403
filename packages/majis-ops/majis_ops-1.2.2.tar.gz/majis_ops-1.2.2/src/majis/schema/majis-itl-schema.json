{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "majis-itl-schema-v1.json",
  "title": "JUICE MAJIS ITL Schema v1",
  "type": "object",
  "properties": {
    "timeline": {
      "items": {
        "properties": {
          "parameters": {
            "type": "object",
            "required": [
              "scenario_id",
              "cu_trep_ms",
              "nb_cu_frames_tot",
              "spatial_binning",
              "ppe",
              "start_row_vi",
              "mirror_flag",
              "start_angle",
              "stop_angle",
              "scanner_step_per_frame",
              "start_scan_speed",
              "stop_scan_speed"
            ],
            "properties": {
            "mission_phase": {
              "type": "string",
              "description": "JUICE mission phase name (TODO: ask SOC to provide allowed/standard names)"
            },
            "scenario_id": {
              "type": "string",
              "description": "New: scenario_id or mtp, eg: 'S008_01' or 'ORB17' (TODO: ask SOC if that will be standardised)"
            },
            "mirror_flag": {
              "type": "string",
              "enum": ["ENABLE", "DISABLE"],
              "description": "If mirror flag='DISABLE' (i.e. no scan movement) then please indicate the requested fixed mirror position in start_angle parameter (0° corresponds to boresight). All other scan parameters shall be 0."
            },
            "start_angle": {
              "type": "number",
              "description": "Start angle in degrees"
            },
            "start_scan_speed": {
              "type": "number",
              "description": ""
            },
            "stop_scan_speed": {
              "type": "number",
              "description": ""
            },
            "stop_angle": {
              "type": "number",
              "description": "Stop angle in degrees"
            },
            "scanner_step_per_frame": {
              "type": "integer",
                "enum": [-3, 0, 3],
                "description": "Scanner step per frame (synchronous flag)."
            },
            "scanner_timetot": {
              "type": "number",
                "description": "Scanner total time"
            },
            "first_cu_frame_start_rel_ca": {
              "type": "string",
              "description": "First CU_frame start wrt C/A. (-/+)hh:mm:ss,000. Scientific need wrt C/A. Parameter only required in case of continuous acquisition (nb_cu_frames_tot=65535). Note: use the decimal separator (either ',' or '.') defined in your Excel for the milliseconds."
            },
            "last_cu_frame_stop_rel_ca": {
              "type": "string",
              "description": "First CU_frame stop wrt C/A. (-/+)hh:mm:ss,000. Scientific need wrt C/A. Parameter only required in case of continuous acquisition (nb_cu_frames_tot=65535). Note: use the decimal separator (either ',' or '.') defined in your Excel for the milliseconds."
            },
            "first_cu_frame_start_utc": {
              "type": "string",
              "description": "First CU_frame start UTC time."
            },
            "last_cu_frame_stop_utc": {
              "type": "string",
              "description": "First CU_frame start UTC stop."
            },
            "cu_trep_ms": {
              "type": "number",
              "description": ""
            },
            "spatial_binning": {
              "type": "integer",
              "enum": [1, 2, 4],
              "description": "Spatial binning for the CU frame: 1, 2 or 4."
            },
            "obs_duration": {
              "type": "number",
              "description": "Observation duration in seconds."
            },
            "nb_cu_frames_tot": {
              "type": "integer",
              "minimum": 1,
              "description": "The number of Frame is automatically re-computed by 'timeline2config' when the Scanner is used in asynchronous mode (Mirror Flag=ENABLE and Scanner step per frame=0). Here 'nb_cu_frames_tot' is used to compute the data volume in the 'DV (Mbits)' column. Put '65535' for continuous acquisition mode."
            },
            "nb_cu_frames_totcomp": {
              "type": "integer",
              "minimum": 1,
              "description": "Re-computed value as 'timeline2config' will do in case of Scanner used in asynchronous mode. Shall be equal to 'nb_cu_frames_tot' for checking purpose."
            },
            "ppe": {
              "type": "integer",
              "minimum": 1,
              "description": "Pixels Per Element"
            },
            "spectral_mapping": {
              "type": "string",
              "description": " the spectral mask is a part of a database that contains spectral masks associated to each type of MAJIS observations, comment récupère-t-on ce fichier ? "
            },
            "data_volume_mbits": {
              "type": "number",
              "minimum": 0,
              "description": "Data volume in Mbits (Mbits=1024*1024bits)"
            },
            "data_rate_bit_per_sec": {
              "type": "number",
              "minimum": 0,
              "description": "Data rate in bits per second"
            },
            "nb_binned_spectels": {
              "type": "integer",
              "minimum": 1,
              "description": "Number of binned spectral elements"
            },
            "nb_binned_spectels_after_comp": {
              "type": "integer",
              "minimum": 1,
              "description": "Equivalent compression factor for all the bands"
            },
            "browse_parameters": {
              "type": "string",
              "description": "Browse parameters file name. This file is a part of a database that contains browse parameters associated to each type of MAJIS observations, comment récupère-t-on ce fichier."
            },
            "image_mode": {
              "type": "string",
              "enum": ["Nominal", "No process"],
              "description": "Nominal or No process"
            },
            "dark_strategy": {
              "type": "integer",
              "enum": [0, 1, 3],
              "description": "Dark Strategy; 0:No Dark, 1: Dark Before, 3: Dark Before + After"
            },
            "dark_subtraction": {
              "type": "string",
              "enum": ["Subtracted", "Not Subtracted"],
              "description": "Dark Subtraction; Subtracted, Not Subtracted"
            },
            "cds_flag": {
              "type": "string",
              "enum": ["ReadReset"],
              "description": "CDS flag; ReadReset"
            },
            "vi_flag": {
              "type": "string",
              "enum": ["ON", "OFF"],
              "description": "VI flag; ON,OFF"
            },
            "ir_flag": {
              "type": "string",
              "enum": ["ON", "OFF"],
              "description": "IR flag; ON,OFF"
            },
            "ir_readout": {
              "type": "string",
              "enum": ["1MHz", "100kHz"],
              "description": "IR Readout; 1MHz,100kHz"
            },
            "start_row_vi": {
              "type": "integer",
              "default": 100,
              "description": "Start Row VI; Nominal values (in physical pixels): 100 for VI from calibration data"
            },
            "start_row_ir": {
              "type": "integer",
              "default": 87,
              "description": "Start Row IR; Nominal values (in physical pixels): 87 for IR from calibration data"
            },
            "vi_despiking_m": {
              "type": "integer",
              "minimum": 1,
              "maximum": 12,
              "description": "Despiking strategy VI (M),integer between 1 and 12"
            },
            "vi_despiking_k": {
              "type": "string",
              "enum": ["Lowest", "Low"],
              "description": "VI Despiking K; Despiking strategy VI (K) with K=Lowest or Low"
            },
            "vi_tint": {
              "type": "number",
              "minimum": 0,
              "description": "VI Tint; VI integration time (ms)"
            },
            "vi_gain": {
              "type": "integer",
              "minimum": 8,
              "maximum": 13,
              "default": 10,
              "description": "VI Gain; VI preamplification Gain, Default value 10, Value between 8 and 13"
            },
            "vi_offset": {
              "type": "integer",
              "minimum": 0,
              "maximum": 3,
              "default": 1,
              "description": "VI Offset; VI detector reference voltage offset, Default value 1, value between 0 and 3"
            },
            "vi_npe": {
              "type": "integer",
              "minimum": 1,
              "maximum": 16,
              "description": "VI NPE; VI PE Frame binning, value between 1 and 16"
            },
            "ir_despiking_n": {
              "type": "integer",
              "minimum": 1,
              "maximum": 16,
              "description": "IR Despiking N; Despiking strategy VI (N sub), integer between 1 and 16"
            },
            "ir_despiking_m": {
              "type": "integer",
              "minimum": 1,
              "maximum": 12,
              "description": "IR Despiking M; Despiking strategy VI (M),integer between 1 and 12"
            },
            "ir_despiking_k": {
              "type": "string",
              "enum": ["Lowest", "Low"],
              "description": "IR Despiking K; Despiking strategy VI (K) with K=Lowest or Low"
            },
            "ir_tint": {
              "type": "number",
              "minimum": 0,
              "description": "IR Tint; VI integration time (ms)"
            },
            "ir_gain": {
              "type": "integer",
              "minimum": 8,
              "maximum": 13,
              "default": 10,
              "description": "IR Gain; VI preamplification Gain, Default value 10, Value between 8 and 13"
            },
            "ir_offset": {
              "type": "integer",
              "minimum": 0,
              "maximum": 3,
              "default": 1,
              "description": "IR Offset; VI detector reference voltage offset, Default value 1, value between 0 and 3"
            },
            "ir_npe": {
              "type": "integer",
              "minimum": 1,
              "maximum": 16,
              "description": "IR NPE; VI PE Frame binning, value between 1 and 16"
              }
            }
          }
        }
      }
    }
  }
}
