<!-- UMAP Floating Window -->
<!-- This is referred to as the "semantic map" in the UI -->

<div id="umapFloatingWindow">
  <!-- Titlebar -->
  <div id="umapTitlebar">
    <span id="semanticMapTitle">Semantic Map</span>
    <div style="display: flex; align-items: center; gap: 8px">
      <!-- Resizing icons -->
      <button id="umapResizeFullscreen" title="Fullscreen" class="icon-btn">
        <svg width="24" height="24" viewBox="0 0 24 24">
          <!-- Central point -->
          <circle cx="12" cy="12" r="1.5" fill="#FFD600" />
          <!-- Bright square outline -->
          <rect
            x="4"
            y="4"
            width="16"
            height="16"
            rx="4"
            fill="none"
            stroke="#D0D0D0"
            stroke-width="1"
          />
          <!-- Arrows to corners -->
          <g stroke="#FFD600" stroke-width="2.5" fill="#FFD600">
            <!-- Top-left arrow -->
            <line x1="12" y1="12" x2="4" y2="4" />
            <polygon points="4,4 7,4 4,7" />
            <!-- Top-right arrow -->
            <line x1="12" y1="12" x2="20" y2="4" />
            <polygon points="20,4 17,4 20,7" />
            <!-- Bottom-left arrow -->
            <line x1="12" y1="12" x2="4" y2="20" />
            <polygon points="4,20 7,20 4,17" />
            <!-- Bottom-right arrow -->
            <line x1="12" y1="12" x2="20" y2="20" />
            <polygon points="20,20 17,20 20,17" />
          </g>
        </svg>
      </button>

      <button id="umapResizeBig" title="Large" class="icon-btn">
        <svg width="28" height="28" viewBox="0 0 28 28">
          <rect
            x="4"
            y="4"
            width="20"
            height="20"
            rx="4"
            fill="#fff"
            opacity="0.8"
          />
        </svg>
      </button>
      <button id="umapResizeMedium" title="Medium" class="icon-btn">
        <svg width="20" height="20" viewBox="0 0 20 20">
          <rect
            x="3"
            y="3"
            width="14"
            height="14"
            rx="3"
            fill="#fff"
            opacity="0.8"
          />
        </svg>
      </button>
      <button id="umapResizeSmall" title="Small" class="icon-btn">
        <svg width="14" height="14" viewBox="0 0 14 14">
          <rect
            x="2"
            y="2"
            width="10"
            height="10"
            rx="2"
            fill="#fff"
            opacity="0.8"
          />
        </svg>
      </button>
      <button id="umapResizeShaded" title="Shaded" class="icon-btn">
        <svg width="18" height="10" viewBox="0 0 18 10">
          <rect
            x="2"
            y="2"
            width="14"
            height="6"
            rx="2"
            fill="#fff"
            opacity="0.8"
          />
        </svg>
      </button>
      <button
        id="umapCloseBtn"
        style="
          background: none;
          border: none;
          color: #fff;
          font-size: 1.5em;
          cursor: pointer;
          margin-left: 8px;
        "
        title="Close"
      >
        &times;
      </button>
    </div>
  </div>

  <!-- All other content hidden until plot is ready -->
  <div id="umapContent" style="display: none">
    <!-- Spinner (always visible during loading) -->
    <div
      id="umapSpinner"
      style="
        display: none;
        position: absolute;
        left: 50%;
        top: 50%;
        transform: translate(-50%, -50%);
        z-index: 10000;
        pointer-events: none;
      "
    >
      <div class="umap-spinner"></div>
    </div>

    <!-- Plotly Plot -->
    <div id="umapPlot"></div>

    <div id="umapControls">
      <!-- Controls Row: EPS spinner and Color Mode -->
      <div
        style="
          display: flex;
          flex-direction: row;
          gap: 24px;
          justify-content: center;
          align-items: flex-start;
          margin-top: 4px;
        "
      >
        <!-- EPS Spinner Container -->
        <div id="umapEpsContainer" style="display: none; padding: 0px">
          <label for="umapEpsSpinner">Cluster Strength</label>
          <input
            type="number"
            id="umapEpsSpinner"
            min="0.01"
            max="1.0"
            step="0.01"
            value="0.1"
            style="width: 60px"
          />
          
          <!-- Click Behavior Radio Buttons -->
          <div id="umapClickBehaviorContainer" style="margin-top: 12px; display: flex; flex-direction: column; gap: 4px;">
            <label style="display: flex; align-items: center; gap: 6px; font-size: 0.9em;">
              <input
                type="radio"
                name="umapClickBehavior"
                id="umapClickSelectsClusterRadio"
                value="cluster"
                checked
              />
              Click selects cluster
            </label>
            <label style="display: flex; align-items: center; gap: 6px; font-size: 0.9em;">
              <input
                type="radio"
                name="umapClickBehavior"
                id="umapClickSelectsImageRadio"
                value="image"
              />
              Click selects image
            </label>
          </div>
        </div>

        <!-- Colorization Mode Controls (two columns) -->
        <div
          id="umapColorModeContainer"
          style="
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 8px;
          "
        >
          <label style="display: flex; align-items: center; gap: 8px">
            <input
              type="checkbox"
              id="umapShowLandmarks"
              style="margin-right: 6px"
            />
            Show landmarks
          </label>
          <label id="umapExitFullscreenLabel" style="display: flex; align-items: center; gap: 8px">
            <input
              type="checkbox"
              id="umapExitFullscreenOnSelection"
              checked
              style="margin-right: 6px"
            />
            Exit fullscreen on selection
          </label>
          <label style="display: flex; align-items: center; gap: 8px">
            <input
              type="checkbox"
              id="umapShowHoverThumbnails"
              checked
              style="margin-right: 6px"
            />
            Show hover thumbnails
          </label>
          <label style="display: flex; align-items: center; gap: 8px">
            <input
              type="checkbox"
              id="umapHighlightSelection"
              style="margin-right: 6px"
            />
            <span>Highlight selection (<a id="umapClearSelectionLink" href="#" style="color:#4a9eff;text-decoration:none;">clear</a>)</span>
          </label>
        </div>
      </div>
    </div>
  </div>
</div>
