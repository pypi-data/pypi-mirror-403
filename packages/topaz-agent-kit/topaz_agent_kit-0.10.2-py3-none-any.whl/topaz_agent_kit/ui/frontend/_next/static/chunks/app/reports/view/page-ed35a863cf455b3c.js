(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[585],{60744:function(e,r,t){Promise.resolve().then(t.bind(t,42386))},42386:function(e,r,t){"use strict";t.d(r,{ReportViewClient:function(){return I}});var n=t(57437),o=t(2265),s=t(16463),a=t(23782),l=t(67601),c=t(99299),i=t(61874),d=t(26178),u=t(43237),h=t(42926),E=t(69843),p=t(38891),g=t(75858),N=t(12914),v=t(34140),f=t(28768),m=t(65623),L=t(73377),O=t(69419),b=t(27299),R=t(20357);function I(){var e;let r=(0,s.useSearchParams)(),t=(0,s.useRouter)(),I=r.get("path"),[x,D]=(0,o.useState)(""),[T,w]=(0,o.useState)(!0),[k,A]=(0,o.useState)(null),C=(null===(e=R.env.NEXT_PUBLIC_TOPAZ_API_BASE)||void 0===e?void 0:e.replace(/\/$/,""))||"";(0,o.useEffect)(()=>{if(!I){A("No report path provided"),w(!1);return}(async()=>{try{w(!0),A(null);let e="".concat(C,"/api/reports/view?path=").concat(encodeURIComponent(I));O.k.debug("Fetching report from: {}",e);let r=await fetch(e);if(!r.ok){let e=await r.text();throw Error("Failed to load report: ".concat(r.status," ").concat(e))}let t=await r.text(),n=(0,b.X)(t);D(n)}catch(e){O.k.error("Error loading report: {}",e),A(e instanceof Error?e.message:"Failed to load report")}finally{w(!1)}})()},[I,C]);let y=/<(span[^>]*(class|style)=["'][^"']*["'][^>]*>|details|summary)/.test(x);return T?(0,n.jsx)("div",{className:"min-h-screen bg-white dark:bg-zinc-950 flex items-center justify-center",children:(0,n.jsx)("div",{className:"text-zinc-600 dark:text-zinc-400",children:"Loading report..."})}):k?(0,n.jsx)("div",{className:"min-h-screen bg-white dark:bg-zinc-950 flex items-center justify-center",children:(0,n.jsxs)("div",{className:"text-center",children:[(0,n.jsx)("div",{className:"text-red-600 dark:text-red-400 mb-4",children:k}),(0,n.jsx)("button",{onClick:()=>t.back(),className:"px-4 py-2 bg-zinc-200 dark:bg-zinc-800 rounded-md hover:bg-zinc-300 dark:hover:bg-zinc-700",children:"Go Back"})]})}):(0,n.jsx)("div",{className:"min-h-screen bg-white dark:bg-zinc-950",children:(0,n.jsxs)("div",{className:"max-w-6xl mx-auto px-4 py-8",children:[(0,n.jsx)("div",{className:"mb-4",children:(0,n.jsx)("button",{onClick:()=>t.back(),className:"text-sm text-zinc-600 dark:text-zinc-400 hover:text-zinc-900 dark:hover:text-zinc-100",children:"← Back"})}),(0,n.jsx)("div",{className:"overflow-auto rounded-md p-6 bg-white dark:bg-zinc-950 border border-zinc-200 dark:border-zinc-800 prose prose-lg max-w-none dark:prose-invert report-content",children:(0,n.jsx)(a.UG,{remarkPlugins:[l.Z],rehypePlugins:[...y?[c.Z]:[],[i.Z,{languages:{javascript:d.Z,typescript:u.Z,json:h.Z,python:E.Z,bash:p.Z,shell:g.Z,yaml:N.Z,markdown:v.Z,xml:f.Z,html:f.Z,css:m.Z,sql:L.Z},ignoreMissing:!0}]],components:{p:e=>{let{children:r}=e;return(0,n.jsx)("p",{className:"whitespace-pre-line leading-normal my-1",children:r})},pre:e=>{let{children:r,...t}=e;return(0,n.jsx)("pre",{...t,className:"overflow-x-visible whitespace-pre-wrap break-words",style:{wordBreak:"break-word",whiteSpace:"pre-wrap"},children:r})},code:e=>{let{children:r,className:t,...o}=e,s=!(null==t?void 0:t.includes("language-"));return(0,n.jsx)("code",{...o,className:s?t:"".concat(t," whitespace-pre-wrap break-words"),style:s?void 0:{wordBreak:"break-word",whiteSpace:"pre-wrap",display:"block",overflowX:"visible"},children:r})},a:e=>{let{href:r,children:t,...o}=e,s=r&&r.startsWith("/api/")&&C?"".concat(C).concat(r):r;return(0,n.jsx)("a",{href:s,...o,className:"text-[hsl(var(--accent))] hover:underline",children:t})}},children:x})})]})})}},69419:function(e,r,t){"use strict";t.d(r,{k:function(){return l}});var n,o,s=t(20357);(n=o||(o={}))[n.ERROR=0]="ERROR",n[n.WARN=1]="WARN",n[n.INFO=2]="INFO",n[n.DEBUG=3]="DEBUG",n[n.TRACE=4]="TRACE";class a{shouldLog(e){return this.isEnabled&&e<=this.level}error(e){for(var r=arguments.length,t=Array(r>1?r-1:0),n=1;n<r;n++)t[n-1]=arguments[n];this.shouldLog(0)&&console.error("\uD83D\uDD34 [ERROR] ".concat(e),...t)}warn(e){for(var r=arguments.length,t=Array(r>1?r-1:0),n=1;n<r;n++)t[n-1]=arguments[n];this.shouldLog(1)&&console.warn("\uD83D\uDFE1 [WARN] ".concat(e),...t)}info(e){for(var r=arguments.length,t=Array(r>1?r-1:0),n=1;n<r;n++)t[n-1]=arguments[n];this.shouldLog(2)&&console.log("\uD83D\uDD35 [INFO] ".concat(e),...t)}debug(e){for(var r=arguments.length,t=Array(r>1?r-1:0),n=1;n<r;n++)t[n-1]=arguments[n];this.shouldLog(3)&&console.log("\uD83D\uDFE2 [DEBUG] ".concat(e),...t)}trace(e){for(var r=arguments.length,t=Array(r>1?r-1:0),n=1;n<r;n++)t[n-1]=arguments[n];this.shouldLog(4)&&console.log("⚪ [TRACE] ".concat(e),...t)}api(e){for(var r=arguments.length,t=Array(r>1?r-1:0),n=1;n<r;n++)t[n-1]=arguments[n];this.shouldLog(3)&&console.log("\uD83C\uDF10 [API] ".concat(e),...t)}event(e){for(var r=arguments.length,t=Array(r>1?r-1:0),n=1;n<r;n++)t[n-1]=arguments[n];this.shouldLog(2)&&console.log("\uD83D\uDCE1 [EVENT] ".concat(e),...t)}state(e){for(var r=arguments.length,t=Array(r>1?r-1:0),n=1;n<r;n++)t[n-1]=arguments[n];this.shouldLog(2)&&console.log("\uD83D\uDCCA [STATE] ".concat(e),...t)}user(e){for(var r=arguments.length,t=Array(r>1?r-1:0),n=1;n<r;n++)t[n-1]=arguments[n];this.shouldLog(2)&&console.log("\uD83D\uDC64 [USER] ".concat(e),...t)}assistant(e){for(var r=arguments.length,t=Array(r>1?r-1:0),n=1;n<r;n++)t[n-1]=arguments[n];this.shouldLog(2)&&console.log("\uD83E\uDD16 [ASSISTANT] ".concat(e),...t)}constructor(){var e;let r=null===(e=s.env.NEXT_PUBLIC_LOG_LEVEL)||void 0===e?void 0:e.toUpperCase();this.level=r&&o[r]||2,this.isEnabled="true"===s.env.NEXT_PUBLIC_DEBUG||void 0!==s.env.NEXT_PUBLIC_LOG_LEVEL,console.log("\uD83D\uDD27 Logger initialized:",{level:this.level,isEnabled:this.isEnabled,nodeEnv:"production",logLevel:s.env.NEXT_PUBLIC_LOG_LEVEL,debug:s.env.NEXT_PUBLIC_DEBUG})}}let l=new a},27299:function(e,r,t){"use strict";function n(e){if(!e||"string"!=typeof e)return e;let r=e.trim();for(let e of(r=r.replace(/\s+/g," "),["UNION ALL","LEFT OUTER JOIN","RIGHT OUTER JOIN","FULL OUTER JOIN","INNER JOIN","GROUP BY","ORDER BY","SELECT","FROM","WHERE","HAVING","LIMIT","OFFSET","UNION","INTERSECT","EXCEPT","LEFT JOIN","RIGHT JOIN","FULL JOIN","CROSS JOIN","JOIN","ON"])){let t=RegExp("\\b".concat(e.replace(/\s+/g,"\\s+"),"\\b"),"gi");r=r.replace(t,e=>"\n".concat(e))}let t=(r=r.replace(/^\n+/,"").replace(/\n{3,}/g,"\n\n")).split("\n"),n=[],o=0;for(let e=0;e<t.length;e++){let r=t[e].trim();if(!r){n.push("");continue}/^(FROM|WHERE|GROUP BY|ORDER BY|HAVING|LIMIT|OFFSET|UNION|UNION ALL|INTERSECT|EXCEPT)\b/i.test(r)&&(o=0);let s=" ".repeat(2*o)+r;n.push(s),/^(SELECT|FROM)\b/i.test(r)?o=1:/^(JOIN|ON)\b/i.test(r)?o=1:/^(WHERE|GROUP BY|ORDER BY|HAVING|LIMIT|OFFSET|UNION|UNION ALL|INTERSECT|EXCEPT)\b/i.test(r)&&(o=0)}return(r=n.join("\n").trim()).split("\n").map(e=>e.trimEnd()).join("\n")}function o(e){return e&&"string"==typeof e?e.replace(/```sql\n?([\s\S]*?)```/gi,(e,r)=>{let t=n(r.trim());return"```sql\n".concat(t,"\n```")}):e}t.d(r,{X:function(){return o},_:function(){return n}})}},function(e){e.O(0,[912,971,23,744],function(){return e(e.s=60744)}),_N_E=e.O()}]);