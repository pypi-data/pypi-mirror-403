{
  "timestamp": "2026-01-24T22:07:25.918650",
  "system": {
    "platform": "Darwin 25.2.0",
    "python_version": "3.12.9",
    "torch_version": "2.9.1",
    "device_type": "mps",
    "device_name": "Apple Silicon",
    "device_count": 1,
    "cuda_version": null,
    "cudnn_version": null,
    "cudnn_benchmark": false,
    "memory_gb": null,
    "numba_available": true,
    "accelerate_available": true
  },
  "config": {
    "d_model": 128,
    "n_layers": 4,
    "n_heads": 4,
    "batch_size": 32,
    "vocab_size": 138,
    "complexity": "medium"
  },
  "grammar": {
    "numba": {
      "name": "numba",
      "count": 10,
      "total_ms": 2.6127500168513507,
      "mean_ms": 0.26127500168513507,
      "std_ms": 0.018915035782082375,
      "min_ms": 0.23895800404716283,
      "max_ms": 0.3031249943887815
    },
    "pytorch": {
      "name": "pytorch",
      "count": 10,
      "total_ms": 30.410293038585223,
      "mean_ms": 3.0410293038585223,
      "std_ms": 0.10718362412643583,
      "min_ms": 2.9284170013852417,
      "max_ms": 3.2412500004284084
    }
  },
  "data_loading": {
    "stats": {
      "collation_with_grammar": {
        "name": "collation_with_grammar",
        "count": 20,
        "total_ms": 85.84470995992888,
        "mean_ms": 4.292235497996444,
        "std_ms": 0.07016122132194463,
        "min_ms": 4.16308399871923,
        "max_ms": 4.377334000309929
      },
      "collation_no_grammar": {
        "name": "collation_no_grammar",
        "count": 20,
        "total_ms": 80.11445800366346,
        "mean_ms": 4.005722900183173,
        "std_ms": 0.05466865510787171,
        "min_ms": 3.918040994904004,
        "max_ms": 4.092959003173746
      },
      "tokenization": {
        "name": "tokenization",
        "count": 20,
        "total_ms": 4.889086980256252,
        "mean_ms": 0.2444543490128126,
        "std_ms": 0.023854172268533345,
        "min_ms": 0.22562500089406967,
        "max_ms": 0.3276659990660846
      }
    },
    "grammar_overhead_ms": 0.286512597813271,
    "grammar_overhead_pct": 6.675136952457783
  },
  "training_step": {
    "stats": {
      "backward": {
        "name": "backward",
        "count": 30,
        "total_ms": 213.45137598109432,
        "mean_ms": 7.1150458660364775,
        "std_ms": 1.0486695825963708,
        "min_ms": 6.589541997527704,
        "max_ms": 12.507792009273544
      },
      "optimizer_step": {
        "name": "optimizer_step",
        "count": 30,
        "total_ms": 105.932209015009,
        "mean_ms": 3.5310736338336333,
        "std_ms": 0.1169326899875059,
        "min_ms": 3.3832909975899383,
        "max_ms": 3.9279170014197007
      },
      "clip_grad": {
        "name": "clip_grad",
        "count": 30,
        "total_ms": 90.80312693549786,
        "mean_ms": 3.0267708978499286,
        "std_ms": 5.469133012117823,
        "min_ms": 1.8396659870631993,
        "max_ms": 31.979833001969382
      },
      "forward": {
        "name": "forward",
        "count": 30,
        "total_ms": 84.1855809558183,
        "mean_ms": 2.80618603186061,
        "std_ms": 0.5402280846704136,
        "min_ms": 2.476499998010695,
        "max_ms": 5.497083009686321
      },
      "device_transfer": {
        "name": "device_transfer",
        "count": 30,
        "total_ms": 78.38033397274558,
        "mean_ms": 2.6126777990915193,
        "std_ms": 0.59301096360239,
        "min_ms": 1.9481249910313636,
        "max_ms": 5.6760420120554045
      },
      "zero_grad": {
        "name": "zero_grad",
        "count": 30,
        "total_ms": 1.118879037676379,
        "mean_ms": 0.03729596792254597,
        "std_ms": 0.0064016683496489505,
        "min_ms": 0.03058298898395151,
        "max_ms": 0.06049999501556158
      }
    },
    "total_step_ms": 19.19043333279357,
    "samples_per_sec": 1667.4975205128278
  },
  "forward_breakdown": {
    "stats": {
      "backbone": {
        "name": "backbone",
        "count": 10,
        "total_ms": 21.700876008253545,
        "mean_ms": 2.1700876008253545,
        "std_ms": 1.9123912168974941,
        "min_ms": 1.510500005679205,
        "max_ms": 7.611042005009949
      },
      "embeddings": {
        "name": "embeddings",
        "count": 10,
        "total_ms": 12.129416980315,
        "mean_ms": 1.2129416980315,
        "std_ms": 0.0971600029093995,
        "min_ms": 1.1515840014908463,
        "max_ms": 1.4617079868912697
      },
      "discrete_head": {
        "name": "discrete_head",
        "count": 10,
        "total_ms": 2.3814580199541524,
        "mean_ms": 0.23814580199541524,
        "std_ms": 0.0149755456250425,
        "min_ms": 0.21912500960752368,
        "max_ms": 0.26966699806507677
      },
      "grammar_masking": {
        "name": "grammar_masking",
        "count": 10,
        "total_ms": 2.190583007177338,
        "mean_ms": 0.2190583007177338,
        "std_ms": 0.02324974710413838,
        "min_ms": 0.19662499835249037,
        "max_ms": 0.27879199478775263
      }
    }
  }
}