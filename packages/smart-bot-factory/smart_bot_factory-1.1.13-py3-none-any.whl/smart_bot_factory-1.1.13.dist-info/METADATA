Metadata-Version: 2.4
Name: smart-bot-factory
Version: 1.1.13
Summary: –ë–∏–±–ª–∏–æ—Ç–µ–∫–∞ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —É–º–Ω—ã—Ö —á–∞—Ç-–±–æ—Ç–æ–≤
Author-email: Kopatych <eserov73@gmail.com>
License: MIT
License-File: LICENSE
Keywords: chatbot,cli,openai,supabase,telegram
Classifier: Development Status :: 4 - Beta
Classifier: Environment :: Console
Classifier: Framework :: AsyncIO
Classifier: Intended Audience :: Developers
Classifier: License :: OSI Approved :: MIT License
Classifier: Operating System :: OS Independent
Classifier: Programming Language :: Python :: 3
Classifier: Programming Language :: Python :: 3.10
Classifier: Programming Language :: Python :: 3.11
Classifier: Programming Language :: Python :: 3.12
Classifier: Topic :: Communications :: Chat
Classifier: Topic :: Software Development :: Libraries :: Python Modules
Requires-Python: >=3.10
Requires-Dist: aiofiles>=24.1.0
Requires-Dist: aiogram-media-group>=0.5.1
Requires-Dist: aiogram>=3.22.0
Requires-Dist: beautifulsoup4>=4.14.2
Requires-Dist: click>=8.3.1
Requires-Dist: httpx>=0.28.1
Requires-Dist: langchain-community>=0.4.1
Requires-Dist: langchain-openai>=1.0.3
Requires-Dist: langchain>=1.0.8
Requires-Dist: openai>=2.8.0
Requires-Dist: playwright>=1.56.0
Requires-Dist: project-root-finder>=1.9
Requires-Dist: python-dateutil>=2.9.0.post0
Requires-Dist: python-dotenv>=1.2.1
Requires-Dist: python-slugify>=8.0.4
Requires-Dist: pytz>=2025.2
Requires-Dist: pyyaml>=6.0.3
Requires-Dist: sulguk>=0.11.1
Requires-Dist: supabase>=2.24.0
Requires-Dist: telegramify-markdown>=0.5.4
Requires-Dist: trafilatura>=2.0.0
Description-Content-Type: text/markdown

# Smart Bot Factory

## –ë–∏–±–ª–∏–æ—Ç–µ–∫–∞ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —É–º–Ω—ã—Ö Telegram –±–æ—Ç–æ–≤ —Å AI, –∞–Ω–∞–ª–∏—Ç–∏–∫–æ–π –∏ –≥–∏–±–∫–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–æ–π

## üìã –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ

- [Smart Bot Factory](#smart-bot-factory)
  - [–ë–∏–±–ª–∏–æ—Ç–µ–∫–∞ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —É–º–Ω—ã—Ö Telegram –±–æ—Ç–æ–≤ —Å AI, –∞–Ω–∞–ª–∏—Ç–∏–∫–æ–π –∏ –≥–∏–±–∫–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–æ–π](#–±–∏–±–ª–∏–æ—Ç–µ–∫–∞-–¥–ª—è-—Å–æ–∑–¥–∞–Ω–∏—è-—É–º–Ω—ã—Ö-telegram-–±–æ—Ç–æ–≤-—Å-ai-–∞–Ω–∞–ª–∏—Ç–∏–∫–æ–π-–∏-–≥–∏–±–∫–æ–π-–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–æ–π)
  - [üìã –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ](#-—Å–æ–¥–µ—Ä–∂–∞–Ω–∏–µ)
  - [üöÄ –£—Å—Ç–∞–Ω–æ–≤–∫–∞](#-—É—Å—Ç–∞–Ω–æ–≤–∫–∞)
  - [‚ö° –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç](#-–±—ã—Å—Ç—Ä—ã–π-—Å—Ç–∞—Ä—Ç)
    - [1. –°–æ–∑–¥–∞–Ω–∏–µ –±–æ—Ç–∞ —á–µ—Ä–µ–∑ CLI](#1-—Å–æ–∑–¥–∞–Ω–∏–µ-–±–æ—Ç–∞-—á–µ—Ä–µ–∑-cli)
    - [2. –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –∫–æ–¥ –±–æ—Ç–∞](#2-–º–∏–Ω–∏–º–∞–ª—å–Ω—ã–π-–∫–æ–¥-–±–æ—Ç–∞)
  - [üéÆ CLI –ö–æ–º–∞–Ω–¥—ã](#-cli-–∫–æ–º–∞–Ω–¥—ã)
    - [–°–æ–∑–¥–∞–Ω–∏–µ –±–æ—Ç–∞](#—Å–æ–∑–¥–∞–Ω–∏–µ-–±–æ—Ç–∞)
    - [–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –±–æ—Ç–∞–º–∏](#—É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ-–±–æ—Ç–∞–º–∏)
    - [–ù–∞—Å—Ç—Ä–æ–π–∫–∞](#–Ω–∞—Å—Ç—Ä–æ–π–∫–∞)
    - [–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ](#—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ)
    - [–£—Ç–∏–ª–∏—Ç—ã](#—É—Ç–∏–ª–∏—Ç—ã)
  - [üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞](#Ô∏è-–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞)
    - [BotBuilder - –û—Å–Ω–æ–≤–Ω–æ–π –∫–ª–∞—Å—Å](#botbuilder---–æ—Å–Ω–æ–≤–Ω–æ–π-–∫–ª–∞—Å—Å)
    - [EventRouter - –†–æ—É—Ç–µ—Ä —Å–æ–±—ã—Ç–∏–π](#eventrouter---—Ä–æ—É—Ç–µ—Ä-—Å–æ–±—ã—Ç–∏–π)
    - [RagRouter - RAG –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã](#ragrouter---rag-–∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã)
    - [ToolRouter - –û–±—ã—á–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã](#toolrouter---–æ–±—ã—á–Ω—ã–µ-–∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã)
  - [üåê –ü–∞—Ä—Å–∏–Ω–≥ —Å–∞–π—Ç–æ–≤ –∏ RAG](#-–ø–∞—Ä—Å–∏–Ω–≥-—Å–∞–π—Ç–æ–≤-–∏-rag)
    - [–ü–∞—Ä—Å–∏–Ω–≥ —Å–∞–π—Ç–æ–≤](#–ø–∞—Ä—Å–∏–Ω–≥-—Å–∞–π—Ç–æ–≤)
    - [–í–µ–∫—Ç–æ—Ä–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ (RAG)](#–≤–µ–∫—Ç–æ—Ä–Ω–æ–µ-—Ö—Ä–∞–Ω–∏–ª–∏—â–µ-rag)
  - [üì¶ –î–µ–∫–æ—Ä–∞—Ç–æ—Ä—ã](#-–¥–µ–∫–æ—Ä–∞—Ç–æ—Ä—ã)
    - [`event_handler` - –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π](#event_handler---–æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏-—Å–æ–±—ã—Ç–∏–π)
    - [`schedule_task` - –ó–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∑–∞–¥–∞—á–∏](#schedule_task---–∑–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ-–∑–∞–¥–∞—á–∏)
    - [`global_handler` - –ì–ª–æ–±–∞–ª—å–Ω—ã–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏](#global_handler---–≥–ª–æ–±–∞–ª—å–Ω—ã–µ-–æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏)
  - [üé£ –•—É–∫–∏ –¥–ª—è –∫–∞—Å—Ç–æ–º–∏–∑–∞—Ü–∏–∏](#-—Ö—É–∫–∏-–¥–ª—è-–∫–∞—Å—Ç–æ–º–∏–∑–∞—Ü–∏–∏)
    - [–î–æ—Å—Ç—É–ø–Ω—ã–µ —Ö—É–∫–∏](#–¥–æ—Å—Ç—É–ø–Ω—ã–µ-—Ö—É–∫–∏)
  - [üì± Telegram —Ä–æ—É—Ç–µ—Ä—ã](#-telegram-—Ä–æ—É—Ç–µ—Ä—ã)
    - [–°–æ–∑–¥–∞–Ω–∏–µ —Ä–æ—É—Ç–µ—Ä–∞](#—Å–æ–∑–¥–∞–Ω–∏–µ-—Ä–æ—É—Ç–µ—Ä–∞)
    - [–ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω–∞—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è](#–º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω–∞—è-—Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è)
  - [üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ](#-—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ)
    - [–ß–µ—Ä–µ–∑ CLI](#—á–µ—Ä–µ–∑-cli)
    - [–ß–µ—Ä–µ–∑ BotBuilder](#—á–µ—Ä–µ–∑-botbuilder)
    - [–§–æ—Ä–º–∞—Ç —Ç–µ—Å—Ç–æ–≤ (YAML)](#—Ñ–æ—Ä–º–∞—Ç-—Ç–µ—Å—Ç–æ–≤-yaml)
  - [üîÑ –ú–∏–≥—Ä–∞—Ü–∏—è —Å –ø—Ä–æ—à–ª–æ–π –≤–µ—Ä—Å–∏–∏](#-–º–∏–≥—Ä–∞—Ü–∏—è-—Å-–ø—Ä–æ—à–ª–æ–π-–≤–µ—Ä—Å–∏–∏)
    - [–û—Å–Ω–æ–≤–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è](#–æ—Å–Ω–æ–≤–Ω—ã–µ-–∏–∑–º–µ–Ω–µ–Ω–∏—è)
    - [–ü—Ä–∏–º–µ—Ä –º–∏–≥—Ä–∞—Ü–∏–∏](#–ø—Ä–∏–º–µ—Ä-–º–∏–≥—Ä–∞—Ü–∏–∏)
    - [–ö–ª—é—á–µ–≤—ã–µ –æ—Ç–ª–∏—á–∏—è](#–∫–ª—é—á–µ–≤—ã–µ-–æ—Ç–ª–∏—á–∏—è)
  - [üîß –†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏](#-—Ä–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–µ-–≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏)
    - [–ö–∞—Å—Ç–æ–º–Ω—ã–π PromptLoader](#–∫–∞—Å—Ç–æ–º–Ω—ã–π-promptloader)
    - [–ü–æ–ª–Ω–∞—è –∑–∞–º–µ–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Å–æ–±—ã—Ç–∏–π](#–ø–æ–ª–Ω–∞—è-–∑–∞–º–µ–Ω–∞-–æ–±—Ä–∞–±–æ—Ç–∫–∏-—Å–æ–±—ã—Ç–∏–π)
    - [–î–æ—Å—Ç—É–ø –∫ aiogram Bot](#–¥–æ—Å—Ç—É–ø-–∫-aiogram-bot)
    - [UTM-—Ç—Ä–∏–≥–≥–µ—Ä—ã](#utm-—Ç—Ä–∏–≥–≥–µ—Ä—ã)
  - [üìö –ü–æ–ª–Ω—ã–π –ø—Ä–∏–º–µ—Ä](#-–ø–æ–ª–Ω—ã–π-–ø—Ä–∏–º–µ—Ä)
  - [üìñ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞](#-—Å—Ç—Ä—É–∫—Ç—É—Ä–∞-–ø—Ä–æ–µ–∫—Ç–∞)
  - [‚öôÔ∏è –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è (.env)](#Ô∏è-–∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è-env)
  - [üéØ –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –¥–µ–∫–æ—Ä–∞—Ç–æ—Ä–æ–≤](#-—Å—Ä–∞–≤–Ω–µ–Ω–∏–µ-–¥–µ–∫–æ—Ä–∞—Ç–æ—Ä–æ–≤)
  - [üîë –ö–ª—é—á–µ–≤—ã–µ –∫–æ–Ω—Ü–µ–ø—Ü–∏–∏](#-–∫–ª—é—á–µ–≤—ã–µ-–∫–æ–Ω—Ü–µ–ø—Ü–∏–∏)
    - [`send_ai_response=True`](#send_ai_responsetrue)
    - [`once_only=True`](#once_onlytrue)
    - [`smart_check=True`](#smart_checktrue)
    - [`event_type` - –ü—Ä–∏–≤—è–∑–∫–∞ –∫–æ –≤—Ä–µ–º–µ–Ω–∏ —Å–æ–±—ã—Ç–∏—è](#event_type---–ø—Ä–∏–≤—è–∑–∫–∞-–∫–æ-–≤—Ä–µ–º–µ–Ω–∏-—Å–æ–±—ã—Ç–∏—è)
  - [üìû –ü–æ–¥–¥–µ—Ä–∂–∫–∞](#-–ø–æ–¥–¥–µ—Ä–∂–∫–∞)
  - [üìÑ –õ–∏—Ü–µ–Ω–∑–∏—è](#-–ª–∏—Ü–µ–Ω–∑–∏—è)

---

## üöÄ –£—Å—Ç–∞–Ω–æ–≤–∫–∞

```bash
pip install smart_bot_factory
```

–ò–ª–∏ —á–µ—Ä–µ–∑ `uv`:

```bash
uv add smart_bot_factory
```

---

## ‚ö° –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### 1. –°–æ–∑–¥–∞–Ω–∏–µ –±–æ—Ç–∞ —á–µ—Ä–µ–∑ CLI

```bash
# –°–æ–∑–¥–∞—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä—É –Ω–æ–≤–æ–≥–æ –±–æ—Ç–∞
sbf create my-bot

# –ù–∞—Å—Ç—Ä–æ–∏—Ç—å .env —Ñ–∞–π–ª
sbf config my-bot

# –ó–∞–ø—É—Å—Ç–∏—Ç—å –±–æ—Ç–∞
sbf run my-bot
```

### 2. –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –∫–æ–¥ –±–æ—Ç–∞

```python
"""my-bot.py"""
import asyncio
from smart_bot_factory.router import EventRouter
from smart_bot_factory.message import send_message_by_human
from smart_bot_factory.creation import BotBuilder

# –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
event_router = EventRouter("my-bot")
bot_builder = BotBuilder("my-bot")

@event_router.event_handler("collect_phone", once_only=True)
async def handle_phone(user_id: int, phone: str):
    """–ò–ò —Å–æ–∑–¥–∞–µ—Ç: {"—Ç–∏–ø": "collect_phone", "–∏–Ω—Ñ–æ": "+79001234567"}"""
    await send_message_by_human(
        user_id=user_id,
        message_text=f"‚úÖ –¢–µ–ª–µ—Ñ–æ–Ω {phone} —Å–æ—Ö—Ä–∞–Ω–µ–Ω"
    )
    return {"status": "success"}

async def main():
    bot_builder.register_routers(event_router)
    await bot_builder.start()

if __name__ == "__main__":
    asyncio.run(main())
```

---

## üéÆ CLI –ö–æ–º–∞–Ω–¥—ã

### –°–æ–∑–¥–∞–Ω–∏–µ –±–æ—Ç–∞

```bash
# –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤–æ–≥–æ –±–æ—Ç–∞ –∏–∑ –±–∞–∑–æ–≤–æ–≥–æ —à–∞–±–ª–æ–Ω–∞
sbf create my-bot

# –°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–≥–æ –±–æ—Ç–∞
sbf copy best-valera new-valera
```

**üí° –ö–æ–º–∞–Ω–¥–∞ `copy` - —Å–æ–∑–¥–∞–µ—Ç –Ω–æ–≤–æ–≥–æ –±–æ—Ç–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–≥–æ:**

- ‚úÖ –ö–æ–ø–∏—Ä—É–µ—Ç –∫–æ–¥ –±–æ—Ç–∞ —Å –∞–≤—Ç–æ–∑–∞–º–µ–Ω–æ–π `bot_id`
- ‚úÖ –ö–æ–ø–∏—Ä—É–µ—Ç –≤—Å–µ –ø—Ä–æ–º–ø—Ç—ã
- ‚úÖ –ö–æ–ø–∏—Ä—É–µ—Ç —Ç–µ—Å—Ç—ã –∏ —Ñ–∞–π–ª—ã
- ‚úÖ –°–æ–∑–¥–∞–µ—Ç –Ω–æ–≤—ã–π `.env` (–Ω–µ –∫–æ–ø–∏—Ä—É–µ—Ç —Ç–æ–∫–µ–Ω—ã)

### –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –±–æ—Ç–∞–º–∏

```bash
# –ü–æ–∫–∞–∑–∞—Ç—å —Å–ø–∏—Å–æ–∫ –±–æ—Ç–æ–≤
sbf list

# –ó–∞–ø—É—Å—Ç–∏—Ç—å –±–æ—Ç–∞
sbf run my-bot

# –£–¥–∞–ª–∏—Ç—å –±–æ—Ç–∞
sbf rm my-bot

# –£–¥–∞–ª–∏—Ç—å –±–µ–∑ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è
sbf rm my-bot --force
```

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞

```bash
# –û—Ç–∫—Ä—ã—Ç—å .env —Ñ–∞–π–ª –≤ —Ä–µ–¥–∞–∫—Ç–æ—Ä–µ
sbf config my-bot

# –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–º–ø—Ç–∞–º–∏
sbf prompts my-bot                    # –°–ø–∏—Å–æ–∫ –ø—Ä–æ–º–ø—Ç–æ–≤
sbf prompts my-bot --edit system      # –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ–º–ø—Ç
sbf prompts my-bot --add custom       # –î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–π –ø—Ä–æ–º–ø—Ç
```

### –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

```bash
# –ó–∞–ø—É—Å—Ç–∏—Ç—å –≤—Å–µ —Ç–µ—Å—Ç—ã
sbf test my-bot

# –ó–∞–ø—É—Å—Ç–∏—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π —Ñ–∞–π–ª
sbf test my-bot --file test_booking.yaml

# –ü–æ–¥—Ä–æ–±–Ω—ã–π –≤—ã–≤–æ–¥
sbf test my-bot -v

# –£–≤–µ–ª–∏—á–∏—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã—Ö –ø–æ—Ç–æ–∫–æ–≤
sbf test my-bot --max-concurrent 10
```

### –£—Ç–∏–ª–∏—Ç—ã

```bash
# –ü–æ–∫–∞–∑–∞—Ç—å –ø—É—Ç—å –∫ –ø—Ä–æ–µ–∫—Ç—É
sbf path

# –°–æ–∑–¥–∞—Ç—å UTM —Å—Å—ã–ª–∫—É
sbf link
```

**–ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä UTM-—Å—Å—ã–ª–æ–∫ (`sbf link`):**

–ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è UTM-—Å—Å—ã–ª–æ–∫ –Ω–∞ Telegram –±–æ—Ç–∞.

**–ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:**

1. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –∫–æ–º–∞–Ω–¥—É `sbf link`
2. –í–≤–µ–¥–∏—Ç–µ username –±–æ—Ç–∞ (–±–µ–∑ @)
3. –£–∫–∞–∂–∏—Ç–µ UTM-–º–µ—Ç–∫–∏ (–º–æ–∂–Ω–æ –ø—Ä–æ–ø—É—Å–∫–∞—Ç—å, –Ω–∞–∂–∞–≤ Enter):
   - `utm_source` - –∏—Å—Ç–æ—á–Ω–∏–∫ —Ç—Ä–∞—Ñ–∏–∫–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä: `vk`, `instagram`, `google`)
   - `utm_medium` - –∫–∞–Ω–∞–ª (–Ω–∞–ø—Ä–∏–º–µ—Ä: `cpc`, `social`, `email`)
   - `utm_campaign` - –Ω–∞–∑–≤–∞–Ω–∏–µ –∫–∞–º–ø–∞–Ω–∏–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä: `summer2025`, `new_year`)
   - `utm_content` - –∫–æ–Ω—Ç–µ–Ω—Ç (–Ω–∞–ø—Ä–∏–º–µ—Ä: `banner`, `post`)
   - `utm_term` - –∫–ª—é—á–µ–≤–æ–µ —Å–ª–æ–≤–æ
   - `segment` - —Å–µ–≥–º–µ–Ω—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π (–Ω–∞–ø—Ä–∏–º–µ—Ä: `premium`, `vip`)

**–ü—Ä–∏–º–µ—Ä:**

```bash
$ sbf link
üîó –ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä UTM-—Å—Å—ã–ª–æ–∫ –¥–ª—è Telegram
==================================================
–í–≤–µ–¥–∏—Ç–µ username –±–æ—Ç–∞ (–±–µ–∑ @): my_bot

üìä –í–≤–µ–¥–∏—Ç–µ UTM-–º–µ—Ç–∫–∏ (–Ω–∞–∂–º–∏—Ç–µ Enter –¥–ª—è –ø—Ä–æ–ø—É—Å–∫–∞):
utm_source (–∏—Å—Ç–æ—á–Ω–∏–∫): vk
utm_medium (–∫–∞–Ω–∞–ª): social
utm_campaign (–∫–∞–º–ø–∞–Ω–∏—è): summer2025
utm_content (–∫–æ–Ω—Ç–µ–Ω—Ç): 
utm_term (–∫–ª—é—á–µ–≤–æ–µ —Å–ª–æ–≤–æ): 
üéØ –°–µ–≥–º–µ–Ω—Ç–∞—Ü–∏—è (–Ω–∞–∂–º–∏—Ç–µ Enter –¥–ª—è –ø—Ä–æ–ø—É—Å–∫–∞):
seg (—Å–µ–≥–º–µ–Ω—Ç): premium

üìè –†–∞–∑–º–µ—Ä OK: 45 —Å–∏–º–≤–æ–ª–æ–≤

‚úÖ –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Å—Å—ã–ª–∫–∞:
üîó https://t.me/my_bot?start=source-vk_medium-social_campaign-summer2025_seg-premium
```

**–§–æ—Ä–º–∞—Ç —Å—Å—ã–ª–∫–∏:**

–°—Å—ã–ª–∫–∞ —Å–æ–∑–¥–∞–µ—Ç—Å—è –≤ —Ñ–æ—Ä–º–∞—Ç–µ:
```
https://t.me/BOT_USERNAME?start=source-VALUE_medium-VALUE_campaign-VALUE_seg-VALUE
```

**–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è:**

- –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –¥–ª–∏–Ω–∞ —Å—Ç—Ä–æ–∫–∏ –ø–æ—Å–ª–µ `start=` - **64 —Å–∏–º–≤–æ–ª–∞**
- –ï—Å–ª–∏ —Å—Å—ã–ª–∫–∞ –ø—Ä–µ–≤—ã—à–∞–µ—Ç –ª–∏–º–∏—Ç, —Å–æ–∫—Ä–∞—Ç–∏—Ç–µ –∑–Ω–∞—á–µ–Ω–∏—è UTM-–º–µ—Ç–æ–∫

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Å—Å—ã–ª–∫–∏:**

1. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—É—é —Å—Å—ã–ª–∫—É
2. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –µ—ë –≤ —Ä–µ–∫–ª–∞–º–µ, –ø–æ—Å—Ç–∞—Ö, email-—Ä–∞—Å—Å—ã–ª–∫–∞—Ö
3. –ü—Ä–∏ –ø–µ—Ä–µ—Ö–æ–¥–µ –ø–æ —Å—Å—ã–ª–∫–µ –∏ –Ω–∞–∂–∞—Ç–∏–∏ `/start` –±–æ—Ç –ø–æ–ª—É—á–∏—Ç UTM-–º–µ—Ç–∫–∏
4. –ú–æ–∂–Ω–æ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å UTM-—Ç—Ä–∏–≥–≥–µ—Ä—ã –¥–ª—è —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π (—Å–º. —Ä–∞–∑–¥–µ–ª [UTM-—Ç—Ä–∏–≥–≥–µ—Ä—ã](#utm-—Ç—Ä–∏–≥–≥–µ—Ä—ã))

**–ü—Ä–∏–º–µ—Ä—ã —Å—Å—ã–ª–æ–∫:**

```bash
# –ü—Ä–æ—Å—Ç–∞—è —Å—Å—ã–ª–∫–∞ —Å –∏—Å—Ç–æ—á–Ω–∏–∫–æ–º –∏ –∫–∞–º–ø–∞–Ω–∏–µ–π
https://t.me/my_bot?start=source-vk_campaign-summer2025

# –° –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏
https://t.me/my_bot?start=source-instagram_medium-story_campaign-new_year

# –° —Å–µ–≥–º–µ–Ω—Ç–æ–º
https://t.me/my_bot?start=source-google_campaign-premium_seg-vip
```

---

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

### BotBuilder - –û—Å–Ω–æ–≤–Ω–æ–π –∫–ª–∞—Å—Å

`BotBuilder` - —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π –∫–ª–∞—Å—Å –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –±–æ—Ç–æ–º. –û–Ω —É–ø—Ä–∞–≤–ª—è–µ—Ç –≤—Å–µ–º–∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞–º–∏: –∫–ª–∏–µ–Ω—Ç–∞–º–∏, –º–µ–Ω–µ–¥–∂–µ—Ä–∞–º–∏, —Ä–æ—É—Ç–µ—Ä–∞–º–∏ –∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞–º–∏.

**–û—Å–Ω–æ–≤–Ω—ã–µ –º–µ—Ç–æ–¥—ã:**

```python
bot_builder = BotBuilder("my-bot")

# –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è —Ä–æ—É—Ç–µ—Ä–æ–≤
bot_builder.register_routers(event_router)              # EventRouter
bot_builder.register_telegram_router(telegram_router)  # aiogram.Router
bot_builder.register_rag(rag_router)                   # RagRouter
bot_builder.register_tool_set(tool_router)              # ToolRouter

# –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –æ—Ç–¥–µ–ª—å–Ω—ã—Ö –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤
bot_builder.register_tool(some_tool)                    # LangChain Tool
bot_builder.register_tools(tool1, tool2, tool3)        # –ù–µ—Å–∫–æ–ª—å–∫–æ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤

# –ö–∞—Å—Ç–æ–º–∏–∑–∞—Ü–∏—è (–¥–æ build())
bot_builder.set_prompt_loader(custom_loader)
bot_builder.set_event_processor(custom_processor)

# –•—É–∫–∏ –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏–π
@bot_builder.validate_message
@bot_builder.enrich_prompt
@bot_builder.enrich_context
@bot_builder.process_response
@bot_builder.filter_send
@bot_builder.on_start

# –°–±–æ—Ä–∫–∞ –∏ –∑–∞–ø—É—Å–∫
await bot_builder.build()   # –Ø–≤–Ω–∞—è —Å–±–æ—Ä–∫–∞ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
await bot_builder.start()   # –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤—ã–∑—ã–≤–∞–µ—Ç build() –µ—Å–ª–∏ –Ω—É–∂–Ω–æ

# –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è —á–µ—Ä–µ–∑ CLI: sbf test my-bot
```

**–ñ–∏–∑–Ω–µ–Ω–Ω—ã–π —Ü–∏–∫–ª:**

1. **–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è** - —Å–æ–∑–¥–∞–Ω–∏–µ `BotBuilder(bot_id)`
2. **–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è** - –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ä–æ—É—Ç–µ—Ä–æ–≤, –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤, —Ö—É–∫–æ–≤
3. **–°–±–æ—Ä–∫–∞** - `build()` –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç –≤—Å–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã (–≤—ã–∑—ã–≤–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤ `start()`)
4. **–ó–∞–ø—É—Å–∫** - `start()` –∑–∞–ø—É—Å–∫–∞–µ—Ç –±–æ—Ç–∞ –∏ –Ω–∞—á–∏–Ω–∞–µ—Ç –æ–±—Ä–∞–±–æ—Ç–∫—É —Å–æ–æ–±—â–µ–Ω–∏–π

### EventRouter - –†–æ—É—Ç–µ—Ä —Å–æ–±—ã—Ç–∏–π

`EventRouter` - —Ä–æ—É—Ç–µ—Ä –¥–ª—è –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ —Å–æ–±—ã—Ç–∏–π, –∑–∞–¥–∞—á –∏ –≥–ª–æ–±–∞–ª—å–Ω—ã—Ö –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤.

```python
from smart_bot_factory.router import EventRouter

event_router = EventRouter("my-bot")

# –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤
@event_router.event_handler("collect_phone")
@event_router.schedule_task("follow_up", delay="24h")
@event_router.global_handler("announcement", delay="2h")

# –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –≤ BotBuilder
bot_builder.register_routers(event_router)
```

### RagRouter - RAG –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã

`RagRouter` - —É–ø—Ä–æ—â–µ–Ω–Ω—ã–π —Ä–æ—É—Ç–µ—Ä –¥–ª—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ RAG-–∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ —Å –≤–µ–∫—Ç–æ—Ä–Ω—ã–º –ø–æ–∏—Å–∫–æ–º.

```python
from smart_bot_factory.rag import RagRouter, VectorStore

# –°–æ–∑–¥–∞–Ω–∏–µ –≤–µ–∫—Ç–æ—Ä–Ω–æ–≥–æ —Ö—Ä–∞–Ω–∏–ª–∏—â–∞
vectorstore = VectorStore(bot_id="my-bot")

# –°–æ–∑–¥–∞–Ω–∏–µ —Ä–æ—É—Ç–µ—Ä–∞
rag_router = RagRouter("my_rag")

# –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞
@rag_router.tool
async def get_info_from_rag(query: str, section: Optional[str] = None) -> str:
    """–ó–∞–ø—Ä–æ—Å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –∏–∑ RAG-—Å–∏—Å—Ç–µ–º—ã.
    
    Args:
        query: –ó–∞–ø—Ä–æ—Å –∫ RAG-—Å–∏—Å—Ç–µ–º–µ.
        section: –†–∞–∑–¥–µ–ª –¥–ª—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ).
    """
    results = await vectorstore.asimilarity_search(
        query, k=5, filter={"section": section} if section else {}
    )
    return format_results(results)

# –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –≤ BotBuilder
bot_builder.register_rag(rag_router)
```

**–ü—Ä–∏–º–µ—Ä –ø–æ–ª–Ω–æ–≥–æ —Ñ–∞–π–ª–∞ `rag_tools.py`:**

```python
from typing import Optional
from smart_bot_factory.rag import RagRouter, VectorStore

vectorstore = VectorStore(bot_id="my-bot")
rag_router = RagRouter("my_rag")

@rag_router.tool
async def get_info_from_rag(query: str, section: Optional[str] = None) -> str:
    """–ó–∞–ø—Ä–æ—Å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –∏–∑ RAG-—Å–∏—Å—Ç–µ–º—ã."""
    results = await vectorstore.asimilarity_search(
        query, k=5, filter={"section": section.split("|")} if section else {}
    )
    return "\n\n".join([doc.page_content for doc in results])
```

### ToolRouter - –û–±—ã—á–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã

`ToolRouter` - —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π —Ä–æ—É—Ç–µ—Ä –¥–ª—è —Å–±–æ—Ä–∞ –∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –æ–±—ã—á–Ω—ã—Ö LangChain-–∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤.

```python
from smart_bot_factory.utils import ToolRouter

tool_router = ToolRouter("common_tools")

@tool_router.tool
def calculate_price(service: str, quantity: int) -> str:
    """–†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç —Ü–µ–Ω—É —É—Å–ª—É–≥–∏.
    
    Args:
        service: –ù–∞–∑–≤–∞–Ω–∏–µ —É—Å–ª—É–≥–∏
        quantity: –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ
    """
    prices = {"–∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏—è": 1000, "–ª–µ—á–µ–Ω–∏–µ": 5000}
    total = prices.get(service, 0) * quantity
    return f"–°—Ç–æ–∏–º–æ—Å—Ç—å: {total}‚ÇΩ"

# –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –≤ BotBuilder
bot_builder.register_tool_set(tool_router)
```

---

## üåê –ü–∞—Ä—Å–∏–Ω–≥ —Å–∞–π—Ç–æ–≤ –∏ RAG

### –ü–∞—Ä—Å–∏–Ω–≥ —Å–∞–π—Ç–æ–≤

`SiteParser` - –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–ª—è –ø–∞—Ä—Å–∏–Ω–≥–∞ –≤–µ–±-—Å–∞–π—Ç–æ–≤ —Å –æ—á–∏—Å—Ç–∫–æ–π —Ç–µ–∫—Å—Ç–∞ —á–µ—Ä–µ–∑ LLM.

**–û—Å–Ω–æ–≤–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:**

- –ü–∞—Ä—Å–∏–Ω–≥ –æ–¥–Ω–æ–π –∏–ª–∏ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —Å—Ç—Ä–∞–Ω–∏—Ü
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—á–∏—Å—Ç–∫–∞ —Ç–µ–∫—Å—Ç–∞ —á–µ—Ä–µ–∑ LLM
- –ü–æ–∏—Å–∫ —Å—Å—ã–ª–æ–∫ –≤ sitemap
- –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –≤ —Ñ–∞–π–ª—ã
- –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞

**–ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:**

```python
import asyncio
from smart_bot_factory.site_parser import SiteParser, search_sitemap

# –°–æ–∑–¥–∞–Ω–∏–µ –ø–∞—Ä—Å–µ—Ä–∞ —Å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–º–∏ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º–∏
additional_prompt = (
    "–£–±–µ—Ä–∏ –∫–æ–Ω—Ç–∞–∫—Ç–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –≤ –Ω–∞—á–∞–ª–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã. "
    "–£–±–µ—Ä–∏ —Å–ø–∏—Å–æ–∫ —É—Å–ª—É–≥ –≤ –∫–æ–Ω—Ü–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã."
)

parser = SiteParser(
    bot_id="my-bot",
    additional_instructions=additional_prompt
)

async def main():
    # –ü–æ–∏—Å–∫ —Å—Å—ã–ª–æ–∫ –≤ sitemap
    links = search_sitemap("https://example.com/sitemap.xml")
    print(f"–ù–∞–π–¥–µ–Ω–æ —Å—Å—ã–ª–æ–∫: {len(links)}")
    
    # –ü–∞—Ä—Å–∏–Ω–≥ –≤—Å–µ—Ö —Å—Å—ã–ª–æ–∫ —Å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º –≤ —Ñ–∞–π–ª—ã
    files = await parser.parser(
        links[:10],  # –ü–µ—Ä–≤—ã–µ 10 —Å—Å—ã–ª–æ–∫
        max_workers=5,  # –û–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å 5 —Å—Ç—Ä–∞–Ω–∏—Ü
        to_files=True  # –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –≤ —Ñ–∞–π–ª—ã
    )
    
    # –§–∞–π–ª—ã —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ bots/my-bot/parser/
    print(f"–°–æ—Ö—Ä–∞–Ω–µ–Ω–æ —Ñ–∞–π–ª–æ–≤: {len(files)}")
    
    # –ò–ª–∏ –ø–æ–ª—É—á–∏—Ç—å —Ç–µ–∫—Å—Ç –Ω–∞–ø—Ä—è–º—É—é
    text = await parser.parser("https://example.com/page")
    print(f"–î–ª–∏–Ω–∞ —Ç–µ–∫—Å—Ç–∞: {len(text)}")

asyncio.run(main())
```

**–ú–µ—Ç–æ–¥—ã:**

- `parser(url, max_workers=5, to_files=False)` - –ø–∞—Ä—Å–∏–Ω–≥ URL –∏–ª–∏ —Å–ø–∏—Å–∫–∞ URL
- `search_sitemap(url, regex=None, limit=None)` - –ø–æ–∏—Å–∫ —Å—Å—ã–ª–æ–∫ –≤ sitemap —Å —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–µ–π

### –í–µ–∫—Ç–æ—Ä–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ (RAG)

`VectorStore` - –≤–µ–∫—Ç–æ—Ä–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ –Ω–∞ –±–∞–∑–µ Supabase –¥–ª—è RAG-–ø–æ–∏—Å–∫–∞.

**–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞:**

- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–≥—Ä—É–∂–∞–µ—Ç –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∏–∑ `.env` —Ñ–∞–π–ª–∞ –±–æ—Ç–∞
- –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –Ω–∞–ª–∏—á–∏–µ —Ç–∞–±–ª–∏—Ü—ã –∏ —Ñ—É–Ω–∫—Ü–∏–∏ –≤ Supabase
- –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç SQL —Ñ–∞–π–ª—ã –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —Ç–∞–±–ª–∏—Ü—ã/—Ñ—É–Ω–∫—Ü–∏–∏ –ø—Ä–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏

**–ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:**

```python
from smart_bot_factory.rag import VectorStore
from langchain_core.documents import Document

# –°–æ–∑–¥–∞–Ω–∏–µ –≤–µ–∫—Ç–æ—Ä–Ω–æ–≥–æ —Ö—Ä–∞–Ω–∏–ª–∏—â–∞
vectorstore = VectorStore(bot_id="my-bot")

# –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ –∏–∑ —Ñ–∞–π–ª–æ–≤
from pathlib import Path

parser_dir = Path("bots/my-bot/parser")
documents = []

for txt_file in parser_dir.glob("*.txt"):
    content = txt_file.read_text(encoding="utf-8")
    
    # –°–æ–∑–¥–∞–µ–º –¥–æ–∫—É–º–µ–Ω—Ç —Å –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–º–∏
    doc = Document(
        page_content=content,
        metadata={
            "source": txt_file.stem,
            "section": "services",  # –î–ª—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏
            "category": "medical"
        }
    )
    documents.append(doc)

# –î–æ–±–∞–≤–ª—è–µ–º –¥–æ–∫—É–º–µ–Ω—Ç—ã –≤ –≤–µ–∫—Ç–æ—Ä–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ
# –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞—é—Ç—Å—è embeddings –∏ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ Supabase
vectorstore.add_documents(documents)

# –ü–æ–∏—Å–∫ –ø–æ –∑–∞–ø—Ä–æ—Å—É
results = await vectorstore.asimilarity_search(
    query="—Å—Ç–æ–∏–º–æ—Å—Ç—å –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏–∏",
    k=5,  # –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
    filter={"section": "services"},  # –§–∏–ª—å—Ç—Ä –ø–æ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–º
    score=0.6  # –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –ø–æ—Ä–æ–≥ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ—Å—Ç–∏
)

for doc in results:
    print(f"–¢–µ–∫—Å—Ç: {doc.page_content[:100]}...")
    print(f"–ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ: {doc.metadata}")
```

**–ú–µ—Ç–æ–¥—ã VectorStore:**

- `add_documents(documents)` - –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
- `add_texts(texts, metadatas=None)` - –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ç–µ–∫—Å—Ç–æ–≤
- `asimilarity_search(query, k=4, filter=None, score=None)` - –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π –ø–æ–∏—Å–∫
- `similarity_search(query, k=4, filter=None)` - —Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π –ø–æ–∏—Å–∫

**–ü–æ–ª–Ω—ã–π –ø—Ä–∏–º–µ—Ä: –ø–∞—Ä—Å–∏–Ω–≥ ‚Üí RAG**

```python
import asyncio
from pathlib import Path
from smart_bot_factory.site_parser import SiteParser, search_sitemap
from smart_bot_factory.rag import VectorStore
from langchain_core.documents import Document

async def parse_and_index():
    # 1. –ü–∞—Ä—Å–∏–Ω–≥ —Å–∞–π—Ç–∞
    parser = SiteParser(
        bot_id="my-bot",
        additional_instructions="–£–±–µ—Ä–∏ –∫–æ–Ω—Ç–∞–∫—Ç—ã –∏ —Å–ø–∏—Å–∫–∏ —É—Å–ª—É–≥"
    )
    
    links = search_sitemap("https://example.com/sitemap.xml")
    files = await parser.parser(links[:20], to_files=True)
    
    # 2. –ó–∞–≥—Ä—É–∑–∫–∞ –≤ –≤–µ–∫—Ç–æ—Ä–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ
    vectorstore = VectorStore(bot_id="my-bot")
    parser_dir = Path("bots/my-bot/parser")
    
    documents = []
    for txt_file in parser_dir.glob("*.txt"):
        content = txt_file.read_text(encoding="utf-8")
        
        # –ò–∑–≤–ª–µ–∫–∞–µ–º –∫–∞—Ç–µ–≥–æ—Ä–∏—é –∏–∑ –∏–º–µ–Ω–∏ —Ñ–∞–π–ª–∞
        category = txt_file.stem.split("-")[0] if "-" in txt_file.stem else "general"
        
        doc = Document(
            page_content=content,
            metadata={
                "source": txt_file.stem,
                "category": category,
                "section": "services"
            }
        )
        documents.append(doc)
    
    # 3. –î–æ–±–∞–≤–ª—è–µ–º –≤ –≤–µ–∫—Ç–æ—Ä–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ
    vectorstore.add_documents(documents)
    print(f"‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–æ {len(documents)} –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ –≤ RAG")

asyncio.run(parse_and_index())
```

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤ RAG-—Ä–æ—É—Ç–µ—Ä–µ:**

```python
from smart_bot_factory.rag import RagRouter, VectorStore

vectorstore = VectorStore(bot_id="my-bot")
rag_router = RagRouter("my_rag")

@rag_router.tool
async def get_info_from_rag(query: str, section: Optional[str] = None) -> str:
    """–ó–∞–ø—Ä–æ—Å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –∏–∑ RAG-—Å–∏—Å—Ç–µ–º—ã.
    
    Args:
        query: –ó–∞–ø—Ä–æ—Å –∫ RAG-—Å–∏—Å—Ç–µ–º–µ
        section: –†–∞–∑–¥–µ–ª –¥–ª—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
    """
    filter_dict = {}
    if section:
        filter_dict["section"] = section.split("|")  # –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —Ä–∞–∑–¥–µ–ª–æ–≤
    
    results = await vectorstore.asimilarity_search(
        query, 
        k=5, 
        filter=filter_dict if filter_dict else None,
        score=0.55  # –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –ø–æ—Ä–æ–≥ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ—Å—Ç–∏
    )
    
    return "\n\n".join([doc.page_content for doc in results])

# –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –≤ –±–æ—Ç–µ
bot_builder.register_rag(rag_router)
```

**–ù–∞—Å—Ç—Ä–æ–π–∫–∞ Supabase:**

–ü—Ä–∏ –ø–µ—Ä–≤–æ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ `VectorStore` –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:

1. –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –Ω–∞–ª–∏—á–∏–µ —Ç–∞–±–ª–∏—Ü—ã `vectorstore` –≤ Supabase
2. –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –Ω–∞–ª–∏—á–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏ `match_vectorstore` –¥–ª—è –ø–æ–∏—Å–∫–∞
3. –ï—Å–ª–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç - –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç SQL —Ñ–∞–π–ª—ã –≤ `sql_functions/`
4. –í—ã–ø–æ–ª–Ω–∏—Ç–µ SQL —Ñ–∞–π–ª—ã –≤ Supabase –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —Ç–∞–±–ª–∏—Ü—ã –∏ —Ñ—É–Ω–∫—Ü–∏–∏

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ç–∞–±–ª–∏—Ü—ã:**

```sql
CREATE TABLE vectorstore (
    id UUID PRIMARY KEY,
    content TEXT,
    embedding vector(1536),  -- –¥–ª—è text-embedding-3-small
    metadata JSONB
);
```

---

## üì¶ –î–µ–∫–æ—Ä–∞—Ç–æ—Ä—ã

### `event_handler` - –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –û–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç —Å–æ–±—ã—Ç–∏—è –æ—Ç –ò–ò –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ (–∫–∞–∫ —Ç–æ–ª—å–∫–æ –ò–ò —Å–æ–∑–¥–∞–µ—Ç —Å–æ–±—ã—Ç–∏–µ).

**–°–∏–≥–Ω–∞—Ç—É—Ä–∞:**

```python
@event_router.event_handler(
    event_type: str,                # –¢–∏–ø —Å–æ–±—ã—Ç–∏—è
    notify: bool = False,           # –£–≤–µ–¥–æ–º–ª—è—Ç—å –∞–¥–º–∏–Ω–æ–≤
    once_only: bool = True,         # –í—ã–ø–æ–ª–Ω—è—Ç—å —Ç–æ–ª—å–∫–æ 1 —Ä–∞–∑
    send_ai_response: bool = True   # –û—Ç–ø—Ä–∞–≤–ª—è—Ç—å –æ—Ç–≤–µ—Ç –æ—Ç –ò–ò
)
async def handler(user_id: int, event_data: str):
    # –í–∞—à –∫–æ–¥
    return {"status": "success"}
```

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**

- **`event_type`** (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π) - –£–Ω–∏–∫–∞–ª—å–Ω–æ–µ –∏–º—è —Å–æ–±—ã—Ç–∏—è
- **`notify`** (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é `False`) - –û—Ç–ø—Ä–∞–≤–ª—è—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –∞–¥–º–∏–Ω–∞–º –ø–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
- **`once_only`** (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é `True`) - –ï—Å–ª–∏ `True`, —Å–æ–±—ã—Ç–∏–µ –≤—ã–ø–æ–ª–Ω–∏—Ç—Å—è —Ç–æ–ª—å–∫–æ 1 —Ä–∞–∑ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- **`send_ai_response`** (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é `True`) - –ï—Å–ª–∏ `False`, –ò–ò –ù–ï –æ—Ç–ø—Ä–∞–≤–∏—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ –ø–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞

**–ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç:**

1. –ò–ò —Å–æ–∑–¥–∞–µ—Ç —Å–æ–±—ã—Ç–∏–µ –≤ JSON: `{"—Ç–∏–ø": "collect_phone", "–∏–Ω—Ñ–æ": "+79001234567"}`
2. –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è **–Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ**
3. –°–æ–±—ã—Ç–∏–µ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ –ë–î —Å–æ —Å—Ç–∞—Ç—É—Å–æ–º `completed`
4. –ï—Å–ª–∏ `once_only=True` - –ø–æ–≤—Ç–æ—Ä–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è –±–ª–æ–∫–∏—Ä—É—é—Ç—Å—è

**–ü—Ä–∏–º–µ—Ä—ã:**

```python
# –ë–∞–∑–æ–≤—ã–π –ø—Ä–∏–º–µ—Ä
@event_router.event_handler("collect_phone")
async def save_phone(user_id: int, phone_number: str):
    """–°–æ—Ö—Ä–∞–Ω—è–µ—Ç —Ç–µ–ª–µ—Ñ–æ–Ω –∫–ª–∏–µ–Ω—Ç–∞"""
    await send_message_by_human(
        user_id=user_id,
        message_text=f"‚úÖ –¢–µ–ª–µ—Ñ–æ–Ω {phone_number} —Å–æ—Ö—Ä–∞–Ω–µ–Ω"
    )
    return {"status": "success", "phone": phone_number}

# –° —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ–º –∞–¥–º–∏–Ω–æ–≤
@event_router.event_handler("new_lead", notify=True, once_only=True)
async def process_lead(user_id: int, lead_info: str):
    """–û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –Ω–æ–≤–æ–≥–æ –ª–∏–¥–∞"""
    # –ê–¥–º–∏–Ω—ã –ø–æ–ª—É—á–∞—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
    return {"status": "lead_created", "info": lead_info}

# –ú–æ–∂–µ—Ç –≤—ã–ø–æ–ª–Ω—è—Ç—å—Å—è –º–Ω–æ–≥–æ–∫—Ä–∞—Ç–Ω–æ
@event_router.event_handler("ask_question", once_only=False)
async def handle_question(user_id: int, question: str):
    """–û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –≤–æ–ø—Ä–æ—Å—ã (–º–æ–∂–µ—Ç –±—ã—Ç—å –º–Ω–æ–≥–æ)"""
    # –õ–æ–≥–∏–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏
    return {"status": "answered"}

# –ë–ï–ó –æ—Ç–ø—Ä–∞–≤–∫–∏ –æ—Ç–≤–µ—Ç–∞ –æ—Ç –ò–ò
@event_router.event_handler("silent_event", send_ai_response=False)
async def handle_silent(user_id: int, event_data: str):
    """
    –í—ã–ø–æ–ª–Ω—è–µ—Ç –ª–æ–≥–∏–∫—É –ë–ï–ó –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏—è –æ—Ç –ò–ò
    –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–æ–≥–¥–∞ —Ö–æ—Ç–∏—Ç–µ —Ç–æ–ª—å–∫–æ —Å–æ–±—Ä–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –±–µ–∑ –æ—Ç–≤–µ—Ç–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é
    """
    await send_message_by_human(user_id, "‚úÖ –î–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã")
    return {"status": "saved"}
```

---

### `schedule_task` - –ó–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∑–∞–¥–∞—á–∏

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –í—ã–ø–æ–ª–Ω—è—é—Ç—Å—è —á–µ—Ä–µ–∑ –∑–∞–¥–∞–Ω–Ω–æ–µ –≤—Ä–µ–º—è –ø–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è —Å–æ–±—ã—Ç–∏—è.

**–°–∏–≥–Ω–∞—Ç—É—Ä–∞:**

```python
@event_router.schedule_task(
    task_name: str,                     # –ù–∞–∑–≤–∞–Ω–∏–µ –∑–∞–¥–∞—á–∏
    delay: Union[str, int],             # –ó–∞–¥–µ—Ä–∂–∫–∞: "1h 30m" –∏–ª–∏ —Å–µ–∫—É–Ω–¥—ã
    notify: bool = False,               # –£–≤–µ–¥–æ–º–ª—è—Ç—å –∞–¥–º–∏–Ω–æ–≤
    smart_check: bool = True,           # –£–º–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏
    once_only: bool = True,             # –í—ã–ø–æ–ª–Ω—è—Ç—å —Ç–æ–ª—å–∫–æ 1 —Ä–∞–∑
    event_type: Union[str, Callable] = None,  # –ò—Å—Ç–æ—á–Ω–∏–∫ –≤—Ä–µ–º–µ–Ω–∏ —Å–æ–±—ã—Ç–∏—è
    send_ai_response: bool = True       # –û—Ç–ø—Ä–∞–≤–ª—è—Ç—å –æ—Ç–≤–µ—Ç –æ—Ç –ò–ò
)
async def handler(user_id: int, user_data: str):
    # –í–∞—à –∫–æ–¥
    return {"status": "sent"}
```

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**

- **`task_name`** (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π) - –£–Ω–∏–∫–∞–ª—å–Ω–æ–µ –∏–º—è –∑–∞–¥–∞—á–∏
- **`delay`** (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π) - –ó–∞–¥–µ—Ä–∂–∫–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è:
  - –°—Ç—Ä–æ–∫–∞: `"1h 30m"`, `"2h"`, `"45m"`, `"30s"`
  - –ß–∏—Å–ª–æ: `3600` (—Å–µ–∫—É–Ω–¥—ã)
- **`notify`** (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é `False`) - –£–≤–µ–¥–æ–º–ª—è—Ç—å –∞–¥–º–∏–Ω–æ–≤
- **`smart_check`** (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é `True`) - –£–º–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞:
  - –û—Ç–º–µ–Ω—è–µ—Ç –∑–∞–¥–∞—á—É –µ—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–µ—Ä–µ—à–µ–ª –Ω–∞ –Ω–æ–≤—ã–π —ç—Ç–∞–ø
  - –ü–µ—Ä–µ–Ω–æ—Å–∏—Ç –∑–∞–¥–∞—á—É –µ—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –±—ã–ª –∞–∫—Ç–∏–≤–µ–Ω
- **`once_only`** (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é `True`) - –í—ã–ø–æ–ª–Ω—è—Ç—å —Ç–æ–ª—å–∫–æ 1 —Ä–∞–∑ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- **`event_type`** (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) - –ò—Å—Ç–æ—á–Ω–∏–∫ –≤—Ä–µ–º–µ–Ω–∏ —Å–æ–±—ã—Ç–∏—è:
  - **–°—Ç—Ä–æ–∫–∞**: `"appointment_booking"` - –∏—â–µ—Ç —Å–æ–±—ã—Ç–∏–µ –≤ –ë–î –∏ –≤—ã—á–∏—Å–ª—è–µ—Ç –≤—Ä–µ–º—è
  - **–§—É–Ω–∫—Ü–∏—è**: `async def(user_id, user_data) -> datetime` - –∫–∞—Å—Ç–æ–º–Ω–∞—è –ª–æ–≥–∏–∫–∞
- **`send_ai_response`** (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é `True`) - –ï—Å–ª–∏ `False`, –ò–ò –ù–ï –æ—Ç–ø—Ä–∞–≤–∏—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ –ø–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∑–∞–¥–∞—á–∏

**–§–æ—Ä–º—É–ª–∞ –≤—Ä–µ–º–µ–Ω–∏ —Å `event_type`:**

```text
reminder_time = event_datetime - delay
```

**–ü—Ä–∏–º–µ—Ä—ã:**

```python
# –ü—Ä–æ—Å—Ç–æ–µ –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏–µ —á–µ—Ä–µ–∑ 24 —á–∞—Å–∞
@event_router.schedule_task("follow_up", delay="24h")
async def send_follow_up(user_id: int, reminder_text: str):
    """
    –ò–ò —Å–æ–∑–¥–∞–µ—Ç: {"—Ç–∏–ø": "follow_up", "–∏–Ω—Ñ–æ": "–ù–µ –∑–∞–±—É–¥—å—Ç–µ –ø—Ä–æ –∑–∞–ø–∏—Å—å"}
    –í—ã–ø–æ–ª–Ω–∏—Ç—Å—è —á–µ—Ä–µ–∑ 24 —á–∞—Å–∞
    """
    await send_message_by_human(
        user_id=user_id,
        message_text=f"üëã {reminder_text}"
    )
    return {"status": "sent"}

# –ù–∞–ø–æ–º–∏–Ω–∞–Ω–∏–µ –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ —Å–æ–±—ã—Ç–∏—è –∏–∑ –ë–î
@event_router.schedule_task(
    "booking_reminder",
    delay="2h",  # –ó–∞ 2 —á–∞—Å–∞ –¥–æ –∑–∞–ø–∏—Å–∏
    event_type="appointment_booking"  # –ò—â–µ—Ç –≤ –ë–î —Å–æ–±—ã—Ç–∏–µ —Ç–∏–ø–∞ "appointment_booking"
)
async def remind_booking(user_id: int, user_data: str):
    """
    –ò–ò —Å–æ–∑–¥–∞–µ—Ç —Å–æ–±—ã—Ç–∏–µ: {"—Ç–∏–ø": "appointment_booking", "–∏–Ω—Ñ–æ": "–¥–∞—Ç–∞: 2025-10-15, –≤—Ä–µ–º—è: 19:00"}
    –ó–∞—Ç–µ–º —Å–æ–∑–¥–∞–µ—Ç: {"—Ç–∏–ø": "booking_reminder", "–∏–Ω—Ñ–æ": ""}
    
    –õ–æ–≥–∏–∫–∞:
    1. –ù–∞—Ö–æ–¥–∏—Ç –≤ –ë–î –ø–æ—Å–ª–µ–¥–Ω–µ–µ —Å–æ–±—ã—Ç–∏–µ "appointment_booking" –¥–ª—è user_id
    2. –ü–∞—Ä—Å–∏—Ç –∏–∑ –Ω–µ–≥–æ datetime: 2025-10-15 19:00
    3. –í—ã—á–∏—Å–ª—è–µ—Ç: reminder_time = 19:00 - 2h = 17:00
    4. –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏–µ –≤ 17:00
    """
    await send_message_by_human(
        user_id=user_id,
        message_text="‚è∞ –ù–∞–ø–æ–º–∏–Ω–∞—é –æ –∑–∞–ø–∏—Å–∏ —á–µ—Ä–µ–∑ 2 —á–∞—Å–∞!"
    )
    return {"status": "sent"}

# –ù–∞–ø–æ–º–∏–Ω–∞–Ω–∏–µ —Å –∫–∞—Å—Ç–æ–º–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–µ–π –ø–æ–ª—É—á–µ–Ω–∏—è –≤—Ä–µ–º–µ–Ω–∏
async def get_booking_from_api(user_id: int, user_data: str) -> datetime:
    """–ü–æ–ª—É—á–∞–µ—Ç –≤—Ä–µ–º—è –∑–∞–ø–∏—Å–∏ –∏–∑ –≤–Ω–µ—à–Ω–µ–≥–æ API"""
    from yclients_api import get_next_booking
    booking = await get_next_booking(user_id)
    return booking['datetime']  # datetime –æ–±—ä–µ–∫—Ç

@event_router.schedule_task(
    "api_reminder",
    delay="1h",
    event_type=get_booking_from_api  # –§—É–Ω–∫—Ü–∏—è –≤–º–µ—Å—Ç–æ —Å—Ç—Ä–æ–∫–∏
)
async def send_api_reminder(user_id: int, user_data: str):
    """
    –ò–ò —Å–æ–∑–¥–∞–µ—Ç: {"—Ç–∏–ø": "api_reminder", "–∏–Ω—Ñ–æ": ""}
    
    –õ–æ–≥–∏–∫–∞:
    1. –í—ã–∑—ã–≤–∞–µ—Ç—Å—è get_booking_from_api(user_id, "")
    2. –§—É–Ω–∫—Ü–∏—è –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç datetime –∏–∑ API
    3. –í—ã—á–∏—Å–ª—è–µ—Ç—Å—è: reminder_time = api_datetime - 1h
    4. –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –≤ –≤—ã—á–∏—Å–ª–µ–Ω–Ω–æ–µ –≤—Ä–µ–º—è
    """
    await send_message_by_human(user_id, "‚è∞ –ù–∞–ø–æ–º–∏–Ω–∞–Ω–∏–µ –∏–∑ API!")
    return {"status": "sent"}

# –ë–µ–∑ smart_check (–æ—Ç–ø—Ä–∞–≤–∏—Ç—å –≤ –ª—é–±–æ–º —Å–ª—É—á–∞–µ)
@event_router.schedule_task("important_reminder", delay="12h", smart_check=False)
async def important_reminder(user_id: int, text: str):
    """–û—Ç–ø—Ä–∞–≤–∏—Ç—Å—è –≤ –ª—é–±–æ–º —Å–ª—É—á–∞–µ, –¥–∞–∂–µ –µ—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∞–∫—Ç–∏–≤–µ–Ω"""
    await send_message_by_human(user_id, f"üîî {text}")
    return {"status": "sent"}
```

---

### `global_handler` - –ì–ª–æ–±–∞–ª—å–Ω—ã–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –í—ã–ø–æ–ª–Ω—è—é—Ç—Å—è –¥–ª—è –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ.

**–°–∏–≥–Ω–∞—Ç—É—Ä–∞:**

```python
@event_router.global_handler(
    handler_type: str,                  # –¢–∏–ø –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞
    delay: Union[str, int],             # –ó–∞–¥–µ—Ä–∂–∫–∞
    notify: bool = False,               # –£–≤–µ–¥–æ–º–ª—è—Ç—å –∞–¥–º–∏–Ω–æ–≤
    once_only: bool = True,             # –í—ã–ø–æ–ª–Ω—è—Ç—å —Ç–æ–ª—å–∫–æ 1 —Ä–∞–∑
    event_type: Union[str, Callable] = None,  # –ò—Å—Ç–æ—á–Ω–∏–∫ –≤—Ä–µ–º–µ–Ω–∏
    send_ai_response: bool = True       # –û—Ç–ø—Ä–∞–≤–ª—è—Ç—å –æ—Ç–≤–µ—Ç –æ—Ç –ò–ò
)
async def handler(handler_data: str):
    # –í–∞—à –∫–æ–¥
    return {"status": "sent"}
```

**–û—Ç–ª–∏—á–∏—è –æ—Ç `schedule_task`:**

- **–ù–µ—Ç `user_id`** - —Ä–∞–±–æ—Ç–∞–µ—Ç –≥–ª–æ–±–∞–ª—å–Ω–æ
- **–ù–µ—Ç `smart_check`** - –Ω–µ –ø—Ä–∏–≤—è–∑–∞–Ω –∫ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- –û–¥–Ω–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ = –æ–¥–Ω–∞ —Ä–∞—Å—Å—ã–ª–∫–∞ –≤—Å–µ–º

**–ü—Ä–∏–º–µ—Ä—ã:**

```python
# –†–∞—Å—Å—ã–ª–∫–∞ –≤—Å–µ–º —á–µ—Ä–µ–∑ 2 —á–∞—Å–∞
@event_router.global_handler("promo_announcement", delay="2h", notify=True)
async def send_promo(announcement_text: str):
    """
    –ò–ò —Å–æ–∑–¥–∞–µ—Ç: {"—Ç–∏–ø": "promo_announcement", "–∏–Ω—Ñ–æ": "–°–∫–∏–¥–∫–∞ 20%!"}
    –û—Ç–ø—Ä–∞–≤–∏—Ç—Å—è –≤—Å–µ–º —á–µ—Ä–µ–∑ 2 —á–∞—Å–∞
    """
    await send_message_to_users_by_stage(
        stage="all",
        message_text=f"üéâ {announcement_text}",
        bot_id="my-bot"
    )
    return {"status": "sent", "recipients": "all"}

# –° –∫–∞—Å—Ç–æ–º–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–µ–π –≤—Ä–µ–º–µ–Ω–∏
async def get_promo_end_time(handler_data: str) -> datetime:
    """–ü–æ–ª—É—á–∞–µ—Ç –≤—Ä–µ–º—è –æ–∫–æ–Ω—á–∞–Ω–∏—è –∞–∫—Ü–∏–∏ –∏–∑ CRM"""
    from crm_api import get_active_promo
    promo = await get_active_promo()
    return promo['end_datetime']

@event_router.global_handler(
    "promo_ending_notification",
    delay="2h",
    event_type=get_promo_end_time
)
async def notify_promo_ending(handler_data: str):
    """–£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –≤—Å–µ–º –∑–∞ 2 —á–∞—Å–∞ –¥–æ –æ–∫–æ–Ω—á–∞–Ω–∏—è –∞–∫—Ü–∏–∏"""
    await send_message_to_users_by_stage(
        stage="all",
        message_text="‚è∞ –ê–∫—Ü–∏—è –∑–∞–∫–∞–Ω—á–∏–≤–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ 2 —á–∞—Å–∞!",
        bot_id="my-bot"
    )
    return {"status": "sent"}
```

---

## üé£ –•—É–∫–∏ –¥–ª—è –∫–∞—Å—Ç–æ–º–∏–∑–∞—Ü–∏–∏

–•—É–∫–∏ –ø–æ–∑–≤–æ–ª—è—é—Ç –≤–Ω–µ–¥—Ä—è—Ç—å —Å–≤–æ—é –ª–æ–≥–∏–∫—É –≤ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—É—é –æ–±—Ä–∞–±–æ—Ç–∫—É —Å–æ–æ–±—â–µ–Ω–∏–π –±–µ–∑ –ø–µ—Ä–µ–ø–∏—Å—ã–≤–∞–Ω–∏—è –≤—Å–µ–π —Ñ—É–Ω–∫—Ü–∏–∏.

### –î–æ—Å—Ç—É–ø–Ω—ã–µ —Ö—É–∫–∏

```python
bot_builder = BotBuilder("my-bot")

# 1. –í–∞–ª–∏–¥–∞—Ü–∏—è —Å–æ–æ–±—â–µ–Ω–∏—è (–î–û –æ–±—Ä–∞–±–æ—Ç–∫–∏ AI)
@bot_builder.validate_message
async def check_spam(message_text: str, message_obj):
    if "—Å–ø–∞–º" in message_text.lower():
        await message_obj.answer("‚õî –°–ø–∞–º –∑–∞–ø—Ä–µ—â–µ–Ω")
        return False  # –ë–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫—É
    return True  # –ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å

# 2. –û–±–æ–≥–∞—â–µ–Ω–∏–µ —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –ø—Ä–æ–º–ø—Ç–∞
@bot_builder.enrich_prompt
async def add_client_info(system_prompt: str, user_id: int):
    session = await supabase_client.get_active_session(user_id)
    phone = session.get('metadata', {}).get('phone')
    
    if phone:
        return f"{system_prompt}\n\n–¢–µ–ª–µ—Ñ–æ–Ω –∫–ª–∏–µ–Ω—Ç–∞: {phone}"
    return system_prompt

# 3. –û–±–æ–≥–∞—â–µ–Ω–∏–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ –¥–ª—è AI
@bot_builder.enrich_context
async def add_external_data(messages: list):
    # –î–æ–±–∞–≤–ª—è–µ–º –¥–∞–Ω–Ω—ã–µ –∏–∑ –≤–Ω–µ—à–Ω–µ–≥–æ API
    messages.append({
        "role": "system",
        "content": "–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –∏–∑ CRM..."
    })
    return messages

# 4. –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—Ç–≤–µ—Ç–∞ AI
@bot_builder.process_response
async def modify_response(response_text: str, ai_metadata: dict, user_id: int):
    # –ú–æ–¥–∏—Ñ–∏—Ü–∏—Ä—É–µ–º –æ—Ç–≤–µ—Ç
    if "—Ü–µ–Ω–∞" in response_text.lower():
        response_text += "\n\nüí∞ –ê–∫—Ç—É–∞–ª—å–Ω—ã–µ —Ü–µ–Ω—ã –Ω–∞ —Å–∞–π—Ç–µ"
    return response_text, ai_metadata

# 5. –§–∏–ª—å—Ç—Ä—ã –æ—Ç–ø—Ä–∞–≤–∫–∏
@bot_builder.filter_send
async def block_during_booking(user_id: int):
    if is_processing_booking(user_id):
        return True  # –ë–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å –æ—Ç–ø—Ä–∞–≤–∫—É
    return False  # –†–∞–∑—Ä–µ—à–∏—Ç—å

# 6. –ö–∞—Å—Ç–æ–º–Ω–∞—è –ª–æ–≥–∏–∫–∞ –ø–æ—Å–ª–µ /start
@bot_builder.on_start
async def custom_start(user_id: int, session_id: str, message, state):
    """–í—ã–∑—ã–≤–∞–µ—Ç—Å—è –ü–û–°–õ–ï —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–≥–æ /start"""
    keyboard = InlineKeyboardMarkup(...)
    await message.answer("–í—ã–±–µ—Ä–∏—Ç–µ –¥–µ–π—Å—Ç–≤–∏–µ:", reply_markup=keyboard)
```

---

## üì± Telegram —Ä–æ—É—Ç–µ—Ä—ã

–ü–æ–¥–∫–ª—é—á–∞–π—Ç–µ —á–∏—Å—Ç—ã–µ `aiogram.Router` –¥–ª—è –∫–∞—Å—Ç–æ–º–Ω—ã—Ö –∫–æ–º–∞–Ω–¥, callback'–æ–≤ –∏ —Ñ–∏–ª—å—Ç—Ä–æ–≤.

### –°–æ–∑–¥–∞–Ω–∏–µ —Ä–æ—É—Ç–µ—Ä–∞

```python
from aiogram import Router, F
from aiogram.filters import Command
from aiogram.types import Message, CallbackQuery, InlineKeyboardMarkup, InlineKeyboardButton

# –°–æ–∑–¥–∞–µ–º aiogram Router
telegram_router = Router(name="my_commands")

@telegram_router.message(Command("price", "—Ü–µ–Ω–∞"))
async def price_handler(message: Message):
    """–ö–æ–º–∞–Ω–¥–∞ /price"""
    await message.answer(
        "üí∞ –ù–∞—à–∏ —Ü–µ–Ω—ã:\n"
        "‚Ä¢ –£—Å–ª—É–≥–∞ 1 - 1000‚ÇΩ\n"
        "‚Ä¢ –£—Å–ª—É–≥–∞ 2 - 2000‚ÇΩ"
    )

@telegram_router.message(Command("catalog"))
async def catalog_handler(message: Message):
    """–ö–æ–º–∞–Ω–¥–∞ /catalog —Å –∫–Ω–æ–ø–∫–∞–º–∏"""
    keyboard = InlineKeyboardMarkup(inline_keyboard=[
        [InlineKeyboardButton(text="üî• –ê–∫—Ü–∏–∏", callback_data="promo")],
        [InlineKeyboardButton(text="üìÖ –ó–∞–ø–∏—Å–∞—Ç—å—Å—è", callback_data="book")]
    ])
    await message.answer("–í—ã–±–µ—Ä–∏—Ç–µ:", reply_markup=keyboard)

@telegram_router.callback_query(F.data == "book")
async def handle_booking(callback: CallbackQuery):
    """–û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–Ω–æ–ø–∫–∏"""
    await callback.answer("–ó–∞–ø–∏—Å—ã–≤–∞—é...")
    await callback.message.answer("–ù–∞–ø–∏—à–∏—Ç–µ –∂–µ–ª–∞–µ–º—É—é –¥–∞—Ç—É")

@telegram_router.message(F.text.lower().contains("–ø–æ–º–æ—â—å"))
async def help_handler(message: Message):
    """–†–µ–∞–≥–∏—Ä—É–µ—Ç –Ω–∞ —Å–ª–æ–≤–æ '–ø–æ–º–æ—â—å'"""
    await message.answer("–ß–µ–º –º–æ–≥—É –ø–æ–º–æ—á—å?")

# –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –≤ –±–æ—Ç–µ
bot_builder.register_telegram_router(telegram_router)
```

### –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω–∞—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è

```python
commands_router = Router(name="commands")
callbacks_router = Router(name="callbacks")
filters_router = Router(name="filters")

# –†–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ–º –≤—Å–µ —Å—Ä–∞–∑—É
bot_builder.register_telegram_routers(
    commands_router,
    callbacks_router,
    filters_router
)
```

**‚ö†Ô∏è –í–∞–∂–Ω–æ:** –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ —Ä–æ—É—Ç–µ—Ä—ã –ø–æ–¥–∫–ª—é—á–∞—é—Ç—Å—è **–ü–ï–†–í–´–ú–ò** (–≤—ã—Å—à–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç), –ø–æ—ç—Ç–æ–º—É –≤–∞—à–∏ –∫–æ–º–∞–Ω–¥—ã –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è —Ä–∞–Ω—å—à–µ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã—Ö.

---

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

–°–∏—Å—Ç–µ–º–∞ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –ø–æ–∑–≤–æ–ª—è–µ—Ç –ø—Ä–æ–≤–µ—Ä—è—Ç—å —Ä–∞–±–æ—Ç—É –±–æ—Ç–∞ —á–µ—Ä–µ–∑ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏. –¢–µ—Å—Ç—ã –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ, –∫–∞–∂–¥—ã–π —à–∞–≥ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –æ—Ç–≤–µ—Ç –±–æ—Ç–∞ –Ω–∞ –Ω–∞–ª–∏—á–∏–µ –æ–∂–∏–¥–∞–µ–º—ã—Ö –∫–ª—é—á–µ–≤—ã—Ö —Å–ª–æ–≤ –∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –∑–∞–ø—Ä–µ—â–µ–Ω–Ω—ã—Ö.

### –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤

```bash
# –ó–∞–ø—É—Å—Ç–∏—Ç—å –≤—Å–µ —Ç–µ—Å—Ç—ã –∏–∑ –ø–∞–ø–∫–∏ bots/my-bot/tests/
sbf test my-bot

# –ö–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π —Ñ–∞–π–ª —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤
sbf test my-bot --file test_booking.yaml

# –ü–æ–¥—Ä–æ–±–Ω—ã–π –≤—ã–≤–æ–¥ (verbose)
sbf test my-bot -v

# –£–≤–µ–ª–∏—á–∏—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã—Ö –ø–æ—Ç–æ–∫–æ–≤ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 5)
sbf test my-bot --max-concurrent 10
```

**–ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç:**

1. –ö–æ–º–∞–Ω–¥–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–≥—Ä—É–∂–∞–µ—Ç —Ñ–∞–π–ª –±–æ—Ç–∞ (`my-bot.py`)
2. –í—ã–ø–æ–ª–Ω—è–µ—Ç —Ñ—É–Ω–∫—Ü–∏—é `main()` –¥–ª—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –≤—Å–µ—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
3. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤—ã–∑—ã–≤–∞–µ—Ç `build()` –µ—Å–ª–∏ –Ω—É–∂–Ω–æ
4. –ó–∞–ø—É—Å–∫–∞–µ—Ç —Ç–µ—Å—Ç—ã —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –≤—Å–µ—Ö –Ω–∞—Å—Ç—Ä–æ–µ–∫ –±–æ—Ç–∞ (—Ä–æ—É—Ç–µ—Ä—ã, –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã, —Ö—É–∫–∏)
5. –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –æ—Ç—á–µ—Ç—ã –≤ `bots/my-bot/reports/`

### –§–æ—Ä–º–∞—Ç —Ç–µ—Å—Ç–æ–≤ (YAML)

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª–∞:**

```yaml
# bots/my-bot/tests/test_booking.yaml
scenarios:
  - name: "–ù–∞–∑–≤–∞–Ω–∏–µ —Å—Ü–µ–Ω–∞—Ä–∏—è"
    steps:
      - user_input: "–í–æ–ø—Ä–æ—Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è"
        expected_keywords:
          - ["—Å–∏–Ω–æ–Ω–∏–º1", "—Å–∏–Ω–æ–Ω–∏–º2"]  # –ì—Ä—É–ø–ø–∞ —Å–∏–Ω–æ–Ω–∏–º–æ–≤
          - "–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ —Å–ª–æ–≤–æ"       # –û–¥–∏–Ω–æ—á–Ω–æ–µ —Å–ª–æ–≤–æ
        forbidden_keywords:
          - "–∑–∞–ø—Ä–µ—â–µ–Ω–Ω–æ–µ —Å–ª–æ–≤–æ"        # –°–ª–æ–≤–∞, –∫–æ—Ç–æ—Ä—ã—Ö –ù–ï –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å
      
      - user_input: "–°–ª–µ–¥—É—é—â–∏–π –≤–æ–ø—Ä–æ—Å"
        expected_keywords:
          - ["–∑–∞–ø–∏—Å—å", "–∑–∞–ø–∏—Å–∞—Ç—å—Å—è"]
          - "–¥–∞—Ç–∞"
        forbidden_keywords: []  # –ú–æ–∂–Ω–æ –æ—Å—Ç–∞–≤–∏—Ç—å –ø—É—Å—Ç—ã–º
```

**–ü–æ–ª–Ω—ã–π –ø—Ä–∏–º–µ—Ä:**

```yaml
# bots/my-bot/tests/quick_scenarios.yaml
scenarios:
  - name: "–ù–æ–≤—ã–π –ø–∞—Ü–∏–µ–Ω—Ç"
    steps:
      - user_input: "–ü—Ä–∏–≤–µ—Ç, —Ö–æ—á—É –∑–∞–ø–∏—Å–∞—Ç—å—Å—è –Ω–∞ –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏—é"
        expected_keywords:
          - ["–ø—Ä–∏–≤–µ—Ç", "–∑–¥—Ä–∞–≤—Å—Ç–≤—É–π—Ç–µ", "–¥–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å"]
          - ["–∑–∞–ø–∏—Å—å", "–∑–∞–ø–∏—Å–∞—Ç—å—Å—è", "–∑–∞–ø–∏—Å–∞—Ç—å—Å—è –Ω–∞ –ø—Ä–∏–µ–º"]
          - ["–∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏—è", "–ø—Ä–∏–µ–º", "–≤–∏–∑–∏—Ç"]
        forbidden_keywords:
          - "–æ—à–∏–±–∫–∞"
          - "–Ω–µ –º–æ–≥—É"
      
      - user_input: "–ö–∞–∫–∏–µ —É –≤–∞—Å —Ü–µ–Ω—ã?"
        expected_keywords:
          - ["—Ü–µ–Ω–∞", "—Å—Ç–æ–∏–º–æ—Å—Ç—å", "—Å—Ç–æ–∏—Ç", "—Å–∫–æ–ª—å–∫–æ"]
          - ["—É—Å–ª—É–≥", "–ø—Ä–æ—Ü–µ–¥—É—Ä", "–ø—Ä–∏–µ–º"]
        forbidden_keywords:
          - "–Ω–µ –∑–Ω–∞—é"
          - "–Ω–µ–∏–∑–≤–µ—Å—Ç–Ω–æ"
      
      - user_input: "–ö–æ–≥–¥–∞ –º–æ–∂–Ω–æ –ø—Ä–∏–π—Ç–∏?"
        expected_keywords:
          - ["–∫–æ–≥–¥–∞", "–¥–∞—Ç–∞", "–≤—Ä–µ–º—è", "—Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ"]
          - ["–ø—Ä–∏–π—Ç–∏", "–ø—Ä–∏–µ—Ö–∞—Ç—å", "–∑–∞–ø–∏—Å–∞—Ç—å—Å—è"]
        forbidden_keywords: []

  - name: "–°—Ç—É–¥–µ–Ω—Ç —Å–ø—Ä–∞—à–∏–≤–∞–µ—Ç –ø—Ä–æ —Å–∫–∏–¥–∫–∏"
    steps:
      - user_input: "–Ø —Å—Ç—É–¥–µ–Ω—Ç, –µ—Å—Ç—å –ª–∏ —Å–∫–∏–¥–∫–∏?"
        expected_keywords:
          - ["—Å—Ç—É–¥–µ–Ω—Ç", "–æ–±—É—á–∞—é—â–∏–π—Å—è"]
          - ["—Å–∫–∏–¥–∫–∏", "–ª—å–≥–æ—Ç—ã", "–ø—Ä–µ—Ñ–µ—Ä–µ–Ω—Ü–∏–∏"]
          - ["–µ—Å—Ç—å", "–ø—Ä–µ–¥—É—Å–º–æ—Ç—Ä–µ–Ω—ã", "–¥–æ—Å—Ç—É–ø–Ω—ã"]
        forbidden_keywords:
          - "–ø–æ–ª–Ω–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å"
          - "–±–µ–∑ —Å–∫–∏–¥–æ–∫"
```

### –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Å–∏–Ω–æ–Ω–∏–º–æ–≤

–°–∏—Å—Ç–µ–º–∞ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –≥–∏–±–∫—É—é –ø—Ä–æ–≤–µ—Ä–∫—É –∫–ª—é—á–µ–≤—ã—Ö —Å–ª–æ–≤ —á–µ—Ä–µ–∑ —Å–∏–Ω–æ–Ω–∏–º—ã:

```yaml
expected_keywords:
  # –û–¥–∏–Ω–æ—á–Ω–æ–µ —Å–ª–æ–≤–æ - –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –Ω–∞–π–¥–µ–Ω–æ —Ç–æ—á–Ω–æ
  - "–ø—Ä–∏–≤–µ—Ç"
  
  # –ì—Ä—É–ø–ø–∞ —Å–∏–Ω–æ–Ω–∏–º–æ–≤ - –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –Ω–∞–π—Ç–∏ –õ–Æ–ë–û–ï –∏–∑ —Å–ª–æ–≤
  - ["–ø—Ä–∏–≤–µ—Ç", "–∑–¥—Ä–∞–≤—Å—Ç–≤—É–π—Ç–µ", "–¥–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å"]
  
  # –°–º–µ—à–∞–Ω–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç - –∫–æ–º–±–∏–Ω–∞—Ü–∏—è –æ–¥–∏–Ω–æ—á–Ω—ã—Ö —Å–ª–æ–≤ –∏ –≥—Ä—É–ø–ø
  - "–ø–æ–º–æ—á—å"
  - ["–∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è", "–¥–∞–Ω–Ω—ã–µ", "–ø–æ–¥—Ä–æ–±–Ω–æ—Å—Ç–∏"]
  - "–∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏—è"
```

**–ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç –ø—Ä–æ–≤–µ—Ä–∫–∞:**

1. –î–ª—è –∫–∞–∂–¥–æ–π –≥—Ä—É–ø–ø—ã —Å–∏–Ω–æ–Ω–∏–º–æ–≤: –µ—Å–ª–∏ –Ω–∞–π–¥–µ–Ω–æ **—Ö–æ—Ç—è –±—ã –æ–¥–Ω–æ** —Å–ª–æ–≤–æ - –≥—Ä—É–ø–ø–∞ —Å—á–∏—Ç–∞–µ—Ç—Å—è –Ω–∞–π–¥–µ–Ω–Ω–æ–π
2. –î–ª—è –æ–¥–∏–Ω–æ—á–Ω—ã—Ö —Å–ª–æ–≤: —Å–ª–æ–≤–æ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –Ω–∞–π–¥–µ–Ω–æ —Ç–æ—á–Ω–æ
3. –®–∞–≥ —Å—á–∏—Ç–∞–µ—Ç—Å—è –ø—Ä–æ–π–¥–µ–Ω–Ω—ã–º, –µ—Å–ª–∏ –Ω–∞–π–¥–µ–Ω—ã **–≤—Å–µ** –≥—Ä—É–ø–ø—ã/—Å–ª–æ–≤–∞ –∏–∑ `expected_keywords` –∏ **–Ω–µ –Ω–∞–π–¥–µ–Ω—ã** —Å–ª–æ–≤–∞ –∏–∑ `forbidden_keywords`

### –ó–∞–ø—Ä–µ—â–µ–Ω–Ω—ã–µ –∫–ª—é—á–µ–≤—ã–µ —Å–ª–æ–≤–∞

`forbidden_keywords` - —Å–ª–æ–≤–∞, –∫–æ—Ç–æ—Ä—ã—Ö **–Ω–µ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å** –≤ –æ—Ç–≤–µ—Ç–µ –±–æ—Ç–∞:

```yaml
forbidden_keywords:
  - "–æ—à–∏–±–∫–∞"
  - "–Ω–µ –º–æ–≥—É"
  - "–Ω–µ –∑–Ω–∞—é"
  - ["–ø–æ–∑–¥–Ω–æ", "–Ω–µ —É—Å–ø–µ–µ—Ç–µ", "–≤—Ä–µ–º—è –≤—ã—à–ª–æ"]  # –ì—Ä—É–ø–ø–∞ –∑–∞–ø—Ä–µ—â–µ–Ω–Ω—ã—Ö —Å–ª–æ–≤
```

–ï—Å–ª–∏ —Ö–æ—Ç—è –±—ã –æ–¥–Ω–æ –∑–∞–ø—Ä–µ—â–µ–Ω–Ω–æ–µ —Å–ª–æ–≤–æ –Ω–∞–π–¥–µ–Ω–æ - —à–∞–≥ —Å—á–∏—Ç–∞–µ—Ç—Å—è –ø—Ä–æ–≤–∞–ª–µ–Ω–Ω—ã–º.

### –û—Ç—á–µ—Ç—ã

–ü–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Ç–µ—Å—Ç–æ–≤ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≥–µ–Ω–µ—Ä–∏—Ä—É—é—Ç—Å—è –æ—Ç—á–µ—Ç—ã:

**–ö–æ–Ω—Å–æ–ª—å–Ω—ã–π –æ—Ç—á–µ—Ç:**
```
üìä –†–ï–ó–£–õ–¨–¢–ê–¢–´: MY-BOT
‚úÖ –°—Ü–µ–Ω–∞—Ä–∏–µ–≤ –ø—Ä–æ–π–¥–µ–Ω–æ: 8/10 (80.0%)
üìù –®–∞–≥–æ–≤ –ø—Ä–æ–π–¥–µ–Ω–æ: 45/50 (90.0%)
```

**–ü–æ–¥—Ä–æ–±–Ω—ã–π –æ—Ç—á–µ—Ç –≤ —Ñ–∞–π–ª–µ:**
- –°–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ `bots/my-bot/reports/test_YYYYMMDD_HHMMSS.txt`
- –°–æ–¥–µ—Ä–∂–∏—Ç –ø–æ–ª–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã –±–æ—Ç–∞ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —à–∞–≥–∞
- –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞–π–¥–µ–Ω–Ω—ã–µ –∏ –ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã–µ –∫–ª—é—á–µ–≤—ã–µ —Å–ª–æ–≤–∞
- –£–∫–∞–∑—ã–≤–∞–µ—Ç –∑–∞–ø—Ä–µ—â–µ–Ω–Ω—ã–µ —Å–ª–æ–≤–∞, –µ—Å–ª–∏ –æ–Ω–∏ –±—ã–ª–∏ –Ω–∞–π–¥–µ–Ω—ã

### –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

1. **–°–æ–∑–¥–∞–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤–æ–π —Å–µ—Å—Å–∏–∏** - –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Å—Ü–µ–Ω–∞—Ä–∏—è —Å–æ–∑–¥–∞–µ—Ç—Å—è —É–Ω–∏–∫–∞–ª—å–Ω–∞—è —Å–µ—Å—Å–∏—è –≤ Supabase
2. **–ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ —à–∞–≥–æ–≤** - –∫–∞–∂–¥—ã–π —à–∞–≥ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –±–æ—Ç—É –∏ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è –æ—Ç–≤–µ—Ç
3. **–ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–ª—é—á–µ–≤—ã—Ö —Å–ª–æ–≤** - —Å–∏—Å—Ç–µ–º–∞ –∏—â–µ—Ç –æ–∂–∏–¥–∞–µ–º—ã–µ —Å–ª–æ–≤–∞ –∏ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –∑–∞–ø—Ä–µ—â–µ–Ω–Ω—ã—Ö
4. **–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –æ—Ç—á–µ—Ç–∞** - —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ —Ñ–∞–π–ª –∏ –≤—ã–≤–æ–¥—è—Ç—Å—è –≤ –∫–æ–Ω—Å–æ–ª—å

**–í–∞–∂–Ω–æ:**

- –ö–∞–∂–¥—ã–π —Å—Ü–µ–Ω–∞—Ä–∏–π –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–π —Å–µ—Å—Å–∏–∏
- –¢–µ—Å—Ç—ã –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 5 –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ)
- –ò—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è —Ä–µ–∞–ª—å–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –±–æ—Ç–∞ (OpenAI, Supabase, –ø—Ä–æ–º–ø—Ç—ã)
- –í—Å–µ —Ö—É–∫–∏ –∏ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Ä–∞–±–æ—Ç–∞—é—Ç –∫–∞–∫ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –±–æ—Ç–µ

### –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

**–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —Å—Ü–µ–Ω–∞—Ä–∏—è:**

```bash
sbf test my-bot --file booking_scenarios.yaml
```

**–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å –ø–æ–¥—Ä–æ–±–Ω—ã–º –≤—ã–≤–æ–¥–æ–º:**

```bash
sbf test my-bot -v
```

–í—ã —É–≤–∏–¥–∏—Ç–µ:
- –ö–∞–∂–¥—ã–π —à–∞–≥ —Ç–µ—Å—Ç–∞
- –û—Ç–≤–µ—Ç –±–æ—Ç–∞ –Ω–∞ –∫–∞–∂–¥–æ–º —à–∞–≥–µ
- –ù–∞–π–¥–µ–Ω–Ω—ã–µ –∏ –ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã–µ –∫–ª—é—á–µ–≤—ã–µ —Å–ª–æ–≤–∞
- –í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∫–∞–∂–¥–æ–≥–æ —à–∞–≥–∞

**–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ CI/CD:**

```bash
# –í —Å–∫—Ä–∏–ø—Ç–µ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏
sbf test my-bot --max-concurrent 10

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–¥–∞ –≤—ã—Ö–æ–¥–∞
if [ $? -ne 0 ]; then
    echo "–¢–µ—Å—Ç—ã –ø—Ä–æ–≤–∞–ª–µ–Ω—ã"
    exit 1
fi
```

---

## üîÑ –ú–∏–≥—Ä–∞—Ü–∏—è —Å –ø—Ä–æ—à–ª–æ–π –≤–µ—Ä—Å–∏–∏

### –û—Å–Ω–æ–≤–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è

1. **–ù–æ–≤–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å BotBuilder**
   - –í—Å–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É—é—Ç—Å—è —á–µ—Ä–µ–∑ `BotBuilder`
   - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏ `start()`
   - –¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤—Å–µ–º–∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞–º–∏

2. **–†–æ—É—Ç–µ—Ä—ã –≤–º–µ—Å—Ç–æ –≥–ª–æ–±–∞–ª—å–Ω—ã—Ö –¥–µ–∫–æ—Ä–∞—Ç–æ—Ä–æ–≤**
   - `EventRouter` –¥–ª—è —Å–æ–±—ã—Ç–∏–π, –∑–∞–¥–∞—á –∏ –≥–ª–æ–±–∞–ª—å–Ω—ã—Ö –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤
   - `RagRouter` –¥–ª—è RAG-–∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤
   - `ToolRouter` –¥–ª—è –æ–±—ã—á–Ω—ã—Ö –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤
   - –ù–µ—Å–∫–æ–ª—å–∫–æ —Ä–æ—É—Ç–µ—Ä–æ–≤ –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ

3. **–£–ª—É—á—à–µ–Ω–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ**
   - –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —á–µ—Ä–µ–∑ CLI –∫–æ–º–∞–Ω–¥—É `sbf test`
   - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –≤—Å–µ—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
   - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –Ω–∞—Å—Ç—Ä–æ–µ–∫ –±–æ—Ç–∞ (—Ä–æ—É—Ç–µ—Ä—ã, –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã, —Ö—É–∫–∏)

4. **–ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ —Å—Ç—Ä—É–∫—Ç—É—Ä–µ –∫–æ–¥–∞**
   - –û–±—è–∑–∞—Ç–µ–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è `main()` –¥–ª—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
   - –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è —Ä–æ—É—Ç–µ—Ä–æ–≤ —á–µ—Ä–µ–∑ `bot_builder.register_routers()`
   - –ó–∞–ø—É—Å–∫ —á–µ—Ä–µ–∑ `await bot_builder.start()`

### –ü–æ—à–∞–≥–æ–≤–∞—è –º–∏–≥—Ä–∞—Ü–∏—è

#### –®–∞–≥ 1: –ò–∑–º–µ–Ω–µ–Ω–∏–µ –∏–º–ø–æ—Ä—Ç–æ–≤

**–ë—ã–ª–æ:**
```python
from smart_bot_factory.core.decorators import (
    event_handler,
    schedule_task,
    global_handler
)
```

**–°—Ç–∞–ª–æ:**
```python
from smart_bot_factory.router import EventRouter
from smart_bot_factory.creation import BotBuilder
```

#### –®–∞–≥ 2: –°–æ–∑–¥–∞–Ω–∏–µ —Ä–æ—É—Ç–µ—Ä–∞ –∏ BotBuilder

**–ë—ã–ª–æ:**
```python
# –î–µ–∫–æ—Ä–∞—Ç–æ—Ä—ã —Ä–∞–±–æ—Ç–∞–ª–∏ –≥–ª–æ–±–∞–ª—å–Ω–æ
@event_handler("collect_phone")
async def handle_phone(user_id: int, phone: str):
    pass
```

**–°—Ç–∞–ª–æ:**
```python
# –°–æ–∑–¥–∞–µ–º —Ä–æ—É—Ç–µ—Ä –∏ BotBuilder
event_router = EventRouter("my-bot")
bot_builder = BotBuilder("my-bot")

# –ò—Å–ø–æ–ª—å–∑—É–µ–º –¥–µ–∫–æ—Ä–∞—Ç–æ—Ä—ã —Ä–æ—É—Ç–µ—Ä–∞
@event_router.event_handler("collect_phone")
async def handle_phone(user_id: int, phone: str):
    pass
```

#### –®–∞–≥ 3: –ú–∏–≥—Ä–∞—Ü–∏—è event_handler

**–ë—ã–ª–æ:**
```python
from smart_bot_factory.core.decorators import event_handler

@event_handler("collect_phone", notify=True, once_only=True)
async def handle_phone(user_id: int, phone: str):
    await send_message_by_human(user_id, f"‚úÖ –¢–µ–ª–µ—Ñ–æ–Ω {phone} —Å–æ—Ö—Ä–∞–Ω–µ–Ω")
    return {"status": "success"}
```

**–°—Ç–∞–ª–æ:**
```python
from smart_bot_factory.router import EventRouter
from smart_bot_factory.creation import BotBuilder

event_router = EventRouter("my-bot")
bot_builder = BotBuilder("my-bot")

@event_router.event_handler("collect_phone", notify=True, once_only=True)
async def handle_phone(user_id: int, phone: str):
    await send_message_by_human(user_id, f"‚úÖ –¢–µ–ª–µ—Ñ–æ–Ω {phone} —Å–æ—Ö—Ä–∞–Ω–µ–Ω")
    return {"status": "success"}
```

**‚úÖ –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –æ—Å—Ç–∞–ª–∏—Å—å —Ç–µ –∂–µ:** `notify`, `once_only`, `send_ai_response`

#### –®–∞–≥ 4: –ú–∏–≥—Ä–∞—Ü–∏—è schedule_task

**–ë—ã–ª–æ:**
```python
from smart_bot_factory.core.decorators import schedule_task

@schedule_task("follow_up", delay="24h", smart_check=True)
async def send_follow_up(user_id: int, reminder_text: str):
    await send_message_by_human(user_id, f"üëã {reminder_text}")
    return {"status": "sent"}
```

**–°—Ç–∞–ª–æ:**
```python
@event_router.schedule_task("follow_up", delay="24h", smart_check=True)
async def send_follow_up(user_id: int, reminder_text: str):
    await send_message_by_human(user_id, f"üëã {reminder_text}")
    return {"status": "sent"}
```

**‚úÖ –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –æ—Å—Ç–∞–ª–∏—Å—å —Ç–µ –∂–µ:** `delay`, `smart_check`, `once_only`, `notify`, `event_type`, `send_ai_response`

#### –®–∞–≥ 5: –ú–∏–≥—Ä–∞—Ü–∏—è global_handler

**–ë—ã–ª–æ:**
```python
from smart_bot_factory.core.decorators import global_handler

@global_handler("promo_announcement", delay="2h", notify=True)
async def send_promo(announcement_text: str):
    await send_message_to_users_by_stage(
        stage="all",
        message_text=f"üéâ {announcement_text}",
        bot_id="my-bot"
    )
    return {"status": "sent"}
```

**–°—Ç–∞–ª–æ:**
```python
@event_router.global_handler("promo_announcement", delay="2h", notify=True)
async def send_promo(announcement_text: str):
    await send_message_to_users_by_stage(
        stage="all",
        message_text=f"üéâ {announcement_text}",
        bot_id="my-bot"
    )
    return {"status": "sent"}
```

**‚úÖ –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –æ—Å—Ç–∞–ª–∏—Å—å —Ç–µ –∂–µ:** `delay`, `once_only`, `notify`, `event_type`, `send_ai_response`

#### –®–∞–≥ 6: –ò–∑–º–µ–Ω–µ–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏ main()

**–ë—ã–ª–æ:**
```python
async def main():
    # –†—É—á–Ω–∞—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
    from smart_bot_factory.config import Config
    from smart_bot_factory.integrations.supabase_client import SupabaseClient
    # ... –º–Ω–æ–≥–æ –∫–æ–¥–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ ...
    
    # –ó–∞–ø—É—Å–∫ –±–æ—Ç–∞
    await dp.start_polling(bot)
```

**–°—Ç–∞–ª–æ:**
```python
async def main():
    # –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è —Ä–æ—É—Ç–µ—Ä–æ–≤
    bot_builder.register_routers(event_router)
    
    # –ú–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –¥—Ä—É–≥–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
    # bot_builder.register_rag(rag_router)
    # bot_builder.register_tool_set(tool_router)
    # bot_builder.register_telegram_router(telegram_router)
    
    # –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∏ –∑–∞–ø—É—Å–∫
    await bot_builder.start()
```

### –ü–æ–ª–Ω—ã–π –ø—Ä–∏–º–µ—Ä –º–∏–≥—Ä–∞—Ü–∏–∏

**–ë—ã–ª–æ (—Å—Ç–∞—Ä–∞—è –≤–µ—Ä—Å–∏—è):**

```python
"""my-bot.py"""
import asyncio
from smart_bot_factory.core.decorators import (
    event_handler,
    schedule_task,
    global_handler
)
from smart_bot_factory.message import send_message_by_human

@event_handler("collect_phone", notify=True, once_only=True)
async def handle_phone(user_id: int, phone: str):
    await send_message_by_human(user_id, f"‚úÖ –¢–µ–ª–µ—Ñ–æ–Ω {phone} —Å–æ—Ö—Ä–∞–Ω–µ–Ω")
    return {"status": "success"}

@schedule_task("follow_up", delay="24h")
async def send_follow_up(user_id: int, text: str):
    await send_message_by_human(user_id, f"üëã {text}")
    return {"status": "sent"}

@global_handler("announcement", delay="2h")
async def send_announcement(text: str):
    # –õ–æ–≥–∏–∫–∞ —Ä–∞—Å—Å—ã–ª–∫–∏
    return {"status": "sent"}

async def main():
    # –ú–Ω–æ–≥–æ –∫–æ–¥–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏...
    await dp.start_polling(bot)

if __name__ == "__main__":
    asyncio.run(main())
```

**–°—Ç–∞–ª–æ (–Ω–æ–≤–∞—è –≤–µ—Ä—Å–∏—è):**

```python
"""my-bot.py"""
import asyncio
from smart_bot_factory.router import EventRouter
from smart_bot_factory.creation import BotBuilder
from smart_bot_factory.message import send_message_by_human

# –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
event_router = EventRouter("my-bot")
bot_builder = BotBuilder("my-bot")

@event_router.event_handler("collect_phone", notify=True, once_only=True)
async def handle_phone(user_id: int, phone: str):
    await send_message_by_human(user_id, f"‚úÖ –¢–µ–ª–µ—Ñ–æ–Ω {phone} —Å–æ—Ö—Ä–∞–Ω–µ–Ω")
    return {"status": "success"}

@event_router.schedule_task("follow_up", delay="24h")
async def send_follow_up(user_id: int, text: str):
    await send_message_by_human(user_id, f"üëã {text}")
    return {"status": "sent"}

@event_router.global_handler("announcement", delay="2h")
async def send_announcement(text: str):
    # –õ–æ–≥–∏–∫–∞ —Ä–∞—Å—Å—ã–ª–∫–∏
    return {"status": "sent"}

async def main():
    # –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è —Ä–æ—É—Ç–µ—Ä–æ–≤
    bot_builder.register_routers(event_router)
    
    # –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∏ –∑–∞–ø—É—Å–∫
    await bot_builder.start()

if __name__ == "__main__":
    asyncio.run(main())
```

### –ö–ª—é—á–µ–≤—ã–µ –æ—Ç–ª–∏—á–∏—è

| –°—Ç–∞—Ä–∞—è –≤–µ—Ä—Å–∏—è | –ù–æ–≤–∞—è –≤–µ—Ä—Å–∏—è |
|---------------|--------------|
| `from smart_bot_factory.core.decorators import event_handler` | `from smart_bot_factory.router import EventRouter` |
| `@event_handler(...)` | `@event_router.event_handler(...)` |
| `@schedule_task(...)` | `@event_router.schedule_task(...)` |
| `@global_handler(...)` | `@event_router.global_handler(...)` |
| –†—É—á–Ω–∞—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ | –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —á–µ—Ä–µ–∑ `BotBuilder` |
| –†–∞–∑—Ä–æ–∑–Ω–µ–Ω–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã | –¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —á–µ—Ä–µ–∑ `BotBuilder` |
| –û—Ç–¥–µ–ª—å–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ | –ß–µ—Ä–µ–∑ CLI –∫–æ–º–∞–Ω–¥—É `sbf test` |
| –ú–Ω–æ–≥–æ –∫–æ–¥–∞ –≤ `main()` | –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –∫–æ–¥: `register_routers()` + `start()` |

### –í–∞–∂–Ω—ã–µ –∑–∞–º–µ—á–∞–Ω–∏—è

1. **–ü–∞—Ä–∞–º–µ—Ç—Ä—ã –¥–µ–∫–æ—Ä–∞—Ç–æ—Ä–æ–≤ –Ω–µ –∏–∑–º–µ–Ω–∏–ª–∏—Å—å** - –≤—Å–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã (`notify`, `once_only`, `send_ai_response`, `delay`, `smart_check`, `event_type`) —Ä–∞–±–æ—Ç–∞—é—Ç —Ç–∞–∫ –∂–µ

2. **–õ–æ–≥–∏–∫–∞ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ –Ω–µ –º–µ–Ω—è–µ—Ç—Å—è** - –∫–æ–¥ –≤–Ω—É—Ç—Ä–∏ —Ñ—É–Ω–∫—Ü–∏–π –æ—Å—Ç–∞–µ—Ç—Å—è –ø—Ä–µ–∂–Ω–∏–º

3. **–û–±—è–∑–∞—Ç–µ–ª—å–Ω–∞—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è —Ä–æ—É—Ç–µ—Ä–æ–≤** - –Ω–µ –∑–∞–±—É–¥—å—Ç–µ –≤—ã–∑–≤–∞—Ç—å `bot_builder.register_routers(event_router)` –≤ `main()`

4. **–ú–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ä–æ—É—Ç–µ—Ä–æ–≤:**
   ```python
   event_router1 = EventRouter("events")
   event_router2 = EventRouter("tasks")
   
   bot_builder.register_routers(event_router1, event_router2)
   ```

5. **–û–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å** - —Å—Ç–∞—Ä—ã–µ –¥–µ–∫–æ—Ä–∞—Ç–æ—Ä—ã –∏–∑ `smart_bot_factory.event.decorators.registry` –≤—Å–µ –µ—â–µ —Ä–∞–±–æ—Ç–∞—é—Ç, –Ω–æ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –º–∏–≥—Ä–∏—Ä–æ–≤–∞—Ç—å –Ω–∞ —Ä–æ—É—Ç–µ—Ä—ã

### –ß–∞—Å—Ç—ã–µ –ø—Ä–æ–±–ª–µ–º—ã –ø—Ä–∏ –º–∏–≥—Ä–∞—Ü–∏–∏

**–ü—Ä–æ–±–ª–µ–º–∞ 1: –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –Ω–µ –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è**

**–†–µ—à–µ–Ω–∏–µ:** –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤—ã–∑–≤–∞–ª–∏ `bot_builder.register_routers(event_router)` –≤ `main()`

**–ü—Ä–æ–±–ª–µ–º–∞ 2: –ò–º–ø–æ—Ä—Ç—ã –Ω–µ –Ω–∞–π–¥–µ–Ω—ã**

**–†–µ—à–µ–Ω–∏–µ:** –ò–∑–º–µ–Ω–∏—Ç–µ –∏–º–ø–æ—Ä—Ç—ã:
- `smart_bot_factory.core.decorators` ‚Üí `smart_bot_factory.router`
- –î–æ–±–∞–≤—å—Ç–µ `from smart_bot_factory.creation import BotBuilder`

**–ü—Ä–æ–±–ª–µ–º–∞ 3: –ë–æ—Ç –Ω–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è**

**–†–µ—à–µ–Ω–∏–µ:** –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤—ã–∑—ã–≤–∞–µ—Ç–µ `await bot_builder.start()` –≤–º–µ—Å—Ç–æ —Å—Ç–∞—Ä–æ–π –ª–æ–≥–∏–∫–∏ –∑–∞–ø—É—Å–∫–∞

**–ü—Ä–æ–±–ª–µ–º–∞ 4: –¢–µ—Å—Ç—ã –Ω–µ —Ä–∞–±–æ—Ç–∞—é—Ç**

**–†–µ—à–µ–Ω–∏–µ:** –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `sbf test my-bot` –¥–ª—è –∑–∞–ø—É—Å–∫–∞ —Ç–µ—Å—Ç–æ–≤

---

## üîß –†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

### –ö–∞—Å—Ç–æ–º–Ω—ã–π PromptLoader

–°–æ–∑–¥–∞–π—Ç–µ —Å–≤–æ–π –∑–∞–≥—Ä—É–∑—á–∏–∫ –ø—Ä–æ–º–ø—Ç–æ–≤ —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ–º –ø—É—Ç–∏:

```python
from smart_bot_factory.utils import UserPromptLoader

# –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –Ω–∞–π–¥–µ—Ç bots/my-bot/prompts
custom_loader = UserPromptLoader("my-bot")

# –ò–ª–∏ –Ω–∞—Å–ª–µ–¥—É–π—Ç–µ—Å—å –¥–ª—è –∫–∞—Å—Ç–æ–º–∏–∑–∞—Ü–∏–∏
class MyPromptLoader(UserPromptLoader):
    def __init__(self, bot_id):
        super().__init__(bot_id)
        self.extra_file = self.prompts_dir / 'extra.txt'

my_loader = MyPromptLoader("my-bot")

# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –î–û build()
bot_builder.set_prompt_loader(my_loader)
```

### –ü–æ–ª–Ω–∞—è –∑–∞–º–µ–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Å–æ–±—ã—Ç–∏–π

–ó–∞–º–µ–Ω–∏—Ç–µ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—É—é —Ñ—É–Ω–∫—Ü–∏—é `process_events`:

```python
from smart_bot_factory.message import get_bot
from smart_bot_factory.core.decorators import execute_event_handler

async def my_process_events(session_id, events, user_id):
    """–ú–æ—è –∫–∞—Å—Ç–æ–º–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Å–æ–±—ã—Ç–∏–π"""
    bot = get_bot()
    
    for event in events:
        event_type = event.get('—Ç–∏–ø')
        
        if event_type == 'booking':
            # –í–∞—à–∞ –∫–∞—Å—Ç–æ–º–Ω–∞—è –ª–æ–≥–∏–∫–∞
            telegram_user = await bot.get_chat(user_id)
            name = telegram_user.first_name
            # ... –æ–±—Ä–∞–±–æ—Ç–∫–∞
        else:
            # –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—Å—Ç–∞–ª—å–Ω—ã—Ö
            await execute_event_handler(event_type, user_id, event.get('–∏–Ω—Ñ–æ'))

# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –î–û build()
bot_builder.set_event_processor(my_process_events)
```

### –î–æ—Å—Ç—É–ø –∫ aiogram Bot

–ü–æ–ª—É—á–∏—Ç–µ –ø—Ä—è–º–æ–π –¥–æ—Å—Ç—É–ø –∫ `aiogram.Bot`:

```python
from smart_bot_factory.message import get_bot

@event_router.event_handler("check_user")
async def get_user_info(user_id: int, event_data: str):
    """–ü–æ–ª—É—á–∞–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –∏–∑ Telegram"""
    bot = get_bot()
    
    # –ò—Å–ø–æ–ª—å–∑—É–µ–º –ª—é–±—ã–µ –º–µ—Ç–æ–¥—ã aiogram Bot
    telegram_user = await bot.get_chat(user_id)
    name = telegram_user.first_name
    username = telegram_user.username
    
    await bot.send_message(user_id, f"–ü—Ä–∏–≤–µ—Ç, {name}!")
    return {"name": name, "username": username}
```

### UTM-—Ç—Ä–∏–≥–≥–µ—Ä—ã

UTM-—Ç—Ä–∏–≥–≥–µ—Ä—ã –ø–æ–∑–≤–æ–ª—è—é—Ç –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –ø—Ä–∏ `/start` —Å –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–º–∏ UTM-–º–µ—Ç–∫–∞–º–∏. –ï—Å–ª–∏ UTM-–¥–∞–Ω–Ω—ã–µ —Å–æ–≤–ø–∞–¥–∞—é—Ç —Å –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–º —Ç—Ä–∏–≥–≥–µ—Ä–æ–º, –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è —Å–æ–æ–±—â–µ–Ω–∏–µ –∏–∑ —Ñ–∞–π–ª–∞, –∞ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è –ª–æ–≥–∏–∫–∞ `/start` –ø—Ä–æ–ø—É—Å–∫–∞–µ—Ç—Å—è.

**–ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç:**

1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç –ø–æ —Å—Å—ã–ª–∫–µ —Å UTM-–º–µ—Ç–∫–∞–º–∏: `https://t.me/my_bot?utm_source=vk&utm_campaign=summer2025`
2. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞–∂–∏–º–∞–µ—Ç `/start`
3. –°–∏—Å—Ç–µ–º–∞ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç UTM-–º–µ—Ç–∫–∏ –∏–∑ —Å—Å—ã–ª–∫–∏
4. –ï—Å–ª–∏ –Ω–∞–π–¥–µ–Ω–æ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ —Å —Ç—Ä–∏–≥–≥–µ—Ä–æ–º - –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è —Å–æ–æ–±—â–µ–Ω–∏–µ –∏–∑ —Ñ–∞–π–ª–∞
5. –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è –ª–æ–≥–∏–∫–∞ `/start` –ø—Ä–æ–ø—É—Å–∫–∞–µ—Ç—Å—è

**–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è —Ç—Ä–∏–≥–≥–µ—Ä–∞:**

```python
# –¢—Ä–∏–≥–≥–µ—Ä –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π –∫–∞–º–ø–∞–Ω–∏–∏
bot_builder.register_utm_trigger(
    message='summer_campaign.txt',  # –§–∞–π–ª –≤ bots/my-bot/utm_message/
    source='vk',                     # utm_source –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å 'vk'
    campaign='summer2025'            # utm_campaign –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å 'summer2025'
)

# –¢—Ä–∏–≥–≥–µ—Ä –¥–ª—è —Å–µ–≥–º–µ–Ω—Ç–∞
bot_builder.register_utm_trigger(
    message='premium_welcome.txt',
    segment='premium'  # –ü–∞—Ä–∞–º–µ—Ç—Ä segment –∏–∑ —Å—Å—ã–ª–∫–∏
)

# –¢—Ä–∏–≥–≥–µ—Ä —Å –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏
bot_builder.register_utm_trigger(
    message='new_year.txt',
    source='instagram',
    medium='story',
    campaign='new_year'
)
```

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**

- **`message`** (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π) - –ò–º—è —Ñ–∞–π–ª–∞ —Å —Å–æ–æ–±—â–µ–Ω–∏–µ–º –≤ `bots/my-bot/utm_message/`
- **`source`** (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) - –¶–µ–ª–µ–≤–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ `utm_source`
- **`medium`** (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) - –¶–µ–ª–µ–≤–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ `utm_medium`
- **`campaign`** (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) - –¶–µ–ª–µ–≤–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ `utm_campaign`
- **`content`** (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) - –¶–µ–ª–µ–≤–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ `utm_content`
- **`term`** (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) - –¶–µ–ª–µ–≤–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ `utm_term`
- **`segment`** (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) - –¶–µ–ª–µ–≤–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ `segment`

**–ü—Ä–∏–º–µ—Ä—ã —Å—Å—ã–ª–æ–∫:**

```bash
# –î–ª—è –ø–µ—Ä–≤–æ–≥–æ —Ç—Ä–∏–≥–≥–µ—Ä–∞ (source='vk', campaign='summer2025')
https://t.me/my_bot?utm_source=vk&utm_campaign=summer2025

# –î–ª—è –≤—Ç–æ—Ä–æ–≥–æ —Ç—Ä–∏–≥–≥–µ—Ä–∞ (segment='premium')
https://t.me/my_bot?segment=premium

# –î–ª—è —Ç—Ä–µ—Ç—å–µ–≥–æ —Ç—Ä–∏–≥–≥–µ—Ä–∞ (source='instagram', medium='story', campaign='new_year')
https://t.me/my_bot?utm_source=instagram&utm_medium=story&utm_campaign=new_year
```

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª–æ–≤:**

```
bots/
‚îî‚îÄ‚îÄ my-bot/
    ‚îî‚îÄ‚îÄ utm_message/
        ‚îú‚îÄ‚îÄ summer_campaign.txt
        ‚îú‚îÄ‚îÄ premium_welcome.txt
        ‚îî‚îÄ‚îÄ new_year.txt
```

**–°–æ–¥–µ—Ä–∂–∏–º–æ–µ —Ñ–∞–π–ª–∞ `summer_campaign.txt`:**

```
üéâ –õ–µ—Ç–Ω—è—è –∞–∫—Ü–∏—è!

–°–∫–∏–¥–∫–∞ 20% –Ω–∞ –≤—Å–µ —É—Å–ª—É–≥–∏ –¥–æ –∫–æ–Ω—Ü–∞ –ª–µ—Ç–∞!

–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø—Ä–æ–º–æ–∫–æ–¥: SUMMER2025
```

**–ü–æ–ª–Ω—ã–π –ø—Ä–∏–º–µ—Ä:**

```python
from smart_bot_factory.creation import BotBuilder

bot_builder = BotBuilder("my-bot")

# –†–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ–º —Ç—Ä–∏–≥–≥–µ—Ä—ã –î–û build()
bot_builder.register_utm_trigger(
    message='summer_campaign.txt',
    source='vk',
    campaign='summer2025'
)

bot_builder.register_utm_trigger(
    message='premium_welcome.txt',
    segment='premium'
)

async def main():
    bot_builder.register_routers(event_router)
    await bot_builder.start()
```

**–í–∞–∂–Ω–æ:**

- –§–∞–π–ª—ã –¥–æ–ª–∂–Ω—ã –Ω–∞—Ö–æ–¥–∏—Ç—å—Å—è –≤ `bots/my-bot/utm_message/`
- –ï—Å–ª–∏ UTM-–º–µ—Ç–∫–∏ —Å–æ–≤–ø–∞–¥–∞—é—Ç - —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è –ª–æ–≥–∏–∫–∞ `/start` **–ø–æ–ª–Ω–æ—Å—Ç—å—é –ø—Ä–æ–ø—É—Å–∫–∞–µ—Ç—Å—è**
- –ï—Å–ª–∏ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–π –Ω–µ—Ç - –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è –ª–æ–≥–∏–∫–∞ `/start`
- –ú–æ–∂–Ω–æ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ç—Ä–∏–≥–≥–µ—Ä–æ–≤ —Å —Ä–∞–∑–Ω—ã–º–∏ —É—Å–ª–æ–≤–∏—è–º–∏

---

## üìö –ü–æ–ª–Ω—ã–π –ø—Ä–∏–º–µ—Ä

```python
"""advanced-bot.py - –ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–π –ø—Ä–∏–º–µ—Ä"""

import asyncio
from typing import Optional

from smart_bot_factory.router import EventRouter
from smart_bot_factory.message import send_message_by_human
from smart_bot_factory.creation import BotBuilder
from smart_bot_factory.rag import RagRouter, VectorStore
from smart_bot_factory.utils import ToolRouter

from aiogram import Router, F
from aiogram.filters import Command
from aiogram.types import Message

# –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
event_router = EventRouter("advanced-bot")
telegram_router = Router(name="commands")
bot_builder = BotBuilder("advanced-bot")

# RAG
vectorstore = VectorStore(bot_id="advanced-bot")
rag_router = RagRouter("advanced_rag")

@rag_router.tool
async def get_info_from_rag(query: str, section: Optional[str] = None) -> str:
    """–ó–∞–ø—Ä–æ—Å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –∏–∑ RAG-—Å–∏—Å—Ç–µ–º—ã."""
    results = await vectorstore.asimilarity_search(query, k=5)
    return "\n\n".join([doc.page_content for doc in results])

# –û–±—ã—á–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã
tool_router = ToolRouter("common")

@tool_router.tool
def calculate_price(service: str, quantity: int) -> str:
    """–†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç —Ü–µ–Ω—É —É—Å–ª—É–≥–∏."""
    prices = {"–∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏—è": 1000, "–ª–µ—á–µ–Ω–∏–µ": 5000}
    return f"–°—Ç–æ–∏–º–æ—Å—Ç—å: {prices.get(service, 0) * quantity}‚ÇΩ"

# ========== –°–û–ë–´–¢–ò–Ø ==========

@event_router.event_handler("collect_phone", notify=True, once_only=True)
async def save_phone(user_id: int, phone: str):
    await send_message_by_human(user_id, f"‚úÖ –¢–µ–ª–µ—Ñ–æ–Ω {phone} —Å–æ—Ö—Ä–∞–Ω–µ–Ω")
    return {"status": "success"}

# ========== –ó–ê–î–ê–ß–ò ==========

@event_router.schedule_task("follow_up", delay="24h")
async def send_follow_up(user_id: int, text: str):
    await send_message_by_human(user_id, f"üëã {text}")
    return {"status": "sent"}

# ========== TELEGRAM –ö–û–ú–ê–ù–î–´ ==========

@telegram_router.message(Command("price"))
async def price_cmd(message: Message):
    await message.answer("üí∞ –¶–µ–Ω—ã: ...")

# ========== –•–£–ö–ò ==========

@bot_builder.validate_message
async def check_business_hours(message_text: str, message_obj):
    """–ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—á–∏—Ö —á–∞—Å–æ–≤"""
    from datetime import datetime
    hour = datetime.now().hour
    if hour < 9 or hour > 21:
        await message_obj.answer("–ú—ã —Ä–∞–±–æ—Ç–∞–µ–º —Å 9:00 –¥–æ 21:00")
        return False
    return True

@bot_builder.enrich_prompt
async def add_client_data(system_prompt: str, user_id: int):
    """–î–æ–±–∞–≤–ª—è–µ—Ç –¥–∞–Ω–Ω—ã–µ –∫–ª–∏–µ–Ω—Ç–∞ –≤ –ø—Ä–æ–º–ø—Ç"""
    # –í–∞—à–∞ –ª–æ–≥–∏–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö
    return system_prompt

# ========== –ó–ê–ü–£–°–ö ==========

async def main():
    # –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è
    bot_builder.register_routers(event_router)
    bot_builder.register_telegram_router(telegram_router)
    bot_builder.register_rag(rag_router)
    bot_builder.register_tool_set(tool_router)
    
    # –°–±–æ—Ä–∫–∞ –∏ –∑–∞–ø—É—Å–∫
    await bot_builder.start()

if __name__ == "__main__":
    asyncio.run(main())
```

---

## üìñ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```text
project/
‚îú‚îÄ‚îÄ bots/
‚îÇ   ‚îî‚îÄ‚îÄ my-bot/
‚îÇ       ‚îú‚îÄ‚îÄ prompts/              # –ü—Ä–æ–º–ø—Ç—ã –¥–ª—è AI
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ system_prompt.txt
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ welcome_message.txt
‚îÇ       ‚îÇ   ‚îî‚îÄ‚îÄ final_instructions.txt
‚îÇ       ‚îú‚îÄ‚îÄ tests/                # YAML —Ç–µ—Å—Ç—ã
‚îÇ       ‚îÇ   ‚îî‚îÄ‚îÄ test_scenarios.yaml
‚îÇ       ‚îú‚îÄ‚îÄ welcome_files/       # –§–∞–π–ª—ã –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏—è
‚îÇ       ‚îú‚îÄ‚îÄ files/                # –§–∞–π–ª—ã –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏
‚îÇ       ‚îú‚îÄ‚îÄ utm_message/          # UTM-—Ç—Ä–∏–≥–≥–µ—Ä—ã
‚îÇ       ‚îî‚îÄ‚îÄ .env                  # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îú‚îÄ‚îÄ my-bot.py                     # –ö–æ–¥ –±–æ—Ç–∞
‚îú‚îÄ‚îÄ rag_tools.py                  # RAG –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
‚îî‚îÄ‚îÄ .env                          # –ì–ª–æ–±–∞–ª—å–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
```

---

## ‚öôÔ∏è –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è (.env)

```bash
# Telegram
TELEGRAM_BOT_TOKEN=your_token_here

# Supabase
SUPABASE_URL=https://your-project.supabase.co
SUPABASE_KEY=your_key_here

# OpenAI
OPENAI_API_KEY=sk-your-key
OPENAI_MODEL=gpt-5-mini
OPENAI_MAX_TOKENS=1500
OPENAI_TEMPERATURE=0.7

# –ü—Ä–æ–º–ø—Ç—ã (–∫–∞—Ç–∞–ª–æ–≥)
PROMT_FILES_DIR=prompts

# –§–∞–π–ª –ø–æ—Å–ª–µ –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏—è —Å –ø–æ–¥–ø–∏—Å—å—é
WELCOME_FILE_URL=welcome_files/
WELCOME_FILE_MSG=welcome_file_msg.txt

# –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—ã (Telegram ID —á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é)
ADMIN_TELEGRAM_IDS=123456789,987654321
ADMIN_SESSION_TIMEOUT_MINUTES=30

# –†–µ–∂–∏–º –æ—Ç–ª–∞–¥–∫–∏ (–ø–æ–∫–∞–∑—ã–≤–∞—Ç—å JSON)
DEBUG_MODE=false

# –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
MAX_CONTEXT_MESSAGES=50
LOG_LEVEL=INFO
MESSAGE_PARSE_MODE=Markdown

# –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–æ–¥–∞–∂
LEAD_QUALIFICATION_THRESHOLD=7
SESSION_TIMEOUT_HOURS=24

# ‚ö†Ô∏è –í–ê–ñ–ù–û: BOT_ID —Ç–µ–ø–µ—Ä—å –ù–ï –Ω—É–∂–µ–Ω –≤ .env!
# Bot ID –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è –∏–∑ –∏–º–µ–Ω–∏ —Ñ–∞–π–ª–∞ –∑–∞–ø—É—Å–∫–∞–ª–∫–∏
# –ù–∞–ø—Ä–∏–º–µ—Ä: python my-bot.py ‚Üí BOT_ID = my-bot
```

---

## üéØ –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –¥–µ–∫–æ—Ä–∞—Ç–æ—Ä–æ–≤

| –î–µ–∫–æ—Ä–∞—Ç–æ—Ä | –ö–æ–≥–¥–∞ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è | –î–ª—è –∫–æ–≥–æ | –ö–ª—é—á–µ–≤—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã |
|-----------|-------------------|----------|--------------------|
| `@event_handler` | –ù–µ–º–µ–¥–ª–µ–Ω–Ω–æ | 1 –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å | `event_type`, `notify`, `once_only`, `send_ai_response` |
| `@schedule_task` | –ß–µ—Ä–µ–∑ –≤—Ä–µ–º—è | 1 –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å | `task_name`, `delay`, `event_type`, `smart_check`, `once_only`, `notify`, `send_ai_response` |
| `@global_handler` | –ß–µ—Ä–µ–∑ –≤—Ä–µ–º—è | –í—Å–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ | `handler_type`, `delay`, `event_type`, `once_only`, `notify`, `send_ai_response` |

---

## üîë –ö–ª—é—á–µ–≤—ã–µ –∫–æ–Ω—Ü–µ–ø—Ü–∏–∏

### `send_ai_response=True`

–ö–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–µ—Ç –æ—Ç–ø—Ä–∞–≤–∫—É —Å–æ–æ–±—â–µ–Ω–∏—è –æ—Ç –ò–ò –ø–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞:

- **`True`** (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é) - –ò–ò –æ—Ç–ø—Ä–∞–≤–∏—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –ø–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞
- **`False`** - –ò–ò –ù–ï –æ—Ç–ø—Ä–∞–≤–∏—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ (–∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–æ–≥–¥–∞ –Ω—É–∂–Ω–∞ —Ç–æ–ª—å–∫–æ —Ñ–æ–Ω–æ–≤–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∏–ª–∏ –∫–æ–≥–¥–∞ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –≤—Ä—É—á–Ω—É—é)

**–ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `send_ai_response=False`:**

- –ö–æ–≥–¥–∞ –Ω—É–∂–Ω–æ —Ç–æ–ª—å–∫–æ —Å–æ–±—Ä–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –±–µ–∑ –æ—Ç–≤–µ—Ç–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é
- –ö–æ–≥–¥–∞ –≤—ã —Å–∞–º–∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏–µ —á–µ—Ä–µ–∑ `send_message_by_human()`
- –î–ª—è —Ñ–æ–Ω–æ–≤—ã—Ö –∑–∞–¥–∞—á –±–µ–∑ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º

### `once_only=True`

–ì–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ —Å–æ–±—ã—Ç–∏—è —Ç–æ–ª—å–∫–æ 1 —Ä–∞–∑ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:

- **–ü—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏**: –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –ë–î, –µ—Å–ª–∏ –µ—Å—Ç—å - –Ω–µ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç
- **–ü—Ä–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏**: –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –ë–î, –µ—Å–ª–∏ –µ—Å—Ç—å `completed` - –æ—Ç–º–µ–Ω—è–µ—Ç

### `smart_check=True`

–£–º–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –¥–ª—è –∑–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –∑–∞–¥–∞—á:

- **–û—Ç–º–µ–Ω—è–µ—Ç** –∑–∞–¥–∞—á—É –µ—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–µ—Ä–µ—à–µ–ª –Ω–∞ –Ω–æ–≤—ã–π —ç—Ç–∞–ø
- **–ü–µ—Ä–µ–Ω–æ—Å–∏—Ç** –∑–∞–¥–∞—á—É –µ—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –±—ã–ª –Ω–µ–¥–∞–≤–Ω–æ –∞–∫—Ç–∏–≤–µ–Ω

### `event_type` - –ü—Ä–∏–≤—è–∑–∫–∞ –∫–æ –≤—Ä–µ–º–µ–Ω–∏ —Å–æ–±—ã—Ç–∏—è

–ü–ª–∞–Ω–∏—Ä—É–µ—Ç –∑–∞–¥–∞—á—É –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ –≤—Ä–µ–º–µ–Ω–∏ —Å–æ–±—ã—Ç–∏—è:

**–°—Ç—Ä–æ–∫–∞** - –∏—â–µ—Ç –≤ –ë–î:

```python
@event_router.schedule_task("reminder", delay="2h", event_type="appointment")
async def remind(user_id: int, text: str):
    # 1. –ò–ò —Å–æ–∑–¥–∞–µ—Ç —Å–æ–±—ã—Ç–∏–µ: {"—Ç–∏–ø": "appointment", "–∏–Ω—Ñ–æ": "–¥–∞—Ç–∞: 2025-10-15, –≤—Ä–µ–º—è: 19:00"}
    # 2. –ò–ò —Å–æ–∑–¥–∞–µ—Ç –∑–∞–¥–∞—á—É: {"—Ç–∏–ø": "reminder", "–∏–Ω—Ñ–æ": ""}
    # 3. –ò—â–µ—Ç—Å—è –≤ –ë–î —Å–æ–±—ã—Ç–∏–µ "appointment" –¥–ª—è user_id
    # 4. –ü–∞—Ä—Å–∏—Ç—Å—è datetime: 2025-10-15 19:00
    # 5. –í—ã—á–∏—Å–ª—è–µ—Ç—Å—è: 19:00 - 2h = 17:00
    # 6. –ó–∞–¥–∞—á–∞ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –≤ 17:00
    pass
```

**–§—É–Ω–∫—Ü–∏—è** - –∫–∞—Å—Ç–æ–º–Ω–∞—è –ª–æ–≥–∏–∫–∞:

```python
async def get_time_from_api(user_id: int, user_data: str) -> datetime:
    booking = await external_api.get_booking(user_id)
    return booking['datetime']

@event_router.schedule_task("api_reminder", delay="1h", event_type=get_time_from_api)
async def remind(user_id: int, text: str):
    # 1. –ò–ò —Å–æ–∑–¥–∞–µ—Ç: {"—Ç–∏–ø": "api_reminder", "–∏–Ω—Ñ–æ": ""}
    # 2. –í—ã–∑—ã–≤–∞–µ—Ç—Å—è get_time_from_api(user_id, "")
    # 3. –§—É–Ω–∫—Ü–∏—è –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç datetime –∏–∑ API
    # 4. –í—ã—á–∏—Å–ª—è–µ—Ç—Å—è: api_datetime - 1h
    # 5. –ó–∞–¥–∞—á–∞ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –≤ –≤—ã—á–∏—Å–ª–µ–Ω–Ω–æ–µ –≤—Ä–µ–º—è
    pass
```

---

## üìû –ü–æ–¥–¥–µ—Ä–∂–∫–∞

- –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è: [GitHub](https://github.com/your-repo)
- Issues: [GitHub Issues](https://github.com/your-repo/issues)

---

## üìÑ –õ–∏—Ü–µ–Ω–∑–∏—è

MIT
