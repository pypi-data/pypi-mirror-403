{
   "meta": {
      "profile": [
         "http://hl7.org/fhir/StructureDefinition/StructureMap"
      ]
   },
   "text": {
      "div": "<div xmlns=\"http://www.w3.org/1999/xhtml\">\n/// url = \"http://example.org/legacy/map\"\n/// name = \"Legacy Patient to FHIR Patient\"\n\nuses \"http://hl7.org/fhir/StructureDefinition/Patient\" as target\n\ngroup main(source legacy, target patient: Patient) {\n    legacy -> patient.name as name then {\n        legacy.firstName -> name.given;\n        legacy.lastName -> name.family;\n    };\n    legacy.dob -> patient.birthDate;\n    legacy.sex where($this = 'F') -> patient.gender = \"female\";\n    legacy.sex where($this = 'M') -> patient.gender = \"male\";\n}\n</div>"
   },
   "url": "http://example.org/legacy/map",
   "name": "Legacy Patient to FHIR Patient",
   "status": "draft",
   "structure": [
      {
         "url": "http://hl7.org/fhir/StructureDefinition/Patient",
         "mode": "target"
      }
   ],
   "group": [
      {
         "name": "main",
         "input": [
            {
               "name": "legacy",
               "mode": "source"
            },
            {
               "name": "patient",
               "type": "Patient",
               "mode": "target"
            }
         ],
         "rule": [
            {
               "source": [
                  {
                     "context": "legacy"
                  }
               ],
               "target": [
                  {
                     "context": "patient",
                     "element": "name",
                     "variable": "name"
                  }
               ],
               "rule": [
                  {
                     "source": [
                        {
                           "context": "legacy",
                           "element": "firstName",
                           "variable": "-firstName-"
                        }
                     ],
                     "target": [
                        {
                           "context": "name",
                           "element": "given",
                           "variable": "-given-"
                        }
                     ],
                     "dependent": [
                        {
                           "name": "-DefaultMappingGroup-",
                           "parameter": [
                              {
                                 "valueId": "-firstName-"
                              },
                              {
                                 "valueId": "-given-"
                              }
                           ]
                        }
                     ]
                  },
                  {
                     "source": [
                        {
                           "context": "legacy",
                           "element": "lastName",
                           "variable": "-lastName-"
                        }
                     ],
                     "target": [
                        {
                           "context": "name",
                           "element": "family",
                           "variable": "-family-"
                        }
                     ],
                     "dependent": [
                        {
                           "name": "-DefaultMappingGroup-",
                           "parameter": [
                              {
                                 "valueId": "-lastName-"
                              },
                              {
                                 "valueId": "-family-"
                              }
                           ]
                        }
                     ]
                  }
               ]
            },
            {
               "source": [
                  {
                     "context": "legacy",
                     "element": "dob",
                     "variable": "-dob-"
                  }
               ],
               "target": [
                  {
                     "context": "patient",
                     "element": "birthDate",
                     "variable": "-birthDate-"
                  }
               ],
               "dependent": [
                  {
                     "name": "-DefaultMappingGroup-",
                     "parameter": [
                        {
                           "valueId": "-dob-"
                        },
                        {
                           "valueId": "-birthDate-"
                        }
                     ]
                  }
               ]
            },
            {
               "source": [
                  {
                     "context": "legacy",
                     "element": "sex",
                     "condition": "$this = 'F'"
                  }
               ],
               "target": [
                  {
                     "context": "patient",
                     "element": "gender",
                     "transform": "copy",
                     "parameter": [
                        {
                           "valueString": "female"
                        }
                     ]
                  }
               ]
            },
            {
               "source": [
                  {
                     "context": "legacy",
                     "element": "sex",
                     "condition": "$this = 'M'"
                  }
               ],
               "target": [
                  {
                     "context": "patient",
                     "element": "gender",
                     "transform": "copy",
                     "parameter": [
                        {
                           "valueString": "male"
                        }
                     ]
                  }
               ]
            }
         ]
      }
   ],
   "resourceType": "StructureMap"
}