[package]
name = "formualizer-workbook"
version = "0.3.0"
edition = "2024"
description = "Ergonomic workbook API over the Formualizer engine (sheets, loaders, staging, undo/redo)"
homepage.workspace = true
license.workspace = true
repository.workspace = true
readme = "README.md"
keywords = ["excel", "formula", "workbook", "engine", "spreadsheet"]
categories = ["data-structures"]

[dependencies]
formualizer-parse = { workspace = true }
formualizer-common = { workspace = true }
formualizer-eval = { workspace = true }
thiserror = { workspace = true }
serde = { workspace = true, features = ["derive"] }
serde_json = { workspace = true, optional = true }
parking_lot = "0.12"
chrono = { workspace = true }
once_cell = { workspace = true }
rustc-hash = { workspace = true }
zip = { version = "0.6.6", default-features = false, features = ["deflate"], optional = true }

[features]
default = ["json"]
json = ["dep:serde_json", "formualizer-common/serde"]
calamine = ["dep:calamine", "dep:zip"]
umya = ["dep:umya-spreadsheet"]
mmap = ["dep:memmap2"]
io_builtins = []
import_range = ["io_builtins"]
webservice = ["io_builtins", "dep:reqwest"]
tracing = ["dep:tracing"]
compression = ["dep:zstd"]
calamine_integration = ["calamine"]
umya_integration = ["umya"]

[dependencies.calamine]
version = "0.24"
optional = true

[dependencies.memmap2]
version = "0.9"
optional = true

[dependencies.reqwest]
version = "0.11"
optional = true

[dependencies.tracing]
version = "0.1"
optional = true

[dependencies.zstd]
version = "0.13"
optional = true

[dev-dependencies]
tempfile = { workspace = true }
umya-spreadsheet = "2.3.2"

[[test]]
name = "calamine"
path = "tests/calamine/mod.rs"
required-features = ["calamine"]

[[test]]
name = "umya"
path = "tests/umya/mod.rs"
required-features = ["umya"]

[dependencies.umya-spreadsheet]
version = "2.3.2"
package = "umya-spreadsheet"
optional = true
