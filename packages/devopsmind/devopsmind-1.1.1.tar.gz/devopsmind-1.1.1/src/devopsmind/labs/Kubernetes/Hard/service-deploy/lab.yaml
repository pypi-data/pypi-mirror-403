id: service-deploy
title: "Expose Deployment with a Service"
stack: kubernetes
difficulty: Hard
xp: 150
goal: "Expose a Kubernetes Deployment internally using a Service"

skills:
  - kubernetes-services
  - service-discovery
  - application-exposure

hint: "Create deployment.yaml (web-deploy, label app=web) and service.yaml (ClusterIP exposing port 80 targeting app=web)."

validator: "validator.py"

mentor:
  why: "This lab teaches how Kubernetes Services provide stable networking and service discovery for replicated workloads, which is essential for internal communication within a cluster."
  intent: stretch

  guidance:
    before: |
      Think about how Kubernetes Services select Pods using labels and provide a stable network endpoint independent of individual Pod IPs.

      Optional manual commands (not required for validation):
      These commands operate only on local files.
      Results are for personal verification only.

      - kubectl explain service
      - kubectl explain service.spec.selector
      - kubectl explain service.spec.ports
    after: |
      Consider how changing Service types alters exposure and when internal-only Services are preferred.

  tags:
    - kubernetes
    - service
    - networking
    - service-discovery

solution:
  overview: >
    At hard level, this lab evaluates whether an engineer can correctly
    connect Kubernetes resources using labels and selectors rather than relying
    on implicit assumptions. Exposing a Deployment through a Service requires
    understanding how resource definitions interact across files.
  professional_reasoning:
    - Services rely entirely on label selectors to route traffic
    - Decoupling workloads from network identity improves resilience
    - Cross-resource consistency is critical for correct behavior
    - Misaligned labels are a common source of production outages
  real_world_context:
    - Most internal Kubernetes traffic flows through ClusterIP Services
    - Teams standardize label conventions to reduce integration errors
    - Senior engineers verify resource linkage before debugging runtime issues

execution:
  runtime: docker
  requires_execution: true
  required_tools:
    - kubernetes
