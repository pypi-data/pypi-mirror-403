id: secure-pod-design
title: "Design a secure Pod using securityContext"
stack: kubernetes
difficulty: Expert
xp: 300
goal: "Design a Kubernetes Pod with secure runtime settings using securityContext"

skills:
  - kubernetes-security
  - pod-hardening
  - least-privilege

hint: "Run the container as a non-root user and restrict runtime privileges using securityContext."

validator: "validator.py"

mentor:
  why: "This lab focuses on enforcing runtime security in Kubernetes by applying least-privilege principles through securityContext, a critical practice for protecting workloads in production clusters."
  intent: stretch

  guidance:
    before: |
      Think about how container runtime settings such as user IDs, Linux capabilities, and filesystem permissions affect security boundaries inside a Pod.

      Optional manual commands (not required for validation):
      These commands operate only on local files.
      Results are for personal verification only.

      - kubectl explain pod.spec.securityContext
      - kubectl explain container.securityContext
    after: |
      Consider how additional protections such as seccomp profiles or read-only root filesystems further reduce attack surface.

  tags:
    - kubernetes
    - security
    - pod-security
    - least-privilege

solution:
  overview: >
    At expert level, Kubernetes security requires deliberate control over how
    containers execute at runtime. This lab evaluates whether an engineer
    can apply least-privilege principles using securityContext to reduce the
    impact of container compromise without relying on external security tools.
  professional_reasoning:
    - Running containers as non-root limits privilege escalation
    - Dropping write access to the filesystem reduces persistence risk
    - Explicit runtime constraints improve security review clarity
    - Misconfigured securityContext settings are a common production weakness
  real_world_context:
    - SecurityContext settings are foundational to Pod Security Standards
    - Production clusters often enforce these controls via admission policies
    - Senior engineers design workloads to be secure by default

execution:
  runtime: docker
  requires_execution: true
  required_tools:
    - kubernetes
