openapi: 3.0.0
info:
  title: API framework for managing computations and results of computations
  description: |
    API for manage computations (e.g. of Maass forms and other mathematical objects)

    - Date format is given by RFC3339 (https://tools.ietf.org/html/rfc3339)
    - Date ranges are given as "created_at=__gt__2020-01-01T00:00:00Z,__lt__2020-01-01T00:00:00Z"
    - Multiple values are given as comma separated lists.

  version: '1'
servers:
  - url: /api/v1
paths:
  /computation:
    post:
      summary: Create a computation object (when starting a computation)
      operationId: comp_manager.api.computation.post
      tags:
        - Computation
      requestBody:
        $ref: "./parameters.yaml#/computation_body_create"
      responses:
        '200':
          description: Started a computation
          content:
            application/json:
              schema:
                type: object
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                type: object

    get:
      summary: Get information about active or inactive computationes
      operationId: comp_manager.api.computation.get
      tags:
        - Computation
      parameters:
        - $ref: "./parameters.yaml#/name"
        - $ref: "./parameters.yaml#/function_name"
        - $ref: "./parameters.yaml#/status"
        - $ref: "./parameters.yaml#/key"
        - $ref: "./parameters.yaml#/id"
        - $ref: "./parameters.yaml#/pid"
        - $ref: "./parameters.yaml#/created_at"
        - $ref: "./parameters.yaml#/updated_at"
        - $ref: "./parameters.yaml#/started_at"
        - $ref: "./parameters.yaml#/finished_at"
        - $ref: "./parameters.yaml#/per_page"
        - $ref: "./parameters.yaml#/page"
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: "./schema.yaml#/ComputationList"
  /computation/{id}:
    get:
      summary: Get information about active or inactive computationes
      operationId: comp_manager.api.computation.get_by_id
      tags:
        - Computation
      parameters:
        - $ref: "./parameters.yaml#/id_path"
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: "./schema.yaml#/Computation"
    put:
      summary: Update a computation object
      operationId: comp_manager.api.computation.put
      tags:
        - Computation
      parameters:
        - $ref: "./parameters.yaml#/id_path"
      requestBody:
        $ref: "./parameters.yaml#/computation_body_update"
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                $ref: "./schema.yaml#/Computation"
        '404':
          description: Not found

    delete:
      summary: Delete a computation object
      operationId: comp_manager.api.computation.delete
      tags:
        - Computation
      parameters:
        - $ref: "./parameters.yaml#/id_path"
      responses:
        '200':
          description: Deleted
          content:
            application/json:
              schema:
                type: object
