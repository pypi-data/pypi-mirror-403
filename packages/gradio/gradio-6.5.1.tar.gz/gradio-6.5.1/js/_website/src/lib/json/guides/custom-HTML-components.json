{"guide": {"name": "custom-HTML-components", "category": "building-with-blocks", "pretty_category": "Building With Blocks", "guide_index": 6, "absolute_index": 12, "pretty_name": "Custom HTML Components", "content": "# Custom Components with `gr.HTML`\n\nIf you wish to create custom HTML in your app, use the `gr.HTML` component. Here's a basic \"HTML-only\" example:\n\n```python\ngr.HTML(value=\"<h1>Hello World!</h1>\")\n```\n\nYou can also use html-templates to organize your HTML. Take a look at the example below:\n\n```python\ngr.HTML(value=\"John\", html_template\"<h1>Hello, {{value}}!</h1><p>${value.length} letters</p>\")\n```\n\n\"John\" becomes `value` when injected into the template, resulting in:\n\n```html\n<h1>Hello, John!</h1><p>4 letters</p>\n```\n\nNotice how we support two types of templating syntaxes: `${}` for custom JavaScript expressions, and `{{}}` for Handlebars templating. You can use either or both in your templates - `${}` allows for completely custom JS logic, while Handlebars provides structured templating for loops and conditionals.\n\nLet's look at another example for displaying a list of items:\n\n```python\ngr.HTML(value=[\"apple\", \"banana\", \"cherry\"], html_templates=\"\"\"\n    <h1>${value.length} fruits:</h1>\n    <ul>\n      {{#each value}}\n        <li>{{this}}</li>\n      {{/each}}\n    </ul>\n\"\"\")\n```\n\nBy default, the content of gr.HTML will have some CSS styles applied to match the Gradio theme. You can disable this with `apply_default_css=False`. You can also provide your own CSS styles via the `css_template` argument as shown in the next example.\n\nLet's build a simple star rating component using `gr.HTML`, and then extend it with more features.\n\n```python\nimport gradio as gr\n\nwith gr.Blocks() as demo:\n    three_star_rating = gr.HTML(\"\"\"\n        <h2>Star Rating:</h2>\n        <img src='https://upload.wikimedia.org/wikipedia/commons/d/df/Award-star-gold-3d.svg'>\n        <img src='https://upload.wikimedia.org/wikipedia/commons/d/df/Award-star-gold-3d.svg'>\n        <img src='https://upload.wikimedia.org/wikipedia/commons/d/df/Award-star-gold-3d.svg'>\n        <img class='faded' src='https://upload.wikimedia.org/wikipedia/commons/d/df/Award-star-gold-3d.svg'>\n        <img class='faded' src='https://upload.wikimedia.org/wikipedia/commons/d/df/Award-star-gold-3d.svg'>\n    \"\"\", css_template=\"\"\"\n        img { height: 50px; display: inline-block; }\n        .faded { filter: grayscale(100%); opacity: 0.3; }\n    \"\"\")\n\ndemo.launch()\n```\n<gradio-app space='gradio/star_rating_simple'></gradio-app>\n\nNote how we used the `css_template` argument to add custom CSS that styles the HTML inside the `gr.HTML` component.\n\nLet's see how the template automatically updates when we update the value.\n\n```python\nimport gradio as gr\n\nwith gr.Blocks() as demo:\n    star_rating = gr.HTML(\n        value=3,\n        html_template=\"\"\"\n        <h2>Star Rating:</h2>\n        ${Array.from({length: 5}, (_, i) => `<img class='${i < value ? '' : 'faded'}' src='https://upload.wikimedia.org/wikipedia/commons/d/df/Award-star-gold-3d.svg'>`).join('')}\"\"\", \n        css_template=\"\"\"\n            img { height: 50px; display: inline-block; }\n            .faded { filter: grayscale(100%); opacity: 0.3; }\n        \"\"\")\n    rating_slider = gr.Slider(0, 5, 3, step=1, label=\"Select Rating\")\n    rating_slider.change(fn=lambda x: x, inputs=rating_slider, outputs=star_rating)\n\ndemo.launch()\n```\n<gradio-app space='gradio/star_rating_templates'></gradio-app>\n\nWe may wish to pass additional props beyond just `value` to the `html_template`. Simply add these props to your templates and pass them as kwargs to the `gr.HTML` component. For example, lets add `size` and `max_stars` props to the star rating component.\n\n```python\nimport gradio as gr\n\nwith gr.Blocks() as demo:\n    star_rating = gr.HTML(\n        7, \n        size=40,\n        max_stars=10,\n        html_template=\"\"\"\n        <h2>Star Rating:</h2>\n        ${Array.from({length: max_stars}, (_, i) => `<img class='${i < value ? '' : 'faded'}' src='https://upload.wikimedia.org/wikipedia/commons/d/df/Award-star-gold-3d.svg'>`).join('')}\"\"\", \n        css_template=\"\"\"\n            img { height: ${size}px; display: inline-block; }\n            .faded { filter: grayscale(100%); opacity: 0.3; }\n        \"\"\"\n    )\n    rating_slider = gr.Slider(0, 10, step=1, label=\"Select Rating\")\n    rating_slider.change(fn=lambda x: x, inputs=rating_slider, outputs=star_rating)\n\n    size_slider = gr.Slider(20, 100, 40, step=1, label=\"Select Size\")\n    size_slider.change(fn=lambda x: gr.HTML(size=x), inputs=size_slider, outputs=star_rating)\n\ndemo.launch()\n```\n<gradio-app space='gradio/star_rating_props'></gradio-app>\n\nNote how both `html_template` and `css_template` can format these extra props. Note also how any of these props can be updated via Gradio event listeners.\n\n## Triggering Events and Custom Input Components\n\nThe `gr.HTML` component can also be used to create custom input components by triggering events. You will provide `js_on_load`, javascript code that runs when the component loads. The code has access to the `trigger` function to trigger events that Gradio can listen to, and the object `props` which has access to all the props of the component, including `value`.\n\n```python\nimport gradio as gr\n\nwith gr.Blocks() as demo:\n    star_rating = gr.HTML(\n        value=3, \n        html_template=\"\"\"\n        <h2>Star Rating:</h2>\n        ${Array.from({length: 5}, (_, i) => `<img class='${i < value ? '' : 'faded'}' src='https://upload.wikimedia.org/wikipedia/commons/d/df/Award-star-gold-3d.svg'>`).join('')}\n        <button id='submit-btn'>Submit Rating</button>\n        \"\"\", \n        css_template=\"\"\"\n            img { height: 50px; display: inline-block; cursor: pointer; }\n            .faded { filter: grayscale(100%); opacity: 0.3; }\n        \"\"\",\n        js_on_load=\"\"\"\n            const imgs = element.querySelectorAll('img');\n            imgs.forEach((img, index) => {\n                img.addEventListener('click', () => {\n                    props.value = index + 1;\n                });\n            });\n            const submitBtn = element.querySelector('#submit-btn');\n            submitBtn.addEventListener('click', () => {\n                trigger('submit');\n            });\n        \"\"\")\n    rating_output = gr.Textbox(label=\"Submitted Rating\")\n    star_rating.submit(lambda x: x, inputs=star_rating, outputs=rating_output)\n\ndemo.launch()\n```\n<gradio-app space='gradio/star_rating_events'></gradio-app>\n\nTake a look at the `js_on_load` code above. We add click event listeners to each star image to update the value via `props.value` when a star is clicked. This also re-renders the template to show the updated value. We also add a click event listener to the submit button that triggers the `submit` event. In our app, we listen to this trigger to run a function that outputs the `value` of the star rating.\n\nYou can update any other props of the component via `props.<prop_name>`, and trigger events via `trigger('<event_name>')`. The trigger event can also be send event data, e.g.\n\n```js\ntrigger('event_name', { key: value, count: 123 });\n```\n\nThis event data will be accessible the Python event listener functions via gr.EventData.\n\n```python\ndef handle_event(evt: gr.EventData):\n    print(evt.key)\n    print(evt.count)\n\nstar_rating.event(fn=handle_event, inputs=[], outputs=[])\n```\n\nKeep in mind that event listeners attached in `js_on_load` are only attached once when the component is first rendered. If your component creates new elements dynamically that need event listeners, attach the event listener to a parent element that exists when the component loads, and check for the target. For example:\n\n```js\nelement.addEventListener('click', (e) =>\n    if (e.target && e.target.matches('.child-element')) {\n        props.value = e.target.dataset.value;\n    }\n);\n```\n\n## Component Classes\n\nIf you are reusing the same HTML component in multiple places, you can create a custom component class by subclassing `gr.HTML` and setting default values for the templates and other arguments. Here's an example of creating a reusable StarRating component.\n\n```python\nimport gradio as gr\n\nclass StarRating(gr.HTML):\n    def __init__(self, label, value=0, **kwargs):\n        html_template = \"\"\"\n        <h2>${label} rating:</h2>\n        ${Array.from({length: 5}, (_, i) => `<img class='${i < value ? '' : 'faded'}' src='https://upload.wikimedia.org/wikipedia/commons/d/df/Award-star-gold-3d.svg'>`).join('')}\n        \"\"\"\n        css_template = \"\"\"\n            img { height: 50px; display: inline-block; cursor: pointer; }\n            .faded { filter: grayscale(100%); opacity: 0.3; }\n        \"\"\"\n        js_on_load = \"\"\"\n            const imgs = element.querySelectorAll('img');\n            imgs.forEach((img, index) => {\n                img.addEventListener('click', () => {\n                    props.value = index + 1;\n                });\n            });\n        \"\"\"\n        super().__init__(value=value, label=label, html_template=html_template, css_template=css_template, js_on_load=js_on_load, **kwargs)\n\n    def api_info(self):\n        return {\"type\": \"integer\", \"minimum\": 0, \"maximum\": 5}\n\n\nwith gr.Blocks() as demo:\n    gr.Markdown(\"# Restaurant Review\")\n    food_rating = StarRating(label=\"Food\", value=3)\n    service_rating = StarRating(label=\"Service\", value=3)\n    ambience_rating = StarRating(label=\"Ambience\", value=3)\n\n    average_btn = gr.Button(\"Calculate Average Rating\")\n\n    rating_output = StarRating(label=\"Average\", value=3)\n    def calculate_average(food, service, ambience):\n        return round((food + service + ambience) / 3)\n    average_btn.click(\n        fn=calculate_average,\n        inputs=[food_rating, service_rating, ambience_rating],\n        outputs=rating_output\n    )\n\ndemo.launch()\n\n```\n<gradio-app space='gradio/star_rating_component'></gradio-app>\n\nNote: Gradio requires all components to accept certain arguments, such as `render`. You do not need\nto handle these arguments, but you do need to accept them in your component constructor and pass\nthem to the parent `gr.HTML` class. Otherwise, your component may not behave correctly. The easiest\nway is to add `**kwargs` to your `__init__` method and pass it to `super().__init__()`, just like in the code example above.\n\nWe've created several custom HTML components as reusable components as examples you can reference in [this directory](https://github.com/gradio-app/gradio/tree/main/gradio/components/custom_html_components).\n\n### API / MCP support\n\nTo make your custom HTML component work with Gradio's built-in support for API and MCP (Model Context Protocol) usage, you need to define how its data should be serialized. There are two ways to do this:\n\n**Option 1: Define an `api_info()` method**\n\nAdd an `api_info()` method that returns a JSON schema dictionary describing your component's data format. This is what we do in the StarRating class above.\n\n**Option 2: Define a Pydantic data model**\n\nFor more complex data structures, you can define a Pydantic model that inherits from `GradioModel` or `GradioRootModel`:\n\n```python\nfrom gradio.data_classes import GradioModel, GradioRootModel\n\nclass MyComponentData(GradioModel):\n    items: List[str]\n    count: int\n\nclass MyComponent(gr.HTML):\n    data_model = MyComponentData\n```\n\nUse `GradioModel` when your data is a dictionary with named fields, or `GradioRootModel` when your data is a simple type (string, list, etc.) that doesn't need to be wrapped in a dictionary. By defining a `data_model`, your component automatically implements API methods.\n\n## Security Considerations\n\nKeep in mind that using `gr.HTML` to create custom components involves injecting raw HTML and JavaScript into your Gradio app. Be cautious about using untrusted user input into `html_template` and `js_on_load`, as this could lead to cross-site scripting (XSS) vulnerabilities. \n\nYou should also expect that any Python event listeners that take your `gr.HTML` component as input could have any arbitrary value passed to them, not just the values you expect the frontend to be able to set for `value`. Sanitize and validate user input appropriately in public applications.\n\n## Next Steps\n\nCheck out some examples of custom components that you can build in [this directory](https://github.com/gradio-app/gradio/tree/main/gradio/components/custom_html_components).", "tags": [], "spaces": [], "url": "/guides/custom-HTML-components/", "contributor": null}}