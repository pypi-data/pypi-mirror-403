{"version":3,"file":"BuilderSettingsArtifactAPITriggerDetails-DAhAKY9C.js","sources":["../../../ui/src/builder/settings/BuilderSettingsArtifactAPITriggerDetails.vue"],"sourcesContent":["<template>\n\t<div class=\"BuilderSettingsArtifactAPITriggerDetails\">\n\t\t<WdsTitle2>Test your trigger</WdsTitle2>\n\t\t<WdsTabs\n\t\t\tv-model=\"tab\"\n\t\t\tclass=\"BuilderSettingsArtifactAPITriggerDetails__tabs\"\n\t\t\t:tabs=\"tabs\"\n\t\t/>\n\t\t<div\n\t\t\tv-if=\"tab === 'builder'\"\n\t\t\tclass=\"BuilderSettingsArtifactAPITriggerDetails__builder\"\n\t\t>\n\t\t\t<div\n\t\t\t\tv-for=\"[fieldKey, fieldValue] in artifactFields\"\n\t\t\t\t:key=\"fieldKey\"\n\t\t\t\tclass=\"BuilderSettingsArtifactAPITriggerDetails__field\"\n\t\t\t>\n\t\t\t\t<!-- Only one field expected in this artifact -->\n\t\t\t\t<WdsFieldWrapper\n\t\t\t\t\t:label=\"fieldValue.name ?? fieldKey\"\n\t\t\t\t\t:hint=\"fieldValue.desc\"\n\t\t\t\t\t:is-expansible=\"true\"\n\t\t\t\t>\n\t\t\t\t\t<BuilderFieldsCode\n\t\t\t\t\t\tv-if=\"fieldValue.type == FieldType.Code\"\n\t\t\t\t\t\t:field-key=\"fieldKey\"\n\t\t\t\t\t\t:component-id=\"component?.id ?? ''\"\n\t\t\t\t\t\t:is-expanded=\"false\"\n\t\t\t\t\t\tinput-language=\"json\"\n\t\t\t\t\t/>\n\t\t\t\t</WdsFieldWrapper>\n\t\t\t</div>\n\t\t</div>\n\n\t\t<div v-else class=\"BuilderSettingsArtifactAPITriggerDetails__api\">\n\t\t\t<ol class=\"BuilderSettingsArtifactAPITriggerDetails__steps\">\n\t\t\t\t<li\n\t\t\t\t\tid=\"stepCreate\"\n\t\t\t\t\tclass=\"BuilderSettingsArtifactAPITriggerDetails__step\"\n\t\t\t\t>\n\t\t\t\t\t<p\n\t\t\t\t\t\tclass=\"BuilderSettingsArtifactAPITriggerDetails__step__hint\"\n\t\t\t\t\t>\n\t\t\t\t\t\tPaste the CURL command into your terminal\n\t\t\t\t\t</p>\n\t\t\t\t\t<WdsButton\n\t\t\t\t\t\tvariant=\"tertiary\"\n\t\t\t\t\t\tsize=\"small\"\n\t\t\t\t\t\t@click=\"copyCreate()\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<WdsIcon\n\t\t\t\t\t\t\t:name=\"isCreateCopied ? 'check' : 'clipboard'\"\n\t\t\t\t\t\t/>\n\n\t\t\t\t\t\tCopy cURL command\n\t\t\t\t\t</WdsButton>\n\t\t\t\t</li>\n\t\t\t\t<li\n\t\t\t\t\tid=\"stepPaste\"\n\t\t\t\t\tclass=\"BuilderSettingsArtifactAPITriggerDetails__step\"\n\t\t\t\t>\n\t\t\t\t\t<p\n\t\t\t\t\t\tclass=\"BuilderSettingsArtifactAPITriggerDetails__step__hint\"\n\t\t\t\t\t>\n\t\t\t\t\t\tOnce the job has run, paste the result here:\n\t\t\t\t\t</p>\n\t\t\t\t\t<WdsTextareaInput\n\t\t\t\t\t\tv-model=\"apiOutput\"\n\t\t\t\t\t\tplaceholder=\"Paste cURL output here\"\n\t\t\t\t\t/>\n\t\t\t\t</li>\n\t\t\t\t<li\n\t\t\t\t\tid=\"stepPoll\"\n\t\t\t\t\tclass=\"BuilderSettingsArtifactAPITriggerDetails__step\"\n\t\t\t\t>\n\t\t\t\t\t<p\n\t\t\t\t\t\tclass=\"BuilderSettingsArtifactAPITriggerDetails__step__hint\"\n\t\t\t\t\t>\n\t\t\t\t\t\tLastly, paste the poll async into your terminal to\n\t\t\t\t\t\tretrieve your artifact\n\t\t\t\t\t</p>\n\t\t\t\t\t<WdsButton\n\t\t\t\t\t\tvariant=\"tertiary\"\n\t\t\t\t\t\tsize=\"small\"\n\t\t\t\t\t\t:disabled=\"isPollDisabled\"\n\t\t\t\t\t\t@click=\"copyPoll()\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<WdsIcon :name=\"isPollCopied ? 'check' : 'clipboard'\" />\n\t\t\t\t\t\tCopy poll async\n\t\t\t\t\t</WdsButton>\n\t\t\t\t</li>\n\t\t\t</ol>\n\t\t</div>\n\t</div>\n</template>\n\n<script setup lang=\"ts\">\nimport { computed, inject, ref } from \"vue\";\nimport injectionKeys from \"@/injectionKeys\";\nimport WdsButton from \"@/wds/WdsButton.vue\";\nimport WdsIcon from \"@/wds/WdsIcon.vue\";\nimport WdsTabs, { WdsTabOptions } from \"@/wds/WdsTabs.vue\";\nimport WdsTextareaInput from \"@/wds/WdsTextareaInput.vue\";\nimport WdsFieldWrapper from \"@/wds/WdsFieldWrapper.vue\";\nimport BuilderFieldsCode from \"./BuilderFieldsCode.vue\";\nimport { useClipboard } from \"@vueuse/core\";\nimport WdsTitle2 from \"@/wds/WdsTitle2.vue\";\nimport { FieldType } from \"@/writerTypes\";\n\nconst wf = inject(injectionKeys.core);\nconst ssbm = inject(injectionKeys.builderManager);\n\nconst component = computed(() =>\n\twf.getComponentById(ssbm.firstSelectedId.value),\n);\nconst blueprintId = computed(() => component.value?.parentId ?? \"\");\n\nconst componentDefinition = computed(() => {\n\tif (!component.value) return null;\n\treturn wf.getComponentDefinition(component.value.type);\n});\n\nconst artifactFields = computed(() => {\n\tconst allFields = componentDefinition.value?.fields ?? {};\n\treturn Object.entries(allFields).filter(([, f]) => f.isArtifactField);\n});\n\nconst baseURL = (wf.writerBaseUrl.value ?? \"https://api.writer.com\").replace(\n\t/\\/+$/,\n\t\"\",\n);\n\nconst curlCreate = computed(\n\t() =>\n\t\t`curl --location --request POST '${baseURL}/v1/agents/${wf.writerAppId.value}/blueprints/${blueprintId.value}/jobs' \\\\` +\n\t\t`\\n--header 'Authorization: Bearer ${wf.writerApiKey.value}' \\\\` +\n\t\t`\\n--header 'Content-Type: application/json' --data '{\"inputs\": []}'`,\n);\n\ntype TabMode = \"builder\" | \"api\";\nconst tabs: WdsTabOptions<TabMode>[] = [\n\t{ label: \"Run in Agent Builder\", value: \"builder\" },\n\t{ label: \"Run via API\", value: \"api\" },\n];\nconst tab = ref<TabMode>(\"builder\");\n\nconst apiOutput = ref(\"\");\nconst parsedOutput = computed(() => {\n\ttry {\n\t\treturn JSON.parse(apiOutput.value);\n\t} catch {\n\t\treturn null;\n\t}\n});\n\nconst { copy: copyCreate, copied: isCreateCopied } = useClipboard({\n\tsource: curlCreate,\n});\n\nconst isPollDisabled = computed(() => {\n\treturn !parsedOutput.value?.poll_url?.trim();\n});\n\nconst curlPoll = computed(() => {\n\tconst pollUrl = parsedOutput.value?.poll_url ?? \"/v1/agents/jobs/JOB_ID\";\n\treturn (\n\t\t`curl --location --request GET '${baseURL}${pollUrl}' \\\\` +\n\t\t`\\n--header 'Authorization: Bearer ${wf.writerApiKey.value}'`\n\t);\n});\n\nconst { copy: copyPoll, copied: isPollCopied } = useClipboard({\n\tsource: curlPoll,\n});\n</script>\n\n<style scoped>\n.WdsTitle2 {\n\tpadding-bottom: 8px;\n}\n.BuilderSettingsArtifactAPITriggerDetails {\n\tdisplay: flex;\n\tflex-direction: column;\n\tgap: 8px;\n\tpadding: 24px;\n}\n.BuilderSettingsArtifactAPITriggerDetails__tabs {\n\tgap: 10px;\n}\n.BuilderSettingsArtifactAPITriggerDetails__builder,\n.BuilderSettingsArtifactAPITriggerDetails__api {\n\tdisplay: flex;\n\tflex-direction: column;\n\tgap: 8px;\n\tmargin-top: 8px;\n}\n.BuilderSettingsArtifactAPITriggerDetails__steps {\n\tdisplay: flex;\n\tflex-direction: column;\n\tgap: 8px;\n\tlist-style-type: decimal;\n\tpadding-left: 16px;\n}\n.BuilderSettingsArtifactAPITriggerDetails__step:first-of-type\n\t> .BuilderSettingsArtifactAPITriggerDetails__step__hint {\n\tmargin-top: 0;\n}\n.BuilderSettingsArtifactAPITriggerDetails__step__hint {\n\tmargin: 12px 0;\n}\n</style>\n<style>\n.BuilderSettingsArtifactAPITriggerDetails__tabs > .WdsTab {\n\tfont-size: 12px;\n\tpadding: 2px 8px;\n}\n</style>\n"],"names":["wf","inject","injectionKeys","ssbm","component","computed","blueprintId","_a","componentDefinition","artifactFields","allFields","f","baseURL","curlCreate","tabs","tab","ref","apiOutput","parsedOutput","copyCreate","isCreateCopied","useClipboard","isPollDisabled","_b","curlPoll","pollUrl","copyPoll","isPollCopied"],"mappings":"g+BA6GM,MAAAA,EAAKC,EAAOC,EAAc,IAAI,EAC9BC,EAAOF,EAAOC,EAAc,cAAc,EAE1CE,EAAYC,EAAS,IAC1BL,EAAG,iBAAiBG,EAAK,gBAAgB,KAAK,CAAA,EAEzCG,EAAcD,EAAS,IAAM,OAAA,QAAAE,EAAAH,EAAU,QAAV,YAAAG,EAAiB,WAAY,GAAE,EAE5DC,EAAsBH,EAAS,IAC/BD,EAAU,MACRJ,EAAG,uBAAuBI,EAAU,MAAM,IAAI,EADxB,IAE7B,EAEKK,EAAiBJ,EAAS,IAAM,OACrC,MAAMK,IAAYH,EAAAC,EAAoB,QAApB,YAAAD,EAA2B,SAAU,CAAA,EAChD,OAAA,OAAO,QAAQG,CAAS,EAAE,OAAO,CAAC,CAAA,CAAGC,CAAC,IAAMA,EAAE,eAAe,CAAA,CACpE,EAEKC,GAAWZ,EAAG,cAAc,OAAS,0BAA0B,QACpE,OACA,EAAA,EAGKa,EAAaR,EAClB,IACC,mCAAmCO,CAAO,cAAcZ,EAAG,YAAY,KAAK,eAAeM,EAAY,KAAK;AAAA,kCACvEN,EAAG,aAAa,KAAK;AAAA,kEAAA,EAKtDc,EAAiC,CACtC,CAAE,MAAO,uBAAwB,MAAO,SAAU,EAClD,CAAE,MAAO,cAAe,MAAO,KAAM,CAAA,EAEhCC,EAAMC,EAAa,SAAS,EAE5BC,EAAYD,EAAI,EAAE,EAClBE,EAAeb,EAAS,IAAM,CAC/B,GAAA,CACI,OAAA,KAAK,MAAMY,EAAU,KAAK,CAAA,MAC1B,CACA,OAAA,IACR,CAAA,CACA,EAEK,CAAE,KAAME,EAAY,OAAQC,CAAA,EAAmBC,EAAa,CACjE,OAAQR,CAAA,CACR,EAEKS,EAAiBjB,EAAS,IAAM,SACrC,MAAO,GAACkB,GAAAhB,EAAAW,EAAa,QAAb,YAAAX,EAAoB,WAApB,MAAAgB,EAA8B,OAAK,CAC3C,EAEKC,EAAWnB,EAAS,IAAM,OACzB,MAAAoB,IAAUlB,EAAAW,EAAa,QAAb,YAAAX,EAAoB,WAAY,yBAE/C,MAAA,kCAAkCK,CAAO,GAAGa,CAAO;AAAA,kCACdzB,EAAG,aAAa,KAAK,GAAA,CAE3D,EAEK,CAAE,KAAM0B,EAAU,OAAQC,CAAA,EAAiBN,EAAa,CAC7D,OAAQG,CAAA,CACR"}