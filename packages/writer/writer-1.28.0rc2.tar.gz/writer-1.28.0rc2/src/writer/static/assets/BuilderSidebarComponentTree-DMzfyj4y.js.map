{"version":3,"file":"BuilderSidebarComponentTree-DMzfyj4y.js","sources":["../../../ui/src/builder/sidebar/composables/useComponentsTreeSearch.ts","../../../ui/src/builder/sidebar/BuilderSidebarComponentTreeBranch.vue","../../../ui/src/builder/sidebar/BuilderSidebarComponentTree.vue"],"sourcesContent":["import type { generateCore } from \"@/core\";\nimport { computed, ComputedRef, Ref } from \"vue\";\nimport { Component } from \"@/writerTypes\";\n\nexport function useComponentsTreeSearch(\n\twf: ReturnType<typeof generateCore>,\n\tquery: ComputedRef<string> | Ref<string>,\n) {\n\tfunction isComponentMatchingQuery(component: Component) {\n\t\tif (!query.value) return true;\n\n\t\tconst def = wf.getComponentDefinition(component.type);\n\t\tif (def?.name.toLocaleLowerCase().includes(query.value)) return true;\n\n\t\tconst matchingFields = Object.values(component.content).filter(\n\t\t\t(fieldContent) =>\n\t\t\t\ttypeof fieldContent === \"string\" &&\n\t\t\t\tfieldContent.toLocaleLowerCase().includes(query.value),\n\t\t);\n\t\tif (matchingFields.length > 0) return true;\n\n\t\treturn false;\n\t}\n\n\treturn { isComponentMatchingQuery };\n}\n\nexport function useComponentsTreeSearchResults(\n\twf: ReturnType<typeof generateCore>,\n\tquery: ComputedRef<string> | Ref<string>,\n\trootId: ComputedRef<Component[\"id\"]>,\n) {\n\tconst { isComponentMatchingQuery } = useComponentsTreeSearch(wf, query);\n\n\tconst searchResultCount = computed<undefined | number>(() => {\n\t\tif (!query.value) return undefined;\n\t\tlet count = 0;\n\n\t\tfor (const c of wf.getComponentsNested(rootId.value)) {\n\t\t\tif (isComponentMatchingQuery(c)) count++;\n\t\t}\n\t\treturn count;\n\t});\n\n\treturn { searchResultCount };\n}\n\nexport function useComponentsTreeSearchForComponent(\n\twf: ReturnType<typeof generateCore>,\n\tquery: ComputedRef<string> | Ref<string>,\n\tcomponent: ComputedRef<Component>,\n) {\n\tconst { isComponentMatchingQuery } = useComponentsTreeSearch(wf, query);\n\n\tconst matched = computed(\n\t\t() => !query.value || isComponentMatchingQuery(component.value),\n\t);\n\n\tconst hasMatchingChildren = computed(() => {\n\t\tif (!query.value) return true;\n\t\tfor (const c of wf.getComponentsNested(component.value.id)) {\n\t\t\tif (isComponentMatchingQuery(c)) return true;\n\t\t}\n\t\treturn false;\n\t});\n\n\treturn { hasMatchingChildren, matched };\n}\n","<template>\n\t<BuilderTree\n\t\tv-if=\"component\"\n\t\tref=\"treeBranch\"\n\t\tclass=\"BuilderSidebarComponentTreeBranch\"\n\t\t:component-id=\"componentId\"\n\t\t:name=\"name\"\n\t\t:query=\"query\"\n\t\t:has-children=\"children.length > 0\"\n\t\t:data-automation-key=\"component.type\"\n\t\t:draggable=\"isDraggingAllowed(componentId)\"\n\t\t:matched=\"matched\"\n\t\t:selected=\"selected\"\n\t\t:variant=\"\n\t\t\tCOMPONENT_TYPES_TOP_LEVEL.has(component.type) ? 'root' : undefined\n\t\t\"\n\t\t:disable-collapse=\"COMPONENT_TYPES_ROOT.has(component.type)\"\n\t\t:no-nested-space=\"COMPONENT_TYPES_ROOT.has(component.type)\"\n\t\t:collapsed=\"isOutsideActivePage\"\n\t\t:right-click-options=\"rightClickDropdownOptions\"\n\t\t:dropdown-options=\"\n\t\t\tcomponent?.type === 'blueprints_blueprint' &&\n\t\t\tisDeleteAllowed(props.componentId)\n\t\t\t\t? rightClickDropdownOptions\n\t\t\t\t: undefined\n\t\t\"\n\t\t@select=\"select\"\n\t\t@dropdown-select=\"handleDropdownSelect($event)\"\n\t\t@dragover=\"handleDragOver\"\n\t\t@dragstart=\"handleDragStart\"\n\t\t@dragend=\"handleDragEnd\"\n\t\t@drop=\"handleDrop\"\n\t>\n\t\t<template #nameRight>\n\t\t\t<span class=\"BuilderSidebarComponentTreeBranch__nameRight\">\n\t\t\t\t<template\n\t\t\t\t\tv-if=\"Object.keys(component.handlers ?? {}).length > 0\"\n\t\t\t\t>\n\t\t\t\t\t<span class=\"middot\"></span>\n\t\t\t\t\t<WdsIcon name=\"zap\" />\n\t\t\t\t</template>\n\t\t\t\t<template v-if=\"!isComponentVisible(component.id)\">\n\t\t\t\t\t<span class=\"middot\"></span>\n\t\t\t\t\t<WdsIcon name=\"eye-off\" />\n\t\t\t\t</template>\n\t\t\t\t<template v-if=\"component.isCodeManaged\">\n\t\t\t\t\t<span class=\"middot\"></span>\n\t\t\t\t\t<WdsIcon name=\"square-terminal\" />\n\t\t\t\t</template>\n\t\t\t\t<template v-if=\"previewText\">\n\t\t\t\t\t<span class=\"middot\"></span\n\t\t\t\t\t><span class=\"previewText\">{{ previewText }}</span>\n\t\t\t\t</template>\n\t\t\t</span>\n\t\t</template>\n\n\t\t<template #children>\n\t\t\t<BuilderSidebarComponentTreeBranch\n\t\t\t\tv-for=\"childComponent in children\"\n\t\t\t\t:key=\"childComponent.id\"\n\t\t\t\t:component-id=\"childComponent.id\"\n\t\t\t\t:query=\"query\"\n\t\t\t\t@expand-branch=\"expand\"\n\t\t\t\t@delete=\"$emit('delete', $event)\"\n\t\t\t/>\n\t\t</template>\n\t</BuilderTree>\n</template>\n\n<script setup lang=\"ts\">\nimport injectionKeys from \"@/injectionKeys\";\nimport {\n\tComponentPublicInstance,\n\tcomputed,\n\tinject,\n\tnextTick,\n\tref,\n\twatch,\n} from \"vue\";\nimport BuilderSidebarComponentTreeBranch from \"./BuilderSidebarComponentTreeBranch.vue\";\nimport { useEvaluator } from \"@/renderer/useEvaluator\";\nimport { useDragDropComponent } from \"../useDragDropComponent\";\nimport { useComponentActions } from \"../useComponentActions\";\n\nimport BuilderTree from \"../BuilderTree.vue\";\nimport { useComponentsTreeSearchForComponent } from \"./composables/useComponentsTreeSearch\";\nimport { useComponentDescription } from \"../useComponentDescription\";\nimport { useWriterTracking } from \"@/composables/useWriterTracking\";\nimport {\n\tCOMPONENT_TYPES_PAGE,\n\tCOMPONENT_TYPES_ROOT,\n\tCOMPONENT_TYPES_TOP_LEVEL,\n} from \"@/constants/component\";\nimport WdsIcon from \"@/wds/WdsIcon.vue\";\nimport type { WdsDropdownMenuOption } from \"@/wds/WdsDropdownMenu.vue\";\n\nconst props = defineProps({\n\tcomponentId: { type: String, required: true },\n\tquery: { type: String, required: false, default: \"\" },\n});\n\nconst treeBranch = ref<ComponentPublicInstance<typeof BuilderTree>>();\n\nconst rightClickDropdownOptions: WdsDropdownMenuOption[] = [\n\t{ label: \"Delete\", value: \"delete\", icon: \"trash-2\" },\n];\nconst wf = inject(injectionKeys.core);\nconst wfbm = inject(injectionKeys.builderManager);\nconst selected = computed(() => wfbm.isComponentIdSelected(props.componentId));\n\nconst tracking = useWriterTracking(wf);\nconst {\n\tcreateAndInsertComponent,\n\tmoveComponent,\n\tgoToComponentParentPage,\n\tisDraggingAllowed,\n\tisDeleteAllowed,\n} = useComponentActions(wf, wfbm, tracking);\nconst { getComponentInfoFromDrag, removeInsertionCandidacy, isParentSuitable } =\n\tuseDragDropComponent(wf);\nconst { isComponentVisible } = useEvaluator(wf);\nconst emits = defineEmits([\"expandBranch\", \"delete\"]);\n\nconst q = computed(() => props.query?.toLocaleLowerCase() ?? \"\");\n\nconst component = computed(() => wf.getComponentById(props.componentId));\n\nconst { hasMatchingChildren, matched } = useComponentsTreeSearchForComponent(\n\twf,\n\tq,\n\tcomponent,\n);\n\nwatch(\n\thasMatchingChildren,\n\t(value) => treeBranch.value?.toggleCollapse(!value),\n\t{\n\t\timmediate: true,\n\t},\n);\n\nconst children = computed(() => {\n\treturn wf\n\t\t.getComponents(props.componentId, { sortedByPosition: true })\n\t\t.filter(\n\t\t\t(c) => wf.getComponentDefinition(c.type)?.category !== \"Internal\",\n\t\t);\n});\n\nconst { name, previewText } = useComponentDescription(wf, component);\n\nasync function select(ev: MouseEvent | KeyboardEvent) {\n\tgoToComponentParentPage(props.componentId);\n\tawait nextTick();\n\twfbm.handleSelectionFromEvent(ev, props.componentId, undefined, \"tree\");\n\texpand();\n}\n\nfunction expand() {\n\tif (!treeBranch.value) return;\n\ttreeBranch.value.expand();\n\temits(\"expandBranch\");\n}\n\nfunction scrollToShow() {\n\tconst treeBranchEl = treeBranch.value?.$el as HTMLDivElement;\n\tif (!treeBranchEl) return;\n\tconst treeEl = treeBranchEl.closest(\".BuilderSidebarComponentTree\");\n\tconst treeBCR = treeEl.getBoundingClientRect();\n\tconst top = treeBranch.value.$el.offsetTop - treeBCR.height / 2;\n\tconst left = treeBranch.value.$el.offsetLeft - treeBCR.left - 16;\n\ttreeEl.scrollTo({ top, left: Math.max(0, left), behavior: \"smooth\" });\n}\n\nfunction handleDragStart(ev: DragEvent) {\n\twfbm.setSelection(null);\n\tev.dataTransfer.setData(\n\t\t`application/json;writer=${component.value.type},${component.value.id}`,\n\t\t\"{}\",\n\t);\n}\n\nfunction handleDragEnd(ev: DragEvent) {\n\tremoveInsertionCandidacy(ev);\n}\n\nfunction handleDragOver(ev: DragEvent) {\n\tconst dragInfo = getComponentInfoFromDrag(ev);\n\tif (!dragInfo) return;\n\tconst { draggedType, draggedId } = dragInfo;\n\tif (!isParentSuitable(props.componentId, draggedId, draggedType)) return;\n\tev.preventDefault();\n}\n\nfunction handleDrop(ev: DragEvent) {\n\tconst dragInfo = getComponentInfoFromDrag(ev);\n\tif (!dragInfo) return;\n\tconst { draggedType, draggedId, sourceBlueprintId } = dragInfo;\n\n\tif (!draggedId) {\n\t\tconst initProperties = sourceBlueprintId\n\t\t\t? { content: { sourceBlueprintId } }\n\t\t\t: undefined;\n\n\t\tcreateAndInsertComponent(\n\t\t\tdraggedType,\n\t\t\tcomponent.value.id,\n\t\t\tundefined,\n\t\t\tinitProperties,\n\t\t);\n\t} else {\n\t\tmoveComponent(draggedId, component.value.id);\n\t}\n\n\tremoveInsertionCandidacy(ev);\n}\n\nfunction handleDropdownSelect(action: string) {\n\tif (action === \"delete\" && isDeleteAllowed(props.componentId)) {\n\t\temits(\"delete\", props.componentId);\n\t}\n}\n\nconst isOutsideActivePage = computed(() => {\n\tif (!wf.activePageId.value) return false;\n\n\t// activate page can be relative to UI or Blueprint\n\tconst isActivePageMatchingMode = wf\n\t\t.getComponents(wfbm.activeRootId.value)\n\t\t.some((c) => c.id === wf.activePageId.value);\n\n\tconst isPage = COMPONENT_TYPES_PAGE.has(component.value.type);\n\n\treturn (\n\t\tisPage &&\n\t\tisActivePageMatchingMode &&\n\t\tprops.componentId !== wf.activePageId.value\n\t);\n});\n\nwatch(wf.activePageId, () => {\n\tif (wf.activePageId.value && isOutsideActivePage.value) {\n\t\ttreeBranch.value?.toggleCollapse(true);\n\t}\n});\n\nwatch(\n\twfbm.firstSelectedItem,\n\tasync (newSelection) => {\n\t\tif (!newSelection) return;\n\t\tif (newSelection.componentId !== props.componentId) return;\n\t\tif (newSelection.source == \"tree\") return;\n\t\texpand();\n\t\tawait nextTick();\n\t\tscrollToShow();\n\t},\n\t{ immediate: true },\n);\n</script>\n\n<style scoped>\n.BuilderSidebarComponentTreeBranch {\n\tmin-width: 170px;\n}\n.BuilderSidebarComponentTreeBranch__nameRight {\n\tdisplay: flex;\n\talign-items: center;\n\tgap: 4px;\n\n\tflex-wrap: nowrap;\n\ttext-wrap: nowrap;\n\ttext-overflow: ellipsis;\n\tmin-width: 0;\n}\n\n.previewText {\n\tflex-wrap: nowrap;\n\ttext-wrap: nowrap;\n\tflex-grow: 1;\n\twhite-space: nowrap;\n\ttext-overflow: ellipsis;\n\toverflow: hidden;\n}\n\n.middot {\n\tdisplay: inline-block;\n\tborder-radius: 3px;\n\twidth: 3px;\n\tmin-width: 3px;\n\theight: 3px;\n\tbackground: var(--builderSecondaryTextColor);\n\topacity: 0.5;\n}\n</style>\n","<template>\n\t<BuilderSidebarPanel\n\t\tv-model=\"query\"\n\t\tclass=\"BuilderSidebarComponentTree\"\n\t\tplaceholder=\"Component tree\"\n\t\t:search-count=\"searchResultCount\"\n\t>\n\t\t<div v-if=\"rootComponentId == 'root'\">\n\t\t\t<BuilderSidebarComponentTreeBranch\n\t\t\t\tclass=\"rootBranch\"\n\t\t\t\t:component-id=\"rootComponentId\"\n\t\t\t\t:query=\"query\"\n\t\t\t\t@delete=\"handleComponentDelete\"\n\t\t\t/>\n\t\t</div>\n\n\t\t<div v-else-if=\"rootComponentId == 'blueprints_root'\" class=\"sections\">\n\t\t\t<div\n\t\t\t\tv-for=\"section in blueprintSections\"\n\t\t\t\t:key=\"section.key\"\n\t\t\t\tclass=\"section\"\n\t\t\t>\n\t\t\t\t<div class=\"section__header\">\n\t\t\t\t\t<span class=\"section__title\">{{ section.title }}</span>\n\t\t\t\t\t<WdsButton\n\t\t\t\t\t\tvariant=\"neutral\"\n\t\t\t\t\t\tsize=\"smallIcon\"\n\t\t\t\t\t\t:data-automation-action=\"section.addAction\"\n\t\t\t\t\t\t@click=\"section.onAdd\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<WdsIcon name=\"plus\" />\n\t\t\t\t\t</WdsButton>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"section__content\">\n\t\t\t\t\t<BuilderSidebarComponentTreeBranch\n\t\t\t\t\t\tv-for=\"blueprint in section.items\"\n\t\t\t\t\t\t:key=\"blueprint.id\"\n\t\t\t\t\t\t:component-id=\"blueprint.id\"\n\t\t\t\t\t\t:query=\"query\"\n\t\t\t\t\t\t@delete=\"handleComponentDelete\"\n\t\t\t\t\t/>\n\t\t\t\t\t<div\n\t\t\t\t\t\tv-if=\"section.items.length === 0\"\n\t\t\t\t\t\tclass=\"section__empty\"\n\t\t\t\t\t>\n\t\t\t\t\t\t{{ section.emptyText }}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\n\t\t<template #footer>\n\t\t\t<div class=\"add\">\n\t\t\t\t<WdsButton\n\t\t\t\t\tv-if=\"rootComponentId == 'root'\"\n\t\t\t\t\tvariant=\"special\"\n\t\t\t\t\tsize=\"small\"\n\t\t\t\t\tdata-automation-action=\"add-page\"\n\t\t\t\t\t@click=\"addPage\"\n\t\t\t\t>\n\t\t\t\t\t<WdsIcon name=\"plus\" />\n\t\t\t\t\tAdd page\n\t\t\t\t</WdsButton>\n\t\t\t\t<WdsButton\n\t\t\t\t\tv-if=\"rootComponentId == 'blueprints_root'\"\n\t\t\t\t\tvariant=\"special\"\n\t\t\t\t\tsize=\"small\"\n\t\t\t\t\tdata-automation-action=\"add-blueprint-footer\"\n\t\t\t\t\t@click=\"addBlueprint\"\n\t\t\t\t>\n\t\t\t\t\t<WdsIcon name=\"plus\" />\n\t\t\t\t\tAdd blueprint\n\t\t\t\t</WdsButton>\n\t\t\t</div>\n\t\t</template>\n\t</BuilderSidebarPanel>\n</template>\n\n<script setup lang=\"ts\">\nimport { computed, inject, nextTick, ref } from \"vue\";\nimport BuilderSidebarPanel from \"./BuilderSidebarPanel.vue\";\nimport injectionKeys from \"@/injectionKeys\";\nimport BuilderSidebarComponentTreeBranch from \"./BuilderSidebarComponentTreeBranch.vue\";\nimport WdsButton from \"@/wds/WdsButton.vue\";\nimport WdsIcon from \"@/wds/WdsIcon.vue\";\nimport { useComponentActions } from \"../useComponentActions\";\nimport { useComponentsTreeSearchResults } from \"./composables/useComponentsTreeSearch\";\nimport { useWriterTracking } from \"@/composables/useWriterTracking\";\nimport {\n\tisSharedBlueprint,\n\tSHARED_BLUEPRINT_FLAG_VALUE,\n} from \"@/utils/sharedBlueprint\";\n\nconst wf = inject(injectionKeys.core);\nconst wfbm = inject(injectionKeys.builderManager);\nconst query = ref(\"\");\n\nconst tracking = useWriterTracking(wf);\nconst { createAndInsertComponent, setContentValue, removeComponentSubtree } =\n\tuseComponentActions(wf, wfbm, tracking);\n\nconst rootComponentId = wfbm.activeRootId;\n\nconst { searchResultCount } = useComponentsTreeSearchResults(\n\twf,\n\tquery,\n\trootComponentId,\n);\n\nconst allBlueprints = computed(() => {\n\treturn wf.getComponents(\"blueprints_root\", { sortedByPosition: true });\n});\n\nconst regularBlueprints = computed(() => {\n\treturn allBlueprints.value.filter((c) => !isSharedBlueprint(c));\n});\n\nconst sharedBlueprintItems = computed(() => {\n\treturn allBlueprints.value.filter((c) => isSharedBlueprint(c));\n});\n\nconst blueprintSections = computed(() => {\n\tconst sections = [\n\t\t{\n\t\t\tkey: \"blueprints\",\n\t\t\ttitle: \"Blueprints\",\n\t\t\titems: regularBlueprints.value,\n\t\t\taddAction: \"add-blueprint\",\n\t\t\tonAdd: addBlueprint,\n\t\t\temptyText: \"No blueprints yet\",\n\t\t},\n\t];\n\n\tif (wf.featureFlags.value?.includes(\"shared_blueprints\")) {\n\t\tsections.push({\n\t\t\tkey: \"shared-blueprints\",\n\t\t\ttitle: \"Shared Blueprints\",\n\t\t\titems: sharedBlueprintItems.value,\n\t\t\taddAction: \"add-shared-blueprint\",\n\t\t\tonAdd: addSharedBlueprint,\n\t\t\temptyText: \"No shared blueprints yet\",\n\t\t});\n\t}\n\n\treturn sections;\n});\n\nasync function addPage() {\n\tconst pageId = createAndInsertComponent(\"page\", \"root\");\n\twf.setActivePageId(pageId);\n\tawait nextTick();\n\twfbm.setSelection(pageId);\n\ttracking.track(\"ui_page_added\");\n}\n\nasync function addBlueprint() {\n\tconst key = getNewBlueprintKey();\n\n\tconst pageId = createAndInsertComponent(\n\t\t\"blueprints_blueprint\",\n\t\t\"blueprints_root\",\n\t\tundefined,\n\t\tkey\n\t\t\t? {\n\t\t\t\t\tcontent: {\n\t\t\t\t\t\tkey,\n\t\t\t\t\t},\n\t\t\t\t}\n\t\t\t: undefined,\n\t);\n\n\tawait nextTick();\n\twf.setActivePageId(pageId);\n\twfbm.setSelection(pageId);\n\ttracking.track(\"blueprints_new_added\");\n}\n\nfunction getNewBlueprintKey() {\n\tconst existingKeys = allBlueprints.value\n\t\t.map((bp) => bp.content?.key)\n\t\t.filter((key) => key?.startsWith(\"BLUEPRINT_\"))\n\t\t.map((key) => Number.parseInt(key.replace(\"BLUEPRINT_\", \"\"), 10))\n\t\t.filter((num) => !Number.isNaN(num));\n\n\tconst maxIndex =\n\t\texistingKeys.length > 0\n\t\t\t? Math.max(...existingKeys)\n\t\t\t: allBlueprints.value.length + 10;\n\treturn `BLUEPRINT_${maxIndex + 1}`;\n}\n\nasync function addSharedBlueprint() {\n\tconst pageId = createAndInsertComponent(\n\t\t\"blueprints_blueprint\",\n\t\t\"blueprints_root\",\n\t);\n\tsetContentValue(pageId, \"isSharedBlueprint\", SHARED_BLUEPRINT_FLAG_VALUE);\n\twf.setActivePageId(pageId);\n\tawait nextTick();\n\twfbm.setSelection(pageId);\n\ttracking.track(\"blueprints_shared_added\");\n}\n\nfunction handleComponentDelete(componentId: string) {\n\tremoveComponentSubtree(componentId);\n}\n</script>\n\n<style scoped>\n.BuilderSidebarComponentTree {\n\theight: 100%;\n\tposition: relative;\n}\n\n.category .header {\n\tfont-size: 12px;\n\tfont-weight: 500;\n\tline-height: 12px; /* 100% */\n\tletter-spacing: 1.3px;\n\ttext-transform: uppercase;\n\tcolor: var(--builderSecondaryTextColor);\n\tmargin-bottom: 16px;\n}\n\n.rootBranch {\n\tflex: 1 0 auto;\n}\n\n.tools {\n\tdisplay: grid;\n\tgrid-template-columns: 24px 1fr;\n\tgrid-template-rows: auto;\n\tpadding: 0 8px 0 8px;\n\trow-gap: 12px;\n\tcolumn-gap: 4px;\n}\n\n.add {\n\tflex: 0 0 var(--builderPanelSwitcherHeight);\n\tbottom: 0;\n\theight: var(--builderPanelSwitcherHeight);\n\tdisplay: flex;\n\talign-items: center;\n\tjustify-content: center;\n\tborder-top: 1px solid var(--builderSeparatorColor);\n\tbackground: var(--builderBackgroundColor);\n}\n\n.sections {\n\tdisplay: flex;\n\tflex-direction: column;\n\tgap: 16px;\n}\n\n.section {\n\tdisplay: flex;\n\tflex-direction: column;\n}\n\n.section__header {\n\tdisplay: flex;\n\talign-items: center;\n\tjustify-content: space-between;\n\tpadding: 8px 16px;\n\tborder-bottom: 1px solid var(--builderSeparatorColor);\n}\n\n.section__title {\n\tfont-size: 11px;\n\tfont-weight: 600;\n\ttext-transform: uppercase;\n\tletter-spacing: 0.5px;\n\tcolor: var(--builderSecondaryTextColor);\n}\n\n.section__content {\n\tpadding: 8px 0;\n}\n\n.section__empty {\n\tpadding: 8px 16px;\n\tfont-size: 12px;\n\tcolor: var(--builderSecondaryTextColor);\n\tfont-style: italic;\n}\n</style>\n"],"names":["useComponentsTreeSearch","wf","query","isComponentMatchingQuery","component","def","fieldContent","useComponentsTreeSearchResults","rootId","computed","count","useComponentsTreeSearchForComponent","matched","props","__props","treeBranch","ref","rightClickDropdownOptions","inject","injectionKeys","wfbm","selected","tracking","useWriterTracking","createAndInsertComponent","moveComponent","goToComponentParentPage","isDraggingAllowed","isDeleteAllowed","useComponentActions","getComponentInfoFromDrag","removeInsertionCandidacy","isParentSuitable","useDragDropComponent","isComponentVisible","useEvaluator","emits","__emit","q","_a","hasMatchingChildren","watch","value","children","c","name","previewText","useComponentDescription","select","ev","nextTick","expand","scrollToShow","treeBranchEl","treeEl","treeBCR","top","left","handleDragStart","handleDragEnd","handleDragOver","dragInfo","draggedType","draggedId","handleDrop","sourceBlueprintId","initProperties","handleDropdownSelect","action","isOutsideActivePage","isActivePageMatchingMode","COMPONENT_TYPES_PAGE","newSelection","setContentValue","removeComponentSubtree","rootComponentId","searchResultCount","allBlueprints","regularBlueprints","isSharedBlueprint","sharedBlueprintItems","blueprintSections","sections","addBlueprint","addSharedBlueprint","addPage","pageId","key","getNewBlueprintKey","existingKeys","bp","num","SHARED_BLUEPRINT_FLAG_VALUE","handleComponentDelete","componentId"],"mappings":"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"}