import{u as E}from"./useBlueprintRun-DWmMgV1z.js";import{d as j,c as S,m as I,r as J,a_ as M,a$ as P,o as c,f as g,g as b,J as N,x as l,y as v,z as _,K as G,R as w,S as A,as as K,G as F,_ as x,i as D,a as $,D as L,E as Y,W as T,t as W,b0 as H,Y as Q,b as R,A as z,ae as U}from"./index-C1IizHaQ.js";const X=["disabled"],Z=["disabled"],tt=j({__name:"WdsButtonSplit",props:{variant:{type:String,default:"primary"},size:{type:String,default:"default"},disabled:{type:Boolean,required:!1}},emits:{mainClick:()=>!0,dropdownOpen:()=>!0,dropdownClose:()=>!0},setup(u,{expose:C,emit:m}){const a=u,d=S(()=>[`WdsButtonSplit--size-${a.size}`,`WdsButtonSplit--variant-${a.variant}`,a.disabled?"WdsButtonSplit--disabled":void 0]),f=m,e=I("btn"),o=I("dropdown"),n=J(!1),{floatingStyles:r}=M(e,o,{placement:"bottom-end",middleware:[P(12)]});function s(B=!n.value){n.value=B,n.value?f("dropdownOpen"):f("dropdownClose")}return C({toggleDropdown:s}),(B,p)=>(c(),g("div",{ref_key:"btn",ref:e,class:F(["WdsButtonSplit",d.value])},[b("button",{type:"button",class:"WdsButtonSplit__main",disabled:u.disabled,onClick:p[0]||(p[0]=y=>B.$emit("mainClick"))},[N(B.$slots,"button",{},void 0,!0)],8,X),p[2]||(p[2]=b("hr",{class:"WdsButtonSplit__divider"},null,-1)),b("button",{class:"WdsButtonSplit__dropdownTrigger",type:"button",disabled:u.disabled,onClickCapture:p[1]||(p[1]=y=>s())},[l(v,{name:n.value?"chevron-up":"chevron-down"},null,8,["name"])],40,Z),l(K,null,{default:_(()=>[n.value?(c(),g("div",{key:0,ref_key:"dropdown",ref:o,style:G(w(r))},[N(B.$slots,"dropdown",{},void 0,!0)],4)):A("",!0)]),_:3})],2))}}),et=x(tt,[["__scopeId","data-v-e9224293"]]),nt={class:"BlueprintToolbarBlocksDropdown"},ot={class:"BlueprintToolbarBlocksDropdown__list"},st={class:"BlueprintToolbarBlocksDropdown__list__item__description"},at={class:"BlueprintToolbarBlocksDropdown__list__item__title"},rt=j({__name:"BlueprintToolbarBlocksDropdown",props:{components:{type:Array,required:!0}},emits:{jumpToComponent:u=>typeof u=="string",runBranch:u=>typeof u=="string"},setup(u){const C=u,m=D($.core);function a(e){const o=m.getComponentDefinition(e.type);return(o==null?void 0:o.name)??e.type}function d(e){if(e.type!=="blueprints_uieventtrigger"||!!e.content.defaultResult)return!0;const n=(e.outs??[]).map(s=>m.getComponentById(s.toNodeId)).flatMap(s=>Object.values(s.content??{}));return n.length===0?!0:!n.some(s=>s.includes("@{result}"))}const f=S(()=>C.components.map(e=>{var s;const o=m.getComponentDefinition(e.type),n=((s=e.content)==null?void 0:s.alias)||a(e),r=(o==null?void 0:o.name)??e.type;return{id:e.id,disabled:!d(e),title:n,description:n===r?void 0:r}}));return(e,o)=>(c(),g("div",nt,[o[0]||(o[0]=b("p",{class:"BlueprintToolbarBlocksDropdown__header"}," Start blueprint from ",-1)),b("div",ot,[(c(!0),g(L,null,Y(f.value,n=>(c(),g("div",{key:n.id,class:F(["BlueprintToolbarBlocksDropdown__list__item",{"BlueprintToolbarBlocksDropdown__list__item--disabled":n.disabled}])},[l(T,{variant:"primary",size:"smallIcon","custom-size":"20px",disabled:n.disabled,"data-writer-tooltip":n.disabled?"Can not run without a default result. Go to this block to define a default result.":"Run the branch",onClick:r=>e.$emit("runBranch",n.id)},{default:_(()=>[l(v,{name:"play"})]),_:2},1032,["disabled","data-writer-tooltip","onClick"]),b("div",null,[b("p",st,W(n.description),1),b("p",at,W(n.title),1)]),l(T,{variant:"neutral",size:"smallIcon","custom-size":"20px","data-writer-tooltip":"Jump to the blueprint",onClick:r=>e.$emit("jumpToComponent",n.id)},{default:_(()=>[l(v,{name:"square-dashed-mouse-pointer"})]),_:2},1032,["onClick"])],2))),128))])]))}}),lt=x(rt,[["__scopeId","data-v-e0d0a711"]]),it={ref:"root",class:"BlueprintToolbar","data-writer-unselectable":!0},ut=j({__name:"BlueprintToolbar",emits:{autogenClick:()=>!0,deploy:()=>!0},setup(u,{emit:C}){const m=C,a=D($.core),d=D($.builderManager),f=D($.componentId),e=I("runBlueprintBtn"),{run:o,stop:n,isRunning:r}=E(a,d,f),s=S(()=>Array.isArray(a.featureFlags.value)&&a.featureFlags.value.includes("blueprint_library")),B=S(()=>{const i=a.getComponentById(f);return H(i)}),p=S(()=>a.getComponents(f).filter(i=>{var t;return((t=a.getComponentDefinition(i.type))==null?void 0:t.category)==="Triggers"})),y=Q([]);function O(){y.value=U(d.selection.value),d.setSelection(null)}function q(){var i;if((i=y.value)!=null&&i.length){d.setSelection(null);for(const t of y.value)d.appendSelection(t.componentId,t.instancePath,t.source);y.value=[]}}function V(i){var t;d.setSelection(i,void 0,"click"),(t=e.value)==null||t.toggleDropdown(!1)}async function h(i){var t;(t=e.value)==null||t.toggleDropdown(!1),await o(i)}return(i,t)=>(c(),g("div",it,[l(T,{variant:"tertiary",size:"icon","data-automation-action":"run-autogen","data-writer-tooltip":"Autogen","data-writer-tooltip-placement":"bottom",onClick:t[0]||(t[0]=k=>m("autogenClick"))},{default:_(()=>[l(v,{name:"wand-sparkles"})]),_:1}),s.value&&B.value?(c(),R(T,{key:0,variant:"special","data-automation-action":"publish-shared-blueprint","data-writer-tooltip":"Publish this shared blueprint","data-writer-tooltip-placement":"bottom",onClick:t[1]||(t[1]=k=>m("deploy"))},{default:_(()=>[l(v,{name:"rocket"}),t[5]||(t[5]=z(" Publish blueprint "))]),_:1})):A("",!0),p.value.length&&!w(r)?(c(),R(et,{key:1,ref_key:"runBlueprintBtn",ref:e,class:"BlueprintToolbar__runBlueprintDropdown",variant:"special",onMainClick:t[3]||(t[3]=k=>h()),onDropdownOpen:O,onDropdownClose:q},{button:_(()=>[l(v,{name:"play"}),t[6]||(t[6]=z(" Run blueprint "))]),dropdown:_(()=>[l(lt,{components:p.value,onJumpToComponent:V,onRunBranch:t[2]||(t[2]=k=>h(k))},null,8,["components"])]),_:1},512)):(c(),R(T,{key:2,class:"BlueprintToolbar__runBlueprint","data-automation-action":"run-blueprint",variant:"special",onClick:t[4]||(t[4]=k=>w(r)?w(n)():h())},{default:_(()=>[l(v,{name:w(r)?"square":"play"},null,8,["name"]),z(" "+W(w(r)?"Stop run":"Run blueprint"),1)]),_:1}))],512))}}),ct=x(ut,[["__scopeId","data-v-5b7eb059"]]);export{ct as default};
//# sourceMappingURL=BlueprintToolbar-Bgw2pXeV.js.map
