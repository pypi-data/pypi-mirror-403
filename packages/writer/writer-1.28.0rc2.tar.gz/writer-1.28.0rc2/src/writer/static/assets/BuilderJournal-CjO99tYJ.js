function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = ["./BuilderEmbeddedCodeEditor-CY65_X2M.js","./index-C1IizHaQ.js","./index-BFl0hGbo.css","./BuilderEmbeddedCodeEditor-DwW24RYH.css"]
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
import{d as O,ap as N,c as f,o,f as d,x as m,aw as fe,g as n,R as x,bt as q,b as h,z as I,A as W,W as R,S as g,_ as $,an as re,y as B,G as H,t as y,bu as oe,D as G,r as V,w as be,bv as ke,ar as he,T as Te,bw as F,ao as Be,Q as Oe,V as ue,E as ie,bx as de,aq as $e,J as ae,by as we,ac as Je,i as se,a as le,Y as Ee,q as xe,bz as Ie,bA as je,ax as Ce}from"./index-C1IizHaQ.js";import{W as ce}from"./WdsTabs-CJTYrdrm.js";import Se from"./SharedCopyClipboardButton-6Jnavq2l.js";import"./WdsDropdownMenu-Ba7OuweF.js";import"./WdsCheckbox-BYkw_Bvq.js";const De=Object.freeze([{value:"success",label:"Success"},{value:"error",label:"Error"},{value:"stopped",label:"Stopped"}]),Le=Object.freeze([{value:"On demand",label:"On demand"},{value:"UI",label:"UI"},{value:"API",label:"API"},{value:"Cron",label:"Scheduled"}]),Re=Object.freeze([{value:"editor",label:"Editor"},{value:"agent",label:"Agent"}]),Ve=Object.freeze([{value:"execution",label:"Executions"},{value:"init",label:"Initialization"}]),Ae=Object.freeze([{label:"Outputs",value:"outputs"},{label:"Metadata",value:"metadata"},{label:"Raw JSON",value:"raw"}]),Ne={class:"BuilderJournalSearchbar"},ze={class:"BuilderJournalSearchbar__dropdown"},Ue={class:"BuilderJournalSearchbar__dropdown"},Me={class:"BuilderJournalSearchbar__dropdown"},Pe={class:"BuilderJournalSearchbar__dropdown"},qe=O({__name:"BuilderJournalSearchbar",props:{search:{type:String,required:!0},searchModifiers:{},filters:{type:Object,required:!0},filtersModifiers:{}},emits:["update:search","update:filters"],setup(t){const l=N(t,"search"),e=N(t,"filters"),r=f(()=>!!l.value||e.value.statuses.length>0||e.value.triggers.length>0||e.value.instanceTypes.length>0||e.value.entryTypes.length>0);function u(){l.value="",e.value={statuses:[],triggers:[],instanceTypes:[],entryTypes:[]}}return(b,a)=>(o(),d("div",Ne,[m(fe,{modelValue:l.value,"onUpdate:modelValue":a[0]||(a[0]=v=>l.value=v),"left-icon":"search",maxlength:"200"},null,8,["modelValue"]),n("div",ze,[m(q,{modelValue:e.value.statuses,"onUpdate:modelValue":a[1]||(a[1]=v=>e.value.statuses=v),options:x(De),"enable-multi-selection":"",placeholder:"Status"},null,8,["modelValue","options"])]),n("div",Ue,[m(q,{modelValue:e.value.triggers,"onUpdate:modelValue":a[2]||(a[2]=v=>e.value.triggers=v),options:x(Le),"enable-multi-selection":"",placeholder:"Trigger"},null,8,["modelValue","options"])]),n("div",Me,[m(q,{modelValue:e.value.instanceTypes,"onUpdate:modelValue":a[3]||(a[3]=v=>e.value.instanceTypes=v),options:x(Re),"enable-multi-selection":"",placeholder:"Instance Type"},null,8,["modelValue","options"])]),n("div",Pe,[m(q,{modelValue:e.value.entryTypes,"onUpdate:modelValue":a[4]||(a[4]=v=>e.value.entryTypes=v),options:x(Ve),"enable-multi-selection":"",placeholder:"Entry Type"},null,8,["modelValue","options"])]),r.value?(o(),h(R,{key:0,"data-writer-tooltip":"Clear filters","data-writer-tooltip-placement":"bottom",variant:"neutral",onClick:u},{default:I(()=>a[5]||(a[5]=[W(" Clear ")])),_:1})):g("",!0)]))}}),We=$(qe,[["__scopeId","data-v-9fb41dfb"]]),Fe={class:"BuilderJournalHeader"},Ge={class:"BuilderJournalHeader__actions"},He=O({__name:"BuilderJournalHeader",props:{search:{required:!0},searchModifiers:{},filters:{required:!0},filtersModifiers:{}},emits:re({refresh:()=>!0,clear:()=>!0,download:()=>!0},["update:search","update:filters"]),setup(t,{emit:l}){const e=l,r=N(t,"search"),u=N(t,"filters");return(b,a)=>(o(),d("div",Fe,[m(We,{search:r.value,"onUpdate:search":a[0]||(a[0]=v=>r.value=v),filters:u.value,"onUpdate:filters":a[1]||(a[1]=v=>u.value=v)},null,8,["search","filters"]),n("div",Ge,[m(R,{"data-writer-tooltip":"Refresh journal","data-writer-tooltip-placement":"left",variant:"neutral",size:"smallIcon",onClick:a[2]||(a[2]=v=>e("refresh"))},{default:I(()=>[m(B,{name:"refresh-cw"})]),_:1}),m(R,{"data-writer-tooltip":"Clear journal","data-writer-tooltip-placement":"left",variant:"neutral",size:"smallIcon",onClick:a[3]||(a[3]=v=>e("clear"))},{default:I(()=>[m(B,{name:"trash-2"})]),_:1}),m(R,{"data-writer-tooltip":"Download as JSON","data-writer-tooltip-placement":"left",variant:"neutral",size:"smallIcon",onClick:a[4]||(a[4]=v=>e("download"))},{default:I(()=>[m(B,{name:"download"})]),_:1})])]))}}),Ye=$(He,[["__scopeId","data-v-76e4949c"]]),Ke={class:"BuilderJournalEntryResult__image"},Qe=O({__name:"BuilderJournalEntryResult",props:{result:{type:String,required:!0}},setup(t){return(l,e)=>(o(),d("div",{class:H(["BuilderJournalEntryResult",t.result])},[n("div",Ke,[t.result==="success"?(o(),h(B,{key:0,name:"check"})):t.result==="error"?(o(),h(B,{key:1,name:"triangle-alert"})):t.result==="stopped"?(o(),h(B,{key:2,name:"octagon-pause"})):g("",!0)])],2))}}),Xe=$(Qe,[["__scopeId","data-v-692d93e0"]]);function me(t,l={dateOptions:{year:"numeric",month:"short",day:"numeric"},timeOptions:{hour:"numeric",minute:"2-digit",second:"2-digit",hour12:!0}}){const{dateOptions:e,timeOptions:r}=l,u=f(()=>t.value.toLocaleDateString(void 0,e)),b=f(()=>t.value.toLocaleTimeString(void 0,r));return{formattedDate:u,formattedTime:b}}const Ze={class:"BuilderJournalEntry__summary"},et={key:1,class:"BuilderJournalEntry__summary__init-badge"},tt={class:"BuilderJournalEntry__summary__content"},nt={class:"BuilderJournalEntry__summary__component"},ot={class:"BuilderJournalEntry__summary__instanceType"},at={class:"BuilderJournalEntry__info"},st={class:"BuilderJournalEntry__info__datetime"},lt={class:"BuilderJournalEntry__info__datetime__time"},rt={class:"BuilderJournalEntry__info__details"},ut=O({__name:"BuilderJournalEntry",props:{journalEntry:{type:Object,required:!0}},emits:["click"],setup(t){const l=t,e=f(()=>new Date(l.journalEntry.timestamp)),{formattedDate:r,formattedTime:u}=me(e,{dateOptions:{year:"numeric",month:"short",day:"numeric"},timeOptions:{hour:"numeric",minute:"2-digit",second:"2-digit",hour12:!0}});return(b,a)=>(o(),d("div",{class:"BuilderJournalEntry BuilderJournalEntry--clickable",onClick:a[0]||(a[0]=v=>b.$emit("click"))},[n("div",Ze,[t.journalEntry.entryType==="execution"?(o(),h(Xe,{key:0,result:t.journalEntry.result},null,8,["result"])):(o(),d("div",et,[m(B,{name:"settings"})])),n("div",tt,[n("div",nt,y(t.journalEntry.title),1),n("div",ot,y(t.journalEntry.instanceTypeLabel),1)])]),n("div",at,[n("div",st,[n("div",null,y(x(r)),1),n("div",lt,y(x(u)),1)]),n("div",rt,y(t.journalEntry.entryType==="execution"?t.journalEntry.trigger.type:"Initialization"),1)])]))}}),it=$(ut,[["__scopeId","data-v-f518d002"]]),dt={class:"header"},ct={class:"header__title"},mt={class:"header__meta"},pt={key:0},yt={key:1},vt=O({__name:"BuilderJournalEntryHeader",props:{entry:{type:Object,required:!0}},setup(t){const l=t,e=f(()=>{const a=new Date(l.entry.timestamp);return Number.isNaN(a.getTime())?new Date:a}),{formattedDate:r,formattedTime:u}=me(e,{dateOptions:{year:"numeric",month:"short",day:"numeric"},timeOptions:{hour:"numeric",minute:"2-digit",second:"2-digit",hour12:!0}}),b=f(()=>l.entry.entryType!=="execution"?"neutral":{success:"success",error:"error",stopped:"warning"}[l.entry.result]||"neutral");return(a,v)=>(o(),d("div",dt,[n("div",ct,[n("h3",null,y(t.entry.title),1),t.entry.entryType==="execution"?(o(),h(oe,{key:0,text:t.entry.result.toUpperCase(),variant:b.value},null,8,["text","variant"])):(o(),h(oe,{key:1,text:"INIT",variant:"neutral"}))]),n("div",mt,[n("span",null,y(x(r))+" "+y(x(u)),1),n("span",null,y(t.entry.instanceTypeLabel),1),t.entry.entryType==="execution"?(o(),d("span",pt,y(t.entry.trigger.type),1)):(o(),d("span",yt,y(t.entry.mode),1))])]))}}),_t=$(vt,[["__scopeId","data-v-fdb05a8b"]]),gt={class:"actions"},ft=O({__name:"BuilderJournalEntryActions",props:{entry:{type:Object,required:!0}},emits:["re-run","go-to-trigger","download"],setup(t){const l=t,e=f(()=>l.entry.entryType==="execution"?JSON.stringify(l.entry.blockOutputs,null,2):JSON.stringify({stdout:l.entry.stdout,logs:l.entry.logs},null,2));return(r,u)=>(o(),d("div",gt,[t.entry.entryType==="execution"?(o(),d(G,{key:0},[m(R,{variant:"neutral",size:"small",type:"button",onClick:u[0]||(u[0]=b=>r.$emit("re-run"))},{default:I(()=>[m(B,{name:"play"}),u[3]||(u[3]=W(" Re-run "))]),_:1}),m(R,{variant:"neutral",size:"small",type:"button",onClick:u[1]||(u[1]=b=>r.$emit("go-to-trigger"))},{default:I(()=>[m(B,{name:"locate"}),u[4]||(u[4]=W(" Go to Trigger "))]),_:1})],64)):g("",!0),m(R,{variant:"neutral",size:"small",type:"button",onClick:u[2]||(u[2]=b=>r.$emit("download"))},{default:I(()=>[m(B,{name:"download"}),u[5]||(u[5]=W(" Download JSON "))]),_:1}),m(Se,{value:e.value,text:"Copy Output",variant:"neutral",size:"small",label:"Copy output to clipboard"},null,8,["value"])]))}}),bt=$(ft,[["__scopeId","data-v-d27dc0c3"]]),kt=["role","tabindex"],ht={key:0,class:"BuilderJournalBlockOutput__title-container"},Tt={class:"BuilderJournalBlockOutput__title"},Bt={class:"BuilderJournalBlockOutput__icon"},Ot={key:1},$t={class:"BuilderJournalBlockOutput__meta"},wt={class:"BuilderJournalBlockOutput__status"},Jt={key:0,class:"BuilderJournalBlockOutput__timing"},Et={key:0},xt={key:1},It={class:"BuilderJournalBlockOutput__tabs"},jt={class:"BuilderJournalBlockOutput__tab-content"},Ct={key:0,class:"BuilderJournalBlockOutput__message"},St={class:"BuilderJournalBlockOutput__message-content"},Dt={key:1,class:"BuilderJournalBlockOutput__log-section"},Lt={class:"BuilderJournalBlockOutput__log-content"},Rt={key:2,class:"BuilderJournalBlockOutput__log-section"},Vt={class:"BuilderJournalBlockOutput__log-content"},At={key:3,class:"BuilderJournalBlockOutput__result-section"},Nt=O({__name:"BuilderJournalBlockOutput",props:{blockId:{type:String,required:!0},output:{type:Object,required:!0},index:{type:Number,required:!0}},emits:["go-to-block"],setup(t){const l=t,e=f(()=>{var i;return(i=l.output.executions)==null?void 0:i[0]}),r=V(""),u=f(()=>{if(!e.value)return[];const i=[];return e.value.message&&i.push({label:"Error",value:"error"}),e.value.stdout&&i.push({label:"Stdout",value:"stdout"}),e.value.logs&&i.push({label:"Logs",value:"logs"}),i.push({label:"Result",value:"result"}),i});be(u,i=>{if(!i.length){r.value="";return}i.some(_=>_.value===r.value)||(r.value=i[0].value)},{immediate:!0});function b(i){return new Date(i*1e3).toLocaleTimeString(void 0,{hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!0})}function a(i){return i<1?`${(i*1e3).toFixed(0)}ms`:`${i.toFixed(2)}s`}const v={success:"BuilderJournalBlockOutput--success",trigger:"BuilderJournalBlockOutput--trigger",skipped:"BuilderJournalBlockOutput--skipped",error:"BuilderJournalBlockOutput--error",stopped:"BuilderJournalBlockOutput--skipped"},S=f(()=>v[e.value.outcome]||"BuilderJournalBlockOutput--success");function D(i,_){return[`/components/${i}.svg`,`/components/blueprints_category_${_}.svg`,"/components/category_Blocks.svg"].map(T=>F(T))}return(i,_)=>{var L,T,j,w,J;return e.value?(o(),d("div",{key:0,class:H(["BuilderJournalBlockOutput",S.value])},[n("div",{class:"BuilderJournalBlockOutput__header",role:t.blockId?"button":void 0,tabindex:t.blockId?"0":void 0,onClick:_[0]||(_[0]=C=>t.blockId&&i.$emit("go-to-block",t.blockId)),onKeydown:_[1]||(_[1]=he(C=>t.blockId&&i.$emit("go-to-block",t.blockId),["enter"]))},[t.blockId?(o(),d("div",ht,[n("h4",Tt,y(((L=t.output.component)==null?void 0:L.title)||`Block ${t.index+1}`),1),n("div",Bt,[m(B,{name:"locate"})])])):(o(),d("h4",Ot,y(((T=t.output.component)==null?void 0:T.title)||`Block ${t.index+1}`),1)),(j=t.output.component)!=null&&j.type?(o(),h(ke,{key:2,class:"BuilderJournalBlockOutput__type-icon",alt:`${t.output.component.type} icon`,urls:D((w=t.output.component)==null?void 0:w.type,(J=t.output.component)==null?void 0:J.category),"loader-max-width-px":32,"loader-max-height-px":32},null,8,["alt","urls"])):g("",!0)],40,kt),n("div",$t,[n("div",wt,[n("span",null,"Outcome: "+y(e.value.outcome),1)]),e.value.startedAt!==void 0||e.value.executionTimeInSeconds!==void 0?(o(),d("div",Jt,[e.value.startedAt!==void 0?(o(),d("span",Et," Started: "+y(b(e.value.startedAt)),1)):g("",!0),e.value.executionTimeInSeconds!==void 0?(o(),d("span",xt," Duration: "+y(a(e.value.executionTimeInSeconds)),1)):g("",!0)])):g("",!0)]),n("div",It,[m(ce,{"model-value":r.value,tabs:u.value,variant:"bar","onUpdate:modelValue":_[2]||(_[2]=C=>r.value=C)},null,8,["model-value","tabs"])]),n("div",jt,[e.value.message&&r.value==="error"?(o(),d("div",Ct,[n("div",St,y(e.value.message),1)])):g("",!0),e.value.stdout&&r.value==="stdout"?(o(),d("div",Dt,[n("pre",Lt,y(e.value.stdout),1)])):g("",!0),e.value.logs&&r.value==="logs"?(o(),d("div",Rt,[n("pre",Vt,y(e.value.logs),1)])):g("",!0),r.value==="result"?(o(),d("div",At,[m(Te,{data:e.value.result,"is-root":"","is-root-open":"","enable-copy-to-json":""},null,8,["data"])])):g("",!0)])],2)):g("",!0)}}}),zt=$(Nt,[["__scopeId","data-v-5fcb3a02"]]),Ut={key:0,class:"output-block output-block--init"},Mt={class:"output-block__log-content"},Pt={key:1,class:"output-block output-block--init"},qt={class:"output-block__log-content"},Wt={key:2,class:"output-block output-block--init"},Ft=O({__name:"BuilderJournalInitLogOutput",props:{entry:{type:Object,required:!0}},setup(t){return(l,e)=>(o(),d("div",null,[t.entry.stdout?(o(),d("div",Ut,[e[0]||(e[0]=n("h4",{class:"output-block__title"},"Stdout",-1)),n("pre",Mt,y(t.entry.stdout),1)])):g("",!0),t.entry.logs?(o(),d("div",Pt,[e[1]||(e[1]=n("h4",{class:"output-block__title"},"Logs",-1)),n("pre",qt,y(t.entry.logs),1)])):g("",!0),!t.entry.stdout&&!t.entry.logs?(o(),d("div",Wt,e[2]||(e[2]=[n("p",{style:{color:"var(--wdsColorGray5)",margin:"0"}}," No logs captured during initialization. ",-1)]))):g("",!0)]))}}),Gt=$(Ft,[["__scopeId","data-v-57b9f71c"]]),Ht={class:"metadata"},Yt={class:"metadata__section"},Kt={class:"metadata__row"},Qt={class:"metadata__row"},Xt={class:"metadata__row"},Zt={class:"metadata__row"},en={class:"metadata__section"},tn={class:"metadata__row"},nn={class:"metadata__row"},on={class:"metadata__row"},an={key:1,class:"metadata__section"},sn={class:"metadata__row"},ln={class:"metadata__row"},rn={class:"metadata__row"},un=O({__name:"BuilderJournalMetadata",props:{entry:{type:Object,required:!0}},setup(t){return(l,e)=>(o(),d("div",Ht,[t.entry.entryType==="execution"?(o(),d(G,{key:0},[n("div",Yt,[e[4]||(e[4]=n("h4",null,"Trigger Information",-1)),n("div",Kt,[e[0]||(e[0]=n("span",{class:"label"},"Type:",-1)),n("span",null,y(t.entry.trigger.type),1)]),n("div",Qt,[e[1]||(e[1]=n("span",{class:"label"},"Event:",-1)),n("span",null,y(t.entry.trigger.event),1)]),n("div",Xt,[e[2]||(e[2]=n("span",{class:"label"},"Component ID:",-1)),n("span",null,y(t.entry.trigger.component.id),1)]),n("div",Zt,[e[3]||(e[3]=n("span",{class:"label"},"Component Type:",-1)),n("span",null,y(t.entry.trigger.component.type),1)])]),n("div",en,[e[8]||(e[8]=n("h4",null,"Execution Information",-1)),n("div",tn,[e[5]||(e[5]=n("span",{class:"label"},"Timestamp:",-1)),n("span",null,y(t.entry.timestamp),1)]),n("div",nn,[e[6]||(e[6]=n("span",{class:"label"},"Instance Type:",-1)),n("span",null,y(t.entry.instanceTypeLabel),1)]),n("div",on,[e[7]||(e[7]=n("span",{class:"label"},"Result:",-1)),n("span",null,y(t.entry.result),1)])])],64)):(o(),d("div",an,[e[12]||(e[12]=n("h4",null,"Initialization Information",-1)),n("div",sn,[e[9]||(e[9]=n("span",{class:"label"},"Timestamp:",-1)),n("span",null,y(t.entry.timestamp),1)]),n("div",ln,[e[10]||(e[10]=n("span",{class:"label"},"Instance Type:",-1)),n("span",null,y(t.entry.instanceTypeLabel),1)]),n("div",rn,[e[11]||(e[11]=n("span",{class:"label"},"Mode:",-1)),n("span",null,y(t.entry.mode),1)])]))]))}}),dn=$(un,[["__scopeId","data-v-db75cdb6"]]),cn={class:"BuilderJournalEntryDetails"},mn={class:"tabs-wrapper"},pn={class:"content"},yn={key:0,class:"outputs"},vn={key:2,class:"raw"},_n=O({__name:"BuilderJournalEntryDetails",props:{entry:{type:Object,required:!0}},emits:["reRun","goToTrigger","goToBlock"],setup(t,{emit:l}){const e=Be({loader:()=>Oe(()=>import("./BuilderEmbeddedCodeEditor-CY65_X2M.js").then(T=>T.B),__vite__mapDeps([0,1,2,3]),import.meta.url)}),r=t,u=l,{pushToast:b}=ue(),a=V("outputs"),v=f(()=>r.entry.entryType!=="execution"?[]:Object.entries(r.entry.blockOutputs).sort((j,w)=>{var A,z,U,M;const J=((z=(A=j[1].executions)==null?void 0:A[0])==null?void 0:z.startedAt)??1/0,C=((M=(U=w[1].executions)==null?void 0:U[0])==null?void 0:M.startedAt)??1/0;return J-C})),S=f(()=>JSON.stringify(r.entry,null,2));function D(){u("reRun",r.entry)}function i(){u("goToTrigger",r.entry)}function _(T){u("goToBlock",T)}function L(){try{de(r.entry,`journal-entry-${r.entry.timestamp}.json`)}catch{b({type:"error",message:"Failed to download file"})}}return(T,j)=>(o(),d("div",cn,[m(_t,{entry:t.entry},null,8,["entry"]),m(bt,{entry:t.entry,onReRun:D,onGoToTrigger:i,onDownload:L},null,8,["entry"]),n("div",mn,[m(ce,{modelValue:a.value,"onUpdate:modelValue":j[0]||(j[0]=w=>a.value=w),tabs:x(Ae),variant:"bar"},null,8,["modelValue","tabs"])]),n("div",pn,[a.value==="outputs"?(o(),d("div",yn,[t.entry.entryType==="init"?(o(),h(Gt,{key:0,entry:t.entry},null,8,["entry"])):(o(!0),d(G,{key:1},ie(v.value,([w,J],C)=>(o(),h(zt,{key:w,"block-id":w,output:J,index:C,onGoToBlock:_},null,8,["block-id","output","index"]))),128))])):g("",!0),a.value==="metadata"?(o(),h(dn,{key:1,entry:t.entry},null,8,["entry"])):g("",!0),a.value==="raw"?(o(),d("div",vn,[m(x(e),{"model-value":S.value,language:"json",variant:"full",disabled:""},null,8,["model-value"])])):g("",!0)])]))}}),gn=$(_n,[["__scopeId","data-v-385aaea3"]]),fn={class:"WdsDrawer__header"},bn={class:"WdsDrawer__header__title"},kn={class:"WdsDrawer__content"},hn=O({__name:"WdsDrawer",props:re({title:{type:String,default:""},size:{type:String,default:"medium"}},{modelValue:{type:Boolean,required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(t){const l=N(t,"modelValue");function e(){l.value=!1}return(r,u)=>(o(),h(Je,{to:"#drawer"},[m(we,{name:"drawer"},{default:I(()=>[l.value?(o(),d("div",{key:0,class:"WdsDrawer__overlay",onClick:e},[n("div",{class:H(["WdsDrawer__container",`WdsDrawer__container--${t.size}`]),onClick:u[0]||(u[0]=$e(()=>{},["stop"]))},[n("div",fn,[ae(r.$slots,"header",{},()=>[n("h2",bn,y(t.title),1)],!0),m(R,{variant:"neutral",size:"icon",onClick:e},{default:I(()=>[m(B,{name:"x"})]),_:1})]),n("div",kn,[ae(r.$slots,"default",{},void 0,!0)])],2)])):g("",!0)]),_:3})]))}}),Tn=$(hn,[["__scopeId","data-v-b8ac3791"]]),Bn={class:"BuilderJournal"},On={key:0,class:"BuilderJournal__loading"},$n={key:1,class:"BuilderJournal__entries"},wn=O({name:"BuilderJournal",__name:"BuilderJournal",setup(t){const{pushToast:l}=ue(),e=se(le.core),r=se(le.builderManager),{goToComponentParentPage:u,selectChild:b}=Ce(e,r),a=V({}),v=V({}),S=V(!1),D=V(""),i=V({statuses:[],triggers:[],instanceTypes:[],entryTypes:[]}),_=Ee(null),L=f({get:()=>!!_.value,set:c=>{c||(_.value=null)}}),T=f(()=>Object.fromEntries(Object.entries(a.value).map(([c,p])=>{const s=e.getComponentById(p.trigger.component.id);if(!s)return[c,null];const k=e.getComponentDefinition(s==null?void 0:s.type),E=s.type==="blueprints_blueprint"?s.content.key:s.content.alias||k.name,P=p.instanceType.charAt(0).toUpperCase()+p.instanceType.slice(1);return[c,{...p,title:E,instanceTypeLabel:P,component:s,componentDefinition:k,entryType:"execution"}]}))),j=f(()=>Object.fromEntries(Object.entries(v.value).map(([c,p])=>{const s=p.instanceType.charAt(0).toUpperCase()+p.instanceType.slice(1),k=p.mode.charAt(0).toUpperCase()+p.mode.slice(1);return[c,{...p,title:`Initialization - ${k}`,instanceTypeLabel:s,entryType:"init"}]}))),w=f(()=>({...T.value,...j.value})),J=f(()=>{const c=D.value.toLowerCase();return Object.fromEntries(Object.entries(w.value).filter(([p,s])=>{var Y,K,Q,X,Z,ee,te,ne;if(!s)return!1;const k=i.value.entryTypes.length===0||i.value.entryTypes.includes(s.entryType);let E=D.value==="";E||(s.entryType==="execution"?E=(K=(Y=s.title)==null?void 0:Y.toLowerCase())==null?void 0:K.includes(c):E=((X=(Q=s.title)==null?void 0:Q.toLowerCase())==null?void 0:X.includes(c))||((ee=(Z=s.stdout)==null?void 0:Z.toLowerCase())==null?void 0:ee.includes(c))||((ne=(te=s.logs)==null?void 0:te.toLowerCase())==null?void 0:ne.includes(c)));const P=i.value.instanceTypes.length===0||i.value.instanceTypes.includes(s.instanceType);if(s.entryType==="execution"){const _e=i.value.statuses.length===0||i.value.statuses.includes(s.result),ge=i.value.triggers.length===0||i.value.triggers.includes(s.trigger.type);return E&&_e&&ge&&P&&k}return E&&P&&k}))}),C=f(()=>{const c=Object.entries(J.value).filter(([p,s])=>s!==null).sort(([p,s],[k,E])=>new Date(E.timestamp).getTime()-new Date(s.timestamp).getTime());return Object.fromEntries(c)});async function A(){Object.keys(T.value).length===0&&(S.value=!0);try{const[c,p]=await Promise.all([fetch(F("/api/data/retrieve"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({key_contains:"wf-journal-",skip_keys:Object.keys(a.value)})}),fetch(F("/api/data/retrieve"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({key_contains:"wf-init-logs-",skip_keys:Object.keys(v.value)})})]);if(!c.ok||!p.ok){l({type:"error",message:"Failed to fetch the execution history"}),S.value=!1;return}const[s,k]=await Promise.all([c.json(),p.json()]);a.value={...a.value,...s.result},v.value={...v.value,...k.result}}catch{l({type:"error",message:"Failed to fetch the execution history"})}finally{S.value=!1}}const z=()=>{const c=Object.fromEntries(Object.keys(J.value).map(p=>[p,a.value[p]||v.value[p]]));de(c,"agent-journal.json")};async function U(){let c;try{c=await fetch(F("/api/data/delete"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({keys:Object.keys(J.value)})})}catch{l({type:"error",message:"Failed to delete the execution history"});return}if(!c.ok){l({type:"error",message:"Failed to delete the execution history"});return}const p={...a.value},s={...v.value};for(const k of Object.keys(J.value))delete p[k],delete s[k];a.value=p,v.value=s}function M(c){_.value=c}function pe(c){c.entryType==="execution"&&l({type:"info",message:`Re-run functionality for ${c.title} will be implemented soon`})}function ye(c){c.entryType==="execution"&&(u(c.trigger.component.id),b(c.trigger.component.id)?(l({type:"success",message:`Jumped to ${c.title}`}),_.value=null):l({type:"error",message:"Trigger not found! It might have been deleted."}))}function ve(c){u(c),b(c)?(l({type:"success",message:"Jumped to block"}),_.value=null):l({type:"error",message:"Block not found! It might have been deleted."})}return xe(()=>{A()}),Ie(()=>{A()}),(c,p)=>(o(),d("div",Bn,[m(Ye,{search:D.value,"onUpdate:search":p[0]||(p[0]=s=>D.value=s),filters:i.value,"onUpdate:filters":p[1]||(p[1]=s=>i.value=s),onRefresh:A,onClear:U,onDownload:z},null,8,["search","filters"]),S.value?(o(),d("div",On,[m(je),p[3]||(p[3]=n("p",null,"Loading entries...",-1))])):(o(),d("div",$n,[(o(!0),d(G,null,ie(C.value,(s,k)=>(o(),h(it,{key:k,"journal-entry":s,onClick:E=>M(s)},null,8,["journal-entry","onClick"]))),128))])),m(Tn,{modelValue:L.value,"onUpdate:modelValue":p[2]||(p[2]=s=>L.value=s),title:"Execution Details",size:"large"},{default:I(()=>[_.value?(o(),h(gn,{key:0,entry:_.value,onReRun:pe,onGoToTrigger:ye,onGoToBlock:ve},null,8,["entry"])):g("",!0)]),_:1},8,["modelValue"])]))}}),Cn=$(wn,[["__scopeId","data-v-f064db3a"]]);export{Cn as default};
//# sourceMappingURL=BuilderJournal-CjO99tYJ.js.map
