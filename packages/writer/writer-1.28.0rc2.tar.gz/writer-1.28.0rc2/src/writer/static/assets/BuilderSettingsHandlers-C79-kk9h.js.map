{"version":3,"file":"BuilderSettingsHandlers-C79-kk9h.js","sources":["../../../ui/src/builder/BuilderBlueprintState.vue","../../../ui/src/composables/useComponentBlueprints.ts","../../../ui/src/builder/settings/BuilderSettingsHandlersBlueprint.vue","../../../ui/src/builder/settings/BuilderSettingsHandlers.vue"],"sourcesContent":["<script setup lang=\"ts\">\nimport injectionKeys from \"@/injectionKeys\";\nimport WdsLoaderDots from \"@/wds/WdsLoaderDots.vue\";\nimport WdsIcon from \"@/wds/WdsIcon.vue\";\nimport { WdsColor } from \"@/wds/tokens\";\nimport { computed, inject } from \"vue\";\n\nconst props = defineProps({\n\tblueprintId: { type: String, required: true },\n});\n\nconst core = inject(injectionKeys.core);\nconst wfbm = inject(injectionKeys.builderManager);\n\nconst blueprintBlocks = computed(() => core.getComponents(props.blueprintId));\nconst blueprintBlocksId = computed(() =>\n\tblueprintBlocks.value.map((b) => b.id),\n);\n\nconst result = computed(() => {\n\tconst logs = wfbm.getLogEntries().filter((l) => {\n\t\tif (!l.blueprintExecution) return false;\n\n\t\tconst isRelated = l.blueprintExecution.summary.some((v) =>\n\t\t\tblueprintBlocksId.value.includes(v.componentId),\n\t\t);\n\t\treturn isRelated;\n\t});\n\n\tconst message = logs.at(0)?.blueprintExecution.summary.at(-1);\n\tif (!message) return undefined;\n\n\tif (message.outcome === \"in_progress\") return \"in_progress\";\n\n\tconst component = core.getComponentById(message.componentId);\n\tconst def = core.getComponentDefinition(component.type);\n\n\treturn def.outs?.[message.outcome]?.style ?? \"success\";\n});\n</script>\n\n<template>\n\t<div class=\"BuilderBlueprintState\">\n\t\t<slot v-if=\"!result\" name=\"unknown\"></slot>\n\t\t<slot v-else-if=\"result === 'success'\" name=\"success\">\n\t\t\t<div\n\t\t\t\tclass=\"BuilderBlueprintState__status BuilderBlueprintState__status--success\"\n\t\t\t>\n\t\t\t\t<WdsIcon name=\"check\" />\n\t\t\t</div>\n\t\t</slot>\n\t\t<slot v-else-if=\"result === 'error'\" name=\"error\">\n\t\t\t<div\n\t\t\t\tclass=\"BuilderBlueprintState__status BuilderBlueprintState__status--error\"\n\t\t\t>\n\t\t\t\t<WdsIcon name=\"circle-alert\" />\n\t\t\t</div>\n\t\t</slot>\n\t\t<slot v-else-if=\"result === 'in_progress'\" name=\"running\">\n\t\t\t<WdsLoaderDots\n\t\t\t\tclass=\"BuilderBlueprintState__status\"\n\t\t\t\t:color=\"WdsColor.Gray5\"\n\t\t\t/>\n\t\t</slot>\n\t</div>\n</template>\n\n<style scoped>\n.BuilderBlueprintState__status {\n\theight: 18px;\n\twidth: 18px;\n\tborder-radius: 50%;\n\n\tdisplay: flex;\n\talign-items: center;\n\tjustify-content: center;\n}\n.BuilderBlueprintState__status--success {\n\tbackground-color: var(--wdsColorGreen3);\n}\n.BuilderBlueprintState__status--error {\n\tbackground-color: var(--wdsColorOrange5);\n}\n</style>\n","import type { Core, Component } from \"@/writerTypes\";\nimport { computed, MaybeRef, unref } from \"vue\";\n\nexport function useComponentLinkedBlueprints(\n\twf: Core,\n\tcomponentId: MaybeRef<string>,\n\teventType: MaybeRef<string>,\n) {\n\tfunction isBlueprintTrigger(c: Component) {\n\t\treturn (\n\t\t\tc.type === \"blueprints_uieventtrigger\" &&\n\t\t\tc.content.refComponentId === unref(componentId) &&\n\t\t\tc.content.refEventType === unref(eventType)\n\t\t);\n\t}\n\n\tconst blueprints = computed<Component[]>(() => {\n\t\tconst blueprintIds = new Set(triggers.value.map((c) => c.parentId));\n\n\t\treturn [...blueprintIds]\n\t\t\t.map((i) => wf.getComponentById(i))\n\t\t\t.filter(Boolean);\n\t});\n\n\tconst triggers = computed<Component[]>(() => {\n\t\treturn wf\n\t\t\t.getComponents(\"blueprints_root\")\n\t\t\t.flatMap((w) => wf.getComponents(w.id).filter(isBlueprintTrigger));\n\t});\n\n\tconst isLinked = computed(() => triggers.value.length > 0);\n\n\treturn { blueprints, triggers, isLinked };\n}\n","<script setup lang=\"ts\">\nimport injectionKeys from \"@/injectionKeys\";\nimport { computed, inject, PropType } from \"vue\";\nimport { useComponentActions } from \"../useComponentActions\";\nimport { Component } from \"@/writerTypes\";\nimport WdsButton from \"@/wds/WdsButton.vue\";\nimport WdsIcon from \"@/wds/WdsIcon.vue\";\nimport { useToasts } from \"../useToast\";\nimport BuilderListItem from \"../BuilderListItem.vue\";\nimport { useBlueprintsRun } from \"@/composables/useBlueprintRun\";\nimport { WdsColor } from \"@/wds/tokens\";\nimport BuilderBlueprintState from \"../BuilderBlueprintState.vue\";\nimport { useComponentLinkedBlueprints } from \"@/composables/useComponentBlueprints\";\nimport WdsButtonLink from \"@/wds/WdsButtonLink.vue\";\nimport { useWriterTracking } from \"@/composables/useWriterTracking\";\n\nconst wf = inject(injectionKeys.core);\nconst wfbm = inject(injectionKeys.builderManager);\n\nconst props = defineProps({\n\tcomponent: { type: Object as PropType<Component>, required: true },\n\teventType: { type: String, required: true },\n\teventDescription: { type: String, required: false, default: undefined },\n});\n\nconst tracking = useWriterTracking(wf);\n\nconst { createAndInsertComponentsTree, removeComponentsSubtree } =\n\tuseComponentActions(wf, wfbm, tracking);\n\nconst eventTypeFormated = computed(() =>\n\tprops.eventType.replace(/^wf-/, \"\").replaceAll(\"-\", \" \"),\n);\n\nconst { blueprints: linkedBlueprints, triggers: linkedTriggers } =\n\tuseComponentLinkedBlueprints(\n\t\twf,\n\t\tcomputed(() => props.component.id),\n\t\tcomputed(() => props.eventType),\n\t);\n\nconst { run, isRunning } = useBlueprintsRun(\n\twf,\n\tcomputed(() =>\n\t\tlinkedTriggers.value.map((w) => ({\n\t\t\tblueprintId: w.parentId,\n\t\t\tbranchId: w.id,\n\t\t})),\n\t),\n);\n\nconst { pushToast } = useToasts();\n\nfunction getNewBlueprintKey() {\n\tconst indexes = linkedBlueprints.value.map((w) => {\n\t\tconst matchs = (w.content.key ?? \"0\").match(/\\d+/);\n\t\treturn matchs ? Number(matchs[0]) : 0;\n\t});\n\treturn indexes.length === 0 ? 1 : Math.max(...indexes) + 1;\n}\n\nasync function createLinkedBlueprint() {\n\tconst { type } = props.component;\n\tconst { name, events } = wf.getComponentDefinition(type);\n\tconst alias = `${name} - ${props.eventType}`;\n\tconst key = `${type}@${props.eventType.replace(/^wf-/, \"\")}_${getNewBlueprintKey()}`;\n\n\tlet defaultResult = events?.[props.eventType]?.eventPayloadExample;\n\n\tif (typeof defaultResult === \"object\" && defaultResult !== null) {\n\t\tdefaultResult = JSON.stringify(defaultResult);\n\t}\n\n\tconst [blueprintId] = createAndInsertComponentsTree(\"blueprints_root\", [\n\t\t{\n\t\t\ttype: \"blueprints_blueprint\",\n\t\t\tinitProperties: {\n\t\t\t\tcontent: {\n\t\t\t\t\tkey,\n\t\t\t\t},\n\t\t\t},\n\t\t},\n\t\t{\n\t\t\ttype: \"blueprints_uieventtrigger\",\n\t\t\tinitProperties: {\n\t\t\t\tcontent: {\n\t\t\t\t\talias,\n\t\t\t\t\trefComponentId: props.component.id,\n\t\t\t\t\trefEventType: props.eventType,\n\t\t\t\t\tdefaultResult: defaultResult\n\t\t\t\t\t\t? String(defaultResult)\n\t\t\t\t\t\t: undefined,\n\t\t\t\t},\n\t\t\t\tx: 96,\n\t\t\t\ty: 96,\n\t\t\t},\n\t\t},\n\t]);\n\n\tpushToast({\n\t\ttype: \"success\",\n\t\tmessage: `${alias} added`,\n\t\taction: {\n\t\t\tlabel: \"Go to blueprint\",\n\t\t\tfunc: () =>\n\t\t\t\tjumpToBlueprint(\n\t\t\t\t\tblueprintId,\n\t\t\t\t\tgetBlueprintTriggerBlock(blueprintId)?.id,\n\t\t\t\t),\n\t\t\ticon: \"wds-blueprints\",\n\t\t},\n\t});\n}\nfunction getBlueprintTriggerBlock(blueprintId: string) {\n\treturn wf\n\t\t.getComponents(blueprintId)\n\t\t.find(\n\t\t\t(c) =>\n\t\t\t\tc.type === \"blueprints_uieventtrigger\" &&\n\t\t\t\tc.content.refComponentId === props.component.id &&\n\t\t\t\tc.content.refEventType === props.eventType,\n\t\t);\n}\n\nfunction deleteLinkedBlueprint(trigger: Component) {\n\tconst componentsToDelete = [trigger.id];\n\tif (wf.getComponents(trigger.parentId).length === 1) {\n\t\tcomponentsToDelete.push(trigger.parentId);\n\t}\n\tremoveComponentsSubtree(...componentsToDelete);\n}\n\nfunction getTriggerName(trigger: Component) {\n\treturn wf.getComponentById(trigger.parentId)?.content?.key || \"Blueprint\";\n}\n\nfunction jumpToBlueprint(blueprintId: string, triggerId?: string) {\n\twf.setActivePageId(blueprintId);\n\twfbm.setMode(\"blueprints\");\n\twfbm.setSelection(triggerId ?? blueprintId, undefined, \"click\");\n}\n</script>\n\n<template>\n\t<div class=\"BuilderSettingsHandlersBlueprint\" :aria-busy=\"isRunning\">\n\t\t<div class=\"BuilderSettingsHandlersBlueprint__title\">\n\t\t\t<WdsButton\n\t\t\t\tclass=\"BuilderSettingsHandlersBlueprint__title__btn\"\n\t\t\t\tvariant=\"special\"\n\t\t\t\tsize=\"icon\"\n\t\t\t\taria-label=\"Run the attached blueprints\"\n\t\t\t\t:disabled=\"isRunning\"\n\t\t\t\t:loading=\"isRunning\"\n\t\t\t\t@click=\"run\"\n\t\t\t>\n\t\t\t\t<WdsIcon name=\"play\" />\n\t\t\t</WdsButton>\n\t\t\t<p>{{ eventTypeFormated }}</p>\n\t\t\t<WdsButton\n\t\t\t\tv-if=\"eventDescription\"\n\t\t\t\t:data-writer-tooltip=\"eventDescription\"\n\t\t\t\tvariant=\"neutral\"\n\t\t\t\tsize=\"smallIcon\"\n\t\t\t\tcustom-size=\"18px\"\n\t\t\t>\n\t\t\t\t<WdsIcon name=\"circle-question-mark\" />\n\t\t\t</WdsButton>\n\t\t</div>\n\n\t\t<div class=\"BuilderSettingsHandlersBlueprint__list\">\n\t\t\t<BuilderListItem\n\t\t\t\tv-for=\"(trigger, i) of linkedTriggers\"\n\t\t\t\t:key=\"trigger.id\"\n\t\t\t\t:color=\"WdsColor.Blue6\"\n\t\t\t\t:color-last=\"\n\t\t\t\t\tlinkedTriggers.length === i + 1\n\t\t\t\t\t\t? WdsColor.Blue2\n\t\t\t\t\t\t: WdsColor.Blue6\n\t\t\t\t\"\n\t\t\t>\n\t\t\t\t<div class=\"BuilderSettingsHandlersBlueprint__list__item\">\n\t\t\t\t\t<WdsButtonLink\n\t\t\t\t\t\tvariant=\"secondary\"\n\t\t\t\t\t\t:disabled=\"isRunning\"\n\t\t\t\t\t\t:text=\"getTriggerName(trigger)\"\n\t\t\t\t\t\t:data-writer-tooltip=\"getTriggerName(trigger)\"\n\t\t\t\t\t\tdata-writer-tooltip-strategy=\"overflow\"\n\t\t\t\t\t\t@click=\"jumpToBlueprint(trigger.parentId, trigger.id)\"\n\t\t\t\t\t/>\n\t\t\t\t\t<BuilderBlueprintState :blueprint-id=\"trigger.parentId\" />\n\t\t\t\t\t<WdsButton\n\t\t\t\t\t\tvariant=\"neutral\"\n\t\t\t\t\t\tsize=\"smallIcon\"\n\t\t\t\t\t\tcustom-size=\"18px\"\n\t\t\t\t\t\taria-label=\"Unlink blueprint\"\n\t\t\t\t\t\tdata-writer-tooltip=\"This will remove the trigger but will not delete the blueprint\"\n\t\t\t\t\t\t:disabled=\"isRunning\"\n\t\t\t\t\t\t@click=\"deleteLinkedBlueprint(trigger)\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<WdsIcon name=\"link-2-off\" />\n\t\t\t\t\t</WdsButton>\n\t\t\t\t</div>\n\t\t\t</BuilderListItem>\n\t\t\t<BuilderListItem is-last :color=\"WdsColor.Blue2\">\n\t\t\t\t<div class=\"BuilderSettingsHandlersBlueprint__list__item\">\n\t\t\t\t\t<WdsButtonLink\n\t\t\t\t\t\tvariant=\"primary\"\n\t\t\t\t\t\tweight=\"semibold\"\n\t\t\t\t\t\t:disabled=\"isRunning\"\n\t\t\t\t\t\tleft-icon=\"plus\"\n\t\t\t\t\t\ttext=\"Create blueprint\"\n\t\t\t\t\t\t@click=\"createLinkedBlueprint\"\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t</BuilderListItem>\n\t\t</div>\n\t</div>\n</template>\n\n<style lang=\"css\" scoped>\n.BuilderSettingsHandlersBlueprint {\n\tfont-size: 14px;\n}\n.BuilderSettingsHandlersBlueprint__title {\n\tdisplay: flex;\n\tgap: 8px;\n\talign-items: center;\n}\n.BuilderSettingsHandlersBlueprint__title__btn {\n\tmin-width: 40px;\n}\n.BuilderSettingsHandlersBlueprint__title__btn i {\n\tfont-size: 24px;\n}\n.BuilderSettingsHandlersBlueprint__list {\n\tcolumn-gap: 12px;\n\tpadding-left: 19px;\n}\n.BuilderSettingsHandlersBlueprint__list__item {\n\tpadding-top: 6px;\n\tpadding-bottom: 6px;\n\tpadding-left: 12px;\n\n\tdisplay: grid;\n\tgrid-template-columns: minmax(0, 1fr) auto auto;\n\tjustify-content: space-between;\n\tgap: 4px;\n}\n</style>\n","<template>\n\t<div\n\t\tv-if=\"shoudBeDisplayed\"\n\t\t:inert=\"isReadOnly\"\n\t\tclass=\"BuilderSettingsHandlers\"\n\t>\n\t\t<WdsTitle2 class=\"BuilderSettingsHandlers__title\">Blueprints</WdsTitle2>\n\t\t<div class=\"BuilderSettingsHandlers__list\">\n\t\t\t<div\n\t\t\t\tv-for=\"(eventInfo, eventType) in recognisedEvents\"\n\t\t\t\t:key=\"eventType\"\n\t\t\t>\n\t\t\t\t<BuilderSettingsHandlersBlueprint\n\t\t\t\t\t:component=\"component\"\n\t\t\t\t\t:event-type=\"eventType\"\n\t\t\t\t\t:event-description=\"eventInfo.desc\"\n\t\t\t\t/>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n</template>\n\n<script setup lang=\"ts\">\nimport { computed, ComputedRef, inject } from \"vue\";\n\nimport injectionKeys from \"@/injectionKeys\";\nimport { InstancePath, WriterComponentDefinition } from \"@/writerTypes\";\nimport BuilderSettingsHandlersBlueprint from \"./BuilderSettingsHandlersBlueprint.vue\";\nimport WdsTitle2 from \"@/wds/WdsTitle2.vue\";\nimport { useEvaluator } from \"@/renderer/useEvaluator\";\nimport { parseInstancePathString } from \"@/renderer/instancePath\";\n\ndefineProps({\n\tisReadOnly: { type: Boolean },\n});\n\nconst wf = inject(injectionKeys.core);\nconst wfbm = inject(injectionKeys.builderManager);\nconst secretsManager = inject(injectionKeys.secretsManager);\n\nconst component = computed(() =>\n\twf.getComponentById(wfbm.firstSelectedId.value),\n);\nconst selectedInstancePath = computed<InstancePath>(() =>\n\tparseInstancePathString(wfbm.firstSelectedItem?.value?.instancePath),\n);\n\nconst { getEvaluatedFields } = useEvaluator(wf, secretsManager);\nconst evaluatedFields = computed(() =>\n\tgetEvaluatedFields(selectedInstancePath.value),\n);\n\nconst recognisedEvents: ComputedRef<WriterComponentDefinition[\"events\"]> =\n\tcomputed(() => {\n\t\tif (!component.value) return {};\n\t\tconst { type } = component.value;\n\t\tconst componentDefinition = wf.getComponentDefinition(type);\n\t\tconst supportedEvents = componentDefinition?.events ?? {};\n\n\t\tconst entries = Object.entries(supportedEvents).filter(([_, v]) => {\n\t\t\tif (v.enabled === undefined) return true;\n\t\t\treturn v.enabled({ evaluatedFields: evaluatedFields.value });\n\t\t});\n\t\tconst recEvents = Object.fromEntries(entries);\n\n\t\tObject.keys({ ...component.value.handlers }).forEach((eventType) => {\n\t\t\tif (recEvents[eventType]) return;\n\t\t\trecEvents[eventType] = { desc: \"Custom event\" };\n\t\t});\n\n\t\treturn recEvents;\n\t});\n\nconst shoudBeDisplayed = computed(() => {\n\tif (!wfbm.isSingleSelectionActive.value) return false;\n\treturn Object.keys(recognisedEvents.value).length > 0;\n});\n</script>\n\n<style scoped>\n@import \"../sharedStyles.css\";\n\n.BuilderSettingsHandlers {\n\tpadding: 24px;\n}\n\n.BuilderSettingsHandlers[inert] {\n\topacity: 0.7;\n}\n\n.BuilderSettingsHandlers__title {\n\tpadding-bottom: 16px;\n}\n\n.BuilderSettingsHandlers__list {\n\tdisplay: flex;\n\tflex-direction: column;\n\tgap: 24px;\n}\n</style>\n"],"names":["props","__props","core","inject","injectionKeys","wfbm","blueprintBlocks","computed","blueprintBlocksId","b","result","message","_a","l","v","component","_c","_b","useComponentLinkedBlueprints","wf","componentId","eventType","isBlueprintTrigger","c","unref","blueprints","triggers","i","w","isLinked","tracking","useWriterTracking","createAndInsertComponentsTree","removeComponentsSubtree","useComponentActions","eventTypeFormated","linkedBlueprints","linkedTriggers","run","isRunning","useBlueprintsRun","pushToast","useToasts","getNewBlueprintKey","indexes","matchs","createLinkedBlueprint","type","name","events","alias","key","defaultResult","blueprintId","jumpToBlueprint","getBlueprintTriggerBlock","deleteLinkedBlueprint","trigger","componentsToDelete","getTriggerName","triggerId","secretsManager","selectedInstancePath","parseInstancePathString","getEvaluatedFields","useEvaluator","evaluatedFields","recognisedEvents","componentDefinition","supportedEvents","entries","_","recEvents","shoudBeDisplayed"],"mappings":"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"}