"""Generated from hyb_gga_xc_wb97.mpl."""

import jax
import jax.lax as lax
import jax.numpy as jnp
import jax.scipy.special as jsp_special
import numpy as np
from jax.numpy import array as array
from jax.numpy import int32 as int32
from jax.numpy import nan as nan
from typing import Callable, Optional
from jxc.functionals.utils import *


def pol(p, r, s=(None, None, None), l=(None, None), tau=(None, None)):
  f = funcs(p)
  params = f.params
  (r0, r1), (s0, s1, s2), (l0, l1), (tau0, tau1) = r, s, l, tau
  params_c_ab_raw = params.c_ab
  if isinstance(params_c_ab_raw, (str, bytes, dict)):
    params_c_ab = params_c_ab_raw
  else:
    try:
      params_c_ab_seq = list(params_c_ab_raw)
    except TypeError:
      params_c_ab = params_c_ab_raw
    else:
      params_c_ab_seq = np.asarray(params_c_ab_seq, dtype=np.float64)
      params_c_ab = np.concatenate((np.array([np.nan], dtype=np.float64), params_c_ab_seq))
  params_c_ss_raw = params.c_ss
  if isinstance(params_c_ss_raw, (str, bytes, dict)):
    params_c_ss = params_c_ss_raw
  else:
    try:
      params_c_ss_seq = list(params_c_ss_raw)
    except TypeError:
      params_c_ss = params_c_ss_raw
    else:
      params_c_ss_seq = np.asarray(params_c_ss_seq, dtype=np.float64)
      params_c_ss = np.concatenate((np.array([np.nan], dtype=np.float64), params_c_ss_seq))
  params_c_x_raw = params.c_x
  if isinstance(params_c_x_raw, (str, bytes, dict)):
    params_c_x = params_c_x_raw
  else:
    try:
      params_c_x_seq = list(params_c_x_raw)
    except TypeError:
      params_c_x = params_c_x_raw
    else:
      params_c_x_seq = np.asarray(params_c_x_seq, dtype=np.float64)
      params_c_x = np.concatenate((np.array([np.nan], dtype=np.float64), params_c_x_seq))

  params_pp = np.array([np.nan, 1, 1, 1], dtype=np.float64)

  params_a = np.array([np.nan, 0.031091, 0.015545, 0.016887], dtype=np.float64)

  params_alpha1 = np.array([np.nan, 0.2137, 0.20548, 0.11125], dtype=np.float64)

  params_beta1 = np.array([np.nan, 7.5957, 14.1189, 10.357], dtype=np.float64)

  params_beta2 = np.array([np.nan, 3.5876, 6.1977, 3.6231], dtype=np.float64)

  params_beta3 = np.array([np.nan, 1.6382, 3.3662, 0.88026], dtype=np.float64)

  params_beta4 = np.array([np.nan, 0.49294, 0.62517, 0.49671], dtype=np.float64)

  params_fz20 = 1.709921

  att_erf_aux1 = lambda a: jnp.sqrt(jnp.pi) * jax.lax.erf(1 / (2 * a))

  att_erf_aux2 = lambda a: jnp.exp(-1 / (4 * a ** 2)) - 1

  a_cnst = (4 / (9 * jnp.pi)) ** (1 / 3) * f.p.cam_omega / 2

  lda_x_ax = -f.RS_FACTOR * X_FACTOR_C / 2 ** (4 / 3)

  b97_g = lambda gamma, cc, x: jnp.sum(jnp.array([cc[i] * (gamma * x ** 2 / (1 + gamma * x ** 2)) ** (i - 1) for i in range(1, 5 + 1)]), axis=0)

  g_aux = lambda k, rs: params_beta1[k] * jnp.sqrt(rs) + params_beta2[k] * rs + params_beta3[k] * rs ** 1.5 + params_beta4[k] * rs ** (params_pp[k] + 1)

  att_erf_aux3 = lambda a: 2 * a ** 2 * att_erf_aux2(a) + 1 / 2

  b97_fpar = lambda lda_func, mgamma, cc, rs, z, xs0, xs1: +lda_stoll_par(f, params, lda_func, rs, z) * b97_g(mgamma, cc, xs0) + lda_stoll_par(f, params, lda_func, rs, -z) * b97_g(mgamma, cc, xs1)

  b97_fperp = lambda lda_func, mgamma, cc, rs, z, xs0, xs1: lda_stoll_perp(f, params, lda_func, rs, z) * b97_g(mgamma, cc, jnp.sqrt(xs0 ** 2 + xs1 ** 2) / jnp.sqrt(2))

  g = lambda k, rs: -2 * params_a[k] * (1 + params_alpha1[k] * rs) * jnp.log(1 + 1 / (2 * params_a[k] * g_aux(k, rs)))

  attenuation_erf0 = lambda a: 1 - 8 / 3 * a * (att_erf_aux1(a) + 2 * a * (att_erf_aux2(a) - att_erf_aux3(a)))

  b97_f = lambda lda_func, gamma_ss, cc_ss, gamma_ab, cc_ab, rs, z, xs0, xs1: +b97_fpar(lda_func, gamma_ss, cc_ss, rs, z, xs0, xs1) + b97_fperp(lda_func, gamma_ab, cc_ab, rs, z, xs0, xs1)

  f_pw = lambda rs, zeta: g(1, rs) + zeta ** 4 * f.f_zeta(zeta) * (g(2, rs) - g(1, rs) + g(3, rs) / params_fz20) - f.f_zeta(zeta) * g(3, rs) / params_fz20

  attenuation_erf = lambda a: apply_piecewise(a, lambda _aval: _aval >= 1.35, lambda _aval: -1 / 2021444812800 * (1.0 / jnp.maximum(_aval, 1.35)) ** 16 + 1 / 44590694400 * (1.0 / jnp.maximum(_aval, 1.35)) ** 14 - 1 / 1073479680 * (1.0 / jnp.maximum(_aval, 1.35)) ** 12 + 1 / 28385280 * (1.0 / jnp.maximum(_aval, 1.35)) ** 10 - 1 / 829440 * (1.0 / jnp.maximum(_aval, 1.35)) ** 8 + 1 / 26880 * (1.0 / jnp.maximum(_aval, 1.35)) ** 6 - 1 / 960 * (1.0 / jnp.maximum(_aval, 1.35)) ** 4 + 1 / 36 * (1.0 / jnp.maximum(_aval, 1.35)) ** 2, lambda _aval: attenuation_erf0(jnp.minimum(_aval, 1.35)))

  lda_x_erf_spin = lambda rs, z: lda_x_ax * f.opz_pow_n(z, 4 / 3) / rs * attenuation_erf(a_cnst * rs / f.opz_pow_n(z, 1 / 3))

  wb97_x = lambda rs, z, xs0, xs1: f.my_piecewise3(f.screen_dens_zeta(rs, z), 0, (1 + z) / 2 * lda_x_erf_spin(rs * (2 / (1 + z)) ** (1 / 3), 1) * b97_g(0.004, params_c_x, xs0)) + f.my_piecewise3(f.screen_dens_zeta(rs, -z), 0, (1 - z) / 2 * lda_x_erf_spin(rs * (2 / (1 - z)) ** (1 / 3), 1) * b97_g(0.004, params_c_x, xs1))

  functional_body = lambda rs, z, xt, xs0, xs1: wb97_x(rs, z, xs0, xs1) + b97_f(f_pw, 0.2, params_c_ss, 0.006, params_c_ab, rs, z, xs0, xs1)

  res = functional_body(
      f.r_ws(f.dens(r0, r1)),
      f.zeta(r0, r1),
      f.xt(r0, r1, s0, s1, s2),
      f.xs0(r0, r1, s0, s2),
      f.xs1(r0, r1, s0, s2),
  )
  return res


def unpol(p, r, s=None, l=None, tau=None):
  f = funcs(p)
  params = f.params
  r0, s0, l0, tau0 = r, s, l, tau
  params_c_ab_raw = params.c_ab
  if isinstance(params_c_ab_raw, (str, bytes, dict)):
    params_c_ab = params_c_ab_raw
  else:
    try:
      params_c_ab_seq = list(params_c_ab_raw)
    except TypeError:
      params_c_ab = params_c_ab_raw
    else:
      params_c_ab_seq = np.asarray(params_c_ab_seq, dtype=np.float64)
      params_c_ab = np.concatenate((np.array([np.nan], dtype=np.float64), params_c_ab_seq))
  params_c_ss_raw = params.c_ss
  if isinstance(params_c_ss_raw, (str, bytes, dict)):
    params_c_ss = params_c_ss_raw
  else:
    try:
      params_c_ss_seq = list(params_c_ss_raw)
    except TypeError:
      params_c_ss = params_c_ss_raw
    else:
      params_c_ss_seq = np.asarray(params_c_ss_seq, dtype=np.float64)
      params_c_ss = np.concatenate((np.array([np.nan], dtype=np.float64), params_c_ss_seq))
  params_c_x_raw = params.c_x
  if isinstance(params_c_x_raw, (str, bytes, dict)):
    params_c_x = params_c_x_raw
  else:
    try:
      params_c_x_seq = list(params_c_x_raw)
    except TypeError:
      params_c_x = params_c_x_raw
    else:
      params_c_x_seq = np.asarray(params_c_x_seq, dtype=np.float64)
      params_c_x = np.concatenate((np.array([np.nan], dtype=np.float64), params_c_x_seq))

  params_pp = np.array([np.nan, 1, 1, 1], dtype=np.float64)

  params_a = np.array([np.nan, 0.031091, 0.015545, 0.016887], dtype=np.float64)

  params_alpha1 = np.array([np.nan, 0.2137, 0.20548, 0.11125], dtype=np.float64)

  params_beta1 = np.array([np.nan, 7.5957, 14.1189, 10.357], dtype=np.float64)

  params_beta2 = np.array([np.nan, 3.5876, 6.1977, 3.6231], dtype=np.float64)

  params_beta3 = np.array([np.nan, 1.6382, 3.3662, 0.88026], dtype=np.float64)

  params_beta4 = np.array([np.nan, 0.49294, 0.62517, 0.49671], dtype=np.float64)

  params_fz20 = 1.709921

  att_erf_aux1 = lambda a: jnp.sqrt(jnp.pi) * jax.lax.erf(1 / (2 * a))

  att_erf_aux2 = lambda a: jnp.exp(-1 / (4 * a ** 2)) - 1

  a_cnst = (4 / (9 * jnp.pi)) ** (1 / 3) * f.p.cam_omega / 2

  lda_x_ax = -f.RS_FACTOR * X_FACTOR_C / 2 ** (4 / 3)

  b97_g = lambda gamma, cc, x: jnp.sum(jnp.array([cc[i] * (gamma * x ** 2 / (1 + gamma * x ** 2)) ** (i - 1) for i in range(1, 5 + 1)]), axis=0)

  g_aux = lambda k, rs: params_beta1[k] * jnp.sqrt(rs) + params_beta2[k] * rs + params_beta3[k] * rs ** 1.5 + params_beta4[k] * rs ** (params_pp[k] + 1)

  att_erf_aux3 = lambda a: 2 * a ** 2 * att_erf_aux2(a) + 1 / 2

  b97_fpar = lambda lda_func, mgamma, cc, rs, z, xs0, xs1: +lda_stoll_par(f, params, lda_func, rs, z) * b97_g(mgamma, cc, xs0) + lda_stoll_par(f, params, lda_func, rs, -z) * b97_g(mgamma, cc, xs1)

  b97_fperp = lambda lda_func, mgamma, cc, rs, z, xs0, xs1: lda_stoll_perp(f, params, lda_func, rs, z) * b97_g(mgamma, cc, jnp.sqrt(xs0 ** 2 + xs1 ** 2) / jnp.sqrt(2))

  g = lambda k, rs: -2 * params_a[k] * (1 + params_alpha1[k] * rs) * jnp.log(1 + 1 / (2 * params_a[k] * g_aux(k, rs)))

  attenuation_erf0 = lambda a: 1 - 8 / 3 * a * (att_erf_aux1(a) + 2 * a * (att_erf_aux2(a) - att_erf_aux3(a)))

  b97_f = lambda lda_func, gamma_ss, cc_ss, gamma_ab, cc_ab, rs, z, xs0, xs1: +b97_fpar(lda_func, gamma_ss, cc_ss, rs, z, xs0, xs1) + b97_fperp(lda_func, gamma_ab, cc_ab, rs, z, xs0, xs1)

  f_pw = lambda rs, zeta: g(1, rs) + zeta ** 4 * f.f_zeta(zeta) * (g(2, rs) - g(1, rs) + g(3, rs) / params_fz20) - f.f_zeta(zeta) * g(3, rs) / params_fz20

  attenuation_erf = lambda a: apply_piecewise(a, lambda _aval: _aval >= 1.35, lambda _aval: -1 / 2021444812800 * (1.0 / jnp.maximum(_aval, 1.35)) ** 16 + 1 / 44590694400 * (1.0 / jnp.maximum(_aval, 1.35)) ** 14 - 1 / 1073479680 * (1.0 / jnp.maximum(_aval, 1.35)) ** 12 + 1 / 28385280 * (1.0 / jnp.maximum(_aval, 1.35)) ** 10 - 1 / 829440 * (1.0 / jnp.maximum(_aval, 1.35)) ** 8 + 1 / 26880 * (1.0 / jnp.maximum(_aval, 1.35)) ** 6 - 1 / 960 * (1.0 / jnp.maximum(_aval, 1.35)) ** 4 + 1 / 36 * (1.0 / jnp.maximum(_aval, 1.35)) ** 2, lambda _aval: attenuation_erf0(jnp.minimum(_aval, 1.35)))

  lda_x_erf_spin = lambda rs, z: lda_x_ax * f.opz_pow_n(z, 4 / 3) / rs * attenuation_erf(a_cnst * rs / f.opz_pow_n(z, 1 / 3))

  wb97_x = lambda rs, z, xs0, xs1: f.my_piecewise3(f.screen_dens_zeta(rs, z), 0, (1 + z) / 2 * lda_x_erf_spin(rs * (2 / (1 + z)) ** (1 / 3), 1) * b97_g(0.004, params_c_x, xs0)) + f.my_piecewise3(f.screen_dens_zeta(rs, -z), 0, (1 - z) / 2 * lda_x_erf_spin(rs * (2 / (1 - z)) ** (1 / 3), 1) * b97_g(0.004, params_c_x, xs1))

  functional_body = lambda rs, z, xt, xs0, xs1: wb97_x(rs, z, xs0, xs1) + b97_f(f_pw, 0.2, params_c_ss, 0.006, params_c_ab, rs, z, xs0, xs1)

  res = functional_body(
      f.r_ws(f.dens(r0 / 2, r0 / 2)),
      f.zeta(r0 / 2, r0 / 2),
      f.xt(r0 / 2, r0 / 2, s0 / 4, s0 / 4, s0 / 4),
      f.xs0(r0 / 2, r0 / 2, s0 / 4, s0 / 4),
      f.xs1(r0 / 2, r0 / 2, s0 / 4, s0 / 4),
  )
  return res

def pol_vxc(p, r, s=(None, None, None), l=(None, None), tau=(None, None)):
  f = funcs(p)
  params = f.params
  (r0, r1), (s0, s1, s2), (l0, l1), (tau0, tau1) = r, s, l, tau

  t2 = r0 - r1
  t3 = r0 + r1
  t4 = 0.1e1 / t3
  t5 = t2 * t4
  t6 = 0.1e1 + t5
  t7 = t6 <= f.p.zeta_threshold
  t8 = jnp.logical_or(r0 <= f.p.dens_threshold, t7)
  t9 = 3 ** (0.1e1 / 0.3e1)
  t12 = (0.1e1 / jnp.pi) ** (0.1e1 / 0.3e1)
  t13 = 4 ** (0.1e1 / 0.3e1)
  t14 = t13 ** 2
  t15 = t12 * t14
  t16 = 2 ** (0.1e1 / 0.3e1)
  t17 = t15 * t16
  t18 = t6 * t9 * t17
  t19 = 0.2e1 <= f.p.zeta_threshold
  t20 = f.p.zeta_threshold ** (0.1e1 / 0.3e1)
  t21 = t20 * f.p.zeta_threshold
  t23 = f.my_piecewise3(t19, t21, 0.2e1 * t16)
  t24 = t3 ** (0.1e1 / 0.3e1)
  t25 = t23 * t24
  t26 = 0.1e1 / t6
  t27 = t26 ** (0.1e1 / 0.3e1)
  t28 = 0.1e1 / t27
  t29 = 9 ** (0.1e1 / 0.3e1)
  t30 = t29 ** 2
  t31 = t12 ** 2
  t32 = t30 * t31
  t33 = f.p.cam_omega * t9
  t34 = t32 * t33
  t35 = 0.1e1 / t24
  t36 = t35 * t16
  t37 = f.my_piecewise3(t19, t20, t16)
  t38 = 0.1e1 / t37
  t39 = t27 * t38
  t42 = t34 * t36 * t39 / 0.18e2
  t43 = 0.135e1 <= t42
  t44 = 0.135e1 < t42
  t45 = f.my_piecewise3(t44, t42, 0.135e1)
  t46 = t45 ** 2
  t49 = t46 ** 2
  t52 = t49 * t46
  t55 = t49 ** 2
  t67 = t55 ** 2
  t71 = f.my_piecewise3(t44, 0.135e1, t42)
  t72 = jnp.sqrt(jnp.pi)
  t73 = 0.1e1 / t71
  t75 = jnp.erf(t73 / 0.2e1)
  t77 = t71 ** 2
  t78 = 0.1e1 / t77
  t80 = jnp.exp(-t78 / 0.4e1)
  t81 = t80 - 0.1e1
  t84 = t80 - 0.3e1 / 0.2e1 - 0.2e1 * t77 * t81
  t87 = 0.2e1 * t71 * t84 + t72 * t75
  t91 = f.my_piecewise3(t43, 0.1e1 / t46 / 0.36e2 - 0.1e1 / t49 / 0.960e3 + 0.1e1 / t52 / 0.26880e5 - 0.1e1 / t55 / 0.829440e6 + 0.1e1 / t55 / t46 / 0.28385280e8 - 0.1e1 / t55 / t49 / 0.1073479680e10 + 0.1e1 / t55 / t52 / 0.44590694400e11 - 0.1e1 / t67 / 0.2021444812800e13, 0.1e1 - 0.8e1 / 0.3e1 * t71 * t87)
  t92 = t28 * t91
  t93 = params.c_x[0]
  t94 = params.c_x[1]
  t95 = t94 * s0
  t96 = r0 ** 2
  t97 = r0 ** (0.1e1 / 0.3e1)
  t98 = t97 ** 2
  t100 = 0.1e1 / t98 / t96
  t101 = s0 * t100
  t103 = 0.1e1 + 0.4e-2 * t101
  t104 = 0.1e1 / t103
  t108 = params.c_x[2]
  t109 = s0 ** 2
  t110 = t108 * t109
  t111 = t96 ** 2
  t112 = t111 * r0
  t114 = 0.1e1 / t97 / t112
  t115 = t103 ** 2
  t116 = 0.1e1 / t115
  t117 = t114 * t116
  t120 = params.c_x[3]
  t121 = t109 * s0
  t122 = t120 * t121
  t123 = t111 ** 2
  t124 = 0.1e1 / t123
  t126 = 0.1e1 / t115 / t103
  t127 = t124 * t126
  t130 = params.c_x[4]
  t131 = t109 ** 2
  t132 = t130 * t131
  t135 = 0.1e1 / t98 / t123 / t96
  t136 = t115 ** 2
  t137 = 0.1e1 / t136
  t138 = t135 * t137
  t141 = t93 + 0.4e-2 * t95 * t100 * t104 + 0.16e-4 * t110 * t117 + 0.64e-7 * t122 * t127 + 0.256e-9 * t132 * t138
  t142 = t92 * t141
  t143 = t25 * t142
  t146 = f.my_piecewise3(t8, 0, -0.3e1 / 0.64e2 * t18 * t143)
  t148 = 0.1e1 - t5
  t149 = t148 <= f.p.zeta_threshold
  t150 = jnp.logical_or(r1 <= f.p.dens_threshold, t149)
  t152 = t148 * t9 * t17
  t153 = 0.1e1 / t148
  t154 = t153 ** (0.1e1 / 0.3e1)
  t155 = 0.1e1 / t154
  t156 = t154 * t38
  t159 = t34 * t36 * t156 / 0.18e2
  t160 = 0.135e1 <= t159
  t161 = 0.135e1 < t159
  t162 = f.my_piecewise3(t161, t159, 0.135e1)
  t163 = t162 ** 2
  t166 = t163 ** 2
  t169 = t166 * t163
  t172 = t166 ** 2
  t184 = t172 ** 2
  t188 = f.my_piecewise3(t161, 0.135e1, t159)
  t189 = 0.1e1 / t188
  t191 = jnp.erf(t189 / 0.2e1)
  t193 = t188 ** 2
  t194 = 0.1e1 / t193
  t196 = jnp.exp(-t194 / 0.4e1)
  t197 = t196 - 0.1e1
  t200 = t196 - 0.3e1 / 0.2e1 - 0.2e1 * t193 * t197
  t203 = 0.2e1 * t188 * t200 + t191 * t72
  t207 = f.my_piecewise3(t160, 0.1e1 / t163 / 0.36e2 - 0.1e1 / t166 / 0.960e3 + 0.1e1 / t169 / 0.26880e5 - 0.1e1 / t172 / 0.829440e6 + 0.1e1 / t172 / t163 / 0.28385280e8 - 0.1e1 / t172 / t166 / 0.1073479680e10 + 0.1e1 / t172 / t169 / 0.44590694400e11 - 0.1e1 / t184 / 0.2021444812800e13, 0.1e1 - 0.8e1 / 0.3e1 * t188 * t203)
  t208 = t155 * t207
  t209 = t94 * s2
  t210 = r1 ** 2
  t211 = r1 ** (0.1e1 / 0.3e1)
  t212 = t211 ** 2
  t214 = 0.1e1 / t212 / t210
  t215 = s2 * t214
  t217 = 0.1e1 + 0.4e-2 * t215
  t218 = 0.1e1 / t217
  t222 = s2 ** 2
  t223 = t108 * t222
  t224 = t210 ** 2
  t225 = t224 * r1
  t227 = 0.1e1 / t211 / t225
  t228 = t217 ** 2
  t229 = 0.1e1 / t228
  t230 = t227 * t229
  t233 = t222 * s2
  t234 = t120 * t233
  t235 = t224 ** 2
  t236 = 0.1e1 / t235
  t238 = 0.1e1 / t228 / t217
  t239 = t236 * t238
  t242 = t222 ** 2
  t243 = t130 * t242
  t246 = 0.1e1 / t212 / t235 / t210
  t247 = t228 ** 2
  t248 = 0.1e1 / t247
  t249 = t246 * t248
  t252 = t93 + 0.4e-2 * t209 * t214 * t218 + 0.16e-4 * t223 * t230 + 0.64e-7 * t234 * t239 + 0.256e-9 * t243 * t249
  t253 = t208 * t252
  t254 = t25 * t253
  t257 = f.my_piecewise3(t150, 0, -0.3e1 / 0.64e2 * t152 * t254)
  t258 = f.my_piecewise3(t7, f.p.zeta_threshold, t6)
  t259 = t9 * t12
  t260 = t259 * t14
  t261 = 0.1e1 / t20
  t262 = t6 ** (0.1e1 / 0.3e1)
  t264 = f.my_piecewise3(t7, t261, 0.1e1 / t262)
  t266 = t260 * t36 * t264
  t268 = 0.1e1 + 0.53425000000000000000000000000000000000000000000000e-1 * t266
  t269 = jnp.sqrt(t266)
  t272 = t266 ** 0.15e1
  t274 = t9 ** 2
  t275 = t274 * t31
  t276 = t275 * t13
  t277 = t24 ** 2
  t278 = 0.1e1 / t277
  t279 = t16 ** 2
  t280 = t278 * t279
  t281 = t264 ** 2
  t283 = t276 * t280 * t281
  t285 = 0.37978500000000000000000000000000000000000000000000e1 * t269 + 0.89690000000000000000000000000000000000000000000000e0 * t266 + 0.20477500000000000000000000000000000000000000000000e0 * t272 + 0.12323500000000000000000000000000000000000000000000e0 * t283
  t288 = 0.1e1 + 0.16081824322151104821330931780901225435013347914188e2 / t285
  t289 = jnp.log(t288)
  t291 = 0.62182e-1 * t268 * t289
  t293 = f.my_piecewise3(0.0e0 <= f.p.zeta_threshold, t21, 0)
  t297 = 0.1e1 / (0.2e1 * t16 - 0.2e1)
  t298 = (t23 + t293 - 0.2e1) * t297
  t300 = 0.1e1 + 0.51370000000000000000000000000000000000000000000000e-1 * t266
  t305 = 0.70594500000000000000000000000000000000000000000000e1 * t269 + 0.15494250000000000000000000000000000000000000000000e1 * t266 + 0.42077500000000000000000000000000000000000000000000e0 * t272 + 0.15629250000000000000000000000000000000000000000000e0 * t283
  t308 = 0.1e1 + 0.32164683177870697973624959794146027661627532968800e2 / t305
  t309 = jnp.log(t308)
  t313 = 0.1e1 + 0.27812500000000000000000000000000000000000000000000e-1 * t266
  t318 = 0.51785000000000000000000000000000000000000000000000e1 * t269 + 0.90577500000000000000000000000000000000000000000000e0 * t266 + 0.11003250000000000000000000000000000000000000000000e0 * t272 + 0.12417750000000000000000000000000000000000000000000e0 * t283
  t321 = 0.1e1 + 0.29608574643216675549239059631669331438384556167466e2 / t318
  t322 = jnp.log(t321)
  t323 = t313 * t322
  t329 = -t291 + t298 * (-0.31090e-1 * t300 * t309 + t291 - 0.19751789702565206228825776161588751761046270558698e-1 * t323) + 0.19751789702565206228825776161588751761046270558698e-1 * t298 * t323
  t332 = f.my_piecewise3(t8, 0, t258 * t329 / 0.2e1)
  t333 = params.c_ss[0]
  t334 = params.c_ss[1]
  t335 = t334 * s0
  t337 = 0.1e1 + 0.2e0 * t101
  t338 = 0.1e1 / t337
  t342 = params.c_ss[2]
  t343 = t342 * t109
  t344 = t337 ** 2
  t345 = 0.1e1 / t344
  t346 = t114 * t345
  t349 = params.c_ss[3]
  t350 = t349 * t121
  t352 = 0.1e1 / t344 / t337
  t353 = t124 * t352
  t356 = params.c_ss[4]
  t357 = t356 * t131
  t358 = t344 ** 2
  t359 = 0.1e1 / t358
  t360 = t135 * t359
  t363 = t333 + 0.2e0 * t335 * t100 * t338 + 0.4e-1 * t343 * t346 + 0.8e-2 * t350 * t353 + 0.16e-2 * t357 * t360
  t364 = t332 * t363
  t365 = f.my_piecewise3(t149, f.p.zeta_threshold, t148)
  t366 = t148 ** (0.1e1 / 0.3e1)
  t368 = f.my_piecewise3(t149, t261, 0.1e1 / t366)
  t370 = t260 * t36 * t368
  t372 = 0.1e1 + 0.53425000000000000000000000000000000000000000000000e-1 * t370
  t373 = jnp.sqrt(t370)
  t376 = t370 ** 0.15e1
  t378 = t368 ** 2
  t380 = t276 * t280 * t378
  t382 = 0.37978500000000000000000000000000000000000000000000e1 * t373 + 0.89690000000000000000000000000000000000000000000000e0 * t370 + 0.20477500000000000000000000000000000000000000000000e0 * t376 + 0.12323500000000000000000000000000000000000000000000e0 * t380
  t385 = 0.1e1 + 0.16081824322151104821330931780901225435013347914188e2 / t382
  t386 = jnp.log(t385)
  t388 = 0.62182e-1 * t372 * t386
  t390 = 0.1e1 + 0.51370000000000000000000000000000000000000000000000e-1 * t370
  t395 = 0.70594500000000000000000000000000000000000000000000e1 * t373 + 0.15494250000000000000000000000000000000000000000000e1 * t370 + 0.42077500000000000000000000000000000000000000000000e0 * t376 + 0.15629250000000000000000000000000000000000000000000e0 * t380
  t398 = 0.1e1 + 0.32164683177870697973624959794146027661627532968800e2 / t395
  t399 = jnp.log(t398)
  t403 = 0.1e1 + 0.27812500000000000000000000000000000000000000000000e-1 * t370
  t408 = 0.51785000000000000000000000000000000000000000000000e1 * t373 + 0.90577500000000000000000000000000000000000000000000e0 * t370 + 0.11003250000000000000000000000000000000000000000000e0 * t376 + 0.12417750000000000000000000000000000000000000000000e0 * t380
  t411 = 0.1e1 + 0.29608574643216675549239059631669331438384556167466e2 / t408
  t412 = jnp.log(t411)
  t413 = t403 * t412
  t419 = -t388 + t298 * (-0.31090e-1 * t390 * t399 + t388 - 0.19751789702565206228825776161588751761046270558698e-1 * t413) + 0.19751789702565206228825776161588751761046270558698e-1 * t298 * t413
  t422 = f.my_piecewise3(t150, 0, t365 * t419 / 0.2e1)
  t423 = t334 * s2
  t425 = 0.1e1 + 0.2e0 * t215
  t426 = 0.1e1 / t425
  t430 = t342 * t222
  t431 = t425 ** 2
  t432 = 0.1e1 / t431
  t433 = t227 * t432
  t436 = t349 * t233
  t438 = 0.1e1 / t431 / t425
  t439 = t236 * t438
  t442 = t356 * t242
  t443 = t431 ** 2
  t444 = 0.1e1 / t443
  t445 = t246 * t444
  t448 = t333 + 0.2e0 * t423 * t214 * t426 + 0.4e-1 * t430 * t433 + 0.8e-2 * t436 * t439 + 0.16e-2 * t442 * t445
  t449 = t422 * t448
  t451 = t259 * t14 * t35
  t453 = 0.1e1 + 0.53425000000000000000000000000000000000000000000000e-1 * t451
  t454 = jnp.sqrt(t451)
  t457 = t451 ** 0.15e1
  t460 = t275 * t13 * t278
  t462 = 0.37978500000000000000000000000000000000000000000000e1 * t454 + 0.89690000000000000000000000000000000000000000000000e0 * t451 + 0.20477500000000000000000000000000000000000000000000e0 * t457 + 0.12323500000000000000000000000000000000000000000000e0 * t460
  t465 = 0.1e1 + 0.16081824322151104821330931780901225435013347914188e2 / t462
  t466 = jnp.log(t465)
  t468 = 0.62182e-1 * t453 * t466
  t469 = t2 ** 2
  t470 = t469 ** 2
  t471 = t3 ** 2
  t472 = t471 ** 2
  t473 = 0.1e1 / t472
  t474 = t470 * t473
  t475 = t262 * t6
  t476 = f.my_piecewise3(t7, t21, t475)
  t477 = t366 * t148
  t478 = f.my_piecewise3(t149, t21, t477)
  t480 = (t476 + t478 - 0.2e1) * t297
  t482 = 0.1e1 + 0.51370000000000000000000000000000000000000000000000e-1 * t451
  t487 = 0.70594500000000000000000000000000000000000000000000e1 * t454 + 0.15494250000000000000000000000000000000000000000000e1 * t451 + 0.42077500000000000000000000000000000000000000000000e0 * t457 + 0.15629250000000000000000000000000000000000000000000e0 * t460
  t490 = 0.1e1 + 0.32164683177870697973624959794146027661627532968800e2 / t487
  t491 = jnp.log(t490)
  t495 = 0.1e1 + 0.27812500000000000000000000000000000000000000000000e-1 * t451
  t500 = 0.51785000000000000000000000000000000000000000000000e1 * t454 + 0.90577500000000000000000000000000000000000000000000e0 * t451 + 0.11003250000000000000000000000000000000000000000000e0 * t457 + 0.12417750000000000000000000000000000000000000000000e0 * t460
  t503 = 0.1e1 + 0.29608574643216675549239059631669331438384556167466e2 / t500
  t504 = jnp.log(t503)
  t505 = t495 * t504
  t507 = -0.31090e-1 * t482 * t491 + t468 - 0.19751789702565206228825776161588751761046270558698e-1 * t505
  t508 = t480 * t507
  t512 = -t468 + t474 * t508 + 0.19751789702565206228825776161588751761046270558698e-1 * t480 * t505 - t332 - t422
  t514 = params.c_ab[1]
  t515 = t101 + t215
  t516 = t514 * t515
  t519 = 0.1e1 + 0.30000000000000000000000000000000000000000000000000e-2 * t101 + 0.30000000000000000000000000000000000000000000000000e-2 * t215
  t520 = 0.1e1 / t519
  t523 = params.c_ab[2]
  t524 = t515 ** 2
  t525 = t523 * t524
  t526 = t519 ** 2
  t527 = 0.1e1 / t526
  t530 = params.c_ab[3]
  t531 = t524 * t515
  t532 = t530 * t531
  t534 = 0.1e1 / t526 / t519
  t537 = params.c_ab[4]
  t538 = t524 ** 2
  t539 = t537 * t538
  t540 = t526 ** 2
  t541 = 0.1e1 / t540
  t544 = params.c_ab[0] + 0.30000000000000000000000000000000000000000000000000e-2 * t516 * t520 + 0.90000000000000000000000000000000000000000000000000e-5 * t525 * t527 + 0.27000000000000000000000000000000000000000000000000e-7 * t532 * t534 + 0.81000000000000000000000000000000000000000000000000e-10 * t539 * t541
  t545 = t512 * t544
  t547 = t2 / t471
  t548 = t4 - t547
  t553 = t23 * t278
  t556 = t18 * t553 * t142 / 0.64e2
  t558 = t26 * t9 * t17
  t561 = t25 / t27 / t26
  t562 = t91 * t141
  t567 = t46 * t45
  t568 = 0.1e1 / t567
  t570 = 0.1e1 / t24 / t3
  t571 = t570 * t16
  t573 = t34 * t571 * t39
  t575 = t32 * t33 * t35
  t576 = t27 ** 2
  t578 = t16 / t576
  t579 = t6 ** 2
  t581 = t38 / t579
  t586 = -t575 * t578 * t581 * t548 / 0.54e2 - t573 / 0.54e2
  t587 = f.my_piecewise3(t44, t586, 0)
  t590 = t49 * t45
  t591 = 0.1e1 / t590
  t594 = t49 * t567
  t595 = 0.1e1 / t594
  t599 = 0.1e1 / t55 / t45
  t603 = 0.1e1 / t55 / t567
  t607 = 0.1e1 / t55 / t590
  t611 = 0.1e1 / t55 / t594
  t615 = 0.1e1 / t67 / t45
  t619 = f.my_piecewise3(t44, 0, t586)
  t621 = t80 * t78
  t626 = 0.1e1 / t77 / t71
  t630 = t71 * t81
  t642 = f.my_piecewise3(t43, -t568 * t587 / 0.18e2 + t591 * t587 / 0.240e3 - t595 * t587 / 0.4480e4 + t599 * t587 / 0.103680e6 - t603 * t587 / 0.2838528e7 + t607 * t587 / 0.89456640e8 - t611 * t587 / 0.3185049600e10 + t615 * t587 / 0.126340300800e12, -0.8e1 / 0.3e1 * t619 * t87 - 0.8e1 / 0.3e1 * t71 * (-t621 * t619 + 0.2e1 * t619 * t84 + 0.2e1 * t71 * (t626 * t619 * t80 / 0.2e1 - 0.4e1 * t630 * t619 - t73 * t619 * t80)))
  t648 = t96 * r0
  t650 = 0.1e1 / t98 / t648
  t655 = t111 * t96
  t657 = 0.1e1 / t97 / t655
  t658 = t657 * t116
  t665 = 0.1e1 / t123 / r0
  t666 = t665 * t126
  t674 = 0.1e1 / t98 / t123 / t648
  t675 = t674 * t137
  t680 = t131 * s0
  t684 = 0.1e1 / t97 / t123 / t655
  t686 = 0.1e1 / t136 / t103
  t696 = f.my_piecewise3(t8, 0, -0.3e1 / 0.64e2 * t548 * t9 * t17 * t143 - t556 - t558 * t561 * t562 * t548 / 0.64e2 - 0.3e1 / 0.64e2 * t18 * t25 * t28 * t642 * t141 - 0.3e1 / 0.64e2 * t18 * t25 * t92 * (-0.10666666666666666666666666666666666666666666666667e-1 * t95 * t650 * t104 + 0.42666666666666666666666666666666666666666666666668e-4 * t94 * t109 * t658 - 0.85333333333333333333333333333333333333333333333333e-4 * t110 * t658 + 0.34133333333333333333333333333333333333333333333334e-6 * t108 * t121 * t666 - 0.512e-6 * t122 * t666 + 0.20480000000000000000000000000000000000000000000001e-8 * t120 * t131 * t675 - 0.27306666666666666666666666666666666666666666666667e-8 * t132 * t675 + 0.10922666666666666666666666666666666666666666666667e-10 * t130 * t680 * t684 * t686))
  t697 = -t548
  t704 = t152 * t553 * t253 / 0.64e2
  t706 = t153 * t9 * t17
  t709 = t25 / t154 / t153
  t710 = t207 * t252
  t715 = t163 * t162
  t716 = 0.1e1 / t715
  t718 = t34 * t571 * t156
  t719 = t154 ** 2
  t721 = t16 / t719
  t722 = t148 ** 2
  t724 = t38 / t722
  t729 = -t575 * t721 * t724 * t697 / 0.54e2 - t718 / 0.54e2
  t730 = f.my_piecewise3(t161, t729, 0)
  t733 = t166 * t162
  t734 = 0.1e1 / t733
  t737 = t166 * t715
  t738 = 0.1e1 / t737
  t742 = 0.1e1 / t172 / t162
  t746 = 0.1e1 / t172 / t715
  t750 = 0.1e1 / t172 / t733
  t754 = 0.1e1 / t172 / t737
  t758 = 0.1e1 / t184 / t162
  t762 = f.my_piecewise3(t161, 0, t729)
  t764 = t196 * t194
  t769 = 0.1e1 / t193 / t188
  t773 = t188 * t197
  t785 = f.my_piecewise3(t160, -t716 * t730 / 0.18e2 + t734 * t730 / 0.240e3 - t738 * t730 / 0.4480e4 + t742 * t730 / 0.103680e6 - t746 * t730 / 0.2838528e7 + t750 * t730 / 0.89456640e8 - t754 * t730 / 0.3185049600e10 + t758 * t730 / 0.126340300800e12, -0.8e1 / 0.3e1 * t762 * t203 - 0.8e1 / 0.3e1 * t188 * (-t764 * t762 + 0.2e1 * t762 * t200 + 0.2e1 * t188 * (t769 * t762 * t196 / 0.2e1 - 0.4e1 * t773 * t762 - t189 * t762 * t196)))
  t792 = f.my_piecewise3(t150, 0, -0.3e1 / 0.64e2 * t697 * t9 * t17 * t254 - t704 - t706 * t709 * t710 * t697 / 0.64e2 - 0.3e1 / 0.64e2 * t152 * t25 * t155 * t785 * t252)
  t793 = f.my_piecewise3(t7, 0, t548)
  t796 = t260 * t571 * t264
  t797 = 0.17808333333333333333333333333333333333333333333333e-1 * t796
  t798 = 0.1e1 / t475
  t801 = f.my_piecewise3(t7, 0, -t798 * t548 / 0.3e1)
  t803 = t260 * t36 * t801
  t807 = 0.62182e-1 * (-t797 + 0.53425000000000000000000000000000000000000000000000e-1 * t803) * t289
  t808 = t285 ** 2
  t810 = t268 / t808
  t811 = 0.1e1 / t269
  t812 = t796 / 0.3e1
  t813 = -t812 + t803
  t814 = t811 * t813
  t816 = 0.29896666666666666666666666666666666666666666666667e0 * t796
  t818 = t266 ** 0.5e0
  t819 = t818 * t813
  t822 = 0.1e1 / t277 / t3
  t823 = t822 * t279
  t825 = t276 * t823 * t281
  t826 = 0.82156666666666666666666666666666666666666666666667e-1 * t825
  t829 = t276 * t280 * t264 * t801
  t832 = 0.1e1 / t288
  t835 = 0.10000000000000000000000000000000000000000000000000e1 * t810 * (0.18989250000000000000000000000000000000000000000000e1 * t814 - t816 + 0.89690000000000000000000000000000000000000000000000e0 * t803 + 0.30716250000000000000000000000000000000000000000000e0 * t819 - t826 + 0.24647000000000000000000000000000000000000000000000e0 * t829) * t832
  t836 = 0.17123333333333333333333333333333333333333333333333e-1 * t796
  t841 = t305 ** 2
  t843 = t300 / t841
  t845 = 0.51647500000000000000000000000000000000000000000000e0 * t796
  t848 = 0.10419500000000000000000000000000000000000000000000e0 * t825
  t851 = 0.1e1 / t308
  t855 = 0.92708333333333333333333333333333333333333333333333e-2 * t796
  t858 = (-t855 + 0.27812500000000000000000000000000000000000000000000e-1 * t803) * t322
  t860 = t318 ** 2
  t861 = 0.1e1 / t860
  t862 = t313 * t861
  t864 = 0.30192500000000000000000000000000000000000000000000e0 * t796
  t867 = 0.82785000000000000000000000000000000000000000000000e-1 * t825
  t869 = 0.25892500000000000000000000000000000000000000000000e1 * t814 - t864 + 0.90577500000000000000000000000000000000000000000000e0 * t803 + 0.16504875000000000000000000000000000000000000000000e0 * t819 - t867 + 0.24835500000000000000000000000000000000000000000000e0 * t829
  t870 = 0.1e1 / t321
  t878 = t298 * t313
  t887 = f.my_piecewise3(t8, 0, t793 * t329 / 0.2e1 + t258 * (-t807 + t835 + t298 * (-0.31090e-1 * (-t836 + 0.51370000000000000000000000000000000000000000000000e-1 * t803) * t309 + 0.99999999999999999999999999999999999999999999999999e0 * t843 * (0.35297250000000000000000000000000000000000000000000e1 * t814 - t845 + 0.15494250000000000000000000000000000000000000000000e1 * t803 + 0.63116250000000000000000000000000000000000000000000e0 * t819 - t848 + 0.31258500000000000000000000000000000000000000000000e0 * t829) * t851 + t807 - t835 - 0.19751789702565206228825776161588751761046270558698e-1 * t858 + 0.58482233974552040708313425006184496242808878304903e0 * t862 * t869 * t870) + 0.19751789702565206228825776161588751761046270558698e-1 * t298 * t858 - 0.58482233974552040708313425006184496242808878304903e0 * t878 * t861 * t869 * t870) / 0.2e1)
  t893 = t657 * t345
  t899 = t665 * t352
  t905 = t674 * t359
  t912 = 0.1e1 / t358 / t337
  t918 = f.my_piecewise3(t149, 0, t697)
  t921 = t260 * t571 * t368
  t922 = 0.17808333333333333333333333333333333333333333333333e-1 * t921
  t923 = 0.1e1 / t477
  t926 = f.my_piecewise3(t149, 0, -t923 * t697 / 0.3e1)
  t928 = t260 * t36 * t926
  t932 = 0.62182e-1 * (-t922 + 0.53425000000000000000000000000000000000000000000000e-1 * t928) * t386
  t933 = t382 ** 2
  t935 = t372 / t933
  t936 = 0.1e1 / t373
  t937 = t921 / 0.3e1
  t938 = -t937 + t928
  t939 = t936 * t938
  t941 = 0.29896666666666666666666666666666666666666666666667e0 * t921
  t943 = t370 ** 0.5e0
  t944 = t943 * t938
  t947 = t276 * t823 * t378
  t948 = 0.82156666666666666666666666666666666666666666666667e-1 * t947
  t951 = t276 * t280 * t368 * t926
  t954 = 0.1e1 / t385
  t957 = 0.10000000000000000000000000000000000000000000000000e1 * t935 * (0.18989250000000000000000000000000000000000000000000e1 * t939 - t941 + 0.89690000000000000000000000000000000000000000000000e0 * t928 + 0.30716250000000000000000000000000000000000000000000e0 * t944 - t948 + 0.24647000000000000000000000000000000000000000000000e0 * t951) * t954
  t958 = 0.17123333333333333333333333333333333333333333333333e-1 * t921
  t963 = t395 ** 2
  t965 = t390 / t963
  t967 = 0.51647500000000000000000000000000000000000000000000e0 * t921
  t970 = 0.10419500000000000000000000000000000000000000000000e0 * t947
  t973 = 0.1e1 / t398
  t977 = 0.92708333333333333333333333333333333333333333333333e-2 * t921
  t980 = (-t977 + 0.27812500000000000000000000000000000000000000000000e-1 * t928) * t412
  t982 = t408 ** 2
  t983 = 0.1e1 / t982
  t984 = t403 * t983
  t986 = 0.30192500000000000000000000000000000000000000000000e0 * t921
  t989 = 0.82785000000000000000000000000000000000000000000000e-1 * t947
  t991 = 0.25892500000000000000000000000000000000000000000000e1 * t939 - t986 + 0.90577500000000000000000000000000000000000000000000e0 * t928 + 0.16504875000000000000000000000000000000000000000000e0 * t944 - t989 + 0.24835500000000000000000000000000000000000000000000e0 * t951
  t992 = 0.1e1 / t411
  t1000 = t298 * t403
  t1009 = f.my_piecewise3(t150, 0, t918 * t419 / 0.2e1 + t365 * (-t932 + t957 + t298 * (-0.31090e-1 * (-t958 + 0.51370000000000000000000000000000000000000000000000e-1 * t928) * t399 + 0.99999999999999999999999999999999999999999999999999e0 * t965 * (0.35297250000000000000000000000000000000000000000000e1 * t939 - t967 + 0.15494250000000000000000000000000000000000000000000e1 * t928 + 0.63116250000000000000000000000000000000000000000000e0 * t944 - t970 + 0.31258500000000000000000000000000000000000000000000e0 * t951) * t973 + t932 - t957 - 0.19751789702565206228825776161588751761046270558698e-1 * t980 + 0.58482233974552040708313425006184496242808878304903e0 * t984 * t991 * t992) + 0.19751789702565206228825776161588751761046270558698e-1 * t298 * t980 - 0.58482233974552040708313425006184496242808878304903e0 * t1000 * t983 * t991 * t992) / 0.2e1)
  t1011 = t14 * t570
  t1014 = 0.11073577833333333333333333333333333333333333333333e-2 * t259 * t1011 * t466
  t1015 = t462 ** 2
  t1020 = t15 * t570
  t1021 = 0.1e1 / t454 * t9 * t1020
  t1023 = t259 * t1011
  t1025 = t451 ** 0.5e0
  t1027 = t1025 * t9 * t1020
  t1030 = t275 * t13 * t822
  t1036 = 0.10000000000000000000000000000000000000000000000000e1 * t453 / t1015 * (-0.63297500000000000000000000000000000000000000000000e0 * t1021 - 0.29896666666666666666666666666666666666666666666667e0 * t1023 - 0.10238750000000000000000000000000000000000000000000e0 * t1027 - 0.82156666666666666666666666666666666666666666666667e-1 * t1030) / t465
  t1040 = 0.4e1 * t469 * t2 * t473 * t508
  t1045 = 0.4e1 * t470 / t472 / t3 * t508
  t1048 = f.my_piecewise3(t7, 0, 0.4e1 / 0.3e1 * t262 * t548)
  t1051 = f.my_piecewise3(t149, 0, 0.4e1 / 0.3e1 * t366 * t697)
  t1053 = (t1048 + t1051) * t297
  t1059 = t487 ** 2
  t1074 = t500 ** 2
  t1075 = 0.1e1 / t1074
  t1081 = -0.86308333333333333333333333333333333333333333333334e0 * t1021 - 0.30192500000000000000000000000000000000000000000000e0 * t1023 - 0.55016250000000000000000000000000000000000000000000e-1 * t1027 - 0.82785000000000000000000000000000000000000000000000e-1 * t1030
  t1082 = 0.1e1 / t503
  t1088 = t474 * t480 * (0.53236443333333333333333333333333333333333333333332e-3 * t259 * t1011 * t491 + 0.99999999999999999999999999999999999999999999999999e0 * t482 / t1059 * (-0.11765750000000000000000000000000000000000000000000e1 * t1021 - 0.51647500000000000000000000000000000000000000000000e0 * t1023 - 0.21038750000000000000000000000000000000000000000000e0 * t1027 - 0.10419500000000000000000000000000000000000000000000e0 * t1030) / t490 - t1014 - t1036 + 0.18311555036753159941307229983139571945136646663793e-3 * t259 * t1011 * t504 + 0.58482233974552040708313425006184496242808878304903e0 * t495 * t1075 * t1081 * t1082)
  t1095 = 0.18311555036753159941307229983139571945136646663793e-3 * t480 * t9 * t15 * t570 * t504
  t1100 = 0.58482233974552040708313425006184496242808878304903e0 * t480 * t495 * t1075 * t1081 * t1082
  t1101 = t1014 + t1036 + t1040 - t1045 + t474 * t1053 * t507 + t1088 + 0.19751789702565206228825776161588751761046270558698e-1 * t1053 * t505 - t1095 - t1100 - t887 - t1009
  t1108 = t527 * s0 * t650
  t1111 = t523 * t515
  t1115 = t534 * s0 * t650
  t1118 = t530 * t524
  t1122 = t541 * s0 * t650
  t1125 = t537 * t531
  t1129 = 0.1e1 / t540 / t519
  vrho_0_ = t146 + t257 + t364 + t449 + t545 + t3 * (t696 + t792 + t887 * t363 + t332 * (-0.53333333333333333333333333333333333333333333333333e0 * t335 * t650 * t338 + 0.10666666666666666666666666666666666666666666666667e0 * t334 * t109 * t893 - 0.21333333333333333333333333333333333333333333333333e0 * t343 * t893 + 0.42666666666666666666666666666666666666666666666668e-1 * t342 * t121 * t899 - 0.64e-1 * t350 * t899 + 0.12800000000000000000000000000000000000000000000000e-1 * t349 * t131 * t905 - 0.17066666666666666666666666666666666666666666666667e-1 * t357 * t905 + 0.34133333333333333333333333333333333333333333333333e-2 * t356 * t680 * t684 * t912) + t1009 * t448 + t1101 * t544 + t512 * (-0.80000000000000000000000000000000000000000000000000e-2 * t514 * s0 * t650 * t520 + 0.24000000000000000000000000000000000000000000000000e-4 * t516 * t1108 - 0.48000000000000000000000000000000000000000000000000e-4 * t1111 * t1108 + 0.14400000000000000000000000000000000000000000000000e-6 * t525 * t1115 - 0.21600000000000000000000000000000000000000000000000e-6 * t1118 * t1115 + 0.64800000000000000000000000000000000000000000000000e-9 * t532 * t1122 - 0.86400000000000000000000000000000000000000000000000e-9 * t1125 * t1122 + 0.25920000000000000000000000000000000000000000000000e-11 * t539 * t1129 * s0 * t650))
  t1138 = -t4 - t547
  t1151 = -t575 * t578 * t581 * t1138 / 0.54e2 - t573 / 0.54e2
  t1152 = f.my_piecewise3(t44, t1151, 0)
  t1170 = f.my_piecewise3(t44, 0, t1151)
  t1189 = f.my_piecewise3(t43, -t568 * t1152 / 0.18e2 + t591 * t1152 / 0.240e3 - t595 * t1152 / 0.4480e4 + t599 * t1152 / 0.103680e6 - t603 * t1152 / 0.2838528e7 + t607 * t1152 / 0.89456640e8 - t611 * t1152 / 0.3185049600e10 + t615 * t1152 / 0.126340300800e12, -0.8e1 / 0.3e1 * t1170 * t87 - 0.8e1 / 0.3e1 * t71 * (-t621 * t1170 + 0.2e1 * t1170 * t84 + 0.2e1 * t71 * (t626 * t1170 * t80 / 0.2e1 - 0.4e1 * t630 * t1170 - t73 * t1170 * t80)))
  t1196 = f.my_piecewise3(t8, 0, -0.3e1 / 0.64e2 * t1138 * t9 * t17 * t143 - t556 - t558 * t561 * t562 * t1138 / 0.64e2 - 0.3e1 / 0.64e2 * t18 * t25 * t28 * t1189 * t141)
  t1197 = -t1138
  t1210 = -t575 * t721 * t724 * t1197 / 0.54e2 - t718 / 0.54e2
  t1211 = f.my_piecewise3(t161, t1210, 0)
  t1229 = f.my_piecewise3(t161, 0, t1210)
  t1248 = f.my_piecewise3(t160, -t716 * t1211 / 0.18e2 + t734 * t1211 / 0.240e3 - t738 * t1211 / 0.4480e4 + t742 * t1211 / 0.103680e6 - t746 * t1211 / 0.2838528e7 + t750 * t1211 / 0.89456640e8 - t754 * t1211 / 0.3185049600e10 + t758 * t1211 / 0.126340300800e12, -0.8e1 / 0.3e1 * t1229 * t203 - 0.8e1 / 0.3e1 * t188 * (-t764 * t1229 + 0.2e1 * t1229 * t200 + 0.2e1 * t188 * (t769 * t1229 * t196 / 0.2e1 - 0.4e1 * t773 * t1229 - t189 * t1229 * t196)))
  t1254 = t210 * r1
  t1256 = 0.1e1 / t212 / t1254
  t1261 = t224 * t210
  t1263 = 0.1e1 / t211 / t1261
  t1264 = t1263 * t229
  t1271 = 0.1e1 / t235 / r1
  t1272 = t1271 * t238
  t1280 = 0.1e1 / t212 / t235 / t1254
  t1281 = t1280 * t248
  t1286 = t242 * s2
  t1290 = 0.1e1 / t211 / t235 / t1261
  t1292 = 0.1e1 / t247 / t217
  t1302 = f.my_piecewise3(t150, 0, -0.3e1 / 0.64e2 * t1197 * t9 * t17 * t254 - t704 - t706 * t709 * t710 * t1197 / 0.64e2 - 0.3e1 / 0.64e2 * t152 * t25 * t155 * t1248 * t252 - 0.3e1 / 0.64e2 * t152 * t25 * t208 * (-0.10666666666666666666666666666666666666666666666667e-1 * t209 * t1256 * t218 + 0.42666666666666666666666666666666666666666666666668e-4 * t94 * t222 * t1264 - 0.85333333333333333333333333333333333333333333333333e-4 * t223 * t1264 + 0.34133333333333333333333333333333333333333333333334e-6 * t108 * t233 * t1272 - 0.512e-6 * t234 * t1272 + 0.20480000000000000000000000000000000000000000000001e-8 * t120 * t242 * t1281 - 0.27306666666666666666666666666666666666666666666667e-8 * t243 * t1281 + 0.10922666666666666666666666666666666666666666666667e-10 * t130 * t1286 * t1290 * t1292))
  t1303 = f.my_piecewise3(t7, 0, t1138)
  t1307 = f.my_piecewise3(t7, 0, -t798 * t1138 / 0.3e1)
  t1309 = t260 * t36 * t1307
  t1313 = 0.62182e-1 * (-t797 + 0.53425000000000000000000000000000000000000000000000e-1 * t1309) * t289
  t1314 = -t812 + t1309
  t1315 = t811 * t1314
  t1318 = t818 * t1314
  t1322 = t276 * t280 * t264 * t1307
  t1327 = 0.10000000000000000000000000000000000000000000000000e1 * t810 * (0.18989250000000000000000000000000000000000000000000e1 * t1315 - t816 + 0.89690000000000000000000000000000000000000000000000e0 * t1309 + 0.30716250000000000000000000000000000000000000000000e0 * t1318 - t826 + 0.24647000000000000000000000000000000000000000000000e0 * t1322) * t832
  t1342 = (-t855 + 0.27812500000000000000000000000000000000000000000000e-1 * t1309) * t322
  t1348 = 0.25892500000000000000000000000000000000000000000000e1 * t1315 - t864 + 0.90577500000000000000000000000000000000000000000000e0 * t1309 + 0.16504875000000000000000000000000000000000000000000e0 * t1318 - t867 + 0.24835500000000000000000000000000000000000000000000e0 * t1322
  t1364 = f.my_piecewise3(t8, 0, t1303 * t329 / 0.2e1 + t258 * (-t1313 + t1327 + t298 * (-0.31090e-1 * (-t836 + 0.51370000000000000000000000000000000000000000000000e-1 * t1309) * t309 + 0.99999999999999999999999999999999999999999999999999e0 * t843 * (0.35297250000000000000000000000000000000000000000000e1 * t1315 - t845 + 0.15494250000000000000000000000000000000000000000000e1 * t1309 + 0.63116250000000000000000000000000000000000000000000e0 * t1318 - t848 + 0.31258500000000000000000000000000000000000000000000e0 * t1322) * t851 + t1313 - t1327 - 0.19751789702565206228825776161588751761046270558698e-1 * t1342 + 0.58482233974552040708313425006184496242808878304903e0 * t862 * t1348 * t870) + 0.19751789702565206228825776161588751761046270558698e-1 * t298 * t1342 - 0.58482233974552040708313425006184496242808878304903e0 * t878 * t861 * t1348 * t870) / 0.2e1)
  t1366 = f.my_piecewise3(t149, 0, t1197)
  t1370 = f.my_piecewise3(t149, 0, -t923 * t1197 / 0.3e1)
  t1372 = t260 * t36 * t1370
  t1376 = 0.62182e-1 * (-t922 + 0.53425000000000000000000000000000000000000000000000e-1 * t1372) * t386
  t1377 = -t937 + t1372
  t1378 = t936 * t1377
  t1381 = t943 * t1377
  t1385 = t276 * t280 * t368 * t1370
  t1390 = 0.10000000000000000000000000000000000000000000000000e1 * t935 * (0.18989250000000000000000000000000000000000000000000e1 * t1378 - t941 + 0.89690000000000000000000000000000000000000000000000e0 * t1372 + 0.30716250000000000000000000000000000000000000000000e0 * t1381 - t948 + 0.24647000000000000000000000000000000000000000000000e0 * t1385) * t954
  t1405 = (-t977 + 0.27812500000000000000000000000000000000000000000000e-1 * t1372) * t412
  t1411 = 0.25892500000000000000000000000000000000000000000000e1 * t1378 - t986 + 0.90577500000000000000000000000000000000000000000000e0 * t1372 + 0.16504875000000000000000000000000000000000000000000e0 * t1381 - t989 + 0.24835500000000000000000000000000000000000000000000e0 * t1385
  t1427 = f.my_piecewise3(t150, 0, t1366 * t419 / 0.2e1 + t365 * (-t1376 + t1390 + t298 * (-0.31090e-1 * (-t958 + 0.51370000000000000000000000000000000000000000000000e-1 * t1372) * t399 + 0.99999999999999999999999999999999999999999999999999e0 * t965 * (0.35297250000000000000000000000000000000000000000000e1 * t1378 - t967 + 0.15494250000000000000000000000000000000000000000000e1 * t1372 + 0.63116250000000000000000000000000000000000000000000e0 * t1381 - t970 + 0.31258500000000000000000000000000000000000000000000e0 * t1385) * t973 + t1376 - t1390 - 0.19751789702565206228825776161588751761046270558698e-1 * t1405 + 0.58482233974552040708313425006184496242808878304903e0 * t984 * t1411 * t992) + 0.19751789702565206228825776161588751761046270558698e-1 * t298 * t1405 - 0.58482233974552040708313425006184496242808878304903e0 * t1000 * t983 * t1411 * t992) / 0.2e1)
  t1433 = t1263 * t432
  t1439 = t1271 * t438
  t1445 = t1280 * t444
  t1452 = 0.1e1 / t443 / t425
  t1460 = f.my_piecewise3(t7, 0, 0.4e1 / 0.3e1 * t262 * t1138)
  t1463 = f.my_piecewise3(t149, 0, 0.4e1 / 0.3e1 * t366 * t1197)
  t1465 = (t1460 + t1463) * t297
  t1470 = t1014 + t1036 - t1040 - t1045 + t474 * t1465 * t507 + t1088 + 0.19751789702565206228825776161588751761046270558698e-1 * t1465 * t505 - t1095 - t1100 - t1364 - t1427
  t1477 = t527 * s2 * t1256
  t1483 = t534 * s2 * t1256
  t1489 = t541 * s2 * t1256
  vrho_1_ = t146 + t257 + t364 + t449 + t545 + t3 * (t1196 + t1302 + t1364 * t363 + t1427 * t448 + t422 * (-0.53333333333333333333333333333333333333333333333333e0 * t423 * t1256 * t426 + 0.10666666666666666666666666666666666666666666666667e0 * t334 * t222 * t1433 - 0.21333333333333333333333333333333333333333333333333e0 * t430 * t1433 + 0.42666666666666666666666666666666666666666666666668e-1 * t342 * t233 * t1439 - 0.64e-1 * t436 * t1439 + 0.12800000000000000000000000000000000000000000000000e-1 * t349 * t242 * t1445 - 0.17066666666666666666666666666666666666666666666667e-1 * t442 * t1445 + 0.34133333333333333333333333333333333333333333333333e-2 * t356 * t1286 * t1290 * t1452) + t1470 * t544 + t512 * (-0.80000000000000000000000000000000000000000000000000e-2 * t514 * s2 * t1256 * t520 + 0.24000000000000000000000000000000000000000000000000e-4 * t516 * t1477 - 0.48000000000000000000000000000000000000000000000000e-4 * t1111 * t1477 + 0.14400000000000000000000000000000000000000000000000e-6 * t525 * t1483 - 0.21600000000000000000000000000000000000000000000000e-6 * t1118 * t1483 + 0.64800000000000000000000000000000000000000000000000e-9 * t532 * t1489 - 0.86400000000000000000000000000000000000000000000000e-9 * t1125 * t1489 + 0.25920000000000000000000000000000000000000000000000e-11 * t539 * t1129 * s2 * t1256))
  t1522 = 0.1e1 / t97 / t123 / t112
  t1531 = f.my_piecewise3(t8, 0, -0.3e1 / 0.64e2 * t18 * t25 * t92 * (0.4e-2 * t94 * t100 * t104 - 0.16e-4 * t95 * t117 + 0.32e-4 * t108 * s0 * t117 - 0.128e-6 * t110 * t127 + 0.192e-6 * t120 * t109 * t127 - 0.768e-9 * t122 * t138 + 0.1024e-8 * t130 * t121 * t138 - 0.4096e-11 * t132 * t1522 * t686))
  t1558 = t527 * t100
  t1563 = t534 * t100
  t1568 = t541 * t100
  vsigma_0_ = t3 * (t1531 + t332 * (0.2e0 * t334 * t100 * t338 - 0.4e-1 * t335 * t346 + 0.8e-1 * t342 * s0 * t346 - 0.16e-1 * t343 * t353 + 0.24e-1 * t349 * t109 * t353 - 0.48e-2 * t350 * t360 + 0.64e-2 * t356 * t121 * t360 - 0.128e-2 * t357 * t1522 * t912) + t512 * (0.30000000000000000000000000000000000000000000000000e-2 * t514 * t100 * t520 - 0.90000000000000000000000000000000000000000000000000e-5 * t516 * t1558 + 0.18000000000000000000000000000000000000000000000000e-4 * t1111 * t1558 - 0.54000000000000000000000000000000000000000000000000e-7 * t525 * t1563 + 0.81000000000000000000000000000000000000000000000000e-7 * t1118 * t1563 - 0.24300000000000000000000000000000000000000000000000e-9 * t532 * t1568 + 0.32400000000000000000000000000000000000000000000000e-9 * t1125 * t1568 - 0.97200000000000000000000000000000000000000000000000e-12 * t539 * t1129 * t100))
  vsigma_1_ = 0.0e0
  t1599 = 0.1e1 / t211 / t235 / t225
  t1608 = f.my_piecewise3(t150, 0, -0.3e1 / 0.64e2 * t152 * t25 * t208 * (0.4e-2 * t94 * t214 * t218 - 0.16e-4 * t209 * t230 + 0.32e-4 * t108 * s2 * t230 - 0.128e-6 * t223 * t239 + 0.192e-6 * t120 * t222 * t239 - 0.768e-9 * t234 * t249 + 0.1024e-8 * t130 * t233 * t249 - 0.4096e-11 * t243 * t1599 * t1292))
  t1635 = t527 * t214
  t1640 = t534 * t214
  t1645 = t541 * t214
  vsigma_2_ = t3 * (t1608 + t422 * (0.2e0 * t334 * t214 * t426 - 0.4e-1 * t423 * t433 + 0.8e-1 * t342 * s2 * t433 - 0.16e-1 * t430 * t439 + 0.24e-1 * t349 * t222 * t439 - 0.48e-2 * t436 * t445 + 0.64e-2 * t356 * t233 * t445 - 0.128e-2 * t442 * t1599 * t1452) + t512 * (0.30000000000000000000000000000000000000000000000000e-2 * t514 * t214 * t520 - 0.90000000000000000000000000000000000000000000000000e-5 * t516 * t1635 + 0.18000000000000000000000000000000000000000000000000e-4 * t1111 * t1635 - 0.54000000000000000000000000000000000000000000000000e-7 * t525 * t1640 + 0.81000000000000000000000000000000000000000000000000e-7 * t1118 * t1640 - 0.24300000000000000000000000000000000000000000000000e-9 * t532 * t1645 + 0.32400000000000000000000000000000000000000000000000e-9 * t1125 * t1645 - 0.97200000000000000000000000000000000000000000000000e-12 * t539 * t1129 * t214))

  res = {'vrho': jnp.stack([vrho_0_, vrho_1_], axis=-1), 'vsigma': jnp.stack([vsigma_0_, vsigma_1_, vsigma_2_], axis=-1)}
  return res


def unpol_vxc(p, r, s=None, l=None, tau=None):
  f = funcs(p)
  params = f.params
  r0, s0, l0, tau0 = r, s, l, tau

  t3 = 0.1e1 <= f.p.zeta_threshold
  t4 = jnp.logical_or(r0 / 0.2e1 <= f.p.dens_threshold, t3)
  t5 = 3 ** (0.1e1 / 0.3e1)
  t7 = (0.1e1 / jnp.pi) ** (0.1e1 / 0.3e1)
  t8 = t5 * t7
  t9 = 4 ** (0.1e1 / 0.3e1)
  t10 = t9 ** 2
  t11 = 2 ** (0.1e1 / 0.3e1)
  t13 = t8 * t10 * t11
  t14 = 0.2e1 <= f.p.zeta_threshold
  t15 = f.p.zeta_threshold ** (0.1e1 / 0.3e1)
  t16 = t15 * f.p.zeta_threshold
  t18 = f.my_piecewise3(t14, t16, 0.2e1 * t11)
  t19 = r0 ** (0.1e1 / 0.3e1)
  t20 = t18 * t19
  t21 = 9 ** (0.1e1 / 0.3e1)
  t22 = t21 ** 2
  t23 = t7 ** 2
  t25 = t22 * t23 * f.p.cam_omega
  t26 = 0.1e1 / t19
  t28 = f.my_piecewise3(t14, t15, t11)
  t30 = t11 / t28
  t33 = t25 * t5 * t26 * t30 / 0.18e2
  t34 = 0.135e1 <= t33
  t35 = 0.135e1 < t33
  t36 = f.my_piecewise3(t35, t33, 0.135e1)
  t37 = t36 ** 2
  t40 = t37 ** 2
  t43 = t40 * t37
  t46 = t40 ** 2
  t58 = t46 ** 2
  t62 = f.my_piecewise3(t35, 0.135e1, t33)
  t63 = jnp.sqrt(jnp.pi)
  t64 = 0.1e1 / t62
  t66 = jnp.erf(t64 / 0.2e1)
  t68 = t62 ** 2
  t69 = 0.1e1 / t68
  t71 = jnp.exp(-t69 / 0.4e1)
  t72 = t71 - 0.1e1
  t75 = t71 - 0.3e1 / 0.2e1 - 0.2e1 * t68 * t72
  t78 = 0.2e1 * t62 * t75 + t63 * t66
  t82 = f.my_piecewise3(t34, 0.1e1 / t37 / 0.36e2 - 0.1e1 / t40 / 0.960e3 + 0.1e1 / t43 / 0.26880e5 - 0.1e1 / t46 / 0.829440e6 + 0.1e1 / t46 / t37 / 0.28385280e8 - 0.1e1 / t46 / t40 / 0.1073479680e10 + 0.1e1 / t46 / t43 / 0.44590694400e11 - 0.1e1 / t58 / 0.2021444812800e13, 0.1e1 - 0.8e1 / 0.3e1 * t62 * t78)
  t84 = params.c_x[1]
  t85 = t84 * s0
  t86 = t11 ** 2
  t87 = r0 ** 2
  t88 = t19 ** 2
  t90 = 0.1e1 / t88 / t87
  t91 = t86 * t90
  t93 = s0 * t86 * t90
  t95 = 0.1e1 + 0.4e-2 * t93
  t96 = 0.1e1 / t95
  t100 = params.c_x[2]
  t101 = s0 ** 2
  t102 = t100 * t101
  t103 = t87 ** 2
  t104 = t103 * r0
  t107 = t11 / t19 / t104
  t108 = t95 ** 2
  t109 = 0.1e1 / t108
  t110 = t107 * t109
  t113 = params.c_x[3]
  t114 = t101 * s0
  t115 = t113 * t114
  t116 = t103 ** 2
  t117 = 0.1e1 / t116
  t119 = 0.1e1 / t108 / t95
  t120 = t117 * t119
  t123 = params.c_x[4]
  t124 = t101 ** 2
  t125 = t123 * t124
  t129 = t86 / t88 / t116 / t87
  t130 = t108 ** 2
  t131 = 0.1e1 / t130
  t132 = t129 * t131
  t135 = params.c_x[0] + 0.4e-2 * t85 * t91 * t96 + 0.32e-4 * t102 * t110 + 0.256e-6 * t115 * t120 + 0.1024e-8 * t125 * t132
  t136 = t82 * t135
  t140 = f.my_piecewise3(t4, 0, -0.3e1 / 0.64e2 * t13 * t20 * t136)
  t142 = f.my_piecewise3(t3, f.p.zeta_threshold, 1)
  t143 = t8 * t10
  t146 = f.my_piecewise3(t3, 0.1e1 / t15, 1)
  t148 = t143 * t26 * t11 * t146
  t150 = 0.1e1 + 0.53425000000000000000000000000000000000000000000000e-1 * t148
  t151 = jnp.sqrt(t148)
  t154 = t148 ** 0.15e1
  t156 = t5 ** 2
  t157 = t156 * t23
  t158 = t157 * t9
  t159 = 0.1e1 / t88
  t161 = t146 ** 2
  t163 = t158 * t159 * t86 * t161
  t165 = 0.37978500000000000000000000000000000000000000000000e1 * t151 + 0.89690000000000000000000000000000000000000000000000e0 * t148 + 0.20477500000000000000000000000000000000000000000000e0 * t154 + 0.12323500000000000000000000000000000000000000000000e0 * t163
  t168 = 0.1e1 + 0.16081824322151104821330931780901225435013347914188e2 / t165
  t169 = jnp.log(t168)
  t171 = 0.62182e-1 * t150 * t169
  t173 = f.my_piecewise3(0.0e0 <= f.p.zeta_threshold, t16, 0)
  t177 = 0.1e1 / (0.2e1 * t11 - 0.2e1)
  t178 = (t18 + t173 - 0.2e1) * t177
  t180 = 0.1e1 + 0.51370000000000000000000000000000000000000000000000e-1 * t148
  t185 = 0.70594500000000000000000000000000000000000000000000e1 * t151 + 0.15494250000000000000000000000000000000000000000000e1 * t148 + 0.42077500000000000000000000000000000000000000000000e0 * t154 + 0.15629250000000000000000000000000000000000000000000e0 * t163
  t188 = 0.1e1 + 0.32164683177870697973624959794146027661627532968800e2 / t185
  t189 = jnp.log(t188)
  t193 = 0.1e1 + 0.27812500000000000000000000000000000000000000000000e-1 * t148
  t198 = 0.51785000000000000000000000000000000000000000000000e1 * t151 + 0.90577500000000000000000000000000000000000000000000e0 * t148 + 0.11003250000000000000000000000000000000000000000000e0 * t154 + 0.12417750000000000000000000000000000000000000000000e0 * t163
  t201 = 0.1e1 + 0.29608574643216675549239059631669331438384556167466e2 / t198
  t202 = jnp.log(t201)
  t203 = t193 * t202
  t212 = f.my_piecewise3(t4, 0, t142 * (-t171 + t178 * (-0.31090e-1 * t180 * t189 + t171 - 0.19751789702565206228825776161588751761046270558698e-1 * t203) + 0.19751789702565206228825776161588751761046270558698e-1 * t178 * t203) / 0.2e1)
  t214 = params.c_ss[1]
  t215 = t214 * s0
  t217 = 0.1e1 + 0.2e0 * t93
  t218 = 0.1e1 / t217
  t222 = params.c_ss[2]
  t223 = t222 * t101
  t224 = t217 ** 2
  t225 = 0.1e1 / t224
  t226 = t107 * t225
  t229 = params.c_ss[3]
  t230 = t229 * t114
  t232 = 0.1e1 / t224 / t217
  t233 = t117 * t232
  t236 = params.c_ss[4]
  t237 = t236 * t124
  t238 = t224 ** 2
  t239 = 0.1e1 / t238
  t240 = t129 * t239
  t243 = params.c_ss[0] + 0.2e0 * t215 * t91 * t218 + 0.8e-1 * t223 * t226 + 0.32e-1 * t230 * t233 + 0.64e-2 * t237 * t240
  t247 = t8 * t10 * t26
  t249 = 0.1e1 + 0.53425000000000000000000000000000000000000000000000e-1 * t247
  t250 = jnp.sqrt(t247)
  t253 = t247 ** 0.15e1
  t256 = t157 * t9 * t159
  t258 = 0.37978500000000000000000000000000000000000000000000e1 * t250 + 0.89690000000000000000000000000000000000000000000000e0 * t247 + 0.20477500000000000000000000000000000000000000000000e0 * t253 + 0.12323500000000000000000000000000000000000000000000e0 * t256
  t261 = 0.1e1 + 0.16081824322151104821330931780901225435013347914188e2 / t258
  t262 = jnp.log(t261)
  t265 = f.my_piecewise3(t3, t16, 1)
  t268 = (0.2e1 * t265 - 0.2e1) * t177
  t270 = 0.1e1 + 0.27812500000000000000000000000000000000000000000000e-1 * t247
  t275 = 0.51785000000000000000000000000000000000000000000000e1 * t250 + 0.90577500000000000000000000000000000000000000000000e0 * t247 + 0.11003250000000000000000000000000000000000000000000e0 * t253 + 0.12417750000000000000000000000000000000000000000000e0 * t256
  t278 = 0.1e1 + 0.29608574643216675549239059631669331438384556167466e2 / t275
  t279 = jnp.log(t278)
  t284 = -0.62182e-1 * t249 * t262 + 0.19751789702565206228825776161588751761046270558698e-1 * t268 * t270 * t279 - 0.2e1 * t212
  t286 = params.c_ab[1]
  t287 = t286 * s0
  t289 = 0.1e1 + 0.6e-2 * t93
  t290 = 0.1e1 / t289
  t294 = params.c_ab[2]
  t295 = t294 * t101
  t296 = t289 ** 2
  t297 = 0.1e1 / t296
  t298 = t107 * t297
  t301 = params.c_ab[3]
  t302 = t301 * t114
  t304 = 0.1e1 / t296 / t289
  t305 = t117 * t304
  t308 = params.c_ab[4]
  t309 = t308 * t124
  t310 = t296 ** 2
  t311 = 0.1e1 / t310
  t312 = t129 * t311
  t315 = params.c_ab[0] + 0.6e-2 * t287 * t91 * t290 + 0.72e-4 * t295 * t298 + 0.864e-6 * t302 * t305 + 0.5184e-8 * t309 * t312
  t321 = t37 * t36
  t324 = 0.1e1 / t19 / r0
  t328 = t25 * t5 * t324 * t30 / 0.54e2
  t329 = f.my_piecewise3(t35, -t328, 0)
  t332 = t40 * t36
  t336 = t40 * t321
  t361 = f.my_piecewise3(t35, 0, -t328)
  t384 = f.my_piecewise3(t34, -0.1e1 / t321 * t329 / 0.18e2 + 0.1e1 / t332 * t329 / 0.240e3 - 0.1e1 / t336 * t329 / 0.4480e4 + 0.1e1 / t46 / t36 * t329 / 0.103680e6 - 0.1e1 / t46 / t321 * t329 / 0.2838528e7 + 0.1e1 / t46 / t332 * t329 / 0.89456640e8 - 0.1e1 / t46 / t336 * t329 / 0.3185049600e10 + 0.1e1 / t58 / t36 * t329 / 0.126340300800e12, -0.8e1 / 0.3e1 * t361 * t78 - 0.8e1 / 0.3e1 * t62 * (-t71 * t69 * t361 + 0.2e1 * t361 * t75 + 0.2e1 * t62 * (0.1e1 / t68 / t62 * t361 * t71 / 0.2e1 - 0.4e1 * t62 * t72 * t361 - t64 * t361 * t71)))
  t389 = t87 * r0
  t392 = t86 / t88 / t389
  t397 = t103 * t87
  t400 = t11 / t19 / t397
  t401 = t400 * t109
  t408 = 0.1e1 / t116 / r0
  t409 = t408 * t119
  t417 = 0.1e1 / t88 / t116 / t389
  t419 = t417 * t131 * t86
  t424 = t124 * s0
  t429 = t11 / t19 / t116 / t397
  t431 = 0.1e1 / t130 / t95
  t441 = f.my_piecewise3(t4, 0, -t13 * t18 * t159 * t136 / 0.64e2 - 0.3e1 / 0.64e2 * t13 * t20 * t384 * t135 - 0.3e1 / 0.64e2 * t13 * t20 * t82 * (-0.10666666666666666666666666666666666666666666666667e-1 * t85 * t392 * t96 + 0.85333333333333333333333333333333333333333333333336e-4 * t84 * t101 * t401 - 0.17066666666666666666666666666666666666666666666667e-3 * t102 * t401 + 0.13653333333333333333333333333333333333333333333334e-5 * t100 * t114 * t409 - 0.2048e-5 * t115 * t409 + 0.81920000000000000000000000000000000000000000000003e-8 * t113 * t124 * t419 - 0.10922666666666666666666666666666666666666666666667e-7 * t125 * t419 + 0.87381333333333333333333333333333333333333333333336e-10 * t123 * t424 * t429 * t431))
  t443 = t324 * t11
  t447 = 0.11073577833333333333333333333333333333333333333333e-2 * t143 * t443 * t146 * t169
  t448 = t165 ** 2
  t454 = t10 * t324
  t455 = t11 * t146
  t456 = t454 * t455
  t457 = 0.1e1 / t151 * t5 * t7 * t456
  t460 = t143 * t443 * t146
  t462 = t148 ** 0.5e0
  t465 = t462 * t5 * t7 * t456
  t468 = 0.1e1 / t88 / r0
  t471 = t158 * t468 * t86 * t161
  t477 = 0.10000000000000000000000000000000000000000000000000e1 * t150 / t448 * (-0.63297500000000000000000000000000000000000000000000e0 * t457 - 0.29896666666666666666666666666666666666666666666667e0 * t460 - 0.10238750000000000000000000000000000000000000000000e0 * t465 - 0.82156666666666666666666666666666666666666666666667e-1 * t471) / t168
  t482 = t185 ** 2
  t498 = t198 ** 2
  t499 = 0.1e1 / t498
  t505 = -0.86308333333333333333333333333333333333333333333334e0 * t457 - 0.30192500000000000000000000000000000000000000000000e0 * t460 - 0.55016250000000000000000000000000000000000000000000e-1 * t465 - 0.82785000000000000000000000000000000000000000000000e-1 * t471
  t506 = 0.1e1 / t201
  t525 = f.my_piecewise3(t4, 0, t142 * (t447 + t477 + t178 * (0.53236443333333333333333333333333333333333333333332e-3 * t143 * t443 * t146 * t189 + 0.99999999999999999999999999999999999999999999999999e0 * t180 / t482 * (-0.11765750000000000000000000000000000000000000000000e1 * t457 - 0.51647500000000000000000000000000000000000000000000e0 * t460 - 0.21038750000000000000000000000000000000000000000000e0 * t465 - 0.10419500000000000000000000000000000000000000000000e0 * t471) / t188 - t447 - t477 + 0.18311555036753159941307229983139571945136646663793e-3 * t143 * t443 * t146 * t202 + 0.58482233974552040708313425006184496242808878304903e0 * t193 * t499 * t505 * t506) - 0.18311555036753159941307229983139571945136646663793e-3 * t178 * t8 * t454 * t455 * t202 - 0.58482233974552040708313425006184496242808878304903e0 * t178 * t193 * t499 * t505 * t506) / 0.2e1)
  t532 = t400 * t225
  t538 = t408 * t232
  t545 = t417 * t239 * t86
  t552 = 0.1e1 / t238 / t217
  t562 = t258 ** 2
  t567 = t7 * t10
  t568 = t567 * t324
  t569 = 0.1e1 / t250 * t5 * t568
  t571 = t8 * t454
  t573 = t247 ** 0.5e0
  t575 = t573 * t5 * t568
  t578 = t157 * t9 * t468
  t591 = t275 ** 2
  t610 = t400 * t297
  t616 = t408 * t304
  t623 = t417 * t311 * t86
  t630 = 0.1e1 / t310 / t289
  vrho_0_ = 0.2e1 * t140 + 0.2e1 * t212 * t243 + t284 * t315 + r0 * (0.2e1 * t441 + 0.2e1 * t525 * t243 + 0.2e1 * t212 * (-0.53333333333333333333333333333333333333333333333333e0 * t215 * t392 * t218 + 0.21333333333333333333333333333333333333333333333334e0 * t214 * t101 * t532 - 0.42666666666666666666666666666666666666666666666667e0 * t223 * t532 + 0.17066666666666666666666666666666666666666666666667e0 * t222 * t114 * t538 - 0.256e0 * t230 * t538 + 0.51200000000000000000000000000000000000000000000000e-1 * t229 * t124 * t545 - 0.68266666666666666666666666666666666666666666666667e-1 * t237 * t545 + 0.27306666666666666666666666666666666666666666666668e-1 * t236 * t424 * t429 * t552) + (0.11073577833333333333333333333333333333333333333333e-2 * t8 * t454 * t262 + 0.10000000000000000000000000000000000000000000000000e1 * t249 / t562 * (-0.63297500000000000000000000000000000000000000000000e0 * t569 - 0.29896666666666666666666666666666666666666666666667e0 * t571 - 0.10238750000000000000000000000000000000000000000000e0 * t575 - 0.82156666666666666666666666666666666666666666666667e-1 * t578) / t261 - 0.18311555036753159941307229983139571945136646663793e-3 * t268 * t5 * t567 * t324 * t279 - 0.58482233974552040708313425006184496242808878304903e0 * t268 * t270 / t591 * (-0.86308333333333333333333333333333333333333333333334e0 * t569 - 0.30192500000000000000000000000000000000000000000000e0 * t571 - 0.55016250000000000000000000000000000000000000000000e-1 * t575 - 0.82785000000000000000000000000000000000000000000000e-1 * t578) / t278 - 0.2e1 * t525) * t315 + t284 * (-0.16000000000000000000000000000000000000000000000000e-1 * t287 * t392 * t290 + 0.19200000000000000000000000000000000000000000000000e-3 * t286 * t101 * t610 - 0.38400000000000000000000000000000000000000000000000e-3 * t295 * t610 + 0.46080000000000000000000000000000000000000000000000e-5 * t294 * t114 * t616 - 0.6912e-5 * t302 * t616 + 0.41472000000000000000000000000000000000000000000000e-7 * t301 * t124 * t623 - 0.55296000000000000000000000000000000000000000000000e-7 * t309 * t623 + 0.66355200000000000000000000000000000000000000000000e-9 * t308 * t424 * t429 * t630))
  t660 = t11 / t19 / t116 / t104
  t669 = f.my_piecewise3(t4, 0, -0.3e1 / 0.64e2 * t13 * t20 * t82 * (0.4e-2 * t84 * t86 * t90 * t96 - 0.32e-4 * t85 * t110 + 0.64e-4 * t100 * s0 * t110 - 0.512e-6 * t102 * t120 + 0.768e-6 * t113 * t101 * t120 - 0.3072e-8 * t115 * t132 + 0.4096e-8 * t123 * t114 * t132 - 0.32768e-10 * t125 * t660 * t431))
  vsigma_0_ = r0 * (0.2e1 * t669 + 0.2e1 * t212 * (0.2e0 * t214 * t86 * t90 * t218 - 0.8e-1 * t215 * t226 + 0.16e0 * t222 * s0 * t226 - 0.64e-1 * t223 * t233 + 0.96e-1 * t229 * t101 * t233 - 0.192e-1 * t230 * t240 + 0.256e-1 * t236 * t114 * t240 - 0.1024e-1 * t237 * t660 * t552) + t284 * (0.6e-2 * t286 * t86 * t90 * t290 - 0.72e-4 * t287 * t298 + 0.144e-3 * t294 * s0 * t298 - 0.1728e-5 * t295 * t305 + 0.2592e-5 * t301 * t101 * t305 - 0.15552e-7 * t302 * t312 + 0.20736e-7 * t308 * t114 * t312 - 0.248832e-9 * t309 * t660 * t630))

  res = {'vrho': vrho_0_, 'vsigma': vsigma_0_}
  return res
