"""Generated from mgga_x_regtm.mpl."""

import jax
import jax.lax as lax
import jax.numpy as jnp
import numpy as np
from jax.numpy import array as array
from jax.numpy import int32 as int32
from jax.numpy import nan as nan
from typing import Callable, Optional
from jxc.functionals.utils import *

def pol(p, r, s=(None, None, None), l=(None, None), tau=(None, None)):
  f = funcs(p)
  params = f.params
  (r0, r1), (s0, s1, s2), (l0, l1), (tau0, tau1) = r, s, l, tau
  tm_lambda = 0.6866

  tm_beta = 79.873

  tm_p = lambda x: (X2S * x) ** 2

  tm_alpha = lambda x, t: (t - x ** 2 / 8) / K_FACTOR_C

  tm_tratio = lambda x, t: jnp.minimum(1.0, x ** 2 / (8 * t))

  reg_c = 3

  reg_d = 1.475

  regtm_w = lambda zp: (zp ** 2 + 3 * zp ** 3) / (1 + zp ** 3) ** 2

  tm_y = lambda x: (2 * tm_lambda - 1) ** 2 * tm_p(x)

  tm_R = lambda x, t: 1 + 595 * (2 * tm_lambda - 1) ** 2 * tm_p(x) / 54 - (t - 3 * (tm_lambda ** 2 - tm_lambda + 1 / 2) * (t - K_FACTOR_C - x ** 2 / 72)) / K_FACTOR_C

  tm_qtilde = lambda x, t: 9 / 20 * (tm_alpha(x, t) - 1) + 2 * tm_p(x) / 3

  regtm_f = lambda a, p: (1 - a) ** 3 / (1 + (reg_d * a) ** 2) ** (3 / 2) * jnp.exp(-reg_c * p)

  tm_f0 = lambda x: (1 + 10 * (70 * tm_y(x) / 27) + tm_beta * tm_y(x) ** 2) ** (1 / 10)

  tm_fx_SC = lambda x, t: (1 + 10 * (+(MU_GE + 50 * tm_p(x) / 729) * tm_p(x) + 146 * tm_qtilde(x, t) ** 2 / 2025 - 73 * tm_qtilde(x, t) / 405 * (3 / 5 * tm_tratio(x, t)) * (1 - tm_tratio(x, t)))) ** (1 / 10)

  regtm_zp = lambda a, p: 1 / (1 + 3 / 5 * (a / (p + regtm_f(a, p))))

  tm_fx_DME = lambda x, t: 1 / tm_f0(x) ** 2 + 7 * tm_R(x, t) / (9 * tm_f0(x) ** 4)

  tm_w = lambda x, t: regtm_w(regtm_zp(tm_alpha(x, t), tm_p(x)))

  tm_f = lambda x, u, t: tm_w(x, t) * tm_fx_DME(x, t) + (1 - tm_w(x, t)) * tm_fx_SC(x, t)

  functional_body = lambda rs, z, xt, xs0, xs1, u0, u1, t0, t1: mgga_exchange(f, params, tm_f, rs, z, xs0, xs1, u0, u1, t0, t1)

  res = functional_body(
      f.r_ws(f.dens(r0, r1)),
      f.zeta(r0, r1),
      f.xt(r0, r1, s0, s1, s2),
      f.xs0(r0, r1, s0, s2),
      f.xs1(r0, r1, s0, s2),
      f.u0(r0, r1, l0, l1),
      f.u1(r0, r1, l0, l1),
      f.tt0(r0, r1, tau0, tau1),
      f.tt1(r0, r1, tau0, tau1),
  )
  return res

def unpol(p, r, s=None, l=None, tau=None):
  f = funcs(p)
  params = f.params
  r0, s0, l0, tau0 = r, s, l, tau
  tm_lambda = 0.6866

  tm_beta = 79.873

  tm_p = lambda x: (X2S * x) ** 2

  tm_alpha = lambda x, t: (t - x ** 2 / 8) / K_FACTOR_C

  tm_tratio = lambda x, t: jnp.minimum(1.0, x ** 2 / (8 * t))

  reg_c = 3

  reg_d = 1.475

  regtm_w = lambda zp: (zp ** 2 + 3 * zp ** 3) / (1 + zp ** 3) ** 2

  tm_y = lambda x: (2 * tm_lambda - 1) ** 2 * tm_p(x)

  tm_R = lambda x, t: 1 + 595 * (2 * tm_lambda - 1) ** 2 * tm_p(x) / 54 - (t - 3 * (tm_lambda ** 2 - tm_lambda + 1 / 2) * (t - K_FACTOR_C - x ** 2 / 72)) / K_FACTOR_C

  tm_qtilde = lambda x, t: 9 / 20 * (tm_alpha(x, t) - 1) + 2 * tm_p(x) / 3

  regtm_f = lambda a, p: (1 - a) ** 3 / (1 + (reg_d * a) ** 2) ** (3 / 2) * jnp.exp(-reg_c * p)

  tm_f0 = lambda x: (1 + 10 * (70 * tm_y(x) / 27) + tm_beta * tm_y(x) ** 2) ** (1 / 10)

  tm_fx_SC = lambda x, t: (1 + 10 * (+(MU_GE + 50 * tm_p(x) / 729) * tm_p(x) + 146 * tm_qtilde(x, t) ** 2 / 2025 - 73 * tm_qtilde(x, t) / 405 * (3 / 5 * tm_tratio(x, t)) * (1 - tm_tratio(x, t)))) ** (1 / 10)

  regtm_zp = lambda a, p: 1 / (1 + 3 / 5 * (a / (p + regtm_f(a, p))))

  tm_fx_DME = lambda x, t: 1 / tm_f0(x) ** 2 + 7 * tm_R(x, t) / (9 * tm_f0(x) ** 4)

  tm_w = lambda x, t: regtm_w(regtm_zp(tm_alpha(x, t), tm_p(x)))

  tm_f = lambda x, u, t: tm_w(x, t) * tm_fx_DME(x, t) + (1 - tm_w(x, t)) * tm_fx_SC(x, t)

  functional_body = lambda rs, z, xt, xs0, xs1, u0, u1, t0, t1: mgga_exchange(f, params, tm_f, rs, z, xs0, xs1, u0, u1, t0, t1)

  res = functional_body(
      f.r_ws(f.dens(r0 / 2, r0 / 2)),
      f.zeta(r0 / 2, r0 / 2),
      f.xt(r0 / 2, r0 / 2, s0 / 4, s0 / 4, s0 / 4),
      f.xs0(r0 / 2, r0 / 2, s0 / 4, s0 / 4),
      f.xs1(r0 / 2, r0 / 2, s0 / 4, s0 / 4),
      f.u0(r0 / 2, r0 / 2, l0 / 2, l0 / 2),
      f.u1(r0 / 2, r0 / 2, l0 / 2, l0 / 2),
      f.tt0(r0 / 2, r0 / 2, tau0 / 2, tau0 / 2),
      f.tt1(r0 / 2, r0 / 2, tau0 / 2, tau0 / 2),
  )
  return res

def pol_vxc(p, r, s=(None, None, None), l=(None, None), tau=(None, None)):
  f = funcs(p)
  params = f.params
  (r0, r1), (s0, s1, s2), (l0, l1), (tau0, tau1) = r, s, l, tau
  tm_lambda = 0.6866

  tm_beta = 79.873

  tm_p = lambda x: (X2S * x) ** 2

  tm_alpha = lambda x, t: (t - x ** 2 / 8) / K_FACTOR_C

  tm_tratio = lambda x, t: jnp.minimum(1.0, x ** 2 / (8 * t))

  reg_c = 3

  reg_d = 1.475

  regtm_w = lambda zp: (zp ** 2 + 3 * zp ** 3) / (1 + zp ** 3) ** 2

  tm_y = lambda x: (2 * tm_lambda - 1) ** 2 * tm_p(x)

  tm_R = lambda x, t: 1 + 595 * (2 * tm_lambda - 1) ** 2 * tm_p(x) / 54 - (t - 3 * (tm_lambda ** 2 - tm_lambda + 1 / 2) * (t - K_FACTOR_C - x ** 2 / 72)) / K_FACTOR_C

  tm_qtilde = lambda x, t: 9 / 20 * (tm_alpha(x, t) - 1) + 2 * tm_p(x) / 3

  regtm_f = lambda a, p: (1 - a) ** 3 / (1 + (reg_d * a) ** 2) ** (3 / 2) * jnp.exp(-reg_c * p)

  tm_f0 = lambda x: (1 + 10 * (70 * tm_y(x) / 27) + tm_beta * tm_y(x) ** 2) ** (1 / 10)

  tm_fx_SC = lambda x, t: (1 + 10 * (+(MU_GE + 50 * tm_p(x) / 729) * tm_p(x) + 146 * tm_qtilde(x, t) ** 2 / 2025 - 73 * tm_qtilde(x, t) / 405 * (3 / 5 * tm_tratio(x, t)) * (1 - tm_tratio(x, t)))) ** (1 / 10)

  regtm_zp = lambda a, p: 1 / (1 + 3 / 5 * (a / (p + regtm_f(a, p))))

  tm_fx_DME = lambda x, t: 1 / tm_f0(x) ** 2 + 7 * tm_R(x, t) / (9 * tm_f0(x) ** 4)

  tm_w = lambda x, t: regtm_w(regtm_zp(tm_alpha(x, t), tm_p(x)))

  tm_f = lambda x, u, t: tm_w(x, t) * tm_fx_DME(x, t) + (1 - tm_w(x, t)) * tm_fx_SC(x, t)

  functional_body = lambda rs, z, xt, xs0, xs1, u0, u1, t0, t1: mgga_exchange(f, params, tm_f, rs, z, xs0, xs1, u0, u1, t0, t1)

  t1 = r0 <= f.p.dens_threshold
  t2 = 3 ** (0.1e1 / 0.3e1)
  t3 = jnp.pi ** (0.1e1 / 0.3e1)
  t5 = t2 / t3
  t6 = r0 + r1
  t7 = 0.1e1 / t6
  t10 = 0.2e1 * r0 * t7 <= f.p.zeta_threshold
  t11 = f.p.zeta_threshold - 0.1e1
  t14 = 0.2e1 * r1 * t7 <= f.p.zeta_threshold
  t15 = -t11
  t16 = r0 - r1
  t17 = t16 * t7
  t18 = f.my_piecewise5(t10, t11, t14, t15, t17)
  t19 = 0.1e1 + t18
  t20 = t19 <= f.p.zeta_threshold
  t21 = f.p.zeta_threshold ** (0.1e1 / 0.3e1)
  t22 = t21 * f.p.zeta_threshold
  t23 = t19 ** (0.1e1 / 0.3e1)
  t25 = f.my_piecewise3(t20, t22, t23 * t19)
  t26 = t6 ** (0.1e1 / 0.3e1)
  t27 = t25 * t26
  t28 = r0 ** (0.1e1 / 0.3e1)
  t29 = t28 ** 2
  t31 = 0.1e1 / t29 / r0
  t32 = tau0 * t31
  t33 = r0 ** 2
  t35 = 0.1e1 / t29 / t33
  t36 = s0 * t35
  t38 = t32 - t36 / 0.8e1
  t39 = 6 ** (0.1e1 / 0.3e1)
  t40 = t38 * t39
  t41 = jnp.pi ** 2
  t42 = t41 ** (0.1e1 / 0.3e1)
  t43 = t42 ** 2
  t44 = 0.1e1 / t43
  t45 = t39 * t44
  t46 = t45 * t36
  t48 = t40 * t44
  t50 = 0.1e1 - 0.5e1 / 0.9e1 * t48
  t51 = t50 ** 2
  t52 = t51 * t50
  t53 = t38 ** 2
  t54 = t39 ** 2
  t57 = 0.1e1 / t42 / t41
  t60 = 0.1e1 + 0.67148919753086419753086419753086419753086419753087e0 * t53 * t54 * t57
  t61 = jnp.sqrt(t60)
  t63 = 0.1e1 / t61 / t60
  t64 = t52 * t63
  t66 = jnp.exp(-t46 / 0.8e1)
  t68 = t46 / 0.24e2 + t64 * t66
  t70 = t44 / t68
  t73 = 0.1e1 + t40 * t70 / 0.3e1
  t74 = t73 ** 2
  t77 = 0.1e1 / t74 / t73
  t79 = 0.1e1 / t74 + 0.3e1 * t77
  t80 = 0.1e1 + t77
  t81 = t80 ** 2
  t82 = 0.1e1 / t81
  t83 = t79 * t82
  t85 = t54 * t57
  t86 = s0 ** 2
  t87 = t33 ** 2
  t90 = 0.1e1 / t28 / t87 / r0
  t94 = 0.1e1 + 0.15045488888888888888888888888888888888888888888889e0 * t46 + 0.26899490462262948000000000000000000000000000000000e-2 * t85 * t86 * t90
  t95 = t94 ** (0.1e1 / 0.5e1)
  t100 = 0.25633760400000000000000000000000000000000000000000e0 * t54 * t43
  t106 = 0.7e1 + 0.44760329444444444444444444444444444444444444444445e0 * t46 - 0.35e2 / 0.9e1 * (0.14554132000000000000000000000000000000000000000000e0 * t32 + t100 + 0.11867481666666666666666666666666666666666666666667e-1 * t36) * t39 * t44
  t107 = t95 ** 2
  t108 = 0.1e1 / t107
  t111 = 0.1e1 / t95 + t106 * t108 / 0.9e1
  t113 = 0.1e1 - t83
  t116 = (0.10e2 / 0.81e2 + 0.25e2 / 0.8748e4 * t46) * t39
  t117 = t44 * s0
  t123 = t48 / 0.4e1 - 0.9e1 / 0.20e2 + t46 / 0.36e2
  t124 = t123 ** 2
  t128 = 0.73e2 / 0.1620e4 * t48 - 0.73e2 / 0.900e3 + 0.73e2 / 0.14580e5 * t46
  t129 = 0.1e1 / r0
  t130 = s0 * t129
  t131 = 0.1e1 / tau0
  t133 = t130 * t131 / 0.8e1
  t134 = t133 < 0.10e1
  t135 = f.my_piecewise3(t134, t133, 0.10e1)
  t136 = t128 * t135
  t137 = 0.1e1 - t135
  t141 = (0.1e1 + 0.5e1 / 0.12e2 * t116 * t117 * t35 + 0.292e3 / 0.405e3 * t124 - 0.6e1 * t136 * t137) ** (0.1e1 / 0.10e2)
  t143 = t83 * t111 + t113 * t141
  t147 = f.my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * t143)
  t148 = r1 <= f.p.dens_threshold
  t149 = f.my_piecewise5(t14, t11, t10, t15, -t17)
  t150 = 0.1e1 + t149
  t151 = t150 <= f.p.zeta_threshold
  t152 = t150 ** (0.1e1 / 0.3e1)
  t154 = f.my_piecewise3(t151, t22, t152 * t150)
  t155 = t154 * t26
  t156 = r1 ** (0.1e1 / 0.3e1)
  t157 = t156 ** 2
  t159 = 0.1e1 / t157 / r1
  t160 = tau1 * t159
  t161 = r1 ** 2
  t163 = 0.1e1 / t157 / t161
  t164 = s2 * t163
  t166 = t160 - t164 / 0.8e1
  t167 = t166 * t39
  t168 = t45 * t164
  t170 = t167 * t44
  t172 = 0.1e1 - 0.5e1 / 0.9e1 * t170
  t173 = t172 ** 2
  t174 = t173 * t172
  t175 = t166 ** 2
  t179 = 0.1e1 + 0.67148919753086419753086419753086419753086419753087e0 * t175 * t54 * t57
  t180 = jnp.sqrt(t179)
  t182 = 0.1e1 / t180 / t179
  t183 = t174 * t182
  t185 = jnp.exp(-t168 / 0.8e1)
  t187 = t168 / 0.24e2 + t183 * t185
  t189 = t44 / t187
  t192 = 0.1e1 + t167 * t189 / 0.3e1
  t193 = t192 ** 2
  t196 = 0.1e1 / t193 / t192
  t198 = 0.1e1 / t193 + 0.3e1 * t196
  t199 = 0.1e1 + t196
  t200 = t199 ** 2
  t201 = 0.1e1 / t200
  t202 = t198 * t201
  t204 = s2 ** 2
  t205 = t161 ** 2
  t208 = 0.1e1 / t156 / t205 / r1
  t212 = 0.1e1 + 0.15045488888888888888888888888888888888888888888889e0 * t168 + 0.26899490462262948000000000000000000000000000000000e-2 * t85 * t204 * t208
  t213 = t212 ** (0.1e1 / 0.5e1)
  t222 = 0.7e1 + 0.44760329444444444444444444444444444444444444444445e0 * t168 - 0.35e2 / 0.9e1 * (0.14554132000000000000000000000000000000000000000000e0 * t160 + t100 + 0.11867481666666666666666666666666666666666666666667e-1 * t164) * t39 * t44
  t223 = t213 ** 2
  t224 = 0.1e1 / t223
  t227 = 0.1e1 / t213 + t222 * t224 / 0.9e1
  t229 = 0.1e1 - t202
  t232 = (0.10e2 / 0.81e2 + 0.25e2 / 0.8748e4 * t168) * t39
  t233 = t44 * s2
  t239 = t170 / 0.4e1 - 0.9e1 / 0.20e2 + t168 / 0.36e2
  t240 = t239 ** 2
  t244 = 0.73e2 / 0.1620e4 * t170 - 0.73e2 / 0.900e3 + 0.73e2 / 0.14580e5 * t168
  t245 = 0.1e1 / r1
  t246 = s2 * t245
  t247 = 0.1e1 / tau1
  t249 = t246 * t247 / 0.8e1
  t250 = t249 < 0.10e1
  t251 = f.my_piecewise3(t250, t249, 0.10e1)
  t252 = t244 * t251
  t253 = 0.1e1 - t251
  t257 = (0.1e1 + 0.5e1 / 0.12e2 * t232 * t233 * t163 + 0.292e3 / 0.405e3 * t240 - 0.6e1 * t252 * t253) ** (0.1e1 / 0.10e2)
  t259 = t202 * t227 + t229 * t257
  t263 = f.my_piecewise3(t148, 0, -0.3e1 / 0.8e1 * t5 * t155 * t259)
  t264 = t6 ** 2
  t266 = t16 / t264
  t267 = t7 - t266
  t268 = f.my_piecewise5(t10, 0, t14, 0, t267)
  t271 = f.my_piecewise3(t20, 0, 0.4e1 / 0.3e1 * t23 * t268)
  t276 = t26 ** 2
  t277 = 0.1e1 / t276
  t281 = t5 * t25 * t277 * t143 / 0.8e1
  t282 = tau0 * t35
  t286 = 0.1e1 / t29 / t33 / r0
  t287 = s0 * t286
  t289 = -0.5e1 / 0.3e1 * t282 + t287 / 0.3e1
  t290 = t289 * t39
  t292 = t68 ** 2
  t294 = t44 / t292
  t295 = t45 * t287
  t298 = t51 * t63 * t66
  t299 = t290 * t44
  t302 = t60 ** 2
  t306 = t52 / t61 / t302 * t66
  t307 = t38 * t54
  t321 = t290 * t70 / 0.3e1 - t40 * t294 * (-t295 / 0.9e1 - 0.5e1 / 0.3e1 * t298 * t299 - 0.20144675925925925925925925925925925925925925925926e1 * t306 * t307 * t57 * t289 + t64 * t39 * t117 * t286 * t66 / 0.3e1) / 0.3e1
  t324 = t74 ** 2
  t325 = 0.1e1 / t324
  t326 = t325 * t321
  t329 = (-0.2e1 * t77 * t321 - 0.9e1 * t326) * t82
  t333 = t79 / t81 / t80
  t334 = t111 * t325
  t339 = 0.1e1 / t95 / t94
  t345 = t85 * t86 / t28 / t87 / t33
  t347 = -0.40121303703703703703703703703703703703703703703704e0 * t295 - 0.14346394913206905600000000000000000000000000000000e-1 * t345
  t362 = t106 / t107 / t94
  t371 = t141 ** 2
  t372 = t371 ** 2
  t373 = t372 ** 2
  t376 = t113 / t373 / t141
  t396 = f.my_piecewise3(t134, -s0 / t33 * t131 / 0.8e1, 0)
  t410 = f.my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t271 * t26 * t143 - t281 - 0.3e1 / 0.8e1 * t5 * t27 * (t329 * t111 + 0.6e1 * t333 * t334 * t321 + t83 * (-t339 * t347 / 0.5e1 + (-0.11936087851851851851851851851851851851851851851852e1 * t295 - 0.35e2 / 0.9e1 * (-0.24256886666666666666666666666666666666666666666667e0 * t282 - 0.31646617777777777777777777777777777777777777777779e-1 * t287) * t39 * t44) * t108 / 0.9e1 - 0.2e1 / 0.45e2 * t362 * t347) + (-0.6e1 * t333 * t326 - t329) * t141 + t376 * (-0.125e3 / 0.39366e5 * t345 - 0.10e2 / 0.9e1 * t116 * t117 * t286 + 0.584e3 / 0.405e3 * t123 * (t299 / 0.4e1 - 0.2e1 / 0.27e2 * t295) - 0.6e1 * (0.73e2 / 0.1620e4 * t299 - 0.146e3 / 0.10935e5 * t295) * t135 * t137 - 0.6e1 * t128 * t396 * t137 + 0.6e1 * t136 * t396) / 0.10e2))
  t412 = f.my_piecewise5(t14, 0, t10, 0, -t267)
  t415 = f.my_piecewise3(t151, 0, 0.4e1 / 0.3e1 * t152 * t412)
  t423 = t5 * t154 * t277 * t259 / 0.8e1
  t425 = f.my_piecewise3(t148, 0, -0.3e1 / 0.8e1 * t5 * t415 * t26 * t259 - t423)
  vrho_0_ = t147 + t263 + t6 * (t410 + t425)
  t428 = -t7 - t266
  t429 = f.my_piecewise5(t10, 0, t14, 0, t428)
  t432 = f.my_piecewise3(t20, 0, 0.4e1 / 0.3e1 * t23 * t429)
  t438 = f.my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t432 * t26 * t143 - t281)
  t440 = f.my_piecewise5(t14, 0, t10, 0, -t428)
  t443 = f.my_piecewise3(t151, 0, 0.4e1 / 0.3e1 * t152 * t440)
  t448 = tau1 * t163
  t452 = 0.1e1 / t157 / t161 / r1
  t453 = s2 * t452
  t455 = -0.5e1 / 0.3e1 * t448 + t453 / 0.3e1
  t456 = t455 * t39
  t458 = t187 ** 2
  t460 = t44 / t458
  t461 = t45 * t453
  t464 = t173 * t182 * t185
  t465 = t456 * t44
  t468 = t179 ** 2
  t472 = t174 / t180 / t468 * t185
  t473 = t166 * t54
  t487 = t456 * t189 / 0.3e1 - t167 * t460 * (-t461 / 0.9e1 - 0.5e1 / 0.3e1 * t464 * t465 - 0.20144675925925925925925925925925925925925925925926e1 * t472 * t473 * t57 * t455 + t183 * t39 * t233 * t452 * t185 / 0.3e1) / 0.3e1
  t490 = t193 ** 2
  t491 = 0.1e1 / t490
  t492 = t491 * t487
  t495 = (-0.2e1 * t196 * t487 - 0.9e1 * t492) * t201
  t499 = t198 / t200 / t199
  t500 = t227 * t491
  t505 = 0.1e1 / t213 / t212
  t511 = t85 * t204 / t156 / t205 / t161
  t513 = -0.40121303703703703703703703703703703703703703703704e0 * t461 - 0.14346394913206905600000000000000000000000000000000e-1 * t511
  t528 = t222 / t223 / t212
  t537 = t257 ** 2
  t538 = t537 ** 2
  t539 = t538 ** 2
  t542 = t229 / t539 / t257
  t562 = f.my_piecewise3(t250, -s2 / t161 * t247 / 0.8e1, 0)
  t576 = f.my_piecewise3(t148, 0, -0.3e1 / 0.8e1 * t5 * t443 * t26 * t259 - t423 - 0.3e1 / 0.8e1 * t5 * t155 * (t495 * t227 + 0.6e1 * t499 * t500 * t487 + t202 * (-t505 * t513 / 0.5e1 + (-0.11936087851851851851851851851851851851851851851852e1 * t461 - 0.35e2 / 0.9e1 * (-0.24256886666666666666666666666666666666666666666667e0 * t448 - 0.31646617777777777777777777777777777777777777777779e-1 * t453) * t39 * t44) * t224 / 0.9e1 - 0.2e1 / 0.45e2 * t528 * t513) + (-0.6e1 * t499 * t492 - t495) * t257 + t542 * (-0.125e3 / 0.39366e5 * t511 - 0.10e2 / 0.9e1 * t232 * t233 * t452 + 0.584e3 / 0.405e3 * t239 * (t465 / 0.4e1 - 0.2e1 / 0.27e2 * t461) - 0.6e1 * (0.73e2 / 0.1620e4 * t465 - 0.146e3 / 0.10935e5 * t461) * t251 * t253 - 0.6e1 * t244 * t562 * t253 + 0.6e1 * t252 * t562) / 0.10e2))
  vrho_1_ = t147 + t263 + t6 * (t438 + t576)
  t579 = t35 * t39
  t582 = t579 * t44
  t598 = -t579 * t70 / 0.24e2 - t40 * t294 * (t582 / 0.24e2 + 0.5e1 / 0.24e2 * t298 * t582 + 0.25180844907407407407407407407407407407407407407408e0 * t306 * t307 * t57 * t35 - t64 * t35 * t45 * t66 / 0.8e1) / 0.3e1
  t601 = t325 * t598
  t604 = (-0.2e1 * t77 * t598 - 0.9e1 * t601) * t82
  t611 = t85 * s0 * t90
  t613 = 0.15045488888888888888888888888888888888888888888889e0 * t582 + 0.53798980924525896000000000000000000000000000000000e-2 * t611
  t635 = t44 * t135 * t137
  t640 = f.my_piecewise3(t134, t129 * t131 / 0.8e1, 0)
  t653 = f.my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * (t604 * t111 + 0.6e1 * t333 * t334 * t598 + t83 * (-t339 * t613 / 0.5e1 + 0.44605775205761316872427983539094650205761316872429e-1 * t579 * t44 * t108 - 0.2e1 / 0.45e2 * t362 * t613) + (-0.6e1 * t333 * t601 - t604) * t141 + t376 * (0.125e3 / 0.104976e6 * t611 + 0.5e1 / 0.12e2 * t116 * t44 * t35 - 0.73e2 / 0.14580e5 * t123 * t35 * t45 + 0.73e2 / 0.19440e5 * t579 * t635 - 0.6e1 * t128 * t640 * t137 + 0.6e1 * t136 * t640) / 0.10e2))
  vsigma_0_ = t6 * t653
  vsigma_1_ = 0.0e0
  t654 = t163 * t39
  t657 = t654 * t44
  t673 = -t654 * t189 / 0.24e2 - t167 * t460 * (t657 / 0.24e2 + 0.5e1 / 0.24e2 * t464 * t657 + 0.25180844907407407407407407407407407407407407407408e0 * t472 * t473 * t57 * t163 - t183 * t163 * t45 * t185 / 0.8e1) / 0.3e1
  t676 = t491 * t673
  t679 = (-0.2e1 * t196 * t673 - 0.9e1 * t676) * t201
  t686 = t85 * s2 * t208
  t688 = 0.15045488888888888888888888888888888888888888888889e0 * t657 + 0.53798980924525896000000000000000000000000000000000e-2 * t686
  t710 = t44 * t251 * t253
  t715 = f.my_piecewise3(t250, t245 * t247 / 0.8e1, 0)
  t728 = f.my_piecewise3(t148, 0, -0.3e1 / 0.8e1 * t5 * t155 * (t679 * t227 + 0.6e1 * t499 * t500 * t673 + t202 * (-t505 * t688 / 0.5e1 + 0.44605775205761316872427983539094650205761316872429e-1 * t654 * t44 * t224 - 0.2e1 / 0.45e2 * t528 * t688) + (-0.6e1 * t499 * t676 - t679) * t257 + t542 * (0.125e3 / 0.104976e6 * t686 + 0.5e1 / 0.12e2 * t232 * t44 * t163 - 0.73e2 / 0.14580e5 * t239 * t163 * t45 + 0.73e2 / 0.19440e5 * t654 * t710 - 0.6e1 * t244 * t715 * t253 + 0.6e1 * t252 * t715) / 0.10e2))
  vsigma_2_ = t6 * t728
  vlapl_0_ = 0.0e0
  vlapl_1_ = 0.0e0
  t729 = t31 * t39
  t742 = t729 * t70 / 0.3e1 - t40 * t294 * (-0.5e1 / 0.3e1 * t298 * t729 * t44 - 0.20144675925925925925925925925925925925925925925926e1 * t306 * t307 * t57 * t31) / 0.3e1
  t745 = t325 * t742
  t748 = (-0.2e1 * t77 * t742 - 0.9e1 * t745) * t82
  t766 = tau0 ** 2
  t770 = f.my_piecewise3(t134, -t130 / t766 / 0.8e1, 0)
  t783 = f.my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t27 * (t748 * t111 + 0.6e1 * t333 * t334 * t742 - 0.62888224691358024691358024691358024691358024691358e-1 * t83 * t31 * t45 * t108 + (-0.6e1 * t333 * t745 - t748) * t141 + t376 * (0.146e3 / 0.405e3 * t123 * t31 * t45 - 0.73e2 / 0.270e3 * t729 * t635 - 0.6e1 * t128 * t770 * t137 + 0.6e1 * t136 * t770) / 0.10e2))
  vtau_0_ = t6 * t783
  t784 = t159 * t39
  t797 = t784 * t189 / 0.3e1 - t167 * t460 * (-0.5e1 / 0.3e1 * t464 * t784 * t44 - 0.20144675925925925925925925925925925925925925925926e1 * t472 * t473 * t57 * t159) / 0.3e1
  t800 = t491 * t797
  t803 = (-0.2e1 * t196 * t797 - 0.9e1 * t800) * t201
  t821 = tau1 ** 2
  t825 = f.my_piecewise3(t250, -t246 / t821 / 0.8e1, 0)
  t838 = f.my_piecewise3(t148, 0, -0.3e1 / 0.8e1 * t5 * t155 * (t803 * t227 + 0.6e1 * t499 * t500 * t797 - 0.62888224691358024691358024691358024691358024691358e-1 * t202 * t159 * t45 * t224 + (-0.6e1 * t499 * t800 - t803) * t257 + t542 * (0.146e3 / 0.405e3 * t239 * t159 * t45 - 0.73e2 / 0.270e3 * t784 * t710 - 0.6e1 * t244 * t825 * t253 + 0.6e1 * t252 * t825) / 0.10e2))
  vtau_1_ = t6 * t838
  _b = lambda x: (jnp.asarray(x) + jnp.zeros_like(r0))
  vrho_0_ = _b(vrho_0_)
  vrho_1_ = _b(vrho_1_)
  vsigma_0_ = _b(vsigma_0_)
  vsigma_1_ = _b(vsigma_1_)
  vsigma_2_ = _b(vsigma_2_)
  vlapl_0_ = _b(vlapl_0_)
  vlapl_1_ = _b(vlapl_1_)
  vtau_0_ = _b(vtau_0_)
  vtau_1_ = _b(vtau_1_)
  res = {'vrho': jnp.stack([vrho_0_, vrho_1_], axis=-1), 'vsigma': jnp.stack([vsigma_0_, vsigma_1_, vsigma_2_], axis=-1), 'vlapl': jnp.stack([vlapl_0_, vlapl_1_], axis=-1), 'vtau':  jnp.stack([vtau_0_, vtau_1_], axis=-1)}
  return res

def unpol_vxc(p, r, s=None, l=None, tau=None):
  f = funcs(p)
  params = f.params
  r0, s0, l0, tau0 = r, s, l, tau
  tm_lambda = 0.6866

  tm_beta = 79.873

  tm_p = lambda x: (X2S * x) ** 2

  tm_alpha = lambda x, t: (t - x ** 2 / 8) / K_FACTOR_C

  tm_tratio = lambda x, t: jnp.minimum(1.0, x ** 2 / (8 * t))

  reg_c = 3

  reg_d = 1.475

  regtm_w = lambda zp: (zp ** 2 + 3 * zp ** 3) / (1 + zp ** 3) ** 2

  tm_y = lambda x: (2 * tm_lambda - 1) ** 2 * tm_p(x)

  tm_R = lambda x, t: 1 + 595 * (2 * tm_lambda - 1) ** 2 * tm_p(x) / 54 - (t - 3 * (tm_lambda ** 2 - tm_lambda + 1 / 2) * (t - K_FACTOR_C - x ** 2 / 72)) / K_FACTOR_C

  tm_qtilde = lambda x, t: 9 / 20 * (tm_alpha(x, t) - 1) + 2 * tm_p(x) / 3

  regtm_f = lambda a, p: (1 - a) ** 3 / (1 + (reg_d * a) ** 2) ** (3 / 2) * jnp.exp(-reg_c * p)

  tm_f0 = lambda x: (1 + 10 * (70 * tm_y(x) / 27) + tm_beta * tm_y(x) ** 2) ** (1 / 10)

  tm_fx_SC = lambda x, t: (1 + 10 * (+(MU_GE + 50 * tm_p(x) / 729) * tm_p(x) + 146 * tm_qtilde(x, t) ** 2 / 2025 - 73 * tm_qtilde(x, t) / 405 * (3 / 5 * tm_tratio(x, t)) * (1 - tm_tratio(x, t)))) ** (1 / 10)

  regtm_zp = lambda a, p: 1 / (1 + 3 / 5 * (a / (p + regtm_f(a, p))))

  tm_fx_DME = lambda x, t: 1 / tm_f0(x) ** 2 + 7 * tm_R(x, t) / (9 * tm_f0(x) ** 4)

  tm_w = lambda x, t: regtm_w(regtm_zp(tm_alpha(x, t), tm_p(x)))

  tm_f = lambda x, u, t: tm_w(x, t) * tm_fx_DME(x, t) + (1 - tm_w(x, t)) * tm_fx_SC(x, t)

  functional_body = lambda rs, z, xt, xs0, xs1, u0, u1, t0, t1: mgga_exchange(f, params, tm_f, rs, z, xs0, xs1, u0, u1, t0, t1)

  t2 = r0 / 0.2e1 <= f.p.dens_threshold
  t3 = 3 ** (0.1e1 / 0.3e1)
  t4 = jnp.pi ** (0.1e1 / 0.3e1)
  t6 = t3 / t4
  t7 = 0.1e1 <= f.p.zeta_threshold
  t8 = f.p.zeta_threshold - 0.1e1
  t10 = f.my_piecewise5(t7, t8, t7, -t8, 0)
  t11 = 0.1e1 + t10
  t13 = f.p.zeta_threshold ** (0.1e1 / 0.3e1)
  t15 = t11 ** (0.1e1 / 0.3e1)
  t17 = f.my_piecewise3(t11 <= f.p.zeta_threshold, t13 * f.p.zeta_threshold, t15 * t11)
  t18 = r0 ** (0.1e1 / 0.3e1)
  t19 = t17 * t18
  t20 = 2 ** (0.1e1 / 0.3e1)
  t21 = t20 ** 2
  t22 = tau0 * t21
  t23 = t18 ** 2
  t25 = 0.1e1 / t23 / r0
  t26 = t22 * t25
  t27 = s0 * t21
  t28 = r0 ** 2
  t30 = 0.1e1 / t23 / t28
  t31 = t27 * t30
  t33 = t26 - t31 / 0.8e1
  t34 = 6 ** (0.1e1 / 0.3e1)
  t35 = t33 * t34
  t36 = jnp.pi ** 2
  t37 = t36 ** (0.1e1 / 0.3e1)
  t38 = t37 ** 2
  t39 = 0.1e1 / t38
  t40 = t34 * t39
  t41 = t40 * t31
  t43 = t35 * t39
  t45 = 0.1e1 - 0.5e1 / 0.9e1 * t43
  t46 = t45 ** 2
  t47 = t46 * t45
  t48 = t33 ** 2
  t49 = t34 ** 2
  t52 = 0.1e1 / t37 / t36
  t55 = 0.1e1 + 0.67148919753086419753086419753086419753086419753087e0 * t48 * t49 * t52
  t56 = jnp.sqrt(t55)
  t58 = 0.1e1 / t56 / t55
  t59 = t47 * t58
  t61 = jnp.exp(-t41 / 0.8e1)
  t63 = t41 / 0.24e2 + t59 * t61
  t64 = 0.1e1 / t63
  t65 = t39 * t64
  t68 = 0.1e1 + t35 * t65 / 0.3e1
  t69 = t68 ** 2
  t72 = 0.1e1 / t69 / t68
  t74 = 0.1e1 / t69 + 0.3e1 * t72
  t75 = 0.1e1 + t72
  t76 = t75 ** 2
  t77 = 0.1e1 / t76
  t78 = t74 * t77
  t80 = t49 * t52
  t81 = s0 ** 2
  t82 = t81 * t20
  t83 = t28 ** 2
  t86 = 0.1e1 / t18 / t83 / r0
  t90 = 0.1e1 + 0.15045488888888888888888888888888888888888888888889e0 * t41 + 0.53798980924525896000000000000000000000000000000000e-2 * t80 * t82 * t86
  t91 = t90 ** (0.1e1 / 0.5e1)
  t102 = 0.7e1 + 0.44760329444444444444444444444444444444444444444445e0 * t41 - 0.35e2 / 0.9e1 * (0.14554132000000000000000000000000000000000000000000e0 * t26 + 0.25633760400000000000000000000000000000000000000000e0 * t49 * t38 + 0.11867481666666666666666666666666666666666666666667e-1 * t31) * t34 * t39
  t103 = t91 ** 2
  t104 = 0.1e1 / t103
  t107 = 0.1e1 / t91 + t102 * t104 / 0.9e1
  t109 = 0.1e1 - t78
  t112 = (0.10e2 / 0.81e2 + 0.25e2 / 0.8748e4 * t41) * t34
  t113 = t112 * t39
  t118 = t43 / 0.4e1 - 0.9e1 / 0.20e2 + t41 / 0.36e2
  t119 = t118 ** 2
  t123 = 0.73e2 / 0.1620e4 * t43 - 0.73e2 / 0.900e3 + 0.73e2 / 0.14580e5 * t41
  t124 = 0.1e1 / r0
  t125 = s0 * t124
  t126 = 0.1e1 / tau0
  t128 = t125 * t126 / 0.8e1
  t129 = t128 < 0.10e1
  t130 = f.my_piecewise3(t129, t128, 0.10e1)
  t131 = t123 * t130
  t132 = 0.1e1 - t130
  t136 = (0.1e1 + 0.5e1 / 0.12e2 * t113 * t31 + 0.292e3 / 0.405e3 * t119 - 0.6e1 * t131 * t132) ** (0.1e1 / 0.10e2)
  t138 = t78 * t107 + t109 * t136
  t142 = f.my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * t138)
  t148 = t22 * t30
  t152 = 0.1e1 / t23 / t28 / r0
  t153 = t27 * t152
  t155 = -0.5e1 / 0.3e1 * t148 + t153 / 0.3e1
  t156 = t155 * t34
  t158 = t63 ** 2
  t160 = t39 / t158
  t161 = t40 * t153
  t164 = t46 * t58 * t61
  t165 = t156 * t39
  t168 = t55 ** 2
  t171 = t47 / t56 / t168
  t187 = t156 * t65 / 0.3e1 - t35 * t160 * (-t161 / 0.9e1 - 0.5e1 / 0.3e1 * t164 * t165 - 0.20144675925925925925925925925925925925925925925926e1 * t171 * t61 * t33 * t49 * t52 * t155 + t59 * t40 * t27 * t152 * t61 / 0.3e1) / 0.3e1
  t190 = t69 ** 2
  t191 = 0.1e1 / t190
  t192 = t191 * t187
  t195 = (-0.2e1 * t72 * t187 - 0.9e1 * t192) * t77
  t199 = t74 / t76 / t75
  t200 = t107 * t191
  t205 = 0.1e1 / t91 / t90
  t211 = t80 * t82 / t18 / t83 / t28
  t213 = -0.40121303703703703703703703703703703703703703703704e0 * t161 - 0.28692789826413811200000000000000000000000000000000e-1 * t211
  t228 = t102 / t103 / t90
  t237 = t136 ** 2
  t238 = t237 ** 2
  t239 = t238 ** 2
  t242 = t109 / t239 / t136
  t261 = f.my_piecewise3(t129, -s0 / t28 * t126 / 0.8e1, 0)
  t275 = f.my_piecewise3(t2, 0, -t6 * t17 / t23 * t138 / 0.8e1 - 0.3e1 / 0.8e1 * t6 * t19 * (t195 * t107 + 0.6e1 * t199 * t200 * t187 + t78 * (-t205 * t213 / 0.5e1 + (-0.11936087851851851851851851851851851851851851851852e1 * t161 - 0.35e2 / 0.9e1 * (-0.24256886666666666666666666666666666666666666666667e0 * t148 - 0.31646617777777777777777777777777777777777777777779e-1 * t153) * t34 * t39) * t104 / 0.9e1 - 0.2e1 / 0.45e2 * t228 * t213) + (-0.6e1 * t199 * t192 - t195) * t136 + t242 * (-0.125e3 / 0.19683e5 * t211 - 0.10e2 / 0.9e1 * t113 * t153 + 0.584e3 / 0.405e3 * t118 * (t165 / 0.4e1 - 0.2e1 / 0.27e2 * t161) - 0.6e1 * (0.73e2 / 0.1620e4 * t165 - 0.146e3 / 0.10935e5 * t161) * t130 * t132 - 0.6e1 * t123 * t261 * t132 + 0.6e1 * t131 * t261) / 0.10e2))
  vrho_0_ = 0.2e1 * r0 * t275 + 0.2e1 * t142
  t278 = t21 * t30
  t279 = t40 * t64
  t282 = t278 * t40
  t287 = t171 * t61 * t33
  t292 = t30 * t34
  t301 = -t278 * t279 / 0.24e2 - t35 * t160 * (t282 / 0.24e2 + 0.5e1 / 0.24e2 * t164 * t282 + 0.25180844907407407407407407407407407407407407407408e0 * t287 * t80 * t278 - t59 * t21 * t292 * t39 * t61 / 0.8e1) / 0.3e1
  t304 = t191 * t301
  t307 = (-0.2e1 * t72 * t301 - 0.9e1 * t304) * t77
  t315 = t80 * s0 * t20 * t86
  t317 = 0.15045488888888888888888888888888888888888888888889e0 * t282 + 0.10759796184905179200000000000000000000000000000000e-1 * t315
  t336 = t118 * t21
  t342 = t39 * t130 * t132
  t347 = f.my_piecewise3(t129, t124 * t126 / 0.8e1, 0)
  t360 = f.my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * (t307 * t107 + 0.6e1 * t199 * t200 * t301 + t78 * (-t205 * t317 / 0.5e1 + 0.44605775205761316872427983539094650205761316872429e-1 * t278 * t40 * t104 - 0.2e1 / 0.45e2 * t228 * t317) + (-0.6e1 * t199 * t304 - t307) * t136 + t242 * (0.125e3 / 0.52488e5 * t315 + 0.5e1 / 0.12e2 * t112 * t39 * t21 * t30 - 0.73e2 / 0.14580e5 * t336 * t292 * t39 + 0.73e2 / 0.19440e5 * t278 * t34 * t342 - 0.6e1 * t123 * t347 * t132 + 0.6e1 * t131 * t347) / 0.10e2))
  vsigma_0_ = 0.2e1 * r0 * t360
  vlapl_0_ = 0.0e0
  t362 = t21 * t25
  t374 = t362 * t279 / 0.3e1 - t35 * t160 * (-0.5e1 / 0.3e1 * t164 * t362 * t40 - 0.20144675925925925925925925925925925925925925925926e1 * t287 * t80 * t362) / 0.3e1
  t377 = t191 * t374
  t380 = (-0.2e1 * t72 * t374 - 0.9e1 * t377) * t77
  t386 = t25 * t34
  t401 = tau0 ** 2
  t405 = f.my_piecewise3(t129, -t125 / t401 / 0.8e1, 0)
  t418 = f.my_piecewise3(t2, 0, -0.3e1 / 0.8e1 * t6 * t19 * (t380 * t107 + 0.6e1 * t199 * t200 * t374 - 0.62888224691358024691358024691358024691358024691358e-1 * t78 * t21 * t386 * t39 * t104 + (-0.6e1 * t199 * t377 - t380) * t136 + t242 * (0.146e3 / 0.405e3 * t336 * t386 * t39 - 0.73e2 / 0.270e3 * t362 * t34 * t342 - 0.6e1 * t123 * t405 * t132 + 0.6e1 * t131 * t405) / 0.10e2))
  vtau_0_ = 0.2e1 * r0 * t418
  _b = lambda x: (jnp.asarray(x) + jnp.zeros_like(r0))
  vrho_0_ = _b(vrho_0_)
  vsigma_0_ = _b(vsigma_0_)
  vlapl_0_ = _b(vlapl_0_)
  vtau_0_ = _b(vtau_0_)
  res = {'vrho': vrho_0_, 'vsigma': vsigma_0_, 'vlapl': vlapl_0_, 'vtau':  vtau_0_}
  return res

def unpol_fxc(p, r, s=None, l=None, tau=None):
  f = funcs(p)
  params = f.params
  r0, s0, l0, tau0 = r, s, l, tau
  
  t2 = r0 / 0.2e1 <= f.p.dens_threshold
  t3 = 3 ** (0.1e1 / 0.3e1)
  t4 = jnp.pi ** (0.1e1 / 0.3e1)
  t6 = t3 / t4
  t7 = 0.1e1 <= f.p.zeta_threshold
  t8 = f.p.zeta_threshold - 0.1e1
  t10 = f.my_piecewise5(t7, t8, t7, -t8, 0)
  t11 = 0.1e1 + t10
  t13 = f.p.zeta_threshold ** (0.1e1 / 0.3e1)
  t15 = t11 ** (0.1e1 / 0.3e1)
  t17 = f.my_piecewise3(t11 <= f.p.zeta_threshold, t13 * f.p.zeta_threshold, t15 * t11)
  t18 = r0 ** (0.1e1 / 0.3e1)
  t19 = t18 ** 2
  t21 = t17 / t19
  t22 = 2 ** (0.1e1 / 0.3e1)
  t23 = t22 ** 2
  t24 = tau0 * t23
  t26 = 0.1e1 / t19 / r0
  t27 = t24 * t26
  t28 = s0 * t23
  t29 = r0 ** 2
  t31 = 0.1e1 / t19 / t29
  t32 = t28 * t31
  t34 = t27 - t32 / 0.8e1
  t35 = 6 ** (0.1e1 / 0.3e1)
  t36 = t34 * t35
  t37 = jnp.pi ** 2
  t38 = t37 ** (0.1e1 / 0.3e1)
  t39 = t38 ** 2
  t40 = 0.1e1 / t39
  t41 = t35 * t40
  t42 = t41 * t32
  t44 = t36 * t40
  t46 = 0.1e1 - 0.5e1 / 0.9e1 * t44
  t47 = t46 ** 2
  t48 = t47 * t46
  t49 = t34 ** 2
  t50 = t35 ** 2
  t53 = 0.1e1 / t38 / t37
  t56 = 0.1e1 + 0.67148919753086419753086419753086419753086419753086e0 * t49 * t50 * t53
  t57 = jnp.sqrt(t56)
  t59 = 0.1e1 / t57 / t56
  t60 = t48 * t59
  t62 = jnp.exp(-t42 / 0.8e1)
  t64 = t42 / 0.24e2 + t60 * t62
  t66 = t40 / t64
  t69 = 0.1e1 + t36 * t66 / 0.3e1
  t70 = t69 ** 2
  t73 = 0.1e1 / t70 / t69
  t75 = 0.1e1 / t70 + 0.3e1 * t73
  t76 = 0.1e1 + t73
  t77 = t76 ** 2
  t78 = 0.1e1 / t77
  t79 = t75 * t78
  t81 = t50 * t53
  t82 = s0 ** 2
  t83 = t82 * t22
  t84 = t29 ** 2
  t91 = 0.1e1 + 0.15045488888888888888888888888888888888888888888889e0 * t42 + 0.53798980924525896000000000000000000000000000000000e-2 * t81 * t83 / t18 / t84 / r0
  t92 = t91 ** (0.1e1 / 0.5e1)
  t103 = 0.1e1 + 0.63943327777777777777777777777777777777777777777778e-1 * t42 - 0.5e1 / 0.9e1 * (0.14554132000000000000000000000000000000000000000000e0 * t27 + 0.25633760400000000000000000000000000000000000000000e0 * t50 * t39 + 0.11867481666666666666666666666666666666666666666667e-1 * t32) * t35 * t40
  t104 = t92 ** 2
  t105 = 0.1e1 / t104
  t108 = 0.1e1 / t92 + 0.7e1 / 0.9e1 * t103 * t105
  t110 = 0.1e1 - t79
  t114 = (0.10e2 / 0.81e2 + 0.25e2 / 0.8748e4 * t42) * t35 * t40
  t119 = t44 / 0.4e1 - 0.9e1 / 0.20e2 + t42 / 0.36e2
  t120 = t119 ** 2
  t124 = 0.1e1 / tau0
  t126 = s0 / r0 * t124 / 0.8e1
  t127 = t126 < 0.10e1
  t128 = f.my_piecewise3(t127, t126, 0.10e1)
  t129 = t119 * t128
  t130 = 0.1e1 - t128
  t133 = 0.1e1 + 0.5e1 / 0.12e2 * t114 * t32 + 0.292e3 / 0.405e3 * t120 - 0.146e3 / 0.135e3 * t129 * t130
  t134 = t133 ** (0.1e1 / 0.10e2)
  t136 = t79 * t108 + t110 * t134
  t140 = t17 * t18
  t141 = t24 * t31
  t143 = t29 * r0
  t145 = 0.1e1 / t19 / t143
  t146 = t28 * t145
  t148 = -0.5e1 / 0.3e1 * t141 + t146 / 0.3e1
  t149 = t148 * t35
  t151 = t64 ** 2
  t153 = t40 / t151
  t154 = t41 * t146
  t156 = t47 * t59
  t157 = t156 * t62
  t158 = t149 * t40
  t161 = t56 ** 2
  t163 = 0.1e1 / t57 / t161
  t164 = t48 * t163
  t165 = t164 * t62
  t166 = t34 * t50
  t171 = t60 * t41
  t172 = t145 * t62
  t176 = -t154 / 0.9e1 - 0.5e1 / 0.3e1 * t157 * t158 - 0.20144675925925925925925925925925925925925925925926e1 * t165 * t166 * t53 * t148 + t171 * t28 * t172 / 0.3e1
  t177 = t153 * t176
  t180 = t149 * t66 / 0.3e1 - t36 * t177 / 0.3e1
  t183 = t70 ** 2
  t184 = 0.1e1 / t183
  t185 = t184 * t180
  t187 = -0.2e1 * t73 * t180 - 0.9e1 * t185
  t188 = t187 * t78
  t191 = 0.1e1 / t77 / t76
  t192 = t75 * t191
  t193 = t108 * t184
  t194 = t193 * t180
  t198 = 0.1e1 / t92 / t91
  t204 = t81 * t83 / t18 / t84 / t29
  t206 = -0.40121303703703703703703703703703703703703703703704e0 * t154 - 0.28692789826413811200000000000000000000000000000000e-1 * t204
  t216 = -0.17051554074074074074074074074074074074074074074074e0 * t154 - 0.5e1 / 0.9e1 * (-0.24256886666666666666666666666666666666666666666667e0 * t141 - 0.31646617777777777777777777777777777777777777777779e-1 * t146) * t35 * t40
  t220 = 0.1e1 / t104 / t91
  t221 = t103 * t220
  t224 = -t198 * t206 / 0.5e1 + 0.7e1 / 0.9e1 * t216 * t105 - 0.14e2 / 0.45e2 * t221 * t206
  t228 = -0.6e1 * t192 * t185 - t188
  t230 = t134 ** 2
  t231 = t230 ** 2
  t232 = t231 ** 2
  t233 = t232 * t134
  t234 = 0.1e1 / t233
  t235 = t110 * t234
  t241 = t158 / 0.4e1 - 0.2e1 / 0.27e2 * t154
  t244 = t241 * t128
  t251 = f.my_piecewise3(t127, -s0 / t29 * t124 / 0.8e1, 0)
  t257 = -0.125e3 / 0.19683e5 * t204 - 0.10e2 / 0.9e1 * t114 * t146 + 0.584e3 / 0.405e3 * t119 * t241 - 0.146e3 / 0.135e3 * t244 * t130 - 0.146e3 / 0.135e3 * t119 * t251 * t130 + 0.146e3 / 0.135e3 * t129 * t251
  t260 = t188 * t108 + 0.6e1 * t192 * t194 + t79 * t224 + t228 * t134 + t235 * t257 / 0.10e2
  t265 = f.my_piecewise3(t2, 0, -t6 * t21 * t136 / 0.8e1 - 0.3e1 / 0.8e1 * t6 * t140 * t260)
  t274 = t180 ** 2
  t277 = t24 * t145
  t280 = 0.1e1 / t19 / t84
  t281 = t28 * t280
  t283 = 0.40e2 / 0.9e1 * t277 - 0.11e2 / 0.9e1 * t281
  t284 = t283 * t35
  t292 = t176 ** 2
  t296 = t41 * t281
  t300 = t148 ** 2
  t302 = t300 * t50 * t53
  t307 = t37 ** 2
  t308 = 0.1e1 / t307
  t318 = t284 * t40
  t354 = 0.1e1 / t18 / t84 / t143
  t359 = 0.11e2 / 0.27e2 * t296 + 0.50e2 / 0.27e2 * t46 * t59 * t62 * t302 + 0.40289351851851851851851851851851851851851851851851e2 * t47 * t163 * t62 * t300 * t308 * t34 - 0.10e2 / 0.9e1 * t156 * t81 * t28 * t172 * t148 - 0.5e1 / 0.3e1 * t157 * t318 + 0.40580796816057956104252400548696844993141289437586e2 * t48 / t57 / t161 / t56 * t62 * t49 * t35 / t39 / t307 * t300 - 0.80578703703703703703703703703703703703703703703702e1 * t164 * t308 * s0 * t23 * t145 * t62 * t34 * t148 - 0.20144675925925925925925925925925925925925925925926e1 * t165 * t302 - 0.20144675925925925925925925925925925925925925925926e1 * t165 * t166 * t53 * t283 - 0.11e2 / 0.9e1 * t171 * t28 * t280 * t62 + 0.2e1 / 0.9e1 * t60 * t81 * t83 * t354 * t62
  t363 = t284 * t66 / 0.3e1 - 0.2e1 / 0.3e1 * t149 * t177 + 0.2e1 / 0.3e1 * t36 * t40 / t151 / t64 * t292 - t36 * t153 * t359 / 0.3e1
  t367 = 0.1e1 / t183 / t69
  t368 = t367 * t274
  t370 = t184 * t363
  t373 = (0.6e1 * t184 * t274 - 0.2e1 * t73 * t363 + 0.36e2 * t368 - 0.9e1 * t370) * t78
  t375 = t187 * t191
  t380 = t77 ** 2
  t382 = t75 / t380
  t383 = t183 ** 2
  t384 = 0.1e1 / t383
  t400 = t91 ** 2
  t403 = t206 ** 2
  t408 = t81 * t83 * t354
  t410 = 0.14711144691358024691358024691358024691358024691358e1 * t296 + 0.18172100223395413760000000000000000000000000000000e0 * t408
  t452 = t257 ** 2
  t458 = t241 ** 2
  t462 = t318 / 0.4e1 + 0.22e2 / 0.81e2 * t296
  t477 = f.my_piecewise3(t127, s0 / t143 * t124 / 0.4e1, 0)
  t481 = t251 ** 2
  t489 = t373 * t108 + 0.12e2 * t375 * t194 + 0.2e1 * t188 * t224 + 0.54e2 * t382 * t108 * t384 * t274 + 0.12e2 * t192 * t224 * t184 * t180 - 0.24e2 * t192 * t108 * t367 * t274 + 0.6e1 * t192 * t193 * t363 + t79 * (0.6e1 / 0.25e2 / t92 / t400 * t403 - t198 * t410 / 0.5e1 + 0.7e1 / 0.9e1 * (0.62522364938271604938271604938271604938271604938271e0 * t296 - 0.5e1 / 0.9e1 * (0.64685031111111111111111111111111111111111111111112e0 * t277 + 0.11603759851851851851851851851851851851851851851852e0 * t281) * t35 * t40) * t105 - 0.28e2 / 0.45e2 * t216 * t220 * t206 + 0.98e2 / 0.225e3 * t103 / t104 / t400 * t403 - 0.14e2 / 0.45e2 * t221 * t410) + (-0.54e2 * t382 * t384 * t274 - 0.12e2 * t375 * t185 + 0.24e2 * t192 * t368 - 0.6e1 * t192 * t370 - t373) * t134 + t228 * t234 * t257 / 0.5e1 - 0.9e1 / 0.100e3 * t110 / t233 / t133 * t452 + t235 * (0.125e3 / 0.2187e4 * t408 + 0.110e3 / 0.27e2 * t114 * t281 + 0.584e3 / 0.405e3 * t458 + 0.584e3 / 0.405e3 * t119 * t462 - 0.146e3 / 0.135e3 * t462 * t128 * t130 - 0.292e3 / 0.135e3 * t241 * t251 * t130 + 0.292e3 / 0.135e3 * t244 * t251 - 0.146e3 / 0.135e3 * t119 * t477 * t130 + 0.292e3 / 0.135e3 * t119 * t481 + 0.146e3 / 0.135e3 * t129 * t477) / 0.10e2
  t494 = f.my_piecewise3(t2, 0, t6 * t17 * t26 * t136 / 0.12e2 - t6 * t21 * t260 / 0.4e1 - 0.3e1 / 0.8e1 * t6 * t140 * t489)
  v2rho2_0_ = 0.2e1 * r0 * t494 + 0.4e1 * t265
  res = {'v2rho2': v2rho2_0_}
  return res

def unpol_kxc(p, r, s=None, l=None, tau=None):
  f = funcs(p)
  params = f.params
  r0, s0, l0, tau0 = r, s, l, tau

  t2 = r0 / 0.2e1 <= f.p.dens_threshold
  t3 = 3 ** (0.1e1 / 0.3e1)
  t4 = jnp.pi ** (0.1e1 / 0.3e1)
  t6 = t3 / t4
  t7 = 0.1e1 <= f.p.zeta_threshold
  t8 = f.p.zeta_threshold - 0.1e1
  t10 = f.my_piecewise5(t7, t8, t7, -t8, 0)
  t11 = 0.1e1 + t10
  t13 = f.p.zeta_threshold ** (0.1e1 / 0.3e1)
  t15 = t11 ** (0.1e1 / 0.3e1)
  t17 = f.my_piecewise3(t11 <= f.p.zeta_threshold, t13 * f.p.zeta_threshold, t15 * t11)
  t18 = r0 ** (0.1e1 / 0.3e1)
  t19 = t18 ** 2
  t21 = 0.1e1 / t19 / r0
  t22 = t17 * t21
  t23 = 2 ** (0.1e1 / 0.3e1)
  t24 = t23 ** 2
  t25 = tau0 * t24
  t26 = t25 * t21
  t27 = s0 * t24
  t28 = r0 ** 2
  t30 = 0.1e1 / t19 / t28
  t31 = t27 * t30
  t33 = t26 - t31 / 0.8e1
  t34 = 6 ** (0.1e1 / 0.3e1)
  t35 = t33 * t34
  t36 = jnp.pi ** 2
  t37 = t36 ** (0.1e1 / 0.3e1)
  t38 = t37 ** 2
  t39 = 0.1e1 / t38
  t40 = t34 * t39
  t41 = t40 * t31
  t43 = t35 * t39
  t45 = 0.1e1 - 0.5e1 / 0.9e1 * t43
  t46 = t45 ** 2
  t47 = t46 * t45
  t48 = t33 ** 2
  t49 = t34 ** 2
  t50 = t48 * t49
  t52 = 0.1e1 / t37 / t36
  t55 = 0.1e1 + 0.67148919753086419753086419753086419753086419753086e0 * t50 * t52
  t56 = jnp.sqrt(t55)
  t58 = 0.1e1 / t56 / t55
  t59 = t47 * t58
  t61 = jnp.exp(-t41 / 0.8e1)
  t63 = t41 / 0.24e2 + t59 * t61
  t65 = t39 / t63
  t68 = 0.1e1 + t35 * t65 / 0.3e1
  t69 = t68 ** 2
  t72 = 0.1e1 / t69 / t68
  t74 = 0.1e1 / t69 + 0.3e1 * t72
  t75 = 0.1e1 + t72
  t76 = t75 ** 2
  t77 = 0.1e1 / t76
  t78 = t74 * t77
  t80 = t49 * t52
  t81 = s0 ** 2
  t82 = t81 * t23
  t83 = t28 ** 2
  t84 = t83 * r0
  t90 = 0.1e1 + 0.15045488888888888888888888888888888888888888888889e0 * t41 + 0.53798980924525896000000000000000000000000000000000e-2 * t80 * t82 / t18 / t84
  t91 = t90 ** (0.1e1 / 0.5e1)
  t102 = 0.1e1 + 0.63943327777777777777777777777777777777777777777778e-1 * t41 - 0.5e1 / 0.9e1 * (0.14554132000000000000000000000000000000000000000000e0 * t26 + 0.25633760400000000000000000000000000000000000000000e0 * t49 * t38 + 0.11867481666666666666666666666666666666666666666667e-1 * t31) * t34 * t39
  t103 = t91 ** 2
  t104 = 0.1e1 / t103
  t107 = 0.1e1 / t91 + 0.7e1 / 0.9e1 * t102 * t104
  t109 = 0.1e1 - t78
  t113 = (0.10e2 / 0.81e2 + 0.25e2 / 0.8748e4 * t41) * t34 * t39
  t118 = t43 / 0.4e1 - 0.9e1 / 0.20e2 + t41 / 0.36e2
  t119 = t118 ** 2
  t123 = 0.1e1 / tau0
  t125 = s0 / r0 * t123 / 0.8e1
  t126 = t125 < 0.10e1
  t127 = f.my_piecewise3(t126, t125, 0.10e1)
  t128 = t118 * t127
  t129 = 0.1e1 - t127
  t132 = 0.1e1 + 0.5e1 / 0.12e2 * t113 * t31 + 0.292e3 / 0.405e3 * t119 - 0.146e3 / 0.135e3 * t128 * t129
  t133 = t132 ** (0.1e1 / 0.10e2)
  t135 = t78 * t107 + t109 * t133
  t140 = t17 / t19
  t141 = t25 * t30
  t143 = t28 * r0
  t145 = 0.1e1 / t19 / t143
  t146 = t27 * t145
  t148 = -0.5e1 / 0.3e1 * t141 + t146 / 0.3e1
  t149 = t148 * t34
  t151 = t63 ** 2
  t153 = t39 / t151
  t154 = t40 * t146
  t156 = t46 * t58
  t157 = t156 * t61
  t158 = t149 * t39
  t161 = t55 ** 2
  t163 = 0.1e1 / t56 / t161
  t164 = t47 * t163
  t165 = t164 * t61
  t166 = t33 * t49
  t171 = t59 * t40
  t172 = t145 * t61
  t176 = -t154 / 0.9e1 - 0.5e1 / 0.3e1 * t157 * t158 - 0.20144675925925925925925925925925925925925925925926e1 * t165 * t166 * t52 * t148 + t171 * t27 * t172 / 0.3e1
  t177 = t153 * t176
  t180 = t149 * t65 / 0.3e1 - t35 * t177 / 0.3e1
  t183 = t69 ** 2
  t184 = 0.1e1 / t183
  t185 = t184 * t180
  t187 = -0.2e1 * t72 * t180 - 0.9e1 * t185
  t188 = t187 * t77
  t191 = 0.1e1 / t76 / t75
  t192 = t74 * t191
  t193 = t107 * t184
  t194 = t193 * t180
  t198 = 0.1e1 / t91 / t90
  t204 = t80 * t82 / t18 / t83 / t28
  t206 = -0.40121303703703703703703703703703703703703703703704e0 * t154 - 0.28692789826413811200000000000000000000000000000000e-1 * t204
  t216 = -0.17051554074074074074074074074074074074074074074074e0 * t154 - 0.5e1 / 0.9e1 * (-0.24256886666666666666666666666666666666666666666667e0 * t141 - 0.31646617777777777777777777777777777777777777777779e-1 * t146) * t34 * t39
  t220 = 0.1e1 / t103 / t90
  t221 = t102 * t220
  t224 = -t198 * t206 / 0.5e1 + 0.7e1 / 0.9e1 * t216 * t104 - 0.14e2 / 0.45e2 * t221 * t206
  t228 = -0.6e1 * t192 * t185 - t188
  t230 = t133 ** 2
  t231 = t230 ** 2
  t232 = t231 ** 2
  t233 = t232 * t133
  t234 = 0.1e1 / t233
  t235 = t109 * t234
  t241 = t158 / 0.4e1 - 0.2e1 / 0.27e2 * t154
  t244 = t241 * t127
  t251 = f.my_piecewise3(t126, -s0 / t28 * t123 / 0.8e1, 0)
  t257 = -0.125e3 / 0.19683e5 * t204 - 0.10e2 / 0.9e1 * t113 * t146 + 0.584e3 / 0.405e3 * t118 * t241 - 0.146e3 / 0.135e3 * t244 * t129 - 0.146e3 / 0.135e3 * t118 * t251 * t129 + 0.146e3 / 0.135e3 * t128 * t251
  t260 = t188 * t107 + 0.6e1 * t192 * t194 + t78 * t224 + t228 * t133 + t235 * t257 / 0.10e2
  t264 = t17 * t18
  t265 = t180 ** 2
  t268 = t25 * t145
  t271 = 0.1e1 / t19 / t83
  t272 = t27 * t271
  t274 = 0.40e2 / 0.9e1 * t268 - 0.11e2 / 0.9e1 * t272
  t275 = t274 * t34
  t281 = 0.1e1 / t151 / t63
  t283 = t176 ** 2
  t284 = t39 * t281 * t283
  t287 = t40 * t272
  t289 = t45 * t58
  t290 = t289 * t61
  t291 = t148 ** 2
  t293 = t291 * t49 * t52
  t296 = t46 * t163
  t297 = t296 * t61
  t298 = t36 ** 2
  t299 = 0.1e1 / t298
  t301 = t291 * t299 * t33
  t304 = t156 * t80
  t309 = t275 * t39
  t314 = 0.1e1 / t56 / t161 / t55
  t315 = t47 * t314
  t316 = t315 * t61
  t319 = 0.1e1 / t38 / t298
  t324 = t299 * s0
  t325 = t164 * t324
  t326 = t24 * t145
  t327 = t61 * t33
  t328 = t327 * t148
  t334 = t52 * t274
  t338 = t271 * t61
  t342 = t59 * t80
  t345 = 0.1e1 / t18 / t83 / t143
  t350 = 0.11e2 / 0.27e2 * t287 + 0.50e2 / 0.27e2 * t290 * t293 + 0.40289351851851851851851851851851851851851851851851e2 * t297 * t301 - 0.10e2 / 0.9e1 * t304 * t27 * t172 * t148 - 0.5e1 / 0.3e1 * t157 * t309 + 0.40580796816057956104252400548696844993141289437586e2 * t316 * t48 * t34 * t319 * t291 - 0.80578703703703703703703703703703703703703703703702e1 * t325 * t326 * t328 - 0.20144675925925925925925925925925925925925925925926e1 * t165 * t293 - 0.20144675925925925925925925925925925925925925925926e1 * t165 * t166 * t334 - 0.11e2 / 0.9e1 * t171 * t27 * t338 + 0.2e1 / 0.9e1 * t342 * t82 * t345 * t61
  t351 = t153 * t350
  t354 = t275 * t65 / 0.3e1 - 0.2e1 / 0.3e1 * t149 * t177 + 0.2e1 / 0.3e1 * t35 * t284 - t35 * t351 / 0.3e1
  t358 = 0.1e1 / t183 / t68
  t359 = t358 * t265
  t361 = t184 * t354
  t363 = 0.6e1 * t184 * t265 - 0.2e1 * t72 * t354 + 0.36e2 * t359 - 0.9e1 * t361
  t364 = t363 * t77
  t366 = t187 * t191
  t371 = t76 ** 2
  t372 = 0.1e1 / t371
  t373 = t74 * t372
  t374 = t183 ** 2
  t375 = 0.1e1 / t374
  t377 = t107 * t375 * t265
  t380 = t224 * t184
  t381 = t380 * t180
  t385 = t107 * t358 * t265
  t388 = t193 * t354
  t391 = t90 ** 2
  t393 = 0.1e1 / t91 / t391
  t394 = t206 ** 2
  t399 = t80 * t82 * t345
  t401 = 0.14711144691358024691358024691358024691358024691358e1 * t287 + 0.18172100223395413760000000000000000000000000000000e0 * t399
  t411 = 0.62522364938271604938271604938271604938271604938271e0 * t287 - 0.5e1 / 0.9e1 * (0.64685031111111111111111111111111111111111111111112e0 * t268 + 0.11603759851851851851851851851851851851851851851852e0 * t272) * t34 * t39
  t414 = t216 * t220
  t418 = 0.1e1 / t103 / t391
  t419 = t102 * t418
  t424 = 0.6e1 / 0.25e2 * t393 * t394 - t198 * t401 / 0.5e1 + 0.7e1 / 0.9e1 * t411 * t104 - 0.28e2 / 0.45e2 * t414 * t206 + 0.98e2 / 0.225e3 * t419 * t394 - 0.14e2 / 0.45e2 * t221 * t401
  t428 = t375 * t265
  t435 = -0.12e2 * t366 * t185 + 0.24e2 * t192 * t359 - 0.6e1 * t192 * t361 - 0.54e2 * t373 * t428 - t364
  t437 = t228 * t234
  t441 = 0.1e1 / t233 / t132
  t442 = t109 * t441
  t443 = t257 ** 2
  t449 = t241 ** 2
  t453 = t309 / 0.4e1 + 0.22e2 / 0.81e2 * t287
  t456 = t453 * t127
  t468 = f.my_piecewise3(t126, s0 / t143 * t123 / 0.4e1, 0)
  t469 = t118 * t468
  t472 = t251 ** 2
  t477 = 0.125e3 / 0.2187e4 * t399 + 0.110e3 / 0.27e2 * t113 * t272 + 0.584e3 / 0.405e3 * t449 + 0.584e3 / 0.405e3 * t118 * t453 - 0.146e3 / 0.135e3 * t456 * t129 - 0.292e3 / 0.135e3 * t241 * t251 * t129 + 0.292e3 / 0.135e3 * t244 * t251 - 0.146e3 / 0.135e3 * t469 * t129 + 0.292e3 / 0.135e3 * t118 * t472 + 0.146e3 / 0.135e3 * t128 * t468
  t480 = t364 * t107 + 0.12e2 * t366 * t194 + 0.2e1 * t188 * t224 + 0.54e2 * t373 * t377 + 0.12e2 * t192 * t381 - 0.24e2 * t192 * t385 + 0.6e1 * t192 * t388 + t78 * t424 + t435 * t133 + t437 * t257 / 0.5e1 - 0.9e1 / 0.100e3 * t442 * t443 + t235 * t477 / 0.10e2
  t485 = f.my_piecewise3(t2, 0, t6 * t22 * t135 / 0.12e2 - t6 * t140 * t260 / 0.4e1 - 0.3e1 / 0.8e1 * t6 * t264 * t480)
  t499 = t358 * t180 * t354
  t504 = t187 * t372
  t520 = t25 * t271
  t523 = 0.1e1 / t19 / t84
  t524 = t27 * t523
  t526 = -0.440e3 / 0.27e2 * t520 + 0.154e3 / 0.27e2 * t524
  t527 = t526 * t34
  t534 = t151 ** 2
  t561 = t46 * t314
  t565 = 0.1e1 / t37 / t298 / t36
  t566 = t291 * t148
  t572 = t148 * t49 * t334
  t581 = t45 * t163
  t585 = t566 * t34 * t319 * t33
  t595 = t527 * t39
  t598 = t161 ** 2
  t604 = t298 ** 2
  t612 = t83 ** 2
  t619 = t61 * t566
  t623 = 0.44318287037037037037037037037037037037037037037035e2 * t325 * t24 * t271 * t328 + 0.55e2 / 0.9e1 * t304 * t27 * t338 * t148 - 0.5e1 / 0.3e1 * t304 * t27 * t172 * t274 - 0.12086805555555555555555555555555555555555555555555e2 * t325 * t326 * t327 * t274 - 0.67634661360096593507087334247828074988568815729310e2 * t561 * t61 * t50 * t565 * t566 - 0.60434027777777777777777777777777777777777777777778e1 * t165 * t572 - 0.20144675925925925925925925925925925925925925925926e1 * t165 * t166 * t52 * t526 + 0.50e2 / 0.9e1 * t290 * t572 - 0.22382973251028806584362139917695473251028806584361e2 * t581 * t61 * t585 + 0.12174239044817386831275720164609053497942386831276e3 * t316 * t585 + 0.12086805555555555555555555555555555555555555555556e3 * t297 * t148 * t299 * t33 * t274 - 0.5e1 / 0.3e1 * t157 * t595 - 0.11444818009454678430466646344561296550322613422751e4 * t47 / t56 / t598 * t61 * t48 * t33 / t604 * t566 + 0.8e1 / 0.9e1 * t59 * t299 * t81 * s0 / t612 / t143 * t61 + 0.60434027777777777777777777777777777777777777777777e2 * t296 * t619 * t299
  t624 = t40 * t524
  t630 = t34 * t319
  t633 = t23 * t345
  t639 = t61 * t291
  t647 = t61 * t48
  t652 = t326 * t639
  t660 = 0.1e1 / t18 / t612
  t683 = t299 * t81
  t708 = -0.154e3 / 0.81e2 * t624 - 0.500e3 / 0.81e2 * t566 * t299 * t58 * t61 - 0.26859567901234567901234567901234567901234567901233e1 * t164 * t630 * t81 * t633 * t328 + 0.13429783950617283950617283950617283950617283950617e2 * t296 * t630 * s0 * t326 * t639 * t33 + 0.13526932272019318701417466849565614997713763145862e2 * t315 * t49 * t565 * s0 * t326 * t647 * t291 - 0.12086805555555555555555555555555555555555555555555e2 * t325 * t652 + 0.154e3 / 0.27e2 * t171 * t27 * t523 * t61 - 0.22e2 / 0.9e1 * t342 * t82 * t660 * t61 + 0.12174239044817386831275720164609053497942386831276e3 * t315 * t647 * t630 * t148 * t274 + 0.100e3 / 0.9e1 * t289 * t324 * t652 - 0.44765946502057613168724279835390946502057613168723e2 * t581 * t619 * t299 * t33 * t40 - 0.13526932272019318701417466849565614997713763145861e3 * t561 * t619 * t299 * t48 * t80 - 0.20e2 / 0.3e1 * t156 * t683 * t633 * t61 * t148 + 0.26859567901234567901234567901234567901234567901234e2 * t296 * t40 * s0 * t326 * t61 * t301 + 0.27053864544038637402834933699131229995427526291722e2 * t315 * t324 * t24 * t172 * t48 * t293 - 0.53719135802469135802469135802469135802469135802468e1 * t164 * t683 * t23 * t345 * t34 * t39 * t328
  t713 = t527 * t65 / 0.3e1 - t275 * t177 + 0.2e1 * t149 * t284 - t149 * t351 - 0.2e1 * t35 * t39 / t534 * t283 * t176 + 0.2e1 * t43 * t281 * t176 * t350 - t35 * t153 * (t623 + t708) / 0.3e1
  t719 = t74 / t371 / t75
  t721 = 0.1e1 / t374 / t183
  t723 = t265 * t180
  t734 = 0.1e1 / t183 / t69
  t735 = t734 * t723
  t738 = t184 * t713
  t741 = (0.18e2 * t185 * t354 - 0.24e2 * t358 * t723 - 0.2e1 * t72 * t713 + 0.108e3 * t499 - 0.180e3 * t735 - 0.9e1 * t738) * t77
  t746 = t391 * t90
  t749 = t394 * t206
  t757 = t80 * t82 * t660
  t759 = -0.68652008559670781893004115226337448559670781893004e1 * t624 - 0.13326206830489970090666666666666666666666666666667e1 * t757
  t794 = -0.72e2 * t192 * t107 * t499 + 0.18e2 * t366 * t388 + 0.162e3 * t504 * t377 + 0.36e2 * t366 * t381 + 0.18e2 * t192 * t424 * t184 * t180 + 0.162e3 * t373 * t224 * t375 * t265 + 0.18e2 * t192 * t380 * t354 + 0.6e1 * t192 * t193 * t713 + 0.648e3 * t719 * t107 * t721 * t723 + t741 * t107 - 0.27e2 / 0.100e3 * t442 * t257 * t477 + t78 * (-0.66e2 / 0.125e3 / t91 / t746 * t749 + 0.18e2 / 0.25e2 * t393 * t206 * t401 - t198 * t759 / 0.5e1 + 0.7e1 / 0.9e1 * (-0.29177103637860082304526748971193415637860082304526e1 * t624 - 0.5e1 / 0.9e1 * (-0.23717844740740740740740740740740740740740740740741e1 * t520 - 0.54150879308641975308641975308641975308641975308643e0 * t524) * t34 * t39) * t104 - 0.14e2 / 0.15e2 * t411 * t220 * t206 + 0.98e2 / 0.75e2 * t216 * t418 * t394 - 0.14e2 / 0.15e2 * t414 * t401 - 0.392e3 / 0.375e3 * t102 / t103 / t746 * t749 + 0.98e2 / 0.75e2 * t419 * t206 * t401 - 0.14e2 / 0.45e2 * t221 * t759) + 0.3e1 * t364 * t224
  t802 = 0.1e1 / t374 / t68
  t811 = t363 * t191
  t829 = t375 * t180 * t354
  t838 = 0.648e3 * t373 * t802 * t723 - 0.648e3 * t719 * t721 * t723 - 0.18e2 * t811 * t185 + 0.72e2 * t192 * t499 - 0.120e3 * t192 * t735 - 0.6e1 * t192 * t738 + 0.72e2 * t366 * t359 - 0.18e2 * t366 * t361 - 0.162e3 * t373 * t829 - 0.162e3 * t504 * t428 - t741
  t850 = t132 ** 2
  t864 = t595 / 0.4e1 - 0.308e3 / 0.243e3 * t624
  t886 = f.my_piecewise3(t126, -0.3e1 / 0.4e1 * s0 / t83 * t123, 0)
  t894 = -0.85250e5 / 0.177147e6 * t757 - 0.1540e4 / 0.81e2 * t113 * t524 + 0.584e3 / 0.135e3 * t241 * t453 + 0.584e3 / 0.405e3 * t118 * t864 - 0.146e3 / 0.135e3 * t864 * t127 * t129 - 0.146e3 / 0.45e2 * t453 * t251 * t129 + 0.146e3 / 0.45e2 * t456 * t251 - 0.146e3 / 0.45e2 * t241 * t468 * t129 + 0.292e3 / 0.45e2 * t241 * t472 + 0.146e3 / 0.45e2 * t244 * t468 - 0.146e3 / 0.135e3 * t118 * t886 * t129 + 0.292e3 / 0.45e2 * t469 * t251 + 0.146e3 / 0.135e3 * t128 * t886
  t900 = -0.72e2 * t366 * t385 - 0.72e2 * t192 * t224 * t358 * t265 - 0.648e3 * t373 * t107 * t802 * t723 + 0.120e3 * t192 * t107 * t734 * t723 + 0.18e2 * t811 * t194 + t838 * t133 + 0.3e1 * t188 * t424 + 0.162e3 * t373 * t107 * t829 + 0.3e1 / 0.10e2 * t437 * t477 - 0.27e2 / 0.100e3 * t228 * t441 * t443 + 0.171e3 / 0.1000e4 * t109 / t233 / t850 * t443 * t257 + t235 * t894 / 0.10e2 + 0.3e1 / 0.10e2 * t435 * t234 * t257
  t906 = f.my_piecewise3(t2, 0, -0.5e1 / 0.36e2 * t6 * t17 * t30 * t135 + t6 * t22 * t260 / 0.4e1 - 0.3e1 / 0.8e1 * t6 * t140 * t480 - 0.3e1 / 0.8e1 * t6 * t264 * (t794 + t900))
  v3rho3_0_ = 0.2e1 * r0 * t906 + 0.6e1 * t485

  res = {'v3rho3': v3rho3_0_}
  return res

def unpol_lxc(p, r, s=None, l=None, tau=None):
  f = funcs(p)
  params = f.params
  r0, s0, l0, tau0 = r, s, l, tau

  t2 = r0 / 0.2e1 <= f.p.dens_threshold
  t3 = 3 ** (0.1e1 / 0.3e1)
  t4 = jnp.pi ** (0.1e1 / 0.3e1)
  t6 = t3 / t4
  t7 = 0.1e1 <= f.p.zeta_threshold
  t8 = f.p.zeta_threshold - 0.1e1
  t10 = f.my_piecewise5(t7, t8, t7, -t8, 0)
  t11 = 0.1e1 + t10
  t13 = f.p.zeta_threshold ** (0.1e1 / 0.3e1)
  t15 = t11 ** (0.1e1 / 0.3e1)
  t17 = f.my_piecewise3(t11 <= f.p.zeta_threshold, t13 * f.p.zeta_threshold, t15 * t11)
  t18 = r0 ** 2
  t19 = r0 ** (0.1e1 / 0.3e1)
  t20 = t19 ** 2
  t22 = 0.1e1 / t20 / t18
  t23 = t17 * t22
  t24 = 2 ** (0.1e1 / 0.3e1)
  t25 = t24 ** 2
  t26 = tau0 * t25
  t28 = 0.1e1 / t20 / r0
  t29 = t26 * t28
  t30 = s0 * t25
  t31 = t30 * t22
  t33 = t29 - t31 / 0.8e1
  t34 = 6 ** (0.1e1 / 0.3e1)
  t35 = t33 * t34
  t36 = jnp.pi ** 2
  t37 = t36 ** (0.1e1 / 0.3e1)
  t38 = t37 ** 2
  t39 = 0.1e1 / t38
  t40 = t34 * t39
  t41 = t40 * t31
  t43 = t35 * t39
  t45 = 0.1e1 - 0.5e1 / 0.9e1 * t43
  t46 = t45 ** 2
  t47 = t46 * t45
  t48 = t33 ** 2
  t49 = t34 ** 2
  t50 = t48 * t49
  t52 = 0.1e1 / t37 / t36
  t55 = 0.1e1 + 0.67148919753086419753086419753086419753086419753086e0 * t50 * t52
  t56 = jnp.sqrt(t55)
  t58 = 0.1e1 / t56 / t55
  t59 = t47 * t58
  t61 = jnp.exp(-t41 / 0.8e1)
  t63 = t41 / 0.24e2 + t59 * t61
  t65 = t39 / t63
  t68 = 0.1e1 + t35 * t65 / 0.3e1
  t69 = t68 ** 2
  t71 = t69 * t68
  t72 = 0.1e1 / t71
  t74 = 0.1e1 / t69 + 0.3e1 * t72
  t75 = 0.1e1 + t72
  t76 = t75 ** 2
  t77 = 0.1e1 / t76
  t78 = t74 * t77
  t80 = t49 * t52
  t81 = s0 ** 2
  t82 = t81 * t24
  t83 = t18 ** 2
  t84 = t83 * r0
  t90 = 0.1e1 + 0.15045488888888888888888888888888888888888888888889e0 * t41 + 0.53798980924525896000000000000000000000000000000000e-2 * t80 * t82 / t19 / t84
  t91 = t90 ** (0.1e1 / 0.5e1)
  t102 = 0.1e1 + 0.63943327777777777777777777777777777777777777777778e-1 * t41 - 0.5e1 / 0.9e1 * (0.14554132000000000000000000000000000000000000000000e0 * t29 + 0.25633760400000000000000000000000000000000000000000e0 * t49 * t38 + 0.11867481666666666666666666666666666666666666666667e-1 * t31) * t34 * t39
  t103 = t91 ** 2
  t104 = 0.1e1 / t103
  t107 = 0.1e1 / t91 + 0.7e1 / 0.9e1 * t102 * t104
  t109 = 0.1e1 - t78
  t113 = (0.10e2 / 0.81e2 + 0.25e2 / 0.8748e4 * t41) * t34 * t39
  t118 = t43 / 0.4e1 - 0.9e1 / 0.20e2 + t41 / 0.36e2
  t119 = t118 ** 2
  t123 = 0.1e1 / tau0
  t125 = s0 / r0 * t123 / 0.8e1
  t126 = t125 < 0.10e1
  t127 = f.my_piecewise3(t126, t125, 0.10e1)
  t128 = t118 * t127
  t129 = 0.1e1 - t127
  t132 = 0.1e1 + 0.5e1 / 0.12e2 * t113 * t31 + 0.292e3 / 0.405e3 * t119 - 0.146e3 / 0.135e3 * t128 * t129
  t133 = t132 ** (0.1e1 / 0.10e2)
  t135 = t78 * t107 + t109 * t133
  t139 = t17 * t28
  t140 = t26 * t22
  t142 = t18 * r0
  t144 = 0.1e1 / t20 / t142
  t145 = t30 * t144
  t147 = -0.5e1 / 0.3e1 * t140 + t145 / 0.3e1
  t148 = t147 * t34
  t150 = t63 ** 2
  t152 = t39 / t150
  t153 = t40 * t145
  t155 = t46 * t58
  t156 = t155 * t61
  t157 = t148 * t39
  t160 = t55 ** 2
  t162 = 0.1e1 / t56 / t160
  t163 = t47 * t162
  t164 = t163 * t61
  t165 = t33 * t49
  t170 = t59 * t40
  t171 = t144 * t61
  t175 = -t153 / 0.9e1 - 0.5e1 / 0.3e1 * t156 * t157 - 0.20144675925925925925925925925925925925925925925926e1 * t164 * t165 * t52 * t147 + t170 * t30 * t171 / 0.3e1
  t176 = t152 * t175
  t179 = t148 * t65 / 0.3e1 - t35 * t176 / 0.3e1
  t182 = t69 ** 2
  t183 = 0.1e1 / t182
  t184 = t183 * t179
  t186 = -0.2e1 * t72 * t179 - 0.9e1 * t184
  t187 = t186 * t77
  t190 = 0.1e1 / t76 / t75
  t191 = t74 * t190
  t192 = t107 * t183
  t193 = t192 * t179
  t197 = 0.1e1 / t91 / t90
  t199 = t83 * t18
  t203 = t80 * t82 / t19 / t199
  t205 = -0.40121303703703703703703703703703703703703703703704e0 * t153 - 0.28692789826413811200000000000000000000000000000000e-1 * t203
  t215 = -0.17051554074074074074074074074074074074074074074074e0 * t153 - 0.5e1 / 0.9e1 * (-0.24256886666666666666666666666666666666666666666667e0 * t140 - 0.31646617777777777777777777777777777777777777777779e-1 * t145) * t34 * t39
  t219 = 0.1e1 / t103 / t90
  t220 = t102 * t219
  t223 = -t197 * t205 / 0.5e1 + 0.7e1 / 0.9e1 * t215 * t104 - 0.14e2 / 0.45e2 * t220 * t205
  t227 = -0.6e1 * t191 * t184 - t187
  t229 = t133 ** 2
  t230 = t229 ** 2
  t231 = t230 ** 2
  t232 = t231 * t133
  t233 = 0.1e1 / t232
  t234 = t109 * t233
  t240 = t157 / 0.4e1 - 0.2e1 / 0.27e2 * t153
  t243 = t240 * t127
  t250 = f.my_piecewise3(t126, -s0 / t18 * t123 / 0.8e1, 0)
  t256 = -0.125e3 / 0.19683e5 * t203 - 0.10e2 / 0.9e1 * t113 * t145 + 0.584e3 / 0.405e3 * t118 * t240 - 0.146e3 / 0.135e3 * t243 * t129 - 0.146e3 / 0.135e3 * t118 * t250 * t129 + 0.146e3 / 0.135e3 * t128 * t250
  t259 = t187 * t107 + 0.6e1 * t191 * t193 + t78 * t223 + t227 * t133 + t234 * t256 / 0.10e2
  t264 = t17 / t20
  t265 = t179 ** 2
  t268 = t26 * t144
  t271 = 0.1e1 / t20 / t83
  t272 = t30 * t271
  t274 = 0.40e2 / 0.9e1 * t268 - 0.11e2 / 0.9e1 * t272
  t275 = t274 * t34
  t281 = 0.1e1 / t150 / t63
  t282 = t39 * t281
  t283 = t175 ** 2
  t284 = t282 * t283
  t287 = t40 * t272
  t289 = t45 * t58
  t290 = t289 * t61
  t291 = t147 ** 2
  t293 = t291 * t49 * t52
  t296 = t46 * t162
  t297 = t296 * t61
  t298 = t36 ** 2
  t299 = 0.1e1 / t298
  t300 = t291 * t299
  t301 = t300 * t33
  t304 = t155 * t80
  t305 = t171 * t147
  t309 = t275 * t39
  t314 = 0.1e1 / t56 / t160 / t55
  t315 = t47 * t314
  t316 = t315 * t61
  t317 = t48 * t34
  t319 = 0.1e1 / t38 / t298
  t324 = t299 * s0
  t325 = t163 * t324
  t326 = t25 * t144
  t327 = t61 * t33
  t328 = t327 * t147
  t334 = t52 * t274
  t338 = t271 * t61
  t342 = t59 * t80
  t345 = 0.1e1 / t19 / t83 / t142
  t346 = t345 * t61
  t350 = 0.11e2 / 0.27e2 * t287 + 0.50e2 / 0.27e2 * t290 * t293 + 0.40289351851851851851851851851851851851851851851851e2 * t297 * t301 - 0.10e2 / 0.9e1 * t304 * t30 * t305 - 0.5e1 / 0.3e1 * t156 * t309 + 0.40580796816057956104252400548696844993141289437586e2 * t316 * t317 * t319 * t291 - 0.80578703703703703703703703703703703703703703703702e1 * t325 * t326 * t328 - 0.20144675925925925925925925925925925925925925925926e1 * t164 * t293 - 0.20144675925925925925925925925925925925925925925926e1 * t164 * t165 * t334 - 0.11e2 / 0.9e1 * t170 * t30 * t338 + 0.2e1 / 0.9e1 * t342 * t82 * t346
  t351 = t152 * t350
  t354 = t275 * t65 / 0.3e1 - 0.2e1 / 0.3e1 * t148 * t176 + 0.2e1 / 0.3e1 * t35 * t284 - t35 * t351 / 0.3e1
  t357 = t182 * t68
  t358 = 0.1e1 / t357
  t359 = t358 * t265
  t361 = t183 * t354
  t363 = 0.6e1 * t183 * t265 - 0.2e1 * t72 * t354 + 0.36e2 * t359 - 0.9e1 * t361
  t364 = t363 * t77
  t366 = t186 * t190
  t371 = t76 ** 2
  t372 = 0.1e1 / t371
  t373 = t74 * t372
  t374 = t182 ** 2
  t375 = 0.1e1 / t374
  t376 = t107 * t375
  t377 = t376 * t265
  t380 = t223 * t183
  t381 = t380 * t179
  t384 = t107 * t358
  t385 = t384 * t265
  t388 = t192 * t354
  t391 = t90 ** 2
  t393 = 0.1e1 / t91 / t391
  t394 = t205 ** 2
  t399 = t80 * t82 * t345
  t401 = 0.14711144691358024691358024691358024691358024691358e1 * t287 + 0.18172100223395413760000000000000000000000000000000e0 * t399
  t411 = 0.62522364938271604938271604938271604938271604938271e0 * t287 - 0.5e1 / 0.9e1 * (0.64685031111111111111111111111111111111111111111112e0 * t268 + 0.11603759851851851851851851851851851851851851851852e0 * t272) * t34 * t39
  t414 = t215 * t219
  t418 = 0.1e1 / t103 / t391
  t419 = t102 * t418
  t424 = 0.6e1 / 0.25e2 * t393 * t394 - t197 * t401 / 0.5e1 + 0.7e1 / 0.9e1 * t411 * t104 - 0.28e2 / 0.45e2 * t414 * t205 + 0.98e2 / 0.225e3 * t419 * t394 - 0.14e2 / 0.45e2 * t220 * t401
  t428 = t375 * t265
  t435 = -0.12e2 * t366 * t184 + 0.24e2 * t191 * t359 - 0.6e1 * t191 * t361 - 0.54e2 * t373 * t428 - t364
  t437 = t227 * t233
  t441 = 0.1e1 / t232 / t132
  t442 = t109 * t441
  t443 = t256 ** 2
  t449 = t240 ** 2
  t453 = t309 / 0.4e1 + 0.22e2 / 0.81e2 * t287
  t456 = t453 * t127
  t468 = f.my_piecewise3(t126, s0 / t142 * t123 / 0.4e1, 0)
  t469 = t118 * t468
  t472 = t250 ** 2
  t477 = 0.125e3 / 0.2187e4 * t399 + 0.110e3 / 0.27e2 * t113 * t272 + 0.584e3 / 0.405e3 * t449 + 0.584e3 / 0.405e3 * t118 * t453 - 0.146e3 / 0.135e3 * t456 * t129 - 0.292e3 / 0.135e3 * t240 * t250 * t129 + 0.292e3 / 0.135e3 * t243 * t250 - 0.146e3 / 0.135e3 * t469 * t129 + 0.292e3 / 0.135e3 * t118 * t472 + 0.146e3 / 0.135e3 * t128 * t468
  t480 = t364 * t107 + 0.12e2 * t366 * t193 + 0.2e1 * t187 * t223 + 0.54e2 * t373 * t377 + 0.12e2 * t191 * t381 - 0.24e2 * t191 * t385 + 0.6e1 * t191 * t388 + t78 * t424 + t435 * t133 + t437 * t256 / 0.5e1 - 0.9e1 / 0.100e3 * t442 * t443 + t234 * t477 / 0.10e2
  t484 = t17 * t19
  t485 = t424 * t183
  t486 = t485 * t179
  t489 = t83 ** 2
  t491 = 0.1e1 / t19 / t489
  t493 = t80 * t82 * t491
  t496 = 0.1e1 / t20 / t84
  t497 = t30 * t496
  t502 = t26 * t271
  t505 = -0.440e3 / 0.27e2 * t502 + 0.154e3 / 0.27e2 * t497
  t506 = t505 * t34
  t507 = t506 * t39
  t509 = t40 * t497
  t511 = t507 / 0.4e1 - 0.308e3 / 0.243e3 * t509
  t514 = t511 * t127
  t522 = t240 * t468
  t533 = f.my_piecewise3(t126, -0.3e1 / 0.4e1 * s0 / t83 * t123, 0)
  t534 = t118 * t533
  t541 = -0.85250e5 / 0.177147e6 * t493 - 0.1540e4 / 0.81e2 * t113 * t497 + 0.584e3 / 0.135e3 * t240 * t453 + 0.584e3 / 0.405e3 * t118 * t511 - 0.146e3 / 0.135e3 * t514 * t129 - 0.146e3 / 0.45e2 * t453 * t250 * t129 + 0.146e3 / 0.45e2 * t456 * t250 - 0.146e3 / 0.45e2 * t522 * t129 + 0.292e3 / 0.45e2 * t240 * t472 + 0.146e3 / 0.45e2 * t243 * t468 - 0.146e3 / 0.135e3 * t534 * t129 + 0.292e3 / 0.45e2 * t469 * t250 + 0.146e3 / 0.135e3 * t128 * t533
  t545 = t223 * t375 * t265
  t548 = t256 * t477
  t551 = t227 * t441
  t556 = t186 * t372
  t560 = 0.1e1 / t374 / t68
  t562 = t265 * t179
  t563 = t107 * t560 * t562
  t574 = t150 ** 2
  t575 = 0.1e1 / t574
  t578 = t39 * t575 * t283 * t175
  t581 = t281 * t175
  t582 = t581 * t350
  t585 = t25 * t271
  t593 = t40 * s0
  t594 = t296 * t593
  t595 = t326 * t61
  t599 = t324 * t25
  t600 = t315 * t599
  t605 = t299 * t81
  t606 = t605 * t24
  t607 = t163 * t606
  t609 = t345 * t34 * t39
  t613 = t46 * t314
  t614 = t613 * t61
  t617 = 0.1e1 / t37 / t298 / t36
  t618 = t291 * t147
  t623 = t147 * t49
  t624 = t623 * t334
  t627 = t52 * t505
  t633 = t45 * t162
  t634 = t633 * t61
  t635 = t618 * t34
  t637 = t635 * t319 * t33
  t643 = t33 * t274
  t647 = t61 * t618
  t648 = t647 * t299
  t656 = 0.44318287037037037037037037037037037037037037037035e2 * t325 * t585 * t328 + 0.55e2 / 0.9e1 * t304 * t30 * t338 * t147 + 0.26859567901234567901234567901234567901234567901234e2 * t594 * t595 * t301 + 0.27053864544038637402834933699131229995427526291722e2 * t600 * t171 * t48 * t293 - 0.53719135802469135802469135802469135802469135802468e1 * t607 * t609 * t328 - 0.67634661360096593507087334247828074988568815729310e2 * t614 * t50 * t617 * t618 - 0.60434027777777777777777777777777777777777777777778e1 * t164 * t624 - 0.20144675925925925925925925925925925925925925925926e1 * t164 * t165 * t627 + 0.50e2 / 0.9e1 * t290 * t624 - 0.22382973251028806584362139917695473251028806584361e2 * t634 * t637 + 0.12174239044817386831275720164609053497942386831276e3 * t316 * t637 + 0.12086805555555555555555555555555555555555555555556e3 * t297 * t147 * t299 * t643 + 0.60434027777777777777777777777777777777777777777777e2 * t296 * t648 - 0.154e3 / 0.81e2 * t509 - 0.5e1 / 0.3e1 * t304 * t30 * t171 * t274
  t657 = t327 * t274
  t662 = t58 * t61
  t665 = t61 * t291
  t666 = t326 * t665
  t669 = t496 * t61
  t678 = t299 * t48
  t682 = t155 * t605
  t683 = t24 * t345
  t684 = t61 * t147
  t688 = t61 * t48
  t689 = t315 * t688
  t690 = t34 * t319
  t695 = t289 * t324
  t699 = t299 * t33
  t704 = t163 * t690 * t81
  t709 = t296 * t690 * s0
  t710 = t665 * t33
  t714 = t49 * t617
  t715 = t714 * s0
  t716 = t315 * t715
  t717 = t688 * t291
  t723 = t160 ** 2
  t725 = 0.1e1 / t56 / t723
  t726 = t47 * t725
  t727 = t726 * t61
  t728 = t48 * t33
  t729 = t298 ** 2
  t730 = 0.1e1 / t729
  t731 = t728 * t730
  t732 = t731 * t618
  t735 = t59 * t299
  t736 = t81 * s0
  t738 = 0.1e1 / t489 / t142
  t739 = t736 * t738
  t743 = -0.12086805555555555555555555555555555555555555555555e2 * t325 * t326 * t657 - 0.500e3 / 0.81e2 * t618 * t299 * t662 - 0.12086805555555555555555555555555555555555555555555e2 * t325 * t666 + 0.154e3 / 0.27e2 * t170 * t30 * t669 - 0.22e2 / 0.9e1 * t342 * t82 * t491 * t61 - 0.13526932272019318701417466849565614997713763145861e3 * t613 * t647 * t678 * t80 - 0.20e2 / 0.3e1 * t682 * t683 * t684 + 0.12174239044817386831275720164609053497942386831276e3 * t689 * t690 * t147 * t274 + 0.100e3 / 0.9e1 * t695 * t666 - 0.44765946502057613168724279835390946502057613168723e2 * t633 * t647 * t699 * t40 - 0.26859567901234567901234567901234567901234567901233e1 * t704 * t683 * t328 + 0.13429783950617283950617283950617283950617283950617e2 * t709 * t326 * t710 + 0.13526932272019318701417466849565614997713763145862e2 * t716 * t326 * t717 - 0.5e1 / 0.3e1 * t156 * t507 - 0.11444818009454678430466646344561296550322613422751e4 * t727 * t732 + 0.8e1 / 0.9e1 * t735 * t739 * t61
  t744 = t656 + t743
  t745 = t152 * t744
  t748 = t506 * t65 / 0.3e1 - t275 * t176 + 0.2e1 * t148 * t284 - t148 * t351 - 0.2e1 * t35 * t578 + 0.2e1 * t43 * t582 - t35 * t745 / 0.3e1
  t749 = t192 * t748
  t752 = t380 * t354
  t756 = 0.1e1 / t371 / t75
  t757 = t74 * t756
  t759 = 0.1e1 / t374 / t182
  t761 = t107 * t759 * t562
  t766 = 0.18e2 * t191 * t486 + t234 * t541 / 0.10e2 + 0.162e3 * t373 * t545 - 0.27e2 / 0.100e3 * t442 * t548 - 0.27e2 / 0.100e3 * t551 * t443 + 0.3e1 * t187 * t424 + 0.162e3 * t556 * t377 - 0.648e3 * t373 * t563 + 0.18e2 * t366 * t388 + 0.6e1 * t191 * t749 + 0.18e2 * t191 * t752 + 0.648e3 * t757 * t761 + 0.36e2 * t366 * t381
  t768 = 0.1e1 / t182 / t69
  t770 = t107 * t768 * t562
  t779 = t768 * t562
  t781 = t358 * t179
  t782 = t781 * t354
  t784 = t183 * t748
  t786 = 0.18e2 * t184 * t354 - 0.24e2 * t358 * t562 - 0.2e1 * t72 * t748 - 0.180e3 * t779 + 0.108e3 * t782 - 0.9e1 * t784
  t787 = t786 * t77
  t788 = t363 * t190
  t797 = t759 * t562
  t800 = t560 * t562
  t804 = t375 * t179 * t354
  t813 = -0.18e2 * t788 * t184 - 0.120e3 * t191 * t779 + 0.72e2 * t191 * t782 - 0.6e1 * t191 * t784 + 0.72e2 * t366 * t359 - 0.18e2 * t366 * t361 + 0.648e3 * t373 * t800 - 0.162e3 * t373 * t804 - 0.162e3 * t556 * t428 - 0.648e3 * t757 * t797 - t787
  t815 = t391 * t90
  t817 = 0.1e1 / t91 / t815
  t818 = t394 * t205
  t821 = t393 * t205
  t826 = -0.68652008559670781893004115226337448559670781893004e1 * t509 - 0.13326206830489970090666666666666666666666666666667e1 * t493
  t836 = -0.29177103637860082304526748971193415637860082304526e1 * t509 - 0.5e1 / 0.9e1 * (-0.23717844740740740740740740740740740740740740740741e1 * t502 - 0.54150879308641975308641975308641975308641975308643e0 * t497) * t34 * t39
  t839 = t411 * t219
  t842 = t215 * t418
  t848 = 0.1e1 / t103 / t815
  t849 = t102 * t848
  t852 = t205 * t401
  t857 = -0.66e2 / 0.125e3 * t817 * t818 + 0.18e2 / 0.25e2 * t821 * t401 - t197 * t826 / 0.5e1 + 0.7e1 / 0.9e1 * t836 * t104 - 0.14e2 / 0.15e2 * t839 * t205 + 0.98e2 / 0.75e2 * t842 * t394 - 0.14e2 / 0.15e2 * t414 * t401 - 0.392e3 / 0.375e3 * t849 * t818 + 0.98e2 / 0.75e2 * t419 * t852 - 0.14e2 / 0.45e2 * t220 * t826
  t861 = t191 * t107
  t866 = t373 * t107
  t869 = t132 ** 2
  t871 = 0.1e1 / t232 / t869
  t872 = t109 * t871
  t873 = t443 * t256
  t879 = t223 * t358 * t265
  t882 = t435 * t233
  t888 = 0.120e3 * t191 * t770 + t813 * t133 + t78 * t857 + 0.18e2 * t788 * t193 - 0.72e2 * t861 * t782 + 0.3e1 / 0.10e2 * t437 * t477 + 0.162e3 * t866 * t804 + 0.171e3 / 0.1000e4 * t872 * t873 - 0.72e2 * t366 * t385 - 0.72e2 * t191 * t879 + 0.3e1 / 0.10e2 * t882 * t256 + 0.3e1 * t364 * t223 + t787 * t107
  t889 = t766 + t888
  t894 = f.my_piecewise3(t2, 0, -0.5e1 / 0.36e2 * t6 * t23 * t135 + t6 * t139 * t259 / 0.4e1 - 0.3e1 / 0.8e1 * t6 * t264 * t480 - 0.3e1 / 0.8e1 * t6 * t484 * t889)
  t912 = t186 * t756
  t930 = t453 ** 2
  t934 = t26 * t496
  t937 = 0.1e1 / t20 / t199
  t938 = t30 * t937
  t940 = 0.6160e4 / 0.81e2 * t934 - 0.2618e4 / 0.81e2 * t938
  t941 = t940 * t34
  t942 = t941 * t39
  t944 = t40 * t938
  t946 = t942 / 0.4e1 + 0.5236e4 / 0.729e3 * t944
  t953 = 0.1e1 / t19 / t489 / r0
  t955 = t80 * t82 * t953
  t975 = f.my_piecewise3(t126, 0.3e1 * s0 / t84 * t123, 0)
  t981 = t468 ** 2
  t994 = 0.584e3 / 0.135e3 * t930 + 0.2336e4 / 0.405e3 * t240 * t511 + 0.584e3 / 0.405e3 * t118 * t946 + 0.584e3 / 0.45e2 * t453 * t472 + 0.761750e6 / 0.177147e6 * t955 + 0.26180e5 / 0.243e3 * t113 * t938 - 0.292e3 / 0.45e2 * t453 * t468 * t129 + 0.292e3 / 0.45e2 * t456 * t468 - 0.584e3 / 0.135e3 * t240 * t533 * t129 + 0.1168e4 / 0.45e2 * t522 * t250 + 0.584e3 / 0.135e3 * t243 * t533 - 0.146e3 / 0.135e3 * t118 * t975 * t129 + 0.1168e4 / 0.135e3 * t534 * t250 + 0.292e3 / 0.45e2 * t118 * t981 + 0.146e3 / 0.135e3 * t128 * t975 - 0.146e3 / 0.135e3 * t946 * t127 * t129 - 0.584e3 / 0.135e3 * t511 * t250 * t129 + 0.584e3 / 0.135e3 * t514 * t250
  t997 = t401 ** 2
  t1011 = t391 ** 2
  t1015 = t394 ** 2
  t1023 = 0.38902804850480109739368998628257887517146776406036e2 * t944 + 0.11105172358741641742222222222222222222222222222222e2 * t955
  t1056 = 0.98e2 / 0.75e2 * t419 * t997 + 0.392e3 / 0.225e3 * t419 * t205 * t826 + 0.196e3 / 0.75e2 * t411 * t418 * t394 - 0.1568e4 / 0.375e3 * t215 * t848 * t818 + 0.392e3 / 0.75e2 * t842 * t852 + 0.6664e4 / 0.1875e4 * t102 / t103 / t1011 * t1015 - 0.784e3 / 0.125e3 * t849 * t394 * t401 - t197 * t1023 / 0.5e1 + 0.7e1 / 0.9e1 * (0.16533692061454046639231824417009602194787379972565e2 * t944 - 0.5e1 / 0.9e1 * (0.11068327545679012345679012345679012345679012345679e2 * t934 + 0.30685498274897119341563786008230452674897119341564e1 * t938) * t34 * t39) * t104 + 0.1056e4 / 0.625e3 / t91 / t1011 * t1015 - 0.396e3 / 0.125e3 * t817 * t394 * t401 + 0.18e2 / 0.25e2 * t393 * t997 + 0.24e2 / 0.25e2 * t821 * t826 - 0.56e2 / 0.45e2 * t836 * t219 * t205 - 0.14e2 / 0.45e2 * t220 * t1023 - 0.28e2 / 0.15e2 * t839 * t401 - 0.56e2 / 0.45e2 * t414 * t826
  t1060 = t759 * t265 * t354
  t1070 = 0.648e3 * t373 * t223 * t804 + 0.2592e4 * t912 * t761 + 0.24e2 * t191 * t857 * t183 * t179 - 0.288e3 * t366 * t107 * t782 + 0.2592e4 * t757 * t223 * t759 * t562 + 0.2e1 / 0.5e1 * t437 * t541 + 0.24e2 * t366 * t749 + t234 * t994 / 0.10e2 + t78 * t1056 + 0.3888e4 * t757 * t107 * t1060 + 0.648e3 * t556 * t107 * t804 + 0.4e1 * t787 * t223 - 0.2592e4 * t556 * t563
  t1072 = t560 * t265 * t354
  t1075 = t786 * t190
  t1078 = t265 ** 2
  t1083 = t354 ** 2
  t1105 = t283 ** 2
  t1113 = t350 ** 2
  t1122 = t291 * t34 * t39
  t1123 = t346 * t1122
  t1136 = t326 * t647 * t33
  t1140 = 0.1e1 / t38 / t729
  t1144 = t61 * t728
  t1152 = t299 * t736
  t1155 = t80 * t147
  t1164 = t24 * t491
  t1205 = t326 * t684 * t274
  t1212 = 0.400e3 / 0.27e2 * t289 * t606 * t1123 - 0.26859567901234567901234567901234567901234567901233e1 * t704 * t683 * t657 + 0.13429783950617283950617283950617283950617283950617e2 * t296 * t714 * t81 * t683 * t710 - 0.22382973251028806584362139917695473251028806584361e2 * t633 * t715 * t1136 - 0.38149393364848928101555487815204321834408711409169e3 * t726 * t34 * t1140 * s0 * t326 * t1144 * t618 + 0.67148919753086419753086419753086419753086419753085e2 * t594 * t326 * t648 - 0.53719135802469135802469135802469135802469135802469e1 * t163 * t1152 * t738 * t327 * t1155 - 0.49598751664070835238530711781740588324950464868161e2 * t716 * t585 * t717 + 0.67634661360096593507087334247828074988568815729311e2 * t716 * t1136 + 0.49242541152263374485596707818930041152263374485595e2 * t704 * t1164 * t328 - 0.12310635288065843621399176954732510288065843621399e3 * t709 * t585 * t710 - 0.13429783950617283950617283950617283950617283950617e2 * t607 * t1123 + 0.110e3 / 0.9e1 * t304 * t30 * t338 * t274 - 0.160e3 / 0.27e2 * t155 * t1152 * t738 * t34 * t39 * t61 * t147 - 0.81161593632115912208504801097393689986282578875169e3 * t613 * t665 * t678 * t274 * t49 * t52 - 0.3080e4 / 0.81e2 * t304 * t30 * t669 * t147 - 0.27575823045267489711934156378600823045267489711933e3 * t325 * t25 * t496 * t328 - 0.16232318726423182441700960219478737997256515775034e4 * t613 * t730 * s0 * t326 * t647 * t48 - 0.48347222222222222222222222222222222222222222222221e2 * t325 * t1205 - 0.16115740740740740740740740740740740740740740740740e2 * t325 * t326 * t327 * t505
  t1215 = t633 * t665
  t1229 = t346 * t291
  t1234 = t171 * t618
  t1247 = t81 ** 2
  t1295 = t165 * t52
  t1296 = t1234 * t1295
  t1306 = 0.400e3 / 0.9e1 * t695 * t1205 - 0.26859567901234567901234567901234567901234567901235e3 * t1215 * t699 * t309 + 0.32464637452846364883401920438957475994513031550067e3 * t315 * t730 * t81 * t683 * t717 - 0.17906378600823045267489711934156378600823045267489e1 * t163 * t714 * t739 * t328 - 0.26859567901234567901234567901234567901234567901233e1 * t163 * t690 * t82 * t1229 + 0.13429783950617283950617283950617283950617283950617e2 * t296 * t690 * t30 * t1234 - 0.2000e4 / 0.243e3 * t635 * t39 * t58 * t324 * t595 - 0.20e2 / 0.9e1 * t304 * t30 * t171 * t505 + 0.8e1 / 0.27e2 * t59 * t299 * t1247 / t20 / t489 / t199 * t34 * t39 * t25 * t61 + 0.88636574074074074074074074074074074074074074074070e2 * t325 * t585 * t657 + 0.47004243827160493827160493827160493827160493827159e2 * t709 * t595 * t147 * t33 * t274 - 0.76298786729697856203110975630408643668817422818331e3 * t726 * t599 * t171 * t728 * t635 * t319 - 0.17234889403292181069958847736625514403292181069958e3 * t296 * t599 * t338 * t33 * t1122 - 0.24799375832035417619265355890870294162475232434078e3 * t600 * t338 * t48 * t293 + 0.68939557613168724279835390946502057613168724279834e2 * t607 * t491 * t34 * t39 * t328 - 0.13429783950617283950617283950617283950617283950617e2 * t607 * t609 * t657 + 0.67634661360096593507087334247828074988568815729311e2 * t716 * t595 * t48 * t147 * t274 + 0.94688525904135230909922267946959304983996342021026e2 * t600 * t1296 + 0.40289351851851851851851851851851851851851851851851e2 * t296 * t606 * t1229 * t1295 - 0.67148919753086419753086419753086419753086419753085e2 * t633 * t599 * t1296
  t1316 = t623 * t627
  t1319 = t291 * t274
  t1323 = t291 ** 2
  t1324 = t1323 * t49
  t1326 = t162 * t61
  t1330 = t274 ** 2
  t1343 = t46 * t725
  t1356 = t505 * t147
  t1361 = t1330 * t49 * t52
  t1365 = t1323 * t34 * t319
  t1381 = -0.38149393364848928101555487815204321834408711409170e3 * t726 * t593 * t595 * t732 - 0.1000e4 / 0.27e2 * t300 * t662 * t274 + 0.2618e4 / 0.243e3 * t944 + 0.200e3 / 0.27e2 * t290 * t1316 - 0.68668908056728070582799878067367779301935680536505e4 * t727 * t731 * t1319 + 0.37304955418381344307270233196159122085048010973936e2 * t1324 * t52 * t1326 * t699 + 0.12174239044817386831275720164609053497942386831276e3 * t316 * t317 * t319 * t1330 - 0.33817330680048296753543667123914037494284407864655e3 * t614 * t165 * t617 * t1323 - 0.11191486625514403292181069958847736625514403292181e3 * t634 * t1323 * t299 * t40 + 0.19074696682424464050777743907602160917204355704584e4 * t1343 * t61 * t728 * t34 * t1140 * t1323 - 0.80578703703703703703703703703703703703703703703704e1 * t164 * t1316 - 0.20144675925925925925925925925925925925925925925926e1 * t164 * t165 * t52 * t940 + 0.16115740740740740740740740740740740740740740740742e3 * t297 * t699 * t1356 + 0.50e2 / 0.9e1 * t290 * t1361 - 0.22382973251028806584362139917695473251028806584361e2 * t634 * t1365 + 0.12174239044817386831275720164609053497942386831276e3 * t316 * t1365 + 0.12086805555555555555555555555555555555555555555556e3 * t297 * t1330 * t299 * t33 - 0.5e1 / 0.3e1 * t156 * t942 - 0.60434027777777777777777777777777777777777777777778e1 * t164 * t1361 + 0.36260416666666666666666666666666666666666666666667e3 * t297 * t300 * t274
  t1385 = t48 * t730 * t1323
  t1414 = t585 * t665
  t1430 = t61 * t1323
  t1441 = t690 * t643
  t1458 = t730 * t1323
  t1466 = t48 ** 2
  t1472 = 0.27053864544038637402834933699131229995427526291722e4 * t45 * t314 * t61 * t1385 + 0.12434985139460448102423411065386374028349336991312e2 * t1324 * t617 * t1326 * t33 - 0.68668908056728070582799878067367779301935680536505e4 * t727 * t1385 - 0.176e3 / 0.9e1 * t735 * t736 / t489 / t83 * t61 + 0.11415316358024691358024691358024691358024691358025e3 * t296 * t34 * t39 * s0 * t25 * t305 * t699 * t274 + 0.94688525904135230909922267946959304983996342021026e2 * t315 * t299 * t145 * t688 * t274 * t1155 - 0.2200e4 / 0.27e2 * t695 * t1414 + 0.88636574074074074074074074074074074074074074074070e2 * t325 * t1414 - 0.2618e4 / 0.81e2 * t170 * t30 * t937 * t61 + 0.1958e4 / 0.81e2 * t342 * t82 * t953 * t61 + 0.880e3 / 0.9e1 * t682 * t1164 * t684 + 0.38149393364848928101555487815204321834408711409166e4 * t1343 * t1430 * t299 * t728 * t690 - 0.40e2 / 0.3e1 * t682 * t683 * t61 * t274 + 0.73045434268904320987654320987654320987654320987656e3 * t315 * t665 * t1441 + 0.16232318726423182441700960219478737997256515775035e3 * t689 * t690 * t1356 - 0.13429783950617283950617283950617283950617283950617e3 * t1215 * t1441 - 0.47344262952067615454961133973479652491998171010514e3 * t613 * t1430 * t699 * t80 - 0.40580796816057956104252400548696844993141289437586e3 * t613 * t688 * t714 * t1319 + 0.19074696682424464050777743907602160917204355704585e4 * t1343 * t1144 * t1458 * t40 + 0.69165644949499541000788881814961585575821210632978e4 * t47 / t56 / t723 / t55 * t61 * t1466 * t1458 * t80
  t1478 = t941 * t65 / 0.3e1 - 0.4e1 / 0.3e1 * t506 * t176 + 0.4e1 * t275 * t284 - 0.2e1 * t275 * t351 - 0.8e1 * t148 * t578 + 0.8e1 * t157 * t582 - 0.4e1 / 0.3e1 * t148 * t745 + 0.8e1 * t35 * t39 / t574 / t63 * t1105 - 0.12e2 * t43 * t575 * t283 * t350 + 0.2e1 * t35 * t282 * t1113 + 0.8e1 / 0.3e1 * t43 * t581 * t744 - t35 * t152 * (t1212 + t1306 + t1381 + t1472) / 0.3e1
  t1482 = 0.1e1 / t182 / t71
  t1483 = t1482 * t1078
  t1486 = t768 * t265 * t354
  t1488 = t358 * t1083
  t1490 = t781 * t748
  t1492 = t183 * t1478
  t1495 = (0.120e3 * t768 * t1078 + 0.18e2 * t183 * t1083 - 0.2e1 * t72 * t1478 + 0.24e2 * t184 * t748 - 0.144e3 * t359 * t354 + 0.1080e4 * t1483 - 0.1080e4 * t1486 + 0.108e3 * t1488 + 0.144e3 * t1490 - 0.9e1 * t1492) * t77
  t1503 = t443 ** 2
  t1510 = t375 * t748 * t179
  t1516 = t477 ** 2
  t1533 = -0.3888e4 * t866 * t1072 + 0.24e2 * t1075 * t193 + t1495 * t107 + 0.72e2 * t366 * t486 - 0.4959e4 / 0.10000e5 * t109 / t232 / t869 / t132 * t1503 + 0.162e3 * t373 * t376 * t1083 + 0.216e3 * t866 * t1510 - 0.27e2 / 0.50e2 * t435 * t441 * t443 - 0.27e2 / 0.100e3 * t442 * t1516 + 0.513e3 / 0.500e3 * t872 * t443 * t477 + 0.72e2 * t788 * t381 - 0.2592e4 * t373 * t223 * t560 * t562 + 0.2e1 / 0.5e1 * t813 * t233 * t256 - 0.288e3 * t366 * t879
  t1542 = 0.1e1 / t374 / t357
  t1560 = 0.1e1 / t374 / t69
  t1575 = t74 / t371 / t76
  t1576 = t374 ** 2
  t1577 = 0.1e1 / t1576
  t1584 = -0.9e1 / 0.25e2 * t442 * t256 * t541 + 0.6e1 * t191 * t192 * t1478 - 0.15552e5 * t757 * t107 * t1542 * t1078 - 0.27e2 / 0.25e2 * t551 * t548 + 0.36e2 * t788 * t388 - 0.144e3 * t191 * t424 * t358 * t265 + 0.324e3 * t373 * t424 * t375 * t265 + 0.6912e4 * t373 * t107 * t1560 * t1078 + 0.648e3 * t556 * t545 - 0.144e3 * t788 * t385 + 0.480e3 * t191 * t223 * t768 * t562 + 0.9720e4 * t1575 * t107 * t1577 * t1078 + 0.72e2 * t366 * t752
  t1599 = t363 * t372
  t1626 = 0.15552e5 * t757 * t1542 * t1078 - 0.6912e4 * t373 * t1560 * t1078 - 0.9720e4 * t1575 * t1577 * t1078 - 0.162e3 * t373 * t375 * t1083 + 0.3888e4 * t373 * t1072 - 0.24e2 * t1075 * t184 - 0.6e1 * t191 * t1492 - 0.216e3 * t373 * t1510 + 0.2592e4 * t556 * t800 - 0.648e3 * t556 * t804 - t1495
  t1651 = -0.3888e4 * t757 * t1060 + 0.720e3 * t191 * t1483 - 0.720e3 * t191 * t1486 + 0.72e2 * t191 * t1488 + 0.96e2 * t191 * t1490 - 0.324e3 * t1599 * t428 + 0.144e3 * t788 * t359 - 0.36e2 * t788 * t361 - 0.480e3 * t366 * t779 + 0.288e3 * t366 * t782 - 0.24e2 * t366 * t784 - 0.2592e4 * t912 * t797
  t1671 = -0.720e3 * t191 * t107 * t1482 * t1078 - 0.72e2 * t191 * t384 * t1083 + 0.36e2 * t191 * t485 * t354 - 0.96e2 * t861 * t1490 + 0.720e3 * t861 * t1486 + 0.324e3 * t1599 * t377 + (t1626 + t1651) * t133 + 0.480e3 * t366 * t770 + 0.171e3 / 0.250e3 * t227 * t871 * t873 + 0.24e2 * t191 * t380 * t748 - 0.288e3 * t191 * t223 * t782 + 0.4e1 * t187 * t857 + 0.6e1 * t364 * t424 + 0.3e1 / 0.5e1 * t882 * t477
  t1678 = f.my_piecewise3(t2, 0, 0.10e2 / 0.27e2 * t6 * t17 * t144 * t135 - 0.5e1 / 0.9e1 * t6 * t23 * t259 + t6 * t139 * t480 / 0.2e1 - t6 * t264 * t889 / 0.2e1 - 0.3e1 / 0.8e1 * t6 * t484 * (t1070 + t1533 + t1584 + t1671))
  v4rho4_0_ = 0.2e1 * r0 * t1678 + 0.8e1 * t894

  res = {'v4rho4': v4rho4_0_}
  return res

def pol_kxc(p, r, s=None, l=None, tau=None):
  f = funcs(p)
  params = f.params
  (r0, r1) = r
  s0 = s[0] if s is not None else None
  s1 = s[1] if s is not None else None
  s2 = s[2] if s is not None else None
  l0 = l[0] if l is not None else None
  l1 = l[1] if l is not None else None
  tau0 = tau[0] if tau is not None else None
  tau1 = tau[1] if tau is not None else None

  t1 = r0 <= f.p.dens_threshold
  t2 = 3 ** (0.1e1 / 0.3e1)
  t3 = jnp.pi ** (0.1e1 / 0.3e1)
  t5 = t2 / t3
  t6 = r0 + r1
  t7 = 0.1e1 / t6
  t10 = 0.2e1 * r0 * t7 <= f.p.zeta_threshold
  t11 = f.p.zeta_threshold - 0.1e1
  t14 = 0.2e1 * r1 * t7 <= f.p.zeta_threshold
  t15 = -t11
  t16 = r0 - r1
  t17 = t16 * t7
  t18 = f.my_piecewise5(t10, t11, t14, t15, t17)
  t19 = 0.1e1 + t18
  t20 = t19 <= f.p.zeta_threshold
  t21 = t19 ** (0.1e1 / 0.3e1)
  t22 = t21 ** 2
  t23 = 0.1e1 / t22
  t24 = t6 ** 2
  t25 = 0.1e1 / t24
  t27 = -t16 * t25 + t7
  t28 = f.my_piecewise5(t10, 0, t14, 0, t27)
  t29 = t28 ** 2
  t33 = 0.1e1 / t24 / t6
  t36 = 0.2e1 * t16 * t33 - 0.2e1 * t25
  t37 = f.my_piecewise5(t10, 0, t14, 0, t36)
  t41 = f.my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t23 * t29 + 0.4e1 / 0.3e1 * t21 * t37)
  t42 = t6 ** (0.1e1 / 0.3e1)
  t43 = t41 * t42
  t44 = r0 ** (0.1e1 / 0.3e1)
  t45 = t44 ** 2
  t48 = tau0 / t45 / r0
  t49 = r0 ** 2
  t51 = 0.1e1 / t45 / t49
  t52 = s0 * t51
  t54 = t48 - t52 / 0.8e1
  t55 = 6 ** (0.1e1 / 0.3e1)
  t56 = t54 * t55
  t57 = jnp.pi ** 2
  t58 = t57 ** (0.1e1 / 0.3e1)
  t59 = t58 ** 2
  t60 = 0.1e1 / t59
  t61 = t55 * t60
  t62 = t61 * t52
  t64 = t56 * t60
  t66 = 0.1e1 - 0.5e1 / 0.9e1 * t64
  t67 = t66 ** 2
  t68 = t67 * t66
  t69 = t54 ** 2
  t70 = t55 ** 2
  t71 = t69 * t70
  t73 = 0.1e1 / t58 / t57
  t76 = 0.1e1 + 0.67148919753086419753086419753086419753086419753086e0 * t71 * t73
  t77 = jnp.sqrt(t76)
  t79 = 0.1e1 / t77 / t76
  t80 = t68 * t79
  t82 = jnp.exp(-t62 / 0.8e1)
  t84 = t62 / 0.24e2 + t80 * t82
  t86 = t60 / t84
  t89 = 0.1e1 + t56 * t86 / 0.3e1
  t90 = t89 ** 2
  t93 = 0.1e1 / t90 / t89
  t95 = 0.1e1 / t90 + 0.3e1 * t93
  t96 = 0.1e1 + t93
  t97 = t96 ** 2
  t98 = 0.1e1 / t97
  t99 = t95 * t98
  t101 = t70 * t73
  t102 = s0 ** 2
  t103 = t49 ** 2
  t104 = t103 * r0
  t110 = 0.1e1 + 0.15045488888888888888888888888888888888888888888889e0 * t62 + 0.26899490462262948000000000000000000000000000000000e-2 * t101 * t102 / t44 / t104
  t111 = t110 ** (0.1e1 / 0.5e1)
  t116 = 0.25633760400000000000000000000000000000000000000000e0 * t70 * t59
  t122 = 0.1e1 + 0.63943327777777777777777777777777777777777777777778e-1 * t62 - 0.5e1 / 0.9e1 * (0.14554132000000000000000000000000000000000000000000e0 * t48 + t116 + 0.11867481666666666666666666666666666666666666666667e-1 * t52) * t55 * t60
  t123 = t111 ** 2
  t124 = 0.1e1 / t123
  t127 = 0.1e1 / t111 + 0.7e1 / 0.9e1 * t122 * t124
  t129 = 0.1e1 - t99
  t132 = (0.10e2 / 0.81e2 + 0.25e2 / 0.8748e4 * t62) * t55
  t133 = t60 * s0
  t139 = t64 / 0.4e1 - 0.9e1 / 0.20e2 + t62 / 0.36e2
  t140 = t139 ** 2
  t144 = 0.1e1 / tau0
  t146 = s0 / r0 * t144 / 0.8e1
  t147 = t146 < 0.10e1
  t148 = f.my_piecewise3(t147, t146, 0.10e1)
  t149 = t139 * t148
  t150 = 0.1e1 - t148
  t153 = 0.1e1 + 0.5e1 / 0.12e2 * t132 * t133 * t51 + 0.292e3 / 0.405e3 * t140 - 0.146e3 / 0.135e3 * t149 * t150
  t154 = t153 ** (0.1e1 / 0.10e2)
  t156 = t99 * t127 + t129 * t154
  t162 = f.my_piecewise3(t20, 0, 0.4e1 / 0.3e1 * t21 * t28)
  t163 = t42 ** 2
  t164 = 0.1e1 / t163
  t165 = t162 * t164
  t169 = t162 * t42
  t170 = tau0 * t51
  t172 = t49 * r0
  t174 = 0.1e1 / t45 / t172
  t175 = s0 * t174
  t177 = -0.5e1 / 0.3e1 * t170 + t175 / 0.3e1
  t178 = t177 * t55
  t180 = t84 ** 2
  t182 = t60 / t180
  t183 = t61 * t175
  t185 = t67 * t79
  t186 = t185 * t82
  t187 = t178 * t60
  t190 = t76 ** 2
  t192 = 0.1e1 / t77 / t190
  t193 = t68 * t192
  t194 = t193 * t82
  t195 = t54 * t70
  t200 = t80 * t55
  t201 = t174 * t82
  t205 = -t183 / 0.9e1 - 0.5e1 / 0.3e1 * t186 * t187 - 0.20144675925925925925925925925925925925925925925926e1 * t194 * t195 * t73 * t177 + t200 * t133 * t201 / 0.3e1
  t206 = t182 * t205
  t209 = t178 * t86 / 0.3e1 - t56 * t206 / 0.3e1
  t212 = t90 ** 2
  t213 = 0.1e1 / t212
  t214 = t213 * t209
  t216 = -0.2e1 * t93 * t209 - 0.9e1 * t214
  t217 = t216 * t98
  t220 = 0.1e1 / t97 / t96
  t221 = t95 * t220
  t222 = t127 * t213
  t223 = t222 * t209
  t227 = 0.1e1 / t111 / t110
  t233 = t101 * t102 / t44 / t103 / t49
  t235 = -0.40121303703703703703703703703703703703703703703704e0 * t183 - 0.14346394913206905600000000000000000000000000000000e-1 * t233
  t245 = -0.17051554074074074074074074074074074074074074074074e0 * t183 - 0.5e1 / 0.9e1 * (-0.24256886666666666666666666666666666666666666666667e0 * t170 - 0.31646617777777777777777777777777777777777777777779e-1 * t175) * t55 * t60
  t249 = 0.1e1 / t123 / t110
  t250 = t122 * t249
  t253 = -t227 * t235 / 0.5e1 + 0.7e1 / 0.9e1 * t245 * t124 - 0.14e2 / 0.45e2 * t250 * t235
  t257 = -0.6e1 * t221 * t214 - t217
  t259 = t154 ** 2
  t260 = t259 ** 2
  t261 = t260 ** 2
  t262 = t261 * t154
  t263 = 0.1e1 / t262
  t264 = t129 * t263
  t271 = t187 / 0.4e1 - 0.2e1 / 0.27e2 * t183
  t274 = t271 * t148
  t281 = f.my_piecewise3(t147, -s0 / t49 * t144 / 0.8e1, 0)
  t287 = -0.125e3 / 0.39366e5 * t233 - 0.10e2 / 0.9e1 * t132 * t133 * t174 + 0.584e3 / 0.405e3 * t139 * t271 - 0.146e3 / 0.135e3 * t274 * t150 - 0.146e3 / 0.135e3 * t139 * t281 * t150 + 0.146e3 / 0.135e3 * t149 * t281
  t290 = t217 * t127 + 0.6e1 * t221 * t223 + t99 * t253 + t257 * t154 + t264 * t287 / 0.10e2
  t294 = f.p.zeta_threshold ** (0.1e1 / 0.3e1)
  t295 = t294 * f.p.zeta_threshold
  t297 = f.my_piecewise3(t20, t295, t21 * t19)
  t299 = 0.1e1 / t163 / t6
  t300 = t297 * t299
  t304 = t297 * t164
  t308 = t297 * t42
  t309 = t209 ** 2
  t312 = tau0 * t174
  t315 = 0.1e1 / t45 / t103
  t316 = s0 * t315
  t318 = 0.40e2 / 0.9e1 * t312 - 0.11e2 / 0.9e1 * t316
  t319 = t318 * t55
  t325 = 0.1e1 / t180 / t84
  t327 = t205 ** 2
  t328 = t60 * t325 * t327
  t331 = t61 * t316
  t333 = t66 * t79
  t334 = t333 * t82
  t335 = t177 ** 2
  t337 = t335 * t70 * t73
  t340 = t67 * t192
  t341 = t340 * t82
  t342 = t57 ** 2
  t343 = 0.1e1 / t342
  t345 = t335 * t343 * t54
  t348 = t185 * t101
  t349 = t82 * t177
  t353 = t319 * t60
  t358 = 0.1e1 / t77 / t190 / t76
  t359 = t68 * t358
  t360 = t359 * t82
  t363 = 0.1e1 / t59 / t342
  t368 = t343 * s0
  t369 = t193 * t368
  t370 = t54 * t177
  t376 = t73 * t318
  t380 = t315 * t82
  t384 = t80 * t70
  t385 = t73 * t102
  t388 = 0.1e1 / t44 / t103 / t172
  t393 = 0.11e2 / 0.27e2 * t331 + 0.50e2 / 0.27e2 * t334 * t337 + 0.40289351851851851851851851851851851851851851851851e2 * t341 * t345 - 0.10e2 / 0.9e1 * t348 * t175 * t349 - 0.5e1 / 0.3e1 * t186 * t353 + 0.40580796816057956104252400548696844993141289437586e2 * t360 * t69 * t55 * t363 * t335 - 0.80578703703703703703703703703703703703703703703702e1 * t369 * t201 * t370 - 0.20144675925925925925925925925925925925925925925926e1 * t194 * t337 - 0.20144675925925925925925925925925925925925925925926e1 * t194 * t195 * t376 - 0.11e2 / 0.9e1 * t200 * t133 * t380 + t384 * t385 * t388 * t82 / 0.9e1
  t394 = t182 * t393
  t397 = t319 * t86 / 0.3e1 - 0.2e1 / 0.3e1 * t178 * t206 + 0.2e1 / 0.3e1 * t56 * t328 - t56 * t394 / 0.3e1
  t401 = 0.1e1 / t212 / t89
  t402 = t401 * t309
  t404 = t213 * t397
  t406 = 0.6e1 * t213 * t309 - 0.2e1 * t93 * t397 + 0.36e2 * t402 - 0.9e1 * t404
  t407 = t406 * t98
  t409 = t216 * t220
  t414 = t97 ** 2
  t415 = 0.1e1 / t414
  t416 = t95 * t415
  t417 = t212 ** 2
  t418 = 0.1e1 / t417
  t420 = t127 * t418 * t309
  t423 = t253 * t213
  t424 = t423 * t209
  t428 = t127 * t401 * t309
  t431 = t222 * t397
  t434 = t110 ** 2
  t436 = 0.1e1 / t111 / t434
  t437 = t235 ** 2
  t441 = t102 * t388
  t442 = t101 * t441
  t444 = 0.14711144691358024691358024691358024691358024691358e1 * t331 + 0.90860501116977068800000000000000000000000000000000e-1 * t442
  t454 = 0.62522364938271604938271604938271604938271604938271e0 * t331 - 0.5e1 / 0.9e1 * (0.64685031111111111111111111111111111111111111111112e0 * t312 + 0.11603759851851851851851851851851851851851851851852e0 * t316) * t55 * t60
  t457 = t245 * t249
  t461 = 0.1e1 / t123 / t434
  t462 = t122 * t461
  t467 = 0.6e1 / 0.25e2 * t436 * t437 - t227 * t444 / 0.5e1 + 0.7e1 / 0.9e1 * t454 * t124 - 0.28e2 / 0.45e2 * t457 * t235 + 0.98e2 / 0.225e3 * t462 * t437 - 0.14e2 / 0.45e2 * t250 * t444
  t471 = t418 * t309
  t478 = -0.12e2 * t409 * t214 + 0.24e2 * t221 * t402 - 0.6e1 * t221 * t404 - 0.54e2 * t416 * t471 - t407
  t480 = t257 * t263
  t484 = 0.1e1 / t262 / t153
  t485 = t129 * t484
  t486 = t287 ** 2
  t493 = t271 ** 2
  t497 = t353 / 0.4e1 + 0.22e2 / 0.81e2 * t331
  t500 = t497 * t148
  t512 = f.my_piecewise3(t147, s0 / t172 * t144 / 0.4e1, 0)
  t513 = t139 * t512
  t516 = t281 ** 2
  t521 = 0.125e3 / 0.4374e4 * t442 + 0.110e3 / 0.27e2 * t132 * t133 * t315 + 0.584e3 / 0.405e3 * t493 + 0.584e3 / 0.405e3 * t139 * t497 - 0.146e3 / 0.135e3 * t500 * t150 - 0.292e3 / 0.135e3 * t271 * t281 * t150 + 0.292e3 / 0.135e3 * t274 * t281 - 0.146e3 / 0.135e3 * t513 * t150 + 0.292e3 / 0.135e3 * t139 * t516 + 0.146e3 / 0.135e3 * t149 * t512
  t524 = t407 * t127 + 0.12e2 * t409 * t223 + 0.2e1 * t217 * t253 + 0.54e2 * t416 * t420 + 0.12e2 * t221 * t424 - 0.24e2 * t221 * t428 + 0.6e1 * t221 * t431 + t99 * t467 + t478 * t154 + t480 * t287 / 0.5e1 - 0.9e1 / 0.100e3 * t485 * t486 + t264 * t521 / 0.10e2
  t529 = f.my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t43 * t156 - t5 * t165 * t156 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t169 * t290 + t5 * t300 * t156 / 0.12e2 - t5 * t304 * t290 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t308 * t524)
  t531 = r1 <= f.p.dens_threshold
  t532 = f.my_piecewise5(t14, t11, t10, t15, -t17)
  t533 = 0.1e1 + t532
  t534 = t533 <= f.p.zeta_threshold
  t535 = t533 ** (0.1e1 / 0.3e1)
  t536 = t535 ** 2
  t537 = 0.1e1 / t536
  t539 = f.my_piecewise5(t14, 0, t10, 0, -t27)
  t540 = t539 ** 2
  t544 = f.my_piecewise5(t14, 0, t10, 0, -t36)
  t548 = f.my_piecewise3(t534, 0, 0.4e1 / 0.9e1 * t537 * t540 + 0.4e1 / 0.3e1 * t535 * t544)
  t550 = r1 ** (0.1e1 / 0.3e1)
  t551 = t550 ** 2
  t554 = tau1 / t551 / r1
  t555 = r1 ** 2
  t557 = 0.1e1 / t551 / t555
  t558 = s2 * t557
  t560 = t554 - t558 / 0.8e1
  t561 = t560 * t55
  t562 = t61 * t558
  t564 = t561 * t60
  t566 = 0.1e1 - 0.5e1 / 0.9e1 * t564
  t567 = t566 ** 2
  t569 = t560 ** 2
  t573 = 0.1e1 + 0.67148919753086419753086419753086419753086419753086e0 * t569 * t70 * t73
  t574 = jnp.sqrt(t573)
  t579 = jnp.exp(-t562 / 0.8e1)
  t586 = 0.1e1 + t561 * t60 / (t562 / 0.24e2 + t567 * t566 / t574 / t573 * t579) / 0.3e1
  t587 = t586 ** 2
  t590 = 0.1e1 / t587 / t586
  t594 = (0.1e1 + t590) ** 2
  t596 = (0.1e1 / t587 + 0.3e1 * t590) / t594
  t598 = s2 ** 2
  t599 = t555 ** 2
  t607 = (0.1e1 + 0.15045488888888888888888888888888888888888888888889e0 * t562 + 0.26899490462262948000000000000000000000000000000000e-2 * t101 * t598 / t550 / t599 / r1) ** (0.1e1 / 0.5e1)
  t617 = t607 ** 2
  t633 = t564 / 0.4e1 - 0.9e1 / 0.20e2 + t562 / 0.36e2
  t634 = t633 ** 2
  t640 = s2 / r1 / tau1 / 0.8e1
  t642 = f.my_piecewise3(t640 < 0.10e1, t640, 0.10e1)
  t648 = (0.1e1 + 0.5e1 / 0.12e2 * (0.10e2 / 0.81e2 + 0.25e2 / 0.8748e4 * t562) * t55 * t60 * s2 * t557 + 0.292e3 / 0.405e3 * t634 - 0.146e3 / 0.135e3 * t633 * t642 * (0.1e1 - t642)) ** (0.1e1 / 0.10e2)
  t650 = t596 * (0.1e1 / t607 + 0.7e1 / 0.9e1 * (0.1e1 + 0.63943327777777777777777777777777777777777777777778e-1 * t562 - 0.5e1 / 0.9e1 * (0.14554132000000000000000000000000000000000000000000e0 * t554 + t116 + 0.11867481666666666666666666666666666666666666666667e-1 * t558) * t55 * t60) / t617) + (0.1e1 - t596) * t648
  t656 = f.my_piecewise3(t534, 0, 0.4e1 / 0.3e1 * t535 * t539)
  t662 = f.my_piecewise3(t534, t295, t535 * t533)
  t668 = f.my_piecewise3(t531, 0, -0.3e1 / 0.8e1 * t5 * t548 * t42 * t650 - t5 * t656 * t164 * t650 / 0.4e1 + t5 * t662 * t299 * t650 / 0.12e2)
  t678 = t24 ** 2
  t682 = 0.6e1 * t33 - 0.6e1 * t16 / t678
  t683 = f.my_piecewise5(t10, 0, t14, 0, t682)
  t687 = f.my_piecewise3(t20, 0, -0.8e1 / 0.27e2 / t22 / t19 * t29 * t28 + 0.4e1 / 0.3e1 * t23 * t28 * t37 + 0.4e1 / 0.3e1 * t21 * t683)
  t710 = 0.1e1 / t163 / t24
  t723 = t401 * t209 * t397
  t728 = t418 * t209 * t397
  t734 = t153 ** 2
  t741 = t309 * t209
  t746 = tau0 * t315
  t749 = 0.1e1 / t45 / t104
  t750 = s0 * t749
  t752 = -0.440e3 / 0.27e2 * t746 + 0.154e3 / 0.27e2 * t750
  t753 = t752 * t55
  t760 = t180 ** 2
  t771 = t55 * t363
  t773 = t82 * t335
  t780 = 0.1e1 / t58 / t342 / t57
  t783 = t82 * t69
  t790 = t82 * t54 * t177
  t794 = t335 * t177
  t795 = t82 * t794
  t799 = t61 * t750
  t807 = t103 ** 2
  t814 = t753 * t60
  t817 = t190 ** 2
  t823 = t342 ** 2
  t830 = t56 * t363 * t794
  t834 = t175 * t773
  t845 = t67 * t358
  t852 = t177 * t70 * t376
  t855 = 0.13429783950617283950617283950617283950617283950617e2 * t340 * t771 * t175 * t773 * t54 + 0.13526932272019318701417466849565614997713763145862e2 * t359 * t70 * t780 * t175 * t783 * t335 - 0.13429783950617283950617283950617283950617283950617e1 * t193 * t771 * t441 * t790 + 0.60434027777777777777777777777777777777777777777777e2 * t340 * t795 * t343 - 0.154e3 / 0.81e2 * t799 - 0.500e3 / 0.81e2 * t794 * t343 * t79 * t82 + 0.2e1 / 0.9e1 * t80 * t343 * t102 * s0 / t807 / t172 * t82 - 0.5e1 / 0.3e1 * t186 * t814 - 0.11444818009454678430466646344561296550322613422751e4 * t68 / t77 / t817 * t82 * t69 * t54 / t823 * t794 + 0.12174239044817386831275720164609053497942386831276e3 * t360 * t830 - 0.12086805555555555555555555555555555555555555555555e2 * t193 * t343 * t834 + 0.154e3 / 0.27e2 * t200 * t133 * t749 * t82 - 0.10e2 / 0.3e1 * t185 * t343 * t441 * t349 - 0.67634661360096593507087334247828074988568815729310e2 * t845 * t82 * t71 * t780 * t794 - 0.60434027777777777777777777777777777777777777777778e1 * t194 * t852
  t861 = 0.1e1 / t44 / t807
  t868 = t66 * t192
  t876 = t54 * t318
  t924 = -0.20144675925925925925925925925925925925925925925926e1 * t194 * t195 * t73 * t752 - 0.11e2 / 0.9e1 * t384 * t385 * t861 * t82 + 0.50e2 / 0.9e1 * t334 * t852 - 0.22382973251028806584362139917695473251028806584361e2 * t868 * t82 * t830 + 0.100e3 / 0.9e1 * t333 * t343 * t834 + 0.12086805555555555555555555555555555555555555555556e3 * t341 * t177 * t343 * t876 - 0.26859567901234567901234567901234567901234567901234e1 * t193 * t343 * t102 * t388 * t61 * t790 + 0.26859567901234567901234567901234567901234567901234e2 * t340 * t61 * s0 * t201 * t345 + 0.27053864544038637402834933699131229995427526291722e2 * t359 * t368 * t174 * t783 * t337 + 0.44318287037037037037037037037037037037037037037035e2 * t369 * t380 * t370 + 0.12174239044817386831275720164609053497942386831276e3 * t359 * t783 * t771 * t177 * t318 - 0.12086805555555555555555555555555555555555555555555e2 * t369 * t201 * t876 - 0.44765946502057613168724279835390946502057613168723e2 * t868 * t795 * t343 * t54 * t61 - 0.13526932272019318701417466849565614997713763145861e3 * t845 * t795 * t343 * t69 * t101 - 0.5e1 / 0.3e1 * t348 * t175 * t82 * t318 + 0.55e2 / 0.9e1 * t348 * t316 * t349
  t929 = t753 * t86 / 0.3e1 - t319 * t206 + 0.2e1 * t178 * t328 - t178 * t394 - 0.2e1 * t56 * t60 / t760 * t327 * t205 + 0.2e1 * t64 * t325 * t205 * t393 - t56 * t182 * (t855 + t924) / 0.3e1
  t933 = 0.1e1 / t212 / t90
  t934 = t933 * t741
  t937 = t213 * t929
  t940 = (0.18e2 * t214 * t397 - 0.24e2 * t401 * t741 - 0.2e1 * t93 * t929 + 0.108e3 * t723 - 0.180e3 * t934 - 0.9e1 * t937) * t98
  t941 = t406 * t220
  t944 = t216 * t415
  t953 = t95 / t414 / t96
  t955 = 0.1e1 / t417 / t212
  t960 = 0.1e1 / t417 / t89
  t972 = 0.648e3 * t416 * t960 * t741 - 0.648e3 * t953 * t955 * t741 - 0.18e2 * t941 * t214 + 0.72e2 * t221 * t723 - 0.120e3 * t221 * t934 - 0.6e1 * t221 * t937 + 0.72e2 * t409 * t402 - 0.18e2 * t409 * t404 - 0.162e3 * t416 * t728 - 0.162e3 * t944 * t471 - t940
  t982 = t434 * t110
  t985 = t437 * t235
  t993 = t101 * t102 * t861
  t995 = -0.68652008559670781893004115226337448559670781893004e1 * t799 - 0.66631034152449850453333333333333333333333333333333e0 * t993
  t1038 = -0.72e2 * t221 * t127 * t723 + 0.162e3 * t416 * t127 * t728 - 0.27e2 / 0.100e3 * t257 * t484 * t486 + 0.171e3 / 0.1000e4 * t129 / t262 / t734 * t486 * t287 + t972 * t154 + 0.3e1 * t217 * t467 + 0.3e1 * t407 * t253 + t940 * t127 + 0.3e1 / 0.10e2 * t478 * t263 * t287 + t99 * (-0.66e2 / 0.125e3 / t111 / t982 * t985 + 0.18e2 / 0.25e2 * t436 * t235 * t444 - t227 * t995 / 0.5e1 + 0.7e1 / 0.9e1 * (-0.29177103637860082304526748971193415637860082304526e1 * t799 - 0.5e1 / 0.9e1 * (-0.23717844740740740740740740740740740740740740740741e1 * t746 - 0.54150879308641975308641975308641975308641975308643e0 * t750) * t55 * t60) * t124 - 0.14e2 / 0.15e2 * t454 * t249 * t235 + 0.98e2 / 0.75e2 * t245 * t461 * t437 - 0.14e2 / 0.15e2 * t457 * t444 - 0.392e3 / 0.375e3 * t122 / t123 / t982 * t985 + 0.98e2 / 0.75e2 * t462 * t235 * t444 - 0.14e2 / 0.45e2 * t250 * t995) + 0.162e3 * t416 * t253 * t418 * t309 - 0.72e2 * t409 * t428 - 0.72e2 * t221 * t253 * t401 * t309
  t1082 = t814 / 0.4e1 - 0.308e3 / 0.243e3 * t799
  t1104 = f.my_piecewise3(t147, -0.3e1 / 0.4e1 * s0 / t103 * t144, 0)
  t1112 = -0.42625e5 / 0.177147e6 * t993 - 0.1540e4 / 0.81e2 * t132 * t133 * t749 + 0.584e3 / 0.135e3 * t271 * t497 + 0.584e3 / 0.405e3 * t139 * t1082 - 0.146e3 / 0.135e3 * t1082 * t148 * t150 - 0.146e3 / 0.45e2 * t497 * t281 * t150 + 0.146e3 / 0.45e2 * t500 * t281 - 0.146e3 / 0.45e2 * t271 * t512 * t150 + 0.292e3 / 0.45e2 * t271 * t516 + 0.146e3 / 0.45e2 * t274 * t512 - 0.146e3 / 0.135e3 * t139 * t1104 * t150 + 0.292e3 / 0.45e2 * t513 * t281 + 0.146e3 / 0.135e3 * t149 * t1104
  t1115 = -0.648e3 * t416 * t127 * t960 * t741 + 0.18e2 * t941 * t223 + 0.162e3 * t944 * t420 + 0.648e3 * t953 * t127 * t955 * t741 + 0.18e2 * t221 * t423 * t397 + 0.6e1 * t221 * t222 * t929 + 0.18e2 * t221 * t467 * t213 * t209 + 0.18e2 * t409 * t431 + 0.120e3 * t221 * t127 * t933 * t741 + 0.36e2 * t409 * t424 - 0.27e2 / 0.100e3 * t485 * t287 * t521 + 0.3e1 / 0.10e2 * t480 * t521 + t264 * t1112 / 0.10e2
  t1121 = f.my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t687 * t42 * t156 - 0.3e1 / 0.8e1 * t5 * t41 * t164 * t156 - 0.9e1 / 0.8e1 * t5 * t43 * t290 + t5 * t162 * t299 * t156 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t165 * t290 - 0.9e1 / 0.8e1 * t5 * t169 * t524 - 0.5e1 / 0.36e2 * t5 * t297 * t710 * t156 + t5 * t300 * t290 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t304 * t524 - 0.3e1 / 0.8e1 * t5 * t308 * (t1038 + t1115))
  t1131 = f.my_piecewise5(t14, 0, t10, 0, -t682)
  t1135 = f.my_piecewise3(t534, 0, -0.8e1 / 0.27e2 / t536 / t533 * t540 * t539 + 0.4e1 / 0.3e1 * t537 * t539 * t544 + 0.4e1 / 0.3e1 * t535 * t1131)
  t1153 = f.my_piecewise3(t531, 0, -0.3e1 / 0.8e1 * t5 * t1135 * t42 * t650 - 0.3e1 / 0.8e1 * t5 * t548 * t164 * t650 + t5 * t656 * t299 * t650 / 0.4e1 - 0.5e1 / 0.36e2 * t5 * t662 * t710 * t650)
  d111 = 0.3e1 * t529 + 0.3e1 * t668 + t6 * (t1121 + t1153)

  res = {'v3rho3': d111}
  return res

def pol_lxc(p, r, s=None, l=None, tau=None):
  f = funcs(p)
  params = f.params
  (r0, r1) = r
  s0 = s[0] if s is not None else None
  s1 = s[1] if s is not None else None
  s2 = s[2] if s is not None else None
  l0 = l[0] if l is not None else None
  l1 = l[1] if l is not None else None
  tau0 = tau[0] if tau is not None else None
  tau1 = tau[1] if tau is not None else None

  t1 = r0 <= f.p.dens_threshold
  t2 = 3 ** (0.1e1 / 0.3e1)
  t3 = jnp.pi ** (0.1e1 / 0.3e1)
  t5 = t2 / t3
  t6 = r0 + r1
  t7 = 0.1e1 / t6
  t10 = 0.2e1 * r0 * t7 <= f.p.zeta_threshold
  t11 = f.p.zeta_threshold - 0.1e1
  t14 = 0.2e1 * r1 * t7 <= f.p.zeta_threshold
  t15 = -t11
  t16 = r0 - r1
  t17 = t16 * t7
  t18 = f.my_piecewise5(t10, t11, t14, t15, t17)
  t19 = 0.1e1 + t18
  t20 = t19 <= f.p.zeta_threshold
  t21 = t19 ** (0.1e1 / 0.3e1)
  t22 = t21 ** 2
  t24 = 0.1e1 / t22 / t19
  t25 = t6 ** 2
  t26 = 0.1e1 / t25
  t28 = -t16 * t26 + t7
  t29 = f.my_piecewise5(t10, 0, t14, 0, t28)
  t30 = t29 ** 2
  t34 = 0.1e1 / t22
  t35 = t34 * t29
  t36 = t25 * t6
  t37 = 0.1e1 / t36
  t40 = 0.2e1 * t16 * t37 - 0.2e1 * t26
  t41 = f.my_piecewise5(t10, 0, t14, 0, t40)
  t44 = t25 ** 2
  t45 = 0.1e1 / t44
  t48 = -0.6e1 * t16 * t45 + 0.6e1 * t37
  t49 = f.my_piecewise5(t10, 0, t14, 0, t48)
  t53 = f.my_piecewise3(t20, 0, -0.8e1 / 0.27e2 * t24 * t30 * t29 + 0.4e1 / 0.3e1 * t35 * t41 + 0.4e1 / 0.3e1 * t21 * t49)
  t54 = t6 ** (0.1e1 / 0.3e1)
  t55 = t53 * t54
  t56 = r0 ** (0.1e1 / 0.3e1)
  t57 = t56 ** 2
  t60 = tau0 / t57 / r0
  t61 = r0 ** 2
  t63 = 0.1e1 / t57 / t61
  t64 = s0 * t63
  t66 = t60 - t64 / 0.8e1
  t67 = 6 ** (0.1e1 / 0.3e1)
  t68 = t66 * t67
  t69 = jnp.pi ** 2
  t70 = t69 ** (0.1e1 / 0.3e1)
  t71 = t70 ** 2
  t72 = 0.1e1 / t71
  t73 = t67 * t72
  t74 = t73 * t64
  t76 = t68 * t72
  t78 = 0.1e1 - 0.5e1 / 0.9e1 * t76
  t79 = t78 ** 2
  t80 = t79 * t78
  t81 = t66 ** 2
  t82 = t67 ** 2
  t83 = t81 * t82
  t85 = 0.1e1 / t70 / t69
  t88 = 0.1e1 + 0.67148919753086419753086419753086419753086419753086e0 * t83 * t85
  t89 = jnp.sqrt(t88)
  t91 = 0.1e1 / t89 / t88
  t92 = t80 * t91
  t94 = jnp.exp(-t74 / 0.8e1)
  t96 = t74 / 0.24e2 + t92 * t94
  t98 = t72 / t96
  t101 = 0.1e1 + t68 * t98 / 0.3e1
  t102 = t101 ** 2
  t104 = t102 * t101
  t105 = 0.1e1 / t104
  t107 = 0.1e1 / t102 + 0.3e1 * t105
  t108 = 0.1e1 + t105
  t109 = t108 ** 2
  t110 = 0.1e1 / t109
  t111 = t107 * t110
  t113 = t82 * t85
  t114 = s0 ** 2
  t115 = t61 ** 2
  t116 = t115 * r0
  t122 = 0.1e1 + 0.15045488888888888888888888888888888888888888888889e0 * t74 + 0.26899490462262948000000000000000000000000000000000e-2 * t113 * t114 / t56 / t116
  t123 = t122 ** (0.1e1 / 0.5e1)
  t128 = 0.25633760400000000000000000000000000000000000000000e0 * t82 * t71
  t134 = 0.1e1 + 0.63943327777777777777777777777777777777777777777778e-1 * t74 - 0.5e1 / 0.9e1 * (0.14554132000000000000000000000000000000000000000000e0 * t60 + t128 + 0.11867481666666666666666666666666666666666666666667e-1 * t64) * t67 * t72
  t135 = t123 ** 2
  t136 = 0.1e1 / t135
  t139 = 0.1e1 / t123 + 0.7e1 / 0.9e1 * t134 * t136
  t141 = 0.1e1 - t111
  t144 = (0.10e2 / 0.81e2 + 0.25e2 / 0.8748e4 * t74) * t67
  t145 = t72 * s0
  t151 = t76 / 0.4e1 - 0.9e1 / 0.20e2 + t74 / 0.36e2
  t152 = t151 ** 2
  t156 = 0.1e1 / tau0
  t158 = s0 / r0 * t156 / 0.8e1
  t159 = t158 < 0.10e1
  t160 = f.my_piecewise3(t159, t158, 0.10e1)
  t161 = t151 * t160
  t162 = 0.1e1 - t160
  t165 = 0.1e1 + 0.5e1 / 0.12e2 * t144 * t145 * t63 + 0.292e3 / 0.405e3 * t152 - 0.146e3 / 0.135e3 * t161 * t162
  t166 = t165 ** (0.1e1 / 0.10e2)
  t168 = t111 * t139 + t141 * t166
  t177 = f.my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t34 * t30 + 0.4e1 / 0.3e1 * t21 * t41)
  t178 = t54 ** 2
  t179 = 0.1e1 / t178
  t180 = t177 * t179
  t184 = t177 * t54
  t185 = tau0 * t63
  t187 = t61 * r0
  t189 = 0.1e1 / t57 / t187
  t190 = s0 * t189
  t192 = -0.5e1 / 0.3e1 * t185 + t190 / 0.3e1
  t193 = t192 * t67
  t195 = t96 ** 2
  t197 = t72 / t195
  t198 = t73 * t190
  t200 = t79 * t91
  t201 = t200 * t94
  t202 = t193 * t72
  t205 = t88 ** 2
  t207 = 0.1e1 / t89 / t205
  t208 = t80 * t207
  t209 = t208 * t94
  t210 = t66 * t82
  t215 = t92 * t67
  t216 = t189 * t94
  t220 = -t198 / 0.9e1 - 0.5e1 / 0.3e1 * t201 * t202 - 0.20144675925925925925925925925925925925925925925926e1 * t209 * t210 * t85 * t192 + t215 * t145 * t216 / 0.3e1
  t221 = t197 * t220
  t224 = t193 * t98 / 0.3e1 - t68 * t221 / 0.3e1
  t227 = t102 ** 2
  t228 = 0.1e1 / t227
  t229 = t228 * t224
  t231 = -0.2e1 * t105 * t224 - 0.9e1 * t229
  t232 = t231 * t110
  t235 = 0.1e1 / t109 / t108
  t236 = t107 * t235
  t237 = t139 * t228
  t238 = t237 * t224
  t242 = 0.1e1 / t123 / t122
  t244 = t115 * t61
  t248 = t113 * t114 / t56 / t244
  t250 = -0.40121303703703703703703703703703703703703703703704e0 * t198 - 0.14346394913206905600000000000000000000000000000000e-1 * t248
  t260 = -0.17051554074074074074074074074074074074074074074074e0 * t198 - 0.5e1 / 0.9e1 * (-0.24256886666666666666666666666666666666666666666667e0 * t185 - 0.31646617777777777777777777777777777777777777777779e-1 * t190) * t67 * t72
  t264 = 0.1e1 / t135 / t122
  t265 = t134 * t264
  t268 = -t242 * t250 / 0.5e1 + 0.7e1 / 0.9e1 * t260 * t136 - 0.14e2 / 0.45e2 * t265 * t250
  t272 = -0.6e1 * t236 * t229 - t232
  t274 = t166 ** 2
  t275 = t274 ** 2
  t276 = t275 ** 2
  t277 = t276 * t166
  t278 = 0.1e1 / t277
  t279 = t141 * t278
  t286 = t202 / 0.4e1 - 0.2e1 / 0.27e2 * t198
  t289 = t286 * t160
  t296 = f.my_piecewise3(t159, -s0 / t61 * t156 / 0.8e1, 0)
  t302 = -0.125e3 / 0.39366e5 * t248 - 0.10e2 / 0.9e1 * t144 * t145 * t189 + 0.584e3 / 0.405e3 * t151 * t286 - 0.146e3 / 0.135e3 * t289 * t162 - 0.146e3 / 0.135e3 * t151 * t296 * t162 + 0.146e3 / 0.135e3 * t161 * t296
  t305 = t232 * t139 + 0.6e1 * t236 * t238 + t111 * t268 + t272 * t166 + t279 * t302 / 0.10e2
  t311 = f.my_piecewise3(t20, 0, 0.4e1 / 0.3e1 * t21 * t29)
  t313 = 0.1e1 / t178 / t6
  t314 = t311 * t313
  t318 = t311 * t179
  t322 = t311 * t54
  t323 = t224 ** 2
  t326 = tau0 * t189
  t329 = 0.1e1 / t57 / t115
  t330 = s0 * t329
  t332 = 0.40e2 / 0.9e1 * t326 - 0.11e2 / 0.9e1 * t330
  t333 = t332 * t67
  t339 = 0.1e1 / t195 / t96
  t340 = t72 * t339
  t341 = t220 ** 2
  t342 = t340 * t341
  t345 = t73 * t330
  t347 = t78 * t91
  t348 = t347 * t94
  t349 = t192 ** 2
  t351 = t349 * t82 * t85
  t354 = t79 * t207
  t355 = t354 * t94
  t356 = t69 ** 2
  t357 = 0.1e1 / t356
  t358 = t349 * t357
  t359 = t358 * t66
  t362 = t200 * t113
  t363 = t94 * t192
  t367 = t333 * t72
  t372 = 0.1e1 / t89 / t205 / t88
  t373 = t80 * t372
  t374 = t373 * t94
  t375 = t81 * t67
  t377 = 0.1e1 / t71 / t356
  t382 = t357 * s0
  t383 = t208 * t382
  t384 = t66 * t192
  t390 = t85 * t332
  t394 = t329 * t94
  t398 = t92 * t82
  t399 = t85 * t114
  t402 = 0.1e1 / t56 / t115 / t187
  t403 = t402 * t94
  t407 = 0.11e2 / 0.27e2 * t345 + 0.50e2 / 0.27e2 * t348 * t351 + 0.40289351851851851851851851851851851851851851851851e2 * t355 * t359 - 0.10e2 / 0.9e1 * t362 * t190 * t363 - 0.5e1 / 0.3e1 * t201 * t367 + 0.40580796816057956104252400548696844993141289437586e2 * t374 * t375 * t377 * t349 - 0.80578703703703703703703703703703703703703703703702e1 * t383 * t216 * t384 - 0.20144675925925925925925925925925925925925925925926e1 * t209 * t351 - 0.20144675925925925925925925925925925925925925925926e1 * t209 * t210 * t390 - 0.11e2 / 0.9e1 * t215 * t145 * t394 + t398 * t399 * t403 / 0.9e1
  t408 = t197 * t407
  t411 = t333 * t98 / 0.3e1 - 0.2e1 / 0.3e1 * t193 * t221 + 0.2e1 / 0.3e1 * t68 * t342 - t68 * t408 / 0.3e1
  t414 = t227 * t101
  t415 = 0.1e1 / t414
  t416 = t415 * t323
  t418 = t228 * t411
  t420 = -0.2e1 * t105 * t411 + 0.6e1 * t228 * t323 + 0.36e2 * t416 - 0.9e1 * t418
  t421 = t420 * t110
  t423 = t231 * t235
  t428 = t109 ** 2
  t429 = 0.1e1 / t428
  t430 = t107 * t429
  t431 = t227 ** 2
  t432 = 0.1e1 / t431
  t433 = t139 * t432
  t434 = t433 * t323
  t437 = t268 * t228
  t438 = t437 * t224
  t441 = t139 * t415
  t442 = t441 * t323
  t445 = t237 * t411
  t448 = t122 ** 2
  t450 = 0.1e1 / t123 / t448
  t451 = t250 ** 2
  t455 = t114 * t402
  t456 = t113 * t455
  t458 = 0.14711144691358024691358024691358024691358024691358e1 * t345 + 0.90860501116977068800000000000000000000000000000000e-1 * t456
  t468 = 0.62522364938271604938271604938271604938271604938271e0 * t345 - 0.5e1 / 0.9e1 * (0.64685031111111111111111111111111111111111111111112e0 * t326 + 0.11603759851851851851851851851851851851851851851852e0 * t330) * t67 * t72
  t471 = t260 * t264
  t475 = 0.1e1 / t135 / t448
  t476 = t134 * t475
  t481 = 0.6e1 / 0.25e2 * t450 * t451 - t242 * t458 / 0.5e1 + 0.7e1 / 0.9e1 * t468 * t136 - 0.28e2 / 0.45e2 * t471 * t250 + 0.98e2 / 0.225e3 * t476 * t451 - 0.14e2 / 0.45e2 * t265 * t458
  t485 = t432 * t323
  t492 = -0.12e2 * t423 * t229 + 0.24e2 * t236 * t416 - 0.6e1 * t236 * t418 - 0.54e2 * t430 * t485 - t421
  t494 = t272 * t278
  t498 = 0.1e1 / t277 / t165
  t499 = t141 * t498
  t500 = t302 ** 2
  t507 = t286 ** 2
  t511 = t367 / 0.4e1 + 0.22e2 / 0.81e2 * t345
  t514 = t511 * t160
  t526 = f.my_piecewise3(t159, s0 / t187 * t156 / 0.4e1, 0)
  t527 = t151 * t526
  t530 = t296 ** 2
  t535 = 0.125e3 / 0.4374e4 * t456 + 0.110e3 / 0.27e2 * t144 * t145 * t329 + 0.584e3 / 0.405e3 * t507 + 0.584e3 / 0.405e3 * t151 * t511 - 0.146e3 / 0.135e3 * t514 * t162 - 0.292e3 / 0.135e3 * t286 * t296 * t162 + 0.292e3 / 0.135e3 * t289 * t296 - 0.146e3 / 0.135e3 * t527 * t162 + 0.292e3 / 0.135e3 * t151 * t530 + 0.146e3 / 0.135e3 * t161 * t526
  t538 = t421 * t139 + 0.12e2 * t423 * t238 + 0.2e1 * t232 * t268 + 0.54e2 * t430 * t434 + 0.12e2 * t236 * t438 - 0.24e2 * t236 * t442 + 0.6e1 * t236 * t445 + t111 * t481 + t492 * t166 + t494 * t302 / 0.5e1 - 0.9e1 / 0.100e3 * t499 * t500 + t279 * t535 / 0.10e2
  t542 = f.p.zeta_threshold ** (0.1e1 / 0.3e1)
  t543 = t542 * f.p.zeta_threshold
  t545 = f.my_piecewise3(t20, t543, t21 * t19)
  t547 = 0.1e1 / t178 / t25
  t548 = t545 * t547
  t552 = t545 * t313
  t556 = t545 * t179
  t560 = t545 * t54
  t561 = t115 ** 2
  t563 = 0.1e1 / t56 / t561
  t564 = t114 * t563
  t565 = t113 * t564
  t568 = 0.1e1 / t57 / t116
  t574 = tau0 * t329
  t576 = s0 * t568
  t578 = -0.440e3 / 0.27e2 * t574 + 0.154e3 / 0.27e2 * t576
  t579 = t578 * t67
  t580 = t579 * t72
  t582 = t73 * t576
  t584 = t580 / 0.4e1 - 0.308e3 / 0.243e3 * t582
  t587 = t584 * t160
  t595 = t286 * t526
  t606 = f.my_piecewise3(t159, -0.3e1 / 0.4e1 * s0 / t115 * t156, 0)
  t607 = t151 * t606
  t614 = -0.42625e5 / 0.177147e6 * t565 - 0.1540e4 / 0.81e2 * t144 * t145 * t568 + 0.584e3 / 0.135e3 * t286 * t511 + 0.584e3 / 0.405e3 * t151 * t584 - 0.146e3 / 0.135e3 * t587 * t162 - 0.146e3 / 0.45e2 * t511 * t296 * t162 + 0.146e3 / 0.45e2 * t514 * t296 - 0.146e3 / 0.45e2 * t595 * t162 + 0.292e3 / 0.45e2 * t286 * t530 + 0.146e3 / 0.45e2 * t289 * t526 - 0.146e3 / 0.135e3 * t607 * t162 + 0.292e3 / 0.45e2 * t527 * t296 + 0.146e3 / 0.135e3 * t161 * t606
  t618 = 0.1e1 / t227 / t102
  t620 = t323 * t224
  t621 = t139 * t618 * t620
  t624 = t236 * t139
  t625 = t415 * t224
  t626 = t625 * t411
  t629 = t430 * t139
  t630 = t432 * t224
  t631 = t630 * t411
  t636 = t492 * t278
  t640 = 0.1e1 / t431 / t101
  t642 = t139 * t640 * t620
  t648 = t268 * t432 * t323
  t653 = t448 * t122
  t655 = 0.1e1 / t123 / t653
  t656 = t451 * t250
  t659 = t450 * t250
  t664 = -0.68652008559670781893004115226337448559670781893004e1 * t582 - 0.66631034152449850453333333333333333333333333333333e0 * t565
  t674 = -0.29177103637860082304526748971193415637860082304526e1 * t582 - 0.5e1 / 0.9e1 * (-0.23717844740740740740740740740740740740740740740741e1 * t574 - 0.54150879308641975308641975308641975308641975308643e0 * t576) * t67 * t72
  t677 = t468 * t264
  t680 = t260 * t475
  t686 = 0.1e1 / t135 / t653
  t687 = t134 * t686
  t690 = t250 * t458
  t695 = -0.66e2 / 0.125e3 * t655 * t656 + 0.18e2 / 0.25e2 * t659 * t458 - t242 * t664 / 0.5e1 + 0.7e1 / 0.9e1 * t674 * t136 - 0.14e2 / 0.15e2 * t677 * t250 + 0.98e2 / 0.75e2 * t680 * t451 - 0.14e2 / 0.15e2 * t471 * t458 - 0.392e3 / 0.375e3 * t687 * t656 + 0.98e2 / 0.75e2 * t476 * t690 - 0.14e2 / 0.45e2 * t265 * t664
  t701 = t279 * t614 / 0.10e2 + 0.120e3 * t236 * t621 - 0.72e2 * t624 * t626 + 0.162e3 * t629 * t631 + 0.3e1 / 0.10e2 * t494 * t535 + 0.3e1 / 0.10e2 * t636 * t302 - 0.648e3 * t430 * t642 - 0.72e2 * t423 * t442 + 0.162e3 * t430 * t648 + 0.3e1 * t421 * t268 + t111 * t695 + 0.36e2 * t423 * t438 + 0.18e2 * t423 * t445
  t703 = t268 * t415 * t323
  t706 = t231 * t429
  t709 = t420 * t235
  t712 = t437 * t411
  t716 = 0.1e1 / t428 / t108
  t717 = t107 * t716
  t719 = 0.1e1 / t431 / t227
  t721 = t139 * t719 * t620
  t724 = t165 ** 2
  t726 = 0.1e1 / t277 / t724
  t727 = t141 * t726
  t728 = t500 * t302
  t741 = t195 ** 2
  t742 = 0.1e1 / t741
  t745 = t72 * t742 * t341 * t220
  t748 = t339 * t220
  t749 = t748 * t407
  t752 = t568 * t94
  t756 = t349 * t192
  t758 = t68 * t377 * t756
  t761 = t208 * t357
  t762 = t94 * t349
  t763 = t190 * t762
  t766 = t200 * t357
  t770 = t79 * t372
  t771 = t770 * t94
  t774 = 0.1e1 / t70 / t356 / t69
  t779 = t192 * t82
  t780 = t779 * t390
  t783 = t85 * t578
  t793 = t78 * t207
  t794 = t793 * t94
  t797 = t347 * t357
  t801 = t66 * t332
  t805 = t94 * t756
  t810 = t756 * t357
  t811 = t91 * t94
  t814 = 0.154e3 / 0.27e2 * t215 * t145 * t752 + 0.12174239044817386831275720164609053497942386831276e3 * t374 * t758 - 0.12086805555555555555555555555555555555555555555555e2 * t761 * t763 - 0.10e2 / 0.3e1 * t766 * t455 * t363 - 0.67634661360096593507087334247828074988568815729310e2 * t771 * t83 * t774 * t756 - 0.60434027777777777777777777777777777777777777777778e1 * t209 * t780 - 0.20144675925925925925925925925925925925925925925926e1 * t209 * t210 * t783 - 0.11e2 / 0.9e1 * t398 * t399 * t563 * t94 + 0.50e2 / 0.9e1 * t348 * t780 - 0.22382973251028806584362139917695473251028806584361e2 * t794 * t758 + 0.100e3 / 0.9e1 * t797 * t763 + 0.12086805555555555555555555555555555555555555555556e3 * t355 * t192 * t357 * t801 + 0.60434027777777777777777777777777777777777777777777e2 * t354 * t805 * t357 - 0.154e3 / 0.81e2 * t582 - 0.500e3 / 0.81e2 * t810 * t811
  t815 = t92 * t357
  t816 = t114 * s0
  t818 = 0.1e1 / t561 / t187
  t819 = t816 * t818
  t825 = t205 ** 2
  t827 = 0.1e1 / t89 / t825
  t828 = t80 * t827
  t829 = t828 * t94
  t830 = t81 * t66
  t831 = t356 ** 2
  t832 = 0.1e1 / t831
  t833 = t830 * t832
  t834 = t833 * t756
  t837 = t73 * s0
  t842 = t382 * t189
  t843 = t373 * t842
  t844 = t94 * t81
  t845 = t844 * t351
  t848 = t357 * t114
  t849 = t848 * t402
  t850 = t208 * t849
  t851 = t94 * t66
  t852 = t851 * t192
  t853 = t73 * t852
  t856 = t94 * t332
  t860 = t373 * t844
  t861 = t67 * t377
  t862 = t192 * t332
  t870 = t357 * t66
  t875 = t357 * t81
  t885 = t354 * t861
  t886 = t762 * t66
  t890 = t82 * t774
  t891 = t373 * t890
  t892 = t844 * t349
  t896 = t208 * t861
  t900 = 0.2e1 / 0.9e1 * t815 * t819 * t94 - 0.5e1 / 0.3e1 * t201 * t580 - 0.11444818009454678430466646344561296550322613422751e4 * t829 * t834 + 0.26859567901234567901234567901234567901234567901234e2 * t354 * t837 * t216 * t359 + 0.27053864544038637402834933699131229995427526291722e2 * t843 * t845 - 0.26859567901234567901234567901234567901234567901234e1 * t850 * t853 - 0.5e1 / 0.3e1 * t362 * t190 * t856 + 0.12174239044817386831275720164609053497942386831276e3 * t860 * t861 * t862 - 0.12086805555555555555555555555555555555555555555555e2 * t383 * t216 * t801 - 0.44765946502057613168724279835390946502057613168723e2 * t793 * t805 * t870 * t73 - 0.13526932272019318701417466849565614997713763145861e3 * t770 * t805 * t875 * t113 + 0.55e2 / 0.9e1 * t362 * t330 * t363 + 0.44318287037037037037037037037037037037037037037035e2 * t383 * t394 * t384 + 0.13429783950617283950617283950617283950617283950617e2 * t885 * t190 * t886 + 0.13526932272019318701417466849565614997713763145862e2 * t891 * t190 * t892 - 0.13429783950617283950617283950617283950617283950617e1 * t896 * t455 * t852
  t901 = t814 + t900
  t902 = t197 * t901
  t905 = t579 * t98 / 0.3e1 - t333 * t221 + 0.2e1 * t193 * t342 - t193 * t408 - 0.2e1 * t68 * t745 + 0.2e1 * t76 * t749 - t68 * t902 / 0.3e1
  t908 = t618 * t620
  t911 = t228 * t905
  t913 = -0.2e1 * t105 * t905 + 0.18e2 * t229 * t411 - 0.24e2 * t415 * t620 + 0.108e3 * t626 - 0.180e3 * t908 - 0.9e1 * t911
  t914 = t913 * t110
  t923 = t719 * t620
  t926 = t640 * t620
  t937 = -0.18e2 * t709 * t229 + 0.72e2 * t236 * t626 - 0.120e3 * t236 * t908 - 0.6e1 * t236 * t911 + 0.72e2 * t423 * t416 - 0.18e2 * t423 * t418 - 0.162e3 * t430 * t631 + 0.648e3 * t430 * t926 - 0.162e3 * t706 * t485 - 0.648e3 * t717 * t923 - t914
  t939 = t272 * t498
  t942 = t237 * t905
  t945 = t481 * t228
  t946 = t945 * t224
  t949 = t302 * t535
  t955 = -0.72e2 * t236 * t703 + 0.162e3 * t706 * t434 + 0.18e2 * t709 * t238 + 0.18e2 * t236 * t712 + 0.648e3 * t717 * t721 + 0.171e3 / 0.1000e4 * t727 * t728 + t937 * t166 - 0.27e2 / 0.100e3 * t939 * t500 + 0.6e1 * t236 * t942 + 0.18e2 * t236 * t946 - 0.27e2 / 0.100e3 * t499 * t949 + t914 * t139 + 0.3e1 * t232 * t481
  t956 = t701 + t955
  t961 = f.my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t55 * t168 - 0.3e1 / 0.8e1 * t5 * t180 * t168 - 0.9e1 / 0.8e1 * t5 * t184 * t305 + t5 * t314 * t168 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t318 * t305 - 0.9e1 / 0.8e1 * t5 * t322 * t538 - 0.5e1 / 0.36e2 * t5 * t548 * t168 + t5 * t552 * t305 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t556 * t538 - 0.3e1 / 0.8e1 * t5 * t560 * t956)
  t963 = r1 <= f.p.dens_threshold
  t964 = f.my_piecewise5(t14, t11, t10, t15, -t17)
  t965 = 0.1e1 + t964
  t966 = t965 <= f.p.zeta_threshold
  t967 = t965 ** (0.1e1 / 0.3e1)
  t968 = t967 ** 2
  t970 = 0.1e1 / t968 / t965
  t972 = f.my_piecewise5(t14, 0, t10, 0, -t28)
  t973 = t972 ** 2
  t977 = 0.1e1 / t968
  t978 = t977 * t972
  t980 = f.my_piecewise5(t14, 0, t10, 0, -t40)
  t984 = f.my_piecewise5(t14, 0, t10, 0, -t48)
  t988 = f.my_piecewise3(t966, 0, -0.8e1 / 0.27e2 * t970 * t973 * t972 + 0.4e1 / 0.3e1 * t978 * t980 + 0.4e1 / 0.3e1 * t967 * t984)
  t990 = r1 ** (0.1e1 / 0.3e1)
  t991 = t990 ** 2
  t994 = tau1 / t991 / r1
  t995 = r1 ** 2
  t997 = 0.1e1 / t991 / t995
  t998 = s2 * t997
  t1000 = t994 - t998 / 0.8e1
  t1001 = t1000 * t67
  t1002 = t73 * t998
  t1004 = t1001 * t72
  t1006 = 0.1e1 - 0.5e1 / 0.9e1 * t1004
  t1007 = t1006 ** 2
  t1009 = t1000 ** 2
  t1013 = 0.1e1 + 0.67148919753086419753086419753086419753086419753086e0 * t1009 * t82 * t85
  t1014 = jnp.sqrt(t1013)
  t1019 = jnp.exp(-t1002 / 0.8e1)
  t1026 = 0.1e1 + t1001 * t72 / (t1002 / 0.24e2 + t1007 * t1006 / t1014 / t1013 * t1019) / 0.3e1
  t1027 = t1026 ** 2
  t1030 = 0.1e1 / t1027 / t1026
  t1034 = (0.1e1 + t1030) ** 2
  t1036 = (0.1e1 / t1027 + 0.3e1 * t1030) / t1034
  t1038 = s2 ** 2
  t1039 = t995 ** 2
  t1047 = (0.1e1 + 0.15045488888888888888888888888888888888888888888889e0 * t1002 + 0.26899490462262948000000000000000000000000000000000e-2 * t113 * t1038 / t990 / t1039 / r1) ** (0.1e1 / 0.5e1)
  t1057 = t1047 ** 2
  t1073 = t1004 / 0.4e1 - 0.9e1 / 0.20e2 + t1002 / 0.36e2
  t1074 = t1073 ** 2
  t1080 = s2 / r1 / tau1 / 0.8e1
  t1082 = f.my_piecewise3(t1080 < 0.10e1, t1080, 0.10e1)
  t1088 = (0.1e1 + 0.5e1 / 0.12e2 * (0.10e2 / 0.81e2 + 0.25e2 / 0.8748e4 * t1002) * t67 * t72 * s2 * t997 + 0.292e3 / 0.405e3 * t1074 - 0.146e3 / 0.135e3 * t1073 * t1082 * (0.1e1 - t1082)) ** (0.1e1 / 0.10e2)
  t1090 = t1036 * (0.1e1 / t1047 + 0.7e1 / 0.9e1 * (0.1e1 + 0.63943327777777777777777777777777777777777777777778e-1 * t1002 - 0.5e1 / 0.9e1 * (0.14554132000000000000000000000000000000000000000000e0 * t994 + t128 + 0.11867481666666666666666666666666666666666666666667e-1 * t998) * t67 * t72) / t1057) + (0.1e1 - t1036) * t1088
  t1099 = f.my_piecewise3(t966, 0, 0.4e1 / 0.9e1 * t977 * t973 + 0.4e1 / 0.3e1 * t967 * t980)
  t1106 = f.my_piecewise3(t966, 0, 0.4e1 / 0.3e1 * t967 * t972)
  t1112 = f.my_piecewise3(t966, t543, t967 * t965)
  t1118 = f.my_piecewise3(t963, 0, -0.3e1 / 0.8e1 * t5 * t988 * t54 * t1090 - 0.3e1 / 0.8e1 * t5 * t1099 * t179 * t1090 + t5 * t1106 * t313 * t1090 / 0.4e1 - 0.5e1 / 0.36e2 * t5 * t1112 * t547 * t1090)
  t1131 = 0.1e1 / t178 / t36
  t1150 = t19 ** 2
  t1153 = t30 ** 2
  t1159 = t41 ** 2
  t1168 = -0.24e2 * t45 + 0.24e2 * t16 / t44 / t6
  t1169 = f.my_piecewise5(t10, 0, t14, 0, t1168)
  t1173 = f.my_piecewise3(t20, 0, 0.40e2 / 0.81e2 / t22 / t1150 * t1153 - 0.16e2 / 0.9e1 * t24 * t30 * t41 + 0.4e1 / 0.3e1 * t34 * t1159 + 0.16e2 / 0.9e1 * t35 * t49 + 0.4e1 / 0.3e1 * t21 * t1169)
  t1192 = t511 ** 2
  t1196 = tau0 * t568
  t1199 = 0.1e1 / t57 / t244
  t1200 = s0 * t1199
  t1202 = 0.6160e4 / 0.81e2 * t1196 - 0.2618e4 / 0.81e2 * t1200
  t1203 = t1202 * t67
  t1204 = t1203 * t72
  t1206 = t73 * t1200
  t1208 = t1204 / 0.4e1 + 0.5236e4 / 0.729e3 * t1206
  t1240 = f.my_piecewise3(t159, 0.3e1 * s0 / t116 * t156, 0)
  t1246 = t526 ** 2
  t1253 = 0.1e1 / t56 / t561 / r0
  t1255 = t113 * t114 * t1253
  t1257 = 0.584e3 / 0.135e3 * t1192 + 0.2336e4 / 0.405e3 * t286 * t584 + 0.584e3 / 0.405e3 * t151 * t1208 + 0.584e3 / 0.45e2 * t511 * t530 + 0.26180e5 / 0.243e3 * t144 * t145 * t1199 - 0.146e3 / 0.135e3 * t1208 * t160 * t162 - 0.584e3 / 0.135e3 * t584 * t296 * t162 + 0.584e3 / 0.135e3 * t587 * t296 - 0.292e3 / 0.45e2 * t511 * t526 * t162 + 0.292e3 / 0.45e2 * t514 * t526 - 0.584e3 / 0.135e3 * t286 * t606 * t162 + 0.1168e4 / 0.45e2 * t595 * t296 + 0.584e3 / 0.135e3 * t289 * t606 - 0.146e3 / 0.135e3 * t151 * t1240 * t162 + 0.1168e4 / 0.135e3 * t607 * t296 + 0.292e3 / 0.45e2 * t151 * t1246 + 0.146e3 / 0.135e3 * t161 * t1240 + 0.380875e6 / 0.177147e6 * t1255
  t1260 = t411 ** 2
  t1272 = 0.1e1 / t227 / t104
  t1274 = t323 ** 2
  t1283 = t719 * t323 * t411
  t1286 = t630 * t905
  t1299 = t420 * t429
  t1305 = t279 * t1257 / 0.10e2 - 0.72e2 * t236 * t441 * t1260 - 0.2592e4 * t430 * t268 * t640 * t620 + 0.24e2 * t236 * t437 * t905 - 0.720e3 * t236 * t139 * t1272 * t1274 - 0.288e3 * t236 * t268 * t626 + 0.3888e4 * t717 * t139 * t1283 + 0.216e3 * t629 * t1286 + 0.24e2 * t236 * t695 * t228 * t224 + 0.324e3 * t430 * t481 * t432 * t323 + 0.72e2 * t423 * t946 + 0.324e3 * t1299 * t434 - 0.9e1 / 0.25e2 * t499 * t614 * t302
  t1312 = t500 ** 2
  t1318 = t640 * t323 * t411
  t1333 = t535 ** 2
  t1364 = t341 ** 2
  t1372 = t407 ** 2
  t1386 = t382 * t329
  t1400 = t210 * t85
  t1408 = t851 * t332
  t1419 = t94 * t830
  t1420 = t756 * t67
  t1425 = t357 * t816
  t1441 = t332 ** 2
  t1446 = t349 ** 2
  t1448 = t1446 * t67 * t377
  t1452 = t1441 * t82 * t85
  t1461 = t1446 * t832
  t1462 = t1461 * t81
  t1470 = 0.67634661360096593507087334247828074988568815729311e2 * t373 * t890 * s0 * t216 * t81 * t192 * t332 - 0.17234889403292181069958847736625514403292181069958e3 * t354 * t1386 * t851 * t349 * t67 * t72 - 0.24799375832035417619265355890870294162475232434078e3 * t373 * t1386 * t845 + 0.34469778806584362139917695473251028806584362139916e2 * t208 * t848 * t563 * t853 + 0.94688525904135230909922267946959304983996342021026e2 * t843 * t805 * t1400 + 0.20144675925925925925925925925925925925925925925925e2 * t354 * t849 * t762 * t1400 - 0.67148919753086419753086419753086419753086419753084e1 * t850 * t73 * t1408 - 0.67148919753086419753086419753086419753086419753085e2 * t793 * t113 * s0 * t216 * t810 * t66 - 0.76298786729697856203110975630408643668817422818331e3 * t828 * t842 * t1419 * t1420 * t377 - 0.13429783950617283950617283950617283950617283950617e1 * t208 * t1425 * t818 * t113 * t852 - 0.38149393364848928101555487815204321834408711409170e3 * t828 * t837 * t216 * t834 + 0.47004243827160493827160493827160493827160493827159e2 * t354 * t861 * s0 * t216 * t384 * t332 + 0.12086805555555555555555555555555555555555555555556e3 * t355 * t1441 * t357 * t66 + 0.12174239044817386831275720164609053497942386831276e3 * t374 * t1448 - 0.60434027777777777777777777777777777777777777777778e1 * t209 * t1452 + 0.50e2 / 0.9e1 * t348 * t1452 - 0.22382973251028806584362139917695473251028806584361e2 * t794 * t1448 + 0.27053864544038637402834933699131229995427526291722e4 * t78 * t372 * t94 * t1462 - 0.5e1 / 0.3e1 * t201 * t1204 + 0.36260416666666666666666666666666666666666666666667e3 * t355 * t358 * t332
  t1477 = t1446 * t82
  t1479 = t207 * t94
  t1498 = t330 * t762
  t1522 = t79 * t827
  t1526 = 0.1e1 / t71 / t831
  t1531 = t779 * t783
  t1538 = t578 * t192
  t1551 = -0.44e2 / 0.9e1 * t815 * t816 / t561 / t115 * t94 + 0.12434985139460448102423411065386374028349336991312e2 * t1477 * t774 * t1479 * t66 - 0.68668908056728070582799878067367779301935680536505e4 * t829 * t1462 + 0.11415316358024691358024691358024691358024691358025e3 * t354 * t842 * t1408 * t202 + 0.94688525904135230909922267946959304983996342021026e2 * t843 * t844 * t332 * t113 * t192 + 0.37304955418381344307270233196159122085048010973936e2 * t1477 * t85 * t1479 * t870 - 0.2200e4 / 0.27e2 * t797 * t1498 + 0.12174239044817386831275720164609053497942386831276e3 * t374 * t375 * t377 * t1441 - 0.11191486625514403292181069958847736625514403292181e3 * t794 * t1446 * t357 * t73 + 0.88636574074074074074074074074074074074074074074070e2 * t761 * t1498 - 0.2618e4 / 0.81e2 * t215 * t145 * t1199 * t94 + 0.979e3 / 0.81e2 * t398 * t399 * t1253 * t94 + 0.440e3 / 0.9e1 * t766 * t564 * t363 + 0.19074696682424464050777743907602160917204355704584e4 * t1522 * t94 * t830 * t67 * t1526 * t1446 - 0.80578703703703703703703703703703703703703703703704e1 * t209 * t1531 - 0.20144675925925925925925925925925925925925925925926e1 * t209 * t210 * t85 * t1202 + 0.16115740740740740740740740740740740740740740740742e3 * t355 * t870 * t1538 + 0.200e3 / 0.27e2 * t348 * t1531 - 0.33817330680048296753543667123914037494284407864655e3 * t771 * t210 * t774 * t1446 - 0.20e2 / 0.3e1 * t766 * t455 * t856
  t1553 = t349 * t332
  t1574 = t190 * t851 * t756
  t1584 = t72 * t94
  t1586 = t402 * t67 * t1584 * t349
  t1598 = t793 * t762
  t1624 = t216 * t862
  t1631 = -0.68668908056728070582799878067367779301935680536505e4 * t829 * t833 * t1553 + 0.24621270576131687242798353909465020576131687242797e2 * t896 * t564 * t852 - 0.12310635288065843621399176954732510288065843621399e3 * t885 * t330 * t886 - 0.1000e4 / 0.27e2 * t358 * t811 * t332 + 0.67148919753086419753086419753086419753086419753085e1 * t354 * t890 * t455 * t886 - 0.49598751664070835238530711781740588324950464868161e2 * t891 * t330 * t892 + 0.67634661360096593507087334247828074988568815729311e2 * t891 * t1574 + 0.67148919753086419753086419753086419753086419753085e2 * t354 * t382 * t216 * t1420 * t72 - 0.67148919753086419753086419753086419753086419753084e1 * t208 * t848 * t1586 + 0.200e3 / 0.27e2 * t347 * t848 * t1586 - 0.40e2 / 0.27e2 * t200 * t1425 * t818 * t67 * t1584 * t192 - 0.26859567901234567901234567901234567901234567901235e3 * t1598 * t870 * t367 - 0.81161593632115912208504801097393689986282578875169e3 * t770 * t762 * t875 * t113 * t332 - 0.38149393364848928101555487815204321834408711409169e3 * t828 * t67 * t1526 * t190 * t1419 * t756 - 0.13429783950617283950617283950617283950617283950617e1 * t896 * t455 * t1408 - 0.44765946502057613168724279835390946502057613168723e0 * t208 * t890 * t819 * t852 - 0.22382973251028806584362139917695473251028806584361e2 * t793 * t890 * t1574 + 0.2618e4 / 0.243e3 * t1206 - 0.48347222222222222222222222222222222222222222222221e2 * t383 * t1624 - 0.16115740740740740740740740740740740740740740740740e2 * t383 * t216 * t66 * t578
  t1632 = t94 * t1446
  t1646 = t81 ** 2
  t1652 = t114 ** 2
  t1722 = 0.38149393364848928101555487815204321834408711409166e4 * t1522 * t1632 * t357 * t830 * t861 + 0.19074696682424464050777743907602160917204355704585e4 * t1522 * t1419 * t1461 * t73 + 0.69165644949499541000788881814961585575821210632978e4 * t80 / t89 / t825 / t88 * t94 * t1646 * t1461 * t113 + 0.2e1 / 0.27e2 * t92 * t357 * t1652 / t57 / t561 / t244 * t67 * t1584 - 0.13429783950617283950617283950617283950617283950617e3 * t1598 * t861 * t801 - 0.2000e4 / 0.243e3 * t1420 * t72 * t91 * t382 * t216 - 0.47344262952067615454961133973479652491998171010514e3 * t770 * t1632 * t870 * t113 - 0.3080e4 / 0.81e2 * t362 * t576 * t363 - 0.27575823045267489711934156378600823045267489711933e3 * t383 * t752 * t384 - 0.13429783950617283950617283950617283950617283950617e1 * t896 * t455 * t762 + 0.110e3 / 0.9e1 * t362 * t330 * t856 + 0.73045434268904320987654320987654320987654320987656e3 * t373 * t851 * t861 * t1553 + 0.88636574074074074074074074074074074074074074074070e2 * t383 * t394 * t801 + 0.13429783950617283950617283950617283950617283950617e2 * t885 * t190 * t805 - 0.16232318726423182441700960219478737997256515775034e4 * t770 * t832 * s0 * t216 * t756 * t81 + 0.16232318726423182441700960219478737997256515775034e3 * t373 * t832 * t114 * t403 * t81 * t349 - 0.20e2 / 0.9e1 * t362 * t190 * t94 * t578 + 0.400e3 / 0.9e1 * t347 * t382 * t1624 + 0.16232318726423182441700960219478737997256515775035e3 * t860 * t861 * t1538 - 0.40580796816057956104252400548696844993141289437586e3 * t770 * t844 * t890 * t1553
  t1728 = t1203 * t98 / 0.3e1 - 0.4e1 / 0.3e1 * t579 * t221 + 0.4e1 * t333 * t342 - 0.2e1 * t333 * t408 - 0.8e1 * t193 * t745 + 0.8e1 * t202 * t749 - 0.4e1 / 0.3e1 * t193 * t902 + 0.8e1 * t68 * t72 / t741 / t96 * t1364 - 0.12e2 * t76 * t742 * t341 * t407 + 0.2e1 * t68 * t340 * t1372 + 0.8e1 / 0.3e1 * t76 * t748 * t901 - t68 * t197 * (t1470 + t1551 + t1631 + t1722) / 0.3e1
  t1731 = t1272 * t1274
  t1734 = t618 * t323 * t411
  t1736 = t415 * t1260
  t1738 = t625 * t905
  t1740 = t228 * t1728
  t1743 = (-0.2e1 * t105 * t1728 + 0.18e2 * t228 * t1260 + 0.120e3 * t618 * t1274 + 0.24e2 * t229 * t905 - 0.144e3 * t416 * t411 + 0.1080e4 * t1731 - 0.1080e4 * t1734 + 0.108e3 * t1736 + 0.144e3 * t1738 - 0.9e1 * t1740) * t110
  t1751 = t458 ** 2
  t1759 = 0.38902804850480109739368998628257887517146776406036e2 * t1206 + 0.55525861793708208711111111111111111111111111111111e1 * t1255
  t1776 = t448 ** 2
  t1779 = t451 ** 2
  t1807 = -0.784e3 / 0.125e3 * t687 * t451 * t458 + 0.98e2 / 0.75e2 * t476 * t1751 + 0.392e3 / 0.225e3 * t476 * t250 * t664 - 0.14e2 / 0.45e2 * t265 * t1759 - 0.56e2 / 0.45e2 * t471 * t664 - 0.396e3 / 0.125e3 * t655 * t451 * t458 + 0.18e2 / 0.25e2 * t450 * t1751 + 0.24e2 / 0.25e2 * t659 * t664 - 0.56e2 / 0.45e2 * t674 * t264 * t250 - 0.28e2 / 0.15e2 * t677 * t458 + 0.1056e4 / 0.625e3 / t123 / t1776 * t1779 - t242 * t1759 / 0.5e1 + 0.7e1 / 0.9e1 * (0.16533692061454046639231824417009602194787379972565e2 * t1206 - 0.5e1 / 0.9e1 * (0.11068327545679012345679012345679012345679012345679e2 * t1196 + 0.30685498274897119341563786008230452674897119341564e1 * t1200) * t67 * t72) * t136 + 0.196e3 / 0.75e2 * t468 * t475 * t451 - 0.1568e4 / 0.375e3 * t260 * t686 * t656 + 0.392e3 / 0.75e2 * t680 * t690 + 0.6664e4 / 0.1875e4 * t134 / t135 / t1776 * t1779
  t1809 = 0.6e1 * t421 * t481 - 0.4959e4 / 0.10000e5 * t141 / t277 / t724 / t165 * t1312 + 0.4e1 * t914 * t268 - 0.3888e4 * t629 * t1318 + 0.648e3 * t706 * t139 * t631 - 0.2592e4 * t706 * t642 + 0.36e2 * t236 * t945 * t411 + 0.36e2 * t709 * t445 + 0.24e2 * t423 * t942 - 0.27e2 / 0.100e3 * t499 * t1333 + 0.171e3 / 0.250e3 * t272 * t726 * t728 + t1743 * t139 + 0.2e1 / 0.5e1 * t937 * t278 * t302 + t111 * t1807
  t1819 = t107 / t428 / t109
  t1820 = t431 ** 2
  t1821 = 0.1e1 / t1820
  t1835 = t231 * t716
  t1838 = -0.9720e4 * t1819 * t1821 * t1274 - 0.216e3 * t430 * t1286 - 0.324e3 * t1299 * t485 + 0.720e3 * t236 * t1731 - 0.720e3 * t236 * t1734 + 0.72e2 * t236 * t1736 + 0.96e2 * t236 * t1738 - 0.2592e4 * t1835 * t923 + 0.144e3 * t709 * t416 - 0.36e2 * t709 * t418 - t1743
  t1842 = 0.1e1 / t431 / t414
  t1858 = 0.1e1 / t431 / t102
  t1864 = t913 * t235
  t1871 = -0.162e3 * t430 * t432 * t1260 + 0.15552e5 * t717 * t1842 * t1274 - 0.6912e4 * t430 * t1858 * t1274 - 0.3888e4 * t717 * t1283 + 0.3888e4 * t430 * t1318 - 0.6e1 * t236 * t1740 - 0.24e2 * t1864 * t229 + 0.288e3 * t423 * t626 - 0.480e3 * t423 * t908 - 0.24e2 * t423 * t911 - 0.648e3 * t706 * t631 + 0.2592e4 * t706 * t926
  t1906 = (t1838 + t1871) * t166 - 0.15552e5 * t717 * t139 * t1842 * t1274 + 0.72e2 * t709 * t438 - 0.144e3 * t709 * t442 + 0.2592e4 * t717 * t268 * t719 * t620 + 0.6e1 * t236 * t237 * t1728 + 0.2592e4 * t1835 * t721 + 0.2e1 / 0.5e1 * t494 * t614 + 0.480e3 * t423 * t621 + 0.162e3 * t430 * t433 * t1260 + 0.24e2 * t1864 * t238 + 0.72e2 * t423 * t712 + 0.480e3 * t236 * t268 * t618 * t620
  t1945 = 0.648e3 * t706 * t648 - 0.144e3 * t236 * t481 * t415 * t323 + 0.6912e4 * t430 * t139 * t1858 * t1274 - 0.288e3 * t423 * t703 + 0.513e3 / 0.500e3 * t727 * t500 * t535 - 0.27e2 / 0.25e2 * t939 * t949 - 0.27e2 / 0.50e2 * t492 * t498 * t500 + 0.9720e4 * t1819 * t139 * t1821 * t1274 + 0.3e1 / 0.5e1 * t636 * t535 + 0.4e1 * t232 * t695 - 0.96e2 * t624 * t1738 + 0.720e3 * t624 * t1734 - 0.288e3 * t423 * t139 * t626 + 0.648e3 * t430 * t268 * t631
  t1951 = -0.3e1 / 0.2e1 * t5 * t322 * t956 - 0.3e1 / 0.2e1 * t5 * t180 * t305 - t5 * t53 * t179 * t168 / 0.2e1 + 0.10e2 / 0.27e2 * t5 * t545 * t1131 * t168 - t5 * t556 * t956 / 0.2e1 - 0.3e1 / 0.2e1 * t5 * t318 * t538 + t5 * t314 * t305 + t5 * t552 * t538 / 0.2e1 - 0.5e1 / 0.9e1 * t5 * t548 * t305 - 0.3e1 / 0.8e1 * t5 * t1173 * t54 * t168 - 0.3e1 / 0.2e1 * t5 * t55 * t305 + t5 * t177 * t313 * t168 / 0.2e1 - 0.9e1 / 0.4e1 * t5 * t184 * t538 - 0.5e1 / 0.9e1 * t5 * t311 * t547 * t168 - 0.3e1 / 0.8e1 * t5 * t560 * (t1305 + t1809 + t1906 + t1945)
  t1952 = f.my_piecewise3(t1, 0, t1951)
  t1953 = t965 ** 2
  t1956 = t973 ** 2
  t1962 = t980 ** 2
  t1968 = f.my_piecewise5(t14, 0, t10, 0, -t1168)
  t1972 = f.my_piecewise3(t966, 0, 0.40e2 / 0.81e2 / t968 / t1953 * t1956 - 0.16e2 / 0.9e1 * t970 * t973 * t980 + 0.4e1 / 0.3e1 * t977 * t1962 + 0.16e2 / 0.9e1 * t978 * t984 + 0.4e1 / 0.3e1 * t967 * t1968)
  t1994 = f.my_piecewise3(t963, 0, -0.3e1 / 0.8e1 * t5 * t1972 * t54 * t1090 - t5 * t988 * t179 * t1090 / 0.2e1 + t5 * t1099 * t313 * t1090 / 0.2e1 - 0.5e1 / 0.9e1 * t5 * t1106 * t547 * t1090 + 0.10e2 / 0.27e2 * t5 * t1112 * t1131 * t1090)
  d1111 = 0.4e1 * t961 + 0.4e1 * t1118 + t6 * (t1952 + t1994)

  res = {'v4rho4': d1111}
  return res

def pol_fxc(p, r, s=(None, None, None), l=(None, None), tau=(None, None)):
  f = funcs(p)
  params = f.params
  (r0, r1), (s0, s1, s2), (l0, l1), (tau0, tau1) = r, s, l, tau
  
  t1 = r0 <= f.p.dens_threshold
  t2 = 3 ** (0.1e1 / 0.3e1)
  t3 = jnp.pi ** (0.1e1 / 0.3e1)
  t5 = t2 / t3
  t6 = r0 + r1
  t7 = 0.1e1 / t6
  t10 = 0.2e1 * r0 * t7 <= f.p.zeta_threshold
  t11 = f.p.zeta_threshold - 0.1e1
  t14 = 0.2e1 * r1 * t7 <= f.p.zeta_threshold
  t15 = -t11
  t16 = r0 - r1
  t17 = t16 * t7
  t18 = f.my_piecewise5(t10, t11, t14, t15, t17)
  t19 = 0.1e1 + t18
  t20 = t19 <= f.p.zeta_threshold
  t21 = t19 ** (0.1e1 / 0.3e1)
  t22 = t6 ** 2
  t23 = 0.1e1 / t22
  t24 = t16 * t23
  t25 = t7 - t24
  t26 = f.my_piecewise5(t10, 0, t14, 0, t25)
  t29 = f.my_piecewise3(t20, 0, 0.4e1 / 0.3e1 * t21 * t26)
  t30 = t6 ** (0.1e1 / 0.3e1)
  t31 = t29 * t30
  t32 = r0 ** (0.1e1 / 0.3e1)
  t33 = t32 ** 2
  t36 = tau0 / t33 / r0
  t37 = r0 ** 2
  t39 = 0.1e1 / t33 / t37
  t40 = s0 * t39
  t42 = t36 - t40 / 0.8e1
  t43 = 6 ** (0.1e1 / 0.3e1)
  t44 = t42 * t43
  t45 = jnp.pi ** 2
  t46 = t45 ** (0.1e1 / 0.3e1)
  t47 = t46 ** 2
  t48 = 0.1e1 / t47
  t49 = t43 * t48
  t50 = t49 * t40
  t52 = t44 * t48
  t54 = 0.1e1 - 0.5e1 / 0.9e1 * t52
  t55 = t54 ** 2
  t56 = t55 * t54
  t57 = t42 ** 2
  t58 = t43 ** 2
  t61 = 0.1e1 / t46 / t45
  t64 = 0.1e1 + 0.67148919753086419753086419753086419753086419753086e0 * t57 * t58 * t61
  t65 = jnp.sqrt(t64)
  t67 = 0.1e1 / t65 / t64
  t68 = t56 * t67
  t70 = jnp.exp(-t50 / 0.8e1)
  t72 = t50 / 0.24e2 + t68 * t70
  t74 = t48 / t72
  t77 = 0.1e1 + t44 * t74 / 0.3e1
  t78 = t77 ** 2
  t81 = 0.1e1 / t78 / t77
  t83 = 0.1e1 / t78 + 0.3e1 * t81
  t84 = 0.1e1 + t81
  t85 = t84 ** 2
  t86 = 0.1e1 / t85
  t87 = t83 * t86
  t89 = t58 * t61
  t90 = s0 ** 2
  t91 = t37 ** 2
  t98 = 0.1e1 + 0.15045488888888888888888888888888888888888888888889e0 * t50 + 0.26899490462262948000000000000000000000000000000000e-2 * t89 * t90 / t32 / t91 / r0
  t99 = t98 ** (0.1e1 / 0.5e1)
  t104 = 0.25633760400000000000000000000000000000000000000000e0 * t58 * t47
  t110 = 0.1e1 + 0.63943327777777777777777777777777777777777777777778e-1 * t50 - 0.5e1 / 0.9e1 * (0.14554132000000000000000000000000000000000000000000e0 * t36 + t104 + 0.11867481666666666666666666666666666666666666666667e-1 * t40) * t43 * t48
  t111 = t99 ** 2
  t112 = 0.1e1 / t111
  t115 = 0.1e1 / t99 + 0.7e1 / 0.9e1 * t110 * t112
  t117 = 0.1e1 - t87
  t120 = (0.10e2 / 0.81e2 + 0.25e2 / 0.8748e4 * t50) * t43
  t121 = t48 * s0
  t127 = t52 / 0.4e1 - 0.9e1 / 0.20e2 + t50 / 0.36e2
  t128 = t127 ** 2
  t132 = 0.1e1 / tau0
  t134 = s0 / r0 * t132 / 0.8e1
  t135 = t134 < 0.10e1
  t136 = f.my_piecewise3(t135, t134, 0.10e1)
  t137 = t127 * t136
  t138 = 0.1e1 - t136
  t141 = 0.1e1 + 0.5e1 / 0.12e2 * t120 * t121 * t39 + 0.292e3 / 0.405e3 * t128 - 0.146e3 / 0.135e3 * t137 * t138
  t142 = t141 ** (0.1e1 / 0.10e2)
  t144 = t87 * t115 + t117 * t142
  t148 = f.p.zeta_threshold ** (0.1e1 / 0.3e1)
  t149 = t148 * f.p.zeta_threshold
  t151 = f.my_piecewise3(t20, t149, t21 * t19)
  t152 = t30 ** 2
  t153 = 0.1e1 / t152
  t154 = t151 * t153
  t157 = t5 * t154 * t144 / 0.8e1
  t158 = t151 * t30
  t159 = tau0 * t39
  t161 = t37 * r0
  t163 = 0.1e1 / t33 / t161
  t164 = s0 * t163
  t166 = -0.5e1 / 0.3e1 * t159 + t164 / 0.3e1
  t167 = t166 * t43
  t169 = t72 ** 2
  t171 = t48 / t169
  t172 = t49 * t164
  t174 = t55 * t67
  t175 = t174 * t70
  t176 = t167 * t48
  t179 = t64 ** 2
  t181 = 0.1e1 / t65 / t179
  t182 = t56 * t181
  t183 = t182 * t70
  t184 = t42 * t58
  t189 = t68 * t43
  t190 = t163 * t70
  t194 = -t172 / 0.9e1 - 0.5e1 / 0.3e1 * t175 * t176 - 0.20144675925925925925925925925925925925925925925926e1 * t183 * t184 * t61 * t166 + t189 * t121 * t190 / 0.3e1
  t195 = t171 * t194
  t198 = t167 * t74 / 0.3e1 - t44 * t195 / 0.3e1
  t201 = t78 ** 2
  t202 = 0.1e1 / t201
  t203 = t202 * t198
  t205 = -0.2e1 * t81 * t198 - 0.9e1 * t203
  t206 = t205 * t86
  t209 = 0.1e1 / t85 / t84
  t210 = t83 * t209
  t211 = t115 * t202
  t212 = t211 * t198
  t216 = 0.1e1 / t99 / t98
  t222 = t89 * t90 / t32 / t91 / t37
  t224 = -0.40121303703703703703703703703703703703703703703704e0 * t172 - 0.14346394913206905600000000000000000000000000000000e-1 * t222
  t234 = -0.17051554074074074074074074074074074074074074074074e0 * t172 - 0.5e1 / 0.9e1 * (-0.24256886666666666666666666666666666666666666666667e0 * t159 - 0.31646617777777777777777777777777777777777777777779e-1 * t164) * t43 * t48
  t238 = 0.1e1 / t111 / t98
  t239 = t110 * t238
  t242 = -t216 * t224 / 0.5e1 + 0.7e1 / 0.9e1 * t234 * t112 - 0.14e2 / 0.45e2 * t239 * t224
  t246 = -0.6e1 * t210 * t203 - t206
  t248 = t142 ** 2
  t249 = t248 ** 2
  t250 = t249 ** 2
  t251 = t250 * t142
  t252 = 0.1e1 / t251
  t253 = t117 * t252
  t260 = t176 / 0.4e1 - 0.2e1 / 0.27e2 * t172
  t263 = t260 * t136
  t270 = f.my_piecewise3(t135, -s0 / t37 * t132 / 0.8e1, 0)
  t276 = -0.125e3 / 0.39366e5 * t222 - 0.10e2 / 0.9e1 * t120 * t121 * t163 + 0.584e3 / 0.405e3 * t127 * t260 - 0.146e3 / 0.135e3 * t263 * t138 - 0.146e3 / 0.135e3 * t127 * t270 * t138 + 0.146e3 / 0.135e3 * t137 * t270
  t279 = t206 * t115 + 0.6e1 * t210 * t212 + t87 * t242 + t246 * t142 + t253 * t276 / 0.10e2
  t284 = f.my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t31 * t144 - t157 - 0.3e1 / 0.8e1 * t5 * t158 * t279)
  t286 = r1 <= f.p.dens_threshold
  t287 = f.my_piecewise5(t14, t11, t10, t15, -t17)
  t288 = 0.1e1 + t287
  t289 = t288 <= f.p.zeta_threshold
  t290 = t288 ** (0.1e1 / 0.3e1)
  t292 = f.my_piecewise5(t14, 0, t10, 0, -t25)
  t295 = f.my_piecewise3(t289, 0, 0.4e1 / 0.3e1 * t290 * t292)
  t296 = t295 * t30
  t297 = r1 ** (0.1e1 / 0.3e1)
  t298 = t297 ** 2
  t301 = tau1 / t298 / r1
  t302 = r1 ** 2
  t304 = 0.1e1 / t298 / t302
  t305 = s2 * t304
  t307 = t301 - t305 / 0.8e1
  t308 = t307 * t43
  t309 = t49 * t305
  t311 = t308 * t48
  t313 = 0.1e1 - 0.5e1 / 0.9e1 * t311
  t314 = t313 ** 2
  t315 = t314 * t313
  t316 = t307 ** 2
  t320 = 0.1e1 + 0.67148919753086419753086419753086419753086419753086e0 * t316 * t58 * t61
  t321 = jnp.sqrt(t320)
  t323 = 0.1e1 / t321 / t320
  t324 = t315 * t323
  t326 = jnp.exp(-t309 / 0.8e1)
  t328 = t309 / 0.24e2 + t324 * t326
  t330 = t48 / t328
  t333 = 0.1e1 + t308 * t330 / 0.3e1
  t334 = t333 ** 2
  t337 = 0.1e1 / t334 / t333
  t339 = 0.1e1 / t334 + 0.3e1 * t337
  t340 = 0.1e1 + t337
  t341 = t340 ** 2
  t342 = 0.1e1 / t341
  t343 = t339 * t342
  t345 = s2 ** 2
  t346 = t302 ** 2
  t353 = 0.1e1 + 0.15045488888888888888888888888888888888888888888889e0 * t309 + 0.26899490462262948000000000000000000000000000000000e-2 * t89 * t345 / t297 / t346 / r1
  t354 = t353 ** (0.1e1 / 0.5e1)
  t363 = 0.1e1 + 0.63943327777777777777777777777777777777777777777778e-1 * t309 - 0.5e1 / 0.9e1 * (0.14554132000000000000000000000000000000000000000000e0 * t301 + t104 + 0.11867481666666666666666666666666666666666666666667e-1 * t305) * t43 * t48
  t364 = t354 ** 2
  t365 = 0.1e1 / t364
  t368 = 0.1e1 / t354 + 0.7e1 / 0.9e1 * t363 * t365
  t370 = 0.1e1 - t343
  t373 = (0.10e2 / 0.81e2 + 0.25e2 / 0.8748e4 * t309) * t43
  t374 = t48 * s2
  t380 = t311 / 0.4e1 - 0.9e1 / 0.20e2 + t309 / 0.36e2
  t381 = t380 ** 2
  t385 = 0.1e1 / tau1
  t387 = s2 / r1 * t385 / 0.8e1
  t388 = t387 < 0.10e1
  t389 = f.my_piecewise3(t388, t387, 0.10e1)
  t390 = t380 * t389
  t391 = 0.1e1 - t389
  t394 = 0.1e1 + 0.5e1 / 0.12e2 * t373 * t374 * t304 + 0.292e3 / 0.405e3 * t381 - 0.146e3 / 0.135e3 * t390 * t391
  t395 = t394 ** (0.1e1 / 0.10e2)
  t397 = t343 * t368 + t370 * t395
  t402 = f.my_piecewise3(t289, t149, t290 * t288)
  t403 = t402 * t153
  t406 = t5 * t403 * t397 / 0.8e1
  t408 = f.my_piecewise3(t286, 0, -0.3e1 / 0.8e1 * t5 * t296 * t397 - t406)
  t410 = t21 ** 2
  t411 = 0.1e1 / t410
  t412 = t26 ** 2
  t417 = t16 / t22 / t6
  t419 = -0.2e1 * t23 + 0.2e1 * t417
  t420 = f.my_piecewise5(t10, 0, t14, 0, t419)
  t424 = f.my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t411 * t412 + 0.4e1 / 0.3e1 * t21 * t420)
  t431 = t5 * t29 * t153 * t144
  t437 = 0.1e1 / t152 / t6
  t441 = t5 * t151 * t437 * t144 / 0.12e2
  t443 = t5 * t154 * t279
  t445 = t198 ** 2
  t448 = tau0 * t163
  t451 = 0.1e1 / t33 / t91
  t452 = s0 * t451
  t454 = 0.40e2 / 0.9e1 * t448 - 0.11e2 / 0.9e1 * t452
  t455 = t454 * t43
  t463 = t194 ** 2
  t467 = t49 * t452
  t471 = t166 ** 2
  t473 = t471 * t58 * t61
  t478 = t45 ** 2
  t479 = 0.1e1 / t478
  t489 = t455 * t48
  t499 = 0.1e1 / t47 / t478
  t524 = 0.1e1 / t32 / t91 / t161
  t529 = 0.11e2 / 0.27e2 * t467 + 0.50e2 / 0.27e2 * t54 * t67 * t70 * t473 + 0.40289351851851851851851851851851851851851851851851e2 * t55 * t181 * t70 * t471 * t479 * t42 - 0.10e2 / 0.9e1 * t174 * t89 * t164 * t70 * t166 - 0.5e1 / 0.3e1 * t175 * t489 + 0.40580796816057956104252400548696844993141289437586e2 * t56 / t65 / t179 / t64 * t70 * t57 * t43 * t499 * t471 - 0.80578703703703703703703703703703703703703703703702e1 * t182 * t479 * s0 * t190 * t42 * t166 - 0.20144675925925925925925925925925925925925925925926e1 * t183 * t473 - 0.20144675925925925925925925925925925925925925925926e1 * t183 * t184 * t61 * t454 - 0.11e2 / 0.9e1 * t189 * t121 * t451 * t70 + t68 * t58 * t61 * t90 * t524 * t70 / 0.9e1
  t533 = t455 * t74 / 0.3e1 - 0.2e1 / 0.3e1 * t167 * t195 + 0.2e1 / 0.3e1 * t44 * t48 / t169 / t72 * t463 - t44 * t171 * t529 / 0.3e1
  t537 = 0.1e1 / t201 / t77
  t538 = t537 * t445
  t540 = t202 * t533
  t543 = (0.6e1 * t202 * t445 - 0.2e1 * t81 * t533 + 0.36e2 * t538 - 0.9e1 * t540) * t86
  t545 = t205 * t209
  t550 = t85 ** 2
  t552 = t83 / t550
  t553 = t201 ** 2
  t554 = 0.1e1 / t553
  t570 = t98 ** 2
  t573 = t224 ** 2
  t578 = t89 * t90 * t524
  t580 = 0.14711144691358024691358024691358024691358024691358e1 * t467 + 0.90860501116977068800000000000000000000000000000000e-1 * t578
  t622 = t276 ** 2
  t629 = t260 ** 2
  t633 = t489 / 0.4e1 + 0.22e2 / 0.81e2 * t467
  t648 = f.my_piecewise3(t135, s0 / t161 * t132 / 0.4e1, 0)
  t652 = t270 ** 2
  t660 = t543 * t115 + 0.12e2 * t545 * t212 + 0.2e1 * t206 * t242 + 0.54e2 * t552 * t115 * t554 * t445 + 0.12e2 * t210 * t242 * t202 * t198 - 0.24e2 * t210 * t115 * t537 * t445 + 0.6e1 * t210 * t211 * t533 + t87 * (0.6e1 / 0.25e2 / t99 / t570 * t573 - t216 * t580 / 0.5e1 + 0.7e1 / 0.9e1 * (0.62522364938271604938271604938271604938271604938271e0 * t467 - 0.5e1 / 0.9e1 * (0.64685031111111111111111111111111111111111111111112e0 * t448 + 0.11603759851851851851851851851851851851851851851852e0 * t452) * t43 * t48) * t112 - 0.28e2 / 0.45e2 * t234 * t238 * t224 + 0.98e2 / 0.225e3 * t110 / t111 / t570 * t573 - 0.14e2 / 0.45e2 * t239 * t580) + (-0.54e2 * t552 * t554 * t445 - 0.12e2 * t545 * t203 + 0.24e2 * t210 * t538 - 0.6e1 * t210 * t540 - t543) * t142 + t246 * t252 * t276 / 0.5e1 - 0.9e1 / 0.100e3 * t117 / t251 / t141 * t622 + t253 * (0.125e3 / 0.4374e4 * t578 + 0.110e3 / 0.27e2 * t120 * t121 * t451 + 0.584e3 / 0.405e3 * t629 + 0.584e3 / 0.405e3 * t127 * t633 - 0.146e3 / 0.135e3 * t633 * t136 * t138 - 0.292e3 / 0.135e3 * t260 * t270 * t138 + 0.292e3 / 0.135e3 * t263 * t270 - 0.146e3 / 0.135e3 * t127 * t648 * t138 + 0.292e3 / 0.135e3 * t127 * t652 + 0.146e3 / 0.135e3 * t137 * t648) / 0.10e2
  t665 = f.my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t424 * t30 * t144 - t431 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t31 * t279 + t441 - t443 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t158 * t660)
  t666 = t290 ** 2
  t667 = 0.1e1 / t666
  t668 = t292 ** 2
  t672 = f.my_piecewise5(t14, 0, t10, 0, -t419)
  t676 = f.my_piecewise3(t289, 0, 0.4e1 / 0.9e1 * t667 * t668 + 0.4e1 / 0.3e1 * t290 * t672)
  t683 = t5 * t295 * t153 * t397
  t688 = t5 * t402 * t437 * t397 / 0.12e2
  t690 = f.my_piecewise3(t286, 0, -0.3e1 / 0.8e1 * t5 * t676 * t30 * t397 - t683 / 0.4e1 + t688)
  d11 = 0.2e1 * t284 + 0.2e1 * t408 + t6 * (t665 + t690)
  t693 = -t7 - t24
  t694 = f.my_piecewise5(t10, 0, t14, 0, t693)
  t697 = f.my_piecewise3(t20, 0, 0.4e1 / 0.3e1 * t21 * t694)
  t698 = t697 * t30
  t703 = f.my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t698 * t144 - t157)
  t705 = f.my_piecewise5(t14, 0, t10, 0, -t693)
  t708 = f.my_piecewise3(t289, 0, 0.4e1 / 0.3e1 * t290 * t705)
  t709 = t708 * t30
  t713 = t402 * t30
  t714 = tau1 * t304
  t716 = t302 * r1
  t718 = 0.1e1 / t298 / t716
  t719 = s2 * t718
  t721 = -0.5e1 / 0.3e1 * t714 + t719 / 0.3e1
  t722 = t721 * t43
  t724 = t328 ** 2
  t726 = t48 / t724
  t727 = t49 * t719
  t729 = t314 * t323
  t730 = t729 * t326
  t731 = t722 * t48
  t734 = t320 ** 2
  t736 = 0.1e1 / t321 / t734
  t737 = t315 * t736
  t738 = t737 * t326
  t739 = t307 * t58
  t744 = t324 * t43
  t745 = t718 * t326
  t749 = -t727 / 0.9e1 - 0.5e1 / 0.3e1 * t730 * t731 - 0.20144675925925925925925925925925925925925925925926e1 * t738 * t739 * t61 * t721 + t744 * t374 * t745 / 0.3e1
  t750 = t726 * t749
  t753 = -t308 * t750 / 0.3e1 + t722 * t330 / 0.3e1
  t756 = t334 ** 2
  t757 = 0.1e1 / t756
  t758 = t757 * t753
  t760 = -0.2e1 * t337 * t753 - 0.9e1 * t758
  t761 = t760 * t342
  t764 = 0.1e1 / t341 / t340
  t765 = t339 * t764
  t766 = t368 * t757
  t767 = t766 * t753
  t771 = 0.1e1 / t354 / t353
  t777 = t89 * t345 / t297 / t346 / t302
  t779 = -0.40121303703703703703703703703703703703703703703704e0 * t727 - 0.14346394913206905600000000000000000000000000000000e-1 * t777
  t789 = -0.17051554074074074074074074074074074074074074074074e0 * t727 - 0.5e1 / 0.9e1 * (-0.24256886666666666666666666666666666666666666666667e0 * t714 - 0.31646617777777777777777777777777777777777777777779e-1 * t719) * t43 * t48
  t793 = 0.1e1 / t364 / t353
  t794 = t363 * t793
  t797 = -t771 * t779 / 0.5e1 + 0.7e1 / 0.9e1 * t789 * t365 - 0.14e2 / 0.45e2 * t794 * t779
  t801 = -0.6e1 * t765 * t758 - t761
  t803 = t395 ** 2
  t804 = t803 ** 2
  t805 = t804 ** 2
  t806 = t805 * t395
  t807 = 0.1e1 / t806
  t808 = t370 * t807
  t815 = t731 / 0.4e1 - 0.2e1 / 0.27e2 * t727
  t818 = t815 * t389
  t825 = f.my_piecewise3(t388, -s2 / t302 * t385 / 0.8e1, 0)
  t831 = -0.125e3 / 0.39366e5 * t777 - 0.10e2 / 0.9e1 * t373 * t374 * t718 + 0.584e3 / 0.405e3 * t380 * t815 - 0.146e3 / 0.135e3 * t818 * t391 - 0.146e3 / 0.135e3 * t380 * t825 * t391 + 0.146e3 / 0.135e3 * t390 * t825
  t834 = t761 * t368 + 0.6e1 * t765 * t767 + t343 * t797 + t801 * t395 + t808 * t831 / 0.10e2
  t839 = f.my_piecewise3(t286, 0, -0.3e1 / 0.8e1 * t5 * t709 * t397 - t406 - 0.3e1 / 0.8e1 * t5 * t713 * t834)
  t843 = 0.2e1 * t417
  t844 = f.my_piecewise5(t10, 0, t14, 0, t843)
  t848 = f.my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t411 * t694 * t26 + 0.4e1 / 0.3e1 * t21 * t844)
  t855 = t5 * t697 * t153 * t144
  t863 = f.my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t848 * t30 * t144 - t855 / 0.8e1 - 0.3e1 / 0.8e1 * t5 * t698 * t279 - t431 / 0.8e1 + t441 - t443 / 0.8e1)
  t867 = f.my_piecewise5(t14, 0, t10, 0, -t843)
  t871 = f.my_piecewise3(t289, 0, 0.4e1 / 0.9e1 * t667 * t705 * t292 + 0.4e1 / 0.3e1 * t290 * t867)
  t878 = t5 * t708 * t153 * t397
  t885 = t5 * t403 * t834
  t888 = f.my_piecewise3(t286, 0, -0.3e1 / 0.8e1 * t5 * t871 * t30 * t397 - t878 / 0.8e1 - t683 / 0.8e1 + t688 - 0.3e1 / 0.8e1 * t5 * t296 * t834 - t885 / 0.8e1)
  d12 = t284 + t408 + t703 + t839 + t6 * (t863 + t888)
  t893 = t694 ** 2
  t897 = 0.2e1 * t23 + 0.2e1 * t417
  t898 = f.my_piecewise5(t10, 0, t14, 0, t897)
  t902 = f.my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t411 * t893 + 0.4e1 / 0.3e1 * t21 * t898)
  t909 = f.my_piecewise3(t1, 0, -0.3e1 / 0.8e1 * t5 * t902 * t30 * t144 - t855 / 0.4e1 + t441)
  t910 = t705 ** 2
  t914 = f.my_piecewise5(t14, 0, t10, 0, -t897)
  t918 = f.my_piecewise3(t289, 0, 0.4e1 / 0.9e1 * t667 * t910 + 0.4e1 / 0.3e1 * t290 * t914)
  t928 = t753 ** 2
  t931 = tau1 * t718
  t934 = 0.1e1 / t298 / t346
  t935 = s2 * t934
  t937 = 0.40e2 / 0.9e1 * t931 - 0.11e2 / 0.9e1 * t935
  t938 = t937 * t43
  t946 = t749 ** 2
  t950 = t49 * t935
  t954 = t721 ** 2
  t956 = t954 * t58 * t61
  t970 = t938 * t48
  t1003 = 0.1e1 / t297 / t346 / t716
  t1008 = 0.11e2 / 0.27e2 * t950 + 0.50e2 / 0.27e2 * t313 * t323 * t326 * t956 + 0.40289351851851851851851851851851851851851851851851e2 * t314 * t736 * t326 * t954 * t479 * t307 - 0.10e2 / 0.9e1 * t729 * t89 * t719 * t326 * t721 - 0.5e1 / 0.3e1 * t730 * t970 + 0.40580796816057956104252400548696844993141289437586e2 * t315 / t321 / t734 / t320 * t326 * t316 * t43 * t499 * t954 - 0.80578703703703703703703703703703703703703703703702e1 * t737 * t479 * s2 * t745 * t307 * t721 - 0.20144675925925925925925925925925925925925925925926e1 * t738 * t956 - 0.20144675925925925925925925925925925925925925925926e1 * t738 * t739 * t61 * t937 - 0.11e2 / 0.9e1 * t744 * t374 * t934 * t326 + t324 * t58 * t61 * t345 * t1003 * t326 / 0.9e1
  t1012 = t938 * t330 / 0.3e1 - 0.2e1 / 0.3e1 * t722 * t750 + 0.2e1 / 0.3e1 * t308 * t48 / t724 / t328 * t946 - t308 * t726 * t1008 / 0.3e1
  t1016 = 0.1e1 / t756 / t333
  t1017 = t1016 * t928
  t1019 = t757 * t1012
  t1022 = (-0.2e1 * t337 * t1012 + 0.6e1 * t757 * t928 + 0.36e2 * t1017 - 0.9e1 * t1019) * t342
  t1024 = t760 * t764
  t1029 = t341 ** 2
  t1031 = t339 / t1029
  t1032 = t756 ** 2
  t1033 = 0.1e1 / t1032
  t1049 = t353 ** 2
  t1052 = t779 ** 2
  t1057 = t89 * t345 * t1003
  t1059 = 0.14711144691358024691358024691358024691358024691358e1 * t950 + 0.90860501116977068800000000000000000000000000000000e-1 * t1057
  t1101 = t831 ** 2
  t1108 = t815 ** 2
  t1112 = t970 / 0.4e1 + 0.22e2 / 0.81e2 * t950
  t1127 = f.my_piecewise3(t388, s2 / t716 * t385 / 0.4e1, 0)
  t1131 = t825 ** 2
  t1139 = t1022 * t368 + 0.12e2 * t1024 * t767 + 0.2e1 * t761 * t797 + 0.54e2 * t1031 * t368 * t1033 * t928 + 0.12e2 * t765 * t797 * t757 * t753 - 0.24e2 * t765 * t368 * t1016 * t928 + 0.6e1 * t765 * t766 * t1012 + t343 * (0.6e1 / 0.25e2 / t354 / t1049 * t1052 - t771 * t1059 / 0.5e1 + 0.7e1 / 0.9e1 * (0.62522364938271604938271604938271604938271604938271e0 * t950 - 0.5e1 / 0.9e1 * (0.64685031111111111111111111111111111111111111111112e0 * t931 + 0.11603759851851851851851851851851851851851851851852e0 * t935) * t43 * t48) * t365 - 0.28e2 / 0.45e2 * t789 * t793 * t779 + 0.98e2 / 0.225e3 * t363 / t364 / t1049 * t1052 - 0.14e2 / 0.45e2 * t794 * t1059) + (-0.54e2 * t1031 * t1033 * t928 + 0.24e2 * t765 * t1017 - 0.6e1 * t765 * t1019 - 0.12e2 * t1024 * t758 - t1022) * t395 + t801 * t807 * t831 / 0.5e1 - 0.9e1 / 0.100e3 * t370 / t806 / t394 * t1101 + t808 * (0.125e3 / 0.4374e4 * t1057 + 0.110e3 / 0.27e2 * t373 * t374 * t934 + 0.584e3 / 0.405e3 * t1108 + 0.584e3 / 0.405e3 * t380 * t1112 - 0.146e3 / 0.135e3 * t1112 * t389 * t391 - 0.292e3 / 0.135e3 * t815 * t825 * t391 + 0.292e3 / 0.135e3 * t818 * t825 - 0.146e3 / 0.135e3 * t380 * t1127 * t391 + 0.292e3 / 0.135e3 * t380 * t1131 + 0.146e3 / 0.135e3 * t390 * t1127) / 0.10e2
  t1144 = f.my_piecewise3(t286, 0, -0.3e1 / 0.8e1 * t5 * t918 * t30 * t397 - t878 / 0.4e1 - 0.3e1 / 0.4e1 * t5 * t709 * t834 + t688 - t885 / 0.4e1 - 0.3e1 / 0.8e1 * t5 * t713 * t1139)
  d22 = 0.2e1 * t703 + 0.2e1 * t839 + t6 * (t909 + t1144)
  res = {'v2rho2': jnp.stack([d11, d12, d22], axis=-1) if 'd12' in locals() else d11}
  return res

