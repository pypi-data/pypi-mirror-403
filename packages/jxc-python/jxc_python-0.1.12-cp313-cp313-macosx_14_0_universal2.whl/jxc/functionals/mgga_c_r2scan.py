"""Generated from mgga_c_r2scan.mpl."""

import jax
import jax.lax as lax
import jax.numpy as jnp
import numpy as np
from jax.numpy import array as array
from jax.numpy import int32 as int32
from jax.numpy import nan as nan
from typing import Callable, Optional
from jxc.functionals.utils import *

def pol(p, r, s=(None, None, None), l=(None, None), tau=(None, None)):
  f = funcs(p)
  params = f.params
  (r0, r1), (s0, s1, s2), (l0, l1), (tau0, tau1) = r, s, l, tau
  
  t1 = 3 ** (0.1e1 / 0.3e1)
  t3 = (0.1e1 / jnp.pi) ** (0.1e1 / 0.3e1)
  t4 = t1 * t3
  t5 = 4 ** (0.1e1 / 0.3e1)
  t6 = t5 ** 2
  t7 = r0 + r1
  t8 = t7 ** (0.1e1 / 0.3e1)
  t10 = t6 / t8
  t11 = t4 * t10
  t13 = 0.621814e-1 + 0.3322041295e-2 * t11
  t14 = jnp.sqrt(t11)
  t16 = 0.5577049766e-1 * t11
  t17 = t11 ** 0.15e1
  t18 = 0.12733196185e-1 * t17
  t19 = t1 ** 2
  t20 = t3 ** 2
  t22 = t8 ** 2
  t25 = t19 * t20 * t5 / t22
  t26 = 0.7662924829e-2 * t25
  t30 = jnp.log(0.1e1 + 0.1e1 / (0.23615562999 * t14 + t16 + t18 + t26))
  t31 = t13 * t30
  t32 = r0 - r1
  t33 = t32 ** 2
  t34 = t33 ** 2
  t35 = t7 ** 2
  t36 = t35 ** 2
  t38 = t34 / t36
  t40 = t32 / t7
  t41 = 0.1e1 + t40
  t42 = t41 <= f.p.zeta_threshold
  t43 = f.p.zeta_threshold ** (0.1e1 / 0.3e1)
  t44 = t43 * f.p.zeta_threshold
  t45 = t41 ** (0.1e1 / 0.3e1)
  t47 = f.my_piecewise3(t42, t44, t45 * t41)
  t48 = 0.1e1 - t40
  t49 = t48 <= f.p.zeta_threshold
  t50 = t48 ** (0.1e1 / 0.3e1)
  t52 = f.my_piecewise3(t49, t44, t50 * t48)
  t53 = t47 + t52 - 0.2e1
  t54 = 2 ** (0.1e1 / 0.3e1)
  t57 = 0.1e1 / (0.2e1 * t54 - 0.2e1)
  t58 = t53 * t57
  t60 = 0.310907e-1 + 0.1597129259e-2 * t11
  t62 = 0.481727078475e-1 * t11
  t63 = 0.130821892925e-1 * t17
  t64 = 0.485924322975e-2 * t25
  t68 = jnp.log(0.1e1 + 0.1e1 / (0.219483242115 * t14 + t62 + t63 + t64))
  t71 = 0.337738e-1 + 0.9393338125e-3 * t11
  t73 = 0.30591463695e-1 * t11
  t74 = 0.37162156485e-2 * t17
  t75 = 0.41939460495e-2 * t25
  t79 = jnp.log(0.1e1 + 0.1e1 / (0.1748976233 * t14 + t73 + t74 + t75))
  t80 = t71 * t79
  t84 = t38 * t58 * (-t60 * t68 + t31 - 0.58482236226346462072622386637590534819724553404281 * t80)
  t86 = 0.58482236226346462072622386637590534819724553404281 * t58 * t80
  t87 = jnp.log(0.2e1)
  t88 = 0.1e1 - t87
  t89 = jnp.pi ** 2
  t92 = t43 ** 2
  t93 = t45 ** 2
  t94 = f.my_piecewise3(t42, t92, t93)
  t95 = t50 ** 2
  t96 = f.my_piecewise3(t49, t92, t95)
  t98 = t94 / 0.2e1 + t96 / 0.2e1
  t99 = t98 ** 2
  t100 = t99 * t98
  t102 = 0.1e1 / t88
  t104 = 0.1e1 / t100
  t107 = jnp.exp(-(-t31 + t84 + t86) * t102 * t89 * t104)
  t108 = t107 - 0.1e1
  t116 = s0 + 0.2e1 * s1 + s2
  t127 = t102 * t89
  t128 = 0.1e1 / t108
  t133 = t92 * f.p.zeta_threshold
  t135 = f.my_piecewise3(t42, t133, t93 * t41)
  t137 = f.my_piecewise3(t49, t133, t95 * t48)
  t143 = jnp.sqrt(0.4e1)
  t144 = t143 * t14
  t146 = 0.3138525e-1 * t11
  t148 = (0.1e1 + 0.22225e-1 * t144 + t146) ** 2
  t154 = 0.1e1 - (0.2363e1 * t54 - 0.2363e1) * t53 * t57
  t156 = t34 ** 2
  t158 = t36 ** 2
  t162 = -t156 * t34 / t158 / t36 + 0.1e1
  t164 = t143 / t14
  t171 = 0.118077814995 * t144 + t16 + t18 + t26
  t173 = 0.1e1 + 0.1e1 / t171
  t174 = jnp.log(t173)
  t175 = 0.1328816518e-1 * t174
  t176 = t171 ** 2
  t180 = t11 ** 0.5
  t186 = t13 / t176 * (0.23615562999 * t164 + 0.22308199064 + 0.7639917711e-1 * t180 + 0.15325849658e-1 * t11) / t173
  t188 = 0.1097416210575 * t144 + t62 + t63 + t64
  t190 = 0.1e1 + 0.1e1 / t188
  t191 = jnp.log(t190)
  t193 = t188 ** 2
  t204 = 0.8744881165e-1 * t144 + t73 + t74 + t75
  t206 = 0.1e1 + 0.1e1 / t204
  t207 = jnp.log(t206)
  t209 = t204 ** 2
  t210 = 0.1e1 / t209
  t215 = 0.1748976233 * t164 + 0.12236585478 + 0.22297293891e-1 * t180 + 0.8387892099e-2 * t11
  t216 = 0.1e1 / t206
  t236 = 0.1e1 / (0.1e1 + 0.4445e-1 * t14 + t146)
  t246 = 6 ** (0.1e1 / 0.3e1)
  t247 = t89 ** (0.1e1 / 0.3e1)
  t248 = t247 ** 2
  t250 = t246 / t248
  t251 = t54 ** 2
  t254 = 0.1e1 / t22 / t35
  t255 = t116 * t254
  t256 = t246 ** 2
  t260 = t116 ** 2
  t268 = jnp.exp(-0.20444604078896369094486892376367646458587560067351 * t256 / t247 / t89 * t54 * t260 / t8 / t36 / t7)
  t274 = (0.1e1 + (0.6672455060314922e-1 + 0.16681137650787305e-2 * t11) / (0.1e1 + 0.4445e-1 * t11) * t116 / t8 / t35 * t54 / t99 * t19 / t3 * t5 * t127 * t128 / 0.24e2 + 0.43913724338827160493827160493827160493827160493828e-2 * t127 / (t135 / 0.2e1 + t137 / 0.2e1) * t104 * t128 * (0.5e1 * t4 * t10 * (0.285764e-1 / t148 * t154 * t162 * (0.4445e-1 * t164 + 0.125541) + t175 - t186 - t38 * t58 * (-0.6388517036e-2 * t191 + t60 / t193 * (0.219483242115 * t164 + 0.19269083139 + 0.78493135755e-1 * t180 + 0.97184864595e-2 * t11) / t190 + t175 - t186 - 0.21973736767207854065825215325254789154450345979641e-2 * t207 + 0.58482236226346462072622386637590534819724553404281 * t71 * t210 * t215 * t216) - 0.21973736767207854065825215325254789154450345979641e-2 * t58 * t207 + 0.58482236226346462072622386637590534819724553404281 * t58 * t71 * t210 * t215 * t216) - 0.45e2 * params.eta * (-0.285764e-1 * t236 * t154 * t162 + t31 - t84 - t86)) * t250 * t251 * t255 * t268) ** (0.1e1 / 0.4e1)
  t279 = jnp.log(0.1e1 + t108 * (0.1e1 - 0.1e1 / t274))
  t281 = t88 / t89 * t100 * t279
  t282 = r0 ** (0.1e1 / 0.3e1)
  t283 = t282 ** 2
  t287 = t41 / 0.2e1
  t288 = t287 ** (0.1e1 / 0.3e1)
  t289 = t288 ** 2
  t290 = t289 * t287
  t292 = r1 ** (0.1e1 / 0.3e1)
  t293 = t292 ** 2
  t297 = t48 / 0.2e1
  t298 = t297 ** (0.1e1 / 0.3e1)
  t299 = t298 ** 2
  t300 = t299 * t297
  t313 = (tau0 / t283 / r0 * t290 + tau1 / t293 / r1 * t300 - t255 / 0.8e1) / (0.3e1 / 0.1e2 * t256 * t248 * (t290 + t300) + params.eta * t116 * t254 / 0.8e1)
  t316 = f.my_piecewise3(0. < t313, 0, t313)
  t321 = jnp.exp(-0.64 * t316 / (0.1e1 - t316))
  t323 = 0.25e1 < t313
  t324 = f.my_piecewise3(t323, 0.25e1, t313)
  t326 = t324 ** 2
  t328 = t326 * t324
  t330 = t326 ** 2
  t339 = f.my_piecewise3(t323, t313, 0.25e1)
  t343 = jnp.exp(0.15e1 / (0.1e1 - t339))
  t345 = f.my_piecewise5(t313 <= 0., t321, t313 <= 0.25e1, 0.1e1 - 0.64 * t324 - 0.4352 * t326 - 0.1535685604549e1 * t328 + 0.3061560252175e1 * t330 - 0.1915710236206e1 * t330 * t324 + 0.516884468372 * t330 * t326 - 0.51848879792e-1 * t330 * t328, -0.7 * t343)
  t348 = jnp.exp(0.1e1 * t236)
  t355 = (0.1e1 + 0.21337642104376358333333333333333333333333333333333e-1 * t250 * t251 * t116 * t254) ** (0.1e1 / 0.4e1)
  t360 = jnp.log(0.1e1 + (t348 - 0.1e1) * (0.1e1 - 0.1e1 / t355))
  res = -t31 + t84 + t86 + t281 + t345 * ((-0.285764e-1 * t236 + 0.285764e-1 * t360) * t154 * t162 + t31 - t84 - t86 - t281)
  return res

def unpol(p, r, s=None, l=None, tau=None):
  f = funcs(p)
  params = f.params
  r0, s0, l0, tau0 = r, s, l, tau
  
  t1 = 3 ** (0.1e1 / 0.3e1)
  t3 = (0.1e1 / jnp.pi) ** (0.1e1 / 0.3e1)
  t4 = t1 * t3
  t5 = 4 ** (0.1e1 / 0.3e1)
  t6 = t5 ** 2
  t7 = r0 ** (0.1e1 / 0.3e1)
  t9 = t6 / t7
  t10 = t4 * t9
  t12 = 0.621814e-1 + 0.3322041295e-2 * t10
  t13 = jnp.sqrt(t10)
  t15 = 0.5577049766e-1 * t10
  t16 = t10 ** 0.15e1
  t17 = 0.12733196185e-1 * t16
  t18 = t1 ** 2
  t19 = t3 ** 2
  t21 = t7 ** 2
  t24 = t18 * t19 * t5 / t21
  t25 = 0.7662924829e-2 * t24
  t29 = jnp.log(0.1e1 + 0.1e1 / (0.23615562999 * t13 + t15 + t17 + t25))
  t30 = t12 * t29
  t31 = 0.1e1 <= f.p.zeta_threshold
  t32 = f.p.zeta_threshold ** (0.1e1 / 0.3e1)
  t34 = f.my_piecewise3(t31, t32 * f.p.zeta_threshold, 1)
  t36 = 0.2e1 * t34 - 0.2e1
  t37 = 2 ** (0.1e1 / 0.3e1)
  t40 = 0.1e1 / (0.2e1 * t37 - 0.2e1)
  t41 = t36 * t40
  t43 = 0.337738e-1 + 0.9393338125e-3 * t10
  t45 = 0.30591463695e-1 * t10
  t46 = 0.37162156485e-2 * t16
  t47 = 0.41939460495e-2 * t24
  t51 = jnp.log(0.1e1 + 0.1e1 / (0.1748976233 * t13 + t45 + t46 + t47))
  t54 = 0.58482236226346462072622386637590534819724553404281 * t41 * t43 * t51
  t55 = jnp.log(0.2e1)
  t56 = 0.1e1 - t55
  t57 = jnp.pi ** 2
  t60 = t32 ** 2
  t61 = f.my_piecewise3(t31, t60, 1)
  t62 = t61 ** 2
  t63 = t62 * t61
  t65 = 0.1e1 / t56
  t67 = 0.1e1 / t63
  t70 = jnp.exp(-(-t30 + t54) * t65 * t57 * t67)
  t71 = t70 - 0.1e1
  t79 = r0 ** 2
  t89 = t65 * t57
  t90 = 0.1e1 / t71
  t96 = f.my_piecewise3(t31, t60 * f.p.zeta_threshold, 1)
  t100 = jnp.sqrt(0.4e1)
  t101 = t100 * t13
  t103 = 0.3138525e-1 * t10
  t105 = (0.1e1 + 0.22225e-1 * t101 + t103) ** 2
  t111 = 0.1e1 - (0.2363e1 * t37 - 0.2363e1) * t36 * t40
  t114 = t100 / t13
  t120 = 0.118077814995 * t101 + t15 + t17 + t25
  t122 = 0.1e1 + 0.1e1 / t120
  t123 = jnp.log(t122)
  t125 = t120 ** 2
  t129 = t10 ** 0.5
  t137 = 0.8744881165e-1 * t101 + t45 + t46 + t47
  t139 = 0.1e1 + 0.1e1 / t137
  t140 = jnp.log(t139)
  t144 = t137 ** 2
  t161 = 0.1e1 / (0.1e1 + 0.4445e-1 * t13 + t103)
  t170 = 6 ** (0.1e1 / 0.3e1)
  t171 = t57 ** (0.1e1 / 0.3e1)
  t172 = t171 ** 2
  t174 = t170 / t172
  t175 = t37 ** 2
  t178 = 0.1e1 / t21 / t79
  t179 = s0 * t178
  t180 = t170 ** 2
  t184 = s0 ** 2
  t186 = t79 ** 2
  t193 = jnp.exp(-0.20444604078896369094486892376367646458587560067351 * t180 / t171 / t57 * t37 * t184 / t7 / t186 / r0)
  t199 = (0.1e1 + (0.6672455060314922e-1 + 0.16681137650787305e-2 * t10) / (0.1e1 + 0.4445e-1 * t10) * s0 / t7 / t79 * t37 / t62 * t18 / t3 * t5 * t89 * t90 / 0.24e2 + 0.43913724338827160493827160493827160493827160493828e-2 * t89 / t96 * t67 * t90 * (0.5e1 * t4 * t9 * (0.285764e-1 / t105 * t111 * (0.4445e-1 * t114 + 0.125541) + 0.1328816518e-1 * t123 - t12 / t125 * (0.23615562999 * t114 + 0.22308199064 + 0.7639917711e-1 * t129 + 0.15325849658e-1 * t10) / t122 - 0.21973736767207854065825215325254789154450345979641e-2 * t41 * t140 + 0.58482236226346462072622386637590534819724553404281 * t41 * t43 / t144 * (0.1748976233 * t114 + 0.12236585478 + 0.22297293891e-1 * t129 + 0.8387892099e-2 * t10) / t139) - 0.45e2 * params.eta * (-0.285764e-1 * t161 * t111 + t30 - t54)) * t174 * t175 * t179 * t193) ** (0.1e1 / 0.4e1)
  t204 = jnp.log(0.1e1 + t71 * (0.1e1 - 0.1e1 / t199))
  t206 = t56 / t57 * t63 * t204
  t220 = (tau0 / t21 / r0 - t179 / 0.8e1) / (0.3e1 / 0.2e2 * t180 * t172 * t37 + params.eta * s0 * t178 / 0.8e1)
  t223 = f.my_piecewise3(0. < t220, 0, t220)
  t228 = jnp.exp(-0.64 * t223 / (0.1e1 - t223))
  t230 = 0.25e1 < t220
  t231 = f.my_piecewise3(t230, 0.25e1, t220)
  t233 = t231 ** 2
  t235 = t233 * t231
  t237 = t233 ** 2
  t246 = f.my_piecewise3(t230, t220, 0.25e1)
  t250 = jnp.exp(0.15e1 / (0.1e1 - t246))
  t252 = f.my_piecewise5(t220 <= 0., t228, t220 <= 0.25e1, 0.1e1 - 0.64 * t231 - 0.4352 * t233 - 0.1535685604549e1 * t235 + 0.3061560252175e1 * t237 - 0.1915710236206e1 * t237 * t231 + 0.516884468372 * t237 * t233 - 0.51848879792e-1 * t237 * t235, -0.7 * t250)
  t255 = jnp.exp(0.1e1 * t161)
  t262 = (0.1e1 + 0.21337642104376358333333333333333333333333333333333e-1 * t174 * t175 * s0 * t178) ** (0.1e1 / 0.4e1)
  t267 = jnp.log(0.1e1 + (t255 - 0.1e1) * (0.1e1 - 0.1e1 / t262))
  res = -t30 + t54 + t206 + t252 * ((-0.285764e-1 * t161 + 0.285764e-1 * t267) * t111 + t30 - t54 - t206)
  return res

def pol_vxc(p, r, s=(None, None, None), l=(None, None), tau=(None, None)):
  f = funcs(p)
  params = f.params
  (r0, r1), (s0, s1, s2), (l0, l1), (tau0, tau1) = r, s, l, tau
  params_eta_raw = params.eta
  if isinstance(params_eta_raw, (str, bytes, dict)):
    params_eta = params_eta_raw
  else:
    try:
      params_eta_seq = list(params_eta_raw)
    except TypeError:
      params_eta = params_eta_raw
    else:
      params_eta_seq = np.asarray(params_eta_seq, dtype=np.float64)
      params_eta = np.concatenate((np.array([np.nan], dtype=np.float64), params_eta_seq))

  params_c1 = 0.667
  params_dp2 = 0.361

  params_pp = np.array([np.nan, 1, 1, 1], dtype=np.float64)

  params_a = np.array([np.nan, 0.0310907, 0.01554535, 0.0168869], dtype=np.float64)

  params_alpha1 = np.array([np.nan, 0.2137, 0.20548, 0.11125], dtype=np.float64)

  params_beta1 = np.array([np.nan, 7.5957, 14.1189, 10.357], dtype=np.float64)

  params_beta2 = np.array([np.nan, 3.5876, 6.1977, 3.6231], dtype=np.float64)

  params_beta3 = np.array([np.nan, 1.6382, 3.3662, 0.88026], dtype=np.float64)

  params_beta4 = np.array([np.nan, 0.49294, 0.62517, 0.49671], dtype=np.float64)

  params_fz20 = 1.7099209341613657

  params_gamma = (1 - jnp.log(2)) / jnp.pi ** 2

  beta_a = 0.06672455060314922

  beta_b = 0.1

  beta_c = 0.1778

  scan_b1c = 0.0285764

  scan_b2c = 0.0889

  scan_b3c = 0.125541

  scan_chi_infty = 0.12802585262625815

  scan_G_cnst = 2.363

  params_c2 = 1.5

  params_d = 0.7

  rscan_fc = np.array([np.nan, -0.051848879792, 0.516884468372, -1.915710236206, 3.061560252175, -1.535685604549, -0.4352, -0.64, 1], dtype=np.float64)

  rscan_f_alpha_small = lambda a, ff: jnp.sum(jnp.array([ff[8 - i] * a ** i for i in range(0, 7 + 1)]), axis=0)

  r2scan_alpha = lambda z, xt, ts0, ts1: (f.t_total(z, ts0, ts1) - xt ** 2 / 8) / (K_FACTOR_C * f.t_total(z, 1, 1) + params_eta * xt ** 2 / 8)

  r2scan_d = lambda z: (f.opz_pow_n(z, 5 / 3) + f.opz_pow_n(-z, 5 / 3)) / 2

  r2scan_dfc2 = lambda ff: jnp.sum(jnp.array([i * ff[8 - i] for i in range(1, 7 + 1)]), axis=0)

  g_aux = lambda k, rs: params_beta1[k] * jnp.sqrt(rs) + params_beta2[k] * rs + params_beta3[k] * rs ** 1.5 + params_beta4[k] * rs ** (params_pp[k] + 1)

  mgamma = params_gamma

  mbeta = lambda rs: beta_a * (1 + beta_b * rs) / (1 + beta_c * rs)

  scan_eclda0 = lambda rs: -scan_b1c / (1 + scan_b2c * jnp.sqrt(rs) + scan_b3c * rs)

  scan_g_infty = lambda s: 1 / (1 + 4 * scan_chi_infty * s ** 2) ** (1 / 4)

  scan_Gc = lambda z: (1 - scan_G_cnst * (2 ** (1 / 3) - 1) * f.f_zeta(z)) * (1 - z ** 12)

  r2scan_f_alpha_neg = lambda a: jnp.exp(-params_c1 * a / (1 - a))

  rscan_f_alpha_large = lambda a: -params_d * jnp.exp(params_c2 / (1 - a))

  g = lambda k, rs: -2 * params_a[k] * (1 + params_alpha1[k] * rs) * jnp.log(1 + 1 / (2 * params_a[k] * g_aux(k, rs)))

  scan_H0 = lambda rs, s: scan_b1c * jnp.log(1 + (jnp.exp(-scan_eclda0(rs) / scan_b1c) - 1) * (1 - scan_g_infty(s)))

  r2scan_elsda0 = lambda rs, z: scan_eclda0(rs) * scan_Gc(z)

  r2scan_f_alpha = lambda a, ff: f.my_piecewise5(a <= 0, r2scan_f_alpha_neg(jnp.minimum(a, 0)), a <= 2.5, rscan_f_alpha_small(jnp.minimum(a, 2.5), ff), rscan_f_alpha_large(jnp.maximum(a, 2.5)))

  f_pw = lambda rs, zeta: g(1, rs) + zeta ** 4 * f.f_zeta(zeta) * (g(2, rs) - g(1, rs) + g(3, rs) / params_fz20) - f.f_zeta(zeta) * g(3, rs) / params_fz20

  scan_e0 = lambda rs, z, s: (scan_eclda0(rs) + scan_H0(rs, s)) * scan_Gc(z)

  r2scan_delsda0 = lambda rs, z: (lambda _jac: jnp.diag(_jac) if _jac.ndim == 2 else _jac)(jax.jacrev(lambda x1: r2scan_elsda0(x1, z))(rs))

  w1 = lambda rs, z: jnp.exp(-f_pw(rs, z) / (mgamma * f.mphi(z) ** 3)) - 1

  r2scan_elsda1 = lambda rs, z: f_pw(rs, z)

  r2scan_ec0 = lambda rs, z, s: scan_e0(rs, z, s)

  r2scan_y = lambda rs, z, t: mbeta(rs) * t ** 2 / (mgamma * w1(rs, z))

  r2scan_delsda1 = lambda rs, z: (lambda _jac: jnp.diag(_jac) if _jac.ndim == 2 else _jac)(jax.jacrev(lambda x1: r2scan_elsda1(x1, z))(rs))

  r2scan_dy = lambda rs, z, s: r2scan_dfc2(rscan_fc) / (27 * mgamma * r2scan_d(z) * f.mphi(z) ** 3 * w1(rs, z)) * (+20 * rs * (r2scan_delsda0(rs, z) - r2scan_delsda1(rs, z)) - 45 * params_eta * (r2scan_elsda0(rs, z) - r2scan_elsda1(rs, z))) * s ** 2 * jnp.exp(-s ** 4 / params_dp2 ** 4)

  r2scan_g = lambda rs, z, s, t: 1 / (1 + 4 * (r2scan_y(rs, z, t) - r2scan_dy(rs, z, s))) ** (1 / 4)

  fH = lambda rs, z, s, t: mgamma * f.mphi(z) ** 3 * jnp.log(1 + w1(rs, z) * (1 - r2scan_g(rs, z, s, t)))

  r2scan_ec1 = lambda rs, z, s, t: f_pw(rs, z) + fH(rs, z, s, t)

  r2scan_f = lambda rs, z, xt, xs0, xs1, ts0, ts1: r2scan_ec1(rs, z, X2S * 2 ** (1 / 3) * xt, f.tt(rs, z, xt)) + r2scan_f_alpha(r2scan_alpha(z, xt, ts0, ts1), rscan_fc) * (+r2scan_ec0(rs, z, X2S * 2 ** (1 / 3) * xt) - r2scan_ec1(rs, z, X2S * 2 ** (1 / 3) * xt, f.tt(rs, z, xt)))

  functional_body = lambda rs, z, xt, xs0, xs1, us0, us1, ts0, ts1: r2scan_f(rs, z, xt, xs0, xs1, ts0, ts1)

  t1 = 3 ** (0.1e1 / 0.3e1)
  t3 = (0.1e1 / jnp.pi) ** (0.1e1 / 0.3e1)
  t4 = t1 * t3
  t5 = 4 ** (0.1e1 / 0.3e1)
  t6 = t5 ** 2
  t7 = r0 + r1
  t8 = t7 ** (0.1e1 / 0.3e1)
  t10 = t6 / t8
  t11 = t4 * t10
  t13 = 0.621814e-1 + 0.33220412950000000000000000000000000000000000000000e-2 * t11
  t14 = jnp.sqrt(t11)
  t16 = 0.55770497660000000000000000000000000000000000000000e-1 * t11
  t17 = t11 ** 0.15e1
  t18 = 0.12733196185000000000000000000000000000000000000000e-1 * t17
  t19 = t1 ** 2
  t20 = t3 ** 2
  t21 = t19 * t20
  t22 = t8 ** 2
  t25 = t21 * t5 / t22
  t26 = 0.76629248290000000000000000000000000000000000000000e-2 * t25
  t27 = 0.23615562999000000000000000000000000000000000000000e0 * t14 + t16 + t18 + t26
  t29 = 0.1e1 + 0.1e1 / t27
  t30 = jnp.log(t29)
  t31 = t13 * t30
  t32 = r0 - r1
  t33 = t32 ** 2
  t34 = t33 ** 2
  t35 = t7 ** 2
  t36 = t35 ** 2
  t37 = 0.1e1 / t36
  t38 = t34 * t37
  t39 = 0.1e1 / t7
  t40 = t32 * t39
  t41 = 0.1e1 + t40
  t42 = t41 <= f.p.zeta_threshold
  t43 = f.p.zeta_threshold ** (0.1e1 / 0.3e1)
  t44 = t43 * f.p.zeta_threshold
  t45 = t41 ** (0.1e1 / 0.3e1)
  t47 = f.my_piecewise3(t42, t44, t45 * t41)
  t48 = 0.1e1 - t40
  t49 = t48 <= f.p.zeta_threshold
  t50 = t48 ** (0.1e1 / 0.3e1)
  t52 = f.my_piecewise3(t49, t44, t50 * t48)
  t53 = t47 + t52 - 0.2e1
  t54 = 2 ** (0.1e1 / 0.3e1)
  t57 = 0.1e1 / (0.2e1 * t54 - 0.2e1)
  t58 = t53 * t57
  t60 = 0.3109070e-1 + 0.15971292590000000000000000000000000000000000000000e-2 * t11
  t62 = 0.48172707847500000000000000000000000000000000000000e-1 * t11
  t63 = 0.13082189292500000000000000000000000000000000000000e-1 * t17
  t64 = 0.48592432297500000000000000000000000000000000000000e-2 * t25
  t65 = 0.21948324211500000000000000000000000000000000000000e0 * t14 + t62 + t63 + t64
  t67 = 0.1e1 + 0.1e1 / t65
  t68 = jnp.log(t67)
  t71 = 0.337738e-1 + 0.93933381250000000000000000000000000000000000000000e-3 * t11
  t73 = 0.30591463695000000000000000000000000000000000000000e-1 * t11
  t74 = 0.37162156485000000000000000000000000000000000000000e-2 * t17
  t75 = 0.41939460495000000000000000000000000000000000000000e-2 * t25
  t76 = 0.17489762330000000000000000000000000000000000000000e0 * t14 + t73 + t74 + t75
  t78 = 0.1e1 + 0.1e1 / t76
  t79 = jnp.log(t78)
  t80 = t71 * t79
  t82 = -t60 * t68 + t31 - 0.58482236226346462072622386637590534819724553404281e0 * t80
  t83 = t58 * t82
  t84 = t38 * t83
  t86 = 0.58482236226346462072622386637590534819724553404281e0 * t58 * t80
  t87 = jnp.log(0.2e1)
  t88 = 0.1e1 - t87
  t89 = jnp.pi ** 2
  t90 = 0.1e1 / t89
  t91 = t88 * t90
  t92 = t43 ** 2
  t93 = t45 ** 2
  t94 = f.my_piecewise3(t42, t92, t93)
  t95 = t50 ** 2
  t96 = f.my_piecewise3(t49, t92, t95)
  t98 = t94 / 0.2e1 + t96 / 0.2e1
  t99 = t98 ** 2
  t100 = t99 * t98
  t102 = 0.1e1 / t88
  t103 = (-t31 + t84 + t86) * t102
  t104 = 0.1e1 / t100
  t105 = t89 * t104
  t107 = jnp.exp(-t103 * t105)
  t108 = t107 - 0.1e1
  t110 = 0.66724550603149220e-1 + 0.16681137650787305000000000000000000000000000000000e-2 * t11
  t112 = 0.1e1 + 0.44450000000000000000000000000000000000000000000000e-1 * t11
  t113 = 0.1e1 / t112
  t114 = t110 * t113
  t116 = s0 + 0.2e1 * s1 + s2
  t117 = t114 * t116
  t120 = 0.1e1 / t8 / t35 * t54
  t121 = 0.1e1 / t99
  t122 = t120 * t121
  t124 = 0.1e1 / t3
  t126 = t19 * t124 * t5
  t127 = t102 * t89
  t128 = 0.1e1 / t108
  t129 = t127 * t128
  t130 = t126 * t129
  t133 = t92 * f.p.zeta_threshold
  t135 = f.my_piecewise3(t42, t133, t93 * t41)
  t137 = f.my_piecewise3(t49, t133, t95 * t48)
  t139 = t135 / 0.2e1 + t137 / 0.2e1
  t140 = 0.1e1 / t139
  t141 = t127 * t140
  t142 = t104 * t128
  t143 = jnp.sqrt(0.4e1)
  t144 = t143 * t14
  t146 = 0.31385250000000000000000000000000000000000000000000e-1 * t11
  t147 = 0.1e1 + 0.22225000000000000000000000000000000000000000000000e-1 * t144 + t146
  t148 = t147 ** 2
  t149 = 0.1e1 / t148
  t151 = 0.2363e1 * t54 - 0.2363e1
  t154 = -t151 * t53 * t57 + 0.1e1
  t155 = t149 * t154
  t156 = t34 ** 2
  t157 = t156 * t34
  t158 = t36 ** 2
  t160 = 0.1e1 / t158 / t36
  t162 = -t157 * t160 + 0.1e1
  t163 = 0.1e1 / t14
  t164 = t143 * t163
  t166 = 0.44450000000000000000000000000000000000000000000000e-1 * t164 + 0.125541e0
  t167 = t162 * t166
  t171 = 0.11807781499500000000000000000000000000000000000000e0 * t144 + t16 + t18 + t26
  t173 = 0.1e1 + 0.1e1 / t171
  t174 = jnp.log(t173)
  t175 = 0.13288165180e-1 * t174
  t176 = t171 ** 2
  t177 = 0.1e1 / t176
  t178 = t13 * t177
  t180 = t11 ** 0.5e0
  t183 = 0.23615562999000000000000000000000000000000000000000e0 * t164 + 0.22308199064e0 + 0.76399177110000000000000000000000000000000000000000e-1 * t180 + 0.15325849658000000000000000000000000000000000000000e-1 * t11
  t184 = 0.1e1 / t173
  t185 = t183 * t184
  t186 = t178 * t185
  t188 = 0.10974162105750000000000000000000000000000000000000e0 * t144 + t62 + t63 + t64
  t190 = 0.1e1 + 0.1e1 / t188
  t191 = jnp.log(t190)
  t193 = t188 ** 2
  t194 = 0.1e1 / t193
  t195 = t60 * t194
  t199 = 0.21948324211500000000000000000000000000000000000000e0 * t164 + 0.192690831390e0 + 0.78493135755000000000000000000000000000000000000000e-1 * t180 + 0.97184864595000000000000000000000000000000000000000e-2 * t11
  t200 = 0.1e1 / t190
  t201 = t199 * t200
  t204 = 0.87448811650000000000000000000000000000000000000000e-1 * t144 + t73 + t74 + t75
  t206 = 0.1e1 + 0.1e1 / t204
  t207 = jnp.log(t206)
  t209 = t204 ** 2
  t210 = 0.1e1 / t209
  t211 = t71 * t210
  t215 = 0.17489762330000000000000000000000000000000000000000e0 * t164 + 0.12236585478e0 + 0.22297293891000000000000000000000000000000000000000e-1 * t180 + 0.83878920990000000000000000000000000000000000000000e-2 * t11
  t216 = 0.1e1 / t206
  t217 = t215 * t216
  t220 = -0.63885170360e-2 * t191 + t195 * t201 + t175 - t186 - 0.21973736767207854065825215325254789154450345979641e-2 * t207 + 0.58482236226346462072622386637590534819724553404281e0 * t211 * t217
  t221 = t58 * t220
  t225 = t58 * t71
  t227 = t210 * t215 * t216
  t230 = 0.285764e-1 * t155 * t167 + t175 - t186 - t38 * t221 - 0.21973736767207854065825215325254789154450345979641e-2 * t58 * t207 + 0.58482236226346462072622386637590534819724553404281e0 * t225 * t227
  t235 = 0.1e1 + 0.44450000000000000000000000000000000000000000000000e-1 * t14 + t146
  t236 = 0.1e1 / t235
  t237 = t236 * t154
  t243 = 0.5e1 * t4 * t10 * t230 - 0.45e2 * params.eta * (-0.285764e-1 * t237 * t162 + t31 - t84 - t86)
  t244 = t142 * t243
  t245 = t141 * t244
  t246 = 6 ** (0.1e1 / 0.3e1)
  t247 = t89 ** (0.1e1 / 0.3e1)
  t248 = t247 ** 2
  t249 = 0.1e1 / t248
  t250 = t246 * t249
  t251 = t54 ** 2
  t252 = t250 * t251
  t254 = 0.1e1 / t22 / t35
  t255 = t116 * t254
  t256 = t246 ** 2
  t260 = t116 ** 2
  t262 = t36 * t7
  t268 = jnp.exp(-0.20444604078896369094486892376367646458587560067351e0 * t256 / t247 / t89 * t54 * t260 / t8 / t262)
  t270 = t252 * t255 * t268
  t273 = 0.1e1 + t117 * t122 * t130 / 0.24e2 + 0.43913724338827160493827160493827160493827160493828e-2 * t245 * t270
  t274 = t273 ** (0.1e1 / 0.4e1)
  t276 = 0.1e1 - 0.1e1 / t274
  t278 = t108 * t276 + 0.1e1
  t279 = jnp.log(t278)
  t281 = t91 * t100 * t279
  t282 = r0 ** (0.1e1 / 0.3e1)
  t283 = t282 ** 2
  t285 = 0.1e1 / t283 / r0
  t286 = tau0 * t285
  t287 = t41 / 0.2e1
  t288 = t287 ** (0.1e1 / 0.3e1)
  t289 = t288 ** 2
  t290 = t289 * t287
  t292 = r1 ** (0.1e1 / 0.3e1)
  t293 = t292 ** 2
  t295 = 0.1e1 / t293 / r1
  t296 = tau1 * t295
  t297 = t48 / 0.2e1
  t298 = t297 ** (0.1e1 / 0.3e1)
  t299 = t298 ** 2
  t300 = t299 * t297
  t303 = t286 * t290 + t296 * t300 - t255 / 0.8e1
  t304 = t256 * t248
  t308 = params.eta * t116
  t311 = 0.3e1 / 0.10e2 * t304 * (t290 + t300) + t308 * t254 / 0.8e1
  t312 = 0.1e1 / t311
  t313 = t303 * t312
  t314 = t313 <= 0.0e0
  t315 = 0.0e0 < t313
  t316 = f.my_piecewise3(t315, 0, t313)
  t317 = 0.1e1 - t316
  t318 = 0.1e1 / t317
  t321 = jnp.exp(-0.64e0 * t316 * t318)
  t322 = t313 <= 0.25e1
  t323 = 0.25e1 < t313
  t324 = f.my_piecewise3(t323, 0.25e1, t313)
  t326 = t324 ** 2
  t328 = t326 * t324
  t330 = t326 ** 2
  t332 = t330 * t324
  t334 = t330 * t326
  t339 = f.my_piecewise3(t323, t313, 0.25e1)
  t340 = 0.1e1 - t339
  t343 = jnp.exp(0.15e1 / t340)
  t345 = f.my_piecewise5(t314, t321, t322, 0.1e1 - 0.64e0 * t324 - 0.4352e0 * t326 - 0.1535685604549e1 * t328 + 0.3061560252175e1 * t330 - 0.1915710236206e1 * t332 + 0.516884468372e0 * t334 - 0.51848879792e-1 * t330 * t328, -0.7e0 * t343)
  t348 = jnp.exp(0.10000000000000000000000000000000000000000000000000e1 * t236)
  t349 = t348 - 0.1e1
  t354 = 0.1e1 + 0.21337642104376358333333333333333333333333333333333e-1 * t250 * t251 * t116 * t254
  t355 = t354 ** (0.1e1 / 0.4e1)
  t357 = 0.1e1 - 0.1e1 / t355
  t359 = t349 * t357 + 0.1e1
  t360 = jnp.log(t359)
  t362 = -0.285764e-1 * t236 + 0.285764e-1 * t360
  t363 = t362 * t154
  t365 = t162 * t363 - t281 + t31 - t84 - t86
  t366 = t345 * t365
  t368 = 0.1e1 / t8 / t7
  t369 = t6 * t368
  t372 = 0.11073470983333333333333333333333333333333333333333e-2 * t4 * t369 * t30
  t373 = t27 ** 2
  t377 = t3 * t6
  t378 = t377 * t368
  t379 = t163 * t1 * t378
  t381 = t4 * t369
  t382 = 0.18590165886666666666666666666666666666666666666667e-1 * t381
  t384 = t180 * t1 * t378
  t385 = 0.63665980925000000000000000000000000000000000000000e-2 * t384
  t389 = t21 * t5 / t22 / t7
  t390 = 0.51086165526666666666666666666666666666666666666667e-2 * t389
  t394 = t13 / t373 * (-0.39359271665000000000000000000000000000000000000000e-1 * t379 - t382 - t385 - t390) / t29
  t395 = t33 * t32
  t396 = t395 * t37
  t398 = 0.4e1 * t396 * t83
  t400 = t34 / t262
  t402 = 0.4e1 * t400 * t83
  t404 = t32 / t35
  t405 = t39 - t404
  t408 = f.my_piecewise3(t42, 0, 0.4e1 / 0.3e1 * t45 * t405)
  t409 = -t405
  t412 = f.my_piecewise3(t49, 0, 0.4e1 / 0.3e1 * t50 * t409)
  t413 = t408 + t412
  t414 = t413 * t57
  t416 = t38 * t414 * t82
  t420 = t65 ** 2
  t424 = 0.16057569282500000000000000000000000000000000000000e-1 * t381
  t425 = 0.65410946462500000000000000000000000000000000000000e-2 * t384
  t426 = 0.32394954865000000000000000000000000000000000000000e-2 * t389
  t434 = t76 ** 2
  t435 = 0.1e1 / t434
  t438 = 0.10197154565000000000000000000000000000000000000000e-1 * t381
  t439 = 0.18581078242500000000000000000000000000000000000000e-2 * t384
  t440 = 0.27959640330000000000000000000000000000000000000000e-2 * t389
  t441 = -0.29149603883333333333333333333333333333333333333333e-1 * t379 - t438 - t439 - t440
  t442 = 0.1e1 / t78
  t448 = t38 * t58 * (0.53237641966666666666666666666666666666666666666667e-3 * t4 * t369 * t68 + t60 / t420 * (-0.36580540352500000000000000000000000000000000000000e-1 * t379 - t424 - t425 - t426) / t67 - t372 - t394 + 0.18311447306006545054854346104378990962041954983034e-3 * t4 * t369 * t79 + 0.58482236226346462072622386637590534819724553404281e0 * t71 * t435 * t441 * t442)
  t450 = 0.58482236226346462072622386637590534819724553404281e0 * t414 * t80
  t455 = 0.18311447306006545054854346104378990962041954983034e-3 * t58 * t1 * t377 * t368 * t79
  t459 = 0.58482236226346462072622386637590534819724553404281e0 * t225 * t435 * t441 * t442
  t460 = t99 * t279
  t461 = 0.1e1 / t45
  t464 = f.my_piecewise3(t42, 0, 0.2e1 / 0.3e1 * t461 * t405)
  t465 = 0.1e1 / t50
  t468 = f.my_piecewise3(t49, 0, 0.2e1 / 0.3e1 * t465 * t409)
  t470 = t464 / 0.2e1 + t468 / 0.2e1
  t473 = 0.3e1 * t91 * t460 * t470
  t477 = t99 ** 2
  t478 = 0.1e1 / t477
  t479 = t89 * t478
  t484 = (-(t372 + t394 + t398 - t402 + t416 + t448 + t450 - t455 - t459) * t102 * t105 + 0.3e1 * t103 * t479 * t470) * t107
  t488 = t108 / t274 / t273
  t489 = t35 * t7
  t491 = 0.1e1 / t22 / t489
  t499 = 0.27801896084645508333333333333333333333333333333333e-3 * t491 * t113 * t116 * t54 * t121 * t102 * t89 * t128
  t500 = t112 ** 2
  t503 = t116 * t491
  t508 = 0.74083333333333333333333333333333333333333333333333e-2 * t110 / t500 * t503 * t54 * t121 * t129
  t515 = 0.7e1 / 0.72e2 * t117 / t8 / t489 * t54 * t121 * t130
  t517 = t117 * t120 * t104
  t525 = t117 * t120 * t121 * t19
  t527 = t124 * t5 * t102
  t528 = t108 ** 2
  t529 = 0.1e1 / t528
  t530 = t89 * t529
  t535 = t139 ** 2
  t538 = t127 / t535 * t244
  t541 = f.my_piecewise3(t42, 0, 0.5e1 / 0.3e1 * t93 * t405)
  t544 = f.my_piecewise3(t49, 0, 0.5e1 / 0.3e1 * t95 * t409)
  t554 = t141 * t478 * t128 * t243
  t561 = t243 * t246
  t563 = t141 * t104 * t529 * t561
  t564 = t249 * t251
  t565 = t564 * t116
  t566 = t254 * t268
  t573 = 0.5e1 / 0.3e1 * t4 * t369 * t230
  t577 = 4 ** (0.1e1 / 0.6e1)
  t579 = t4 * t368
  t580 = t577 * t163 * t579
  t582 = 0.10461750000000000000000000000000000000000000000000e-1 * t381
  t586 = 0.571528e-1 / t148 / t147 * t154 * t167 * (-0.14816666666666666666666666666666666666666666666667e-1 * t580 - t582)
  t587 = t149 * t151
  t590 = t57 * t162 * t166
  t594 = t156 * t395 * t160
  t597 = t157 / t158 / t262
  t599 = -0.12e2 * t594 + 0.12e2 * t597
  t606 = 0.1e1 / t14 / t11
  t611 = 0.84681398666666666666666666666666666666666666666666e-3 * t155 * t162 * t577 * t606 * t1 * t3 * t368
  t613 = -0.78718543330000000000000000000000000000000000000000e-1 * t580 - t382 - t385 - t390
  t616 = 0.13288165180e-1 * t177 * t613 * t184
  t617 = t4 * t6
  t621 = 0.11073470983333333333333333333333333333333333333333e-2 * t617 * t368 * t177 * t185
  t627 = 0.2e1 * t13 / t176 / t171 * t185 * t613
  t629 = t577 * t606 * t579
  t631 = t11 ** (-0.5e0)
  t633 = t631 * t1 * t378
  t638 = t178 * (0.15743708666000000000000000000000000000000000000000e0 * t629 - 0.12733196185000000000000000000000000000000000000000e-1 * t633 - 0.51086165526666666666666666666666666666666666666667e-2 * t381) * t184
  t639 = t176 ** 2
  t642 = t173 ** 2
  t646 = t13 / t639 * t183 / t642 * t613
  t648 = 0.4e1 * t396 * t221
  t650 = 0.4e1 * t400 * t221
  t654 = -0.73161080705000000000000000000000000000000000000000e-1 * t580 - t424 - t425 - t426
  t674 = t193 ** 2
  t677 = t190 ** 2
  t683 = -0.58299207766666666666666666666666666666666666666667e-1 * t580 - t438 - t439 - t440
  t685 = t210 * t683 * t216
  t692 = 0.1e1 / t209 / t204
  t700 = 0.11659841553333333333333333333333333333333333333333e0 * t629 - 0.37162156485000000000000000000000000000000000000001e-2 * t633 - 0.27959640330000000000000000000000000000000000000000e-2 * t381
  t704 = t209 ** 2
  t705 = 0.1e1 / t704
  t707 = t206 ** 2
  t708 = 0.1e1 / t707
  t713 = 0.63885170360e-2 * t194 * t654 * t200 - 0.53237641966666666666666666666666666666666666666667e-3 * t617 * t368 * t194 * t201 - 0.2e1 * t60 / t193 / t188 * t201 * t654 + t195 * (0.14632216141000000000000000000000000000000000000000e0 * t629 - 0.13082189292500000000000000000000000000000000000000e-1 * t633 - 0.32394954865000000000000000000000000000000000000000e-2 * t381) * t200 + t60 / t674 * t199 / t677 * t654 - t616 + t621 + t627 - t638 - t646 + 0.21973736767207854065825215325254789154450345979641e-2 * t685 - 0.18311447306006545054854346104378990962041954983034e-3 * t617 * t368 * t210 * t217 - 0.11696447245269292414524477327518106963944910680856e1 * t71 * t692 * t217 * t683 + 0.58482236226346462072622386637590534819724553404281e0 * t211 * t700 * t216 + 0.58482236226346462072622386637590534819724553404281e0 * t71 * t705 * t215 * t708 * t683
  t715 = t38 * t58 * t713
  t719 = 0.21973736767207854065825215325254789154450345979641e-2 * t58 * t685
  t726 = 0.18311447306006545054854346104378990962041954983034e-3 * t58 * t4 * t369 * t227
  t731 = 0.11696447245269292414524477327518106963944910680856e1 * t225 * t692 * t215 * t216 * t683
  t735 = 0.58482236226346462072622386637590534819724553404281e0 * t225 * t210 * t700 * t216
  t740 = 0.58482236226346462072622386637590534819724553404281e0 * t225 * t705 * t215 * t708 * t683
  t741 = -t586 - 0.285764e-1 * t587 * t413 * t590 + 0.285764e-1 * t155 * t599 * t166 + t611 - t616 + t621 + t627 - t638 - t646 - t648 + t650 - t38 * t414 * t220 - t715 - 0.21973736767207854065825215325254789154450345979641e-2 * t414 * t207 + t719 + 0.58482236226346462072622386637590534819724553404281e0 * t414 * t71 * t227 - t726 - t731 + t735 + t740
  t745 = t235 ** 2
  t746 = 0.1e1 / t745
  t749 = -0.74083333333333333333333333333333333333333333333333e-2 * t379 - t582
  t752 = 0.285764e-1 * t746 * t154 * t162 * t749
  t753 = t236 * t151
  t754 = t414 * t162
  t759 = t752 + 0.285764e-1 * t753 * t754 - 0.285764e-1 * t237 * t599 - t372 - t394 - t398 + t402 - t416 - t448 - t450 + t455 + t459
  t770 = 0.11710326490353909465020576131687242798353909465021e-1 * t245 * t252 * t503 * t268
  t772 = t140 * t104
  t773 = t102 * t90 * t772
  t774 = t128 * t243
  t782 = 0.57459117295175457567385649134860096906651948254069e-1 * t773 * t774 * t260 * t116 / t158 / t7 * t268
  t783 = -t499 + t508 - t515 - t517 * t126 * t127 * t128 * t470 / 0.12e2 - t525 * t527 * t530 * t484 / 0.24e2 - 0.43913724338827160493827160493827160493827160493828e-2 * t538 * t252 * t255 * t268 * (t541 / 0.2e1 + t544 / 0.2e1) - 0.13174117301648148148148148148148148148148148148148e-1 * t554 * t252 * t255 * t268 * t470 - 0.43913724338827160493827160493827160493827160493828e-2 * t563 * t565 * t566 * t484 + 0.43913724338827160493827160493827160493827160493828e-2 * t141 * t142 * (0.5e1 * t10 * t4 * t741 - 0.45e2 * t759 * params.eta - t573) * t270 - t770 + t782
  t788 = 0.1e1 / t278
  t790 = t91 * t100 * (t484 * t276 + t488 * t783 / 0.4e1) * t788
  t791 = r0 ** 2
  t797 = t405 / 0.2e1
  t798 = t289 * t797
  t802 = -t299 * t797
  t805 = t503 / 0.3e1
  t808 = t311 ** 2
  t810 = t303 / t808
  t816 = t308 * t491 / 0.3e1
  t819 = (-0.5e1 / 0.3e1 * tau0 / t283 / t791 * t290 + 0.5e1 / 0.3e1 * t286 * t798 + 0.5e1 / 0.3e1 * t296 * t802 + t805) * t312 - t810 * (0.3e1 / 0.10e2 * t304 * (0.5e1 / 0.3e1 * t798 + 0.5e1 / 0.3e1 * t802) - t816)
  t820 = f.my_piecewise3(t315, 0, t819)
  t823 = t317 ** 2
  t825 = t316 / t823
  t830 = f.my_piecewise3(t323, 0, t819)
  t845 = t340 ** 2
  t846 = 0.1e1 / t845
  t847 = f.my_piecewise3(t323, t819, 0)
  t851 = f.my_piecewise5(t314, (-0.64e0 * t820 * t318 - 0.64e0 * t825 * t820) * t321, t322, -0.64e0 * t830 - 0.8704e0 * t324 * t830 - 0.4607056813647e1 * t326 * t830 + 0.12246241008700e2 * t328 * t830 - 0.9578551181030e1 * t330 * t830 + 0.3101306810232e1 * t332 * t830 - 0.362942158544e0 * t334 * t830, -0.105e1 * t846 * t847 * t343)
  t853 = t746 * t749
  t860 = t349 / t355 / t354
  t866 = 0.1e1 / t359
  t871 = (0.285764e-1 * t853 + 0.285764e-1 * (-0.10000000000000000000000000000000000000000000000000e1 * t853 * t348 * t357 - 0.14225094736250905555555555555555555555555555555555e-1 * t860 * t246 * t564 * t503) * t866) * t154 * t162
  t872 = t362 * t151
  t875 = t363 * t599 - t754 * t872 - t372 - t394 - t398 + t402 - t416 - t448 - t450 + t455 + t459 - t473 - t790 + t871
  t877 = t345 * t875 + t365 * t851 + t372 + t394 + t398 - t402 + t416 + t448 + t450 - t455 - t459 + t473 + t790
  vrho_0_ = t7 * t877 + t281 - t31 + t366 + t84 + t86
  t879 = -t39 - t404
  t882 = f.my_piecewise3(t42, 0, 0.4e1 / 0.3e1 * t45 * t879)
  t883 = -t879
  t886 = f.my_piecewise3(t49, 0, 0.4e1 / 0.3e1 * t50 * t883)
  t887 = t882 + t886
  t888 = t887 * t57
  t890 = t38 * t888 * t82
  t892 = 0.58482236226346462072622386637590534819724553404281e0 * t888 * t80
  t895 = f.my_piecewise3(t42, 0, 0.2e1 / 0.3e1 * t461 * t879)
  t898 = f.my_piecewise3(t49, 0, 0.2e1 / 0.3e1 * t465 * t883)
  t900 = t895 / 0.2e1 + t898 / 0.2e1
  t903 = 0.3e1 * t91 * t460 * t900
  t911 = (-(t372 + t394 - t398 - t402 + t890 + t448 + t892 - t455 - t459) * t102 * t105 + 0.3e1 * t103 * t479 * t900) * t107
  t924 = f.my_piecewise3(t42, 0, 0.5e1 / 0.3e1 * t93 * t879)
  t927 = f.my_piecewise3(t49, 0, 0.5e1 / 0.3e1 * t95 * t883)
  t948 = 0.12e2 * t594 + 0.12e2 * t597
  t959 = -t586 - 0.285764e-1 * t587 * t887 * t590 + 0.285764e-1 * t155 * t948 * t166 + t611 - t616 + t621 + t627 - t638 - t646 + t648 + t650 - t38 * t888 * t220 - t715 - 0.21973736767207854065825215325254789154450345979641e-2 * t888 * t207 + t719 + 0.58482236226346462072622386637590534819724553404281e0 * t888 * t71 * t227 - t726 - t731 + t735 + t740
  t963 = t888 * t162
  t968 = t752 + 0.285764e-1 * t753 * t963 - 0.285764e-1 * t237 * t948 - t372 - t394 + t398 + t402 - t890 - t448 - t892 + t455 + t459
  t976 = -t499 + t508 - t515 - t517 * t126 * t127 * t128 * t900 / 0.12e2 - t525 * t527 * t530 * t911 / 0.24e2 - 0.43913724338827160493827160493827160493827160493828e-2 * t538 * t252 * t255 * t268 * (t924 / 0.2e1 + t927 / 0.2e1) - 0.13174117301648148148148148148148148148148148148148e-1 * t554 * t252 * t255 * t268 * t900 - 0.43913724338827160493827160493827160493827160493828e-2 * t563 * t565 * t566 * t911 + 0.43913724338827160493827160493827160493827160493828e-2 * t141 * t142 * (0.5e1 * t10 * t4 * t959 - 0.45e2 * params.eta * t968 - t573) * t270 - t770 + t782
  t982 = t91 * t100 * (t911 * t276 + t488 * t976 / 0.4e1) * t788
  t983 = t879 / 0.2e1
  t984 = t289 * t983
  t987 = r1 ** 2
  t994 = -t299 * t983
  t1005 = (0.5e1 / 0.3e1 * t286 * t984 - 0.5e1 / 0.3e1 * tau1 / t293 / t987 * t300 + 0.5e1 / 0.3e1 * t296 * t994 + t805) * t312 - t810 * (0.3e1 / 0.10e2 * t304 * (0.5e1 / 0.3e1 * t984 + 0.5e1 / 0.3e1 * t994) - t816)
  t1006 = f.my_piecewise3(t315, 0, t1005)
  t1013 = f.my_piecewise3(t323, 0, t1005)
  t1028 = f.my_piecewise3(t323, t1005, 0)
  t1032 = f.my_piecewise5(t314, (-0.64e0 * t1006 * t318 - 0.64e0 * t825 * t1006) * t321, t322, -0.64e0 * t1013 - 0.8704e0 * t324 * t1013 - 0.4607056813647e1 * t326 * t1013 + 0.12246241008700e2 * t328 * t1013 - 0.9578551181030e1 * t330 * t1013 + 0.3101306810232e1 * t332 * t1013 - 0.362942158544e0 * t334 * t1013, -0.105e1 * t846 * t1028 * t343)
  t1036 = t363 * t948 - t872 * t963 - t372 - t394 + t398 + t402 - t448 + t455 + t459 + t871 - t890 - t892 - t903 - t982
  t1038 = t1032 * t365 + t345 * t1036 + t372 + t394 - t398 - t402 + t448 - t455 - t459 + t890 + t892 + t903 + t982
  vrho_1_ = t7 * t1038 + t281 - t31 + t366 + t84 + t86
  t1040 = t91 * t100
  t1042 = t114 * t122 * t130
  t1047 = t251 * t254
  t1050 = t127 * t772 * t128 * t561 * t249 * t1047 * t268
  t1056 = t773 * t774 * t260 / t158 * t268
  t1062 = t1040 * t488 * (t1042 / 0.24e2 + 0.43913724338827160493827160493827160493827160493828e-2 * t1050 - 0.21547168985690796587769618425572536339994480595275e-1 * t1056) * t788 / 0.4e1
  t1066 = -t254 * t810 * params.eta - t254 * t312
  t1067 = t1066 / 0.8e1
  t1068 = f.my_piecewise3(t315, 0, t1067)
  t1075 = f.my_piecewise3(t323, 0, t1067)
  t1090 = f.my_piecewise3(t323, t1067, 0)
  t1094 = f.my_piecewise5(t314, (-0.64e0 * t1068 * t318 - 0.64e0 * t825 * t1068) * t321, t322, -0.64e0 * t1075 - 0.8704e0 * t324 * t1075 - 0.4607056813647e1 * t326 * t1075 + 0.12246241008700e2 * t328 * t1075 - 0.9578551181030e1 * t330 * t1075 + 0.3101306810232e1 * t332 * t1075 - 0.362942158544e0 * t334 * t1075, -0.105e1 * t846 * t1090 * t343)
  t1100 = t860 * t250 * t1047 * t866 * t154 * t162
  vsigma_0_ = t7 * (t1062 + t1094 * t365 + t345 * (0.15243824895787514156916666666666666666666666666666e-3 * t1100 - t1062))
  t1112 = t1040 * t488 * (t1042 / 0.12e2 + 0.87827448677654320987654320987654320987654320987656e-2 * t1050 - 0.43094337971381593175539236851145072679988961190551e-1 * t1056) * t788 / 0.4e1
  t1113 = t1066 / 0.4e1
  t1114 = f.my_piecewise3(t315, 0, t1113)
  t1121 = f.my_piecewise3(t323, 0, t1113)
  t1136 = f.my_piecewise3(t323, t1113, 0)
  t1140 = f.my_piecewise5(t314, (-0.64e0 * t1114 * t318 - 0.64e0 * t825 * t1114) * t321, t322, -0.64e0 * t1121 - 0.8704e0 * t324 * t1121 - 0.4607056813647e1 * t326 * t1121 + 0.12246241008700e2 * t328 * t1121 - 0.9578551181030e1 * t330 * t1121 + 0.3101306810232e1 * t332 * t1121 - 0.362942158544e0 * t334 * t1121, -0.105e1 * t846 * t1136 * t343)
  vsigma_1_ = t7 * (t1112 + t1140 * t365 + t345 * (0.30487649791575028313833333333333333333333333333331e-3 * t1100 - t1112))
  vsigma_2_ = vsigma_0_
  vlapl_0_ = 0.0e0
  vlapl_1_ = 0.0e0
  t1147 = t285 * t290 * t312
  t1148 = f.my_piecewise3(t315, 0, t1147)
  t1155 = f.my_piecewise3(t323, 0, t1147)
  t1170 = f.my_piecewise3(t323, t1147, 0)
  t1174 = f.my_piecewise5(t314, (-0.64e0 * t1148 * t318 - 0.64e0 * t825 * t1148) * t321, t322, -0.64e0 * t1155 - 0.8704e0 * t324 * t1155 - 0.4607056813647e1 * t326 * t1155 + 0.12246241008700e2 * t328 * t1155 - 0.9578551181030e1 * t330 * t1155 + 0.3101306810232e1 * t332 * t1155 - 0.362942158544e0 * t334 * t1155, -0.105e1 * t846 * t1170 * t343)
  vtau_0_ = t7 * t1174 * t365
  t1177 = t295 * t300 * t312
  t1178 = f.my_piecewise3(t315, 0, t1177)
  t1185 = f.my_piecewise3(t323, 0, t1177)
  t1200 = f.my_piecewise3(t323, t1177, 0)
  t1204 = f.my_piecewise5(t314, (-0.64e0 * t1178 * t318 - 0.64e0 * t825 * t1178) * t321, t322, -0.64e0 * t1185 - 0.8704e0 * t324 * t1185 - 0.4607056813647e1 * t326 * t1185 + 0.12246241008700e2 * t328 * t1185 - 0.9578551181030e1 * t330 * t1185 + 0.3101306810232e1 * t332 * t1185 - 0.362942158544e0 * t334 * t1185, -0.105e1 * t846 * t1200 * t343)
  vtau_1_ = t7 * t1204 * t365
  _b = lambda x: (jnp.asarray(x) + jnp.zeros_like(r0))
  vrho_0_ = _b(vrho_0_)
  vrho_1_ = _b(vrho_1_)
  vsigma_0_ = _b(vsigma_0_)
  vsigma_1_ = _b(vsigma_1_)
  vsigma_2_ = _b(vsigma_2_)
  vlapl_0_ = _b(vlapl_0_)
  vlapl_1_ = _b(vlapl_1_)
  vtau_0_ = _b(vtau_0_)
  vtau_1_ = _b(vtau_1_)
  res = {'vrho': jnp.stack([vrho_0_, vrho_1_], axis=-1), 'vsigma': jnp.stack([vsigma_0_, vsigma_1_, vsigma_2_], axis=-1), 'vlapl': jnp.stack([vlapl_0_, vlapl_1_], axis=-1), 'vtau':  jnp.stack([vtau_0_, vtau_1_], axis=-1)}
  return res

def unpol_vxc(p, r, s=None, l=None, tau=None):
  f = funcs(p)
  params = f.params
  r0, s0, l0, tau0 = r, s, l, tau
  params_eta_raw = params.eta
  if isinstance(params_eta_raw, (str, bytes, dict)):
    params_eta = params_eta_raw
  else:
    try:
      params_eta_seq = list(params_eta_raw)
    except TypeError:
      params_eta = params_eta_raw
    else:
      params_eta_seq = np.asarray(params_eta_seq, dtype=np.float64)
      params_eta = np.concatenate((np.array([np.nan], dtype=np.float64), params_eta_seq))

  params_c1 = 0.667
  params_dp2 = 0.361

  params_pp = np.array([np.nan, 1, 1, 1], dtype=np.float64)

  params_a = np.array([np.nan, 0.0310907, 0.01554535, 0.0168869], dtype=np.float64)

  params_alpha1 = np.array([np.nan, 0.2137, 0.20548, 0.11125], dtype=np.float64)

  params_beta1 = np.array([np.nan, 7.5957, 14.1189, 10.357], dtype=np.float64)

  params_beta2 = np.array([np.nan, 3.5876, 6.1977, 3.6231], dtype=np.float64)

  params_beta3 = np.array([np.nan, 1.6382, 3.3662, 0.88026], dtype=np.float64)

  params_beta4 = np.array([np.nan, 0.49294, 0.62517, 0.49671], dtype=np.float64)

  params_fz20 = 1.7099209341613657

  params_gamma = (1 - jnp.log(2)) / jnp.pi ** 2

  beta_a = 0.06672455060314922

  beta_b = 0.1

  beta_c = 0.1778

  scan_b1c = 0.0285764

  scan_b2c = 0.0889

  scan_b3c = 0.125541

  scan_chi_infty = 0.12802585262625815

  scan_G_cnst = 2.363

  params_c2 = 1.5

  params_d = 0.7

  rscan_fc = np.array([np.nan, -0.051848879792, 0.516884468372, -1.915710236206, 3.061560252175, -1.535685604549, -0.4352, -0.64, 1], dtype=np.float64)

  rscan_f_alpha_small = lambda a, ff: jnp.sum(jnp.array([ff[8 - i] * a ** i for i in range(0, 7 + 1)]), axis=0)

  r2scan_alpha = lambda z, xt, ts0, ts1: (f.t_total(z, ts0, ts1) - xt ** 2 / 8) / (K_FACTOR_C * f.t_total(z, 1, 1) + params_eta * xt ** 2 / 8)

  r2scan_d = lambda z: (f.opz_pow_n(z, 5 / 3) + f.opz_pow_n(-z, 5 / 3)) / 2

  r2scan_dfc2 = lambda ff: jnp.sum(jnp.array([i * ff[8 - i] for i in range(1, 7 + 1)]), axis=0)

  g_aux = lambda k, rs: params_beta1[k] * jnp.sqrt(rs) + params_beta2[k] * rs + params_beta3[k] * rs ** 1.5 + params_beta4[k] * rs ** (params_pp[k] + 1)

  mgamma = params_gamma

  mbeta = lambda rs: beta_a * (1 + beta_b * rs) / (1 + beta_c * rs)

  scan_eclda0 = lambda rs: -scan_b1c / (1 + scan_b2c * jnp.sqrt(rs) + scan_b3c * rs)

  scan_g_infty = lambda s: 1 / (1 + 4 * scan_chi_infty * s ** 2) ** (1 / 4)

  scan_Gc = lambda z: (1 - scan_G_cnst * (2 ** (1 / 3) - 1) * f.f_zeta(z)) * (1 - z ** 12)

  r2scan_f_alpha_neg = lambda a: jnp.exp(-params_c1 * a / (1 - a))

  rscan_f_alpha_large = lambda a: -params_d * jnp.exp(params_c2 / (1 - a))

  g = lambda k, rs: -2 * params_a[k] * (1 + params_alpha1[k] * rs) * jnp.log(1 + 1 / (2 * params_a[k] * g_aux(k, rs)))

  scan_H0 = lambda rs, s: scan_b1c * jnp.log(1 + (jnp.exp(-scan_eclda0(rs) / scan_b1c) - 1) * (1 - scan_g_infty(s)))

  r2scan_elsda0 = lambda rs, z: scan_eclda0(rs) * scan_Gc(z)

  r2scan_f_alpha = lambda a, ff: f.my_piecewise5(a <= 0, r2scan_f_alpha_neg(jnp.minimum(a, 0)), a <= 2.5, rscan_f_alpha_small(jnp.minimum(a, 2.5), ff), rscan_f_alpha_large(jnp.maximum(a, 2.5)))

  f_pw = lambda rs, zeta: g(1, rs) + zeta ** 4 * f.f_zeta(zeta) * (g(2, rs) - g(1, rs) + g(3, rs) / params_fz20) - f.f_zeta(zeta) * g(3, rs) / params_fz20

  scan_e0 = lambda rs, z, s: (scan_eclda0(rs) + scan_H0(rs, s)) * scan_Gc(z)

  r2scan_delsda0 = lambda rs, z: (lambda _jac: jnp.diag(_jac) if _jac.ndim == 2 else _jac)(jax.jacrev(lambda x1: r2scan_elsda0(x1, z))(rs))

  w1 = lambda rs, z: jnp.exp(-f_pw(rs, z) / (mgamma * f.mphi(z) ** 3)) - 1

  r2scan_elsda1 = lambda rs, z: f_pw(rs, z)

  r2scan_ec0 = lambda rs, z, s: scan_e0(rs, z, s)

  r2scan_y = lambda rs, z, t: mbeta(rs) * t ** 2 / (mgamma * w1(rs, z))

  r2scan_delsda1 = lambda rs, z: (lambda _jac: jnp.diag(_jac) if _jac.ndim == 2 else _jac)(jax.jacrev(lambda x1: r2scan_elsda1(x1, z))(rs))

  r2scan_dy = lambda rs, z, s: r2scan_dfc2(rscan_fc) / (27 * mgamma * r2scan_d(z) * f.mphi(z) ** 3 * w1(rs, z)) * (+20 * rs * (r2scan_delsda0(rs, z) - r2scan_delsda1(rs, z)) - 45 * params_eta * (r2scan_elsda0(rs, z) - r2scan_elsda1(rs, z))) * s ** 2 * jnp.exp(-s ** 4 / params_dp2 ** 4)

  r2scan_g = lambda rs, z, s, t: 1 / (1 + 4 * (r2scan_y(rs, z, t) - r2scan_dy(rs, z, s))) ** (1 / 4)

  fH = lambda rs, z, s, t: mgamma * f.mphi(z) ** 3 * jnp.log(1 + w1(rs, z) * (1 - r2scan_g(rs, z, s, t)))

  r2scan_ec1 = lambda rs, z, s, t: f_pw(rs, z) + fH(rs, z, s, t)

  r2scan_f = lambda rs, z, xt, xs0, xs1, ts0, ts1: r2scan_ec1(rs, z, X2S * 2 ** (1 / 3) * xt, f.tt(rs, z, xt)) + r2scan_f_alpha(r2scan_alpha(z, xt, ts0, ts1), rscan_fc) * (+r2scan_ec0(rs, z, X2S * 2 ** (1 / 3) * xt) - r2scan_ec1(rs, z, X2S * 2 ** (1 / 3) * xt, f.tt(rs, z, xt)))

  functional_body = lambda rs, z, xt, xs0, xs1, us0, us1, ts0, ts1: r2scan_f(rs, z, xt, xs0, xs1, ts0, ts1)

  t1 = 3 ** (0.1e1 / 0.3e1)
  t3 = (0.1e1 / jnp.pi) ** (0.1e1 / 0.3e1)
  t4 = t1 * t3
  t5 = 4 ** (0.1e1 / 0.3e1)
  t6 = t5 ** 2
  t7 = r0 ** (0.1e1 / 0.3e1)
  t9 = t6 / t7
  t10 = t4 * t9
  t12 = 0.621814e-1 + 0.33220412950000000000000000000000000000000000000000e-2 * t10
  t13 = jnp.sqrt(t10)
  t15 = 0.55770497660000000000000000000000000000000000000000e-1 * t10
  t16 = t10 ** 0.15e1
  t17 = 0.12733196185000000000000000000000000000000000000000e-1 * t16
  t18 = t1 ** 2
  t19 = t3 ** 2
  t20 = t18 * t19
  t21 = t7 ** 2
  t24 = t20 * t5 / t21
  t25 = 0.76629248290000000000000000000000000000000000000000e-2 * t24
  t26 = 0.23615562999000000000000000000000000000000000000000e0 * t13 + t15 + t17 + t25
  t28 = 0.1e1 + 0.1e1 / t26
  t29 = jnp.log(t28)
  t30 = t12 * t29
  t31 = 0.1e1 <= f.p.zeta_threshold
  t32 = f.p.zeta_threshold ** (0.1e1 / 0.3e1)
  t34 = f.my_piecewise3(t31, t32 * f.p.zeta_threshold, 1)
  t36 = 0.2e1 * t34 - 0.2e1
  t37 = 2 ** (0.1e1 / 0.3e1)
  t40 = 0.1e1 / (0.2e1 * t37 - 0.2e1)
  t41 = t36 * t40
  t43 = 0.337738e-1 + 0.93933381250000000000000000000000000000000000000000e-3 * t10
  t45 = 0.30591463695000000000000000000000000000000000000000e-1 * t10
  t46 = 0.37162156485000000000000000000000000000000000000000e-2 * t16
  t47 = 0.41939460495000000000000000000000000000000000000000e-2 * t24
  t48 = 0.17489762330000000000000000000000000000000000000000e0 * t13 + t45 + t46 + t47
  t50 = 0.1e1 + 0.1e1 / t48
  t51 = jnp.log(t50)
  t54 = 0.58482236226346462072622386637590534819724553404281e0 * t41 * t43 * t51
  t55 = jnp.log(0.2e1)
  t56 = 0.1e1 - t55
  t57 = jnp.pi ** 2
  t58 = 0.1e1 / t57
  t59 = t56 * t58
  t60 = t32 ** 2
  t61 = f.my_piecewise3(t31, t60, 1)
  t62 = t61 ** 2
  t63 = t62 * t61
  t65 = 0.1e1 / t56
  t67 = 0.1e1 / t63
  t70 = jnp.exp(-(-t30 + t54) * t65 * t57 * t67)
  t71 = t70 - 0.1e1
  t73 = 0.66724550603149220e-1 + 0.16681137650787305000000000000000000000000000000000e-2 * t10
  t75 = 0.1e1 + 0.44450000000000000000000000000000000000000000000000e-1 * t10
  t76 = 0.1e1 / t75
  t77 = t73 * t76
  t78 = t77 * s0
  t79 = r0 ** 2
  t82 = 0.1e1 / t7 / t79 * t37
  t83 = 0.1e1 / t62
  t84 = t82 * t83
  t86 = 0.1e1 / t3
  t89 = t65 * t57
  t90 = 0.1e1 / t71
  t91 = t89 * t90
  t92 = t18 * t86 * t5 * t91
  t96 = f.my_piecewise3(t31, t60 * f.p.zeta_threshold, 1)
  t97 = 0.1e1 / t96
  t98 = t89 * t97
  t99 = t67 * t90
  t100 = jnp.sqrt(0.4e1)
  t101 = t100 * t13
  t103 = 0.31385250000000000000000000000000000000000000000000e-1 * t10
  t104 = 0.1e1 + 0.22225000000000000000000000000000000000000000000000e-1 * t101 + t103
  t105 = t104 ** 2
  t111 = 0.1e1 - (0.2363e1 * t37 - 0.2363e1) * t36 * t40
  t112 = 0.1e1 / t105 * t111
  t113 = 0.1e1 / t13
  t114 = t100 * t113
  t116 = 0.44450000000000000000000000000000000000000000000000e-1 * t114 + 0.125541e0
  t120 = 0.11807781499500000000000000000000000000000000000000e0 * t101 + t15 + t17 + t25
  t122 = 0.1e1 + 0.1e1 / t120
  t123 = jnp.log(t122)
  t125 = t120 ** 2
  t126 = 0.1e1 / t125
  t127 = t12 * t126
  t129 = t10 ** 0.5e0
  t132 = 0.23615562999000000000000000000000000000000000000000e0 * t114 + 0.22308199064e0 + 0.76399177110000000000000000000000000000000000000000e-1 * t129 + 0.15325849658000000000000000000000000000000000000000e-1 * t10
  t133 = 0.1e1 / t122
  t134 = t132 * t133
  t137 = 0.87448811650000000000000000000000000000000000000000e-1 * t101 + t45 + t46 + t47
  t139 = 0.1e1 + 0.1e1 / t137
  t140 = jnp.log(t139)
  t143 = t41 * t43
  t144 = t137 ** 2
  t145 = 0.1e1 / t144
  t149 = 0.17489762330000000000000000000000000000000000000000e0 * t114 + 0.12236585478e0 + 0.22297293891000000000000000000000000000000000000000e-1 * t129 + 0.83878920990000000000000000000000000000000000000000e-2 * t10
  t151 = 0.1e1 / t139
  t152 = t145 * t149 * t151
  t155 = 0.285764e-1 * t112 * t116 + 0.13288165180e-1 * t123 - t127 * t134 - 0.21973736767207854065825215325254789154450345979641e-2 * t41 * t140 + 0.58482236226346462072622386637590534819724553404281e0 * t143 * t152
  t160 = 0.1e1 + 0.44450000000000000000000000000000000000000000000000e-1 * t13 + t103
  t161 = 0.1e1 / t160
  t167 = 0.5e1 * t4 * t9 * t155 - 0.45e2 * params.eta * (-0.285764e-1 * t161 * t111 + t30 - t54)
  t169 = t98 * t99 * t167
  t170 = 6 ** (0.1e1 / 0.3e1)
  t171 = t57 ** (0.1e1 / 0.3e1)
  t172 = t171 ** 2
  t173 = 0.1e1 / t172
  t174 = t170 * t173
  t175 = t37 ** 2
  t176 = t174 * t175
  t178 = 0.1e1 / t21 / t79
  t179 = s0 * t178
  t180 = t170 ** 2
  t184 = s0 ** 2
  t186 = t79 ** 2
  t193 = jnp.exp(-0.20444604078896369094486892376367646458587560067351e0 * t180 / t171 / t57 * t37 * t184 / t7 / t186 / r0)
  t195 = t176 * t179 * t193
  t198 = 0.1e1 + t78 * t84 * t92 / 0.24e2 + 0.43913724338827160493827160493827160493827160493828e-2 * t169 * t195
  t199 = t198 ** (0.1e1 / 0.4e1)
  t201 = 0.1e1 - 0.1e1 / t199
  t203 = t71 * t201 + 0.1e1
  t204 = jnp.log(t203)
  t206 = t59 * t63 * t204
  t208 = 0.1e1 / t21 / r0
  t211 = tau0 * t208 - t179 / 0.8e1
  t215 = params.eta * s0
  t218 = 0.3e1 / 0.20e2 * t180 * t172 * t37 + t215 * t178 / 0.8e1
  t219 = 0.1e1 / t218
  t220 = t211 * t219
  t221 = t220 <= 0.0e0
  t222 = 0.0e0 < t220
  t223 = f.my_piecewise3(t222, 0, t220)
  t224 = 0.1e1 - t223
  t225 = 0.1e1 / t224
  t228 = jnp.exp(-0.64e0 * t223 * t225)
  t229 = t220 <= 0.25e1
  t230 = 0.25e1 < t220
  t231 = f.my_piecewise3(t230, 0.25e1, t220)
  t233 = t231 ** 2
  t235 = t233 * t231
  t237 = t233 ** 2
  t239 = t237 * t231
  t241 = t237 * t233
  t246 = f.my_piecewise3(t230, t220, 0.25e1)
  t247 = 0.1e1 - t246
  t250 = jnp.exp(0.15e1 / t247)
  t252 = f.my_piecewise5(t221, t228, t229, 0.1e1 - 0.64e0 * t231 - 0.4352e0 * t233 - 0.1535685604549e1 * t235 + 0.3061560252175e1 * t237 - 0.1915710236206e1 * t239 + 0.516884468372e0 * t241 - 0.51848879792e-1 * t237 * t235, -0.7e0 * t250)
  t255 = jnp.exp(0.10000000000000000000000000000000000000000000000000e1 * t161)
  t256 = t255 - 0.1e1
  t261 = 0.1e1 + 0.21337642104376358333333333333333333333333333333333e-1 * t174 * t175 * s0 * t178
  t262 = t261 ** (0.1e1 / 0.4e1)
  t264 = 0.1e1 - 0.1e1 / t262
  t266 = t256 * t264 + 0.1e1
  t267 = jnp.log(t266)
  t271 = (-0.285764e-1 * t161 + 0.285764e-1 * t267) * t111 + t30 - t54 - t206
  t274 = 0.1e1 / t7 / r0
  t275 = t6 * t274
  t278 = 0.11073470983333333333333333333333333333333333333333e-2 * t4 * t275 * t29
  t279 = t26 ** 2
  t283 = t3 * t6
  t284 = t283 * t274
  t285 = t113 * t1 * t284
  t287 = t4 * t275
  t288 = 0.18590165886666666666666666666666666666666666666667e-1 * t287
  t290 = t129 * t1 * t284
  t291 = 0.63665980925000000000000000000000000000000000000000e-2 * t290
  t293 = t20 * t5 * t208
  t294 = 0.51086165526666666666666666666666666666666666666667e-2 * t293
  t298 = t12 / t279 * (-0.39359271665000000000000000000000000000000000000000e-1 * t285 - t288 - t291 - t294) / t28
  t303 = 0.18311447306006545054854346104378990962041954983034e-3 * t41 * t1 * t283 * t274 * t51
  t304 = t48 ** 2
  t307 = 0.10197154565000000000000000000000000000000000000000e-1 * t287
  t308 = 0.18581078242500000000000000000000000000000000000000e-2 * t290
  t309 = 0.27959640330000000000000000000000000000000000000000e-2 * t293
  t315 = 0.58482236226346462072622386637590534819724553404281e0 * t143 / t304 * (-0.29149603883333333333333333333333333333333333333333e-1 * t285 - t307 - t308 - t309) / t50
  t316 = t278 + t298 - t303 - t315
  t324 = t71 / t199 / t198
  t325 = t79 * r0
  t327 = 0.1e1 / t21 / t325
  t336 = t75 ** 2
  t339 = s0 * t327
  t352 = t62 ** 2
  t359 = t56 ** 2
  t360 = 0.1e1 / t359
  t362 = t57 ** 2
  t363 = t71 ** 2
  t364 = 0.1e1 / t363
  t366 = t316 * t70
  t376 = t167 * t170
  t379 = t173 * t175
  t392 = 4 ** (0.1e1 / 0.6e1)
  t394 = t4 * t274
  t395 = t392 * t113 * t394
  t397 = 0.10461750000000000000000000000000000000000000000000e-1 * t287
  t404 = 0.1e1 / t13 / t10
  t411 = -0.78718543330000000000000000000000000000000000000000e-1 * t395 - t288 - t291 - t294
  t427 = t392 * t404 * t394
  t429 = t10 ** (-0.5e0)
  t431 = t429 * t1 * t284
  t437 = t125 ** 2
  t440 = t122 ** 2
  t446 = -0.58299207766666666666666666666666666666666666666667e-1 * t395 - t307 - t308 - t309
  t470 = t144 ** 2
  t473 = t139 ** 2
  t479 = -0.571528e-1 / t105 / t104 * t111 * t116 * (-0.14816666666666666666666666666666666666666666666667e-1 * t395 - t397) + 0.84681398666666666666666666666666666666666666666666e-3 * t112 * t392 * t404 * t1 * t3 * t274 - 0.13288165180e-1 * t126 * t411 * t133 + 0.11073470983333333333333333333333333333333333333333e-2 * t4 * t6 * t274 * t126 * t134 + 0.2e1 * t12 / t125 / t120 * t134 * t411 - t127 * (0.15743708666000000000000000000000000000000000000000e0 * t427 - 0.12733196185000000000000000000000000000000000000000e-1 * t431 - 0.51086165526666666666666666666666666666666666666667e-2 * t287) * t133 - t12 / t437 * t132 / t440 * t411 + 0.21973736767207854065825215325254789154450345979641e-2 * t41 * t145 * t446 * t151 - 0.18311447306006545054854346104378990962041954983034e-3 * t41 * t4 * t275 * t152 - 0.11696447245269292414524477327518106963944910680856e1 * t143 / t144 / t137 * t149 * t151 * t446 + 0.58482236226346462072622386637590534819724553404281e0 * t143 * t145 * (0.11659841553333333333333333333333333333333333333333e0 * t427 - 0.37162156485000000000000000000000000000000000000001e-2 * t431 - 0.27959640330000000000000000000000000000000000000000e-2 * t287) * t151 + 0.58482236226346462072622386637590534819724553404281e0 * t143 / t470 * t149 / t473 * t446
  t483 = t160 ** 2
  t484 = 0.1e1 / t483
  t487 = -0.74083333333333333333333333333333333333333333333333e-2 * t285 - t397
  t503 = t97 * t67
  t504 = t65 * t58 * t503
  t505 = t90 * t167
  t507 = t186 ** 2
  t520 = 0.1e1 / t203
  t522 = t59 * t63 * (-t316 * t65 * t57 * t67 * t70 * t201 + t324 * (-0.27801896084645508333333333333333333333333333333333e-3 * t327 * t76 * s0 * t37 * t83 * t65 * t57 * t90 + 0.74083333333333333333333333333333333333333333333333e-2 * t73 / t336 * t339 * t37 * t83 * t91 - 0.7e1 / 0.72e2 * t78 / t7 / t325 * t37 * t83 * t92 + t78 * t82 / t352 / t61 * t18 * t86 * t5 * t360 * t362 * t364 * t366 / 0.24e2 + 0.43913724338827160493827160493827160493827160493828e-2 * t360 * t362 * t97 / t352 / t62 * t364 * t376 * t379 * s0 * t178 * t193 * t366 + 0.43913724338827160493827160493827160493827160493828e-2 * t98 * t99 * (-0.5e1 / 0.3e1 * t4 * t275 * t155 + 0.5e1 * t4 * t9 * t479 - 0.45e2 * params.eta * (0.285764e-1 * t484 * t111 * t487 - t278 - t298 + t303 + t315)) * t195 - 0.11710326490353909465020576131687242798353909465021e-1 * t169 * t176 * t339 * t193 + 0.57459117295175457567385649134860096906651948254069e-1 * t504 * t505 * t184 * s0 / t507 / r0 * t193) / 0.4e1) * t520
  t528 = t218 ** 2
  t530 = t211 / t528
  t534 = (-0.5e1 / 0.3e1 * tau0 * t178 + t339 / 0.3e1) * t219 + t530 * t215 * t327 / 0.3e1
  t535 = f.my_piecewise3(t222, 0, t534)
  t538 = t224 ** 2
  t540 = t223 / t538
  t545 = f.my_piecewise3(t230, 0, t534)
  t560 = t247 ** 2
  t561 = 0.1e1 / t560
  t562 = f.my_piecewise3(t230, t534, 0)
  t566 = f.my_piecewise5(t221, (-0.64e0 * t535 * t225 - 0.64e0 * t540 * t535) * t228, t229, -0.64e0 * t545 - 0.8704e0 * t231 * t545 - 0.4607056813647e1 * t233 * t545 + 0.12246241008700e2 * t235 * t545 - 0.9578551181030e1 * t237 * t545 + 0.3101306810232e1 * t239 * t545 - 0.362942158544e0 * t241 * t545, -0.105e1 * t561 * t562 * t250)
  t568 = t484 * t487
  t575 = t256 / t262 / t261
  t581 = 0.1e1 / t266
  vrho_0_ = -t30 + t54 + t206 + t252 * t271 + r0 * (t278 + t298 - t303 - t315 + t522 + t566 * t271 + t252 * ((0.285764e-1 * t568 + 0.285764e-1 * (-0.10000000000000000000000000000000000000000000000000e1 * t568 * t255 * t264 - 0.14225094736250905555555555555555555555555555555555e-1 * t575 * t170 * t379 * t339) * t581) * t111 - t278 - t298 + t303 + t315 - t522))
  t597 = t175 * t178
  t612 = t59 * t63 * t324 * (t77 * t84 * t92 / 0.24e2 + 0.43913724338827160493827160493827160493827160493828e-2 * t89 * t503 * t90 * t376 * t173 * t597 * t193 - 0.21547168985690796587769618425572536339994480595275e-1 * t504 * t505 * t184 / t507 * t193) * t520 / 0.4e1
  t617 = -t530 * params.eta * t178 / 0.8e1 - t178 * t219 / 0.8e1
  t618 = f.my_piecewise3(t222, 0, t617)
  t625 = f.my_piecewise3(t230, 0, t617)
  t640 = f.my_piecewise3(t230, t617, 0)
  t644 = f.my_piecewise5(t221, (-0.64e0 * t618 * t225 - 0.64e0 * t540 * t618) * t228, t229, -0.64e0 * t625 - 0.8704e0 * t231 * t625 - 0.4607056813647e1 * t233 * t625 + 0.12246241008700e2 * t235 * t625 - 0.9578551181030e1 * t237 * t625 + 0.3101306810232e1 * t239 * t625 - 0.362942158544e0 * t241 * t625, -0.105e1 * t561 * t640 * t250)
  vsigma_0_ = r0 * (t612 + t644 * t271 + t252 * (0.15243824895787514156916666666666666666666666666666e-3 * t575 * t174 * t597 * t581 * t111 - t612))
  vlapl_0_ = 0.0e0
  t654 = t208 * t219
  t655 = f.my_piecewise3(t222, 0, t654)
  t662 = f.my_piecewise3(t230, 0, t654)
  t677 = f.my_piecewise3(t230, t654, 0)
  t681 = f.my_piecewise5(t221, (-0.64e0 * t655 * t225 - 0.64e0 * t540 * t655) * t228, t229, -0.64e0 * t662 - 0.8704e0 * t231 * t662 - 0.4607056813647e1 * t233 * t662 + 0.12246241008700e2 * t235 * t662 - 0.9578551181030e1 * t237 * t662 + 0.3101306810232e1 * t239 * t662 - 0.362942158544e0 * t241 * t662, -0.105e1 * t561 * t677 * t250)
  vtau_0_ = r0 * t681 * t271
  _b = lambda x: (jnp.asarray(x) + jnp.zeros_like(r0))
  vrho_0_ = _b(vrho_0_)
  vsigma_0_ = _b(vsigma_0_)
  vlapl_0_ = _b(vlapl_0_)
  vtau_0_ = _b(vtau_0_)
  res = {'vrho': vrho_0_, 'vsigma': vsigma_0_, 'vlapl': vlapl_0_, 'vtau':  vtau_0_}
  return res

def unpol_fxc(p, r, s=None, l=None, tau=None):
  f = funcs(p)
  params = f.params
  r0, s0, l0, tau0 = r, s, l, tau

  t1 = 3 ** (0.1e1 / 0.3e1)
  t3 = (0.1e1 / jnp.pi) ** (0.1e1 / 0.3e1)
  t4 = t1 * t3
  t5 = 4 ** (0.1e1 / 0.3e1)
  t6 = t5 ** 2
  t7 = r0 ** (0.1e1 / 0.3e1)
  t9 = 0.1e1 / t7 / r0
  t10 = t6 * t9
  t12 = t6 / t7
  t13 = t4 * t12
  t14 = jnp.sqrt(t13)
  t16 = 0.89690000000000000000000000000000000000000000000000e0 * t13
  t17 = t13 ** 0.15e1
  t18 = 0.20477500000000000000000000000000000000000000000000e0 * t17
  t19 = t1 ** 2
  t20 = t3 ** 2
  t21 = t19 * t20
  t22 = t7 ** 2
  t25 = t21 * t5 / t22
  t26 = 0.12323500000000000000000000000000000000000000000000e0 * t25
  t27 = 0.37978500000000000000000000000000000000000000000000e1 * t14 + t16 + t18 + t26
  t30 = 0.1e1 + 0.16081979498692535066756296899072713062105388428051e2 / t27
  t31 = jnp.log(t30)
  t33 = t4 * t10 * t31
  t36 = 0.1e1 + 0.53425000000000000000000000000000000000000000000000e-1 * t13
  t37 = t27 ** 2
  t38 = 0.1e1 / t37
  t39 = t36 * t38
  t40 = 0.1e1 / t14
  t41 = t40 * t1
  t42 = t3 * t6
  t43 = t42 * t9
  t44 = t41 * t43
  t46 = t4 * t10
  t47 = 0.29896666666666666666666666666666666666666666666667e0 * t46
  t48 = t13 ** 0.5e0
  t49 = t48 * t1
  t50 = t49 * t43
  t51 = 0.10238750000000000000000000000000000000000000000000e0 * t50
  t53 = 0.1e1 / t22 / r0
  t55 = t21 * t5 * t53
  t56 = 0.82156666666666666666666666666666666666666666666667e-1 * t55
  t57 = -0.63297500000000000000000000000000000000000000000000e0 * t44 - t47 - t51 - t56
  t58 = 0.1e1 / t30
  t59 = t57 * t58
  t60 = t39 * t59
  t62 = 0.1e1 <= f.p.zeta_threshold
  t63 = f.p.zeta_threshold ** (0.1e1 / 0.3e1)
  t65 = f.my_piecewise3(t62, t63 * f.p.zeta_threshold, 1)
  t67 = 0.2e1 * t65 - 0.2e1
  t68 = 2 ** (0.1e1 / 0.3e1)
  t69 = t68 - 0.1e1
  t71 = 0.1e1 / t69 / 0.2e1
  t72 = t67 * t71
  t73 = t72 * t1
  t75 = 0.90577500000000000000000000000000000000000000000000e0 * t13
  t76 = 0.11003250000000000000000000000000000000000000000000e0 * t17
  t77 = 0.12417750000000000000000000000000000000000000000000e0 * t25
  t78 = 0.51785000000000000000000000000000000000000000000000e1 * t14 + t75 + t76 + t77
  t81 = 0.1e1 + 0.29608749977793437516654921862508808603118393547661e2 / t78
  t82 = jnp.log(t81)
  t85 = t73 * t42 * t9 * t82
  t88 = 0.1e1 + 0.27812500000000000000000000000000000000000000000000e-1 * t13
  t89 = t72 * t88
  t90 = t78 ** 2
  t91 = 0.1e1 / t90
  t93 = 0.30192500000000000000000000000000000000000000000000e0 * t46
  t94 = 0.55016250000000000000000000000000000000000000000000e-1 * t50
  t95 = 0.82785000000000000000000000000000000000000000000000e-1 * t55
  t96 = -0.86308333333333333333333333333333333333333333333334e0 * t44 - t93 - t94 - t95
  t98 = 0.1e1 / t81
  t99 = t91 * t96 * t98
  t100 = t89 * t99
  t102 = jnp.log(0.2e1)
  t103 = 0.1e1 - t102
  t104 = jnp.pi ** 2
  t105 = 0.1e1 / t104
  t106 = t103 * t105
  t107 = t63 ** 2
  t108 = f.my_piecewise3(t62, t107, 1)
  t109 = t108 ** 2
  t110 = t109 * t108
  t111 = 0.11073470983333333333333333333333333333333333333333e-2 * t33
  t112 = 0.10000000000000000000000000000000000000000000000000e1 * t60
  t113 = 0.18311447306006545054854346104378990962041954983034e-3 * t85
  t114 = 0.58482236226346462072622386637590534819724553404280e0 * t100
  t115 = t111 + t112 - t113 - t114
  t116 = 0.1e1 / t103
  t118 = t115 * t116 * t104
  t119 = 0.1e1 / t110
  t121 = 0.621814e-1 * t36 * t31
  t124 = 0.19751673498613801407483339618206552048944131217655e-1 * t72 * t88 * t82
  t129 = jnp.exp(-(-t121 + t124) * t116 * t104 * t119)
  t130 = t119 * t129
  t132 = 0.1e1 + 0.25000000000000000000000000000000000000000000000000e-1 * t13
  t134 = 0.1e1 + 0.44450000000000000000000000000000000000000000000000e-1 * t13
  t135 = 0.1e1 / t134
  t137 = t132 * t135 * s0
  t138 = r0 ** 2
  t140 = 0.1e1 / t7 / t138
  t141 = t140 * t68
  t142 = 0.1e1 / t109
  t145 = 0.1e1 / t3
  t148 = t116 * t104
  t149 = t129 - 0.1e1
  t150 = 0.1e1 / t149
  t151 = t148 * t150
  t152 = t19 * t145 * t5 * t151
  t156 = f.my_piecewise3(t62, t107 * f.p.zeta_threshold, 1)
  t157 = 0.1e1 / t156
  t158 = t148 * t157
  t159 = t119 * t150
  t160 = jnp.sqrt(0.4e1)
  t161 = t160 * t14
  t163 = 0.31385250000000000000000000000000000000000000000000e-1 * t13
  t164 = 0.1e1 + 0.22225000000000000000000000000000000000000000000000e-1 * t161 + t163
  t165 = t164 ** 2
  t170 = 0.1e1 - 0.2363e1 * t69 * t67 * t71
  t171 = 0.1e1 / t165 * t170
  t172 = t160 * t40
  t174 = 0.44450000000000000000000000000000000000000000000000e-1 * t172 + 0.125541e0
  t178 = 0.18989250000000000000000000000000000000000000000000e1 * t161 + t16 + t18 + t26
  t181 = 0.1e1 + 0.16081979498692535066756296899072713062105388428051e2 / t178
  t182 = jnp.log(t181)
  t184 = t178 ** 2
  t185 = 0.1e1 / t184
  t186 = t36 * t185
  t190 = 0.37978500000000000000000000000000000000000000000000e1 * t172 + 0.35876e1 + 0.12286500000000000000000000000000000000000000000000e1 * t48 + 0.24647000000000000000000000000000000000000000000000e0 * t13
  t191 = 0.1e1 / t181
  t192 = t190 * t191
  t196 = 0.25892500000000000000000000000000000000000000000000e1 * t161 + t75 + t76 + t77
  t199 = 0.1e1 + 0.29608749977793437516654921862508808603118393547661e2 / t196
  t200 = jnp.log(t199)
  t203 = t196 ** 2
  t204 = 0.1e1 / t203
  t208 = 0.51785000000000000000000000000000000000000000000000e1 * t172 + 0.36231e1 + 0.66019500000000000000000000000000000000000000000000e0 * t48 + 0.24835500000000000000000000000000000000000000000000e0 * t13
  t210 = 0.1e1 / t199
  t211 = t204 * t208 * t210
  t214 = 0.285764e-1 * t171 * t174 + 0.13288165180e-1 * t182 - 0.10000000000000000000000000000000000000000000000000e1 * t186 * t192 - 0.21973736767207854065825215325254789154450345979641e-2 * t72 * t200 + 0.58482236226346462072622386637590534819724553404280e0 * t89 * t211
  t219 = 0.1e1 + 0.44450000000000000000000000000000000000000000000000e-1 * t14 + t163
  t220 = 0.1e1 / t219
  t226 = 0.5e1 * t4 * t12 * t214 - 0.45e2 * params.eta * (-0.285764e-1 * t220 * t170 + t121 - t124)
  t227 = t159 * t226
  t228 = t158 * t227
  t229 = 6 ** (0.1e1 / 0.3e1)
  t230 = t104 ** (0.1e1 / 0.3e1)
  t231 = t230 ** 2
  t232 = 0.1e1 / t231
  t233 = t229 * t232
  t234 = t68 ** 2
  t235 = t233 * t234
  t237 = 0.1e1 / t22 / t138
  t238 = s0 * t237
  t239 = t229 ** 2
  t241 = 0.1e1 / t230 / t104
  t243 = s0 ** 2
  t245 = t138 ** 2
  t246 = t245 * r0
  t252 = jnp.exp(-0.20444604078896369094486892376367646458587560067350e0 * t239 * t241 * t68 * t243 / t7 / t246)
  t254 = t235 * t238 * t252
  t257 = 0.1e1 + 0.27801896084645508333333333333333333333333333333333e-2 * t137 * t141 * t142 * t152 + 0.43913724338827160493827160493827160493827160493828e-2 * t228 * t254
  t258 = t257 ** (0.1e1 / 0.4e1)
  t260 = 0.1e1 - 0.1e1 / t258
  t261 = t130 * t260
  t264 = 0.1e1 / t258 / t257
  t265 = t149 * t264
  t266 = t138 * r0
  t268 = 0.1e1 / t22 / t266
  t269 = t268 * t135
  t270 = s0 * t68
  t274 = t142 * t116 * t104 * t150
  t277 = t134 ** 2
  t278 = 0.1e1 / t277
  t279 = t132 * t278
  t280 = s0 * t268
  t283 = t68 * t142 * t151
  t288 = 0.1e1 / t7 / t266 * t68
  t293 = t109 ** 2
  t295 = 0.1e1 / t293 / t108
  t296 = t295 * t19
  t298 = t137 * t141 * t296
  t299 = t145 * t5
  t300 = t103 ** 2
  t301 = 0.1e1 / t300
  t302 = t299 * t301
  t303 = t104 ** 2
  t304 = t149 ** 2
  t305 = 0.1e1 / t304
  t306 = t303 * t305
  t307 = t115 * t129
  t309 = t302 * t306 * t307
  t312 = t301 * t303
  t313 = t312 * t157
  t315 = 0.1e1 / t293 / t109
  t316 = t315 * t305
  t317 = t226 * t229
  t319 = t313 * t316 * t317
  t320 = t232 * t234
  t321 = t320 * s0
  t322 = t237 * t252
  t324 = t321 * t322 * t307
  t332 = 0.1e1 / t165 / t164 * t170
  t333 = 4 ** (0.1e1 / 0.6e1)
  t334 = t333 * t40
  t335 = t4 * t9
  t336 = t334 * t335
  t338 = 0.10461750000000000000000000000000000000000000000000e-1 * t46
  t339 = -0.14816666666666666666666666666666666666666666666667e-1 * t336 - t338
  t343 = t171 * t333
  t345 = 0.1e1 / t14 / t13
  t346 = t345 * t1
  t352 = -0.12659500000000000000000000000000000000000000000000e1 * t336 - t47 - t51 - t56
  t356 = t4 * t6
  t357 = t9 * t185
  t362 = 0.1e1 / t184 / t178
  t363 = t36 * t362
  t367 = t333 * t345
  t368 = t367 * t335
  t370 = t13 ** (-0.5e0)
  t371 = t370 * t1
  t372 = t371 * t43
  t375 = 0.25319000000000000000000000000000000000000000000000e1 * t368 - 0.20477500000000000000000000000000000000000000000000e0 * t372 - 0.82156666666666666666666666666666666666666666666667e-1 * t46
  t376 = t375 * t191
  t379 = t184 ** 2
  t380 = 0.1e1 / t379
  t381 = t36 * t380
  t382 = t181 ** 2
  t383 = 0.1e1 / t382
  t384 = t190 * t383
  t389 = -0.17261666666666666666666666666666666666666666666667e1 * t336 - t93 - t94 - t95
  t394 = t72 * t4
  t399 = 0.1e1 / t203 / t196
  t400 = t399 * t208
  t401 = t210 * t389
  t408 = 0.34523333333333333333333333333333333333333333333333e1 * t368 - 0.11003250000000000000000000000000000000000000000000e0 * t372 - 0.82785000000000000000000000000000000000000000000000e-1 * t46
  t410 = t204 * t408 * t210
  t413 = t203 ** 2
  t414 = 0.1e1 / t413
  t415 = t414 * t208
  t416 = t199 ** 2
  t417 = 0.1e1 / t416
  t418 = t417 * t389
  t422 = -0.571528e-1 * t332 * t174 * t339 + 0.84681398666666666666666666666666666666666666666666e-3 * t343 * t346 * t3 * t9 - 0.21370000000000000000000000000000000000000000000000e0 * t185 * t352 * t191 + 0.17808333333333333333333333333333333333333333333333e-1 * t356 * t357 * t192 + 0.20000000000000000000000000000000000000000000000000e1 * t363 * t192 * t352 - 0.10000000000000000000000000000000000000000000000000e1 * t186 * t376 - 0.16081979498692535066756296899072713062105388428051e2 * t381 * t384 * t352 + 0.65061487801810439055792405134319469986943565662261e-1 * t72 * t204 * t389 * t210 - 0.54217906501508699213160337611932891655786304718551e-2 * t394 * t10 * t211 - 0.11696447245269292414524477327518106963944910680856e1 * t89 * t400 * t401 + 0.58482236226346462072622386637590534819724553404280e0 * t89 * t410 + 0.17315859105681463759666483083807725165579399831905e2 * t89 * t415 * t418
  t426 = t219 ** 2
  t427 = 0.1e1 / t426
  t428 = t427 * t170
  t430 = -0.74083333333333333333333333333333333333333333333333e-2 * t44 - t338
  t436 = -0.5e1 / 0.3e1 * t4 * t10 * t214 + 0.5e1 * t4 * t12 * t422 - 0.45e2 * params.eta * (0.285764e-1 * t428 * t430 - t111 - t112 + t113 + t114)
  t438 = t158 * t159 * t436
  t442 = t235 * t280 * t252
  t445 = t116 * t105
  t447 = t445 * t157 * t119
  t448 = t150 * t226
  t449 = t243 * s0
  t450 = t245 ** 2
  t453 = t449 / t450 / r0
  t454 = t453 * t252
  t458 = -0.27801896084645508333333333333333333333333333333333e-3 * t269 * t270 * t274 + 0.49431771238499713816666666666666666666666666666666e-3 * t279 * t280 * t283 - 0.64871090864172852777777777777777777777777777777777e-2 * t137 * t288 * t142 * t152 + 0.27801896084645508333333333333333333333333333333333e-2 * t298 * t309 + 0.43913724338827160493827160493827160493827160493828e-2 * t319 * t324 + 0.43913724338827160493827160493827160493827160493828e-2 * t438 * t254 - 0.11710326490353909465020576131687242798353909465021e-1 * t228 * t442 + 0.57459117295175457567385649134860096906651948254064e-1 * t447 * t448 * t454
  t461 = -t118 * t261 + t265 * t458 / 0.4e1
  t464 = t149 * t260 + 0.1e1
  t465 = 0.1e1 / t464
  t467 = t106 * t110 * t461 * t465
  t471 = tau0 * t53 - t238 / 0.8e1
  t475 = params.eta * s0
  t478 = 0.3e1 / 0.20e2 * t239 * t231 * t68 + t475 * t237 / 0.8e1
  t479 = 0.1e1 / t478
  t480 = t471 * t479
  t481 = t480 <= 0.0e0
  t482 = 0.0e0 < t480
  t486 = -0.5e1 / 0.3e1 * tau0 * t237 + t280 / 0.3e1
  t488 = t478 ** 2
  t489 = 0.1e1 / t488
  t490 = t471 * t489
  t491 = t475 * t268
  t494 = t486 * t479 + t490 * t491 / 0.3e1
  t495 = f.my_piecewise3(t482, 0, t494)
  t496 = f.my_piecewise3(t482, 0, t480)
  t497 = 0.1e1 - t496
  t498 = 0.1e1 / t497
  t501 = t497 ** 2
  t502 = 0.1e1 / t501
  t503 = t496 * t502
  t506 = -0.64e0 * t495 * t498 - 0.64e0 * t503 * t495
  t509 = jnp.exp(-0.64e0 * t496 * t498)
  t511 = t480 <= 0.25e1
  t512 = 0.25e1 < t480
  t513 = f.my_piecewise3(t512, 0, t494)
  t515 = f.my_piecewise3(t512, 0.25e1, t480)
  t518 = t515 ** 2
  t521 = t518 * t515
  t524 = t518 ** 2
  t527 = t524 * t515
  t530 = t524 * t518
  t534 = f.my_piecewise3(t512, t480, 0.25e1)
  t535 = 0.1e1 - t534
  t536 = t535 ** 2
  t537 = 0.1e1 / t536
  t538 = f.my_piecewise3(t512, t494, 0)
  t542 = jnp.exp(0.15e1 / t535)
  t545 = f.my_piecewise5(t481, t506 * t509, t511, -0.64e0 * t513 - 0.8704e0 * t515 * t513 - 0.4607056813647e1 * t518 * t513 + 0.12246241008700e2 * t521 * t513 - 0.9578551181030e1 * t524 * t513 + 0.3101306810232e1 * t527 * t513 - 0.362942158544e0 * t530 * t513, -0.105e1 * t537 * t538 * t542)
  t548 = jnp.exp(0.10000000000000000000000000000000000000000000000000e1 * t220)
  t549 = t548 - 0.1e1
  t550 = t234 * s0
  t554 = 0.1e1 + 0.21337642104376358333333333333333333333333333333333e-1 * t233 * t550 * t237
  t555 = t554 ** (0.1e1 / 0.4e1)
  t557 = 0.1e1 - 0.1e1 / t555
  t559 = t549 * t557 + 0.1e1
  t560 = jnp.log(t559)
  t564 = jnp.log(t464)
  t567 = (-0.285764e-1 * t220 + 0.285764e-1 * t560) * t170 + t121 - t124 - t106 * t110 * t564
  t580 = f.my_piecewise5(t481, t509, t511, 0.1e1 - 0.64e0 * t515 - 0.4352e0 * t518 - 0.1535685604549e1 * t521 + 0.3061560252175e1 * t524 - 0.1915710236206e1 * t527 + 0.516884468372e0 * t530 - 0.51848879792e-1 * t524 * t521, -0.7e0 * t542)
  t581 = t427 * t430
  t583 = t548 * t557
  t587 = 0.1e1 / t555 / t554
  t589 = t549 * t587 * t229
  t593 = -0.10000000000000000000000000000000000000000000000000e1 * t581 * t583 - 0.14225094736250905555555555555555555555555555555555e-1 * t589 * t320 * t280
  t594 = 0.1e1 / t559
  t599 = (0.285764e-1 * t581 + 0.285764e-1 * t593 * t594) * t170 - t111 - t112 + t113 + t114 - t467
  t602 = t6 * t140
  t605 = 0.14764627977777777777777777777777777777777777777777e-2 * t4 * t602 * t31
  t609 = 0.35616666666666666666666666666666666666666666666666e-1 * t356 * t9 * t38 * t59
  t613 = t57 ** 2
  t616 = 0.20000000000000000000000000000000000000000000000000e1 * t36 / t37 / t27 * t613 * t58
  t619 = t20 * t5 * t237
  t620 = t345 * t19 * t619
  t622 = t42 * t140
  t623 = t41 * t622
  t625 = t4 * t602
  t626 = 0.39862222222222222222222222222222222222222222222223e0 * t625
  t628 = t370 * t19 * t619
  t629 = 0.68258333333333333333333333333333333333333333333333e-1 * t628
  t630 = t49 * t622
  t631 = 0.13651666666666666666666666666666666666666666666667e0 * t630
  t633 = t21 * t5 * t237
  t634 = 0.13692777777777777777777777777777777777777777777778e0 * t633
  t638 = 0.10000000000000000000000000000000000000000000000000e1 * t39 * (-0.42198333333333333333333333333333333333333333333333e0 * t620 + 0.84396666666666666666666666666666666666666666666666e0 * t623 + t626 + t629 + t631 + t634) * t58
  t639 = t37 ** 2
  t642 = t30 ** 2
  t646 = 0.16081979498692535066756296899072713062105388428051e2 * t36 / t639 * t613 / t642
  t650 = 0.24415263074675393406472461472505321282722606644045e-3 * t73 * t42 * t140 * t82
  t653 = 0.10843581300301739842632067522386578331157260943710e-1 * t394 * t10 * t99
  t656 = t96 ** 2
  t660 = 0.11696447245269292414524477327518106963944910680856e1 * t89 / t90 / t78 * t656 * t98
  t663 = 0.40256666666666666666666666666666666666666666666667e0 * t625
  t664 = 0.36677500000000000000000000000000000000000000000000e-1 * t628
  t665 = 0.73355000000000000000000000000000000000000000000000e-1 * t630
  t666 = 0.13797500000000000000000000000000000000000000000000e0 * t633
  t671 = 0.58482236226346462072622386637590534819724553404280e0 * t89 * t91 * (-0.57538888888888888888888888888888888888888888888889e0 * t620 + 0.11507777777777777777777777777777777777777777777778e1 * t623 + t663 + t664 + t665 + t666) * t98
  t672 = t90 ** 2
  t675 = t81 ** 2
  t679 = 0.17315859105681463759666483083807725165579399831905e2 * t89 / t672 * t656 / t675
  t680 = -t605 - t609 - t616 + t638 + t646 + t650 + t653 + t660 - t671 - t679
  t684 = t115 ** 2
  t694 = t257 ** 2
  t698 = t458 ** 2
  t717 = t305 * t115 * t129
  t722 = 0.1e1 / t22 / t245
  t723 = s0 * t722
  t744 = t243 ** 2
  t746 = t245 * t266
  t752 = t241 * t68
  t761 = 0.1e1 / t246
  t765 = t151 * t356
  t793 = t333 ** 2
  t794 = t793 ** 2
  t795 = t794 * t333
  t797 = t21 * t237
  t798 = t795 * t345 * t797
  t800 = t4 * t140
  t801 = t334 * t800
  t803 = -0.28769444444444444444444444444444444444444444444445e0 * t798 + 0.23015555555555555555555555555555555555555555555556e1 * t801 + t663 + t664 + t665 + t666
  t813 = t389 ** 2
  t836 = 0.1e1 / t14 / t25 / 0.4e1
  t858 = t795 * t836 * t797
  t860 = t367 * t800
  t862 = t13 ** (-0.15e1)
  t864 = t862 * t19 * t619
  t866 = t371 * t622
  t875 = 0.13949000000000000000000000000000000000000000000000e-1 * t625
  t880 = t72 * t356
  t887 = -0.33872559466666666666666666666666666666666666666666e-2 * t332 * t367 * t4 * t9 * t339 - 0.71233333333333333333333333333333333333333333333332e-1 * t46 * t362 * t190 * t191 * t352 + 0.57278650314509912396097010788863979689532025117908e0 * t46 * t380 * t190 * t383 * t352 + 0.34631718211362927519332966167615450331158799663810e2 * t89 * t414 * t408 * t418 + 0.17315859105681463759666483083807725165579399831905e2 * t89 * t415 * t417 * t803 + 0.10254018858216406658218194626490193680059335835414e4 * t89 / t413 / t203 * t208 / t416 / t199 * t813 - 0.23392894490538584829048954655036213927889821361712e1 * t89 * t399 * t408 * t401 - 0.11696447245269292414524477327518106963944910680856e1 * t89 * t400 * t210 * t803 - 0.10389515463408878255799889850284635099347639899143e3 * t89 / t413 / t196 * t208 * t417 * t813 + 0.42340699333333333333333333333333333333333333333333e-3 * t171 * t795 * t836 * t19 * t20 * t237 + 0.35616666666666666666666666666666666666666666666666e-1 * t356 * t357 * t376 - 0.11290853155555555555555555555555555555555555555555e-2 * t343 * t346 * t3 * t140 - 0.23744444444444444444444444444444444444444444444444e-1 * t356 * t140 * t185 * t192 + 0.35089341735807877243573431982554320891834732042568e1 * t89 * t415 * t210 * t813 - 0.10000000000000000000000000000000000000000000000000e1 * t186 * (0.12659500000000000000000000000000000000000000000000e1 * t858 - 0.33758666666666666666666666666666666666666666666667e1 * t860 - 0.13651666666666666666666666666666666666666666666667e0 * t864 + 0.27303333333333333333333333333333333333333333333333e0 * t866 + 0.10954222222222222222222222222222222222222222222222e0 * t625) * t191 - 0.571528e-1 * t332 * t174 * (-0.24694444444444444444444444444444444444444444444445e-2 * t798 + 0.19755555555555555555555555555555555555555555555556e-1 * t801 + t875) - 0.32106488758451047387714937384560157077845137188324e0 * t880 * t9 * t414 * t208 * t417 * t389
  t916 = t352 ** 2
  t922 = -0.21099166666666666666666666666666666666666666666667e0 * t798 + 0.16879333333333333333333333333333333333333333333333e1 * t801 + t626 + t629 + t631 + t634
  t966 = t165 ** 2
  t969 = t339 ** 2
  t973 = 0.21687162600603479685264135044773156662314521887420e-1 * t880 * t9 * t399 * t208 * t210 * t389 + 0.72290542002011598950880450149243855541048406291401e-2 * t394 * t602 * t211 - 0.10843581300301739842632067522386578331157260943710e-1 * t394 * t10 * t410 + 0.58482236226346462072622386637590534819724553404280e0 * t89 * t204 * (0.17261666666666666666666666666666666666666666666666e1 * t858 - 0.46031111111111111111111111111111111111111111111111e1 * t860 - 0.73354999999999999999999999999999999999999999999999e-1 * t864 + 0.14671000000000000000000000000000000000000000000000e0 * t866 + 0.11038000000000000000000000000000000000000000000000e0 * t625) * t210 - 0.51726012919273400298984252201052768390886626637712e3 * t36 / t379 / t184 * t190 / t382 / t181 * t916 + 0.20000000000000000000000000000000000000000000000000e1 * t363 * t192 * t922 + 0.65061487801810439055792405134319469986943565662261e-1 * t72 * t204 * t803 * t210 + 0.19263893255070628432628962430736094246707082312994e1 * t72 * t414 * t813 * t417 - 0.13012297560362087811158481026863893997388713132452e0 * t72 * t399 * t813 * t210 - 0.60000000000000000000000000000000000000000000000000e1 * t381 * t192 * t916 - 0.32163958997385070133512593798145426124210776856102e2 * t381 * t375 * t383 * t352 - 0.16081979498692535066756296899072713062105388428051e2 * t381 * t384 * t922 + 0.96491876992155210400537781394436278372632330568306e2 * t36 / t379 / t178 * t384 * t916 + 0.40000000000000000000000000000000000000000000000000e1 * t363 * t376 * t352 + 0.42740000000000000000000000000000000000000000000000e0 * t362 * t916 * t191 - 0.21370000000000000000000000000000000000000000000000e0 * t185 * t922 * t191 - 0.34367190188705947437658206473318387813719215070745e1 * t380 * t916 * t383 + 0.1714584e0 / t966 * t170 * t174 * t969
  t979 = 0.1e1 / t426 / t219
  t981 = t430 ** 2
  t986 = -0.49388888888888888888888888888888888888888888888889e-2 * t620 + 0.98777777777777777777777777777777777777777777777777e-2 * t623 + t875
  t989 = -0.571528e-1 * t979 * t170 * t981 + 0.285764e-1 * t428 * t986 + t605 + t609 + t616 - t638 - t646 - t650 - t653 - t660 + t671 + t679
  t999 = -0.23420652980707818930041152263374485596707818930042e-1 * t319 * t321 * t268 * t252 * t307 + 0.11491823459035091513477129826972019381330389650813e0 * t301 * t157 * t316 * t226 * t453 * t252 * t115 * t129 - 0.55603792169291016666666666666666666666666666666666e-3 * t269 * t270 * t295 * t312 * t717 - 0.29659062743099828290000000000000000000000000000000e-2 * t279 * t723 * t283 + 0.11491823459035091513477129826972019381330389650813e0 * t447 * t150 * t436 * t454 - 0.67035636844371367161949923990670113057760606296409e0 * t447 * t448 * t449 / t450 / t138 * t252 + 0.16681137650787305000000000000000000000000000000000e-2 * t722 * t135 * t270 * t274 + 0.62652208203878883543870995399241927482658031711424e-1 * t445 * t157 * t227 * t744 * s0 / t7 / t450 / t746 * t239 * t752 * t252 + 0.14648281543675415194338888888888888888888888888889e-4 * t132 / t277 / t134 * s0 * t761 * t68 * t142 * t765 + 0.43913724338827160493827160493827160493827160493828e-2 * t158 * t159 * (0.20e2 / 0.9e1 * t4 * t602 * t214 - 0.10e2 / 0.3e1 * t4 * t10 * t422 + 0.5e1 * t4 * t12 * (t887 + t973) - 0.45e2 * params.eta * t989) * t254 - 0.23420652980707818930041152263374485596707818930042e-1 * t438 * t442
  t1027 = t680 * t129
  t1032 = t293 ** 2
  t1036 = t137 * t141 / t1032 * t19
  t1038 = 0.1e1 / t300 / t103
  t1039 = t299 * t1038
  t1040 = t303 * t104
  t1042 = 0.1e1 / t304 / t149
  t1044 = t129 ** 2
  t1045 = t684 * t1044
  t1051 = t684 * t129
  t1066 = t1038 * t1040 * t157
  t1068 = 0.1e1 / t1032 / t108
  t1083 = 0.42937863797964334705075445816186556927297668038410e-1 * t228 * t235 * t723 * t252 + 0.21623696954724284259259259259259259259259259259259e-1 * t137 / t7 / t245 * t68 * t142 * t152 - 0.82386285397499523027777777777777777777777777777777e-5 * t761 * t278 * t270 * t142 * t765 + 0.98863542476999427633333333333333333333333333333332e-3 * t279 * t280 * t68 * t295 * t301 * t303 * t717 - 0.12974218172834570555555555555555555555555555555555e-1 * t137 * t288 * t296 * t309 + 0.27801896084645508333333333333333333333333333333333e-2 * t298 * t302 * t306 * t1027 + 0.55603792169291016666666666666666666666666666666666e-2 * t1036 * t1039 * t1040 * t1042 * t1045 - 0.27801896084645508333333333333333333333333333333333e-2 * t1036 * t1039 * t1040 * t305 * t1051 + 0.87827448677654320987654320987654320987654320987656e-2 * t313 * t316 * t436 * t229 * t324 + 0.43913724338827160493827160493827160493827160493828e-2 * t319 * t321 * t322 * t1027 + 0.87827448677654320987654320987654320987654320987656e-2 * t1066 * t1068 * t1042 * t317 * t321 * t322 * t1045 - 0.43913724338827160493827160493827160493827160493828e-2 * t1066 * t1068 * t305 * t317 * t321 * t322 * t1051
  t1090 = t106 * t110 * (-t680 * t116 * t104 * t261 + t684 * t301 * t303 * t315 * t129 * t260 - t118 * t130 * t264 * t458 / 0.2e1 - 0.5e1 / 0.16e2 * t149 / t258 / t694 * t698 + t265 * (t999 + t1083) / 0.4e1) * t465
  t1091 = t461 ** 2
  t1093 = t464 ** 2
  t1096 = t106 * t110 * t1091 / t1093
  t1108 = params.eta ** 2
  t1111 = 0.1e1 / t7 / t746
  t1118 = (0.40e2 / 0.9e1 * tau0 * t268 - 0.11e2 / 0.9e1 * t723) * t479 + 0.2e1 / 0.3e1 * t486 * t489 * t491 + 0.2e1 / 0.9e1 * t471 / t488 / t478 * t1108 * t243 * t1111 - 0.11e2 / 0.9e1 * t490 * t475 * t722
  t1119 = f.my_piecewise3(t482, 0, t1118)
  t1122 = t495 ** 2
  t1134 = t506 ** 2
  t1137 = f.my_piecewise3(t512, 0, t1118)
  t1139 = t513 ** 2
  t1163 = -0.64e0 * t1137 - 0.8704e0 * t1139 - 0.8704e0 * t515 * t1137 - 0.9214113627294e1 * t515 * t1139 - 0.4607056813647e1 * t518 * t1137 + 0.36738723026100e2 * t518 * t1139 + 0.12246241008700e2 * t521 * t1137 - 0.38314204724120e2 * t521 * t1139 - 0.9578551181030e1 * t524 * t1137 + 0.15506534051160e2 * t524 * t1139 + 0.3101306810232e1 * t527 * t1137 - 0.2177652951264e1 * t527 * t1139 - 0.362942158544e0 * t530 * t1137
  t1166 = t538 ** 2
  t1170 = f.my_piecewise3(t512, t1118, 0)
  t1174 = t536 ** 2
  t1180 = f.my_piecewise5(t481, (-0.64e0 * t1119 * t498 - 0.128e1 * t1122 * t502 - 0.128e1 * t496 / t501 / t497 * t1122 - 0.64e0 * t503 * t1119) * t509 + t1134 * t509, t511, t1163, -0.210e1 / t536 / t535 * t1166 * t542 - 0.105e1 * t537 * t1170 * t542 - 0.1575e1 / t1174 * t1166 * t542)
  t1184 = t979 * t981
  t1186 = t427 * t986
  t1192 = t426 ** 2
  t1203 = t554 ** 2
  t1218 = t593 ** 2
  t1219 = t559 ** 2
  t1225 = (-0.571528e-1 * t1184 + 0.285764e-1 * t1186 + 0.285764e-1 * (0.20000000000000000000000000000000000000000000000000e1 * t1184 * t583 - 0.10000000000000000000000000000000000000000000000000e1 * t1186 * t583 + 0.10000000000000000000000000000000000000000000000000e1 / t1192 * t981 * t583 + 0.28450189472501811111111111111111111111111111111110e-1 * t581 * t548 * t587 * t233 * t550 * t268 - 0.20235332025531322029119593137558641975308641975307e-2 * t549 / t555 / t1203 * t239 * t752 * t243 * t1111 + 0.52158680699586653703703703703703703703703703703702e-1 * t589 * t320 * t723) * t594 - 0.285764e-1 * t1218 / t1219) * t170 + t605 + t609 + t616 - t638 - t646 - t650 - t653 - t660 + t671 + t679 - t1090 + t1096
  t1227 = t1180 * t567 + t580 * t1225 + 0.2e1 * t545 * t599 + t1090 - t1096 - t605 - t609 - t616 + t638 + t646 + t650 + t653 + t660 - t671 - t679
  v2rho2_0_ = 0.22146941966666666666666666666666666666666666666666e-2 * t33 + 0.20000000000000000000000000000000000000000000000000e1 * t60 - 0.36622894612013090109708692208757981924083909966068e-3 * t85 - 0.11696447245269292414524477327518106963944910680856e1 * t100 + 0.2e1 * t467 + 0.2e1 * t545 * t567 + 0.2e1 * t580 * t599 + r0 * t1227

  res = {'v2rho2': v2rho2_0_}
  return res

def unpol_kxc(p, r, s=None, l=None, tau=None):
  f = funcs(p)
  params = f.params
  r0, s0, l0, tau0 = r, s, l, tau

  t1 = 3 ** (0.1e1 / 0.3e1)
  t2 = 0.1e1 / jnp.pi
  t3 = t2 ** (0.1e1 / 0.3e1)
  t4 = t1 * t3
  t5 = 4 ** (0.1e1 / 0.3e1)
  t6 = t5 ** 2
  t7 = r0 ** 2
  t8 = r0 ** (0.1e1 / 0.3e1)
  t10 = 0.1e1 / t8 / t7
  t11 = t6 * t10
  t13 = t6 / t8
  t14 = t4 * t13
  t15 = jnp.sqrt(t14)
  t17 = 0.89690000000000000000000000000000000000000000000000e0 * t14
  t18 = t14 ** 0.15e1
  t19 = 0.20477500000000000000000000000000000000000000000000e0 * t18
  t20 = t1 ** 2
  t21 = t3 ** 2
  t22 = t20 * t21
  t23 = t8 ** 2
  t26 = t22 * t5 / t23
  t27 = 0.12323500000000000000000000000000000000000000000000e0 * t26
  t28 = 0.37978500000000000000000000000000000000000000000000e1 * t15 + t17 + t19 + t27
  t31 = 0.1e1 + 0.16081979498692535066756296899072713062105388428051e2 / t28
  t32 = jnp.log(t31)
  t34 = t4 * t11 * t32
  t37 = 0.1e1 / t23 / r0
  t40 = 0.1e1 / t23 / t7
  t41 = s0 * t40
  t43 = tau0 * t37 - t41 / 0.8e1
  t44 = 6 ** (0.1e1 / 0.3e1)
  t45 = t44 ** 2
  t46 = jnp.pi ** 2
  t47 = t46 ** (0.1e1 / 0.3e1)
  t48 = t47 ** 2
  t50 = 2 ** (0.1e1 / 0.3e1)
  t53 = params.eta * s0
  t56 = 0.3e1 / 0.20e2 * t45 * t48 * t50 + t53 * t40 / 0.8e1
  t57 = 0.1e1 / t56
  t58 = t43 * t57
  t59 = t58 <= 0.0e0
  t60 = 0.0e0 < t58
  t63 = t7 * r0
  t65 = 0.1e1 / t23 / t63
  t66 = s0 * t65
  t68 = -0.5e1 / 0.3e1 * tau0 * t40 + t66 / 0.3e1
  t70 = t56 ** 2
  t71 = 0.1e1 / t70
  t72 = t43 * t71
  t73 = t53 * t65
  t76 = t68 * t57 + t72 * t73 / 0.3e1
  t77 = f.my_piecewise3(t60, 0, t76)
  t78 = f.my_piecewise3(t60, 0, t58)
  t79 = 0.1e1 - t78
  t80 = 0.1e1 / t79
  t83 = t79 ** 2
  t84 = 0.1e1 / t83
  t85 = t78 * t84
  t88 = -0.64e0 * t77 * t80 - 0.64e0 * t85 * t77
  t91 = jnp.exp(-0.64e0 * t78 * t80)
  t93 = t58 <= 0.25e1
  t94 = 0.25e1 < t58
  t95 = f.my_piecewise3(t94, 0, t76)
  t97 = f.my_piecewise3(t94, 0.25e1, t58)
  t98 = t97 * t95
  t100 = t97 ** 2
  t101 = t100 * t95
  t103 = t100 * t97
  t104 = t103 * t95
  t106 = t100 ** 2
  t107 = t106 * t95
  t109 = t106 * t97
  t110 = t109 * t95
  t112 = t106 * t100
  t116 = f.my_piecewise3(t94, t58, 0.25e1)
  t117 = 0.1e1 - t116
  t118 = t117 ** 2
  t119 = 0.1e1 / t118
  t120 = f.my_piecewise3(t94, t76, 0)
  t124 = jnp.exp(0.15e1 / t117)
  t127 = f.my_piecewise5(t59, t88 * t91, t93, -0.64e0 * t95 - 0.8704e0 * t98 - 0.4607056813647e1 * t101 + 0.12246241008700e2 * t104 - 0.9578551181030e1 * t107 + 0.3101306810232e1 * t110 - 0.362942158544e0 * t112 * t95, -0.105e1 * t119 * t120 * t124)
  t129 = 0.31385250000000000000000000000000000000000000000000e-1 * t14
  t130 = 0.1e1 + 0.44450000000000000000000000000000000000000000000000e-1 * t15 + t129
  t131 = t130 ** 2
  t132 = 0.1e1 / t131
  t133 = 0.1e1 / t15
  t134 = t133 * t1
  t135 = t3 * t6
  t137 = 0.1e1 / t8 / r0
  t138 = t135 * t137
  t139 = t134 * t138
  t141 = t6 * t137
  t142 = t4 * t141
  t143 = 0.10461750000000000000000000000000000000000000000000e-1 * t142
  t144 = -0.74083333333333333333333333333333333333333333333333e-2 * t139 - t143
  t145 = t132 * t144
  t147 = 0.1e1 / t130
  t149 = jnp.exp(0.10000000000000000000000000000000000000000000000000e1 * t147)
  t150 = 0.1e1 / t48
  t151 = t44 * t150
  t152 = t50 ** 2
  t153 = t152 * s0
  t157 = 0.1e1 + 0.21337642104376358333333333333333333333333333333333e-1 * t151 * t153 * t40
  t158 = t157 ** (0.1e1 / 0.4e1)
  t160 = 0.1e1 - 0.1e1 / t158
  t161 = t149 * t160
  t164 = t149 - 0.1e1
  t166 = 0.1e1 / t158 / t157
  t168 = t164 * t166 * t44
  t169 = t150 * t152
  t173 = -0.10000000000000000000000000000000000000000000000000e1 * t145 * t161 - 0.14225094736250905555555555555555555555555555555555e-1 * t168 * t169 * t66
  t175 = t164 * t160 + 0.1e1
  t176 = 0.1e1 / t175
  t180 = t50 - 0.1e1
  t181 = 0.1e1 <= f.p.zeta_threshold
  t182 = f.p.zeta_threshold ** (0.1e1 / 0.3e1)
  t184 = f.my_piecewise3(t181, t182 * f.p.zeta_threshold, 1)
  t186 = 0.2e1 * t184 - 0.2e1
  t189 = 0.1e1 / t180 / 0.2e1
  t192 = 0.1e1 - 0.2363e1 * t180 * t186 * t189
  t196 = 0.11073470983333333333333333333333333333333333333333e-2 * t4 * t141 * t32
  t198 = 0.1e1 + 0.53425000000000000000000000000000000000000000000000e-1 * t14
  t199 = t28 ** 2
  t200 = 0.1e1 / t199
  t201 = t198 * t200
  t203 = 0.29896666666666666666666666666666666666666666666667e0 * t142
  t204 = t14 ** 0.5e0
  t205 = t204 * t1
  t206 = t205 * t138
  t207 = 0.10238750000000000000000000000000000000000000000000e0 * t206
  t209 = t22 * t5 * t37
  t210 = 0.82156666666666666666666666666666666666666666666667e-1 * t209
  t211 = -0.63297500000000000000000000000000000000000000000000e0 * t139 - t203 - t207 - t210
  t212 = 0.1e1 / t31
  t213 = t211 * t212
  t215 = 0.10000000000000000000000000000000000000000000000000e1 * t201 * t213
  t216 = t186 * t189
  t217 = t216 * t1
  t219 = 0.90577500000000000000000000000000000000000000000000e0 * t14
  t220 = 0.11003250000000000000000000000000000000000000000000e0 * t18
  t221 = 0.12417750000000000000000000000000000000000000000000e0 * t26
  t222 = 0.51785000000000000000000000000000000000000000000000e1 * t15 + t219 + t220 + t221
  t225 = 0.1e1 + 0.29608749977793437516654921862508808603118393547661e2 / t222
  t226 = jnp.log(t225)
  t230 = 0.18311447306006545054854346104378990962041954983034e-3 * t217 * t135 * t137 * t226
  t232 = 0.1e1 + 0.27812500000000000000000000000000000000000000000000e-1 * t14
  t233 = t216 * t232
  t234 = t222 ** 2
  t235 = 0.1e1 / t234
  t237 = 0.30192500000000000000000000000000000000000000000000e0 * t142
  t238 = 0.55016250000000000000000000000000000000000000000000e-1 * t206
  t239 = 0.82785000000000000000000000000000000000000000000000e-1 * t209
  t240 = -0.86308333333333333333333333333333333333333333333334e0 * t139 - t237 - t238 - t239
  t242 = 0.1e1 / t225
  t243 = t235 * t240 * t242
  t245 = 0.58482236226346462072622386637590534819724553404280e0 * t233 * t243
  t246 = jnp.log(0.2e1)
  t247 = 0.1e1 - t246
  t248 = 0.1e1 / t46
  t249 = t247 * t248
  t250 = t182 ** 2
  t251 = f.my_piecewise3(t181, t250, 1)
  t252 = t251 ** 2
  t253 = t252 * t251
  t254 = t196 + t215 - t230 - t245
  t255 = 0.1e1 / t247
  t257 = t254 * t255 * t46
  t258 = 0.1e1 / t253
  t260 = 0.621814e-1 * t198 * t32
  t263 = 0.19751673498613801407483339618206552048944131217655e-1 * t216 * t232 * t226
  t268 = jnp.exp(-(-t260 + t263) * t255 * t46 * t258)
  t269 = t258 * t268
  t271 = 0.1e1 + 0.25000000000000000000000000000000000000000000000000e-1 * t14
  t273 = 0.1e1 + 0.44450000000000000000000000000000000000000000000000e-1 * t14
  t274 = 0.1e1 / t273
  t276 = t271 * t274 * s0
  t277 = t10 * t50
  t278 = 0.1e1 / t252
  t281 = 0.1e1 / t3
  t284 = t255 * t46
  t285 = t268 - 0.1e1
  t286 = 0.1e1 / t285
  t287 = t284 * t286
  t288 = t20 * t281 * t5 * t287
  t292 = f.my_piecewise3(t181, t250 * f.p.zeta_threshold, 1)
  t293 = 0.1e1 / t292
  t294 = t284 * t293
  t295 = t258 * t286
  t296 = jnp.sqrt(0.4e1)
  t297 = t296 * t15
  t299 = 0.1e1 + 0.22225000000000000000000000000000000000000000000000e-1 * t297 + t129
  t300 = t299 ** 2
  t302 = 0.1e1 / t300 * t192
  t303 = t296 * t133
  t305 = 0.44450000000000000000000000000000000000000000000000e-1 * t303 + 0.125541e0
  t309 = 0.18989250000000000000000000000000000000000000000000e1 * t297 + t17 + t19 + t27
  t312 = 0.1e1 + 0.16081979498692535066756296899072713062105388428051e2 / t309
  t313 = jnp.log(t312)
  t315 = t309 ** 2
  t316 = 0.1e1 / t315
  t317 = t198 * t316
  t321 = 0.37978500000000000000000000000000000000000000000000e1 * t303 + 0.35876e1 + 0.12286500000000000000000000000000000000000000000000e1 * t204 + 0.24647000000000000000000000000000000000000000000000e0 * t14
  t322 = 0.1e1 / t312
  t323 = t321 * t322
  t327 = 0.25892500000000000000000000000000000000000000000000e1 * t297 + t219 + t220 + t221
  t330 = 0.1e1 + 0.29608749977793437516654921862508808603118393547661e2 / t327
  t331 = jnp.log(t330)
  t334 = t327 ** 2
  t335 = 0.1e1 / t334
  t339 = 0.51785000000000000000000000000000000000000000000000e1 * t303 + 0.36231e1 + 0.66019500000000000000000000000000000000000000000000e0 * t204 + 0.24835500000000000000000000000000000000000000000000e0 * t14
  t341 = 0.1e1 / t330
  t342 = t335 * t339 * t341
  t345 = 0.285764e-1 * t302 * t305 + 0.13288165180e-1 * t313 - 0.10000000000000000000000000000000000000000000000000e1 * t317 * t323 - 0.21973736767207854065825215325254789154450345979641e-2 * t216 * t331 + 0.58482236226346462072622386637590534819724553404280e0 * t233 * t342
  t354 = 0.5e1 * t4 * t13 * t345 - 0.45e2 * params.eta * (-0.285764e-1 * t147 * t192 + t260 - t263)
  t355 = t295 * t354
  t356 = t294 * t355
  t357 = t151 * t152
  t359 = 0.1e1 / t47 / t46
  t360 = t45 * t359
  t361 = s0 ** 2
  t362 = t50 * t361
  t363 = t7 ** 2
  t364 = t363 * r0
  t366 = 0.1e1 / t8 / t364
  t370 = jnp.exp(-0.20444604078896369094486892376367646458587560067350e0 * t360 * t362 * t366)
  t372 = t357 * t41 * t370
  t375 = 0.1e1 + 0.27801896084645508333333333333333333333333333333333e-2 * t276 * t277 * t278 * t288 + 0.43913724338827160493827160493827160493827160493828e-2 * t356 * t372
  t376 = t375 ** (0.1e1 / 0.4e1)
  t378 = 0.1e1 - 0.1e1 / t376
  t379 = t269 * t378
  t382 = 0.1e1 / t376 / t375
  t383 = t285 * t382
  t384 = t65 * t274
  t385 = s0 * t50
  t389 = t278 * t255 * t46 * t286
  t392 = t273 ** 2
  t393 = 0.1e1 / t392
  t394 = t271 * t393
  t397 = t50 * t278 * t287
  t401 = 0.1e1 / t8 / t63
  t402 = t401 * t50
  t407 = t252 ** 2
  t409 = 0.1e1 / t407 / t251
  t410 = t409 * t20
  t412 = t276 * t277 * t410
  t413 = t281 * t5
  t414 = t247 ** 2
  t415 = 0.1e1 / t414
  t416 = t413 * t415
  t417 = t46 ** 2
  t418 = t285 ** 2
  t419 = 0.1e1 / t418
  t420 = t417 * t419
  t421 = t254 * t268
  t423 = t416 * t420 * t421
  t426 = t415 * t417
  t427 = t426 * t293
  t429 = 0.1e1 / t407 / t252
  t430 = t429 * t419
  t431 = t354 * t44
  t433 = t427 * t430 * t431
  t434 = t169 * s0
  t435 = t40 * t370
  t437 = t434 * t435 * t421
  t445 = 0.1e1 / t300 / t299 * t192
  t446 = 4 ** (0.1e1 / 0.6e1)
  t447 = t446 * t133
  t448 = t4 * t137
  t449 = t447 * t448
  t451 = -0.14816666666666666666666666666666666666666666666667e-1 * t449 - t143
  t455 = t302 * t446
  t457 = 0.1e1 / t15 / t14
  t458 = t457 * t1
  t464 = -0.12659500000000000000000000000000000000000000000000e1 * t449 - t203 - t207 - t210
  t468 = t4 * t6
  t469 = t137 * t316
  t473 = t315 * t309
  t474 = 0.1e1 / t473
  t475 = t198 * t474
  t479 = t446 * t457
  t480 = t479 * t448
  t482 = t14 ** (-0.5e0)
  t483 = t482 * t1
  t484 = t483 * t138
  t487 = 0.25319000000000000000000000000000000000000000000000e1 * t480 - 0.20477500000000000000000000000000000000000000000000e0 * t484 - 0.82156666666666666666666666666666666666666666666667e-1 * t142
  t488 = t487 * t322
  t491 = t315 ** 2
  t492 = 0.1e1 / t491
  t493 = t198 * t492
  t494 = t312 ** 2
  t495 = 0.1e1 / t494
  t496 = t321 * t495
  t501 = -0.17261666666666666666666666666666666666666666666667e1 * t449 - t237 - t238 - t239
  t506 = t216 * t4
  t510 = t334 * t327
  t511 = 0.1e1 / t510
  t512 = t511 * t339
  t513 = t341 * t501
  t520 = 0.34523333333333333333333333333333333333333333333333e1 * t480 - 0.11003250000000000000000000000000000000000000000000e0 * t484 - 0.82785000000000000000000000000000000000000000000000e-1 * t142
  t522 = t335 * t520 * t341
  t525 = t334 ** 2
  t526 = 0.1e1 / t525
  t527 = t526 * t339
  t528 = t330 ** 2
  t529 = 0.1e1 / t528
  t530 = t529 * t501
  t534 = -0.571528e-1 * t445 * t305 * t451 + 0.84681398666666666666666666666666666666666666666666e-3 * t455 * t458 * t3 * t137 - 0.21370000000000000000000000000000000000000000000000e0 * t316 * t464 * t322 + 0.17808333333333333333333333333333333333333333333333e-1 * t468 * t469 * t323 + 0.20000000000000000000000000000000000000000000000000e1 * t475 * t323 * t464 - 0.10000000000000000000000000000000000000000000000000e1 * t317 * t488 - 0.16081979498692535066756296899072713062105388428051e2 * t493 * t496 * t464 + 0.65061487801810439055792405134319469986943565662261e-1 * t216 * t335 * t501 * t341 - 0.54217906501508699213160337611932891655786304718551e-2 * t506 * t141 * t342 - 0.11696447245269292414524477327518106963944910680856e1 * t233 * t512 * t513 + 0.58482236226346462072622386637590534819724553404280e0 * t233 * t522 + 0.17315859105681463759666483083807725165579399831905e2 * t233 * t527 * t530
  t538 = t132 * t192
  t544 = -0.5e1 / 0.3e1 * t4 * t141 * t345 + 0.5e1 * t4 * t13 * t534 - 0.45e2 * params.eta * (0.285764e-1 * t538 * t144 - t196 - t215 + t230 + t245)
  t545 = t295 * t544
  t546 = t294 * t545
  t550 = t357 * t66 * t370
  t553 = t255 * t248
  t555 = t553 * t293 * t258
  t556 = t286 * t354
  t557 = t361 * s0
  t558 = t363 ** 2
  t561 = t557 / t558 / r0
  t562 = t561 * t370
  t566 = -0.27801896084645508333333333333333333333333333333333e-3 * t384 * t385 * t389 + 0.49431771238499713816666666666666666666666666666666e-3 * t394 * t66 * t397 - 0.64871090864172852777777777777777777777777777777777e-2 * t276 * t402 * t278 * t288 + 0.27801896084645508333333333333333333333333333333333e-2 * t412 * t423 + 0.43913724338827160493827160493827160493827160493828e-2 * t433 * t437 + 0.43913724338827160493827160493827160493827160493828e-2 * t546 * t372 - 0.11710326490353909465020576131687242798353909465021e-1 * t356 * t550 + 0.57459117295175457567385649134860096906651948254064e-1 * t555 * t556 * t562
  t569 = -t257 * t379 + t383 * t566 / 0.4e1
  t572 = t285 * t378 + 0.1e1
  t573 = 0.1e1 / t572
  t576 = (0.285764e-1 * t145 + 0.285764e-1 * t173 * t176) * t192 - t196 - t215 + t230 + t245 - t249 * t253 * t569 * t573
  t580 = t506 * t141 * t243
  t592 = f.my_piecewise5(t59, t91, t93, 0.1e1 - 0.64e0 * t97 - 0.4352e0 * t100 - 0.1535685604549e1 * t103 + 0.3061560252175e1 * t106 - 0.1915710236206e1 * t109 + 0.516884468372e0 * t112 - 0.51848879792e-1 * t106 * t103, -0.7e0 * t124)
  t594 = 0.1e1 / t131 / t130
  t595 = t144 ** 2
  t596 = t594 * t595
  t598 = t457 * t20
  t599 = t21 * t5
  t600 = t599 * t40
  t601 = t598 * t600
  t603 = t135 * t10
  t604 = t134 * t603
  t606 = t4 * t11
  t607 = 0.13949000000000000000000000000000000000000000000000e-1 * t606
  t608 = -0.49388888888888888888888888888888888888888888888889e-2 * t601 + 0.98777777777777777777777777777777777777777777777777e-2 * t604 + t607
  t609 = t132 * t608
  t615 = t131 ** 2
  t616 = 0.1e1 / t615
  t617 = t616 * t595
  t620 = t149 * t166
  t621 = t145 * t620
  t623 = t151 * t153 * t65
  t626 = t157 ** 2
  t628 = 0.1e1 / t158 / t626
  t630 = t164 * t628 * t45
  t631 = t359 * t50
  t632 = t363 * t63
  t634 = 0.1e1 / t8 / t632
  t640 = 0.1e1 / t23 / t363
  t641 = s0 * t640
  t645 = 0.20000000000000000000000000000000000000000000000000e1 * t596 * t161 - 0.10000000000000000000000000000000000000000000000000e1 * t609 * t161 + 0.10000000000000000000000000000000000000000000000000e1 * t617 * t161 + 0.28450189472501811111111111111111111111111111111110e-1 * t621 * t623 - 0.20235332025531322029119593137558641975308641975307e-2 * t630 * t631 * t361 * t634 + 0.52158680699586653703703703703703703703703703703702e-1 * t168 * t169 * t641
  t648 = t173 ** 2
  t649 = t175 ** 2
  t650 = 0.1e1 / t649
  t655 = 0.14764627977777777777777777777777777777777777777777e-2 * t34
  t656 = t137 * t200
  t658 = t468 * t656 * t213
  t659 = 0.35616666666666666666666666666666666666666666666666e-1 * t658
  t661 = 0.1e1 / t199 / t28
  t662 = t198 * t661
  t663 = t211 ** 2
  t664 = t663 * t212
  t665 = t662 * t664
  t666 = 0.20000000000000000000000000000000000000000000000000e1 * t665
  t669 = 0.39862222222222222222222222222222222222222222222223e0 * t606
  t670 = t482 * t20
  t671 = t670 * t600
  t672 = 0.68258333333333333333333333333333333333333333333333e-1 * t671
  t673 = t205 * t603
  t674 = 0.13651666666666666666666666666666666666666666666667e0 * t673
  t676 = t22 * t5 * t40
  t677 = 0.13692777777777777777777777777777777777777777777778e0 * t676
  t678 = -0.42198333333333333333333333333333333333333333333333e0 * t601 + 0.84396666666666666666666666666666666666666666666666e0 * t604 + t669 + t672 + t674 + t677
  t679 = t678 * t212
  t680 = t201 * t679
  t681 = 0.10000000000000000000000000000000000000000000000000e1 * t680
  t682 = t199 ** 2
  t683 = 0.1e1 / t682
  t684 = t198 * t683
  t685 = t31 ** 2
  t686 = 0.1e1 / t685
  t687 = t663 * t686
  t688 = t684 * t687
  t689 = 0.16081979498692535066756296899072713062105388428051e2 * t688
  t692 = t217 * t135 * t10 * t226
  t693 = 0.24415263074675393406472461472505321282722606644045e-3 * t692
  t694 = 0.10843581300301739842632067522386578331157260943710e-1 * t580
  t696 = 0.1e1 / t234 / t222
  t697 = t240 ** 2
  t699 = t696 * t697 * t242
  t700 = t233 * t699
  t701 = 0.11696447245269292414524477327518106963944910680856e1 * t700
  t704 = 0.40256666666666666666666666666666666666666666666667e0 * t606
  t705 = 0.36677500000000000000000000000000000000000000000000e-1 * t671
  t706 = 0.73355000000000000000000000000000000000000000000000e-1 * t673
  t707 = 0.13797500000000000000000000000000000000000000000000e0 * t676
  t708 = -0.57538888888888888888888888888888888888888888888889e0 * t601 + 0.11507777777777777777777777777777777777777777777778e1 * t604 + t704 + t705 + t706 + t707
  t710 = t235 * t708 * t242
  t711 = t233 * t710
  t712 = 0.58482236226346462072622386637590534819724553404280e0 * t711
  t713 = t234 ** 2
  t714 = 0.1e1 / t713
  t716 = t225 ** 2
  t717 = 0.1e1 / t716
  t718 = t714 * t697 * t717
  t719 = t233 * t718
  t720 = 0.17315859105681463759666483083807725165579399831905e2 * t719
  t721 = -t655 - t659 - t666 + t681 + t689 + t693 + t694 + t701 - t712 - t720
  t723 = t721 * t255 * t46
  t725 = t254 ** 2
  t727 = t725 * t415 * t417
  t728 = t429 * t268
  t731 = t382 * t566
  t732 = t269 * t731
  t735 = t375 ** 2
  t737 = 0.1e1 / t376 / t735
  t738 = t285 * t737
  t739 = t566 ** 2
  t742 = t65 * t370
  t744 = t434 * t742 * t421
  t747 = t415 * t293
  t749 = t747 * t430 * t354
  t751 = t370 * t254 * t268
  t752 = t561 * t751
  t755 = t385 * t409
  t756 = t384 * t755
  t758 = t419 * t254 * t268
  t759 = t426 * t758
  t765 = t286 * t544
  t771 = t557 / t558 / t7
  t772 = t771 * t370
  t776 = t640 * t274
  t780 = t553 * t293
  t781 = t780 * t355
  t782 = t361 ** 2
  t783 = t782 * s0
  t786 = 0.1e1 / t8 / t558 / t632
  t789 = t631 * t370
  t790 = t783 * t786 * t45 * t789
  t794 = 0.1e1 / t392 / t273
  t796 = t271 * t794 * s0
  t797 = 0.1e1 / t364
  t798 = t797 * t50
  t801 = t287 * t468
  t810 = t464 ** 2
  t814 = t446 ** 2
  t815 = t814 ** 2
  t816 = t815 * t446
  t817 = t816 * t457
  t818 = t22 * t40
  t819 = t817 * t818
  t821 = t4 * t10
  t822 = t447 * t821
  t824 = -0.21099166666666666666666666666666666666666666666667e0 * t819 + 0.16879333333333333333333333333333333333333333333333e1 * t822 + t669 + t672 + t674 + t677
  t837 = t501 ** 2
  t838 = t341 * t837
  t842 = t526 * t520
  t846 = t511 * t520
  t850 = t302 * t816
  t853 = 0.1e1 / t15 / t26 / 0.4e1
  t854 = t853 * t20
  t868 = -0.28769444444444444444444444444444444444444444444445e0 * t819 + 0.23015555555555555555555555555555555555555555555556e1 * t822 + t704 + t705 + t706 + t707
  t869 = t529 * t868
  t874 = 0.1e1 / t525 / t334
  t875 = t874 * t339
  t877 = 0.1e1 / t528 / t330
  t878 = t877 * t837
  t882 = t341 * t868
  t887 = 0.1e1 / t525 / t327
  t888 = t887 * t339
  t889 = t529 * t837
  t893 = t10 * t316
  t898 = 0.1e1 / t491 / t315
  t899 = t198 * t898
  t901 = 0.1e1 / t494 / t312
  t902 = t321 * t901
  t906 = 0.42740000000000000000000000000000000000000000000000e0 * t474 * t810 * t322 - 0.21370000000000000000000000000000000000000000000000e0 * t316 * t824 * t322 - 0.34367190188705947437658206473318387813719215070745e1 * t492 * t810 * t495 - 0.10843581300301739842632067522386578331157260943710e-1 * t506 * t141 * t522 + 0.72290542002011598950880450149243855541048406291401e-2 * t506 * t11 * t342 + 0.35089341735807877243573431982554320891834732042568e1 * t233 * t527 * t838 + 0.34631718211362927519332966167615450331158799663810e2 * t233 * t842 * t530 - 0.23392894490538584829048954655036213927889821361712e1 * t233 * t846 * t513 + 0.42340699333333333333333333333333333333333333333333e-3 * t850 * t854 * t21 * t40 + 0.35616666666666666666666666666666666666666666666666e-1 * t468 * t469 * t488 - 0.11290853155555555555555555555555555555555555555555e-2 * t455 * t458 * t3 * t10 + 0.17315859105681463759666483083807725165579399831905e2 * t233 * t527 * t869 + 0.10254018858216406658218194626490193680059335835414e4 * t233 * t875 * t878 - 0.11696447245269292414524477327518106963944910680856e1 * t233 * t512 * t882 - 0.10389515463408878255799889850284635099347639899143e3 * t233 * t888 * t889 - 0.23744444444444444444444444444444444444444444444444e-1 * t468 * t893 * t323 - 0.51726012919273400298984252201052768390886626637712e3 * t899 * t902 * t810
  t917 = 0.1e1 / t491 / t309
  t918 = t198 * t917
  t922 = t816 * t853
  t923 = t922 * t818
  t925 = t479 * t821
  t927 = t14 ** (-0.15e1)
  t928 = t927 * t20
  t929 = t928 * t600
  t931 = t483 * t603
  t934 = 0.17261666666666666666666666666666666666666666666666e1 * t923 - 0.46031111111111111111111111111111111111111111111111e1 * t925 - 0.73354999999999999999999999999999999999999999999999e-1 * t929 + 0.14671000000000000000000000000000000000000000000000e0 * t931 + 0.11038000000000000000000000000000000000000000000000e0 * t606
  t936 = t335 * t934 * t341
  t939 = t487 * t495
  t958 = t216 * t468
  t959 = t137 * t511
  t960 = t339 * t341
  t961 = t960 * t501
  t965 = t137 * t526
  t966 = t339 * t529
  t967 = t966 * t501
  t973 = -0.24694444444444444444444444444444444444444444444445e-2 * t819 + 0.19755555555555555555555555555555555555555555555556e-1 * t822 + t607
  t974 = t305 * t973
  t977 = t300 ** 2
  t979 = 0.1e1 / t977 * t192
  t980 = t451 ** 2
  t989 = 0.12659500000000000000000000000000000000000000000000e1 * t923 - 0.33758666666666666666666666666666666666666666666667e1 * t925 - 0.13651666666666666666666666666666666666666666666667e0 * t929 + 0.27303333333333333333333333333333333333333333333333e0 * t931 + 0.10954222222222222222222222222222222222222222222222e0 * t606
  t990 = t989 * t322
  t993 = t492 * t321
  t994 = t495 * t464
  t995 = t993 * t994
  t998 = t474 * t321
  t999 = t322 * t464
  t1000 = t998 * t999
  t1003 = t445 * t479
  t1008 = 0.20000000000000000000000000000000000000000000000000e1 * t475 * t323 * t824 - 0.60000000000000000000000000000000000000000000000000e1 * t493 * t323 * t810 - 0.16081979498692535066756296899072713062105388428051e2 * t493 * t496 * t824 + 0.96491876992155210400537781394436278372632330568306e2 * t918 * t496 * t810 + 0.58482236226346462072622386637590534819724553404280e0 * t233 * t936 - 0.32163958997385070133512593798145426124210776856102e2 * t493 * t939 * t464 + 0.40000000000000000000000000000000000000000000000000e1 * t475 * t488 * t464 + 0.65061487801810439055792405134319469986943565662261e-1 * t216 * t335 * t868 * t341 + 0.19263893255070628432628962430736094246707082312994e1 * t216 * t526 * t837 * t529 - 0.13012297560362087811158481026863893997388713132452e0 * t216 * t511 * t837 * t341 + 0.21687162600603479685264135044773156662314521887420e-1 * t958 * t959 * t961 - 0.32106488758451047387714937384560157077845137188324e0 * t958 * t965 * t967 - 0.571528e-1 * t445 * t974 + 0.1714584e0 * t979 * t305 * t980 - 0.10000000000000000000000000000000000000000000000000e1 * t317 * t990 + 0.57278650314509912396097010788863979689532025117908e0 * t142 * t995 - 0.71233333333333333333333333333333333333333333333332e-1 * t142 * t1000 - 0.33872559466666666666666666666666666666666666666666e-2 * t1003 * t4 * t137 * t451
  t1009 = t906 + t1008
  t1013 = t594 * t192
  t1018 = -0.571528e-1 * t1013 * t595 + 0.285764e-1 * t538 * t608 + t655 + t659 + t666 - t681 - t689 - t693 - t694 - t701 + t712 + t720
  t1021 = 0.20e2 / 0.9e1 * t4 * t11 * t345 - 0.10e2 / 0.3e1 * t4 * t141 * t534 + 0.5e1 * t4 * t13 * t1009 - 0.45e2 * params.eta * t1018
  t1023 = t294 * t295 * t1021
  t1028 = -0.23420652980707818930041152263374485596707818930042e-1 * t433 * t744 + 0.11491823459035091513477129826972019381330389650813e0 * t749 * t752 - 0.55603792169291016666666666666666666666666666666666e-3 * t756 * t759 - 0.29659062743099828290000000000000000000000000000000e-2 * t394 * t641 * t397 + 0.11491823459035091513477129826972019381330389650813e0 * t555 * t765 * t562 - 0.67035636844371367161949923990670113057760606296409e0 * t555 * t556 * t772 + 0.16681137650787305000000000000000000000000000000000e-2 * t776 * t385 * t389 + 0.62652208203878883543870995399241927482658031711424e-1 * t781 * t790 + 0.14648281543675415194338888888888888888888888888889e-4 * t796 * t798 * t278 * t801 + 0.43913724338827160493827160493827160493827160493828e-2 * t1023 * t372 - 0.23420652980707818930041152263374485596707818930042e-1 * t546 * t550
  t1030 = t357 * t641 * t370
  t1035 = 0.1e1 / t8 / t363 * t50
  t1040 = t797 * t393
  t1041 = t385 * t278
  t1046 = t394 * t66 * t50
  t1047 = t409 * t415
  t1048 = t1047 * t417
  t1049 = t1048 * t758
  t1053 = t276 * t402 * t410
  t1056 = t721 * t268
  t1058 = t416 * t420 * t1056
  t1061 = t407 ** 2
  t1062 = 0.1e1 / t1061
  t1063 = t1062 * t20
  t1065 = t276 * t277 * t1063
  t1067 = 0.1e1 / t414 / t247
  t1068 = t413 * t1067
  t1069 = t417 * t46
  t1071 = 0.1e1 / t418 / t285
  t1073 = t268 ** 2
  t1074 = t725 * t1073
  t1076 = t1068 * t1069 * t1071 * t1074
  t1080 = t725 * t268
  t1082 = t1068 * t1069 * t419 * t1080
  t1085 = t544 * t44
  t1087 = t427 * t430 * t1085
  t1091 = t434 * t435 * t1056
  t1094 = t1067 * t1069
  t1095 = t1094 * t293
  t1097 = 0.1e1 / t1061 / t251
  t1098 = t1097 * t1071
  t1100 = t1095 * t1098 * t431
  t1102 = t434 * t435 * t1074
  t1105 = t1097 * t419
  t1107 = t1095 * t1105 * t431
  t1109 = t434 * t435 * t1080
  t1112 = 0.42937863797964334705075445816186556927297668038410e-1 * t356 * t1030 + 0.21623696954724284259259259259259259259259259259259e-1 * t276 * t1035 * t278 * t288 - 0.82386285397499523027777777777777777777777777777777e-5 * t1040 * t1041 * t801 + 0.98863542476999427633333333333333333333333333333332e-3 * t1046 * t1049 - 0.12974218172834570555555555555555555555555555555555e-1 * t1053 * t423 + 0.27801896084645508333333333333333333333333333333333e-2 * t412 * t1058 + 0.55603792169291016666666666666666666666666666666666e-2 * t1065 * t1076 - 0.27801896084645508333333333333333333333333333333333e-2 * t1065 * t1082 + 0.87827448677654320987654320987654320987654320987656e-2 * t1087 * t437 + 0.43913724338827160493827160493827160493827160493828e-2 * t433 * t1091 + 0.87827448677654320987654320987654320987654320987656e-2 * t1100 * t1102 - 0.43913724338827160493827160493827160493827160493828e-2 * t1107 * t1109
  t1113 = t1028 + t1112
  t1116 = -t723 * t379 + t727 * t728 * t378 - t257 * t732 / 0.2e1 - 0.5e1 / 0.16e2 * t738 * t739 + t383 * t1113 / 0.4e1
  t1119 = t249 * t253 * t1116 * t573
  t1120 = t569 ** 2
  t1122 = t572 ** 2
  t1123 = 0.1e1 / t1122
  t1125 = t249 * t253 * t1120 * t1123
  t1126 = (-0.571528e-1 * t596 + 0.285764e-1 * t609 + 0.285764e-1 * t645 * t176 - 0.285764e-1 * t648 * t650) * t192 + t655 + t659 + t666 - t681 - t689 - t693 - t694 - t701 + t712 + t720 - t1119 + t1125
  t1131 = t663 * t211
  t1134 = 0.60000000000000000000000000000000000000000000000000e1 * t684 * t1131 * t212
  t1136 = 0.1e1 / t363
  t1137 = t853 * t2 * t1136
  t1139 = t599 * t65
  t1140 = t598 * t1139
  t1142 = t135 * t401
  t1143 = t134 * t1142
  t1145 = t6 * t401
  t1146 = t4 * t1145
  t1147 = 0.93011851851851851851851851851851851851851851851854e0 * t1146
  t1149 = t927 * t2 * t1136
  t1150 = 0.13651666666666666666666666666666666666666666666667e0 * t1149
  t1151 = t670 * t1139
  t1152 = 0.27303333333333333333333333333333333333333333333333e0 * t1151
  t1153 = t205 * t1142
  t1154 = 0.31853888888888888888888888888888888888888888888890e0 * t1153
  t1156 = t22 * t5 * t65
  t1157 = 0.36514074074074074074074074074074074074074074074075e0 * t1156
  t1161 = 0.10000000000000000000000000000000000000000000000000e1 * t201 * (-0.25319000000000000000000000000000000000000000000000e1 * t1137 + 0.16879333333333333333333333333333333333333333333333e1 * t1140 - 0.19692555555555555555555555555555555555555555555555e1 * t1143 - t1147 + t1150 - t1152 - t1154 - t1157) * t212
  t1166 = 0.51947577317044391278999449251423175496738199495715e2 * t233 * t714 * t708 * t717 * t240
  t1171 = 0.35089341735807877243573431982554320891834732042568e1 * t233 * t696 * t240 * t242 * t708
  t1175 = 0.10685000000000000000000000000000000000000000000000e0 * t468 * t137 * t661 * t664
  t1179 = 0.56968947174242584615102410102512416326352748836105e-3 * t217 * t135 * t401 * t226
  t1183 = 0.71233333333333333333333333333333333333333333333331e-1 * t468 * t10 * t200 * t213
  t1186 = 0.53424999999999999999999999999999999999999999999999e-1 * t468 * t656 * t679
  t1190 = 0.85917975471764868594145516183295969534298037676861e0 * t468 * t137 * t683 * t687
  t1196 = 0.96491876992155210400537781394436278372632330568306e2 * t198 / t682 / t28 * t1131 * t686
  t1200 = 0.48245938496077605200268890697218139186316165284153e2 * t684 * t678 * t686 * t211
  t1203 = 0.60000000000000000000000000000000000000000000000000e1 * t662 * t213 * t678
  t1204 = t697 * t240
  t1208 = 0.35089341735807877243573431982554320891834732042568e1 * t233 * t714 * t1204 * t242
  t1211 = 0.32530743900905219527896202567159734993471782831130e-1 * t506 * t141 * t699
  t1214 = 0.21687162600603479685264135044773156662314521887420e-1 * t506 * t11 * t243
  t1217 = 0.16265371950452609763948101283579867496735891415565e-1 * t506 * t141 * t710
  t1218 = -t1196 + t1161 + t1200 + t1134 - t1203 - t1166 - t1208 + t1171 - t1211 - t1214 + t1217
  t1221 = 0.48159733137676571081572406076840235616767705782485e0 * t506 * t141 * t718
  t1229 = 0.51726012919273400298984252201052768390886626637712e3 * t198 / t682 / t199 * t1131 / t685 / t31
  t1232 = 0.34450798614814814814814814814814814814814814814813e-2 * t4 * t1145 * t32
  t1240 = 0.10254018858216406658218194626490193680059335835414e4 * t233 / t713 / t234 * t1204 / t716 / t225
  t1246 = 0.10389515463408878255799889850284635099347639899143e3 * t233 / t713 / t222 * t1204 * t717
  t1250 = 0.93932222222222222222222222222222222222222222222223e0 * t1146
  t1251 = 0.73355000000000000000000000000000000000000000000000e-1 * t1149
  t1252 = 0.14671000000000000000000000000000000000000000000000e0 * t1151
  t1253 = 0.17116166666666666666666666666666666666666666666667e0 * t1153
  t1254 = 0.36793333333333333333333333333333333333333333333333e0 * t1156
  t1259 = 0.58482236226346462072622386637590534819724553404280e0 * t233 * t235 * (-0.34523333333333333333333333333333333333333333333333e1 * t1137 + 0.23015555555555555555555555555555555555555555555556e1 * t1140 - 0.26851481481481481481481481481481481481481481481482e1 * t1143 - t1250 + t1251 - t1252 - t1253 - t1254) * t242
  t1260 = t1221 + t1175 - t1179 + t1183 - t1186 - t1190 + t1229 + t1232 - t1240 + t1246 - t1259
  t1261 = t1218 + t1260
  t1274 = t725 * t254
  t1301 = t1067 * t293
  t1315 = t419 * t721
  t1316 = t1315 * t268
  t1321 = t1062 * t1067 * t1069
  t1323 = t1071 * t725 * t1073
  t1328 = t419 * t725 * t268
  t1336 = t363 * t7
  t1338 = 0.1e1 / t8 / t1336
  t1342 = t1041 * t287
  t1345 = 0.1e1 / t1336
  t1355 = t276 * t277 / t1061 / t253 * t20
  t1356 = t414 ** 2
  t1357 = 0.1e1 / t1356
  t1358 = t413 * t1357
  t1359 = t417 ** 2
  t1360 = t418 ** 2
  t1361 = 0.1e1 / t1360
  t1364 = t1274 * t1073 * t268
  t1370 = t1274 * t1073
  t1383 = t420 * t1 * t135 * t421
  t1394 = 0.34475470377105274540431389480916058143991168952439e0 * t1301 * t1098 * t354 * t562 * t1074 * t46 - 0.17237735188552637270215694740458029071995584476219e0 * t1301 * t1105 * t354 * t562 * t725 * t46 * t268 + 0.14829531371549914145000000000000000000000000000000e-2 * t1046 * t1048 * t1316 + 0.29659062743099828289999999999999999999999999999999e-2 * t1046 * t1321 * t1323 - 0.14829531371549914145000000000000000000000000000000e-2 * t1046 * t1321 * t1328 - 0.88977188229299484869999999999999999999999999999999e-2 * t394 * t641 * t50 * t1049 - 0.14648281543675415194338888888888888888888888888889e-5 * t22 * t5 * t1338 * t794 * t1342 + 0.90624913937249475330555555555555555555555555555555e-4 * t4 * t6 * t1345 * t393 * t1342 + 0.16681137650787305000000000000000000000000000000000e-1 * t1355 * t1358 * t1359 * t1361 * t1364 - 0.16681137650787305000000000000000000000000000000000e-1 * t1355 * t1358 * t1359 * t1071 * t1370 + 0.64871090864172852777777777777777777777777777777776e-1 * t276 * t1035 * t410 * t423 + 0.43944844631026245583016666666666666666666666666667e-4 * t796 * t798 * t1047 * t1383 - 0.70261958942123456790123456790123456790123456790126e-1 * t1100 * t434 * t742 * t1074 + 0.35130979471061728395061728395061728395061728395063e-1 * t1107 * t434 * t742 * t1080
  t1417 = t1261 * t268
  t1423 = t1357 * t1359 * t293
  t1425 = 0.1e1 / t1061 / t407
  t1443 = t1274 * t268
  t1453 = t413 * t1094
  t1455 = t1073 * t254
  t1464 = t169 * t41
  t1465 = t370 * t721
  t1474 = 0.12881359139389300411522633744855967078189300411523e0 * t433 * t434 * t640 * t370 * t421 + 0.13174117301648148148148148148148148148148148148148e-1 * t1087 * t1091 + 0.26348234603296296296296296296296296296296296296297e-1 * t1095 * t1098 * t1085 * t1102 - 0.13174117301648148148148148148148148148148148148148e-1 * t1095 * t1105 * t1085 * t1109 + 0.13174117301648148148148148148148148148148148148148e-1 * t427 * t430 * t1021 * t44 * t437 - 0.70261958942123456790123456790123456790123456790126e-1 * t1087 * t744 + 0.43913724338827160493827160493827160493827160493828e-2 * t433 * t434 * t435 * t1417 + 0.26348234603296296296296296296296296296296296296297e-1 * t1423 * t1425 * t1361 * t431 * t434 * t435 * t1364 - 0.26348234603296296296296296296296296296296296296297e-1 * t1423 * t1425 * t1071 * t431 * t434 * t435 * t1370 + 0.43913724338827160493827160493827160493827160493828e-2 * t1423 * t1425 * t419 * t431 * t434 * t435 * t1443 + 0.27801896084645508333333333333333333333333333333333e-2 * t1355 * t1358 * t1359 * t419 * t1443 + 0.16681137650787305000000000000000000000000000000000e-1 * t1065 * t1453 * t1071 * t721 * t1455 - 0.83405688253936524999999999999999999999999999999999e-2 * t1065 * t1453 * t1315 * t421 + 0.26348234603296296296296296296296296296296296296297e-1 * t1100 * t1464 * t1465 * t1455 - 0.13174117301648148148148148148148148148148148148148e-1 * t1107 * t1464 * t1465 * t421
  t1477 = 0.1e1 / t23 / t364
  t1478 = s0 * t1477
  t1486 = 0.1e1 / t558 / t63
  t1535 = t558 ** 2
  t1566 = t837 * t501
  t1580 = t2 * t1136
  t1581 = t296 * t853 * t1580
  t1583 = t22 * t65
  t1584 = t817 * t1583
  t1586 = t4 * t401
  t1587 = t447 * t1586
  t1589 = -0.17261666666666666666666666666666666666666666666667e1 * t1581 + 0.11507777777777777777777777777777777777777777777778e1 * t1584 - 0.53702962962962962962962962962962962962962962962964e1 * t1587 - t1250 + t1251 - t1252 - t1253 - t1254
  t1641 = t525 ** 2
  t1644 = t528 ** 2
  t1650 = 0.60000000000000000000000000000000000000000000000000e1 * t475 * t990 * t464 + 0.28947563097646563120161334418330883511789699170492e3 * t918 * t939 * t810 - 0.18000000000000000000000000000000000000000000000000e2 * t493 * t488 * t810 + 0.11407595979765752407267741521970340469066011116898e3 * t216 * t874 * t1566 * t877 + 0.55403703703703703703703703703703703703703703703703e-1 * t468 * t401 * t316 * t323 - 0.14035736694323150897429372793021728356733892817027e2 * t233 * t888 * t341 * t1566 + 0.17315859105681463759666483083807725165579399831905e2 * t233 * t527 * t529 * t1589 - 0.11696447245269292414524477327518106963944910680856e1 * t233 * t512 * t341 * t1589 - 0.71233333333333333333333333333333333333333333333332e-1 * t468 * t893 * t488 - 0.31168546390226634767399669550853905298042919697429e3 * t233 * t887 * t520 * t889 + 0.53424999999999999999999999999999999999999999999999e-1 * t468 * t469 * t990 + 0.26345324029629629629629629629629629629629629629628e-2 * t455 * t458 * t3 * t401 + 0.51947577317044391278999449251423175496738199495715e2 * t233 * t526 * t934 * t530 + 0.51947577317044391278999449251423175496738199495715e2 * t233 * t842 * t869 + 0.30762056574649219974654583879470581040178007506242e4 * t233 * t874 * t520 * t878 - 0.35089341735807877243573431982554320891834732042568e1 * t233 * t511 * t934 * t513 - 0.35089341735807877243573431982554320891834732042568e1 * t233 * t846 * t882 + 0.62337092780453269534799339101707810596085839394858e3 * t233 * t875 * t529 * t1566 - 0.12304822629859687989861833551788232416071203002497e5 * t233 / t525 / t510 * t339 * t877 * t1566 + 0.91082604192152556048340974007871726131433263376469e5 * t233 / t1641 * t339 / t1644 * t1566
  t1676 = -0.12659500000000000000000000000000000000000000000000e1 * t1581 + 0.84396666666666666666666666666666666666666666666667e0 * t1584 - 0.39385111111111111111111111111111111111111111111110e1 * t1587 - t1147 + t1150 - t1152 - t1154 - t1157
  t1680 = t810 * t464
  t1694 = t495 * t824
  t1699 = t322 * t824
  t1720 = t491 ** 2
  t1723 = t494 ** 2
  t1735 = 0.10526802520742363173072029594766296267550419612770e2 * t233 * t842 * t838 - 0.16936279733333333333333333333333333333333333333332e-2 * t850 * t854 * t21 * t65 - 0.48245938496077605200268890697218139186316165284153e2 * t493 * t989 * t495 * t464 + 0.39036892681086263433475443080591681992166139397356e0 * t216 * t526 * t1566 * t341 + 0.5143752e0 * t979 * t974 * t451 + 0.65061487801810439055792405134319469986943565662261e-1 * t216 * t335 * t1589 * t341 - 0.16081979498692535066756296899072713062105388428051e2 * t493 * t496 * t1676 - 0.57895126195293126240322668836661767023579398340984e3 * t899 * t496 * t1680 + 0.62071215503128080358781102641263322069063951965254e4 * t198 / t491 / t473 * t902 * t1680 - 0.48245938496077605200268890697218139186316165284153e2 * t493 * t939 * t824 + 0.28947563097646563120161334418330883511789699170492e3 * t918 * t321 * t1694 * t464 - 0.18000000000000000000000000000000000000000000000000e2 * t493 * t321 * t1699 * t464 - 0.15517803875782020089695275660315830517265987991313e4 * t899 * t321 * t901 * t824 * t464 - 0.12822000000000000000000000000000000000000000000000e1 * t492 * t1680 * t322 - 0.11053848960848725643892934695364976605132472112479e3 * t898 * t1680 * t901 + 0.20620314113223568462594923883991032688231529042447e2 * t917 * t1680 * t495 - 0.21370000000000000000000000000000000000000000000000e0 * t316 * t1676 * t322 - 0.24955700379505800914252936827276051226357058527653e5 * t198 / t1720 * t321 / t1723 * t1680 + 0.24000000000000000000000000000000000000000000000000e2 * t918 * t323 * t1680 + 0.20000000000000000000000000000000000000000000000000e1 * t475 * t323 * t1676
  t1749 = 0.1e1 / t15 / t2 * r0 / 0.48e2
  t1751 = t296 * t1749 * t1580
  t1753 = t922 * t1583
  t1755 = t479 * t1586
  t1757 = t14 ** (-0.25e1)
  t1759 = t1757 * t2 * t1136
  t1761 = t928 * t1139
  t1763 = t483 * t1142
  t1797 = t868 * t501
  t1845 = 0.57791679765211885297886887292208282740121246938982e1 * t216 * t526 * t869 * t501 - 0.39036892681086263433475443080591681992166139397356e0 * t216 * t511 * t882 * t501 + 0.58482236226346462072622386637590534819724553404280e0 * t233 * t335 * (0.17261666666666666666666666666666666666666666666666e2 * t1751 - 0.69046666666666666666666666666666666666666666666665e1 * t1753 + 0.10740592592592592592592592592592592592592592592593e2 * t1755 - 0.44012999999999999999999999999999999999999999999999e0 * t1759 + 0.29342000000000000000000000000000000000000000000000e0 * t1761 - 0.34232333333333333333333333333333333333333333333333e0 * t1763 - 0.25755333333333333333333333333333333333333333333333e0 * t1146) * t341 + 0.42340699333333333333333333333333333333333333333333e-2 * t302 * t296 * t1749 * t2 * t1136 + 0.21687162600603479685264135044773156662314521887420e-1 * t506 * t11 * t522 - 0.16265371950452609763948101283579867496735891415565e-1 * t506 * t141 * t936 - 0.16867793133802706421872105034823566292911294801327e-1 * t506 * t1145 * t342 - 0.10685000000000000000000000000000000000000000000000e0 * t142 * t998 * t1699 + 0.32055000000000000000000000000000000000000000000000e0 * t142 * t993 * t322 * t810 + 0.85917975471764868594145516183295969534298037676862e0 * t142 * t993 * t1694 + 0.10526802520742363173072029594766296267550419612770e2 * t216 * t232 * t526 * t960 * t1797 + 0.60000000000000000000000000000000000000000000000000e1 * t475 * t488 * t824 - 0.11558335953042377059577377458441656548024249387796e2 * t216 * t887 * t1566 * t529 - 0.10000000000000000000000000000000000000000000000000e1 * t317 * (0.12659500000000000000000000000000000000000000000000e2 * t1751 - 0.50638000000000000000000000000000000000000000000001e1 * t1753 + 0.78770222222222222222222222222222222222222222222223e1 * t1755 - 0.81910000000000000000000000000000000000000000000002e0 * t1759 + 0.54606666666666666666666666666666666666666666666667e0 * t1761 - 0.63707777777777777777777777777777777777777777777777e0 * t1763 - 0.25559851851851851851851851851851851851851851851851e0 * t1146) * t322 - 0.25404419600000000000000000000000000000000000000000e-2 * t445 * t922 * t22 * t40 * t451 - 0.21369999999999999999999999999999999999999999999999e0 * t142 * t474 * t487 * t999 + 0.17183595094352973718829103236659193906859607535372e1 * t142 * t492 * t487 * t994 + 0.67745118933333333333333333333333333333333333333331e-2 * t1003 * t4 * t10 * t451 - 0.50808839199999999999999999999999999999999999999999e-2 * t1003 * t4 * t137 * t973 + 0.15242651760000000000000000000000000000000000000000e-1 * t979 * t479 * t4 * t137 * t980
  t1853 = t339 * t877
  t1931 = 0.32547666666666666666666666666666666666666666666667e-1 * t1146
  t1936 = -0.31168546390226634767399669550853905298042919697429e3 * t216 * t232 * t887 * t966 * t1797 + 0.30762056574649219974654583879470581040178007506242e4 * t216 * t232 * t874 * t1853 * t1797 - 0.51550785283058921156487309709977581720578822606116e1 * t142 * t917 * t321 * t495 * t810 + 0.27634622402121814109732336738412441512831180281197e2 * t142 * t898 * t321 * t901 * t810 + 0.14246666666666666666666666666666666666666666666666e0 * t606 * t1000 - 0.11455730062901982479219402157772795937906405023582e1 * t606 * t995 - 0.10310157056611784231297461941995516344115764521224e2 * t492 * t824 * t994 - 0.43374325201206959370528270089546313324629043774840e-1 * t958 * t10 * t511 * t961 + 0.64212977516902094775429874769120314155690274376647e0 * t958 * t10 * t526 * t967 + 0.32530743900905219527896202567159734993471782831130e-1 * t958 * t959 * t960 * t868 + 0.28895839882605942648943443646104141370060623469492e1 * t958 * t137 * t887 * t966 * t837 - 0.97592231702715658583688607701479204980415348493391e-1 * t958 * t965 * t960 * t837 - 0.48159733137676571081572406076840235616767705782486e0 * t958 * t965 * t966 * t868 + 0.65061487801810439055792405134319469986943565662260e-1 * t958 * t959 * t520 * t341 * t501 - 0.96319466275353142163144812153680471233535411564971e0 * t958 * t965 * t520 * t529 * t501 - 0.28518989949414381018169353804925851172665027792245e2 * t958 * t137 * t874 * t1853 * t837 - 0.15517803875782020089695275660315830517265987991313e4 * t899 * t487 * t901 * t810 + 0.12822000000000000000000000000000000000000000000000e1 * t474 * t464 * t1699 - 0.6858336e0 / t977 / t299 * t192 * t305 * t980 * t451 - 0.571528e-1 * t445 * t305 * (-0.14816666666666666666666666666666666666666666666667e-1 * t1581 + 0.98777777777777777777777777777777777777777777777780e-2 * t1584 - 0.46096296296296296296296296296296296296296296296297e-1 * t1587 - t1931)
  t1943 = t595 * t144
  t1949 = -0.29633333333333333333333333333333333333333333333333e-1 * t1137 + 0.19755555555555555555555555555555555555555555555555e-1 * t1140 - 0.23048148148148148148148148148148148148148148148148e-1 * t1143 - t1931
  t1952 = -t1134 - t1161 + t1166 - t1171 - t1175 + t1179 - t1183 + t1186 + t1190 - t1232 + 0.1714584e0 * t616 * t192 * t1943 + 0.285764e-1 * t538 * t1949
  t1956 = -t1229 + t1208 + t1240 - t1246 + t1259 + t1196 + t1203 - t1200 - 0.1714584e0 * t1013 * t144 * t608 + t1211 + t1214 - t1217 - t1221
  t1965 = 0.17685589265329897609962962962962962962962962962963e-1 * t394 * t1478 * t397 - 0.20110691053311410148584977197201033917328181888923e1 * t555 * t765 * t772 + 0.72653861646566300790760965239411989199744352347918e1 * t555 * t556 * t557 * t1486 * t370 + 0.17237735188552637270215694740458029071995584476219e0 * t555 * t286 * t1021 * t562 - 0.24715885619249856908333333333333333333333333333334e-4 * t1040 * s0 * t50 * t409 * t415 * t1383 + 0.18795662461163665063161298619772578244797409513427e0 * t747 * t429 * t419 * t354 * t783 * t786 * t45 * t359 * t50 * t370 * t421 - 0.99469005991731707592592592592592592592592592592592e-2 * t1477 * t274 * t385 * t389 + 0.50043412952361914999999999999999999999999999999999e-2 * t776 * t755 * t759 - 0.20110691053311410148584977197201033917328181888923e1 * t749 * t771 * t751 + 0.34475470377105274540431389480916058143991168952439e0 * t747 * t430 * t544 * t752 + 0.17237735188552637270215694740458029071995584476219e0 * t749 * t561 * t1465 * t268 - 0.83405688253936524999999999999999999999999999999999e-3 * t756 * t426 * t1316 + 0.40988786924700376993741670691528929491621648719567e0 * t781 * t782 * t557 / t23 / t1535 / t364 * t44 / t48 / t417 * t152 * t370 + 0.43913724338827160493827160493827160493827160493828e-2 * t294 * t295 * (-0.140e3 / 0.27e2 * t4 * t1145 * t345 + 0.20e2 / 0.3e1 * t4 * t11 * t534 - 0.5e1 * t4 * t141 * t1009 + 0.5e1 * t4 * t13 * (t1650 + t1735 + t1845 + t1936) - 0.45e2 * params.eta * (t1952 + t1956)) * t372
  t1972 = t392 ** 2
  t1998 = t276 * t402 * t1063
  t2012 = t384 * t385 * t1062
  t2029 = 0.12881359139389300411522633744855967078189300411523e0 * t546 * t1030 - 0.20037669772383356195701874714220393232738911751258e0 * t356 * t357 * t1478 * t370 + 0.26044644584654888215534544444444444444444444444445e-5 * t271 / t1972 * s0 * t1338 * t50 * t278 * t287 * t22 * t5 + 0.18795662461163665063161298619772578244797409513427e0 * t780 * t545 * t790 - 0.16916096215047298556845168757795320420317668562084e1 * t781 * t783 / t8 / t1535 * t45 * t789 - 0.35130979471061728395061728395061728395061728395063e-1 * t1023 * t550 - 0.19461327259251855833333333333333333333333333333333e-1 * t1053 * t1058 - 0.38922654518503711666666666666666666666666666666665e-1 * t1998 * t1076 + 0.19461327259251855833333333333333333333333333333333e-1 * t1998 * t1082 + 0.27801896084645508333333333333333333333333333333333e-2 * t412 * t416 * t420 * t1417 - 0.35130979471061728395061728395061728395061728395063e-1 * t433 * t434 * t742 * t1056 - 0.16681137650787305000000000000000000000000000000000e-2 * t2012 * t1094 * t1323 + 0.83405688253936524999999999999999999999999999999999e-3 * t2012 * t1094 * t1328 - 0.16113109698042956713772777777777777777777777777778e-3 * t796 * t1345 * t50 * t278 * t801 - 0.93702686803805231790123456790123456790123456790122e-1 * t276 * t366 * t50 * t278 * t288
  t2037 = t249 * t253 * (-t1261 * t255 * t46 * t379 + 0.3e1 * t721 * t415 * t417 * t429 * t254 * t268 * t378 - 0.3e1 / 0.4e1 * t723 * t732 - t1274 * t1067 * t1069 * t1097 * t268 * t378 + 0.3e1 / 0.4e1 * t727 * t728 * t731 + 0.15e2 / 0.16e2 * t257 * t269 * t737 * t739 - 0.3e1 / 0.4e1 * t257 * t269 * t382 * t1113 + 0.45e2 / 0.64e2 * t285 / t376 / t735 / t375 * t739 * t566 - 0.15e2 / 0.16e2 * t738 * t566 * t1113 + t383 * (t1394 + t1474 + t1965 + t2029) / 0.4e1) * t573
  t2038 = t1134 + t1161 - t1166 + t1171 + t1175 - t1179 + t1183 - t1186 - t1190 + t2037 + t1232 + t1229 - t1208 - t1240
  t2042 = 0.40e2 / 0.9e1 * tau0 * t65 - 0.11e2 / 0.9e1 * t641
  t2044 = t68 * t71
  t2048 = 0.1e1 / t70 / t56
  t2049 = t43 * t2048
  t2050 = params.eta ** 2
  t2051 = t2050 * t361
  t2052 = t2051 * t634
  t2055 = t53 * t640
  t2058 = t2042 * t57 + 0.2e1 / 0.3e1 * t2044 * t73 + 0.2e1 / 0.9e1 * t2049 * t2052 - 0.11e2 / 0.9e1 * t72 * t2055
  t2059 = f.my_piecewise3(t60, 0, t2058)
  t2062 = t77 ** 2
  t2066 = 0.1e1 / t83 / t79
  t2067 = t78 * t2066
  t2072 = -0.64e0 * t2059 * t80 - 0.128e1 * t2062 * t84 - 0.128e1 * t2067 * t2062 - 0.64e0 * t85 * t2059
  t2074 = t88 ** 2
  t2077 = f.my_piecewise3(t94, 0, t2058)
  t2079 = t95 ** 2
  t2103 = -0.64e0 * t2077 - 0.8704e0 * t2079 - 0.8704e0 * t97 * t2077 - 0.9214113627294e1 * t97 * t2079 - 0.4607056813647e1 * t100 * t2077 + 0.36738723026100e2 * t100 * t2079 + 0.12246241008700e2 * t103 * t2077 - 0.38314204724120e2 * t103 * t2079 - 0.9578551181030e1 * t106 * t2077 + 0.15506534051160e2 * t106 * t2079 + 0.3101306810232e1 * t109 * t2077 - 0.2177652951264e1 * t109 * t2079 - 0.362942158544e0 * t112 * t2077
  t2105 = 0.1e1 / t118 / t117
  t2106 = t120 ** 2
  t2110 = f.my_piecewise3(t94, t2058, 0)
  t2114 = t118 ** 2
  t2115 = 0.1e1 / t2114
  t2120 = f.my_piecewise5(t59, t2072 * t91 + t2074 * t91, t93, t2103, -0.210e1 * t2105 * t2106 * t124 - 0.105e1 * t119 * t2110 * t124 - 0.1575e1 * t2115 * t2106 * t124)
  t2129 = 0.2e1 * t249 * t253 * t1120 * t569 / t1122 / t572
  t2136 = 0.3e1 * t249 * t253 * t1116 * t1123 * t569
  t2137 = -t1134 - t1161 + t1166 - t1171 - t1175 + t1179 - t1183 + t1186 + t1190 - t2037 - t1232 - t1229 + t1208
  t2138 = t616 * t1943
  t2140 = t594 * t144
  t2143 = t132 * t1949
  t2196 = 0.1e1 / t8 / t558
  t2204 = -0.60000000000000000000000000000000000000000000000000e1 * t2138 * t161 + 0.60000000000000000000000000000000000000000000000000e1 * t2140 * t161 * t608 - 0.60000000000000000000000000000000000000000000000000e1 / t615 / t130 * t1943 * t161 - 0.85350568417505433333333333333333333333333333333330e-1 * t596 * t620 * t623 - 0.10000000000000000000000000000000000000000000000000e1 * t2143 * t161 + 0.30000000000000000000000000000000000000000000000000e1 * t616 * t608 * t144 * t149 * t160 + 0.42675284208752716666666666666666666666666666666665e-1 * t609 * t620 * t623 - 0.10000000000000000000000000000000000000000000000000e1 / t615 / t131 * t1943 * t161 - 0.42675284208752716666666666666666666666666666666665e-1 * t617 * t620 * t623 + 0.60705996076593966087358779412675925925925925925921e-2 * t145 * t149 * t628 * t360 * t362 * t634 - 0.15647604209875996111111111111111111111111111111110e0 * t621 * t151 * t153 * t640 - 0.31087747628928898252912838668079770391184269901849e-2 * t164 / t158 / t626 / t157 / t417 * t557 * t1486 + 0.22258865228084454232031552451314506172839506172838e-1 * t630 * t631 * t361 * t2196 - 0.24340717659807105061728395061728395061728395061728e0 * t168 * t169 * t1478
  t2217 = t1240 - t1246 + t1259 + t1196 + t1203 - t1200 - t2129 + t1211 + t1214 - t1217 - t1221 + t2136 + (0.1714584e0 * t2138 - 0.1714584e0 * t2140 * t608 + 0.285764e-1 * t2143 + 0.285764e-1 * t2204 * t176 - 0.857292e-1 * t645 * t650 * t173 + 0.571528e-1 * t648 * t173 / t649 / t175) * t192
  t2232 = t70 ** 2
  t2246 = (-0.440e3 / 0.27e2 * tau0 * t640 + 0.154e3 / 0.27e2 * t1478) * t57 + t2042 * t71 * t73 + 0.2e1 / 0.3e1 * t68 * t2048 * t2052 - 0.11e2 / 0.3e1 * t2044 * t2055 + 0.2e1 / 0.9e1 * t43 / t2232 * t2050 * params.eta * t557 * t1486 - 0.22e2 / 0.9e1 * t2049 * t2051 * t2196 + 0.154e3 / 0.27e2 * t72 * t53 * t1477
  t2247 = f.my_piecewise3(t60, 0, t2246)
  t2253 = t2062 * t77
  t2256 = t83 ** 2
  t2274 = f.my_piecewise3(t94, 0, t2246)
  t2280 = t2079 * t95
  t2310 = -0.64e0 * t2274 - 0.26112e1 * t95 * t2077 - 0.8704e0 * t97 * t2274 - 0.9214113627294e1 * t2280 - 0.27642340881882e2 * t98 * t2077 - 0.4607056813647e1 * t100 * t2274 + 0.73477446052200e2 * t97 * t2280 + 0.110216169078300e3 * t101 * t2077 + 0.12246241008700e2 * t103 * t2274 - 0.114942614172360e3 * t100 * t2280 - 0.114942614172360e3 * t104 * t2077 - 0.9578551181030e1 * t106 * t2274 + 0.62026136204640e2 * t103 * t2280 + 0.46519602153480e2 * t107 * t2077 + 0.3101306810232e1 * t109 * t2274 - 0.10888264756320e2 * t106 * t2280 - 0.6532958853792e1 * t110 * t2077 - 0.362942158544e0 * t112 * t2274
  t2311 = t2106 * t120
  t2324 = f.my_piecewise3(t94, t2246, 0)
  t2338 = f.my_piecewise5(t59, (-0.64e0 * t2247 * t80 - 0.384e1 * t2059 * t84 * t77 - 0.384e1 * t2253 * t2066 - 0.384e1 * t78 / t2256 * t2253 - 0.384e1 * t2067 * t77 * t2059 - 0.64e0 * t85 * t2247) * t91 + 0.3e1 * t2072 * t88 * t91 + t2074 * t88 * t91, t93, t2310, -0.630e1 * t2115 * t2311 * t124 - 0.630e1 * t2105 * t120 * t124 * t2110 - 0.9450e1 / t2114 / t117 * t2311 * t124 - 0.105e1 * t119 * t2324 * t124 - 0.4725e1 * t2115 * t2110 * t120 * t124 - 0.23625e1 / t2114 / t118 * t2311 * t124)
  t2340 = jnp.log(t175)
  t2344 = jnp.log(t572)
  t2347 = (-0.285764e-1 * t147 + 0.285764e-1 * t2340) * t192 + t260 - t263 - t249 * t253 * t2344
  t2349 = t1246 - t1259 + 0.3e1 * t2120 * t576 - t1196 - t1203 + t1200 + t2129 - t1211 - t1214 + t1217 + t1221 + 0.3e1 * t127 * t1126 - t2136 + t592 * (t2137 + t2217) + t2338 * t2347
  v3rho3_0_ = -0.44293883933333333333333333333333333333333333333332e-2 * t34 + 0.6e1 * t127 * t576 + 0.32530743900905219527896202567159734993471782831130e-1 * t580 + 0.3e1 * t592 * t1126 + 0.30000000000000000000000000000000000000000000000000e1 * t680 + 0.48245938496077605200268890697218139186316165284153e2 * t688 + r0 * (t2038 + t2349) + 0.3e1 * t2120 * t2347 - 0.60000000000000000000000000000000000000000000000000e1 * t665 + 0.3e1 * t1119 - 0.10685000000000000000000000000000000000000000000000e0 * t658 + 0.73245789224026180219417384417515963848167819932136e-3 * t692 - 0.3e1 * t1125 + 0.35089341735807877243573431982554320891834732042568e1 * t700 - 0.17544670867903938621786715991277160445917366021284e1 * t711 - 0.51947577317044391278999449251423175496738199495715e2 * t719

  res = {'v3rho3': v3rho3_0_}
  return res
