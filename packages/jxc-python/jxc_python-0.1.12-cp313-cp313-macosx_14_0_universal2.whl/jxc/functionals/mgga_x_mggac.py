"""Generated from mgga_x_mggac.mpl."""

import jax
import jax.lax as lax
import jax.numpy as jnp
import numpy as np
from jax.numpy import array as array
from jax.numpy import int32 as int32
from jax.numpy import nan as nan
from typing import Callable, Optional
from jxc.functionals.utils import *

def pol(p, r, s=(None, None, None), l=(None, None), tau=(None, None)):
  f = funcs(p)
  params = f.params
  (r0, r1), (s0, s1, s2), (l0, l1), (tau0, tau1) = r, s, l, tau
  mbrxc_v0 = lambda x: -(32 * jnp.pi) ** (1 / 3) / (8 * X_FACTOR_C) * jnp.exp(x / 3) * (8 - jnp.exp(-x) * (x ** 2 + 5 * x + 8)) / (x * (1 + x) ** (1 / 3))

  mbrxc_v_smallq = lambda x: -1 / 12 * 32 ** (1 / 3) * jnp.pi ** (1 / 3) * 3 ** (2 / 3) / (1 / jnp.pi) ** (1 / 3) * 4 ** (1 / 3) - 1 / 108 * 32 ** (1 / 3) * jnp.pi ** (1 / 3) * 3 ** (2 / 3) / (1 / jnp.pi) ** (1 / 3) * 4 ** (1 / 3) * x ** 2 + 1 / 108 * 32 ** (1 / 3) * jnp.pi ** (1 / 3) * 3 ** (2 / 3) / (1 / jnp.pi) ** (1 / 3) * 4 ** (1 / 3) * x ** 3 - 13 / 1620 * 32 ** (1 / 3) * jnp.pi ** (1 / 3) * 3 ** (2 / 3) / (1 / jnp.pi) ** (1 / 3) * 4 ** (1 / 3) * x ** 4 + 67 / 9720 * 32 ** (1 / 3) * jnp.pi ** (1 / 3) * 3 ** (2 / 3) / (1 / jnp.pi) ** (1 / 3) * 4 ** (1 / 3) * x ** 5 - 52 / 8505 * 32 ** (1 / 3) * jnp.pi ** (1 / 3) * 3 ** (2 / 3) / (1 / jnp.pi) ** (1 / 3) * 4 ** (1 / 3) * x ** 6 + 1811 / 326592 * 32 ** (1 / 3) * jnp.pi ** (1 / 3) * 3 ** (2 / 3) / (1 / jnp.pi) ** (1 / 3) * 4 ** (1 / 3) * x ** 7

  mbrxc_v_cutoff = DBL_EPSILON ** (1 / 4)

  task_alpha = lambda x, t: t / K_FACTOR_C * jnp.maximum(1 - x ** 2 / (8 * t), 1e-10)

  mggac_b1 = 3.712

  mggac_b2 = 2.0

  mggac_b4 = 0.1

  mbrxc_v = lambda x: f.my_piecewise3(x < mbrxc_v_cutoff, mbrxc_v_smallq(x), mbrxc_v0(jnp.maximum(x, mbrxc_v_cutoff)))

  mggac_b3 = 2.595 + 0.5197 * mggac_b4 + 0.559 * mggac_b2

  mggac_b5 = -3 * mggac_b3

  mbrxc_Q = lambda x, t: +(32 * jnp.pi) ** (2 / 3) / 6 * (1 + mggac_b4 * task_alpha(x, t) + mggac_b5 * task_alpha(x, t) ** 2) / (mggac_b1 + mggac_b2 * task_alpha(x, t) + mggac_b3 * task_alpha(x, t) ** 2)

  mbrxc_f = lambda x, u, t: -mbrxc_v(mbrxc_x(mbrxc_Q(x, t))) / 2

  functional_body = lambda rs, z, xt, xs0, xs1, u0, u1, t0, t1: mgga_exchange(f, params, mbrxc_f, rs, z, xs0, xs1, u0, u1, t0, t1)

  res = functional_body(
      f.r_ws(f.dens(r0, r1)),
      f.zeta(r0, r1),
      f.xt(r0, r1, s0, s1, s2),
      f.xs0(r0, r1, s0, s2),
      f.xs1(r0, r1, s0, s2),
      f.u0(r0, r1, l0, l1),
      f.u1(r0, r1, l0, l1),
      f.tt0(r0, r1, tau0, tau1),
      f.tt1(r0, r1, tau0, tau1),
  )
  return res

def unpol(p, r, s=None, l=None, tau=None):
  f = funcs(p)
  params = f.params
  r0, s0, l0, tau0 = r, s, l, tau
  mbrxc_v0 = lambda x: -(32 * jnp.pi) ** (1 / 3) / (8 * X_FACTOR_C) * jnp.exp(x / 3) * (8 - jnp.exp(-x) * (x ** 2 + 5 * x + 8)) / (x * (1 + x) ** (1 / 3))

  mbrxc_v_smallq = lambda x: -1 / 12 * 32 ** (1 / 3) * jnp.pi ** (1 / 3) * 3 ** (2 / 3) / (1 / jnp.pi) ** (1 / 3) * 4 ** (1 / 3) - 1 / 108 * 32 ** (1 / 3) * jnp.pi ** (1 / 3) * 3 ** (2 / 3) / (1 / jnp.pi) ** (1 / 3) * 4 ** (1 / 3) * x ** 2 + 1 / 108 * 32 ** (1 / 3) * jnp.pi ** (1 / 3) * 3 ** (2 / 3) / (1 / jnp.pi) ** (1 / 3) * 4 ** (1 / 3) * x ** 3 - 13 / 1620 * 32 ** (1 / 3) * jnp.pi ** (1 / 3) * 3 ** (2 / 3) / (1 / jnp.pi) ** (1 / 3) * 4 ** (1 / 3) * x ** 4 + 67 / 9720 * 32 ** (1 / 3) * jnp.pi ** (1 / 3) * 3 ** (2 / 3) / (1 / jnp.pi) ** (1 / 3) * 4 ** (1 / 3) * x ** 5 - 52 / 8505 * 32 ** (1 / 3) * jnp.pi ** (1 / 3) * 3 ** (2 / 3) / (1 / jnp.pi) ** (1 / 3) * 4 ** (1 / 3) * x ** 6 + 1811 / 326592 * 32 ** (1 / 3) * jnp.pi ** (1 / 3) * 3 ** (2 / 3) / (1 / jnp.pi) ** (1 / 3) * 4 ** (1 / 3) * x ** 7

  mbrxc_v_cutoff = DBL_EPSILON ** (1 / 4)

  task_alpha = lambda x, t: t / K_FACTOR_C * jnp.maximum(1 - x ** 2 / (8 * t), 1e-10)

  mggac_b1 = 3.712

  mggac_b2 = 2.0

  mggac_b4 = 0.1

  mbrxc_v = lambda x: f.my_piecewise3(x < mbrxc_v_cutoff, mbrxc_v_smallq(x), mbrxc_v0(jnp.maximum(x, mbrxc_v_cutoff)))

  mggac_b3 = 2.595 + 0.5197 * mggac_b4 + 0.559 * mggac_b2

  mggac_b5 = -3 * mggac_b3

  mbrxc_Q = lambda x, t: +(32 * jnp.pi) ** (2 / 3) / 6 * (1 + mggac_b4 * task_alpha(x, t) + mggac_b5 * task_alpha(x, t) ** 2) / (mggac_b1 + mggac_b2 * task_alpha(x, t) + mggac_b3 * task_alpha(x, t) ** 2)

  mbrxc_f = lambda x, u, t: -mbrxc_v(mbrxc_x(mbrxc_Q(x, t))) / 2

  functional_body = lambda rs, z, xt, xs0, xs1, u0, u1, t0, t1: mgga_exchange(f, params, mbrxc_f, rs, z, xs0, xs1, u0, u1, t0, t1)

  res = functional_body(
      f.r_ws(f.dens(r0 / 2, r0 / 2)),
      f.zeta(r0 / 2, r0 / 2),
      f.xt(r0 / 2, r0 / 2, s0 / 4, s0 / 4, s0 / 4),
      f.xs0(r0 / 2, r0 / 2, s0 / 4, s0 / 4),
      f.xs1(r0 / 2, r0 / 2, s0 / 4, s0 / 4),
      f.u0(r0 / 2, r0 / 2, l0 / 2, l0 / 2),
      f.u1(r0 / 2, r0 / 2, l0 / 2, l0 / 2),
      f.tt0(r0 / 2, r0 / 2, tau0 / 2, tau0 / 2),
      f.tt1(r0 / 2, r0 / 2, tau0 / 2, tau0 / 2),
  )
  return res

def pol_vxc(p, r, s=(None, None, None), l=(None, None), tau=(None, None)):
  f = funcs(p)
  params = f.params
  (r0, r1), (s0, s1, s2), (l0, l1), (tau0, tau1) = r, s, l, tau
  mbrxc_v0 = lambda x: -(32 * jnp.pi) ** (1 / 3) / (8 * X_FACTOR_C) * jnp.exp(x / 3) * (8 - jnp.exp(-x) * (x ** 2 + 5 * x + 8)) / (x * (1 + x) ** (1 / 3))

  mbrxc_v_smallq = lambda x: -1 / 12 * 32 ** (1 / 3) * jnp.pi ** (1 / 3) * 3 ** (2 / 3) / (1 / jnp.pi) ** (1 / 3) * 4 ** (1 / 3) - 1 / 108 * 32 ** (1 / 3) * jnp.pi ** (1 / 3) * 3 ** (2 / 3) / (1 / jnp.pi) ** (1 / 3) * 4 ** (1 / 3) * x ** 2 + 1 / 108 * 32 ** (1 / 3) * jnp.pi ** (1 / 3) * 3 ** (2 / 3) / (1 / jnp.pi) ** (1 / 3) * 4 ** (1 / 3) * x ** 3 - 13 / 1620 * 32 ** (1 / 3) * jnp.pi ** (1 / 3) * 3 ** (2 / 3) / (1 / jnp.pi) ** (1 / 3) * 4 ** (1 / 3) * x ** 4 + 67 / 9720 * 32 ** (1 / 3) * jnp.pi ** (1 / 3) * 3 ** (2 / 3) / (1 / jnp.pi) ** (1 / 3) * 4 ** (1 / 3) * x ** 5 - 52 / 8505 * 32 ** (1 / 3) * jnp.pi ** (1 / 3) * 3 ** (2 / 3) / (1 / jnp.pi) ** (1 / 3) * 4 ** (1 / 3) * x ** 6 + 1811 / 326592 * 32 ** (1 / 3) * jnp.pi ** (1 / 3) * 3 ** (2 / 3) / (1 / jnp.pi) ** (1 / 3) * 4 ** (1 / 3) * x ** 7

  mbrxc_v_cutoff = DBL_EPSILON ** (1 / 4)

  task_alpha = lambda x, t: t / K_FACTOR_C * jnp.maximum(1 - x ** 2 / (8 * t), 1e-10)

  mggac_b1 = 3.712

  mggac_b2 = 2.0

  mggac_b4 = 0.1

  mbrxc_v = lambda x: f.my_piecewise3(x < mbrxc_v_cutoff, mbrxc_v_smallq(x), mbrxc_v0(jnp.maximum(x, mbrxc_v_cutoff)))

  mggac_b3 = 2.595 + 0.5197 * mggac_b4 + 0.559 * mggac_b2

  mggac_b5 = -3 * mggac_b3

  mbrxc_Q = lambda x, t: +(32 * jnp.pi) ** (2 / 3) / 6 * (1 + mggac_b4 * task_alpha(x, t) + mggac_b5 * task_alpha(x, t) ** 2) / (mggac_b1 + mggac_b2 * task_alpha(x, t) + mggac_b3 * task_alpha(x, t) ** 2)

  mbrxc_f = lambda x, u, t: -mbrxc_v(mbrxc_x(mbrxc_Q(x, t))) / 2

  functional_body = lambda rs, z, xt, xs0, xs1, u0, u1, t0, t1: mgga_exchange(f, params, mbrxc_f, rs, z, xs0, xs1, u0, u1, t0, t1)

  t1 = r0 <= f.p.dens_threshold
  t2 = 3 ** (0.1e1 / 0.3e1)
  t3 = jnp.pi ** (0.1e1 / 0.3e1)
  t4 = 0.1e1 / t3
  t5 = t2 * t4
  t6 = r0 + r1
  t7 = 0.1e1 / t6
  t10 = 0.2e1 * r0 * t7 <= f.p.zeta_threshold
  t11 = f.p.zeta_threshold - 0.1e1
  t14 = 0.2e1 * r1 * t7 <= f.p.zeta_threshold
  t15 = -t11
  t16 = r0 - r1
  t17 = t16 * t7
  t18 = f.my_piecewise5(t10, t11, t14, t15, t17)
  t19 = 0.1e1 + t18
  t20 = t19 <= f.p.zeta_threshold
  t21 = f.p.zeta_threshold ** (0.1e1 / 0.3e1)
  t22 = t21 * f.p.zeta_threshold
  t23 = t19 ** (0.1e1 / 0.3e1)
  t25 = f.my_piecewise3(t20, t22, t23 * t19)
  t26 = t6 ** (0.1e1 / 0.3e1)
  t27 = t25 * t26
  t28 = 32 ** (0.1e1 / 0.3e1)
  t29 = t28 ** 2
  t30 = t3 ** 2
  t31 = t29 * t30
  t32 = r0 ** (0.1e1 / 0.3e1)
  t33 = t32 ** 2
  t35 = 0.1e1 / t33 / r0
  t36 = tau0 * t35
  t37 = 6 ** (0.1e1 / 0.3e1)
  t38 = jnp.pi ** 2
  t39 = t38 ** (0.1e1 / 0.3e1)
  t40 = t39 ** 2
  t41 = 0.1e1 / t40
  t42 = t37 * t41
  t43 = 0.1e1 / r0
  t44 = s0 * t43
  t45 = 0.1e1 / tau0
  t47 = t44 * t45 / 0.8e1
  t49 = 0.0e0 < 0.9999999999e0 - t47
  t51 = f.my_piecewise3(t49, 0.1e1 - t47, 0.1e-9)
  t52 = t42 * t51
  t53 = t36 * t52
  t55 = tau0 ** 2
  t56 = r0 ** 2
  t59 = 0.1e1 / t32 / t56 / r0
  t60 = t55 * t59
  t61 = t37 ** 2
  t63 = 0.1e1 / t39 / t38
  t64 = t61 * t63
  t65 = t51 ** 2
  t66 = t64 * t65
  t67 = t60 * t66
  t69 = 0.1e1 + 0.55555555555555555555555555555555555555555555555556e-1 * t53 - 0.34860833333333333333333333333333333333333333333333e1 * t67
  t72 = 0.3712e1 + 0.11111111111111111111111111111111111111111111111111e1 * t53 + 0.11620277777777777777777777777777777777777777777778e1 * t67
  t73 = 0.1e1 / t72
  t77 = mbrxc_x(t31 * t69 * t73 / 0.6e1)
  t78 = DBL_EPSILON ** (0.1e1 / 0.4e1)
  t79 = t77 < t78
  t80 = t28 * t3
  t81 = t2 ** 2
  t83 = (0.1e1 / jnp.pi) ** (0.1e1 / 0.3e1)
  t84 = 0.1e1 / t83
  t85 = t81 * t84
  t86 = 4 ** (0.1e1 / 0.3e1)
  t88 = t80 * t85 * t86
  t89 = t88 / 0.12e2
  t90 = t80 * t81
  t91 = t84 * t86
  t92 = t77 ** 2
  t93 = t91 * t92
  t96 = t92 * t77
  t97 = t91 * t96
  t100 = t92 ** 2
  t101 = t91 * t100
  t105 = t91 * t100 * t77
  t109 = t91 * t100 * t92
  t117 = t80 * t85
  t118 = t78 < t77
  t119 = f.my_piecewise3(t118, t77, t78)
  t121 = jnp.exp(t119 / 0.3e1)
  t122 = t86 * t121
  t123 = jnp.exp(-t119)
  t124 = t119 ** 2
  t126 = t124 + 0.5e1 * t119 + 0.8e1
  t128 = -t123 * t126 + 0.8e1
  t129 = 0.1e1 / t119
  t131 = 0.1e1 + t119
  t132 = t131 ** (0.1e1 / 0.3e1)
  t133 = 0.1e1 / t132
  t134 = t128 * t129 * t133
  t138 = f.my_piecewise3(t79, -t89 - t90 * t93 / 0.108e3 + t90 * t97 / 0.108e3 - 0.13e2 / 0.1620e4 * t90 * t101 + 0.67e2 / 0.9720e4 * t90 * t105 - 0.52e2 / 0.8505e4 * t90 * t109 + 0.1811e4 / 0.326592e6 * t90 * t91 * t100 * t96, -t117 * t122 * t134 / 0.36e2)
  t142 = f.my_piecewise3(t1, 0, 0.3e1 / 0.16e2 * t5 * t27 * t138)
  t143 = r1 <= f.p.dens_threshold
  t144 = f.my_piecewise5(t14, t11, t10, t15, -t17)
  t145 = 0.1e1 + t144
  t146 = t145 <= f.p.zeta_threshold
  t147 = t145 ** (0.1e1 / 0.3e1)
  t149 = f.my_piecewise3(t146, t22, t147 * t145)
  t150 = t149 * t26
  t151 = r1 ** (0.1e1 / 0.3e1)
  t152 = t151 ** 2
  t154 = 0.1e1 / t152 / r1
  t155 = tau1 * t154
  t156 = 0.1e1 / r1
  t157 = s2 * t156
  t158 = 0.1e1 / tau1
  t160 = t157 * t158 / 0.8e1
  t162 = 0.0e0 < 0.9999999999e0 - t160
  t164 = f.my_piecewise3(t162, 0.1e1 - t160, 0.1e-9)
  t165 = t42 * t164
  t166 = t155 * t165
  t168 = tau1 ** 2
  t169 = r1 ** 2
  t172 = 0.1e1 / t151 / t169 / r1
  t173 = t168 * t172
  t174 = t164 ** 2
  t175 = t64 * t174
  t176 = t173 * t175
  t178 = 0.1e1 + 0.55555555555555555555555555555555555555555555555556e-1 * t166 - 0.34860833333333333333333333333333333333333333333333e1 * t176
  t181 = 0.3712e1 + 0.11111111111111111111111111111111111111111111111111e1 * t166 + 0.11620277777777777777777777777777777777777777777778e1 * t176
  t182 = 0.1e1 / t181
  t186 = mbrxc_x(t31 * t178 * t182 / 0.6e1)
  t187 = t186 < t78
  t188 = t186 ** 2
  t189 = t91 * t188
  t192 = t188 * t186
  t193 = t91 * t192
  t196 = t188 ** 2
  t197 = t91 * t196
  t201 = t91 * t196 * t186
  t205 = t91 * t196 * t188
  t213 = t78 < t186
  t214 = f.my_piecewise3(t213, t186, t78)
  t216 = jnp.exp(t214 / 0.3e1)
  t217 = t86 * t216
  t218 = jnp.exp(-t214)
  t219 = t214 ** 2
  t221 = t219 + 0.5e1 * t214 + 0.8e1
  t223 = -t218 * t221 + 0.8e1
  t224 = 0.1e1 / t214
  t226 = 0.1e1 + t214
  t227 = t226 ** (0.1e1 / 0.3e1)
  t228 = 0.1e1 / t227
  t229 = t223 * t224 * t228
  t233 = f.my_piecewise3(t187, -t89 - t90 * t189 / 0.108e3 + t90 * t193 / 0.108e3 - 0.13e2 / 0.1620e4 * t90 * t197 + 0.67e2 / 0.9720e4 * t90 * t201 - 0.52e2 / 0.8505e4 * t90 * t205 + 0.1811e4 / 0.326592e6 * t90 * t91 * t196 * t192, -t117 * t217 * t229 / 0.36e2)
  t237 = f.my_piecewise3(t143, 0, 0.3e1 / 0.16e2 * t5 * t150 * t233)
  t238 = t6 ** 2
  t240 = t16 / t238
  t241 = t7 - t240
  t242 = f.my_piecewise5(t10, 0, t14, 0, t241)
  t245 = f.my_piecewise3(t20, 0, 0.4e1 / 0.3e1 * t23 * t242)
  t250 = t26 ** 2
  t251 = 0.1e1 / t250
  t255 = t5 * t25 * t251 * t138 / 0.16e2
  t257 = t29 * t4 * t81
  t259 = t257 * t91 * t77
  t263 = tau0 / t33 / t56 * t52
  t269 = f.my_piecewise3(t49, s0 / t56 * t45 / 0.8e1, 0)
  t271 = t36 * t42 * t269
  t273 = t56 ** 2
  t277 = t55 / t32 / t273 * t66
  t279 = t60 * t61
  t280 = t63 * t51
  t282 = t279 * t280 * t269
  t287 = t72 ** 2
  t289 = t69 / t287
  t299 = t69 ** 2
  t300 = 0.1e1 / t299
  t301 = (t31 * (-0.92592592592592592592592592592592592592592592592594e-1 * t263 + 0.55555555555555555555555555555555555555555555555556e-1 * t271 + 0.11620277777777777777777777777777777777777777777778e2 * t277 - 0.69721666666666666666666666666666666666666666666666e1 * t282) * t73 / 0.6e1 - t31 * t289 * (-0.18518518518518518518518518518518518518518518518518e1 * t263 + 0.11111111111111111111111111111111111111111111111111e1 * t271 - 0.38734259259259259259259259259259259259259259259260e1 * t277 + 0.23240555555555555555555555555555555555555555555556e1 * t282) / 0.6e1) * t300
  t304 = (0.1e1 + t77) ** (0.1e1 / 0.3e1)
  t305 = t304 ** 2
  t306 = 0.1e1 / t305
  t308 = jnp.exp(-0.2e1 / 0.3e1 * t77)
  t309 = 0.1e1 / t308
  t313 = 0.1e1 / (t92 - 0.3e1 * t77 + 0.6e1)
  t315 = (t77 - 0.3e1) ** 2
  t317 = t306 * t309 * t313 * t315
  t318 = t301 * t287 * t317
  t321 = t257 * t93
  t324 = t257 * t97
  t327 = t257 * t101
  t330 = t257 * t105
  t333 = t257 * t109
  t338 = t28 / t30
  t343 = t287 * t306 * t309 * t313 * t315
  t346 = f.my_piecewise3(t118, 0.9e1 / 0.32e2 * t338 * t301 * t343, 0)
  t364 = t121 * t128
  t366 = 0.1e1 / t124 * t133
  t373 = t129 / t132 / t131
  t379 = f.my_piecewise3(t79, -t259 * t318 / 0.192e3 + t321 * t318 / 0.128e3 - 0.13e2 / 0.1440e4 * t324 * t318 + 0.67e2 / 0.6912e4 * t327 * t318 - 0.13e2 / 0.1260e4 * t330 * t318 + 0.1811e4 / 0.165888e6 * t333 * t318, -t88 * t346 * t121 * t134 / 0.108e3 - t117 * t122 * (t346 * t123 * t126 - t123 * (0.2e1 * t119 * t346 + 0.5e1 * t346)) * t129 * t133 / 0.36e2 + t88 * t364 * t366 * t346 / 0.36e2 + t88 * t364 * t373 * t346 / 0.108e3)
  t384 = f.my_piecewise3(t1, 0, 0.3e1 / 0.16e2 * t5 * t245 * t26 * t138 + t255 + 0.3e1 / 0.16e2 * t5 * t27 * t379)
  t386 = f.my_piecewise5(t14, 0, t10, 0, -t241)
  t389 = f.my_piecewise3(t146, 0, 0.4e1 / 0.3e1 * t147 * t386)
  t397 = t5 * t149 * t251 * t233 / 0.16e2
  t399 = f.my_piecewise3(t143, 0, 0.3e1 / 0.16e2 * t5 * t389 * t26 * t233 + t397)
  vrho_0_ = t142 + t237 + t6 * (t384 + t399)
  t402 = -t7 - t240
  t403 = f.my_piecewise5(t10, 0, t14, 0, t402)
  t406 = f.my_piecewise3(t20, 0, 0.4e1 / 0.3e1 * t23 * t403)
  t412 = f.my_piecewise3(t1, 0, 0.3e1 / 0.16e2 * t5 * t406 * t26 * t138 + t255)
  t414 = f.my_piecewise5(t14, 0, t10, 0, -t402)
  t417 = f.my_piecewise3(t146, 0, 0.4e1 / 0.3e1 * t147 * t414)
  t423 = t257 * t91 * t186
  t427 = tau1 / t152 / t169 * t165
  t433 = f.my_piecewise3(t162, s2 / t169 * t158 / 0.8e1, 0)
  t435 = t155 * t42 * t433
  t437 = t169 ** 2
  t441 = t168 / t151 / t437 * t175
  t443 = t173 * t61
  t444 = t63 * t164
  t446 = t443 * t444 * t433
  t451 = t181 ** 2
  t453 = t178 / t451
  t463 = t178 ** 2
  t464 = 0.1e1 / t463
  t465 = (t31 * (-0.92592592592592592592592592592592592592592592592594e-1 * t427 + 0.55555555555555555555555555555555555555555555555556e-1 * t435 + 0.11620277777777777777777777777777777777777777777778e2 * t441 - 0.69721666666666666666666666666666666666666666666666e1 * t446) * t182 / 0.6e1 - t31 * t453 * (-0.18518518518518518518518518518518518518518518518518e1 * t427 + 0.11111111111111111111111111111111111111111111111111e1 * t435 - 0.38734259259259259259259259259259259259259259259260e1 * t441 + 0.23240555555555555555555555555555555555555555555556e1 * t446) / 0.6e1) * t464
  t468 = (0.1e1 + t186) ** (0.1e1 / 0.3e1)
  t469 = t468 ** 2
  t470 = 0.1e1 / t469
  t472 = jnp.exp(-0.2e1 / 0.3e1 * t186)
  t473 = 0.1e1 / t472
  t477 = 0.1e1 / (t188 - 0.3e1 * t186 + 0.6e1)
  t479 = (t186 - 0.3e1) ** 2
  t481 = t470 * t473 * t477 * t479
  t482 = t465 * t451 * t481
  t485 = t257 * t189
  t488 = t257 * t193
  t491 = t257 * t197
  t494 = t257 * t201
  t497 = t257 * t205
  t505 = t451 * t470 * t473 * t477 * t479
  t508 = f.my_piecewise3(t213, 0.9e1 / 0.32e2 * t338 * t465 * t505, 0)
  t526 = t216 * t223
  t528 = 0.1e1 / t219 * t228
  t535 = t224 / t227 / t226
  t541 = f.my_piecewise3(t187, -t423 * t482 / 0.192e3 + t485 * t482 / 0.128e3 - 0.13e2 / 0.1440e4 * t488 * t482 + 0.67e2 / 0.6912e4 * t491 * t482 - 0.13e2 / 0.1260e4 * t494 * t482 + 0.1811e4 / 0.165888e6 * t497 * t482, -t88 * t508 * t216 * t229 / 0.108e3 - t117 * t217 * (t508 * t218 * t221 - t218 * (0.2e1 * t214 * t508 + 0.5e1 * t508)) * t224 * t228 / 0.36e2 + t88 * t526 * t528 * t508 / 0.36e2 + t88 * t526 * t535 * t508 / 0.108e3)
  t546 = f.my_piecewise3(t143, 0, 0.3e1 / 0.16e2 * t5 * t417 * t26 * t233 + t397 + 0.3e1 / 0.16e2 * t5 * t150 * t541)
  vrho_1_ = t142 + t237 + t6 * (t412 + t546)
  t551 = f.my_piecewise3(t49, -t43 * t45 / 0.8e1, 0)
  t553 = t36 * t42 * t551
  t556 = t279 * t280 * t551
  t568 = (t31 * (0.55555555555555555555555555555555555555555555555556e-1 * t553 - 0.69721666666666666666666666666666666666666666666666e1 * t556) * t73 / 0.6e1 - t31 * t289 * (0.11111111111111111111111111111111111111111111111111e1 * t553 + 0.23240555555555555555555555555555555555555555555556e1 * t556) / 0.6e1) * t300
  t570 = t568 * t287 * t317
  t587 = f.my_piecewise3(t118, 0.9e1 / 0.32e2 * t338 * t568 * t343, 0)
  t614 = f.my_piecewise3(t79, -t259 * t570 / 0.192e3 + t321 * t570 / 0.128e3 - 0.13e2 / 0.1440e4 * t324 * t570 + 0.67e2 / 0.6912e4 * t327 * t570 - 0.13e2 / 0.1260e4 * t330 * t570 + 0.1811e4 / 0.165888e6 * t333 * t570, -t88 * t587 * t121 * t134 / 0.108e3 - t117 * t122 * (t587 * t123 * t126 - t123 * (0.2e1 * t119 * t587 + 0.5e1 * t587)) * t129 * t133 / 0.36e2 + t88 * t364 * t366 * t587 / 0.36e2 + t88 * t364 * t373 * t587 / 0.108e3)
  t618 = f.my_piecewise3(t1, 0, 0.3e1 / 0.16e2 * t5 * t27 * t614)
  vsigma_0_ = t6 * t618
  vsigma_1_ = 0.0e0
  t621 = f.my_piecewise3(t162, -t156 * t158 / 0.8e1, 0)
  t623 = t155 * t42 * t621
  t626 = t443 * t444 * t621
  t638 = (t31 * (0.55555555555555555555555555555555555555555555555556e-1 * t623 - 0.69721666666666666666666666666666666666666666666666e1 * t626) * t182 / 0.6e1 - t31 * t453 * (0.11111111111111111111111111111111111111111111111111e1 * t623 + 0.23240555555555555555555555555555555555555555555556e1 * t626) / 0.6e1) * t464
  t640 = t638 * t451 * t481
  t657 = f.my_piecewise3(t213, 0.9e1 / 0.32e2 * t338 * t638 * t505, 0)
  t684 = f.my_piecewise3(t187, -t423 * t640 / 0.192e3 + t485 * t640 / 0.128e3 - 0.13e2 / 0.1440e4 * t488 * t640 + 0.67e2 / 0.6912e4 * t491 * t640 - 0.13e2 / 0.1260e4 * t494 * t640 + 0.1811e4 / 0.165888e6 * t497 * t640, -t88 * t657 * t216 * t229 / 0.108e3 - t117 * t217 * (t657 * t218 * t221 - t218 * (0.2e1 * t214 * t657 + 0.5e1 * t657)) * t224 * t228 / 0.36e2 + t88 * t526 * t528 * t657 / 0.36e2 + t88 * t526 * t535 * t657 / 0.108e3)
  t688 = f.my_piecewise3(t143, 0, 0.3e1 / 0.16e2 * t5 * t150 * t684)
  vsigma_2_ = t6 * t688
  vlapl_0_ = 0.0e0
  vlapl_1_ = 0.0e0
  t691 = t35 * t37 * t41 * t51
  t696 = f.my_piecewise3(t49, t44 / t55 / 0.8e1, 0)
  t698 = t36 * t42 * t696
  t701 = tau0 * t59 * t66
  t704 = t279 * t280 * t696
  t718 = (t31 * (0.55555555555555555555555555555555555555555555555556e-1 * t691 + 0.55555555555555555555555555555555555555555555555556e-1 * t698 - 0.69721666666666666666666666666666666666666666666666e1 * t701 - 0.69721666666666666666666666666666666666666666666666e1 * t704) * t73 / 0.6e1 - t31 * t289 * (0.11111111111111111111111111111111111111111111111111e1 * t691 + 0.11111111111111111111111111111111111111111111111111e1 * t698 + 0.23240555555555555555555555555555555555555555555556e1 * t701 + 0.23240555555555555555555555555555555555555555555556e1 * t704) / 0.6e1) * t300
  t720 = t718 * t287 * t317
  t737 = f.my_piecewise3(t118, 0.9e1 / 0.32e2 * t338 * t718 * t343, 0)
  t764 = f.my_piecewise3(t79, -t259 * t720 / 0.192e3 + t321 * t720 / 0.128e3 - 0.13e2 / 0.1440e4 * t324 * t720 + 0.67e2 / 0.6912e4 * t327 * t720 - 0.13e2 / 0.1260e4 * t330 * t720 + 0.1811e4 / 0.165888e6 * t333 * t720, -t88 * t737 * t121 * t134 / 0.108e3 - t117 * t122 * (t737 * t123 * t126 - t123 * (0.2e1 * t119 * t737 + 0.5e1 * t737)) * t129 * t133 / 0.36e2 + t88 * t364 * t366 * t737 / 0.36e2 + t88 * t364 * t373 * t737 / 0.108e3)
  t768 = f.my_piecewise3(t1, 0, 0.3e1 / 0.16e2 * t5 * t27 * t764)
  vtau_0_ = t6 * t768
  t771 = t154 * t37 * t41 * t164
  t776 = f.my_piecewise3(t162, t157 / t168 / 0.8e1, 0)
  t778 = t155 * t42 * t776
  t781 = tau1 * t172 * t175
  t784 = t443 * t444 * t776
  t798 = (t31 * (0.55555555555555555555555555555555555555555555555556e-1 * t771 + 0.55555555555555555555555555555555555555555555555556e-1 * t778 - 0.69721666666666666666666666666666666666666666666666e1 * t781 - 0.69721666666666666666666666666666666666666666666666e1 * t784) * t182 / 0.6e1 - t31 * t453 * (0.11111111111111111111111111111111111111111111111111e1 * t771 + 0.11111111111111111111111111111111111111111111111111e1 * t778 + 0.23240555555555555555555555555555555555555555555556e1 * t781 + 0.23240555555555555555555555555555555555555555555556e1 * t784) / 0.6e1) * t464
  t800 = t798 * t451 * t481
  t817 = f.my_piecewise3(t213, 0.9e1 / 0.32e2 * t338 * t798 * t505, 0)
  t844 = f.my_piecewise3(t187, -t423 * t800 / 0.192e3 + t485 * t800 / 0.128e3 - 0.13e2 / 0.1440e4 * t488 * t800 + 0.67e2 / 0.6912e4 * t491 * t800 - 0.13e2 / 0.1260e4 * t494 * t800 + 0.1811e4 / 0.165888e6 * t497 * t800, -t88 * t817 * t216 * t229 / 0.108e3 - t117 * t217 * (t817 * t218 * t221 - t218 * (0.2e1 * t214 * t817 + 0.5e1 * t817)) * t224 * t228 / 0.36e2 + t88 * t526 * t528 * t817 / 0.36e2 + t88 * t526 * t535 * t817 / 0.108e3)
  t848 = f.my_piecewise3(t143, 0, 0.3e1 / 0.16e2 * t5 * t150 * t844)
  vtau_1_ = t6 * t848
  _b = lambda x: (jnp.asarray(x) + jnp.zeros_like(r0))
  vrho_0_ = _b(vrho_0_)
  vrho_1_ = _b(vrho_1_)
  vsigma_0_ = _b(vsigma_0_)
  vsigma_1_ = _b(vsigma_1_)
  vsigma_2_ = _b(vsigma_2_)
  vlapl_0_ = _b(vlapl_0_)
  vlapl_1_ = _b(vlapl_1_)
  vtau_0_ = _b(vtau_0_)
  vtau_1_ = _b(vtau_1_)
  res = {'vrho': jnp.stack([vrho_0_, vrho_1_], axis=-1), 'vsigma': jnp.stack([vsigma_0_, vsigma_1_, vsigma_2_], axis=-1), 'vlapl': jnp.stack([vlapl_0_, vlapl_1_], axis=-1), 'vtau':  jnp.stack([vtau_0_, vtau_1_], axis=-1)}
  return res

def unpol_vxc(p, r, s=None, l=None, tau=None):
  f = funcs(p)
  params = f.params
  r0, s0, l0, tau0 = r, s, l, tau
  mbrxc_v0 = lambda x: -(32 * jnp.pi) ** (1 / 3) / (8 * X_FACTOR_C) * jnp.exp(x / 3) * (8 - jnp.exp(-x) * (x ** 2 + 5 * x + 8)) / (x * (1 + x) ** (1 / 3))

  mbrxc_v_smallq = lambda x: -1 / 12 * 32 ** (1 / 3) * jnp.pi ** (1 / 3) * 3 ** (2 / 3) / (1 / jnp.pi) ** (1 / 3) * 4 ** (1 / 3) - 1 / 108 * 32 ** (1 / 3) * jnp.pi ** (1 / 3) * 3 ** (2 / 3) / (1 / jnp.pi) ** (1 / 3) * 4 ** (1 / 3) * x ** 2 + 1 / 108 * 32 ** (1 / 3) * jnp.pi ** (1 / 3) * 3 ** (2 / 3) / (1 / jnp.pi) ** (1 / 3) * 4 ** (1 / 3) * x ** 3 - 13 / 1620 * 32 ** (1 / 3) * jnp.pi ** (1 / 3) * 3 ** (2 / 3) / (1 / jnp.pi) ** (1 / 3) * 4 ** (1 / 3) * x ** 4 + 67 / 9720 * 32 ** (1 / 3) * jnp.pi ** (1 / 3) * 3 ** (2 / 3) / (1 / jnp.pi) ** (1 / 3) * 4 ** (1 / 3) * x ** 5 - 52 / 8505 * 32 ** (1 / 3) * jnp.pi ** (1 / 3) * 3 ** (2 / 3) / (1 / jnp.pi) ** (1 / 3) * 4 ** (1 / 3) * x ** 6 + 1811 / 326592 * 32 ** (1 / 3) * jnp.pi ** (1 / 3) * 3 ** (2 / 3) / (1 / jnp.pi) ** (1 / 3) * 4 ** (1 / 3) * x ** 7

  mbrxc_v_cutoff = DBL_EPSILON ** (1 / 4)

  task_alpha = lambda x, t: t / K_FACTOR_C * jnp.maximum(1 - x ** 2 / (8 * t), 1e-10)

  mggac_b1 = 3.712

  mggac_b2 = 2.0

  mggac_b4 = 0.1

  mbrxc_v = lambda x: f.my_piecewise3(x < mbrxc_v_cutoff, mbrxc_v_smallq(x), mbrxc_v0(jnp.maximum(x, mbrxc_v_cutoff)))

  mggac_b3 = 2.595 + 0.5197 * mggac_b4 + 0.559 * mggac_b2

  mggac_b5 = -3 * mggac_b3

  mbrxc_Q = lambda x, t: +(32 * jnp.pi) ** (2 / 3) / 6 * (1 + mggac_b4 * task_alpha(x, t) + mggac_b5 * task_alpha(x, t) ** 2) / (mggac_b1 + mggac_b2 * task_alpha(x, t) + mggac_b3 * task_alpha(x, t) ** 2)

  mbrxc_f = lambda x, u, t: -mbrxc_v(mbrxc_x(mbrxc_Q(x, t))) / 2

  functional_body = lambda rs, z, xt, xs0, xs1, u0, u1, t0, t1: mgga_exchange(f, params, mbrxc_f, rs, z, xs0, xs1, u0, u1, t0, t1)

  t2 = r0 / 0.2e1 <= f.p.dens_threshold
  t3 = 3 ** (0.1e1 / 0.3e1)
  t4 = jnp.pi ** (0.1e1 / 0.3e1)
  t5 = 0.1e1 / t4
  t6 = t3 * t5
  t7 = 0.1e1 <= f.p.zeta_threshold
  t8 = f.p.zeta_threshold - 0.1e1
  t10 = f.my_piecewise5(t7, t8, t7, -t8, 0)
  t11 = 0.1e1 + t10
  t13 = f.p.zeta_threshold ** (0.1e1 / 0.3e1)
  t15 = t11 ** (0.1e1 / 0.3e1)
  t17 = f.my_piecewise3(t11 <= f.p.zeta_threshold, t13 * f.p.zeta_threshold, t15 * t11)
  t18 = r0 ** (0.1e1 / 0.3e1)
  t19 = t17 * t18
  t20 = 32 ** (0.1e1 / 0.3e1)
  t21 = t20 ** 2
  t22 = t4 ** 2
  t23 = t21 * t22
  t24 = 2 ** (0.1e1 / 0.3e1)
  t25 = t24 ** 2
  t26 = tau0 * t25
  t27 = t18 ** 2
  t29 = 0.1e1 / t27 / r0
  t30 = t26 * t29
  t31 = 6 ** (0.1e1 / 0.3e1)
  t32 = jnp.pi ** 2
  t33 = t32 ** (0.1e1 / 0.3e1)
  t34 = t33 ** 2
  t36 = t31 / t34
  t37 = 0.1e1 / r0
  t38 = s0 * t37
  t39 = 0.1e1 / tau0
  t41 = t38 * t39 / 0.8e1
  t43 = 0.0e0 < 0.9999999999e0 - t41
  t45 = f.my_piecewise3(t43, 0.1e1 - t41, 0.1e-9)
  t46 = t36 * t45
  t47 = t30 * t46
  t49 = tau0 ** 2
  t50 = t49 * t24
  t51 = r0 ** 2
  t54 = 0.1e1 / t18 / t51 / r0
  t55 = t50 * t54
  t56 = t31 ** 2
  t59 = t56 / t33 / t32
  t60 = t45 ** 2
  t61 = t59 * t60
  t62 = t55 * t61
  t64 = 0.1e1 + 0.55555555555555555555555555555555555555555555555556e-1 * t47 - 0.69721666666666666666666666666666666666666666666667e1 * t62
  t67 = 0.3712e1 + 0.11111111111111111111111111111111111111111111111111e1 * t47 + 0.23240555555555555555555555555555555555555555555556e1 * t62
  t68 = 0.1e1 / t67
  t72 = mbrxc_x(t23 * t64 * t68 / 0.6e1)
  t73 = DBL_EPSILON ** (0.1e1 / 0.4e1)
  t74 = t72 < t73
  t75 = t20 * t4
  t76 = t3 ** 2
  t78 = (0.1e1 / jnp.pi) ** (0.1e1 / 0.3e1)
  t79 = 0.1e1 / t78
  t80 = t76 * t79
  t81 = 4 ** (0.1e1 / 0.3e1)
  t83 = t75 * t80 * t81
  t85 = t75 * t76
  t86 = t79 * t81
  t87 = t72 ** 2
  t88 = t86 * t87
  t91 = t87 * t72
  t92 = t86 * t91
  t95 = t87 ** 2
  t96 = t86 * t95
  t100 = t86 * t95 * t72
  t104 = t86 * t95 * t87
  t112 = t75 * t80
  t113 = t73 < t72
  t114 = f.my_piecewise3(t113, t72, t73)
  t116 = jnp.exp(t114 / 0.3e1)
  t117 = t81 * t116
  t118 = jnp.exp(-t114)
  t119 = t114 ** 2
  t121 = t119 + 0.5e1 * t114 + 0.8e1
  t123 = -t118 * t121 + 0.8e1
  t124 = 0.1e1 / t114
  t126 = 0.1e1 + t114
  t127 = t126 ** (0.1e1 / 0.3e1)
  t128 = 0.1e1 / t127
  t129 = t123 * t124 * t128
  t133 = f.my_piecewise3(t74, -t83 / 0.12e2 - t85 * t88 / 0.108e3 + t85 * t92 / 0.108e3 - 0.13e2 / 0.1620e4 * t85 * t96 + 0.67e2 / 0.9720e4 * t85 * t100 - 0.52e2 / 0.8505e4 * t85 * t104 + 0.1811e4 / 0.326592e6 * t85 * t86 * t95 * t91, -t112 * t117 * t129 / 0.36e2)
  t137 = f.my_piecewise3(t2, 0, 0.3e1 / 0.16e2 * t6 * t19 * t133)
  t144 = t21 * t5 * t76
  t146 = t144 * t86 * t72
  t150 = t26 / t27 / t51 * t46
  t156 = f.my_piecewise3(t43, s0 / t51 * t39 / 0.8e1, 0)
  t158 = t30 * t36 * t156
  t160 = t51 ** 2
  t164 = t50 / t18 / t160 * t61
  t168 = t55 * t59 * t45 * t156
  t173 = t67 ** 2
  t175 = t64 / t173
  t185 = t64 ** 2
  t186 = 0.1e1 / t185
  t187 = (t23 * (-0.92592592592592592592592592592592592592592592592594e-1 * t150 + 0.55555555555555555555555555555555555555555555555556e-1 * t158 + 0.23240555555555555555555555555555555555555555555556e2 * t164 - 0.13944333333333333333333333333333333333333333333333e2 * t168) * t68 / 0.6e1 - t23 * t175 * (-0.18518518518518518518518518518518518518518518518518e1 * t150 + 0.11111111111111111111111111111111111111111111111111e1 * t158 - 0.77468518518518518518518518518518518518518518518520e1 * t164 + 0.46481111111111111111111111111111111111111111111112e1 * t168) / 0.6e1) * t186
  t190 = (0.1e1 + t72) ** (0.1e1 / 0.3e1)
  t191 = t190 ** 2
  t192 = 0.1e1 / t191
  t194 = jnp.exp(-0.2e1 / 0.3e1 * t72)
  t195 = 0.1e1 / t194
  t199 = 0.1e1 / (t87 - 0.3e1 * t72 + 0.6e1)
  t201 = (t72 - 0.3e1) ** 2
  t203 = t192 * t195 * t199 * t201
  t204 = t187 * t173 * t203
  t207 = t144 * t88
  t210 = t144 * t92
  t213 = t144 * t96
  t216 = t144 * t100
  t219 = t144 * t104
  t224 = t20 / t22
  t229 = t173 * t192 * t195 * t199 * t201
  t232 = f.my_piecewise3(t113, 0.9e1 / 0.32e2 * t224 * t187 * t229, 0)
  t250 = t116 * t123
  t252 = 0.1e1 / t119 * t128
  t259 = t124 / t127 / t126
  t265 = f.my_piecewise3(t74, -t146 * t204 / 0.192e3 + t207 * t204 / 0.128e3 - 0.13e2 / 0.1440e4 * t210 * t204 + 0.67e2 / 0.6912e4 * t213 * t204 - 0.13e2 / 0.1260e4 * t216 * t204 + 0.1811e4 / 0.165888e6 * t219 * t204, -t83 * t232 * t116 * t129 / 0.108e3 - t112 * t117 * (t232 * t118 * t121 - t118 * (0.2e1 * t114 * t232 + 0.5e1 * t232)) * t124 * t128 / 0.36e2 + t83 * t250 * t252 * t232 / 0.36e2 + t83 * t250 * t259 * t232 / 0.108e3)
  t270 = f.my_piecewise3(t2, 0, t6 * t17 / t27 * t133 / 0.16e2 + 0.3e1 / 0.16e2 * t6 * t19 * t265)
  vrho_0_ = 0.2e1 * r0 * t270 + 0.2e1 * t137
  t275 = f.my_piecewise3(t43, -t37 * t39 / 0.8e1, 0)
  t277 = t30 * t36 * t275
  t281 = t55 * t59 * t45 * t275
  t293 = (t23 * (0.55555555555555555555555555555555555555555555555556e-1 * t277 - 0.13944333333333333333333333333333333333333333333333e2 * t281) * t68 / 0.6e1 - t23 * t175 * (0.11111111111111111111111111111111111111111111111111e1 * t277 + 0.46481111111111111111111111111111111111111111111112e1 * t281) / 0.6e1) * t186
  t295 = t293 * t173 * t203
  t312 = f.my_piecewise3(t113, 0.9e1 / 0.32e2 * t224 * t293 * t229, 0)
  t339 = f.my_piecewise3(t74, -t146 * t295 / 0.192e3 + t207 * t295 / 0.128e3 - 0.13e2 / 0.1440e4 * t210 * t295 + 0.67e2 / 0.6912e4 * t213 * t295 - 0.13e2 / 0.1260e4 * t216 * t295 + 0.1811e4 / 0.165888e6 * t219 * t295, -t83 * t312 * t116 * t129 / 0.108e3 - t112 * t117 * (t312 * t118 * t121 - t118 * (0.2e1 * t114 * t312 + 0.5e1 * t312)) * t124 * t128 / 0.36e2 + t83 * t250 * t252 * t312 / 0.36e2 + t83 * t250 * t259 * t312 / 0.108e3)
  t343 = f.my_piecewise3(t2, 0, 0.3e1 / 0.16e2 * t6 * t19 * t339)
  vsigma_0_ = 0.2e1 * r0 * t343
  vlapl_0_ = 0.0e0
  t346 = t25 * t29 * t46
  t351 = f.my_piecewise3(t43, t38 / t49 / 0.8e1, 0)
  t353 = t30 * t36 * t351
  t357 = tau0 * t24 * t54 * t61
  t361 = t55 * t59 * t45 * t351
  t375 = (t23 * (0.55555555555555555555555555555555555555555555555556e-1 * t346 + 0.55555555555555555555555555555555555555555555555556e-1 * t353 - 0.13944333333333333333333333333333333333333333333333e2 * t357 - 0.13944333333333333333333333333333333333333333333333e2 * t361) * t68 / 0.6e1 - t23 * t175 * (0.11111111111111111111111111111111111111111111111111e1 * t346 + 0.11111111111111111111111111111111111111111111111111e1 * t353 + 0.46481111111111111111111111111111111111111111111112e1 * t357 + 0.46481111111111111111111111111111111111111111111112e1 * t361) / 0.6e1) * t186
  t377 = t375 * t173 * t203
  t394 = f.my_piecewise3(t113, 0.9e1 / 0.32e2 * t224 * t375 * t229, 0)
  t421 = f.my_piecewise3(t74, -t146 * t377 / 0.192e3 + t207 * t377 / 0.128e3 - 0.13e2 / 0.1440e4 * t210 * t377 + 0.67e2 / 0.6912e4 * t213 * t377 - 0.13e2 / 0.1260e4 * t216 * t377 + 0.1811e4 / 0.165888e6 * t219 * t377, -t83 * t394 * t116 * t129 / 0.108e3 - t112 * t117 * (t394 * t118 * t121 - t118 * (0.2e1 * t114 * t394 + 0.5e1 * t394)) * t124 * t128 / 0.36e2 + t83 * t250 * t252 * t394 / 0.36e2 + t83 * t250 * t259 * t394 / 0.108e3)
  t425 = f.my_piecewise3(t2, 0, 0.3e1 / 0.16e2 * t6 * t19 * t421)
  vtau_0_ = 0.2e1 * r0 * t425
  _b = lambda x: (jnp.asarray(x) + jnp.zeros_like(r0))
  vrho_0_ = _b(vrho_0_)
  vsigma_0_ = _b(vsigma_0_)
  vlapl_0_ = _b(vlapl_0_)
  vtau_0_ = _b(vtau_0_)
  res = {'vrho': vrho_0_, 'vsigma': vsigma_0_, 'vlapl': vlapl_0_, 'vtau':  vtau_0_}
  return res

def unpol_fxc(p, r, s=None, l=None, tau=None):
  f = funcs(p)
  params = f.params
  r0, s0, l0, tau0 = r, s, l, tau
  
  t2 = r0 / 0.2e1 <= f.p.dens_threshold
  t3 = 3 ** (0.1e1 / 0.3e1)
  t4 = jnp.pi ** (0.1e1 / 0.3e1)
  t5 = 0.1e1 / t4
  t6 = t3 * t5
  t7 = 0.1e1 <= f.p.zeta_threshold
  t8 = f.p.zeta_threshold - 0.1e1
  t10 = f.my_piecewise5(t7, t8, t7, -t8, 0)
  t11 = 0.1e1 + t10
  t13 = f.p.zeta_threshold ** (0.1e1 / 0.3e1)
  t15 = t11 ** (0.1e1 / 0.3e1)
  t17 = f.my_piecewise3(t11 <= f.p.zeta_threshold, t13 * f.p.zeta_threshold, t15 * t11)
  t18 = r0 ** (0.1e1 / 0.3e1)
  t19 = t18 ** 2
  t21 = t17 / t19
  t22 = 32 ** (0.1e1 / 0.3e1)
  t23 = t22 ** 2
  t24 = t4 ** 2
  t25 = t23 * t24
  t26 = 2 ** (0.1e1 / 0.3e1)
  t27 = t26 ** 2
  t28 = tau0 * t27
  t30 = 0.1e1 / t19 / r0
  t31 = t28 * t30
  t32 = 6 ** (0.1e1 / 0.3e1)
  t33 = jnp.pi ** 2
  t34 = t33 ** (0.1e1 / 0.3e1)
  t35 = t34 ** 2
  t37 = t32 / t35
  t40 = 0.1e1 / tau0
  t42 = s0 / r0 * t40 / 0.8e1
  t44 = 0.0e0 < 0.9999999999e0 - t42
  t46 = f.my_piecewise3(t44, 0.1e1 - t42, 0.1e-9)
  t47 = t37 * t46
  t48 = t31 * t47
  t50 = tau0 ** 2
  t51 = t50 * t26
  t52 = r0 ** 2
  t53 = t52 * r0
  t56 = t51 / t18 / t53
  t57 = t32 ** 2
  t60 = t57 / t34 / t33
  t61 = t46 ** 2
  t62 = t60 * t61
  t63 = t56 * t62
  t65 = 0.1e1 + 0.55555555555555555555555555555555555555555555555556e-1 * t48 - 0.69721666666666666666666666666666666666666666666666e1 * t63
  t68 = 0.3712e1 + 0.11111111111111111111111111111111111111111111111111e1 * t48 + 0.23240555555555555555555555555555555555555555555556e1 * t63
  t69 = 0.1e1 / t68
  t73 = mbrxc_x(t25 * t65 * t69 / 0.6e1)
  t74 = DBL_EPSILON ** (0.1e1 / 0.4e1)
  t75 = t73 < t74
  t76 = t22 * t4
  t77 = t3 ** 2
  t78 = 0.1e1 / jnp.pi
  t79 = t78 ** (0.1e1 / 0.3e1)
  t80 = 0.1e1 / t79
  t81 = t77 * t80
  t82 = 4 ** (0.1e1 / 0.3e1)
  t84 = t76 * t81 * t82
  t86 = t76 * t77
  t87 = t80 * t82
  t88 = t73 ** 2
  t89 = t87 * t88
  t92 = t88 * t73
  t93 = t87 * t92
  t96 = t88 ** 2
  t97 = t87 * t96
  t100 = t96 * t73
  t101 = t87 * t100
  t104 = t96 * t88
  t105 = t87 * t104
  t113 = t76 * t81
  t114 = t74 < t73
  t115 = f.my_piecewise3(t114, t73, t74)
  t117 = jnp.exp(t115 / 0.3e1)
  t118 = t82 * t117
  t119 = jnp.exp(-t115)
  t120 = t115 ** 2
  t122 = t120 + 0.5e1 * t115 + 0.8e1
  t124 = -t119 * t122 + 0.8e1
  t125 = 0.1e1 / t115
  t126 = t124 * t125
  t127 = 0.1e1 + t115
  t128 = t127 ** (0.1e1 / 0.3e1)
  t129 = 0.1e1 / t128
  t130 = t126 * t129
  t134 = f.my_piecewise3(t75, -t84 / 0.12e2 - t86 * t89 / 0.108e3 + t86 * t93 / 0.108e3 - 0.13e2 / 0.1620e4 * t86 * t97 + 0.67e2 / 0.9720e4 * t86 * t101 - 0.52e2 / 0.8505e4 * t86 * t105 + 0.1811e4 / 0.326592e6 * t86 * t87 * t96 * t92, -t113 * t118 * t130 / 0.36e2)
  t138 = t17 * t18
  t140 = t23 * t5 * t77
  t142 = t140 * t87 * t73
  t145 = t28 / t19 / t52
  t146 = t145 * t47
  t152 = f.my_piecewise3(t44, s0 / t52 * t40 / 0.8e1, 0)
  t153 = t37 * t152
  t154 = t31 * t153
  t156 = t52 ** 2
  t159 = t51 / t18 / t156
  t160 = t159 * t62
  t163 = t60 * t46 * t152
  t164 = t56 * t163
  t166 = -0.92592592592592592592592592592592592592592592592594e-1 * t146 + 0.55555555555555555555555555555555555555555555555556e-1 * t154 + 0.23240555555555555555555555555555555555555555555555e2 * t160 - 0.13944333333333333333333333333333333333333333333333e2 * t164
  t169 = t68 ** 2
  t170 = 0.1e1 / t169
  t171 = t65 * t170
  t176 = -0.18518518518518518518518518518518518518518518518518e1 * t146 + 0.11111111111111111111111111111111111111111111111111e1 * t154 - 0.77468518518518518518518518518518518518518518518520e1 * t160 + 0.46481111111111111111111111111111111111111111111112e1 * t164
  t180 = t25 * t166 * t69 / 0.6e1 - t25 * t171 * t176 / 0.6e1
  t181 = t65 ** 2
  t182 = 0.1e1 / t181
  t183 = t180 * t182
  t184 = t183 * t169
  t185 = 0.1e1 + t73
  t186 = t185 ** (0.1e1 / 0.3e1)
  t187 = t186 ** 2
  t188 = 0.1e1 / t187
  t190 = jnp.exp(-0.2e1 / 0.3e1 * t73)
  t191 = 0.1e1 / t190
  t192 = t188 * t191
  t194 = 0.6e1 + t88 - 0.3e1 * t73
  t195 = 0.1e1 / t194
  t196 = -0.3e1 + t73
  t197 = t196 ** 2
  t198 = t195 * t197
  t199 = t192 * t198
  t200 = t184 * t199
  t203 = t140 * t89
  t206 = t140 * t93
  t209 = t140 * t97
  t212 = t140 * t101
  t215 = t140 * t105
  t219 = 0.1e1 / t24
  t220 = t22 * t219
  t223 = t191 * t195
  t225 = t169 * t188 * t223 * t197
  t226 = t220 * t183 * t225
  t228 = f.my_piecewise3(t114, 0.9e1 / 0.32e2 * t226, 0)
  t229 = t228 * t117
  t233 = t228 * t119
  t238 = 0.2e1 * t115 * t228 + 0.5e1 * t228
  t240 = -t119 * t238 + t233 * t122
  t242 = t240 * t125 * t129
  t246 = t117 * t124
  t247 = 0.1e1 / t120
  t248 = t247 * t129
  t249 = t248 * t228
  t254 = 0.1e1 / t128 / t127
  t255 = t125 * t254
  t256 = t255 * t228
  t261 = f.my_piecewise3(t75, -t142 * t200 / 0.192e3 + t203 * t200 / 0.128e3 - 0.13e2 / 0.1440e4 * t206 * t200 + 0.67e2 / 0.6912e4 * t209 * t200 - 0.13e2 / 0.1260e4 * t212 * t200 + 0.1811e4 / 0.165888e6 * t215 * t200, -t84 * t229 * t130 / 0.108e3 - t113 * t118 * t242 / 0.36e2 + t84 * t246 * t249 / 0.36e2 + t84 * t246 * t256 / 0.108e3)
  t266 = f.my_piecewise3(t2, 0, t6 * t21 * t134 / 0.16e2 + 0.3e1 / 0.16e2 * t6 * t138 * t261)
  t275 = t78 * t77
  t276 = t275 * t80
  t278 = t180 ** 2
  t280 = t276 * t82 * t100 * t278
  t281 = t181 ** 2
  t282 = 0.1e1 / t281
  t283 = t169 ** 2
  t284 = t282 * t283
  t285 = t185 ** 2
  t287 = 0.1e1 / t186 / t285
  t289 = t190 ** 2
  t291 = t194 ** 2
  t292 = 0.1e1 / t291
  t293 = 0.1e1 / t289 * t292
  t294 = t197 ** 2
  t295 = t293 * t294
  t296 = t284 * t287 * t295
  t300 = 0.1e1 / t186 / t185
  t301 = t284 * t300
  t302 = t301 * t295
  t306 = t293 * t197 * t196
  t307 = t301 * t306
  t312 = t276 * t82 * t88 * t278
  t321 = t276 * t82 * t92 * t278
  t330 = t276 * t82 * t73 * t278
  t340 = t276 * t82 * t104 * t278
  t349 = t276 * t82 * t96 * t278
  t358 = t140 * t87 * t92 * t180
  t360 = 0.1e1 / t181 / t65
  t365 = t360 * t169 * t188 * t223 * t197 * t166
  t372 = t182 * t68 * t188 * t223 * t197 * t176
  t377 = t140 * t87 * t73 * t180
  t380 = 0.7e1 / 0.64e2 * t330 * t302 - 0.3e1 / 0.32e2 * t330 * t307 - 0.1811e4 / 0.27648e5 * t340 * t296 + 0.1811e4 / 0.27648e5 * t340 * t302 + 0.1811e4 / 0.9216e4 * t340 * t307 - 0.67e2 / 0.1152e4 * t349 * t296 - 0.3275e4 / 0.8064e4 * t349 * t302 + 0.67e2 / 0.384e3 * t349 * t307 + 0.13e2 / 0.720e3 * t358 * t365 - 0.13e2 / 0.720e3 * t358 * t372 + t377 * t365 / 0.96e2
  t394 = 0.9e1 / 0.16e2 * t73 * t22 * t219 * t180 * t182 * t225 - 0.27e2 / 0.32e2 * t226
  t397 = t182 * t169 * t188 * t191 * t292 * t197 * t394
  t402 = t140 * t87 * t104 * t180
  t407 = t140 * t87 * t100 * t180
  t422 = t140 * t87 * t96 * t180
  t427 = -t377 * t372 / 0.96e2 + t377 * t397 / 0.192e3 - 0.1811e4 / 0.165888e6 * t402 * t397 + 0.13e2 / 0.630e3 * t407 * t365 - 0.13e2 / 0.630e3 * t407 * t372 + 0.13e2 / 0.1260e4 * t407 * t397 - 0.1811e4 / 0.82944e5 * t402 * t365 + 0.1811e4 / 0.82944e5 * t402 * t372 + 0.13e2 / 0.1440e4 * t358 * t397 - 0.67e2 / 0.3456e4 * t422 * t365 + 0.67e2 / 0.3456e4 * t422 * t372
  t432 = t140 * t87 * t88 * t180
  t442 = t28 / t19 / t53 * t47
  t444 = t145 * t153
  t450 = f.my_piecewise3(t44, -s0 / t53 * t40 / 0.4e1, 0)
  t452 = t31 * t37 * t450
  t458 = t51 / t18 / t156 / r0 * t62
  t460 = t159 * t163
  t462 = t152 ** 2
  t464 = t56 * t60 * t462
  t468 = t56 * t60 * t46 * t450
  t481 = t176 ** 2
  t497 = (t25 * (0.24691358024691358024691358024691358024691358024692e0 * t442 - 0.18518518518518518518518518518518518518518518518519e0 * t444 + 0.55555555555555555555555555555555555555555555555556e-1 * t452 - 0.10070907407407407407407407407407407407407407407407e3 * t458 + 0.92962222222222222222222222222222222222222222222220e2 * t460 - 0.13944333333333333333333333333333333333333333333333e2 * t464 - 0.13944333333333333333333333333333333333333333333333e2 * t468) * t69 / 0.6e1 - t25 * t166 * t170 * t176 / 0.3e1 + t25 * t65 / t169 / t68 * t481 / 0.3e1 - t25 * t171 * (0.49382716049382716049382716049382716049382716049381e1 * t442 - 0.37037037037037037037037037037037037037037037037036e1 * t444 + 0.11111111111111111111111111111111111111111111111111e1 * t452 + 0.33569691358024691358024691358024691358024691358025e2 * t458 - 0.30987407407407407407407407407407407407407407407408e2 * t460 + 0.46481111111111111111111111111111111111111111111112e1 * t464 + 0.46481111111111111111111111111111111111111111111112e1 * t468) / 0.6e1) * t182
  t499 = t497 * t169 * t199
  t516 = -0.67e2 / 0.6912e4 * t422 * t397 - t432 * t365 / 0.64e2 + t432 * t372 / 0.64e2 - t432 * t397 / 0.128e3 - t142 * t499 / 0.192e3 + t203 * t499 / 0.128e3 - 0.13e2 / 0.1440e4 * t206 * t499 + 0.67e2 / 0.6912e4 * t209 * t499 - 0.13e2 / 0.1260e4 * t212 * t499 + 0.1811e4 / 0.165888e6 * t215 * t499 - 0.3e1 / 0.64e2 * t275 * t87 * t278 * t302
  t539 = t23 / t4 / jnp.pi * t278 * t282
  t544 = t283 * t300
  t558 = f.my_piecewise3(t114, 0.9e1 / 0.32e2 * t220 * t497 * t225 - 0.9e1 / 0.16e2 * t220 * t180 * t360 * t169 * t192 * t198 * t166 + 0.9e1 / 0.16e2 * t220 * t183 * t68 * t192 * t198 * t176 - 0.27e2 / 0.512e3 * t539 * t283 * t287 * t295 + 0.27e2 / 0.512e3 * t539 * t544 * t295 - 0.9e1 / 0.32e2 * t220 * t184 * t192 * t292 * t197 * t394 + 0.81e2 / 0.512e3 * t539 * t544 * t306, 0)
  t563 = t228 ** 2
  t564 = t563 * t117
  t598 = t117 * t240
  t621 = t127 ** 2
  t633 = -t84 * t558 * t117 * t130 / 0.108e3 - t84 * t564 * t130 / 0.324e3 - t84 * t229 * t242 / 0.54e2 + t84 * t564 * t124 * t247 * t129 / 0.54e2 + t84 * t564 * t126 * t254 / 0.162e3 - t113 * t118 * (t558 * t119 * t122 - t563 * t119 * t122 + 0.2e1 * t233 * t238 - t119 * (0.2e1 * t115 * t558 + 0.5e1 * t558 + 0.2e1 * t563)) * t125 * t129 / 0.36e2 + t84 * t598 * t249 / 0.18e2 + t84 * t598 * t256 / 0.54e2 - t84 * t246 / t120 / t115 * t129 * t563 / 0.18e2 - t84 * t246 * t247 * t254 * t563 / 0.54e2 + t84 * t246 * t248 * t558 / 0.36e2 - t84 * t246 * t125 / t128 / t621 * t563 / 0.81e2 + t84 * t246 * t255 * t558 / 0.108e3
  t634 = f.my_piecewise3(t75, 0.13e2 / 0.210e3 * t280 * t296 + 0.56729e5 / 0.107520e6 * t280 * t302 - 0.13e2 / 0.70e2 * t280 * t307 - 0.3e1 / 0.64e2 * t312 * t296 - 0.63e2 / 0.320e3 * t312 * t302 + 0.9e1 / 0.64e2 * t312 * t307 + 0.13e2 / 0.240e3 * t321 * t296 + 0.283e3 / 0.960e3 * t321 * t302 - 0.13e2 / 0.80e2 * t321 * t307 + t330 * t296 / 0.32e2 + t380 + t427 + t516, t633)
  t639 = f.my_piecewise3(t2, 0, -t6 * t17 * t30 * t134 / 0.24e2 + t6 * t21 * t261 / 0.8e1 + 0.3e1 / 0.16e2 * t6 * t138 * t634)
  v2rho2_0_ = 0.2e1 * r0 * t639 + 0.4e1 * t266
  res = {'v2rho2': v2rho2_0_}
  return res

def pol_fxc(p, r, s=(None, None, None), l=(None, None), tau=(None, None)):
  f = funcs(p)
  params = f.params
  (r0, r1), (s0, s1, s2), (l0, l1), (tau0, tau1) = r, s, l, tau
  
  t1 = r0 <= f.p.dens_threshold
  t2 = 3 ** (0.1e1 / 0.3e1)
  t3 = jnp.pi ** (0.1e1 / 0.3e1)
  t4 = 0.1e1 / t3
  t5 = t2 * t4
  t6 = r0 + r1
  t7 = 0.1e1 / t6
  t10 = 0.2e1 * r0 * t7 <= f.p.zeta_threshold
  t11 = f.p.zeta_threshold - 0.1e1
  t14 = 0.2e1 * r1 * t7 <= f.p.zeta_threshold
  t15 = -t11
  t16 = r0 - r1
  t17 = t16 * t7
  t18 = f.my_piecewise5(t10, t11, t14, t15, t17)
  t19 = 0.1e1 + t18
  t20 = t19 <= f.p.zeta_threshold
  t21 = t19 ** (0.1e1 / 0.3e1)
  t22 = t6 ** 2
  t23 = 0.1e1 / t22
  t24 = t16 * t23
  t25 = t7 - t24
  t26 = f.my_piecewise5(t10, 0, t14, 0, t25)
  t29 = f.my_piecewise3(t20, 0, 0.4e1 / 0.3e1 * t21 * t26)
  t30 = t6 ** (0.1e1 / 0.3e1)
  t31 = t29 * t30
  t32 = 32 ** (0.1e1 / 0.3e1)
  t33 = t32 ** 2
  t34 = t3 ** 2
  t35 = t33 * t34
  t36 = r0 ** (0.1e1 / 0.3e1)
  t37 = t36 ** 2
  t40 = tau0 / t37 / r0
  t41 = 6 ** (0.1e1 / 0.3e1)
  t42 = jnp.pi ** 2
  t43 = t42 ** (0.1e1 / 0.3e1)
  t44 = t43 ** 2
  t46 = t41 / t44
  t49 = 0.1e1 / tau0
  t51 = s0 / r0 * t49 / 0.8e1
  t53 = 0.0e0 < 0.9999999999e0 - t51
  t55 = f.my_piecewise3(t53, 0.1e1 - t51, 0.1e-9)
  t56 = t46 * t55
  t57 = t40 * t56
  t59 = tau0 ** 2
  t60 = r0 ** 2
  t61 = t60 * r0
  t64 = t59 / t36 / t61
  t65 = t41 ** 2
  t67 = 0.1e1 / t43 / t42
  t68 = t65 * t67
  t69 = t55 ** 2
  t70 = t68 * t69
  t71 = t64 * t70
  t73 = 0.1e1 + 0.55555555555555555555555555555555555555555555555556e-1 * t57 - 0.34860833333333333333333333333333333333333333333333e1 * t71
  t76 = 0.3712e1 + 0.11111111111111111111111111111111111111111111111111e1 * t57 + 0.11620277777777777777777777777777777777777777777778e1 * t71
  t77 = 0.1e1 / t76
  t81 = mbrxc_x(t35 * t73 * t77 / 0.6e1)
  t82 = DBL_EPSILON ** (0.1e1 / 0.4e1)
  t83 = t81 < t82
  t84 = t32 * t3
  t85 = t2 ** 2
  t86 = 0.1e1 / jnp.pi
  t87 = t86 ** (0.1e1 / 0.3e1)
  t88 = 0.1e1 / t87
  t89 = t85 * t88
  t90 = 4 ** (0.1e1 / 0.3e1)
  t92 = t84 * t89 * t90
  t93 = t92 / 0.12e2
  t94 = t84 * t85
  t95 = t88 * t90
  t96 = t81 ** 2
  t97 = t95 * t96
  t100 = t96 * t81
  t101 = t95 * t100
  t104 = t96 ** 2
  t105 = t95 * t104
  t108 = t104 * t81
  t109 = t95 * t108
  t112 = t104 * t96
  t113 = t95 * t112
  t121 = t84 * t89
  t122 = t82 < t81
  t123 = f.my_piecewise3(t122, t81, t82)
  t125 = jnp.exp(t123 / 0.3e1)
  t126 = t90 * t125
  t127 = jnp.exp(-t123)
  t128 = t123 ** 2
  t130 = t128 + 0.5e1 * t123 + 0.8e1
  t132 = -t127 * t130 + 0.8e1
  t133 = 0.1e1 / t123
  t134 = t132 * t133
  t135 = 0.1e1 + t123
  t136 = t135 ** (0.1e1 / 0.3e1)
  t137 = 0.1e1 / t136
  t138 = t134 * t137
  t142 = f.my_piecewise3(t83, -t93 - t94 * t97 / 0.108e3 + t94 * t101 / 0.108e3 - 0.13e2 / 0.1620e4 * t94 * t105 + 0.67e2 / 0.9720e4 * t94 * t109 - 0.52e2 / 0.8505e4 * t94 * t113 + 0.1811e4 / 0.326592e6 * t94 * t95 * t104 * t100, -t121 * t126 * t138 / 0.36e2)
  t146 = f.p.zeta_threshold ** (0.1e1 / 0.3e1)
  t147 = t146 * f.p.zeta_threshold
  t149 = f.my_piecewise3(t20, t147, t21 * t19)
  t150 = t30 ** 2
  t151 = 0.1e1 / t150
  t152 = t149 * t151
  t155 = t5 * t152 * t142 / 0.16e2
  t156 = t149 * t30
  t158 = t33 * t4 * t85
  t160 = t158 * t95 * t81
  t163 = tau0 / t37 / t60
  t164 = t163 * t56
  t170 = f.my_piecewise3(t53, s0 / t60 * t49 / 0.8e1, 0)
  t171 = t46 * t170
  t172 = t40 * t171
  t174 = t60 ** 2
  t177 = t59 / t36 / t174
  t178 = t177 * t70
  t180 = t64 * t65
  t181 = t67 * t55
  t182 = t181 * t170
  t183 = t180 * t182
  t185 = -0.92592592592592592592592592592592592592592592592594e-1 * t164 + 0.55555555555555555555555555555555555555555555555556e-1 * t172 + 0.11620277777777777777777777777777777777777777777778e2 * t178 - 0.69721666666666666666666666666666666666666666666666e1 * t183
  t188 = t76 ** 2
  t189 = 0.1e1 / t188
  t190 = t73 * t189
  t195 = -0.18518518518518518518518518518518518518518518518518e1 * t164 + 0.11111111111111111111111111111111111111111111111111e1 * t172 - 0.38734259259259259259259259259259259259259259259260e1 * t178 + 0.23240555555555555555555555555555555555555555555556e1 * t183
  t199 = t35 * t185 * t77 / 0.6e1 - t35 * t190 * t195 / 0.6e1
  t200 = t73 ** 2
  t201 = 0.1e1 / t200
  t202 = t199 * t201
  t203 = t202 * t188
  t204 = 0.1e1 + t81
  t205 = t204 ** (0.1e1 / 0.3e1)
  t206 = t205 ** 2
  t207 = 0.1e1 / t206
  t209 = jnp.exp(-0.2e1 / 0.3e1 * t81)
  t210 = 0.1e1 / t209
  t211 = t207 * t210
  t213 = 0.6e1 + t96 - 0.3e1 * t81
  t214 = 0.1e1 / t213
  t215 = -0.3e1 + t81
  t216 = t215 ** 2
  t217 = t214 * t216
  t218 = t211 * t217
  t219 = t203 * t218
  t222 = t158 * t97
  t225 = t158 * t101
  t228 = t158 * t105
  t231 = t158 * t109
  t234 = t158 * t113
  t238 = 0.1e1 / t34
  t239 = t32 * t238
  t242 = t210 * t214
  t244 = t188 * t207 * t242 * t216
  t245 = t239 * t202 * t244
  t247 = f.my_piecewise3(t122, 0.9e1 / 0.32e2 * t245, 0)
  t248 = t247 * t125
  t252 = t247 * t127
  t257 = 0.2e1 * t123 * t247 + 0.5e1 * t247
  t259 = -t127 * t257 + t252 * t130
  t261 = t259 * t133 * t137
  t265 = t125 * t132
  t266 = 0.1e1 / t128
  t267 = t266 * t137
  t268 = t267 * t247
  t273 = 0.1e1 / t136 / t135
  t274 = t133 * t273
  t275 = t274 * t247
  t280 = f.my_piecewise3(t83, -t160 * t219 / 0.192e3 + t222 * t219 / 0.128e3 - 0.13e2 / 0.1440e4 * t225 * t219 + 0.67e2 / 0.6912e4 * t228 * t219 - 0.13e2 / 0.1260e4 * t231 * t219 + 0.1811e4 / 0.165888e6 * t234 * t219, -t92 * t248 * t138 / 0.108e3 - t121 * t126 * t261 / 0.36e2 + t92 * t265 * t268 / 0.36e2 + t92 * t265 * t275 / 0.108e3)
  t285 = f.my_piecewise3(t1, 0, 0.3e1 / 0.16e2 * t5 * t31 * t142 + t155 + 0.3e1 / 0.16e2 * t5 * t156 * t280)
  t287 = r1 <= f.p.dens_threshold
  t288 = f.my_piecewise5(t14, t11, t10, t15, -t17)
  t289 = 0.1e1 + t288
  t290 = t289 <= f.p.zeta_threshold
  t291 = t289 ** (0.1e1 / 0.3e1)
  t293 = f.my_piecewise5(t14, 0, t10, 0, -t25)
  t296 = f.my_piecewise3(t290, 0, 0.4e1 / 0.3e1 * t291 * t293)
  t297 = t296 * t30
  t298 = r1 ** (0.1e1 / 0.3e1)
  t299 = t298 ** 2
  t302 = tau1 / t299 / r1
  t305 = 0.1e1 / tau1
  t307 = s2 / r1 * t305 / 0.8e1
  t309 = 0.0e0 < 0.9999999999e0 - t307
  t311 = f.my_piecewise3(t309, 0.1e1 - t307, 0.1e-9)
  t312 = t46 * t311
  t313 = t302 * t312
  t315 = tau1 ** 2
  t316 = r1 ** 2
  t317 = t316 * r1
  t320 = t315 / t298 / t317
  t321 = t311 ** 2
  t322 = t68 * t321
  t323 = t320 * t322
  t325 = 0.1e1 + 0.55555555555555555555555555555555555555555555555556e-1 * t313 - 0.34860833333333333333333333333333333333333333333333e1 * t323
  t328 = 0.3712e1 + 0.11111111111111111111111111111111111111111111111111e1 * t313 + 0.11620277777777777777777777777777777777777777777778e1 * t323
  t329 = 0.1e1 / t328
  t333 = mbrxc_x(t35 * t325 * t329 / 0.6e1)
  t334 = t333 < t82
  t335 = t333 ** 2
  t336 = t95 * t335
  t339 = t335 * t333
  t340 = t95 * t339
  t343 = t335 ** 2
  t344 = t95 * t343
  t347 = t343 * t333
  t348 = t95 * t347
  t351 = t343 * t335
  t352 = t95 * t351
  t360 = t82 < t333
  t361 = f.my_piecewise3(t360, t333, t82)
  t363 = jnp.exp(t361 / 0.3e1)
  t364 = t90 * t363
  t365 = jnp.exp(-t361)
  t366 = t361 ** 2
  t368 = t366 + 0.5e1 * t361 + 0.8e1
  t370 = -t365 * t368 + 0.8e1
  t371 = 0.1e1 / t361
  t372 = t370 * t371
  t373 = 0.1e1 + t361
  t374 = t373 ** (0.1e1 / 0.3e1)
  t375 = 0.1e1 / t374
  t376 = t372 * t375
  t380 = f.my_piecewise3(t334, -t93 - t94 * t336 / 0.108e3 + t94 * t340 / 0.108e3 - 0.13e2 / 0.1620e4 * t94 * t344 + 0.67e2 / 0.9720e4 * t94 * t348 - 0.52e2 / 0.8505e4 * t94 * t352 + 0.1811e4 / 0.326592e6 * t94 * t95 * t343 * t339, -t121 * t364 * t376 / 0.36e2)
  t385 = f.my_piecewise3(t290, t147, t291 * t289)
  t386 = t385 * t151
  t389 = t5 * t386 * t380 / 0.16e2
  t391 = f.my_piecewise3(t287, 0, 0.3e1 / 0.16e2 * t5 * t297 * t380 + t389)
  t393 = t21 ** 2
  t394 = 0.1e1 / t393
  t395 = t26 ** 2
  t400 = t16 / t22 / t6
  t402 = -0.2e1 * t23 + 0.2e1 * t400
  t403 = f.my_piecewise5(t10, 0, t14, 0, t402)
  t407 = f.my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t394 * t395 + 0.4e1 / 0.3e1 * t21 * t403)
  t414 = t5 * t29 * t151 * t142
  t420 = 0.1e1 / t150 / t6
  t424 = t5 * t149 * t420 * t142 / 0.24e2
  t426 = t5 * t152 * t280
  t430 = t158 * t95 * t81 * t199
  t435 = t201 * t76 * t207 * t242 * t216 * t195
  t440 = t158 * t95 * t108 * t199
  t443 = t213 ** 2
  t444 = 0.1e1 / t443
  t453 = 0.9e1 / 0.16e2 * t81 * t32 * t238 * t199 * t201 * t244 - 0.27e2 / 0.32e2 * t245
  t456 = t201 * t188 * t207 * t210 * t444 * t216 * t453
  t461 = t158 * t95 * t112 * t199
  t463 = 0.1e1 / t200 / t73
  t468 = t463 * t188 * t207 * t242 * t216 * t185
  t477 = t158 * t95 * t104 * t199
  t491 = t158 * t95 * t100 * t199
  t502 = t158 * t95 * t96 * t199
  t511 = t86 * t85
  t512 = t511 * t88
  t514 = t199 ** 2
  t516 = t512 * t90 * t96 * t514
  t517 = t200 ** 2
  t518 = 0.1e1 / t517
  t519 = t188 ** 2
  t520 = t518 * t519
  t522 = 0.1e1 / t205 / t204
  t523 = t520 * t522
  t524 = t209 ** 2
  t526 = 0.1e1 / t524 * t444
  t527 = t216 ** 2
  t528 = t526 * t527
  t529 = t523 * t528
  t533 = t526 * t216 * t215
  t534 = t523 * t533
  t539 = t512 * t90 * t108 * t514
  t540 = t204 ** 2
  t542 = 0.1e1 / t205 / t540
  t544 = t520 * t542 * t528
  t547 = 0.13e2 / 0.720e3 * t491 * t468 - 0.13e2 / 0.720e3 * t491 * t435 + 0.13e2 / 0.1440e4 * t491 * t456 + t430 * t456 / 0.192e3 - t502 * t468 / 0.64e2 + t502 * t435 / 0.64e2 - t502 * t456 / 0.128e3 + t430 * t468 / 0.96e2 - 0.63e2 / 0.320e3 * t516 * t529 + 0.9e1 / 0.64e2 * t516 * t534 + 0.13e2 / 0.210e3 * t539 * t544
  t555 = t512 * t90 * t112 * t514
  t564 = t512 * t90 * t100 * t514
  t573 = t512 * t90 * t104 * t514
  t580 = 0.56729e5 / 0.107520e6 * t539 * t529 - 0.13e2 / 0.70e2 * t539 * t534 - 0.1811e4 / 0.27648e5 * t555 * t544 + 0.1811e4 / 0.27648e5 * t555 * t529 + 0.1811e4 / 0.9216e4 * t555 * t534 + 0.13e2 / 0.240e3 * t564 * t544 + 0.283e3 / 0.960e3 * t564 * t529 - 0.13e2 / 0.80e2 * t564 * t534 - 0.67e2 / 0.1152e4 * t573 * t544 - 0.3275e4 / 0.8064e4 * t573 * t529 + 0.67e2 / 0.384e3 * t573 * t534
  t583 = t512 * t90 * t81 * t514
  t595 = tau0 / t37 / t61 * t56
  t597 = t163 * t171
  t603 = f.my_piecewise3(t53, -s0 / t61 * t49 / 0.4e1, 0)
  t605 = t40 * t46 * t603
  t611 = t59 / t36 / t174 / r0 * t70
  t614 = t177 * t65 * t182
  t616 = t170 ** 2
  t618 = t64 * t68 * t616
  t621 = t180 * t181 * t603
  t634 = t195 ** 2
  t650 = (t35 * (0.24691358024691358024691358024691358024691358024692e0 * t595 - 0.18518518518518518518518518518518518518518518518519e0 * t597 + 0.55555555555555555555555555555555555555555555555556e-1 * t605 - 0.50354537037037037037037037037037037037037037037038e2 * t611 + 0.46481111111111111111111111111111111111111111111111e2 * t614 - 0.69721666666666666666666666666666666666666666666666e1 * t618 - 0.69721666666666666666666666666666666666666666666666e1 * t621) * t77 / 0.6e1 - t35 * t185 * t189 * t195 / 0.3e1 + t35 * t73 / t188 / t76 * t634 / 0.3e1 - t35 * t190 * (0.49382716049382716049382716049382716049382716049381e1 * t595 - 0.37037037037037037037037037037037037037037037037036e1 * t597 + 0.11111111111111111111111111111111111111111111111111e1 * t605 + 0.16784845679012345679012345679012345679012345679013e2 * t611 - 0.15493703703703703703703703703703703703703703703704e2 * t614 + 0.23240555555555555555555555555555555555555555555556e1 * t618 + 0.23240555555555555555555555555555555555555555555556e1 * t621) / 0.6e1) * t201
  t652 = t650 * t188 * t218
  t669 = t583 * t544 / 0.32e2 + 0.7e1 / 0.64e2 * t583 * t529 - 0.3e1 / 0.32e2 * t583 * t534 - 0.3e1 / 0.64e2 * t516 * t544 - 0.13e2 / 0.1260e4 * t231 * t652 + 0.1811e4 / 0.165888e6 * t234 * t652 - t160 * t652 / 0.192e3 + t222 * t652 / 0.128e3 - 0.13e2 / 0.1440e4 * t225 * t652 + 0.67e2 / 0.6912e4 * t228 * t652 - 0.3e1 / 0.64e2 * t511 * t95 * t514 * t529
  t690 = t33 / t3 / jnp.pi
  t692 = t690 * t514 * t518
  t697 = t519 * t522
  t711 = f.my_piecewise3(t122, 0.9e1 / 0.32e2 * t239 * t650 * t244 - 0.9e1 / 0.16e2 * t239 * t199 * t463 * t188 * t211 * t217 * t185 + 0.9e1 / 0.16e2 * t239 * t202 * t76 * t211 * t217 * t195 - 0.27e2 / 0.512e3 * t692 * t519 * t542 * t528 + 0.27e2 / 0.512e3 * t692 * t697 * t528 - 0.9e1 / 0.32e2 * t239 * t203 * t211 * t444 * t216 * t453 + 0.81e2 / 0.512e3 * t692 * t697 * t533, 0)
  t716 = t247 ** 2
  t717 = t716 * t125
  t751 = t125 * t259
  t774 = t135 ** 2
  t786 = -t92 * t711 * t125 * t138 / 0.108e3 - t92 * t717 * t138 / 0.324e3 - t92 * t248 * t261 / 0.54e2 + t92 * t717 * t132 * t266 * t137 / 0.54e2 + t92 * t717 * t134 * t273 / 0.162e3 - t121 * t126 * (t711 * t127 * t130 - t716 * t127 * t130 + 0.2e1 * t252 * t257 - t127 * (0.2e1 * t123 * t711 + 0.5e1 * t711 + 0.2e1 * t716)) * t133 * t137 / 0.36e2 + t92 * t751 * t268 / 0.18e2 + t92 * t751 * t275 / 0.54e2 - t92 * t265 / t128 / t123 * t137 * t716 / 0.18e2 - t92 * t265 * t266 * t273 * t716 / 0.54e2 + t92 * t265 * t267 * t711 / 0.36e2 - t92 * t265 * t133 / t136 / t774 * t716 / 0.81e2 + t92 * t265 * t274 * t711 / 0.108e3
  t787 = f.my_piecewise3(t83, -t430 * t435 / 0.96e2 + 0.13e2 / 0.1260e4 * t440 * t456 - 0.1811e4 / 0.82944e5 * t461 * t468 + 0.1811e4 / 0.82944e5 * t461 * t435 - 0.1811e4 / 0.165888e6 * t461 * t456 - 0.67e2 / 0.3456e4 * t477 * t468 + 0.67e2 / 0.3456e4 * t477 * t435 - 0.67e2 / 0.6912e4 * t477 * t456 + 0.13e2 / 0.630e3 * t440 * t468 - 0.13e2 / 0.630e3 * t440 * t435 + t547 + t580 + t669, t786)
  t792 = f.my_piecewise3(t1, 0, 0.3e1 / 0.16e2 * t5 * t407 * t30 * t142 + t414 / 0.8e1 + 0.3e1 / 0.8e1 * t5 * t31 * t280 - t424 + t426 / 0.8e1 + 0.3e1 / 0.16e2 * t5 * t156 * t787)
  t793 = t291 ** 2
  t794 = 0.1e1 / t793
  t795 = t293 ** 2
  t799 = f.my_piecewise5(t14, 0, t10, 0, -t402)
  t803 = f.my_piecewise3(t290, 0, 0.4e1 / 0.9e1 * t794 * t795 + 0.4e1 / 0.3e1 * t291 * t799)
  t810 = t5 * t296 * t151 * t380
  t815 = t5 * t385 * t420 * t380 / 0.24e2
  t817 = f.my_piecewise3(t287, 0, 0.3e1 / 0.16e2 * t5 * t803 * t30 * t380 + t810 / 0.8e1 - t815)
  d11 = 0.2e1 * t285 + 0.2e1 * t391 + t6 * (t792 + t817)
  t820 = -t7 - t24
  t821 = f.my_piecewise5(t10, 0, t14, 0, t820)
  t824 = f.my_piecewise3(t20, 0, 0.4e1 / 0.3e1 * t21 * t821)
  t825 = t824 * t30
  t830 = f.my_piecewise3(t1, 0, 0.3e1 / 0.16e2 * t5 * t825 * t142 + t155)
  t832 = f.my_piecewise5(t14, 0, t10, 0, -t820)
  t835 = f.my_piecewise3(t290, 0, 0.4e1 / 0.3e1 * t291 * t832)
  t836 = t835 * t30
  t840 = t385 * t30
  t842 = t158 * t95 * t333
  t845 = tau1 / t299 / t316
  t846 = t845 * t312
  t852 = f.my_piecewise3(t309, s2 / t316 * t305 / 0.8e1, 0)
  t853 = t46 * t852
  t854 = t302 * t853
  t856 = t316 ** 2
  t859 = t315 / t298 / t856
  t860 = t859 * t322
  t862 = t320 * t65
  t863 = t67 * t311
  t864 = t863 * t852
  t865 = t862 * t864
  t867 = -0.92592592592592592592592592592592592592592592592594e-1 * t846 + 0.55555555555555555555555555555555555555555555555556e-1 * t854 + 0.11620277777777777777777777777777777777777777777778e2 * t860 - 0.69721666666666666666666666666666666666666666666666e1 * t865
  t870 = t328 ** 2
  t871 = 0.1e1 / t870
  t872 = t325 * t871
  t877 = -0.18518518518518518518518518518518518518518518518518e1 * t846 + 0.11111111111111111111111111111111111111111111111111e1 * t854 - 0.38734259259259259259259259259259259259259259259260e1 * t860 + 0.23240555555555555555555555555555555555555555555556e1 * t865
  t881 = t35 * t867 * t329 / 0.6e1 - t35 * t872 * t877 / 0.6e1
  t882 = t325 ** 2
  t883 = 0.1e1 / t882
  t884 = t881 * t883
  t885 = t884 * t870
  t886 = 0.1e1 + t333
  t887 = t886 ** (0.1e1 / 0.3e1)
  t888 = t887 ** 2
  t889 = 0.1e1 / t888
  t891 = jnp.exp(-0.2e1 / 0.3e1 * t333)
  t892 = 0.1e1 / t891
  t893 = t889 * t892
  t895 = 0.6e1 + t335 - 0.3e1 * t333
  t896 = 0.1e1 / t895
  t897 = -0.3e1 + t333
  t898 = t897 ** 2
  t899 = t896 * t898
  t900 = t893 * t899
  t901 = t885 * t900
  t904 = t158 * t336
  t907 = t158 * t340
  t910 = t158 * t344
  t913 = t158 * t348
  t916 = t158 * t352
  t922 = t892 * t896
  t924 = t870 * t889 * t922 * t898
  t925 = t239 * t884 * t924
  t927 = f.my_piecewise3(t360, 0.9e1 / 0.32e2 * t925, 0)
  t928 = t927 * t363
  t932 = t927 * t365
  t937 = 0.2e1 * t361 * t927 + 0.5e1 * t927
  t939 = -t365 * t937 + t932 * t368
  t941 = t939 * t371 * t375
  t945 = t363 * t370
  t946 = 0.1e1 / t366
  t947 = t946 * t375
  t948 = t947 * t927
  t953 = 0.1e1 / t374 / t373
  t954 = t371 * t953
  t955 = t954 * t927
  t960 = f.my_piecewise3(t334, -t842 * t901 / 0.192e3 + t904 * t901 / 0.128e3 - 0.13e2 / 0.1440e4 * t907 * t901 + 0.67e2 / 0.6912e4 * t910 * t901 - 0.13e2 / 0.1260e4 * t913 * t901 + 0.1811e4 / 0.165888e6 * t916 * t901, -t92 * t928 * t376 / 0.108e3 - t121 * t364 * t941 / 0.36e2 + t92 * t945 * t948 / 0.36e2 + t92 * t945 * t955 / 0.108e3)
  t965 = f.my_piecewise3(t287, 0, 0.3e1 / 0.16e2 * t5 * t836 * t380 + t389 + 0.3e1 / 0.16e2 * t5 * t840 * t960)
  t969 = 0.2e1 * t400
  t970 = f.my_piecewise5(t10, 0, t14, 0, t969)
  t974 = f.my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t394 * t821 * t26 + 0.4e1 / 0.3e1 * t21 * t970)
  t981 = t5 * t824 * t151 * t142
  t989 = f.my_piecewise3(t1, 0, 0.3e1 / 0.16e2 * t5 * t974 * t30 * t142 + t981 / 0.16e2 + 0.3e1 / 0.16e2 * t5 * t825 * t280 + t414 / 0.16e2 - t424 + t426 / 0.16e2)
  t993 = f.my_piecewise5(t14, 0, t10, 0, -t969)
  t997 = f.my_piecewise3(t290, 0, 0.4e1 / 0.9e1 * t794 * t832 * t293 + 0.4e1 / 0.3e1 * t291 * t993)
  t1004 = t5 * t835 * t151 * t380
  t1011 = t5 * t386 * t960
  t1014 = f.my_piecewise3(t287, 0, 0.3e1 / 0.16e2 * t5 * t997 * t30 * t380 + t1004 / 0.16e2 + t810 / 0.16e2 - t815 + 0.3e1 / 0.16e2 * t5 * t297 * t960 + t1011 / 0.16e2)
  d12 = t285 + t391 + t830 + t965 + t6 * (t989 + t1014)
  t1019 = t821 ** 2
  t1023 = 0.2e1 * t23 + 0.2e1 * t400
  t1024 = f.my_piecewise5(t10, 0, t14, 0, t1023)
  t1028 = f.my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t394 * t1019 + 0.4e1 / 0.3e1 * t21 * t1024)
  t1035 = f.my_piecewise3(t1, 0, 0.3e1 / 0.16e2 * t5 * t1028 * t30 * t142 + t981 / 0.8e1 - t424)
  t1036 = t832 ** 2
  t1040 = f.my_piecewise5(t14, 0, t10, 0, -t1023)
  t1044 = f.my_piecewise3(t290, 0, 0.4e1 / 0.9e1 * t794 * t1036 + 0.4e1 / 0.3e1 * t291 * t1040)
  t1056 = t158 * t95 * t333 * t881
  t1059 = t895 ** 2
  t1060 = 0.1e1 / t1059
  t1069 = 0.9e1 / 0.16e2 * t333 * t32 * t238 * t881 * t883 * t924 - 0.27e2 / 0.32e2 * t925
  t1072 = t883 * t870 * t889 * t892 * t1060 * t898 * t1069
  t1077 = t158 * t95 * t335 * t881
  t1079 = 0.1e1 / t882 / t325
  t1084 = t1079 * t870 * t889 * t922 * t898 * t867
  t1091 = t883 * t328 * t889 * t922 * t898 * t877
  t1096 = t158 * t95 * t347 * t881
  t1102 = t881 ** 2
  t1104 = t512 * t90 * t351 * t1102
  t1105 = t882 ** 2
  t1106 = 0.1e1 / t1105
  t1107 = t870 ** 2
  t1108 = t1106 * t1107
  t1109 = t886 ** 2
  t1111 = 0.1e1 / t887 / t1109
  t1113 = t891 ** 2
  t1115 = 0.1e1 / t1113 * t1060
  t1116 = t898 ** 2
  t1117 = t1115 * t1116
  t1118 = t1108 * t1111 * t1117
  t1122 = 0.1e1 / t887 / t886
  t1123 = t1108 * t1122
  t1124 = t1123 * t1117
  t1128 = t1115 * t898 * t897
  t1129 = t1123 * t1128
  t1135 = tau1 / t299 / t317 * t312
  t1137 = t845 * t853
  t1143 = f.my_piecewise3(t309, -s2 / t317 * t305 / 0.4e1, 0)
  t1145 = t302 * t46 * t1143
  t1151 = t315 / t298 / t856 / r1 * t322
  t1154 = t859 * t65 * t864
  t1156 = t852 ** 2
  t1158 = t320 * t68 * t1156
  t1161 = t862 * t863 * t1143
  t1174 = t877 ** 2
  t1190 = (t35 * (0.24691358024691358024691358024691358024691358024692e0 * t1135 - 0.18518518518518518518518518518518518518518518518519e0 * t1137 + 0.55555555555555555555555555555555555555555555555556e-1 * t1145 - 0.50354537037037037037037037037037037037037037037038e2 * t1151 + 0.46481111111111111111111111111111111111111111111111e2 * t1154 - 0.69721666666666666666666666666666666666666666666666e1 * t1158 - 0.69721666666666666666666666666666666666666666666666e1 * t1161) * t329 / 0.6e1 - t35 * t867 * t871 * t877 / 0.3e1 + t35 * t325 / t870 / t328 * t1174 / 0.3e1 - t35 * t872 * (0.49382716049382716049382716049382716049382716049381e1 * t1135 - 0.37037037037037037037037037037037037037037037037036e1 * t1137 + 0.11111111111111111111111111111111111111111111111111e1 * t1145 + 0.16784845679012345679012345679012345679012345679013e2 * t1151 - 0.15493703703703703703703703703703703703703703703704e2 * t1154 + 0.23240555555555555555555555555555555555555555555556e1 * t1158 + 0.23240555555555555555555555555555555555555555555556e1 * t1161) / 0.6e1) * t883
  t1192 = t1190 * t870 * t900
  t1208 = t512 * t90 * t347 * t1102
  t1217 = t512 * t90 * t335 * t1102
  t1226 = t512 * t90 * t339 * t1102
  t1229 = 0.1811e4 / 0.165888e6 * t916 * t1192 - t842 * t1192 / 0.192e3 + t904 * t1192 / 0.128e3 - 0.13e2 / 0.1440e4 * t907 * t1192 + 0.13e2 / 0.210e3 * t1208 * t1118 + 0.56729e5 / 0.107520e6 * t1208 * t1124 - 0.13e2 / 0.70e2 * t1208 * t1129 - 0.3e1 / 0.64e2 * t1217 * t1118 - 0.63e2 / 0.320e3 * t1217 * t1124 + 0.9e1 / 0.64e2 * t1217 * t1129 + 0.13e2 / 0.240e3 * t1226 * t1118
  t1237 = t512 * t90 * t333 * t1102
  t1246 = t512 * t90 * t343 * t1102
  t1255 = t158 * t95 * t351 * t881
  t1262 = 0.283e3 / 0.960e3 * t1226 * t1124 - 0.13e2 / 0.80e2 * t1226 * t1129 + t1237 * t1118 / 0.32e2 + 0.7e1 / 0.64e2 * t1237 * t1124 - 0.3e1 / 0.32e2 * t1237 * t1129 - 0.67e2 / 0.1152e4 * t1246 * t1118 - 0.3275e4 / 0.8064e4 * t1246 * t1124 + 0.67e2 / 0.384e3 * t1246 * t1129 - 0.1811e4 / 0.82944e5 * t1255 * t1084 + 0.1811e4 / 0.82944e5 * t1255 * t1091 - 0.1811e4 / 0.165888e6 * t1255 * t1072
  t1265 = t158 * t95 * t343 * t881
  t1278 = t158 * t95 * t339 * t881
  t1293 = -0.67e2 / 0.3456e4 * t1265 * t1084 + 0.67e2 / 0.3456e4 * t1265 * t1091 - 0.67e2 / 0.6912e4 * t1265 * t1072 + 0.13e2 / 0.630e3 * t1096 * t1084 - t1077 * t1072 / 0.128e3 + 0.13e2 / 0.720e3 * t1278 * t1084 - 0.13e2 / 0.720e3 * t1278 * t1091 + 0.13e2 / 0.1440e4 * t1278 * t1072 + t1056 * t1084 / 0.96e2 - t1056 * t1091 / 0.96e2 - 0.3e1 / 0.64e2 * t511 * t95 * t1102 * t1124
  t1313 = t690 * t1102 * t1106
  t1318 = t1107 * t1122
  t1332 = f.my_piecewise3(t360, 0.9e1 / 0.32e2 * t239 * t1190 * t924 - 0.9e1 / 0.16e2 * t239 * t881 * t1079 * t870 * t893 * t899 * t867 + 0.9e1 / 0.16e2 * t239 * t884 * t328 * t893 * t899 * t877 - 0.27e2 / 0.512e3 * t1313 * t1107 * t1111 * t1117 + 0.27e2 / 0.512e3 * t1313 * t1318 * t1117 - 0.9e1 / 0.32e2 * t239 * t885 * t893 * t1060 * t898 * t1069 + 0.81e2 / 0.512e3 * t1313 * t1318 * t1128, 0)
  t1337 = t927 ** 2
  t1338 = t1337 * t363
  t1372 = t363 * t939
  t1395 = t373 ** 2
  t1407 = -t92 * t1332 * t363 * t376 / 0.108e3 - t92 * t1338 * t376 / 0.324e3 - t92 * t928 * t941 / 0.54e2 + t92 * t1338 * t370 * t946 * t375 / 0.54e2 + t92 * t1338 * t372 * t953 / 0.162e3 - t121 * t364 * (t1332 * t365 * t368 - t1337 * t365 * t368 + 0.2e1 * t932 * t937 - t365 * (0.2e1 * t361 * t1332 + 0.5e1 * t1332 + 0.2e1 * t1337)) * t371 * t375 / 0.36e2 + t92 * t1372 * t948 / 0.18e2 + t92 * t1372 * t955 / 0.54e2 - t92 * t945 / t366 / t361 * t375 * t1337 / 0.18e2 - t92 * t945 * t946 * t953 * t1337 / 0.54e2 + t92 * t945 * t947 * t1332 / 0.36e2 - t92 * t945 * t371 / t374 / t1395 * t1337 / 0.81e2 + t92 * t945 * t954 * t1332 / 0.108e3
  t1408 = f.my_piecewise3(t334, t1056 * t1072 / 0.192e3 - t1077 * t1084 / 0.64e2 + t1077 * t1091 / 0.64e2 - 0.13e2 / 0.630e3 * t1096 * t1091 + 0.13e2 / 0.1260e4 * t1096 * t1072 - 0.1811e4 / 0.27648e5 * t1104 * t1118 + 0.1811e4 / 0.27648e5 * t1104 * t1124 + 0.1811e4 / 0.9216e4 * t1104 * t1129 + 0.67e2 / 0.6912e4 * t910 * t1192 - 0.13e2 / 0.1260e4 * t913 * t1192 + t1229 + t1262 + t1293, t1407)
  t1413 = f.my_piecewise3(t287, 0, 0.3e1 / 0.16e2 * t5 * t1044 * t30 * t380 + t1004 / 0.8e1 + 0.3e1 / 0.8e1 * t5 * t836 * t960 - t815 + t1011 / 0.8e1 + 0.3e1 / 0.16e2 * t5 * t840 * t1408)
  d22 = 0.2e1 * t830 + 0.2e1 * t965 + t6 * (t1035 + t1413)
  res = {'v2rho2': jnp.stack([d11, d12, d22], axis=-1) if 'd12' in locals() else d11}
  return res

def pol_fxc(p, r, s=(None, None, None), l=(None, None), tau=(None, None)):
  f = funcs(p)
  params = f.params
  (r0, r1), (s0, s1, s2), (l0, l1), (tau0, tau1) = r, s, l, tau
  
  t1 = r0 <= f.p.dens_threshold
  t2 = 3 ** (0.1e1 / 0.3e1)
  t3 = jnp.pi ** (0.1e1 / 0.3e1)
  t4 = 0.1e1 / t3
  t5 = t2 * t4
  t6 = r0 + r1
  t7 = 0.1e1 / t6
  t10 = 0.2e1 * r0 * t7 <= f.p.zeta_threshold
  t11 = f.p.zeta_threshold - 0.1e1
  t14 = 0.2e1 * r1 * t7 <= f.p.zeta_threshold
  t15 = -t11
  t16 = r0 - r1
  t17 = t16 * t7
  t18 = f.my_piecewise5(t10, t11, t14, t15, t17)
  t19 = 0.1e1 + t18
  t20 = t19 <= f.p.zeta_threshold
  t21 = t19 ** (0.1e1 / 0.3e1)
  t22 = t6 ** 2
  t23 = 0.1e1 / t22
  t24 = t16 * t23
  t25 = t7 - t24
  t26 = f.my_piecewise5(t10, 0, t14, 0, t25)
  t29 = f.my_piecewise3(t20, 0, 0.4e1 / 0.3e1 * t21 * t26)
  t30 = t6 ** (0.1e1 / 0.3e1)
  t31 = t29 * t30
  t32 = 32 ** (0.1e1 / 0.3e1)
  t33 = t32 ** 2
  t34 = t3 ** 2
  t35 = t33 * t34
  t36 = r0 ** (0.1e1 / 0.3e1)
  t37 = t36 ** 2
  t40 = tau0 / t37 / r0
  t41 = 6 ** (0.1e1 / 0.3e1)
  t42 = jnp.pi ** 2
  t43 = t42 ** (0.1e1 / 0.3e1)
  t44 = t43 ** 2
  t46 = t41 / t44
  t49 = 0.1e1 / tau0
  t51 = s0 / r0 * t49 / 0.8e1
  t53 = 0.0e0 < 0.9999999999e0 - t51
  t55 = f.my_piecewise3(t53, 0.1e1 - t51, 0.1e-9)
  t56 = t46 * t55
  t57 = t40 * t56
  t59 = tau0 ** 2
  t60 = r0 ** 2
  t61 = t60 * r0
  t64 = t59 / t36 / t61
  t65 = t41 ** 2
  t67 = 0.1e1 / t43 / t42
  t68 = t65 * t67
  t69 = t55 ** 2
  t70 = t68 * t69
  t71 = t64 * t70
  t73 = 0.1e1 + 0.55555555555555555555555555555555555555555555555556e-1 * t57 - 0.34860833333333333333333333333333333333333333333333e1 * t71
  t76 = 0.3712e1 + 0.11111111111111111111111111111111111111111111111111e1 * t57 + 0.11620277777777777777777777777777777777777777777778e1 * t71
  t77 = 0.1e1 / t76
  t81 = mbrxc_x(t35 * t73 * t77 / 0.6e1)
  t82 = DBL_EPSILON ** (0.1e1 / 0.4e1)
  t83 = t81 < t82
  t84 = t32 * t3
  t85 = t2 ** 2
  t86 = 0.1e1 / jnp.pi
  t87 = t86 ** (0.1e1 / 0.3e1)
  t88 = 0.1e1 / t87
  t89 = t85 * t88
  t90 = 4 ** (0.1e1 / 0.3e1)
  t92 = t84 * t89 * t90
  t93 = t92 / 0.12e2
  t94 = t84 * t85
  t95 = t88 * t90
  t96 = t81 ** 2
  t97 = t95 * t96
  t100 = t96 * t81
  t101 = t95 * t100
  t104 = t96 ** 2
  t105 = t95 * t104
  t108 = t104 * t81
  t109 = t95 * t108
  t112 = t104 * t96
  t113 = t95 * t112
  t121 = t84 * t89
  t122 = t82 < t81
  t123 = f.my_piecewise3(t122, t81, t82)
  t125 = jnp.exp(t123 / 0.3e1)
  t126 = t90 * t125
  t127 = jnp.exp(-t123)
  t128 = t123 ** 2
  t130 = t128 + 0.5e1 * t123 + 0.8e1
  t132 = -t127 * t130 + 0.8e1
  t133 = 0.1e1 / t123
  t134 = t132 * t133
  t135 = 0.1e1 + t123
  t136 = t135 ** (0.1e1 / 0.3e1)
  t137 = 0.1e1 / t136
  t138 = t134 * t137
  t142 = f.my_piecewise3(t83, -t93 - t94 * t97 / 0.108e3 + t94 * t101 / 0.108e3 - 0.13e2 / 0.1620e4 * t94 * t105 + 0.67e2 / 0.9720e4 * t94 * t109 - 0.52e2 / 0.8505e4 * t94 * t113 + 0.1811e4 / 0.326592e6 * t94 * t95 * t104 * t100, -t121 * t126 * t138 / 0.36e2)
  t146 = f.p.zeta_threshold ** (0.1e1 / 0.3e1)
  t147 = t146 * f.p.zeta_threshold
  t149 = f.my_piecewise3(t20, t147, t21 * t19)
  t150 = t30 ** 2
  t151 = 0.1e1 / t150
  t152 = t149 * t151
  t155 = t5 * t152 * t142 / 0.16e2
  t156 = t149 * t30
  t158 = t33 * t4 * t85
  t160 = t158 * t95 * t81
  t163 = tau0 / t37 / t60
  t164 = t163 * t56
  t170 = f.my_piecewise3(t53, s0 / t60 * t49 / 0.8e1, 0)
  t171 = t46 * t170
  t172 = t40 * t171
  t174 = t60 ** 2
  t177 = t59 / t36 / t174
  t178 = t177 * t70
  t180 = t64 * t65
  t181 = t67 * t55
  t182 = t181 * t170
  t183 = t180 * t182
  t185 = -0.92592592592592592592592592592592592592592592592594e-1 * t164 + 0.55555555555555555555555555555555555555555555555556e-1 * t172 + 0.11620277777777777777777777777777777777777777777778e2 * t178 - 0.69721666666666666666666666666666666666666666666666e1 * t183
  t188 = t76 ** 2
  t189 = 0.1e1 / t188
  t190 = t73 * t189
  t195 = -0.18518518518518518518518518518518518518518518518518e1 * t164 + 0.11111111111111111111111111111111111111111111111111e1 * t172 - 0.38734259259259259259259259259259259259259259259260e1 * t178 + 0.23240555555555555555555555555555555555555555555556e1 * t183
  t199 = t35 * t185 * t77 / 0.6e1 - t35 * t190 * t195 / 0.6e1
  t200 = t73 ** 2
  t201 = 0.1e1 / t200
  t202 = t199 * t201
  t203 = t202 * t188
  t204 = 0.1e1 + t81
  t205 = t204 ** (0.1e1 / 0.3e1)
  t206 = t205 ** 2
  t207 = 0.1e1 / t206
  t209 = jnp.exp(-0.2e1 / 0.3e1 * t81)
  t210 = 0.1e1 / t209
  t211 = t207 * t210
  t213 = 0.6e1 + t96 - 0.3e1 * t81
  t214 = 0.1e1 / t213
  t215 = -0.3e1 + t81
  t216 = t215 ** 2
  t217 = t214 * t216
  t218 = t211 * t217
  t219 = t203 * t218
  t222 = t158 * t97
  t225 = t158 * t101
  t228 = t158 * t105
  t231 = t158 * t109
  t234 = t158 * t113
  t238 = 0.1e1 / t34
  t239 = t32 * t238
  t242 = t210 * t214
  t244 = t188 * t207 * t242 * t216
  t245 = t239 * t202 * t244
  t247 = f.my_piecewise3(t122, 0.9e1 / 0.32e2 * t245, 0)
  t248 = t247 * t125
  t252 = t247 * t127
  t257 = 0.2e1 * t123 * t247 + 0.5e1 * t247
  t259 = -t127 * t257 + t252 * t130
  t261 = t259 * t133 * t137
  t265 = t125 * t132
  t266 = 0.1e1 / t128
  t267 = t266 * t137
  t268 = t267 * t247
  t273 = 0.1e1 / t136 / t135
  t274 = t133 * t273
  t275 = t274 * t247
  t280 = f.my_piecewise3(t83, -t160 * t219 / 0.192e3 + t222 * t219 / 0.128e3 - 0.13e2 / 0.1440e4 * t225 * t219 + 0.67e2 / 0.6912e4 * t228 * t219 - 0.13e2 / 0.1260e4 * t231 * t219 + 0.1811e4 / 0.165888e6 * t234 * t219, -t92 * t248 * t138 / 0.108e3 - t121 * t126 * t261 / 0.36e2 + t92 * t265 * t268 / 0.36e2 + t92 * t265 * t275 / 0.108e3)
  t285 = f.my_piecewise3(t1, 0, 0.3e1 / 0.16e2 * t5 * t31 * t142 + t155 + 0.3e1 / 0.16e2 * t5 * t156 * t280)
  t287 = r1 <= f.p.dens_threshold
  t288 = f.my_piecewise5(t14, t11, t10, t15, -t17)
  t289 = 0.1e1 + t288
  t290 = t289 <= f.p.zeta_threshold
  t291 = t289 ** (0.1e1 / 0.3e1)
  t293 = f.my_piecewise5(t14, 0, t10, 0, -t25)
  t296 = f.my_piecewise3(t290, 0, 0.4e1 / 0.3e1 * t291 * t293)
  t297 = t296 * t30
  t298 = r1 ** (0.1e1 / 0.3e1)
  t299 = t298 ** 2
  t302 = tau1 / t299 / r1
  t305 = 0.1e1 / tau1
  t307 = s2 / r1 * t305 / 0.8e1
  t309 = 0.0e0 < 0.9999999999e0 - t307
  t311 = f.my_piecewise3(t309, 0.1e1 - t307, 0.1e-9)
  t312 = t46 * t311
  t313 = t302 * t312
  t315 = tau1 ** 2
  t316 = r1 ** 2
  t317 = t316 * r1
  t320 = t315 / t298 / t317
  t321 = t311 ** 2
  t322 = t68 * t321
  t323 = t320 * t322
  t325 = 0.1e1 + 0.55555555555555555555555555555555555555555555555556e-1 * t313 - 0.34860833333333333333333333333333333333333333333333e1 * t323
  t328 = 0.3712e1 + 0.11111111111111111111111111111111111111111111111111e1 * t313 + 0.11620277777777777777777777777777777777777777777778e1 * t323
  t329 = 0.1e1 / t328
  t333 = mbrxc_x(t35 * t325 * t329 / 0.6e1)
  t334 = t333 < t82
  t335 = t333 ** 2
  t336 = t95 * t335
  t339 = t335 * t333
  t340 = t95 * t339
  t343 = t335 ** 2
  t344 = t95 * t343
  t347 = t343 * t333
  t348 = t95 * t347
  t351 = t343 * t335
  t352 = t95 * t351
  t360 = t82 < t333
  t361 = f.my_piecewise3(t360, t333, t82)
  t363 = jnp.exp(t361 / 0.3e1)
  t364 = t90 * t363
  t365 = jnp.exp(-t361)
  t366 = t361 ** 2
  t368 = t366 + 0.5e1 * t361 + 0.8e1
  t370 = -t365 * t368 + 0.8e1
  t371 = 0.1e1 / t361
  t372 = t370 * t371
  t373 = 0.1e1 + t361
  t374 = t373 ** (0.1e1 / 0.3e1)
  t375 = 0.1e1 / t374
  t376 = t372 * t375
  t380 = f.my_piecewise3(t334, -t93 - t94 * t336 / 0.108e3 + t94 * t340 / 0.108e3 - 0.13e2 / 0.1620e4 * t94 * t344 + 0.67e2 / 0.9720e4 * t94 * t348 - 0.52e2 / 0.8505e4 * t94 * t352 + 0.1811e4 / 0.326592e6 * t94 * t95 * t343 * t339, -t121 * t364 * t376 / 0.36e2)
  t385 = f.my_piecewise3(t290, t147, t291 * t289)
  t386 = t385 * t151
  t389 = t5 * t386 * t380 / 0.16e2
  t391 = f.my_piecewise3(t287, 0, 0.3e1 / 0.16e2 * t5 * t297 * t380 + t389)
  t393 = t21 ** 2
  t394 = 0.1e1 / t393
  t395 = t26 ** 2
  t400 = t16 / t22 / t6
  t402 = -0.2e1 * t23 + 0.2e1 * t400
  t403 = f.my_piecewise5(t10, 0, t14, 0, t402)
  t407 = f.my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t394 * t395 + 0.4e1 / 0.3e1 * t21 * t403)
  t414 = t5 * t29 * t151 * t142
  t420 = 0.1e1 / t150 / t6
  t424 = t5 * t149 * t420 * t142 / 0.24e2
  t426 = t5 * t152 * t280
  t428 = t86 * t85
  t429 = t428 * t88
  t431 = t199 ** 2
  t433 = t429 * t90 * t96 * t431
  t434 = t200 ** 2
  t435 = 0.1e1 / t434
  t436 = t188 ** 2
  t437 = t435 * t436
  t439 = 0.1e1 / t205 / t204
  t440 = t437 * t439
  t441 = t209 ** 2
  t443 = t213 ** 2
  t444 = 0.1e1 / t443
  t445 = 0.1e1 / t441 * t444
  t447 = t445 * t216 * t215
  t448 = t440 * t447
  t453 = t429 * t90 * t108 * t431
  t454 = t204 ** 2
  t456 = 0.1e1 / t205 / t454
  t458 = t216 ** 2
  t459 = t445 * t458
  t460 = t437 * t456 * t459
  t463 = t440 * t459
  t470 = t429 * t90 * t112 * t431
  t479 = t429 * t90 * t100 * t431
  t489 = t429 * t90 * t104 * t431
  t498 = t429 * t90 * t81 * t431
  t512 = tau0 / t37 / t61 * t56
  t514 = t163 * t171
  t520 = f.my_piecewise3(t53, -s0 / t61 * t49 / 0.4e1, 0)
  t522 = t40 * t46 * t520
  t528 = t59 / t36 / t174 / r0 * t70
  t531 = t177 * t65 * t182
  t533 = t170 ** 2
  t535 = t64 * t68 * t533
  t538 = t180 * t181 * t520
  t551 = t195 ** 2
  t567 = (t35 * (0.24691358024691358024691358024691358024691358024692e0 * t512 - 0.18518518518518518518518518518518518518518518518519e0 * t514 + 0.55555555555555555555555555555555555555555555555556e-1 * t522 - 0.50354537037037037037037037037037037037037037037038e2 * t528 + 0.46481111111111111111111111111111111111111111111111e2 * t531 - 0.69721666666666666666666666666666666666666666666666e1 * t535 - 0.69721666666666666666666666666666666666666666666666e1 * t538) * t77 / 0.6e1 - t35 * t185 * t189 * t195 / 0.3e1 + t35 * t73 / t188 / t76 * t551 / 0.3e1 - t35 * t190 * (0.49382716049382716049382716049382716049382716049381e1 * t512 - 0.37037037037037037037037037037037037037037037037036e1 * t514 + 0.11111111111111111111111111111111111111111111111111e1 * t522 + 0.16784845679012345679012345679012345679012345679013e2 * t528 - 0.15493703703703703703703703703703703703703703703704e2 * t531 + 0.23240555555555555555555555555555555555555555555556e1 * t535 + 0.23240555555555555555555555555555555555555555555556e1 * t538) / 0.6e1) * t201
  t569 = t567 * t188 * t218
  t576 = -0.67e2 / 0.1152e4 * t489 * t460 - 0.3275e4 / 0.8064e4 * t489 * t463 + 0.67e2 / 0.384e3 * t489 * t448 + t498 * t460 / 0.32e2 + 0.7e1 / 0.64e2 * t498 * t463 - 0.3e1 / 0.32e2 * t498 * t448 - 0.3e1 / 0.64e2 * t433 * t460 - 0.63e2 / 0.320e3 * t433 * t463 - 0.13e2 / 0.1260e4 * t231 * t569 + 0.1811e4 / 0.165888e6 * t234 * t569 - t160 * t569 / 0.192e3
  t586 = t158 * t95 * t81 * t199
  t597 = 0.9e1 / 0.16e2 * t81 * t32 * t238 * t199 * t201 * t244 - 0.27e2 / 0.32e2 * t245
  t600 = t201 * t188 * t207 * t210 * t444 * t216 * t597
  t605 = t158 * t95 * t112 * t199
  t610 = t158 * t95 * t108 * t199
  t612 = 0.1e1 / t200 / t73
  t617 = t612 * t188 * t207 * t242 * t216 * t185
  t624 = t201 * t76 * t207 * t242 * t216 * t195
  t635 = t158 * t95 * t100 * t199
  t638 = t222 * t569 / 0.128e3 - 0.13e2 / 0.1440e4 * t225 * t569 + 0.67e2 / 0.6912e4 * t228 * t569 + t586 * t600 / 0.192e3 - 0.1811e4 / 0.165888e6 * t605 * t600 + 0.13e2 / 0.630e3 * t610 * t617 - 0.13e2 / 0.630e3 * t610 * t624 + 0.13e2 / 0.1260e4 * t610 * t600 - 0.1811e4 / 0.82944e5 * t605 * t617 + 0.1811e4 / 0.82944e5 * t605 * t624 + 0.13e2 / 0.1440e4 * t635 * t600
  t641 = t158 * t95 * t104 * t199
  t650 = t158 * t95 * t96 * t199
  t669 = -0.67e2 / 0.3456e4 * t641 * t617 + 0.67e2 / 0.3456e4 * t641 * t624 - 0.67e2 / 0.6912e4 * t641 * t600 - t650 * t617 / 0.64e2 + t650 * t624 / 0.64e2 - t650 * t600 / 0.128e3 + 0.13e2 / 0.720e3 * t635 * t617 - 0.13e2 / 0.720e3 * t635 * t624 + t586 * t617 / 0.96e2 - t586 * t624 / 0.96e2 - 0.3e1 / 0.64e2 * t428 * t95 * t431 * t463
  t690 = t33 / t3 / jnp.pi
  t692 = t690 * t431 * t435
  t697 = t436 * t439
  t711 = f.my_piecewise3(t122, 0.9e1 / 0.32e2 * t239 * t567 * t244 - 0.9e1 / 0.16e2 * t239 * t199 * t612 * t188 * t211 * t217 * t185 + 0.9e1 / 0.16e2 * t239 * t202 * t76 * t211 * t217 * t195 - 0.27e2 / 0.512e3 * t692 * t436 * t456 * t459 + 0.27e2 / 0.512e3 * t692 * t697 * t459 - 0.9e1 / 0.32e2 * t239 * t203 * t211 * t444 * t216 * t597 + 0.81e2 / 0.512e3 * t692 * t697 * t447, 0)
  t716 = t247 ** 2
  t717 = t716 * t125
  t751 = t125 * t259
  t774 = t135 ** 2
  t786 = -t92 * t711 * t125 * t138 / 0.108e3 - t92 * t717 * t138 / 0.324e3 - t92 * t248 * t261 / 0.54e2 + t92 * t717 * t132 * t266 * t137 / 0.54e2 + t92 * t717 * t134 * t273 / 0.162e3 - t121 * t126 * (t711 * t127 * t130 - t716 * t127 * t130 + 0.2e1 * t252 * t257 - t127 * (0.2e1 * t123 * t711 + 0.5e1 * t711 + 0.2e1 * t716)) * t133 * t137 / 0.36e2 + t92 * t751 * t268 / 0.18e2 + t92 * t751 * t275 / 0.54e2 - t92 * t265 / t128 / t123 * t137 * t716 / 0.18e2 - t92 * t265 * t266 * t273 * t716 / 0.54e2 + t92 * t265 * t267 * t711 / 0.36e2 - t92 * t265 * t133 / t136 / t774 * t716 / 0.81e2 + t92 * t265 * t274 * t711 / 0.108e3
  t787 = f.my_piecewise3(t83, 0.9e1 / 0.64e2 * t433 * t448 + 0.13e2 / 0.210e3 * t453 * t460 + 0.56729e5 / 0.107520e6 * t453 * t463 - 0.13e2 / 0.70e2 * t453 * t448 - 0.1811e4 / 0.27648e5 * t470 * t460 + 0.1811e4 / 0.27648e5 * t470 * t463 + 0.1811e4 / 0.9216e4 * t470 * t448 + 0.13e2 / 0.240e3 * t479 * t460 + 0.283e3 / 0.960e3 * t479 * t463 - 0.13e2 / 0.80e2 * t479 * t448 + t576 + t638 + t669, t786)
  t792 = f.my_piecewise3(t1, 0, 0.3e1 / 0.16e2 * t5 * t407 * t30 * t142 + t414 / 0.8e1 + 0.3e1 / 0.8e1 * t5 * t31 * t280 - t424 + t426 / 0.8e1 + 0.3e1 / 0.16e2 * t5 * t156 * t787)
  t793 = t291 ** 2
  t794 = 0.1e1 / t793
  t795 = t293 ** 2
  t799 = f.my_piecewise5(t14, 0, t10, 0, -t402)
  t803 = f.my_piecewise3(t290, 0, 0.4e1 / 0.9e1 * t794 * t795 + 0.4e1 / 0.3e1 * t291 * t799)
  t810 = t5 * t296 * t151 * t380
  t815 = t5 * t385 * t420 * t380 / 0.24e2
  t817 = f.my_piecewise3(t287, 0, 0.3e1 / 0.16e2 * t5 * t803 * t30 * t380 + t810 / 0.8e1 - t815)
  d11 = 0.2e1 * t285 + 0.2e1 * t391 + t6 * (t792 + t817)
  t820 = -t7 - t24
  t821 = f.my_piecewise5(t10, 0, t14, 0, t820)
  t824 = f.my_piecewise3(t20, 0, 0.4e1 / 0.3e1 * t21 * t821)
  t825 = t824 * t30
  t830 = f.my_piecewise3(t1, 0, 0.3e1 / 0.16e2 * t5 * t825 * t142 + t155)
  t832 = f.my_piecewise5(t14, 0, t10, 0, -t820)
  t835 = f.my_piecewise3(t290, 0, 0.4e1 / 0.3e1 * t291 * t832)
  t836 = t835 * t30
  t840 = t385 * t30
  t842 = t158 * t95 * t333
  t845 = tau1 / t299 / t316
  t846 = t845 * t312
  t852 = f.my_piecewise3(t309, s2 / t316 * t305 / 0.8e1, 0)
  t853 = t46 * t852
  t854 = t302 * t853
  t856 = t316 ** 2
  t859 = t315 / t298 / t856
  t860 = t859 * t322
  t862 = t320 * t65
  t863 = t67 * t311
  t864 = t863 * t852
  t865 = t862 * t864
  t867 = -0.92592592592592592592592592592592592592592592592594e-1 * t846 + 0.55555555555555555555555555555555555555555555555556e-1 * t854 + 0.11620277777777777777777777777777777777777777777778e2 * t860 - 0.69721666666666666666666666666666666666666666666666e1 * t865
  t870 = t328 ** 2
  t871 = 0.1e1 / t870
  t872 = t325 * t871
  t877 = -0.18518518518518518518518518518518518518518518518518e1 * t846 + 0.11111111111111111111111111111111111111111111111111e1 * t854 - 0.38734259259259259259259259259259259259259259259260e1 * t860 + 0.23240555555555555555555555555555555555555555555556e1 * t865
  t881 = t35 * t867 * t329 / 0.6e1 - t35 * t872 * t877 / 0.6e1
  t882 = t325 ** 2
  t883 = 0.1e1 / t882
  t884 = t881 * t883
  t885 = t884 * t870
  t886 = 0.1e1 + t333
  t887 = t886 ** (0.1e1 / 0.3e1)
  t888 = t887 ** 2
  t889 = 0.1e1 / t888
  t891 = jnp.exp(-0.2e1 / 0.3e1 * t333)
  t892 = 0.1e1 / t891
  t893 = t889 * t892
  t895 = 0.6e1 + t335 - 0.3e1 * t333
  t896 = 0.1e1 / t895
  t897 = -0.3e1 + t333
  t898 = t897 ** 2
  t899 = t896 * t898
  t900 = t893 * t899
  t901 = t885 * t900
  t904 = t158 * t336
  t907 = t158 * t340
  t910 = t158 * t344
  t913 = t158 * t348
  t916 = t158 * t352
  t922 = t892 * t896
  t924 = t870 * t889 * t922 * t898
  t925 = t239 * t884 * t924
  t927 = f.my_piecewise3(t360, 0.9e1 / 0.32e2 * t925, 0)
  t928 = t927 * t363
  t932 = t927 * t365
  t937 = 0.2e1 * t361 * t927 + 0.5e1 * t927
  t939 = -t365 * t937 + t932 * t368
  t941 = t939 * t371 * t375
  t945 = t363 * t370
  t946 = 0.1e1 / t366
  t947 = t946 * t375
  t948 = t947 * t927
  t953 = 0.1e1 / t374 / t373
  t954 = t371 * t953
  t955 = t954 * t927
  t960 = f.my_piecewise3(t334, -t842 * t901 / 0.192e3 + t904 * t901 / 0.128e3 - 0.13e2 / 0.1440e4 * t907 * t901 + 0.67e2 / 0.6912e4 * t910 * t901 - 0.13e2 / 0.1260e4 * t913 * t901 + 0.1811e4 / 0.165888e6 * t916 * t901, -t92 * t928 * t376 / 0.108e3 - t121 * t364 * t941 / 0.36e2 + t92 * t945 * t948 / 0.36e2 + t92 * t945 * t955 / 0.108e3)
  t965 = f.my_piecewise3(t287, 0, 0.3e1 / 0.16e2 * t5 * t836 * t380 + t389 + 0.3e1 / 0.16e2 * t5 * t840 * t960)
  t969 = 0.2e1 * t400
  t970 = f.my_piecewise5(t10, 0, t14, 0, t969)
  t974 = f.my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t394 * t821 * t26 + 0.4e1 / 0.3e1 * t21 * t970)
  t981 = t5 * t824 * t151 * t142
  t989 = f.my_piecewise3(t1, 0, 0.3e1 / 0.16e2 * t5 * t974 * t30 * t142 + t981 / 0.16e2 + 0.3e1 / 0.16e2 * t5 * t825 * t280 + t414 / 0.16e2 - t424 + t426 / 0.16e2)
  t993 = f.my_piecewise5(t14, 0, t10, 0, -t969)
  t997 = f.my_piecewise3(t290, 0, 0.4e1 / 0.9e1 * t794 * t832 * t293 + 0.4e1 / 0.3e1 * t291 * t993)
  t1004 = t5 * t835 * t151 * t380
  t1011 = t5 * t386 * t960
  t1014 = f.my_piecewise3(t287, 0, 0.3e1 / 0.16e2 * t5 * t997 * t30 * t380 + t1004 / 0.16e2 + t810 / 0.16e2 - t815 + 0.3e1 / 0.16e2 * t5 * t297 * t960 + t1011 / 0.16e2)
  d12 = t285 + t391 + t830 + t965 + t6 * (t989 + t1014)
  t1019 = t821 ** 2
  t1023 = 0.2e1 * t23 + 0.2e1 * t400
  t1024 = f.my_piecewise5(t10, 0, t14, 0, t1023)
  t1028 = f.my_piecewise3(t20, 0, 0.4e1 / 0.9e1 * t394 * t1019 + 0.4e1 / 0.3e1 * t21 * t1024)
  t1035 = f.my_piecewise3(t1, 0, 0.3e1 / 0.16e2 * t5 * t1028 * t30 * t142 + t981 / 0.8e1 - t424)
  t1036 = t832 ** 2
  t1040 = f.my_piecewise5(t14, 0, t10, 0, -t1023)
  t1044 = f.my_piecewise3(t290, 0, 0.4e1 / 0.9e1 * t794 * t1036 + 0.4e1 / 0.3e1 * t291 * t1040)
  t1054 = t881 ** 2
  t1057 = t882 ** 2
  t1058 = 0.1e1 / t1057
  t1059 = t870 ** 2
  t1060 = t1058 * t1059
  t1062 = 0.1e1 / t887 / t886
  t1063 = t1060 * t1062
  t1064 = t891 ** 2
  t1066 = t895 ** 2
  t1067 = 0.1e1 / t1066
  t1068 = 0.1e1 / t1064 * t1067
  t1069 = t898 ** 2
  t1070 = t1068 * t1069
  t1071 = t1063 * t1070
  t1076 = t429 * t90 * t351 * t1054
  t1077 = t886 ** 2
  t1079 = 0.1e1 / t887 / t1077
  t1081 = t1060 * t1079 * t1070
  t1087 = t1068 * t898 * t897
  t1088 = t1063 * t1087
  t1093 = t429 * t90 * t343 * t1054
  t1098 = t429 * t90 * t347 * t1054
  t1105 = t429 * t90 * t335 * t1054
  t1115 = t429 * t90 * t339 * t1054
  t1124 = t429 * t90 * t333 * t1054
  t1140 = tau1 / t299 / t317 * t312
  t1142 = t845 * t853
  t1148 = f.my_piecewise3(t309, -s2 / t317 * t305 / 0.4e1, 0)
  t1150 = t302 * t46 * t1148
  t1156 = t315 / t298 / t856 / r1 * t322
  t1159 = t859 * t65 * t864
  t1161 = t852 ** 2
  t1163 = t320 * t68 * t1161
  t1166 = t862 * t863 * t1148
  t1179 = t877 ** 2
  t1195 = (t35 * (0.24691358024691358024691358024691358024691358024692e0 * t1140 - 0.18518518518518518518518518518518518518518518518519e0 * t1142 + 0.55555555555555555555555555555555555555555555555556e-1 * t1150 - 0.50354537037037037037037037037037037037037037037038e2 * t1156 + 0.46481111111111111111111111111111111111111111111111e2 * t1159 - 0.69721666666666666666666666666666666666666666666666e1 * t1163 - 0.69721666666666666666666666666666666666666666666666e1 * t1166) * t329 / 0.6e1 - t35 * t867 * t871 * t877 / 0.3e1 + t35 * t325 / t870 / t328 * t1179 / 0.3e1 - t35 * t872 * (0.49382716049382716049382716049382716049382716049381e1 * t1140 - 0.37037037037037037037037037037037037037037037037036e1 * t1142 + 0.11111111111111111111111111111111111111111111111111e1 * t1150 + 0.16784845679012345679012345679012345679012345679013e2 * t1156 - 0.15493703703703703703703703703703703703703703703704e2 * t1159 + 0.23240555555555555555555555555555555555555555555556e1 * t1163 + 0.23240555555555555555555555555555555555555555555556e1 * t1166) / 0.6e1) * t883
  t1197 = t1195 * t870 * t900
  t1202 = 0.13e2 / 0.240e3 * t1115 * t1081 + 0.283e3 / 0.960e3 * t1115 * t1071 - 0.13e2 / 0.80e2 * t1115 * t1088 + t1124 * t1081 / 0.32e2 + 0.7e1 / 0.64e2 * t1124 * t1071 - 0.3e1 / 0.32e2 * t1124 * t1088 - 0.3275e4 / 0.8064e4 * t1093 * t1071 + 0.67e2 / 0.384e3 * t1093 * t1088 + 0.13e2 / 0.210e3 * t1098 * t1081 + t904 * t1197 / 0.128e3 - 0.13e2 / 0.1440e4 * t907 * t1197
  t1214 = t158 * t95 * t339 * t881
  t1219 = t883 * t328 * t889 * t922 * t898 * t877
  t1232 = 0.9e1 / 0.16e2 * t333 * t32 * t238 * t881 * t883 * t924 - 0.27e2 / 0.32e2 * t925
  t1235 = t883 * t870 * t889 * t892 * t1067 * t898 * t1232
  t1240 = t158 * t95 * t333 * t881
  t1247 = t158 * t95 * t335 * t881
  t1249 = 0.1e1 / t882 / t325
  t1254 = t1249 * t870 * t889 * t922 * t898 * t867
  t1261 = 0.67e2 / 0.6912e4 * t910 * t1197 - 0.13e2 / 0.1260e4 * t913 * t1197 + 0.1811e4 / 0.165888e6 * t916 * t1197 - t842 * t1197 / 0.192e3 - 0.13e2 / 0.720e3 * t1214 * t1219 + 0.13e2 / 0.1440e4 * t1214 * t1235 - t1240 * t1219 / 0.96e2 + t1240 * t1235 / 0.192e3 - t1247 * t1254 / 0.64e2 + t1247 * t1219 / 0.64e2 - t1247 * t1235 / 0.128e3
  t1266 = t158 * t95 * t347 * t881
  t1271 = t158 * t95 * t351 * t881
  t1280 = t158 * t95 * t343 * t881
  t1293 = t1240 * t1254 / 0.96e2 + 0.13e2 / 0.1260e4 * t1266 * t1235 - 0.1811e4 / 0.82944e5 * t1271 * t1254 + 0.1811e4 / 0.82944e5 * t1271 * t1219 - 0.1811e4 / 0.165888e6 * t1271 * t1235 - 0.67e2 / 0.3456e4 * t1280 * t1254 + 0.67e2 / 0.3456e4 * t1280 * t1219 - 0.67e2 / 0.6912e4 * t1280 * t1235 + 0.13e2 / 0.630e3 * t1266 * t1254 - 0.13e2 / 0.630e3 * t1266 * t1219 + 0.13e2 / 0.720e3 * t1214 * t1254
  t1313 = t690 * t1054 * t1058
  t1318 = t1059 * t1062
  t1332 = f.my_piecewise3(t360, 0.9e1 / 0.32e2 * t239 * t1195 * t924 - 0.9e1 / 0.16e2 * t239 * t881 * t1249 * t870 * t893 * t899 * t867 + 0.9e1 / 0.16e2 * t239 * t884 * t328 * t893 * t899 * t877 - 0.27e2 / 0.512e3 * t1313 * t1059 * t1079 * t1070 + 0.27e2 / 0.512e3 * t1313 * t1318 * t1070 - 0.9e1 / 0.32e2 * t239 * t885 * t893 * t1067 * t898 * t1232 + 0.81e2 / 0.512e3 * t1313 * t1318 * t1087, 0)
  t1337 = t927 ** 2
  t1338 = t1337 * t363
  t1372 = t363 * t939
  t1395 = t373 ** 2
  t1407 = -t92 * t1332 * t363 * t376 / 0.108e3 - t92 * t1338 * t376 / 0.324e3 - t92 * t928 * t941 / 0.54e2 + t92 * t1338 * t370 * t946 * t375 / 0.54e2 + t92 * t1338 * t372 * t953 / 0.162e3 - t121 * t364 * (t1332 * t365 * t368 - t1337 * t365 * t368 + 0.2e1 * t932 * t937 - t365 * (0.2e1 * t361 * t1332 + 0.5e1 * t1332 + 0.2e1 * t1337)) * t371 * t375 / 0.36e2 + t92 * t1372 * t948 / 0.18e2 + t92 * t1372 * t955 / 0.54e2 - t92 * t945 / t366 / t361 * t375 * t1337 / 0.18e2 - t92 * t945 * t946 * t953 * t1337 / 0.54e2 + t92 * t945 * t947 * t1332 / 0.36e2 - t92 * t945 * t371 / t374 / t1395 * t1337 / 0.81e2 + t92 * t945 * t954 * t1332 / 0.108e3
  t1408 = f.my_piecewise3(t334, -0.3e1 / 0.64e2 * t428 * t95 * t1054 * t1071 - 0.1811e4 / 0.27648e5 * t1076 * t1081 + 0.1811e4 / 0.27648e5 * t1076 * t1071 + 0.1811e4 / 0.9216e4 * t1076 * t1088 - 0.67e2 / 0.1152e4 * t1093 * t1081 + 0.56729e5 / 0.107520e6 * t1098 * t1071 - 0.13e2 / 0.70e2 * t1098 * t1088 - 0.3e1 / 0.64e2 * t1105 * t1081 - 0.63e2 / 0.320e3 * t1105 * t1071 + 0.9e1 / 0.64e2 * t1105 * t1088 + t1202 + t1261 + t1293, t1407)
  t1413 = f.my_piecewise3(t287, 0, 0.3e1 / 0.16e2 * t5 * t1044 * t30 * t380 + t1004 / 0.8e1 + 0.3e1 / 0.8e1 * t5 * t836 * t960 - t815 + t1011 / 0.8e1 + 0.3e1 / 0.16e2 * t5 * t840 * t1408)
  d22 = 0.2e1 * t830 + 0.2e1 * t965 + t6 * (t1035 + t1413)
  res = {'v2rho2': jnp.stack([d11, d12, d22], axis=-1) if 'd12' in locals() else d11}
  return res

