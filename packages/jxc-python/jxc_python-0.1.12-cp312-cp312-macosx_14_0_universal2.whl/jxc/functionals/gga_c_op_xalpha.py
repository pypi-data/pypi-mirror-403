"""Generated from gga_c_op_xalpha.mpl."""

import jax
import jax.lax as lax
import jax.numpy as jnp
import numpy as np
from jax.numpy import array as array
from jax.numpy import int32 as int32
from jax.numpy import nan as nan
from typing import Callable, Optional
from jxc.functionals.utils import *

def pol(p, r, s=(None, None, None), l=(None, None), tau=(None, None)):
  f = funcs(p)
  params = f.params
  (r0, r1), (s0, s1, s2), (l0, l1), (tau0, tau1) = r, s, l, tau
  op_a1 = 1.5214

  op_a2 = 0.5764

  op_b1 = 1.1284

  op_b2 = 0.3183

  op_qab = 2.5654

  op_enhancement = lambda xs=None: 1

  op_b88_zab = lambda f_x, rs, z, xs0, xs1: f.my_piecewise3(b88_zab(f, params, 1, op_enhancement, rs, z, xs0, xs1) == 0, DBL_EPSILON, b88_zab(f, params, 1, op_enhancement, rs, z, xs0, xs1))

  op_beta = lambda rs, z, xs0, xs1: op_qab / op_b88_zab(op_enhancement, rs, z, xs0, xs1)

  op_f_s = lambda rs, z, xt, xs0, xs1: -(1 - z ** 2) * f.n_total(rs) / 4.0 * (op_a1 * op_beta(rs, z, xs0, xs1) + op_a2) / (op_beta(rs, z, xs0, xs1) ** 4 + op_b1 * op_beta(rs, z, xs0, xs1) ** 3 + op_b2 * op_beta(rs, z, xs0, xs1) ** 2)

  op_f = lambda rs, z, xt, xs0, xs1: f.my_piecewise3(jnp.logical_or(1 - jnp.abs(z) <= f.p.zeta_threshold, jnp.logical_and(f.screen_dens(rs, z), f.screen_dens(rs, -z))), 0, op_f_s(rs, f.z_thr(z), xt, xs0, xs1))

  functional_body = lambda rs, z, xt, xs0, xs1: op_f(rs, z, xt, xs0, xs1)

  res = functional_body(
      f.r_ws(f.dens(r0, r1)),
      f.zeta(r0, r1),
      f.xt(r0, r1, s0, s1, s2),
      f.xs0(r0, r1, s0, s2),
      f.xs1(r0, r1, s0, s2),
  )
  return res

def unpol(p, r, s=None, l=None, tau=None):
  f = funcs(p)
  params = f.params
  r0, s0, l0, tau0 = r, s, l, tau
  op_a1 = 1.5214

  op_a2 = 0.5764

  op_b1 = 1.1284

  op_b2 = 0.3183

  op_qab = 2.5654

  op_enhancement = lambda xs=None: 1

  op_b88_zab = lambda f_x, rs, z, xs0, xs1: f.my_piecewise3(b88_zab(f, params, 1, op_enhancement, rs, z, xs0, xs1) == 0, DBL_EPSILON, b88_zab(f, params, 1, op_enhancement, rs, z, xs0, xs1))

  op_beta = lambda rs, z, xs0, xs1: op_qab / op_b88_zab(op_enhancement, rs, z, xs0, xs1)

  op_f_s = lambda rs, z, xt, xs0, xs1: -(1 - z ** 2) * f.n_total(rs) / 4.0 * (op_a1 * op_beta(rs, z, xs0, xs1) + op_a2) / (op_beta(rs, z, xs0, xs1) ** 4 + op_b1 * op_beta(rs, z, xs0, xs1) ** 3 + op_b2 * op_beta(rs, z, xs0, xs1) ** 2)

  op_f = lambda rs, z, xt, xs0, xs1: f.my_piecewise3(jnp.logical_or(1 - jnp.abs(z) <= f.p.zeta_threshold, jnp.logical_and(f.screen_dens(rs, z), f.screen_dens(rs, -z))), 0, op_f_s(rs, f.z_thr(z), xt, xs0, xs1))

  functional_body = lambda rs, z, xt, xs0, xs1: op_f(rs, z, xt, xs0, xs1)

  res = functional_body(
      f.r_ws(f.dens(r0 / 2, r0 / 2)),
      f.zeta(r0 / 2, r0 / 2),
      f.xt(r0 / 2, r0 / 2, s0 / 4, s0 / 4, s0 / 4),
      f.xs0(r0 / 2, r0 / 2, s0 / 4, s0 / 4),
      f.xs1(r0 / 2, r0 / 2, s0 / 4, s0 / 4),
  )
  return res

def pol_vxc(p, r, s=(None, None, None), l=(None, None), tau=(None, None)):
  f = funcs(p)
  params = f.params
  (r0, r1), (s0, s1, s2), (l0, l1), (tau0, tau1) = r, s, l, tau
  op_a1 = 1.5214

  op_a2 = 0.5764

  op_b1 = 1.1284

  op_b2 = 0.3183

  op_qab = 2.5654

  op_enhancement = lambda xs=None: 1

  op_b88_zab = lambda f_x, rs, z, xs0, xs1: f.my_piecewise3(b88_zab(f, params, 1, op_enhancement, rs, z, xs0, xs1) == 0, DBL_EPSILON, b88_zab(f, params, 1, op_enhancement, rs, z, xs0, xs1))

  op_beta = lambda rs, z, xs0, xs1: op_qab / op_b88_zab(op_enhancement, rs, z, xs0, xs1)

  op_f_s = lambda rs, z, xt, xs0, xs1: -(1 - z ** 2) * f.n_total(rs) / 4.0 * (op_a1 * op_beta(rs, z, xs0, xs1) + op_a2) / (op_beta(rs, z, xs0, xs1) ** 4 + op_b1 * op_beta(rs, z, xs0, xs1) ** 3 + op_b2 * op_beta(rs, z, xs0, xs1) ** 2)

  op_f = lambda rs, z, xt, xs0, xs1: f.my_piecewise3(jnp.logical_or(1 - jnp.abs(z) <= f.p.zeta_threshold, jnp.logical_and(f.screen_dens(rs, z), f.screen_dens(rs, -z))), 0, op_f_s(rs, f.z_thr(z), xt, xs0, xs1))

  functional_body = lambda rs, z, xt, xs0, xs1: op_f(rs, z, xt, xs0, xs1)

  t1 = r0 - r1
  t2 = r0 + r1
  t3 = 0.1e1 / t2
  t4 = t1 * t3
  t5 = abs(t4)
  t11 = 0.1e1 - t5 <= f.p.zeta_threshold or r0 <= f.p.dens_threshold and r1 <= f.p.dens_threshold
  t13 = 0.1e1 + t4 <= f.p.zeta_threshold
  t14 = f.p.zeta_threshold - 0.1e1
  t16 = 0.1e1 - t4 <= f.p.zeta_threshold
  t17 = -t14
  t18 = f.my_piecewise5(t13, t14, t16, t17, t4)
  t19 = t18 ** 2
  t20 = 0.1e1 - t19
  t21 = t20 * t2
  t24 = 0.2e1 * r0 * t3 <= f.p.zeta_threshold
  t27 = 0.2e1 * r1 * t3 <= f.p.zeta_threshold
  t28 = f.my_piecewise5(t24, t14, t27, t17, t4)
  t29 = 0.1e1 + t28
  t32 = t29 * t2 / 0.2e1 <= f.p.dens_threshold
  t33 = 3 ** (0.1e1 / 0.3e1)
  t34 = t33 ** 2
  t36 = (0.1e1 / jnp.pi) ** (0.1e1 / 0.3e1)
  t38 = t34 / t36
  t39 = 4 ** (0.1e1 / 0.3e1)
  t40 = 2 ** (0.1e1 / 0.3e1)
  t41 = t39 * t40
  t42 = t29 <= f.p.zeta_threshold
  t43 = 0.1e1 - t28
  t44 = t43 <= f.p.zeta_threshold
  t45 = f.my_piecewise5(t42, t14, t44, t17, t28)
  t47 = (0.1e1 + t45) * t2
  t48 = t47 ** (0.1e1 / 0.3e1)
  t53 = f.my_piecewise3(t32, 0, t38 * t41 / t48 / 0.9e1)
  t57 = t43 * t2 / 0.2e1 <= f.p.dens_threshold
  t58 = f.my_piecewise5(t44, t14, t42, t17, -t28)
  t60 = (0.1e1 + t58) * t2
  t61 = t60 ** (0.1e1 / 0.3e1)
  t66 = f.my_piecewise3(t57, 0, t38 * t41 / t61 / 0.9e1)
  t67 = t53 + t66
  t68 = t67 == 0.0e0
  t69 = f.my_piecewise3(t68, DBL_EPSILON, t67)
  t72 = 0.390299956e1 / t69 + 0.5764e0
  t73 = t69 ** 2
  t74 = t73 ** 2
  t75 = 0.1e1 / t74
  t78 = 0.1e1 / t73 / t69
  t80 = 0.1e1 / t73
  t82 = 0.433132090567376656e2 * t75 + 0.190514637481962976e2 * t78 + 0.2094820520028e1 * t80
  t83 = 0.1e1 / t82
  t87 = f.my_piecewise3(t11, 0, -0.25000000000000000000000000000000000000000000000000e0 * t21 * t72 * t83)
  t88 = t2 ** 2
  t90 = t1 / t88
  t91 = t3 - t90
  t92 = f.my_piecewise5(t13, 0, t16, 0, t91)
  t95 = t2 * t72 * t83
  t100 = 0.25000000000000000000000000000000000000000000000000e0 * t20 * t72 * t83
  t101 = t38 * t39
  t104 = t40 / t48 / t47
  t105 = f.my_piecewise5(t24, 0, t27, 0, t91)
  t106 = f.my_piecewise5(t42, 0, t44, 0, t105)
  t112 = f.my_piecewise3(t32, 0, -t101 * t104 * (t106 * t2 + t45 + 0.1e1) / 0.27e2)
  t115 = t40 / t61 / t60
  t116 = f.my_piecewise5(t44, 0, t42, 0, -t105)
  t122 = f.my_piecewise3(t57, 0, -t101 * t115 * (t116 * t2 + t58 + 0.1e1) / 0.27e2)
  t124 = f.my_piecewise3(t68, 0, t112 + t122)
  t129 = t82 ** 2
  t131 = t72 / t129
  t133 = 0.1e1 / t74 / t69
  t145 = f.my_piecewise3(t11, 0, 0.50000000000000000000000000000000000000000000000000e0 * t18 * t92 * t95 - t100 + 0.97574989000000000000000000000000000000000000000000e0 * t21 * t80 * t124 * t83 + 0.25000000000000000000000000000000000000000000000000e0 * t21 * t131 * (-0.1732528362269506624e3 * t133 * t124 - 0.571543912445888928e2 * t75 * t124 - 0.4189641040056e1 * t78 * t124))
  vrho_0_ = t2 * t145 + t87
  t147 = -t3 - t90
  t148 = f.my_piecewise5(t13, 0, t16, 0, t147)
  t152 = f.my_piecewise5(t24, 0, t27, 0, t147)
  t153 = f.my_piecewise5(t42, 0, t44, 0, t152)
  t159 = f.my_piecewise3(t32, 0, -t101 * t104 * (t153 * t2 + t45 + 0.1e1) / 0.27e2)
  t160 = f.my_piecewise5(t44, 0, t42, 0, -t152)
  t166 = f.my_piecewise3(t57, 0, -t101 * t115 * (t160 * t2 + t58 + 0.1e1) / 0.27e2)
  t168 = f.my_piecewise3(t68, 0, t159 + t166)
  t184 = f.my_piecewise3(t11, 0, 0.50000000000000000000000000000000000000000000000000e0 * t18 * t148 * t95 - t100 + 0.97574989000000000000000000000000000000000000000000e0 * t21 * t80 * t168 * t83 + 0.25000000000000000000000000000000000000000000000000e0 * t21 * t131 * (-0.1732528362269506624e3 * t133 * t168 - 0.571543912445888928e2 * t75 * t168 - 0.4189641040056e1 * t78 * t168))
  vrho_1_ = t2 * t184 + t87
  vsigma_0_ = 0.0e0
  vsigma_1_ = 0.0e0
  vsigma_2_ = 0.0e0
  _b = lambda x: (jnp.asarray(x) + jnp.zeros_like(r0))
  vrho_0_ = _b(vrho_0_)
  vrho_1_ = _b(vrho_1_)
  vsigma_0_ = _b(vsigma_0_)
  vsigma_1_ = _b(vsigma_1_)
  vsigma_2_ = _b(vsigma_2_)
  res = {'vrho': jnp.stack([vrho_0_, vrho_1_], axis=-1), 'vsigma': jnp.stack([vsigma_0_, vsigma_1_, vsigma_2_], axis=-1)}
  return res

def unpol_vxc(p, r, s=None, l=None, tau=None):
  f = funcs(p)
  params = f.params
  r0, s0, l0, tau0 = r, s, l, tau
  op_a1 = 1.5214

  op_a2 = 0.5764

  op_b1 = 1.1284

  op_b2 = 0.3183

  op_qab = 2.5654

  op_enhancement = lambda xs=None: 1

  op_b88_zab = lambda f_x, rs, z, xs0, xs1: f.my_piecewise3(b88_zab(f, params, 1, op_enhancement, rs, z, xs0, xs1) == 0, DBL_EPSILON, b88_zab(f, params, 1, op_enhancement, rs, z, xs0, xs1))

  op_beta = lambda rs, z, xs0, xs1: op_qab / op_b88_zab(op_enhancement, rs, z, xs0, xs1)

  op_f_s = lambda rs, z, xt, xs0, xs1: -(1 - z ** 2) * f.n_total(rs) / 4.0 * (op_a1 * op_beta(rs, z, xs0, xs1) + op_a2) / (op_beta(rs, z, xs0, xs1) ** 4 + op_b1 * op_beta(rs, z, xs0, xs1) ** 3 + op_b2 * op_beta(rs, z, xs0, xs1) ** 2)

  op_f = lambda rs, z, xt, xs0, xs1: f.my_piecewise3(jnp.logical_or(1 - jnp.abs(z) <= f.p.zeta_threshold, jnp.logical_and(f.screen_dens(rs, z), f.screen_dens(rs, -z))), 0, op_f_s(rs, f.z_thr(z), xt, xs0, xs1))

  functional_body = lambda rs, z, xt, xs0, xs1: op_f(rs, z, xt, xs0, xs1)

  t1 = 0.1e1 <= f.p.zeta_threshold
  t4 = t1 or r0 / 0.2e1 <= f.p.dens_threshold
  t5 = f.p.zeta_threshold - 0.1e1
  t6 = -t5
  t7 = f.my_piecewise5(t1, t5, t1, t6, 0)
  t8 = t7 ** 2
  t9 = 0.1e1 - t8
  t10 = t9 * r0
  t11 = 0.1e1 + t7
  t14 = t11 * r0 / 0.2e1 <= f.p.dens_threshold
  t15 = 3 ** (0.1e1 / 0.3e1)
  t16 = t15 ** 2
  t18 = (0.1e1 / jnp.pi) ** (0.1e1 / 0.3e1)
  t20 = t16 / t18
  t21 = 4 ** (0.1e1 / 0.3e1)
  t22 = 2 ** (0.1e1 / 0.3e1)
  t23 = t21 * t22
  t24 = t11 <= f.p.zeta_threshold
  t25 = 0.1e1 - t7
  t26 = t25 <= f.p.zeta_threshold
  t27 = f.my_piecewise5(t24, t5, t26, t6, t7)
  t28 = 0.1e1 + t27
  t29 = t28 * r0
  t30 = t29 ** (0.1e1 / 0.3e1)
  t35 = f.my_piecewise3(t14, 0, t20 * t23 / t30 / 0.9e1)
  t39 = t25 * r0 / 0.2e1 <= f.p.dens_threshold
  t40 = f.my_piecewise5(t26, t5, t24, t6, -t7)
  t41 = 0.1e1 + t40
  t42 = t41 * r0
  t43 = t42 ** (0.1e1 / 0.3e1)
  t48 = f.my_piecewise3(t39, 0, t20 * t23 / t43 / 0.9e1)
  t49 = t35 + t48
  t50 = t49 == 0.0e0
  t51 = f.my_piecewise3(t50, DBL_EPSILON, t49)
  t54 = 0.390299956e1 / t51 + 0.5764e0
  t55 = t51 ** 2
  t56 = t55 ** 2
  t57 = 0.1e1 / t56
  t60 = 0.1e1 / t55 / t51
  t62 = 0.1e1 / t55
  t64 = 0.433132090567376656e2 * t57 + 0.190514637481962976e2 * t60 + 0.2094820520028e1 * t62
  t65 = 0.1e1 / t64
  t69 = f.my_piecewise3(t4, 0, -0.25000000000000000000000000000000000000000000000000e0 * t10 * t54 * t65)
  t73 = t20 * t21
  t80 = f.my_piecewise3(t14, 0, -t73 * t22 / t30 / t29 * t28 / 0.27e2)
  t87 = f.my_piecewise3(t39, 0, -t73 * t22 / t43 / t42 * t41 / 0.27e2)
  t89 = f.my_piecewise3(t50, 0, t80 + t87)
  t94 = t64 ** 2
  t110 = f.my_piecewise3(t4, 0, -0.25000000000000000000000000000000000000000000000000e0 * t9 * t54 * t65 + 0.97574989000000000000000000000000000000000000000000e0 * t10 * t62 * t89 * t65 + 0.25000000000000000000000000000000000000000000000000e0 * t10 * t54 / t94 * (-0.1732528362269506624e3 / t56 / t51 * t89 - 0.571543912445888928e2 * t57 * t89 - 0.4189641040056e1 * t60 * t89))
  vrho_0_ = r0 * t110 + t69
  vsigma_0_ = 0.0e0
  _b = lambda x: (jnp.asarray(x) + jnp.zeros_like(r0))
  vrho_0_ = _b(vrho_0_)
  vsigma_0_ = _b(vsigma_0_)
  res = {'vrho': vrho_0_, 'vsigma': vsigma_0_}
  return res

def unpol_fxc(p, r, s=None, l=None, tau=None):
  f = funcs(p)
  params = f.params
  r0, s0, l0, tau0 = r, s, l, tau
  
  t1 = 0.1e1 <= f.p.zeta_threshold
  t4 = t1 or r0 / 0.2e1 <= f.p.dens_threshold
  t5 = f.p.zeta_threshold - 0.1e1
  t6 = -t5
  t7 = f.my_piecewise5(t1, t5, t1, t6, 0)
  t8 = t7 ** 2
  t9 = 0.1e1 - t8
  t10 = 0.1e1 + t7
  t13 = t10 * r0 / 0.2e1 <= f.p.dens_threshold
  t14 = 3 ** (0.1e1 / 0.3e1)
  t15 = t14 ** 2
  t17 = (0.1e1 / jnp.pi) ** (0.1e1 / 0.3e1)
  t19 = t15 / t17
  t20 = 4 ** (0.1e1 / 0.3e1)
  t21 = 2 ** (0.1e1 / 0.3e1)
  t22 = t20 * t21
  t23 = t10 <= f.p.zeta_threshold
  t24 = 0.1e1 - t7
  t25 = t24 <= f.p.zeta_threshold
  t26 = f.my_piecewise5(t23, t5, t25, t6, t7)
  t27 = 0.1e1 + t26
  t28 = t27 * r0
  t29 = t28 ** (0.1e1 / 0.3e1)
  t34 = f.my_piecewise3(t13, 0, t19 * t22 / t29 / 0.9e1)
  t38 = t24 * r0 / 0.2e1 <= f.p.dens_threshold
  t39 = f.my_piecewise5(t25, t5, t23, t6, -t7)
  t40 = 0.1e1 + t39
  t41 = t40 * r0
  t42 = t41 ** (0.1e1 / 0.3e1)
  t47 = f.my_piecewise3(t38, 0, t19 * t22 / t42 / 0.9e1)
  t48 = t34 + t47
  t49 = t48 == 0.0e0
  t50 = f.my_piecewise3(t49, DBL_EPSILON, t48)
  t53 = 0.390299956e1 / t50 + 0.5764e0
  t54 = t9 * t53
  t55 = t50 ** 2
  t56 = t55 ** 2
  t57 = 0.1e1 / t56
  t60 = 0.1e1 / t55 / t50
  t62 = 0.1e1 / t55
  t64 = 0.433132090567376656e2 * t57 + 0.190514637481962976e2 * t60 + 0.2094820520028e1 * t62
  t65 = 0.1e1 / t64
  t68 = t9 * r0
  t69 = t19 * t20
  t76 = f.my_piecewise3(t13, 0, -t69 * t21 / t29 / t28 * t27 / 0.27e2)
  t83 = f.my_piecewise3(t38, 0, -t69 * t21 / t42 / t41 * t40 / 0.27e2)
  t85 = f.my_piecewise3(t49, 0, t76 + t83)
  t90 = t64 ** 2
  t91 = 0.1e1 / t90
  t92 = t53 * t91
  t94 = 0.1e1 / t56 / t50
  t101 = -0.1732528362269506624e3 * t94 * t85 - 0.571543912445888928e2 * t57 * t85 - 0.4189641040056e1 * t60 * t85
  t106 = f.my_piecewise3(t4, 0, -0.25000000000000000000000000000000000000000000000000e0 * t54 * t65 + 0.97574989000000000000000000000000000000000000000000e0 * t68 * t62 * t85 * t65 + 0.25000000000000000000000000000000000000000000000000e0 * t68 * t92 * t101)
  t115 = t85 ** 2
  t120 = t27 ** 2
  t121 = r0 ** 2
  t129 = f.my_piecewise3(t13, 0, 0.4e1 / 0.81e2 * t69 * t21 / t29 / t121)
  t130 = t40 ** 2
  t138 = f.my_piecewise3(t38, 0, 0.4e1 / 0.81e2 * t69 * t21 / t42 / t121)
  t140 = f.my_piecewise3(t49, 0, t129 + t138)
  t153 = t101 ** 2
  t176 = f.my_piecewise3(t4, 0, 0.19514997800000000000000000000000000000000000000000e1 * t9 * t62 * t85 * t65 + 0.50000000000000000000000000000000000000000000000000e0 * t54 * t91 * t101 - 0.19514997800000000000000000000000000000000000000000e1 * t68 * t60 * t115 * t65 + 0.97574989000000000000000000000000000000000000000000e0 * t68 * t62 * t140 * t65 - 0.19514997800000000000000000000000000000000000000000e1 * t68 * t62 * t85 * t91 * t101 - 0.50000000000000000000000000000000000000000000000000e0 * t68 * t53 / t90 / t64 * t153 + 0.25000000000000000000000000000000000000000000000000e0 * t68 * t92 * (0.8662641811347533120e3 / t56 / t55 * t115 - 0.1732528362269506624e3 * t94 * t140 + 0.2286175649783555712e3 * t94 * t115 - 0.571543912445888928e2 * t57 * t140 + 0.12568923120168e2 * t57 * t115 - 0.4189641040056e1 * t60 * t140))
  v2rho2_0_ = r0 * t176 + 0.2e1 * t106
  v2rhosigma_0_ = 0.0e0
  v2sigma2_0_ = 0.0e0
  res = {'v2rho2': v2rho2_0_, 'v2rhosigma': v2rhosigma_0_, 'v2sigma2': v2sigma2_0_}
  return res

def unpol_kxc(p, r, s=None, l=None, tau=None):
  f = funcs(p)
  params = f.params
  r0, s0, l0, tau0 = r, s, l, tau

  t1 = 0.1e1 <= f.p.zeta_threshold
  t4 = t1 or r0 / 0.2e1 <= f.p.dens_threshold
  t5 = f.p.zeta_threshold - 0.1e1
  t6 = -t5
  t7 = f.my_piecewise5(t1, t5, t1, t6, 0)
  t8 = t7 ** 2
  t9 = 0.1e1 - t8
  t10 = 0.1e1 + t7
  t13 = t10 * r0 / 0.2e1 <= f.p.dens_threshold
  t14 = 3 ** (0.1e1 / 0.3e1)
  t15 = t14 ** 2
  t17 = (0.1e1 / jnp.pi) ** (0.1e1 / 0.3e1)
  t19 = t15 / t17
  t20 = 4 ** (0.1e1 / 0.3e1)
  t21 = 2 ** (0.1e1 / 0.3e1)
  t22 = t20 * t21
  t23 = t10 <= f.p.zeta_threshold
  t24 = 0.1e1 - t7
  t25 = t24 <= f.p.zeta_threshold
  t26 = f.my_piecewise5(t23, t5, t25, t6, t7)
  t27 = 0.1e1 + t26
  t28 = t27 * r0
  t29 = t28 ** (0.1e1 / 0.3e1)
  t34 = f.my_piecewise3(t13, 0, t19 * t22 / t29 / 0.9e1)
  t38 = t24 * r0 / 0.2e1 <= f.p.dens_threshold
  t39 = f.my_piecewise5(t25, t5, t23, t6, -t7)
  t40 = 0.1e1 + t39
  t41 = t40 * r0
  t42 = t41 ** (0.1e1 / 0.3e1)
  t47 = f.my_piecewise3(t38, 0, t19 * t22 / t42 / 0.9e1)
  t48 = t34 + t47
  t49 = t48 == 0.0e0
  t50 = f.my_piecewise3(t49, DBL_EPSILON, t48)
  t51 = t50 ** 2
  t52 = 0.1e1 / t51
  t53 = t9 * t52
  t54 = t19 * t20
  t61 = f.my_piecewise3(t13, 0, -t54 * t21 / t29 / t28 * t27 / 0.27e2)
  t68 = f.my_piecewise3(t38, 0, -t54 * t21 / t42 / t41 * t40 / 0.27e2)
  t70 = f.my_piecewise3(t49, 0, t61 + t68)
  t71 = t51 ** 2
  t72 = 0.1e1 / t71
  t74 = t51 * t50
  t75 = 0.1e1 / t74
  t78 = 0.433132090567376656e2 * t72 + 0.190514637481962976e2 * t75 + 0.2094820520028e1 * t52
  t79 = 0.1e1 / t78
  t80 = t70 * t79
  t85 = 0.390299956e1 / t50 + 0.5764e0
  t86 = t9 * t85
  t87 = t78 ** 2
  t88 = 0.1e1 / t87
  t90 = 0.1e1 / t71 / t50
  t91 = t90 * t70
  t93 = t72 * t70
  t97 = -0.1732528362269506624e3 * t91 - 0.571543912445888928e2 * t93 - 0.4189641040056e1 * t75 * t70
  t101 = t9 * r0
  t102 = t70 ** 2
  t107 = t27 ** 2
  t108 = r0 ** 2
  t116 = f.my_piecewise3(t13, 0, 0.4e1 / 0.81e2 * t54 * t21 / t29 / t108)
  t117 = t40 ** 2
  t125 = f.my_piecewise3(t38, 0, 0.4e1 / 0.81e2 * t54 * t21 / t42 / t108)
  t127 = f.my_piecewise3(t49, 0, t116 + t125)
  t132 = t101 * t52
  t133 = t70 * t88
  t134 = t133 * t97
  t138 = 0.1e1 / t87 / t78
  t140 = t97 ** 2
  t144 = t85 * t88
  t146 = 0.1e1 / t71 / t51
  t159 = 0.8662641811347533120e3 * t146 * t102 - 0.1732528362269506624e3 * t90 * t127 + 0.2286175649783555712e3 * t90 * t102 - 0.571543912445888928e2 * t72 * t127 + 0.12568923120168e2 * t72 * t102 - 0.4189641040056e1 * t75 * t127
  t164 = f.my_piecewise3(t4, 0, 0.19514997800000000000000000000000000000000000000000e1 * t53 * t80 + 0.50000000000000000000000000000000000000000000000000e0 * t86 * t88 * t97 - 0.19514997800000000000000000000000000000000000000000e1 * t101 * t75 * t102 * t79 + 0.97574989000000000000000000000000000000000000000000e0 * t101 * t52 * t127 * t79 - 0.19514997800000000000000000000000000000000000000000e1 * t132 * t134 - 0.50000000000000000000000000000000000000000000000000e0 * t101 * t85 * t138 * t140 + 0.25000000000000000000000000000000000000000000000000e0 * t101 * t144 * t159)
  t170 = t107 * t27
  t171 = t108 * r0
  t179 = f.my_piecewise3(t13, 0, -0.28e2 / 0.243e3 * t54 * t21 / t29 / t171)
  t180 = t117 * t40
  t188 = f.my_piecewise3(t38, 0, -0.28e2 / 0.243e3 * t54 * t21 / t42 / t171)
  t190 = f.my_piecewise3(t49, 0, t179 + t188)
  t197 = t102 * t70
  t240 = t101 * t75
  t255 = t87 ** 2
  t267 = 0.58544993400000000000000000000000000000000000000000e1 * t132 * t70 * t138 * t140 + 0.97574989000000000000000000000000000000000000000000e0 * t101 * t52 * t190 * t79 + 0.25000000000000000000000000000000000000000000000000e0 * t101 * t144 * (-0.51975850868085198720e4 / t71 / t74 * t197 + 0.25987925434042599360e4 * t146 * t70 * t127 - 0.1732528362269506624e3 * t90 * t190 - 0.11430878248917778560e4 * t146 * t197 + 0.6858526949350667136e3 * t91 * t127 - 0.571543912445888928e2 * t72 * t190 - 0.50275692480672e2 * t90 * t197 + 0.37706769360504e2 * t93 * t127 - 0.4189641040056e1 * t75 * t190) - 0.58544993400000000000000000000000000000000000000000e1 * t9 * t75 * t102 * t79 - 0.58544993400000000000000000000000000000000000000000e1 * t53 * t134 - 0.15000000000000000000000000000000000000000000000000e1 * t86 * t138 * t140 + 0.29272496700000000000000000000000000000000000000000e1 * t53 * t127 * t79 + 0.75000000000000000000000000000000000000000000000000e0 * t86 * t88 * t159 + 0.58544993400000000000000000000000000000000000000000e1 * t101 * t72 * t197 * t79 - 0.58544993400000000000000000000000000000000000000000e1 * t240 * t80 * t127 + 0.58544993400000000000000000000000000000000000000000e1 * t240 * t102 * t88 * t97 - 0.29272496700000000000000000000000000000000000000000e1 * t132 * t127 * t88 * t97 - 0.29272496700000000000000000000000000000000000000000e1 * t132 * t133 * t159 + 0.15000000000000000000000000000000000000000000000000e1 * t101 * t85 / t255 * t140 * t97 - 0.15000000000000000000000000000000000000000000000000e1 * t101 * t85 * t138 * t97 * t159
  t268 = f.my_piecewise3(t4, 0, t267)
  v3rho3_0_ = r0 * t268 + 0.3e1 * t164

  res = {'v3rho3': v3rho3_0_}
  return res

def unpol_lxc(p, r, s=None, l=None, tau=None):
  f = funcs(p)
  params = f.params
  r0, s0, l0, tau0 = r, s, l, tau

  t1 = 0.1e1 <= f.p.zeta_threshold
  t4 = t1 or r0 / 0.2e1 <= f.p.dens_threshold
  t5 = f.p.zeta_threshold - 0.1e1
  t6 = -t5
  t7 = f.my_piecewise5(t1, t5, t1, t6, 0)
  t8 = t7 ** 2
  t9 = 0.1e1 - t8
  t10 = t9 * r0
  t11 = 0.1e1 + t7
  t14 = t11 * r0 / 0.2e1 <= f.p.dens_threshold
  t15 = 3 ** (0.1e1 / 0.3e1)
  t16 = t15 ** 2
  t18 = (0.1e1 / jnp.pi) ** (0.1e1 / 0.3e1)
  t20 = t16 / t18
  t21 = 4 ** (0.1e1 / 0.3e1)
  t22 = 2 ** (0.1e1 / 0.3e1)
  t23 = t21 * t22
  t24 = t11 <= f.p.zeta_threshold
  t25 = 0.1e1 - t7
  t26 = t25 <= f.p.zeta_threshold
  t27 = f.my_piecewise5(t24, t5, t26, t6, t7)
  t28 = 0.1e1 + t27
  t29 = t28 * r0
  t30 = t29 ** (0.1e1 / 0.3e1)
  t35 = f.my_piecewise3(t14, 0, t20 * t23 / t30 / 0.9e1)
  t39 = t25 * r0 / 0.2e1 <= f.p.dens_threshold
  t40 = f.my_piecewise5(t26, t5, t24, t6, -t7)
  t41 = 0.1e1 + t40
  t42 = t41 * r0
  t43 = t42 ** (0.1e1 / 0.3e1)
  t48 = f.my_piecewise3(t39, 0, t20 * t23 / t43 / 0.9e1)
  t49 = t35 + t48
  t50 = t49 == 0.0e0
  t51 = f.my_piecewise3(t50, DBL_EPSILON, t49)
  t52 = t51 ** 2
  t53 = 0.1e1 / t52
  t54 = t10 * t53
  t55 = t20 * t21
  t62 = f.my_piecewise3(t14, 0, -t55 * t22 / t30 / t29 * t28 / 0.27e2)
  t69 = f.my_piecewise3(t39, 0, -t55 * t22 / t43 / t42 * t41 / 0.27e2)
  t71 = f.my_piecewise3(t50, 0, t62 + t69)
  t72 = t52 ** 2
  t73 = 0.1e1 / t72
  t75 = t52 * t51
  t76 = 0.1e1 / t75
  t79 = 0.433132090567376656e2 * t73 + 0.190514637481962976e2 * t76 + 0.2094820520028e1 * t53
  t80 = t79 ** 2
  t82 = 0.1e1 / t80 / t79
  t83 = t71 * t82
  t85 = 0.1e1 / t72 / t51
  t86 = t85 * t71
  t88 = t73 * t71
  t92 = -0.1732528362269506624e3 * t86 - 0.571543912445888928e2 * t88 - 0.4189641040056e1 * t76 * t71
  t93 = t92 ** 2
  t94 = t83 * t93
  t97 = t28 ** 2
  t98 = t97 * t28
  t99 = r0 ** 2
  t100 = t99 * r0
  t108 = f.my_piecewise3(t14, 0, -0.28e2 / 0.243e3 * t55 * t22 / t30 / t100)
  t109 = t41 ** 2
  t110 = t109 * t41
  t118 = f.my_piecewise3(t39, 0, -0.28e2 / 0.243e3 * t55 * t22 / t43 / t100)
  t120 = f.my_piecewise3(t50, 0, t108 + t118)
  t122 = 0.1e1 / t79
  t128 = 0.390299956e1 / t51 + 0.5764e0
  t129 = 0.1e1 / t80
  t130 = t128 * t129
  t132 = 0.1e1 / t72 / t75
  t133 = t71 ** 2
  t134 = t133 * t71
  t138 = 0.1e1 / t72 / t52
  t139 = t138 * t71
  t147 = f.my_piecewise3(t14, 0, 0.4e1 / 0.81e2 * t55 * t22 / t30 / t99)
  t155 = f.my_piecewise3(t39, 0, 0.4e1 / 0.81e2 * t55 * t22 / t43 / t99)
  t157 = f.my_piecewise3(t50, 0, t147 + t155)
  t174 = -0.51975850868085198720e4 * t132 * t134 + 0.25987925434042599360e4 * t139 * t157 - 0.1732528362269506624e3 * t85 * t120 - 0.11430878248917778560e4 * t138 * t134 + 0.6858526949350667136e3 * t86 * t157 - 0.571543912445888928e2 * t73 * t120 - 0.50275692480672e2 * t85 * t134 + 0.37706769360504e2 * t88 * t157 - 0.4189641040056e1 * t76 * t120
  t178 = t9 * t76
  t179 = t133 * t122
  t182 = t9 * t53
  t183 = t71 * t129
  t187 = t9 * t128
  t194 = t138 * t133
  t198 = t85 * t133
  t206 = 0.8662641811347533120e3 * t194 - 0.1732528362269506624e3 * t85 * t157 + 0.2286175649783555712e3 * t198 - 0.571543912445888928e2 * t73 * t157 + 0.12568923120168e2 * t73 * t133 - 0.4189641040056e1 * t76 * t157
  t214 = t10 * t76
  t216 = t71 * t122 * t157
  t219 = t133 * t129
  t220 = t219 * t92
  t223 = t157 * t129
  t224 = t223 * t92
  t227 = t183 * t206
  t230 = t80 ** 2
  t231 = 0.1e1 / t230
  t233 = t93 * t92
  t237 = t10 * t128
  t239 = t82 * t92 * t206
  t242 = 0.58544993400000000000000000000000000000000000000000e1 * t54 * t94 + 0.97574989000000000000000000000000000000000000000000e0 * t10 * t53 * t120 * t122 + 0.25000000000000000000000000000000000000000000000000e0 * t10 * t130 * t174 - 0.58544993400000000000000000000000000000000000000000e1 * t178 * t179 - 0.58544993400000000000000000000000000000000000000000e1 * t182 * t183 * t92 - 0.15000000000000000000000000000000000000000000000000e1 * t187 * t82 * t93 + 0.29272496700000000000000000000000000000000000000000e1 * t182 * t157 * t122 + 0.75000000000000000000000000000000000000000000000000e0 * t187 * t129 * t206 + 0.58544993400000000000000000000000000000000000000000e1 * t10 * t73 * t134 * t122 - 0.58544993400000000000000000000000000000000000000000e1 * t214 * t216 + 0.58544993400000000000000000000000000000000000000000e1 * t214 * t220 - 0.29272496700000000000000000000000000000000000000000e1 * t54 * t224 - 0.29272496700000000000000000000000000000000000000000e1 * t54 * t227 + 0.15000000000000000000000000000000000000000000000000e1 * t10 * t128 * t231 * t233 - 0.15000000000000000000000000000000000000000000000000e1 * t237 * t239
  t243 = f.my_piecewise3(t4, 0, t242)
  t245 = t10 * t73
  t264 = t120 * t122
  t298 = t97 ** 2
  t299 = t99 ** 2
  t307 = f.my_piecewise3(t14, 0, 0.280e3 / 0.729e3 * t55 * t22 / t30 / t299)
  t308 = t109 ** 2
  t316 = f.my_piecewise3(t39, 0, 0.280e3 / 0.729e3 * t55 * t22 / t43 / t299)
  t318 = f.my_piecewise3(t50, 0, t307 + t316)
  t323 = -0.23417997360000000000000000000000000000000000000000e2 * t245 * t134 * t129 * t92 + 0.11708998680000000000000000000000000000000000000000e2 * t214 * t219 * t206 - 0.58544993400000000000000000000000000000000000000000e1 * t54 * t223 * t206 + 0.90000000000000000000000000000000000000000000000000e1 * t237 * t231 * t93 * t206 + 0.11708998680000000000000000000000000000000000000000e2 * t54 * t157 * t82 * t93 - 0.78059991200000000000000000000000000000000000000000e1 * t214 * t264 * t71 + 0.35126996040000000000000000000000000000000000000000e2 * t245 * t179 * t157 - 0.39029995600000000000000000000000000000000000000000e1 * t54 * t120 * t129 * t92 - 0.20000000000000000000000000000000000000000000000000e1 * t237 * t82 * t174 * t92 + 0.23417997360000000000000000000000000000000000000000e2 * t214 * t183 * t157 * t92 + 0.23417997360000000000000000000000000000000000000000e2 * t54 * t83 * t92 * t206 - 0.23417997360000000000000000000000000000000000000000e2 * t214 * t133 * t82 * t93 - 0.23417997360000000000000000000000000000000000000000e2 * t54 * t71 * t231 * t233 - 0.39029995600000000000000000000000000000000000000000e1 * t54 * t183 * t174 + 0.97574989000000000000000000000000000000000000000000e0 * t10 * t53 * t318 * t122
  t324 = t72 ** 2
  t326 = t133 ** 2
  t332 = t157 ** 2
  t359 = 0.363830956076596391040e5 / t324 * t326 - 0.311855105208511192320e5 * t132 * t133 * t157 + 0.25987925434042599360e4 * t138 * t332 + 0.34650567245390132480e4 * t139 * t120 - 0.1732528362269506624e3 * t85 * t318 + 0.68585269493506671360e4 * t132 * t326 - 0.68585269493506671360e4 * t194 * t157 + 0.6858526949350667136e3 * t85 * t332 + 0.9144702599134222848e3 * t86 * t120 - 0.571543912445888928e2 * t73 * t318 + 0.251378462403360e3 * t138 * t326 - 0.301654154884032e3 * t198 * t157 + 0.37706769360504e2 * t73 * t332 + 0.50275692480672e2 * t88 * t120 - 0.4189641040056e1 * t76 * t318
  t370 = t206 ** 2
  t381 = t93 ** 2
  t407 = 0.25000000000000000000000000000000000000000000000000e0 * t10 * t130 * t359 - 0.58544993400000000000000000000000000000000000000000e1 * t10 * t76 * t332 * t122 - 0.11708998680000000000000000000000000000000000000000e2 * t182 * t227 - 0.15000000000000000000000000000000000000000000000000e1 * t10 * t128 * t82 * t370 - 0.23417997360000000000000000000000000000000000000000e2 * t10 * t85 * t326 * t122 - 0.60000000000000000000000000000000000000000000000000e1 * t10 * t128 / t230 / t79 * t381 - 0.60000000000000000000000000000000000000000000000000e1 * t187 * t239 + 0.23417997360000000000000000000000000000000000000000e2 * t178 * t220 - 0.23417997360000000000000000000000000000000000000000e2 * t178 * t216 + 0.23417997360000000000000000000000000000000000000000e2 * t182 * t94 - 0.11708998680000000000000000000000000000000000000000e2 * t182 * t224 + 0.39029995600000000000000000000000000000000000000000e1 * t182 * t264 + 0.10000000000000000000000000000000000000000000000000e1 * t187 * t129 * t174 + 0.23417997360000000000000000000000000000000000000000e2 * t9 * t73 * t134 * t122 + 0.60000000000000000000000000000000000000000000000000e1 * t187 * t231 * t233
  t409 = f.my_piecewise3(t4, 0, t323 + t407)
  v4rho4_0_ = r0 * t409 + 0.4e1 * t243

  res = {'v4rho4': v4rho4_0_}
  return res

def pol_fxc(p, r, s=(None, None, None), l=(None, None), tau=(None, None)):
  f = funcs(p)
  params = f.params
  (r0, r1), (s0, s1, s2), (l0, l1), (tau0, tau1) = r, s, l, tau
  
  t1 = r0 - r1
  t2 = r0 + r1
  t3 = 0.1e1 / t2
  t4 = t1 * t3
  t5 = abs(t4)
  t11 = 0.1e1 - t5 <= f.p.zeta_threshold or r0 <= f.p.dens_threshold and r1 <= f.p.dens_threshold
  t13 = 0.1e1 + t4 <= f.p.zeta_threshold
  t14 = f.p.zeta_threshold - 0.1e1
  t16 = 0.1e1 - t4 <= f.p.zeta_threshold
  t17 = -t14
  t18 = f.my_piecewise5(t13, t14, t16, t17, t4)
  t19 = t2 ** 2
  t20 = 0.1e1 / t19
  t21 = t1 * t20
  t22 = t3 - t21
  t23 = f.my_piecewise5(t13, 0, t16, 0, t22)
  t24 = t18 * t23
  t27 = 0.2e1 * r0 * t3 <= f.p.zeta_threshold
  t30 = 0.2e1 * r1 * t3 <= f.p.zeta_threshold
  t31 = f.my_piecewise5(t27, t14, t30, t17, t4)
  t32 = 0.1e1 + t31
  t35 = t32 * t2 / 0.2e1 <= f.p.dens_threshold
  t36 = 3 ** (0.1e1 / 0.3e1)
  t37 = t36 ** 2
  t39 = (0.1e1 / jnp.pi) ** (0.1e1 / 0.3e1)
  t41 = t37 / t39
  t42 = 4 ** (0.1e1 / 0.3e1)
  t43 = 2 ** (0.1e1 / 0.3e1)
  t44 = t42 * t43
  t45 = t32 <= f.p.zeta_threshold
  t46 = 0.1e1 - t31
  t47 = t46 <= f.p.zeta_threshold
  t48 = f.my_piecewise5(t45, t14, t47, t17, t31)
  t49 = 0.1e1 + t48
  t50 = t49 * t2
  t51 = t50 ** (0.1e1 / 0.3e1)
  t56 = f.my_piecewise3(t35, 0, t41 * t44 / t51 / 0.9e1)
  t60 = t46 * t2 / 0.2e1 <= f.p.dens_threshold
  t61 = f.my_piecewise5(t47, t14, t45, t17, -t31)
  t62 = 0.1e1 + t61
  t63 = t62 * t2
  t64 = t63 ** (0.1e1 / 0.3e1)
  t69 = f.my_piecewise3(t60, 0, t41 * t44 / t64 / 0.9e1)
  t70 = t56 + t69
  t71 = t70 == 0.0e0
  t72 = f.my_piecewise3(t71, DBL_EPSILON, t70)
  t75 = 0.390299956e1 / t72 + 0.5764e0
  t77 = t72 ** 2
  t78 = t77 ** 2
  t79 = 0.1e1 / t78
  t82 = 0.1e1 / t77 / t72
  t84 = 0.1e1 / t77
  t86 = 0.433132090567376656e2 * t79 + 0.190514637481962976e2 * t82 + 0.2094820520028e1 * t84
  t87 = 0.1e1 / t86
  t88 = t2 * t75 * t87
  t91 = t18 ** 2
  t92 = 0.1e1 - t91
  t93 = t92 * t75
  t95 = 0.25000000000000000000000000000000000000000000000000e0 * t93 * t87
  t96 = t92 * t2
  t97 = t41 * t42
  t100 = t43 / t51 / t50
  t101 = f.my_piecewise5(t27, 0, t30, 0, t22)
  t102 = f.my_piecewise5(t45, 0, t47, 0, t101)
  t104 = t102 * t2 + t48 + 0.1e1
  t108 = f.my_piecewise3(t35, 0, -t97 * t100 * t104 / 0.27e2)
  t111 = t43 / t64 / t63
  t112 = f.my_piecewise5(t47, 0, t45, 0, -t101)
  t114 = t112 * t2 + t61 + 0.1e1
  t118 = f.my_piecewise3(t60, 0, -t97 * t111 * t114 / 0.27e2)
  t120 = f.my_piecewise3(t71, 0, t108 + t118)
  t122 = t84 * t120 * t87
  t125 = t86 ** 2
  t126 = 0.1e1 / t125
  t127 = t75 * t126
  t129 = 0.1e1 / t78 / t72
  t136 = -0.1732528362269506624e3 * t129 * t120 - 0.571543912445888928e2 * t79 * t120 - 0.4189641040056e1 * t82 * t120
  t137 = t127 * t136
  t141 = f.my_piecewise3(t11, 0, 0.50000000000000000000000000000000000000000000000000e0 * t24 * t88 - t95 + 0.97574989000000000000000000000000000000000000000000e0 * t96 * t122 + 0.25000000000000000000000000000000000000000000000000e0 * t96 * t137)
  t143 = t23 ** 2
  t145 = t75 * t87
  t150 = t1 / t19 / t2
  t152 = -0.2e1 * t20 + 0.2e1 * t150
  t153 = f.my_piecewise5(t13, 0, t16, 0, t152)
  t157 = t24 * t145
  t159 = t24 * t2
  t164 = t92 * t84
  t166 = t164 * t120 * t87
  t169 = t93 * t126 * t136
  t171 = t120 ** 2
  t176 = t49 ** 2
  t180 = t43 / t51 / t176 / t19
  t181 = t104 ** 2
  t185 = f.my_piecewise5(t27, 0, t30, 0, t152)
  t186 = f.my_piecewise5(t45, 0, t47, 0, t185)
  t194 = f.my_piecewise3(t35, 0, 0.4e1 / 0.81e2 * t97 * t180 * t181 - t97 * t100 * (t186 * t2 + 0.2e1 * t102) / 0.27e2)
  t195 = t62 ** 2
  t199 = t43 / t64 / t195 / t19
  t200 = t114 ** 2
  t204 = f.my_piecewise5(t47, 0, t45, 0, -t185)
  t212 = f.my_piecewise3(t60, 0, 0.4e1 / 0.81e2 * t97 * t199 * t200 - t97 * t111 * (t204 * t2 + 0.2e1 * t112) / 0.27e2)
  t214 = f.my_piecewise3(t71, 0, t194 + t212)
  t219 = t96 * t84
  t220 = t120 * t126
  t225 = 0.1e1 / t125 / t86
  t226 = t75 * t225
  t227 = t136 ** 2
  t232 = 0.1e1 / t78 / t77
  t249 = 0.50000000000000000000000000000000000000000000000000e0 * t143 * t2 * t145 + 0.50000000000000000000000000000000000000000000000000e0 * t18 * t153 * t88 + 0.10000000000000000000000000000000000000000000000000e1 * t157 - 0.39029995600000000000000000000000000000000000000000e1 * t159 * t122 - 0.10000000000000000000000000000000000000000000000000e1 * t159 * t137 + 0.19514997800000000000000000000000000000000000000000e1 * t166 + 0.50000000000000000000000000000000000000000000000000e0 * t169 - 0.19514997800000000000000000000000000000000000000000e1 * t96 * t82 * t171 * t87 + 0.97574989000000000000000000000000000000000000000000e0 * t96 * t84 * t214 * t87 - 0.19514997800000000000000000000000000000000000000000e1 * t219 * t220 * t136 - 0.50000000000000000000000000000000000000000000000000e0 * t96 * t226 * t227 + 0.25000000000000000000000000000000000000000000000000e0 * t96 * t127 * (0.8662641811347533120e3 * t232 * t171 - 0.1732528362269506624e3 * t129 * t214 + 0.2286175649783555712e3 * t129 * t171 - 0.571543912445888928e2 * t79 * t214 + 0.12568923120168e2 * t79 * t171 - 0.4189641040056e1 * t82 * t214)
  t250 = f.my_piecewise3(t11, 0, t249)
  d11 = t2 * t250 + 0.2e1 * t141
  t252 = -t3 - t21
  t253 = f.my_piecewise5(t13, 0, t16, 0, t252)
  t254 = t18 * t253
  t257 = f.my_piecewise5(t27, 0, t30, 0, t252)
  t258 = f.my_piecewise5(t45, 0, t47, 0, t257)
  t260 = t258 * t2 + t48 + 0.1e1
  t264 = f.my_piecewise3(t35, 0, -t97 * t100 * t260 / 0.27e2)
  t265 = f.my_piecewise5(t47, 0, t45, 0, -t257)
  t267 = t265 * t2 + t61 + 0.1e1
  t271 = f.my_piecewise3(t60, 0, -t97 * t111 * t267 / 0.27e2)
  t273 = f.my_piecewise3(t71, 0, t264 + t271)
  t275 = t84 * t273 * t87
  t278 = t129 * t273
  t280 = t79 * t273
  t284 = -0.1732528362269506624e3 * t278 - 0.571543912445888928e2 * t280 - 0.4189641040056e1 * t82 * t273
  t285 = t127 * t284
  t289 = f.my_piecewise3(t11, 0, 0.50000000000000000000000000000000000000000000000000e0 * t254 * t88 - t95 + 0.97574989000000000000000000000000000000000000000000e0 * t96 * t275 + 0.25000000000000000000000000000000000000000000000000e0 * t96 * t285)
  t293 = 0.2e1 * t150
  t294 = f.my_piecewise5(t13, 0, t16, 0, t293)
  t298 = t254 * t145
  t300 = t254 * t2
  t310 = t273 * t87
  t311 = t164 * t310
  t321 = f.my_piecewise5(t27, 0, t30, 0, t293)
  t322 = f.my_piecewise5(t45, 0, t47, 0, t321)
  t329 = f.my_piecewise3(t35, 0, 0.4e1 / 0.81e2 * t97 * t180 * t260 * t104 - t97 * t100 * (t322 * t2 + t102 + t258) / 0.27e2)
  t334 = f.my_piecewise5(t47, 0, t45, 0, -t321)
  t341 = f.my_piecewise3(t60, 0, 0.4e1 / 0.81e2 * t97 * t199 * t267 * t114 - t97 * t111 * (t334 * t2 + t112 + t265) / 0.27e2)
  t343 = f.my_piecewise3(t71, 0, t329 + t341)
  t348 = t273 * t126
  t355 = t93 * t126 * t284
  t382 = 0.50000000000000000000000000000000000000000000000000e0 * t23 * t253 * t88 + 0.50000000000000000000000000000000000000000000000000e0 * t18 * t294 * t88 + 0.50000000000000000000000000000000000000000000000000e0 * t298 - 0.19514997800000000000000000000000000000000000000000e1 * t300 * t122 - 0.50000000000000000000000000000000000000000000000000e0 * t300 * t137 + 0.50000000000000000000000000000000000000000000000000e0 * t157 + 0.97574989000000000000000000000000000000000000000000e0 * t166 + 0.25000000000000000000000000000000000000000000000000e0 * t169 - 0.19514997800000000000000000000000000000000000000000e1 * t159 * t275 + 0.97574989000000000000000000000000000000000000000000e0 * t311 - 0.19514997800000000000000000000000000000000000000000e1 * t96 * t82 * t310 * t120 + 0.97574989000000000000000000000000000000000000000000e0 * t96 * t84 * t343 * t87 - 0.97574989000000000000000000000000000000000000000000e0 * t219 * t348 * t136 - 0.50000000000000000000000000000000000000000000000000e0 * t159 * t285 + 0.25000000000000000000000000000000000000000000000000e0 * t355 - 0.97574989000000000000000000000000000000000000000000e0 * t219 * t220 * t284 - 0.50000000000000000000000000000000000000000000000000e0 * t96 * t75 * t225 * t284 * t136 + 0.25000000000000000000000000000000000000000000000000e0 * t96 * t127 * (0.8662641811347533120e3 * t232 * t273 * t120 - 0.1732528362269506624e3 * t129 * t343 + 0.2286175649783555712e3 * t278 * t120 - 0.571543912445888928e2 * t79 * t343 + 0.12568923120168e2 * t280 * t120 - 0.4189641040056e1 * t82 * t343)
  t383 = f.my_piecewise3(t11, 0, t382)
  d12 = t2 * t383 + t141 + t289
  t386 = t253 ** 2
  t391 = 0.2e1 * t20 + 0.2e1 * t150
  t392 = f.my_piecewise5(t13, 0, t16, 0, t391)
  t403 = t273 ** 2
  t408 = t260 ** 2
  t412 = f.my_piecewise5(t27, 0, t30, 0, t391)
  t413 = f.my_piecewise5(t45, 0, t47, 0, t412)
  t421 = f.my_piecewise3(t35, 0, 0.4e1 / 0.81e2 * t97 * t180 * t408 - t97 * t100 * (t413 * t2 + 0.2e1 * t258) / 0.27e2)
  t422 = t267 ** 2
  t426 = f.my_piecewise5(t47, 0, t45, 0, -t412)
  t434 = f.my_piecewise3(t60, 0, 0.4e1 / 0.81e2 * t97 * t199 * t422 - t97 * t111 * (t426 * t2 + 0.2e1 * t265) / 0.27e2)
  t436 = f.my_piecewise3(t71, 0, t421 + t434)
  t444 = t284 ** 2
  t464 = 0.50000000000000000000000000000000000000000000000000e0 * t386 * t2 * t145 + 0.50000000000000000000000000000000000000000000000000e0 * t18 * t392 * t88 + 0.10000000000000000000000000000000000000000000000000e1 * t298 - 0.39029995600000000000000000000000000000000000000000e1 * t300 * t275 - 0.10000000000000000000000000000000000000000000000000e1 * t300 * t285 + 0.19514997800000000000000000000000000000000000000000e1 * t311 + 0.50000000000000000000000000000000000000000000000000e0 * t355 - 0.19514997800000000000000000000000000000000000000000e1 * t96 * t82 * t403 * t87 + 0.97574989000000000000000000000000000000000000000000e0 * t96 * t84 * t436 * t87 - 0.19514997800000000000000000000000000000000000000000e1 * t219 * t348 * t284 - 0.50000000000000000000000000000000000000000000000000e0 * t96 * t226 * t444 + 0.25000000000000000000000000000000000000000000000000e0 * t96 * t127 * (0.8662641811347533120e3 * t232 * t403 - 0.1732528362269506624e3 * t129 * t436 + 0.2286175649783555712e3 * t129 * t403 - 0.571543912445888928e2 * t79 * t436 + 0.12568923120168e2 * t79 * t403 - 0.4189641040056e1 * t82 * t436)
  t465 = f.my_piecewise3(t11, 0, t464)
  d22 = t2 * t465 + 0.2e1 * t289
  res = {'v2rho2': jnp.stack([d11, d12, d22], axis=-1) if 'd12' in locals() else d11}
  return res

def pol_kxc(p, r, s=None, l=None, tau=None):
  f = funcs(p)
  params = f.params
  (r0, r1) = r
  s0 = s[0] if s is not None else None
  s1 = s[1] if s is not None else None
  s2 = s[2] if s is not None else None
  l0 = l[0] if l is not None else None
  l1 = l[1] if l is not None else None
  tau0 = tau[0] if tau is not None else None
  tau1 = tau[1] if tau is not None else None

  t1 = r0 - r1
  t2 = r0 + r1
  t3 = 0.1e1 / t2
  t4 = t1 * t3
  t5 = abs(t4)
  t11 = 0.1e1 - t5 <= f.p.zeta_threshold or r0 <= f.p.dens_threshold and r1 <= f.p.dens_threshold
  t13 = 0.1e1 + t4 <= f.p.zeta_threshold
  t15 = 0.1e1 - t4 <= f.p.zeta_threshold
  t16 = t2 ** 2
  t17 = 0.1e1 / t16
  t19 = -t1 * t17 + t3
  t20 = f.my_piecewise5(t13, 0, t15, 0, t19)
  t21 = t20 ** 2
  t22 = t21 * t2
  t25 = 0.2e1 * r0 * t3 <= f.p.zeta_threshold
  t26 = f.p.zeta_threshold - 0.1e1
  t29 = 0.2e1 * r1 * t3 <= f.p.zeta_threshold
  t30 = -t26
  t31 = f.my_piecewise5(t25, t26, t29, t30, t4)
  t32 = 0.1e1 + t31
  t35 = t32 * t2 / 0.2e1 <= f.p.dens_threshold
  t36 = 3 ** (0.1e1 / 0.3e1)
  t37 = t36 ** 2
  t39 = (0.1e1 / jnp.pi) ** (0.1e1 / 0.3e1)
  t41 = t37 / t39
  t42 = 4 ** (0.1e1 / 0.3e1)
  t43 = 2 ** (0.1e1 / 0.3e1)
  t44 = t42 * t43
  t45 = t32 <= f.p.zeta_threshold
  t46 = 0.1e1 - t31
  t47 = t46 <= f.p.zeta_threshold
  t48 = f.my_piecewise5(t45, t26, t47, t30, t31)
  t49 = 0.1e1 + t48
  t50 = t49 * t2
  t51 = t50 ** (0.1e1 / 0.3e1)
  t56 = f.my_piecewise3(t35, 0, t41 * t44 / t51 / 0.9e1)
  t60 = t46 * t2 / 0.2e1 <= f.p.dens_threshold
  t61 = f.my_piecewise5(t47, t26, t45, t30, -t31)
  t62 = 0.1e1 + t61
  t63 = t62 * t2
  t64 = t63 ** (0.1e1 / 0.3e1)
  t69 = f.my_piecewise3(t60, 0, t41 * t44 / t64 / 0.9e1)
  t70 = t56 + t69
  t71 = t70 == 0.0e0
  t72 = f.my_piecewise3(t71, DBL_EPSILON, t70)
  t75 = 0.390299956e1 / t72 + 0.5764e0
  t76 = t72 ** 2
  t77 = t76 ** 2
  t78 = 0.1e1 / t77
  t80 = t76 * t72
  t81 = 0.1e1 / t80
  t83 = 0.1e1 / t76
  t85 = 0.433132090567376656e2 * t78 + 0.190514637481962976e2 * t81 + 0.2094820520028e1 * t83
  t86 = 0.1e1 / t85
  t87 = t75 * t86
  t90 = f.my_piecewise5(t13, t26, t15, t30, t4)
  t91 = t16 * t2
  t92 = 0.1e1 / t91
  t95 = 0.2e1 * t1 * t92 - 0.2e1 * t17
  t96 = f.my_piecewise5(t13, 0, t15, 0, t95)
  t97 = t90 * t96
  t99 = t2 * t75 * t86
  t102 = t90 * t20
  t105 = t102 * t2
  t106 = t41 * t42
  t109 = t43 / t51 / t50
  t110 = f.my_piecewise5(t25, 0, t29, 0, t19)
  t111 = f.my_piecewise5(t45, 0, t47, 0, t110)
  t113 = t111 * t2 + t48 + 0.1e1
  t117 = f.my_piecewise3(t35, 0, -t106 * t109 * t113 / 0.27e2)
  t120 = t43 / t64 / t63
  t121 = f.my_piecewise5(t47, 0, t45, 0, -t110)
  t123 = t121 * t2 + t61 + 0.1e1
  t127 = f.my_piecewise3(t60, 0, -t106 * t120 * t123 / 0.27e2)
  t129 = f.my_piecewise3(t71, 0, t117 + t127)
  t130 = t83 * t129
  t131 = t130 * t86
  t134 = t85 ** 2
  t135 = 0.1e1 / t134
  t136 = t75 * t135
  t138 = 0.1e1 / t77 / t72
  t139 = t138 * t129
  t141 = t78 * t129
  t145 = -0.1732528362269506624e3 * t139 - 0.571543912445888928e2 * t141 - 0.4189641040056e1 * t81 * t129
  t146 = t136 * t145
  t149 = t90 ** 2
  t150 = 0.1e1 - t149
  t151 = t150 * t83
  t152 = t129 * t86
  t155 = t150 * t75
  t156 = t135 * t145
  t159 = t150 * t2
  t160 = t129 ** 2
  t162 = t81 * t160 * t86
  t165 = t49 ** 2
  t169 = t43 / t51 / t165 / t16
  t170 = t113 ** 2
  t174 = f.my_piecewise5(t25, 0, t29, 0, t95)
  t175 = f.my_piecewise5(t45, 0, t47, 0, t174)
  t178 = t175 * t2 + 0.2e1 * t111
  t183 = f.my_piecewise3(t35, 0, 0.4e1 / 0.81e2 * t106 * t169 * t170 - t106 * t109 * t178 / 0.27e2)
  t184 = t62 ** 2
  t188 = t43 / t64 / t184 / t16
  t189 = t123 ** 2
  t193 = f.my_piecewise5(t47, 0, t45, 0, -t174)
  t196 = t193 * t2 + 0.2e1 * t121
  t201 = f.my_piecewise3(t60, 0, 0.4e1 / 0.81e2 * t106 * t188 * t189 - t106 * t120 * t196 / 0.27e2)
  t203 = f.my_piecewise3(t71, 0, t183 + t201)
  t205 = t83 * t203 * t86
  t208 = t159 * t83
  t209 = t129 * t135
  t210 = t209 * t145
  t214 = 0.1e1 / t134 / t85
  t216 = t145 ** 2
  t217 = t75 * t214 * t216
  t221 = 0.1e1 / t77 / t76
  t234 = 0.8662641811347533120e3 * t221 * t160 - 0.1732528362269506624e3 * t138 * t203 + 0.2286175649783555712e3 * t138 * t160 - 0.571543912445888928e2 * t78 * t203 + 0.12568923120168e2 * t78 * t160 - 0.4189641040056e1 * t81 * t203
  t235 = t136 * t234
  t238 = 0.50000000000000000000000000000000000000000000000000e0 * t22 * t87 + 0.50000000000000000000000000000000000000000000000000e0 * t97 * t99 + 0.10000000000000000000000000000000000000000000000000e1 * t102 * t87 - 0.39029995600000000000000000000000000000000000000000e1 * t105 * t131 - 0.10000000000000000000000000000000000000000000000000e1 * t105 * t146 + 0.19514997800000000000000000000000000000000000000000e1 * t151 * t152 + 0.50000000000000000000000000000000000000000000000000e0 * t155 * t156 - 0.19514997800000000000000000000000000000000000000000e1 * t159 * t162 + 0.97574989000000000000000000000000000000000000000000e0 * t159 * t205 - 0.19514997800000000000000000000000000000000000000000e1 * t208 * t210 - 0.50000000000000000000000000000000000000000000000000e0 * t159 * t217 + 0.25000000000000000000000000000000000000000000000000e0 * t159 * t235
  t239 = f.my_piecewise3(t11, 0, t238)
  t266 = t134 ** 2
  t275 = t160 * t129
  t294 = t16 ** 2
  t298 = 0.6e1 * t92 - 0.6e1 * t1 / t294
  t299 = f.my_piecewise5(t25, 0, t29, 0, t298)
  t300 = f.my_piecewise5(t45, 0, t47, 0, t299)
  t308 = f.my_piecewise3(t35, 0, -0.28e2 / 0.243e3 * t106 * t43 / t51 / t165 / t49 / t91 * t170 * t113 + 0.4e1 / 0.27e2 * t106 * t169 * t113 * t178 - t106 * t109 * (t300 * t2 + 0.3e1 * t175) / 0.27e2)
  t322 = f.my_piecewise5(t47, 0, t45, 0, -t299)
  t330 = f.my_piecewise3(t60, 0, -0.28e2 / 0.243e3 * t106 * t43 / t64 / t184 / t62 / t91 * t189 * t123 + 0.4e1 / 0.27e2 * t106 * t188 * t123 * t196 - t106 * t120 * (t322 * t2 + 0.3e1 * t193) / 0.27e2)
  t332 = f.my_piecewise3(t71, 0, t308 + t330)
  t363 = 0.11708998680000000000000000000000000000000000000000e2 * t105 * t130 * t156 + 0.29272496700000000000000000000000000000000000000000e1 * t151 * t203 * t86 + 0.75000000000000000000000000000000000000000000000000e0 * t155 * t135 * t234 + 0.15000000000000000000000000000000000000000000000000e1 * t97 * t87 - 0.58544993400000000000000000000000000000000000000000e1 * t150 * t81 * t160 * t86 - 0.15000000000000000000000000000000000000000000000000e1 * t155 * t214 * t216 + 0.15000000000000000000000000000000000000000000000000e1 * t21 * t75 * t86 - 0.58544993400000000000000000000000000000000000000000e1 * t151 * t210 - 0.11708998680000000000000000000000000000000000000000e2 * t102 * t131 + 0.15000000000000000000000000000000000000000000000000e1 * t159 * t75 / t266 * t216 * t145 + 0.25000000000000000000000000000000000000000000000000e0 * t159 * t136 * (-0.51975850868085198720e4 / t77 / t80 * t275 + 0.25987925434042599360e4 * t221 * t129 * t203 - 0.1732528362269506624e3 * t138 * t332 - 0.11430878248917778560e4 * t221 * t275 + 0.6858526949350667136e3 * t139 * t203 - 0.571543912445888928e2 * t78 * t332 - 0.50275692480672e2 * t138 * t275 + 0.37706769360504e2 * t141 * t203 - 0.4189641040056e1 * t81 * t332) + 0.97574989000000000000000000000000000000000000000000e0 * t159 * t83 * t332 * t86 - 0.15000000000000000000000000000000000000000000000000e1 * t22 * t146 + 0.58544993400000000000000000000000000000000000000000e1 * t159 * t78 * t275 * t86 - 0.58544993400000000000000000000000000000000000000000e1 * t22 * t131
  t364 = f.my_piecewise5(t13, 0, t15, 0, t298)
  t386 = t97 * t2
  t395 = t159 * t81
  t411 = 0.50000000000000000000000000000000000000000000000000e0 * t90 * t364 * t99 + 0.15000000000000000000000000000000000000000000000000e1 * t20 * t2 * t87 * t96 - 0.30000000000000000000000000000000000000000000000000e1 * t102 * t146 - 0.29272496700000000000000000000000000000000000000000e1 * t208 * t203 * t135 * t145 - 0.29272496700000000000000000000000000000000000000000e1 * t208 * t209 * t234 - 0.15000000000000000000000000000000000000000000000000e1 * t159 * t75 * t214 * t145 * t234 - 0.15000000000000000000000000000000000000000000000000e1 * t386 * t146 - 0.58544993400000000000000000000000000000000000000000e1 * t386 * t131 - 0.58544993400000000000000000000000000000000000000000e1 * t105 * t205 - 0.15000000000000000000000000000000000000000000000000e1 * t105 * t235 - 0.58544993400000000000000000000000000000000000000000e1 * t395 * t152 * t203 + 0.58544993400000000000000000000000000000000000000000e1 * t208 * t129 * t214 * t216 + 0.11708998680000000000000000000000000000000000000000e2 * t105 * t162 + 0.30000000000000000000000000000000000000000000000000e1 * t105 * t217 + 0.58544993400000000000000000000000000000000000000000e1 * t395 * t160 * t135 * t145
  t413 = f.my_piecewise3(t11, 0, t363 + t411)
  d111 = t2 * t413 + 0.3e1 * t239

  res = {'v3rho3': d111}
  return res

def pol_lxc(p, r, s=None, l=None, tau=None):
  f = funcs(p)
  params = f.params
  (r0, r1) = r
  s0 = s[0] if s is not None else None
  s1 = s[1] if s is not None else None
  s2 = s[2] if s is not None else None
  l0 = l[0] if l is not None else None
  l1 = l[1] if l is not None else None
  tau0 = tau[0] if tau is not None else None
  tau1 = tau[1] if tau is not None else None

  t1 = r0 - r1
  t2 = r0 + r1
  t3 = 0.1e1 / t2
  t4 = t1 * t3
  t5 = abs(t4)
  t11 = 0.1e1 - t5 <= f.p.zeta_threshold or r0 <= f.p.dens_threshold and r1 <= f.p.dens_threshold
  t13 = 0.1e1 + t4 <= f.p.zeta_threshold
  t15 = 0.1e1 - t4 <= f.p.zeta_threshold
  t16 = t2 ** 2
  t17 = 0.1e1 / t16
  t19 = -t1 * t17 + t3
  t20 = f.my_piecewise5(t13, 0, t15, 0, t19)
  t21 = t20 ** 2
  t22 = t21 * t2
  t25 = 0.2e1 * r0 * t3 <= f.p.zeta_threshold
  t26 = f.p.zeta_threshold - 0.1e1
  t29 = 0.2e1 * r1 * t3 <= f.p.zeta_threshold
  t30 = -t26
  t31 = f.my_piecewise5(t25, t26, t29, t30, t4)
  t32 = 0.1e1 + t31
  t35 = t32 * t2 / 0.2e1 <= f.p.dens_threshold
  t36 = 3 ** (0.1e1 / 0.3e1)
  t37 = t36 ** 2
  t39 = (0.1e1 / jnp.pi) ** (0.1e1 / 0.3e1)
  t41 = t37 / t39
  t42 = 4 ** (0.1e1 / 0.3e1)
  t43 = 2 ** (0.1e1 / 0.3e1)
  t44 = t42 * t43
  t45 = t32 <= f.p.zeta_threshold
  t46 = 0.1e1 - t31
  t47 = t46 <= f.p.zeta_threshold
  t48 = f.my_piecewise5(t45, t26, t47, t30, t31)
  t49 = 0.1e1 + t48
  t50 = t49 * t2
  t51 = t50 ** (0.1e1 / 0.3e1)
  t56 = f.my_piecewise3(t35, 0, t41 * t44 / t51 / 0.9e1)
  t60 = t46 * t2 / 0.2e1 <= f.p.dens_threshold
  t61 = f.my_piecewise5(t47, t26, t45, t30, -t31)
  t62 = 0.1e1 + t61
  t63 = t62 * t2
  t64 = t63 ** (0.1e1 / 0.3e1)
  t69 = f.my_piecewise3(t60, 0, t41 * t44 / t64 / 0.9e1)
  t70 = t56 + t69
  t71 = t70 == 0.0e0
  t72 = f.my_piecewise3(t71, DBL_EPSILON, t70)
  t73 = t72 ** 2
  t74 = 0.1e1 / t73
  t75 = t41 * t42
  t78 = t43 / t51 / t50
  t79 = f.my_piecewise5(t25, 0, t29, 0, t19)
  t80 = f.my_piecewise5(t45, 0, t47, 0, t79)
  t82 = t80 * t2 + t48 + 0.1e1
  t86 = f.my_piecewise3(t35, 0, -t75 * t78 * t82 / 0.27e2)
  t89 = t43 / t64 / t63
  t90 = f.my_piecewise5(t47, 0, t45, 0, -t79)
  t92 = t90 * t2 + t61 + 0.1e1
  t96 = f.my_piecewise3(t60, 0, -t75 * t89 * t92 / 0.27e2)
  t98 = f.my_piecewise3(t71, 0, t86 + t96)
  t99 = t74 * t98
  t100 = t73 ** 2
  t101 = 0.1e1 / t100
  t103 = t73 * t72
  t104 = 0.1e1 / t103
  t107 = 0.433132090567376656e2 * t101 + 0.190514637481962976e2 * t104 + 0.2094820520028e1 * t74
  t108 = 0.1e1 / t107
  t109 = t99 * t108
  t112 = f.my_piecewise5(t13, t26, t15, t30, t4)
  t113 = t112 ** 2
  t114 = 0.1e1 - t113
  t115 = t114 * t2
  t116 = t98 ** 2
  t117 = t116 * t98
  t119 = t101 * t117 * t108
  t124 = 0.390299956e1 / t72 + 0.5764e0
  t125 = t107 ** 2
  t126 = 0.1e1 / t125
  t127 = t124 * t126
  t129 = 0.1e1 / t100 / t103
  t133 = 0.1e1 / t100 / t73
  t134 = t133 * t98
  t135 = t49 ** 2
  t139 = t43 / t51 / t135 / t16
  t140 = t82 ** 2
  t144 = t16 * t2
  t145 = 0.1e1 / t144
  t148 = 0.2e1 * t1 * t145 - 0.2e1 * t17
  t149 = f.my_piecewise5(t25, 0, t29, 0, t148)
  t150 = f.my_piecewise5(t45, 0, t47, 0, t149)
  t153 = t150 * t2 + 0.2e1 * t80
  t158 = f.my_piecewise3(t35, 0, 0.4e1 / 0.81e2 * t75 * t139 * t140 - t75 * t78 * t153 / 0.27e2)
  t159 = t62 ** 2
  t163 = t43 / t64 / t159 / t16
  t164 = t92 ** 2
  t168 = f.my_piecewise5(t47, 0, t45, 0, -t149)
  t171 = t168 * t2 + 0.2e1 * t90
  t176 = f.my_piecewise3(t60, 0, 0.4e1 / 0.81e2 * t75 * t163 * t164 - t75 * t89 * t171 / 0.27e2)
  t178 = f.my_piecewise3(t71, 0, t158 + t176)
  t182 = 0.1e1 / t100 / t72
  t187 = t43 / t51 / t135 / t49 / t144
  t196 = t16 ** 2
  t197 = 0.1e1 / t196
  t200 = -0.6e1 * t1 * t197 + 0.6e1 * t145
  t201 = f.my_piecewise5(t25, 0, t29, 0, t200)
  t202 = f.my_piecewise5(t45, 0, t47, 0, t201)
  t205 = t202 * t2 + 0.3e1 * t150
  t210 = f.my_piecewise3(t35, 0, -0.28e2 / 0.243e3 * t75 * t187 * t140 * t82 + 0.4e1 / 0.27e2 * t75 * t139 * t82 * t153 - t75 * t78 * t205 / 0.27e2)
  t215 = t43 / t64 / t159 / t62 / t144
  t224 = f.my_piecewise5(t47, 0, t45, 0, -t201)
  t227 = t224 * t2 + 0.3e1 * t168
  t232 = f.my_piecewise3(t60, 0, -0.28e2 / 0.243e3 * t75 * t215 * t164 * t92 + 0.4e1 / 0.27e2 * t75 * t163 * t92 * t171 - t75 * t89 * t227 / 0.27e2)
  t234 = f.my_piecewise3(t71, 0, t210 + t232)
  t239 = t182 * t98
  t246 = t101 * t98
  t251 = -0.51975850868085198720e4 * t129 * t117 + 0.25987925434042599360e4 * t134 * t178 - 0.1732528362269506624e3 * t182 * t234 - 0.11430878248917778560e4 * t133 * t117 + 0.6858526949350667136e3 * t239 * t178 - 0.571543912445888928e2 * t101 * t234 - 0.50275692480672e2 * t182 * t117 + 0.37706769360504e2 * t246 * t178 - 0.4189641040056e1 * t104 * t234
  t252 = t127 * t251
  t255 = t114 * t74
  t256 = t98 * t126
  t259 = t104 * t98
  t261 = -0.1732528362269506624e3 * t239 - 0.571543912445888928e2 * t246 - 0.4189641040056e1 * t259
  t262 = t256 * t261
  t265 = t127 * t261
  t268 = t20 * t2
  t269 = t124 * t108
  t270 = f.my_piecewise5(t13, 0, t15, 0, t148)
  t274 = t112 * t20
  t278 = t74 * t234 * t108
  t281 = f.my_piecewise5(t13, 0, t15, 0, t200)
  t282 = t112 * t281
  t284 = t2 * t124 * t108
  t289 = t274 * t2
  t290 = t126 * t261
  t291 = t99 * t290
  t294 = t112 * t270
  t295 = t294 * t2
  t298 = t133 * t116
  t302 = t182 * t116
  t310 = 0.8662641811347533120e3 * t298 - 0.1732528362269506624e3 * t182 * t178 + 0.2286175649783555712e3 * t302 - 0.571543912445888928e2 * t101 * t178 + 0.12568923120168e2 * t101 * t116 - 0.4189641040056e1 * t104 * t178
  t311 = t127 * t310
  t314 = t115 * t74
  t316 = 0.1e1 / t125 / t107
  t317 = t98 * t316
  t318 = t261 ** 2
  t319 = t317 * t318
  t322 = t104 * t116
  t323 = t322 * t108
  t326 = -0.58544993400000000000000000000000000000000000000000e1 * t22 * t109 + 0.58544993400000000000000000000000000000000000000000e1 * t115 * t119 + 0.25000000000000000000000000000000000000000000000000e0 * t115 * t252 - 0.58544993400000000000000000000000000000000000000000e1 * t255 * t262 - 0.15000000000000000000000000000000000000000000000000e1 * t22 * t265 + 0.15000000000000000000000000000000000000000000000000e1 * t268 * t269 * t270 - 0.11708998680000000000000000000000000000000000000000e2 * t274 * t109 + 0.97574989000000000000000000000000000000000000000000e0 * t115 * t278 + 0.50000000000000000000000000000000000000000000000000e0 * t282 * t284 - 0.30000000000000000000000000000000000000000000000000e1 * t274 * t265 + 0.11708998680000000000000000000000000000000000000000e2 * t289 * t291 - 0.15000000000000000000000000000000000000000000000000e1 * t295 * t265 - 0.15000000000000000000000000000000000000000000000000e1 * t289 * t311 + 0.58544993400000000000000000000000000000000000000000e1 * t314 * t319 + 0.11708998680000000000000000000000000000000000000000e2 * t289 * t323
  t327 = t115 * t124
  t329 = t316 * t261 * t310
  t334 = t74 * t178
  t335 = t334 * t108
  t338 = t124 * t316
  t339 = t338 * t318
  t342 = t256 * t310
  t345 = t115 * t104
  t346 = t98 * t108
  t347 = t346 * t178
  t350 = t116 * t126
  t351 = t350 * t261
  t354 = t21 * t124
  t357 = t125 ** 2
  t358 = 0.1e1 / t357
  t360 = t318 * t261
  t361 = t124 * t358 * t360
  t364 = t178 * t126
  t365 = t364 * t261
  t368 = t114 * t124
  t369 = t126 * t310
  t374 = t316 * t318
  t377 = t178 * t108
  t380 = t114 * t104
  t381 = t116 * t108
  t384 = -0.15000000000000000000000000000000000000000000000000e1 * t327 * t329 - 0.58544993400000000000000000000000000000000000000000e1 * t295 * t109 - 0.58544993400000000000000000000000000000000000000000e1 * t289 * t335 + 0.30000000000000000000000000000000000000000000000000e1 * t289 * t339 - 0.29272496700000000000000000000000000000000000000000e1 * t314 * t342 - 0.58544993400000000000000000000000000000000000000000e1 * t345 * t347 + 0.58544993400000000000000000000000000000000000000000e1 * t345 * t351 + 0.15000000000000000000000000000000000000000000000000e1 * t354 * t108 + 0.15000000000000000000000000000000000000000000000000e1 * t115 * t361 - 0.29272496700000000000000000000000000000000000000000e1 * t314 * t365 + 0.75000000000000000000000000000000000000000000000000e0 * t368 * t369 + 0.15000000000000000000000000000000000000000000000000e1 * t294 * t269 - 0.15000000000000000000000000000000000000000000000000e1 * t368 * t374 + 0.29272496700000000000000000000000000000000000000000e1 * t255 * t377 - 0.58544993400000000000000000000000000000000000000000e1 * t380 * t381
  t386 = f.my_piecewise3(t11, 0, t326 + t384)
  t408 = t115 * t101
  t421 = t234 * t108
  t441 = 0.60000000000000000000000000000000000000000000000000e1 * t295 * t339 - 0.23417997360000000000000000000000000000000000000000e2 * t268 * t74 * t346 * t270 + 0.11708998680000000000000000000000000000000000000000e2 * t345 * t350 * t310 - 0.20000000000000000000000000000000000000000000000000e1 * t289 * t252 + 0.23417997360000000000000000000000000000000000000000e2 * t22 * t74 * t262 + 0.23417997360000000000000000000000000000000000000000e2 * t295 * t323 - 0.23417997360000000000000000000000000000000000000000e2 * t345 * t116 * t316 * t318 + 0.35126996040000000000000000000000000000000000000000e2 * t408 * t381 * t178 + 0.90000000000000000000000000000000000000000000000000e1 * t327 * t358 * t318 * t310 - 0.78059991200000000000000000000000000000000000000000e1 * t289 * t278 + 0.46835994720000000000000000000000000000000000000000e2 * t274 * t74 * t262 - 0.78059991200000000000000000000000000000000000000000e1 * t345 * t421 * t98 - 0.20000000000000000000000000000000000000000000000000e1 * t327 * t316 * t251 * t261 - 0.30000000000000000000000000000000000000000000000000e1 * t295 * t311 - 0.58544993400000000000000000000000000000000000000000e1 * t314 * t364 * t310 - 0.46835994720000000000000000000000000000000000000000e2 * t289 * t119 - 0.60000000000000000000000000000000000000000000000000e1 * t268 * t124 * t126 * t270 * t261
  t464 = t178 ** 2
  t472 = t318 ** 2
  t476 = t135 ** 2
  t481 = t140 ** 2
  t489 = t153 ** 2
  t501 = -0.24e2 * t197 + 0.24e2 * t1 / t196 / t2
  t502 = f.my_piecewise5(t25, 0, t29, 0, t501)
  t503 = f.my_piecewise5(t45, 0, t47, 0, t502)
  t511 = f.my_piecewise3(t35, 0, 0.280e3 / 0.729e3 * t75 * t43 / t51 / t476 / t196 * t481 - 0.56e2 / 0.81e2 * t75 * t187 * t140 * t153 + 0.4e1 / 0.27e2 * t75 * t139 * t489 + 0.16e2 / 0.81e2 * t75 * t139 * t82 * t205 - t75 * t78 * (t503 * t2 + 0.4e1 * t202) / 0.27e2)
  t512 = t159 ** 2
  t517 = t164 ** 2
  t525 = t171 ** 2
  t533 = f.my_piecewise5(t47, 0, t45, 0, -t502)
  t541 = f.my_piecewise3(t60, 0, 0.280e3 / 0.729e3 * t75 * t43 / t64 / t512 / t196 * t517 - 0.56e2 / 0.81e2 * t75 * t215 * t164 * t171 + 0.4e1 / 0.27e2 * t75 * t163 * t525 + 0.16e2 / 0.81e2 * t75 * t163 * t92 * t227 - t75 * t89 * (t533 * t2 + 0.4e1 * t224) / 0.27e2)
  t543 = f.my_piecewise3(t71, 0, t511 + t541)
  t550 = t100 ** 2
  t552 = t116 ** 2
  t584 = 0.363830956076596391040e5 / t550 * t552 - 0.311855105208511192320e5 * t129 * t116 * t178 + 0.25987925434042599360e4 * t133 * t464 + 0.34650567245390132480e4 * t134 * t234 - 0.1732528362269506624e3 * t182 * t543 + 0.68585269493506671360e4 * t129 * t552 - 0.68585269493506671360e4 * t298 * t178 + 0.6858526949350667136e3 * t182 * t464 + 0.9144702599134222848e3 * t239 * t234 - 0.571543912445888928e2 * t101 * t543 + 0.251378462403360e3 * t133 * t552 - 0.301654154884032e3 * t302 * t178 + 0.37706769360504e2 * t101 * t464 + 0.50275692480672e2 * t246 * t234 - 0.4189641040056e1 * t104 * t543
  t594 = t310 ** 2
  t598 = 0.11708998680000000000000000000000000000000000000000e2 * t314 * t178 * t316 * t318 - 0.23417997360000000000000000000000000000000000000000e2 * t408 * t117 * t126 * t261 - 0.39029995600000000000000000000000000000000000000000e1 * t314 * t234 * t126 * t261 - 0.11708998680000000000000000000000000000000000000000e2 * t255 * t342 - 0.60000000000000000000000000000000000000000000000000e1 * t368 * t329 + 0.23417997360000000000000000000000000000000000000000e2 * t22 * t323 - 0.60000000000000000000000000000000000000000000000000e1 * t274 * t311 - 0.23417997360000000000000000000000000000000000000000e2 * t380 * t347 - 0.58544993400000000000000000000000000000000000000000e1 * t115 * t104 * t464 * t108 - 0.60000000000000000000000000000000000000000000000000e1 * t115 * t124 / t357 / t107 * t472 + 0.97574989000000000000000000000000000000000000000000e0 * t115 * t74 * t543 * t108 + 0.23417997360000000000000000000000000000000000000000e2 * t255 * t319 + 0.25000000000000000000000000000000000000000000000000e0 * t115 * t127 * t584 - 0.23417997360000000000000000000000000000000000000000e2 * t274 * t335 + 0.23417997360000000000000000000000000000000000000000e2 * t380 * t351 - 0.60000000000000000000000000000000000000000000000000e1 * t294 * t265 - 0.15000000000000000000000000000000000000000000000000e1 * t115 * t338 * t594
  t611 = f.my_piecewise5(t13, 0, t15, 0, t501)
  t625 = t282 * t2
  t641 = t310 * t261
  t645 = 0.60000000000000000000000000000000000000000000000000e1 * t22 * t339 + 0.46835994720000000000000000000000000000000000000000e2 * t274 * t323 - 0.11708998680000000000000000000000000000000000000000e2 * t255 * t365 + 0.20000000000000000000000000000000000000000000000000e1 * t268 * t269 * t281 - 0.11708998680000000000000000000000000000000000000000e2 * t22 * t335 + 0.50000000000000000000000000000000000000000000000000e0 * t112 * t611 * t284 - 0.30000000000000000000000000000000000000000000000000e1 * t22 * t311 + 0.12000000000000000000000000000000000000000000000000e2 * t274 * t339 - 0.23417997360000000000000000000000000000000000000000e2 * t115 * t182 * t552 * t108 - 0.23417997360000000000000000000000000000000000000000e2 * t294 * t109 - 0.20000000000000000000000000000000000000000000000000e1 * t625 * t265 - 0.78059991200000000000000000000000000000000000000000e1 * t625 * t109 - 0.11708998680000000000000000000000000000000000000000e2 * t295 * t335 - 0.39029995600000000000000000000000000000000000000000e1 * t314 * t256 * t251 - 0.12000000000000000000000000000000000000000000000000e2 * t289 * t361 - 0.23417997360000000000000000000000000000000000000000e2 * t314 * t98 * t358 * t360 + 0.12000000000000000000000000000000000000000000000000e2 * t289 * t338 * t641
  t680 = t270 ** 2
  t697 = 0.23417997360000000000000000000000000000000000000000e2 * t289 * t99 * t369 + 0.23417997360000000000000000000000000000000000000000e2 * t314 * t317 * t641 + 0.46835994720000000000000000000000000000000000000000e2 * t289 * t259 * t377 + 0.23417997360000000000000000000000000000000000000000e2 * t295 * t291 + 0.23417997360000000000000000000000000000000000000000e2 * t345 * t364 * t261 * t98 + 0.23417997360000000000000000000000000000000000000000e2 * t289 * t334 * t290 - 0.46835994720000000000000000000000000000000000000000e2 * t289 * t322 * t290 - 0.46835994720000000000000000000000000000000000000000e2 * t289 * t99 * t374 - 0.23417997360000000000000000000000000000000000000000e2 * t21 * t74 * t346 + 0.60000000000000000000000000000000000000000000000000e1 * t368 * t358 * t360 + 0.23417997360000000000000000000000000000000000000000e2 * t114 * t101 * t117 * t108 + 0.15000000000000000000000000000000000000000000000000e1 * t680 * t2 * t269 + 0.20000000000000000000000000000000000000000000000000e1 * t282 * t269 + 0.10000000000000000000000000000000000000000000000000e1 * t368 * t126 * t251 + 0.60000000000000000000000000000000000000000000000000e1 * t20 * t124 * t108 * t270 + 0.39029995600000000000000000000000000000000000000000e1 * t255 * t421 - 0.60000000000000000000000000000000000000000000000000e1 * t354 * t290
  t700 = f.my_piecewise3(t11, 0, t441 + t598 + t645 + t697)
  d1111 = t2 * t700 + 0.4e1 * t386

  res = {'v4rho4': d1111}
  return res
