import{f as Q,a as A,V as M,Q as w,o as J,y as $,g as W,b0 as Z,L as f}from"./index-C7ioxznG.js";class h{constructor(e){this.value=this._toInt(e)}_toInt(e){return e|0}add(e){return new h(this.value+e.value)}subtract(e){return new h(this.value-e.value)}multiply(e){return new h(Math.imul(this.value,e.value))}divide(e){return new h(this.value/e.value)}getClassName(){return h.ClassName}equals(e){return this.value===e.value}static FromValue(e){return new h(e)}toString(){return this.value.toString()}}h.ClassName="FlowGraphInteger";Q("FlowGraphInteger",h);class g{constructor(e=[1,0,0,1]){this._m=e}get m(){return this._m}transformVector(e){return this.transformVectorToRef(e,new A)}transformVectorToRef(e,n){return n.x=e.x*this._m[0]+e.y*this._m[1],n.y=e.x*this._m[2]+e.y*this._m[3],n}asArray(){return this.toArray()}toArray(e=[]){for(let n=0;n<4;n++)e[n]=this._m[n];return e}fromArray(e){for(let n=0;n<4;n++)this._m[n]=e[n];return this}multiplyToRef(e,n){const o=e._m,t=this._m,a=n._m;return a[0]=o[0]*t[0]+o[1]*t[2],a[1]=o[0]*t[1]+o[1]*t[3],a[2]=o[2]*t[0]+o[3]*t[2],a[3]=o[2]*t[1]+o[3]*t[3],n}multiply(e){return this.multiplyToRef(e,new g)}divideToRef(e,n){const o=this._m,t=e._m,a=n._m;return a[0]=o[0]/t[0],a[1]=o[1]/t[1],a[2]=o[2]/t[2],a[3]=o[3]/t[3],n}divide(e){return this.divideToRef(e,new g)}addToRef(e,n){const o=this._m,t=e.m,a=n.m;return a[0]=o[0]+t[0],a[1]=o[1]+t[1],a[2]=o[2]+t[2],a[3]=o[3]+t[3],n}add(e){return this.addToRef(e,new g)}subtractToRef(e,n){const o=this._m,t=e.m,a=n.m;return a[0]=o[0]-t[0],a[1]=o[1]-t[1],a[2]=o[2]-t[2],a[3]=o[3]-t[3],n}subtract(e){return this.subtractToRef(e,new g)}transpose(){const e=this._m;return new g([e[0],e[2],e[1],e[3]])}determinant(){const e=this._m;return e[0]*e[3]-e[1]*e[2]}inverse(){const e=this.determinant();if(e===0)throw new Error("Matrix is not invertible");const n=this._m,o=1/e;return new g([n[3]*o,-n[1]*o,-n[2]*o,n[0]*o])}equals(e,n=0){const o=this._m,t=e.m;return n===0?o[0]===t[0]&&o[1]===t[1]&&o[2]===t[2]&&o[3]===t[3]:Math.abs(o[0]-t[0])<n&&Math.abs(o[1]-t[1])<n&&Math.abs(o[2]-t[2])<n&&Math.abs(o[3]-t[3])<n}getClassName(){return"FlowGraphMatrix2D"}toString(){return`FlowGraphMatrix2D(${this._m.join(", ")})`}}class v{constructor(e=[1,0,0,0,1,0,0,0,1]){this._m=e}get m(){return this._m}transformVector(e){return this.transformVectorToRef(e,new M)}transformVectorToRef(e,n){const o=this._m;return n.x=e.x*o[0]+e.y*o[1]+e.z*o[2],n.y=e.x*o[3]+e.y*o[4]+e.z*o[5],n.z=e.x*o[6]+e.y*o[7]+e.z*o[8],n}multiplyToRef(e,n){const o=e._m,t=this._m,a=n.m;return a[0]=o[0]*t[0]+o[1]*t[3]+o[2]*t[6],a[1]=o[0]*t[1]+o[1]*t[4]+o[2]*t[7],a[2]=o[0]*t[2]+o[1]*t[5]+o[2]*t[8],a[3]=o[3]*t[0]+o[4]*t[3]+o[5]*t[6],a[4]=o[3]*t[1]+o[4]*t[4]+o[5]*t[7],a[5]=o[3]*t[2]+o[4]*t[5]+o[5]*t[8],a[6]=o[6]*t[0]+o[7]*t[3]+o[8]*t[6],a[7]=o[6]*t[1]+o[7]*t[4]+o[8]*t[7],a[8]=o[6]*t[2]+o[7]*t[5]+o[8]*t[8],n}multiply(e){return this.multiplyToRef(e,new v)}divideToRef(e,n){const o=this._m,t=e.m,a=n.m;return a[0]=o[0]/t[0],a[1]=o[1]/t[1],a[2]=o[2]/t[2],a[3]=o[3]/t[3],a[4]=o[4]/t[4],a[5]=o[5]/t[5],a[6]=o[6]/t[6],a[7]=o[7]/t[7],a[8]=o[8]/t[8],n}divide(e){return this.divideToRef(e,new v)}addToRef(e,n){const o=this._m,t=e.m,a=n.m;return a[0]=o[0]+t[0],a[1]=o[1]+t[1],a[2]=o[2]+t[2],a[3]=o[3]+t[3],a[4]=o[4]+t[4],a[5]=o[5]+t[5],a[6]=o[6]+t[6],a[7]=o[7]+t[7],a[8]=o[8]+t[8],n}add(e){return this.addToRef(e,new v)}subtractToRef(e,n){const o=this._m,t=e.m,a=n.m;return a[0]=o[0]-t[0],a[1]=o[1]-t[1],a[2]=o[2]-t[2],a[3]=o[3]-t[3],a[4]=o[4]-t[4],a[5]=o[5]-t[5],a[6]=o[6]-t[6],a[7]=o[7]-t[7],a[8]=o[8]-t[8],n}subtract(e){return this.subtractToRef(e,new v)}toArray(e=[]){for(let n=0;n<9;n++)e[n]=this._m[n];return e}asArray(){return this.toArray()}fromArray(e){for(let n=0;n<9;n++)this._m[n]=e[n];return this}transpose(){const e=this._m;return new v([e[0],e[3],e[6],e[1],e[4],e[7],e[2],e[5],e[8]])}determinant(){const e=this._m;return e[0]*(e[4]*e[8]-e[5]*e[7])-e[1]*(e[3]*e[8]-e[5]*e[6])+e[2]*(e[3]*e[7]-e[4]*e[6])}inverse(){const e=this.determinant();if(e===0)throw new Error("Matrix is not invertible");const n=this._m,o=1/e;return new v([(n[4]*n[8]-n[5]*n[7])*o,(n[2]*n[7]-n[1]*n[8])*o,(n[1]*n[5]-n[2]*n[4])*o,(n[5]*n[6]-n[3]*n[8])*o,(n[0]*n[8]-n[2]*n[6])*o,(n[2]*n[3]-n[0]*n[5])*o,(n[3]*n[7]-n[4]*n[6])*o,(n[1]*n[6]-n[0]*n[7])*o,(n[0]*n[4]-n[1]*n[3])*o])}equals(e,n=0){const o=this._m,t=e.m;return n===0?o[0]===t[0]&&o[1]===t[1]&&o[2]===t[2]&&o[3]===t[3]&&o[4]===t[4]&&o[5]===t[5]&&o[6]===t[6]&&o[7]===t[7]&&o[8]===t[8]:Math.abs(o[0]-t[0])<n&&Math.abs(o[1]-t[1])<n&&Math.abs(o[2]-t[2])<n&&Math.abs(o[3]-t[3])<n&&Math.abs(o[4]-t[4])<n&&Math.abs(o[5]-t[5])<n&&Math.abs(o[6]-t[6])<n&&Math.abs(o[7]-t[7])<n&&Math.abs(o[8]-t[8])<n}getClassName(){return"FlowGraphMatrix3D"}toString(){return`FlowGraphMatrix3D(${this._m.join(", ")})`}}var P;(function(r){r.Any="any",r.String="string",r.Number="number",r.Boolean="boolean",r.Object="object",r.Integer="FlowGraphInteger",r.Vector2="Vector2",r.Vector3="Vector3",r.Vector4="Vector4",r.Quaternion="Quaternion",r.Matrix="Matrix",r.Matrix2D="Matrix2D",r.Matrix3D="Matrix3D",r.Color3="Color3",r.Color4="Color4"})(P||(P={}));class m{constructor(e,n,o=-1){this.typeName=e,this.defaultValue=n,this.animationType=o}serialize(e){e.typeName=this.typeName,e.defaultValue=this.defaultValue}}const y=new m("any",void 0),R=new m("string",""),B=new m("number",0,0),E=new m("boolean",!1),_=new m("Vector2",A.Zero(),5),F=new m("Vector3",M.Zero(),1),N=new m("Vector4",$.Zero()),G=new m("Matrix",J.Identity(),3),S=new m("Matrix2D",new g),D=new m("Matrix3D",new v),T=new m("Color3",Z.Black(),4),x=new m("Color4",new W(0,0,0,0),7),d=new m("Quaternion",w.Identity(),2);d.typeTransformer=r=>{if(r.getClassName){if(r.getClassName()==="Vector4")return w.FromArray(r.asArray());if(r.getClassName()==="Vector3")return w.FromEulerVector(r);if(r.getClassName()==="Matrix")return w.FromRotationMatrix(r)}return r};const q=new m("FlowGraphInteger",new h(0),0);function Y(r){const e=r;switch(typeof r){case"string":return R;case"number":return B;case"boolean":return E;case"object":if(e.getClassName)switch(e.getClassName()){case"Vector2":return _;case"Vector3":return F;case"Vector4":return N;case"Matrix":return G;case"Color3":return T;case"Color4":return x;case"Quaternion":return d;case"FlowGraphInteger":return q;case"Matrix2D":return S;case"Matrix3D":return D}return y;default:return y}}function j(r){switch(r){case"string":return R;case"number":return B;case"boolean":return E;case"Vector2":return _;case"Vector3":return F;case"Vector4":return N;case"Matrix":return G;case"Color3":return T;case"Color4":return x;case"Quaternion":return d;case"FlowGraphInteger":return q;case"Matrix2D":return S;case"Matrix3D":return D;default:return y}}function H(r){switch(r){case"number":return 0;case"Vector2":return 5;case"Vector3":return 1;case"Matrix":return 3;case"Color3":return 4;case"Color4":return 7;case"Quaternion":return 2;default:return 0}}function O(r){switch(r){case 0:return B;case 5:return _;case 1:return F;case 3:return G;case 4:return T;case 7:return x;case 2:return d;default:return y}}function z(r){const[e,n]=r.split(":");return K({op:e,extension:n})}function K(r,e=!0){var o;const n=r.extension?(o=b[r.extension])==null?void 0:o[r.op]:U[r.op];if(!n&&(f.Warn(`No mapping found for operation ${r.op} and extension ${r.extension||"KHR_interactivity"}`),e)){const t={},a={flows:{}};if(r.inputValueSockets){t.values={};for(const l in r.inputValueSockets)t.values[l]={name:l}}return r.outputValueSockets&&(a.values={},Object.keys(r.outputValueSockets).forEach(l=>{a.values[l]={name:l}})),{blocks:[],inputs:t,outputs:a}}return n}function tt(r,e,n){b[e]||(b[e]={}),b[e][r]=n}const b={BABYLON:{"flow/log":{blocks:["FlowGraphConsoleLogBlock"],inputs:{values:{message:{name:"message"}}}}}},U={"event/onStart":{blocks:["FlowGraphSceneReadyEventBlock"],outputs:{flows:{out:{name:"done"}}}},"event/onTick":{blocks:["FlowGraphSceneTickEventBlock"],inputs:{},outputs:{values:{timeSinceLastTick:{name:"deltaTime",gltfType:"number"}},flows:{out:{name:"done"}}}},"event/send":{blocks:["FlowGraphSendCustomEventBlock"],extraProcessor(r,e,n,o,t){var c;if(e.op!=="event/send"||!r.configuration||Object.keys(r.configuration).length!==1)throw new Error("Receive event should have a single configuration object, the event itself");const l=(c=r.configuration.event.value)==null?void 0:c[0];if(typeof l!="number")throw new Error("Event id should be a number");const i=o.arrays.events[l],s=t[0];return s.config||(s.config={}),s.config.eventId=i.eventId,s.config.eventData=i.eventData,t}},"event/receive":{blocks:["FlowGraphReceiveCustomEventBlock"],outputs:{flows:{out:{name:"done"}}},validation(r,e){var a,l;if(!r.configuration)return f.Error("Receive event should have a configuration object"),{valid:!1,error:"Receive event should have a configuration object"};const n=r.configuration.event;if(!n)return f.Error("Receive event should have a single configuration object, the event itself"),{valid:!1,error:"Receive event should have a single configuration object, the event itself"};const o=(a=n.value)==null?void 0:a[0];return typeof o!="number"?(f.Error("Event id should be a number"),{valid:!1,error:"Event id should be a number"}):((l=e.events)==null?void 0:l[o])?{valid:!0}:(f.Error(`Event with id ${o} not found`),{valid:!1,error:`Event with id ${o} not found`})},extraProcessor(r,e,n,o,t){var c;if(e.op!=="event/receive"||!r.configuration||Object.keys(r.configuration).length!==1)throw new Error("Receive event should have a single configuration object, the event itself");const l=(c=r.configuration.event.value)==null?void 0:c[0];if(typeof l!="number")throw new Error("Event id should be a number");const i=o.arrays.events[l],s=t[0];return s.config||(s.config={}),s.config.eventId=i.eventId,s.config.eventData=i.eventData,t}},"math/E":u("FlowGraphEBlock"),"math/Pi":u("FlowGraphPIBlock"),"math/Inf":u("FlowGraphInfBlock"),"math/NaN":u("FlowGraphNaNBlock"),"math/abs":u("FlowGraphAbsBlock"),"math/sign":u("FlowGraphSignBlock"),"math/trunc":u("FlowGraphTruncBlock"),"math/floor":u("FlowGraphFloorBlock"),"math/ceil":u("FlowGraphCeilBlock"),"math/round":{blocks:["FlowGraphRoundBlock"],configuration:{},inputs:{values:{a:{name:"a"}}},outputs:{values:{value:{name:"value"}}},extraProcessor(r,e,n,o,t){var a;return(a=t[0]).config||(a.config={}),t[0].config.roundHalfAwayFromZero=!0,t}},"math/fract":u("FlowGraphFractBlock"),"math/neg":u("FlowGraphNegationBlock"),"math/add":u("FlowGraphAddBlock",["a","b"],!0),"math/sub":u("FlowGraphSubtractBlock",["a","b"],!0),"math/mul":{blocks:["FlowGraphMultiplyBlock"],extraProcessor(r,e,n,o,t){var a;(a=t[0]).config||(a.config={}),t[0].config.useMatrixPerComponent=!0,t[0].config.preventIntegerFloatArithmetic=!0;let l=-1;return Object.keys(r.values||{}).find(i=>{var s;return((s=r.values)==null?void 0:s[i].type)!==void 0?(l=r.values[i].type,!0):!1}),l!==-1&&(t[0].config.type=o.arrays.types[l].flowGraphType),t},validation(r){return r.values?L(r):{valid:!0}}},"math/div":u("FlowGraphDivideBlock",["a","b"],!0),"math/rem":u("FlowGraphModuloBlock",["a","b"]),"math/min":u("FlowGraphMinBlock",["a","b"]),"math/max":u("FlowGraphMaxBlock",["a","b"]),"math/clamp":u("FlowGraphClampBlock",["a","b","c"]),"math/saturate":u("FlowGraphSaturateBlock"),"math/mix":u("FlowGraphMathInterpolationBlock",["a","b","c"]),"math/eq":u("FlowGraphEqualityBlock",["a","b"]),"math/lt":u("FlowGraphLessThanBlock",["a","b"]),"math/le":u("FlowGraphLessThanOrEqualBlock",["a","b"]),"math/gt":u("FlowGraphGreaterThanBlock",["a","b"]),"math/ge":u("FlowGraphGreaterThanOrEqualBlock",["a","b"]),"math/isNaN":u("FlowGraphIsNaNBlock"),"math/isInf":u("FlowGraphIsInfBlock"),"math/select":{blocks:["FlowGraphConditionalBlock"],inputs:{values:{condition:{name:"condition"},a:{name:"onTrue"},b:{name:"onFalse"}}},outputs:{values:{value:{name:"output"}}}},"math/random":{blocks:["FlowGraphRandomBlock"],outputs:{values:{value:{name:"value"}}}},"math/sin":u("FlowGraphSinBlock"),"math/cos":u("FlowGraphCosBlock"),"math/tan":u("FlowGraphTanBlock"),"math/asin":u("FlowGraphASinBlock"),"math/acos":u("FlowGraphACosBlock"),"math/atan":u("FlowGraphATanBlock"),"math/atan2":u("FlowGraphATan2Block",["a","b"]),"math/sinh":u("FlowGraphSinhBlock"),"math/cosh":u("FlowGraphCoshBlock"),"math/tanh":u("FlowGraphTanhBlock"),"math/asinh":u("FlowGraphASinhBlock"),"math/acosh":u("FlowGraphACoshBlock"),"math/atanh":u("FlowGraphATanhBlock"),"math/exp":u("FlowGraphExponentialBlock"),"math/log":u("FlowGraphLogBlock"),"math/log2":u("FlowGraphLog2Block"),"math/log10":u("FlowGraphLog10Block"),"math/sqrt":u("FlowGraphSquareRootBlock"),"math/cbrt":u("FlowGraphCubeRootBlock"),"math/pow":u("FlowGraphPowerBlock",["a","b"]),"math/length":u("FlowGraphLengthBlock"),"math/normalize":u("FlowGraphNormalizeBlock"),"math/dot":u("FlowGraphDotBlock",["a","b"]),"math/cross":u("FlowGraphCrossBlock",["a","b"]),"math/rotate2D":{blocks:["FlowGraphRotate2DBlock"],inputs:{values:{a:{name:"a"},angle:{name:"b"}}},outputs:{values:{value:{name:"value"}}}},"math/rotate3D":{blocks:["FlowGraphRotate3DBlock"],inputs:{values:{a:{name:"a"},rotation:{name:"b"}}},outputs:{values:{value:{name:"value"}}}},"math/transform":{blocks:["FlowGraphTransformVectorBlock"],inputs:{values:{a:{name:"a"},b:{name:"b"}}},outputs:{values:{value:{name:"value"}}}},"math/combine2":{blocks:["FlowGraphCombineVector2Block"],inputs:{values:{a:{name:"input_0",gltfType:"number"},b:{name:"input_1",gltfType:"number"}}},outputs:{values:{value:{name:"value"}}}},"math/combine3":{blocks:["FlowGraphCombineVector3Block"],inputs:{values:{a:{name:"input_0",gltfType:"number"},b:{name:"input_1",gltfType:"number"},c:{name:"input_2",gltfType:"number"}}},outputs:{values:{value:{name:"value"}}}},"math/combine4":{blocks:["FlowGraphCombineVector4Block"],inputs:{values:{a:{name:"input_0",gltfType:"number"},b:{name:"input_1",gltfType:"number"},c:{name:"input_2",gltfType:"number"},d:{name:"input_3",gltfType:"number"}}},outputs:{values:{value:{name:"value"}}}},"math/extract2":{blocks:["FlowGraphExtractVector2Block"],inputs:{values:{a:{name:"input",gltfType:"number"}}},outputs:{values:{0:{name:"output_0"},1:{name:"output_1"}}}},"math/extract3":{blocks:["FlowGraphExtractVector3Block"],inputs:{values:{a:{name:"input",gltfType:"number"}}},outputs:{values:{0:{name:"output_0"},1:{name:"output_1"},2:{name:"output_2"}}}},"math/extract4":{blocks:["FlowGraphExtractVector4Block"],inputs:{values:{a:{name:"input",gltfType:"number"}}},outputs:{values:{0:{name:"output_0"},1:{name:"output_1"},2:{name:"output_2"},3:{name:"output_3"}}}},"math/transpose":u("FlowGraphTransposeBlock"),"math/determinant":u("FlowGraphDeterminantBlock"),"math/inverse":u("FlowGraphInvertMatrixBlock"),"math/matMul":u("FlowGraphMatrixMultiplicationBlock",["a","b"]),"math/matCompose":{blocks:["FlowGraphMatrixCompose"],inputs:{values:{translation:{name:"position",gltfType:"float3"},rotation:{name:"rotationQuaternion",gltfType:"float4"},scale:{name:"scaling",gltfType:"float3"}}},outputs:{values:{value:{name:"value"}}},extraProcessor(r,e,n,o,t,a){const l=t[0].dataInputs.find(i=>i.name==="rotationQuaternion");if(!l)throw new Error("Rotation quaternion input not found");return a._connectionValues[l.uniqueId]&&(a._connectionValues[l.uniqueId].type="Quaternion"),t}},"math/matDecompose":{blocks:["FlowGraphMatrixDecompose"],inputs:{values:{a:{name:"input",gltfType:"number"}}},outputs:{values:{translation:{name:"position"},rotation:{name:"rotationQuaternion"},scale:{name:"scaling"}}}},"math/quatConjugate":u("FlowGraphConjugateBlock",["a"]),"math/quatMul":{blocks:["FlowGraphMultiplyBlock"],inputs:{values:{a:{name:"a",gltfType:"vector4"},b:{name:"b",gltfType:"vector4"}}},outputs:{values:{value:{name:"value"}}},extraProcessor(r,e,n,o,t){var a;return(a=t[0]).config||(a.config={}),t[0].config.type="Quaternion",t}},"math/quatAngleBetween":u("FlowGraphAngleBetweenBlock",["a","b"]),"math/quatFromAxisAngle":{blocks:["FlowGraphQuaternionFromAxisAngleBlock"],inputs:{values:{axis:{name:"a",gltfType:"float3"},angle:{name:"b",gltfType:"number"}}},outputs:{values:{value:{name:"value"}}}},"math/quatToAxisAngle":u("FlowGraphAxisAngleFromQuaternionBlock",["a"]),"math/quatFromDirections":u("FlowGraphQuaternionFromDirectionsBlock",["a","b"]),"math/combine2x2":{blocks:["FlowGraphCombineMatrix2DBlock"],inputs:{values:{a:{name:"input_0",gltfType:"number"},b:{name:"input_1",gltfType:"number"},c:{name:"input_2",gltfType:"number"},d:{name:"input_3",gltfType:"number"}}},outputs:{values:{value:{name:"value"}}},extraProcessor(r,e,n,o,t){var a;return(a=t[0]).config||(a.config={}),t[0].config.inputIsColumnMajor=!0,t}},"math/extract2x2":{blocks:["FlowGraphExtractMatrix2DBlock"],inputs:{values:{a:{name:"input",gltfType:"float2x2"}}},outputs:{values:{0:{name:"output_0"},1:{name:"output_1"},2:{name:"output_2"},3:{name:"output_3"}}}},"math/combine3x3":{blocks:["FlowGraphCombineMatrix3DBlock"],inputs:{values:{a:{name:"input_0",gltfType:"number"},b:{name:"input_1",gltfType:"number"},c:{name:"input_2",gltfType:"number"},d:{name:"input_3",gltfType:"number"},e:{name:"input_4",gltfType:"number"},f:{name:"input_5",gltfType:"number"},g:{name:"input_6",gltfType:"number"},h:{name:"input_7",gltfType:"number"},i:{name:"input_8",gltfType:"number"}}},outputs:{values:{value:{name:"value"}}},extraProcessor(r,e,n,o,t){var a;return(a=t[0]).config||(a.config={}),t[0].config.inputIsColumnMajor=!0,t}},"math/extract3x3":{blocks:["FlowGraphExtractMatrix3DBlock"],inputs:{values:{a:{name:"input",gltfType:"float3x3"}}},outputs:{values:{0:{name:"output_0"},1:{name:"output_1"},2:{name:"output_2"},3:{name:"output_3"},4:{name:"output_4"},5:{name:"output_5"},6:{name:"output_6"},7:{name:"output_7"},8:{name:"output_8"}}}},"math/combine4x4":{blocks:["FlowGraphCombineMatrixBlock"],inputs:{values:{a:{name:"input_0",gltfType:"number"},b:{name:"input_1",gltfType:"number"},c:{name:"input_2",gltfType:"number"},d:{name:"input_3",gltfType:"number"},e:{name:"input_4",gltfType:"number"},f:{name:"input_5",gltfType:"number"},g:{name:"input_6",gltfType:"number"},h:{name:"input_7",gltfType:"number"},i:{name:"input_8",gltfType:"number"},j:{name:"input_9",gltfType:"number"},k:{name:"input_10",gltfType:"number"},l:{name:"input_11",gltfType:"number"},m:{name:"input_12",gltfType:"number"},n:{name:"input_13",gltfType:"number"},o:{name:"input_14",gltfType:"number"},p:{name:"input_15",gltfType:"number"}}},outputs:{values:{value:{name:"value"}}},extraProcessor(r,e,n,o,t){var a;return(a=t[0]).config||(a.config={}),t[0].config.inputIsColumnMajor=!0,t}},"math/extract4x4":{blocks:["FlowGraphExtractMatrixBlock"],configuration:{},inputs:{values:{a:{name:"input",gltfType:"number"}}},outputs:{values:{0:{name:"output_0"},1:{name:"output_1"},2:{name:"output_2"},3:{name:"output_3"},4:{name:"output_4"},5:{name:"output_5"},6:{name:"output_6"},7:{name:"output_7"},8:{name:"output_8"},9:{name:"output_9"},10:{name:"output_10"},11:{name:"output_11"},12:{name:"output_12"},13:{name:"output_13"},14:{name:"output_14"},15:{name:"output_15"}}}},"math/not":{blocks:["FlowGraphBitwiseNotBlock"],inputs:{values:{a:{name:"a"}}},outputs:{values:{value:{name:"value"}}},extraProcessor(r,e,n,o,t,a){var s;var l;(l=t[0]).config||(l.config={});const i=t[0].dataInputs[0];return t[0].config.valueType=((s=a._connectionValues[i.uniqueId])==null?void 0:s.type)??"FlowGraphInteger",t}},"math/and":{blocks:["FlowGraphBitwiseAndBlock"],inputs:{values:{a:{name:"a"},b:{name:"b"}}},outputs:{values:{value:{name:"value"}}},extraProcessor(r,e,n,o,t,a){var c,p;var l;(l=t[0]).config||(l.config={});const i=t[0].dataInputs[0],s=t[0].dataInputs[1];return t[0].config.valueType=((c=a._connectionValues[i.uniqueId])==null?void 0:c.type)??((p=a._connectionValues[s.uniqueId])==null?void 0:p.type)??"FlowGraphInteger",t}},"math/or":{blocks:["FlowGraphBitwiseOrBlock"],inputs:{values:{a:{name:"a"},b:{name:"b"}}},outputs:{values:{value:{name:"value"}}},extraProcessor(r,e,n,o,t,a){var c,p;var l;(l=t[0]).config||(l.config={});const i=t[0].dataInputs[0],s=t[0].dataInputs[1];return t[0].config.valueType=((c=a._connectionValues[i.uniqueId])==null?void 0:c.type)??((p=a._connectionValues[s.uniqueId])==null?void 0:p.type)??"FlowGraphInteger",t}},"math/xor":{blocks:["FlowGraphBitwiseXorBlock"],inputs:{values:{a:{name:"a"},b:{name:"b"}}},outputs:{values:{value:{name:"value"}}},extraProcessor(r,e,n,o,t,a){var c,p;var l;(l=t[0]).config||(l.config={});const i=t[0].dataInputs[0],s=t[0].dataInputs[1];return t[0].config.valueType=((c=a._connectionValues[i.uniqueId])==null?void 0:c.type)??((p=a._connectionValues[s.uniqueId])==null?void 0:p.type)??"FlowGraphInteger",t}},"math/asr":u("FlowGraphBitwiseRightShiftBlock",["a","b"]),"math/lsl":u("FlowGraphBitwiseLeftShiftBlock",["a","b"]),"math/clz":u("FlowGraphLeadingZerosBlock"),"math/ctz":u("FlowGraphTrailingZerosBlock"),"math/popcnt":u("FlowGraphOneBitsCounterBlock"),"math/rad":u("FlowGraphDegToRadBlock"),"math/deg":u("FlowGraphRadToDegBlock"),"type/boolToInt":u("FlowGraphBooleanToInt"),"type/boolToFloat":u("FlowGraphBooleanToFloat"),"type/intToBool":u("FlowGraphIntToBoolean"),"type/intToFloat":u("FlowGraphIntToFloat"),"type/floatToInt":u("FlowGraphFloatToInt"),"type/floatToBool":u("FlowGraphFloatToBoolean"),"flow/sequence":{blocks:["FlowGraphSequenceBlock"],extraProcessor(r,e,n,o,t){const a=t[0];return a.config||(a.config={}),a.config.outputSignalCount=Object.keys(r.flows||[]).length,a.signalOutputs.forEach((l,i)=>{l.name="out_"+i}),t}},"flow/branch":{blocks:["FlowGraphBranchBlock"],outputs:{flows:{true:{name:"onTrue"},false:{name:"onFalse"}}}},"flow/switch":{blocks:["FlowGraphSwitchBlock"],configuration:{cases:{name:"cases",isArray:!0,inOptions:!0,defaultValue:[]}},inputs:{values:{selection:{name:"case"},default:{name:"default"}}},validation(r){var n;const e=(n=r.configuration)==null?void 0:n.cases;if(e&&e.value){if(!e.value.every(a=>typeof a=="number"&&/^-?\d+$/.test(a.toString())))return f.Warn("Switch cases should be integers. Using empty array instead."),e.value=[],{valid:!0};const t=new Set(e.value);e.value=Array.from(t)}return{valid:!0}},extraProcessor(r,e,n,o,t){if(e.op!=="flow/switch"||!r.flows||Object.keys(r.flows).length===0)throw new Error("Switch should have a single configuration object, the cases array");return t[0].signalOutputs.forEach(l=>{l.name!=="default"&&(l.name="out_"+l.name)}),t}},"flow/while":{blocks:["FlowGraphWhileLoopBlock"],outputs:{flows:{loopBody:{name:"executionFlow"}}}},"flow/for":{blocks:["FlowGraphForLoopBlock"],configuration:{initialIndex:{name:"initialIndex",gltfType:"number",inOptions:!0,defaultValue:0}},inputs:{values:{startIndex:{name:"startIndex",gltfType:"number"},endIndex:{name:"endIndex",gltfType:"number"}}},outputs:{values:{index:{name:"index"}},flows:{loopBody:{name:"executionFlow"}}},extraProcessor(r,e,n,o,t){const a=t[0];return a.config||(a.config={}),a.config.incrementIndexWhenLoopDone=!0,t}},"flow/doN":{blocks:["FlowGraphDoNBlock"],configuration:{},inputs:{values:{n:{name:"maxExecutions",gltfType:"number"}}},outputs:{values:{currentCount:{name:"executionCount"}}}},"flow/multiGate":{blocks:["FlowGraphMultiGateBlock"],configuration:{isRandom:{name:"isRandom",gltfType:"boolean",inOptions:!0,defaultValue:!1},isLoop:{name:"isLoop",gltfType:"boolean",inOptions:!0,defaultValue:!1}},extraProcessor(r,e,n,o,t){if(e.op!=="flow/multiGate"||!r.flows||Object.keys(r.flows).length===0)throw new Error("MultiGate should have a single configuration object, the number of output flows");const a=t[0];return a.config||(a.config={}),a.config.outputSignalCount=Object.keys(r.flows).length,a.signalOutputs.forEach((l,i)=>{l.name="out_"+i}),t}},"flow/waitAll":{blocks:["FlowGraphWaitAllBlock"],configuration:{inputFlows:{name:"inputSignalCount",gltfType:"number",inOptions:!0,defaultValue:0}},inputs:{flows:{reset:{name:"reset"},"[segment]":{name:"in_$1"}}},validation(r){var e,n,o;return typeof((o=(n=(e=r.configuration)==null?void 0:e.inputFlows)==null?void 0:n.value)==null?void 0:o[0])!="number"&&(r.configuration=r.configuration||{inputFlows:{value:[0]}},r.configuration.inputFlows.value=[0]),{valid:!0}}},"flow/throttle":{blocks:["FlowGraphThrottleBlock"],outputs:{flows:{err:{name:"error"}}}},"flow/setDelay":{blocks:["FlowGraphSetDelayBlock"],outputs:{flows:{err:{name:"error"}}}},"flow/cancelDelay":{blocks:["FlowGraphCancelDelayBlock"]},"variable/get":{blocks:["FlowGraphGetVariableBlock"],validation(r){var e,n;return(n=(e=r.configuration)==null?void 0:e.variable)!=null&&n.value?{valid:!0}:(f.Error("Variable get block should have a variable configuration"),{valid:!1,error:"Variable get block should have a variable configuration"})},configuration:{variable:{name:"variable",gltfType:"number",flowGraphType:"string",inOptions:!0,isVariable:!0,dataTransformer(r,e){return e.getVariableName(r)}}}},"variable/set":{blocks:["FlowGraphSetVariableBlock"],configuration:{variables:{name:"variables",gltfType:"number",flowGraphType:"string",inOptions:!0,isArray:!0,dataTransformer(r,e){return r.map(n=>e.getVariableName(n))}}},extraProcessor(r,e,n,o,t){return t[0].dataInputs.forEach(l=>{l.name=o.getVariableName(+l.name)}),t}},"variable/interpolate":{blocks:["FlowGraphInterpolationBlock","FlowGraphContextBlock","FlowGraphPlayAnimationBlock","FlowGraphBezierCurveEasing","FlowGraphGetVariableBlock"],configuration:{variable:{name:"propertyName",inOptions:!0,isVariable:!0,dataTransformer(r,e){return e.getVariableName(r)}},useSlerp:{name:"animationType",inOptions:!0,defaultValue:!1,dataTransformer(r){return r===!0?"Quaternion":void 0}}},inputs:{values:{value:{name:"value_1"},duration:{name:"duration_1",gltfType:"number"},p1:{name:"controlPoint1",toBlock:"FlowGraphBezierCurveEasing"},p2:{name:"controlPoint2",toBlock:"FlowGraphBezierCurveEasing"}},flows:{in:{name:"in",toBlock:"FlowGraphPlayAnimationBlock"}}},outputs:{flows:{err:{name:"error",toBlock:"FlowGraphPlayAnimationBlock"},out:{name:"out",toBlock:"FlowGraphPlayAnimationBlock"},done:{name:"done",toBlock:"FlowGraphPlayAnimationBlock"}}},interBlockConnectors:[{input:"object",output:"userVariables",inputBlockIndex:2,outputBlockIndex:1,isVariable:!0},{input:"animation",output:"animation",inputBlockIndex:2,outputBlockIndex:0,isVariable:!0},{input:"easingFunction",output:"easingFunction",inputBlockIndex:0,outputBlockIndex:3,isVariable:!0},{input:"value_0",output:"value",inputBlockIndex:0,outputBlockIndex:4,isVariable:!0}],extraProcessor(r,e,n,o,t){var k,I,V,C;var a,l;const i=t[0],s=(I=(k=r.configuration)==null?void 0:k.variable.value)==null?void 0:I[0];if(typeof s!="number")throw f.Error("Variable index is not defined for variable interpolation block"),new Error("Variable index is not defined for variable interpolation block");const c=o.arrays.staticVariables[s];typeof((C=(V=i.config)==null?void 0:V.animationType)==null?void 0:C.value)>"u"&&(i.config||(i.config={}),(a=i.config).animationType||(a.animationType={}),i.config.animationType.value=H(c.type));const p=t[4];return p.config||(p.config={}),(l=p.config).variable||(l.variable={}),p.config.variable.value=o.getVariableName(s),t}},"pointer/get":{blocks:["FlowGraphGetPropertyBlock","FlowGraphJsonPointerParserBlock"],configuration:{pointer:{name:"jsonPointer",toBlock:"FlowGraphJsonPointerParserBlock"}},inputs:{values:{"[segment]":{name:"$1",toBlock:"FlowGraphJsonPointerParserBlock"}}},interBlockConnectors:[{input:"object",output:"object",inputBlockIndex:0,outputBlockIndex:1,isVariable:!0},{input:"propertyName",output:"propertyName",inputBlockIndex:0,outputBlockIndex:1,isVariable:!0},{input:"customGetFunction",output:"getFunction",inputBlockIndex:0,outputBlockIndex:1,isVariable:!0}],extraProcessor(r,e,n,o,t){return t.forEach(a=>{a.className==="FlowGraphJsonPointerParserBlock"&&(a.config||(a.config={}),a.config.outputValue=!0)}),t}},"pointer/set":{blocks:["FlowGraphSetPropertyBlock","FlowGraphJsonPointerParserBlock"],configuration:{pointer:{name:"jsonPointer",toBlock:"FlowGraphJsonPointerParserBlock"}},inputs:{values:{value:{name:"value"},"[segment]":{name:"$1",toBlock:"FlowGraphJsonPointerParserBlock"}}},outputs:{flows:{err:{name:"error"}}},interBlockConnectors:[{input:"object",output:"object",inputBlockIndex:0,outputBlockIndex:1,isVariable:!0},{input:"propertyName",output:"propertyName",inputBlockIndex:0,outputBlockIndex:1,isVariable:!0},{input:"customSetFunction",output:"setFunction",inputBlockIndex:0,outputBlockIndex:1,isVariable:!0}],extraProcessor(r,e,n,o,t){return t.forEach(a=>{a.className==="FlowGraphJsonPointerParserBlock"&&(a.config||(a.config={}),a.config.outputValue=!0)}),t}},"pointer/interpolate":{blocks:["FlowGraphInterpolationBlock","FlowGraphJsonPointerParserBlock","FlowGraphPlayAnimationBlock","FlowGraphBezierCurveEasing"],configuration:{pointer:{name:"jsonPointer",toBlock:"FlowGraphJsonPointerParserBlock"}},inputs:{values:{value:{name:"value_1"},"[segment]":{name:"$1",toBlock:"FlowGraphJsonPointerParserBlock"},duration:{name:"duration_1",gltfType:"number"},p1:{name:"controlPoint1",toBlock:"FlowGraphBezierCurveEasing"},p2:{name:"controlPoint2",toBlock:"FlowGraphBezierCurveEasing"}},flows:{in:{name:"in",toBlock:"FlowGraphPlayAnimationBlock"}}},outputs:{flows:{err:{name:"error",toBlock:"FlowGraphPlayAnimationBlock"},out:{name:"out",toBlock:"FlowGraphPlayAnimationBlock"},done:{name:"done",toBlock:"FlowGraphPlayAnimationBlock"}}},interBlockConnectors:[{input:"object",output:"object",inputBlockIndex:2,outputBlockIndex:1,isVariable:!0},{input:"propertyName",output:"propertyName",inputBlockIndex:0,outputBlockIndex:1,isVariable:!0},{input:"customBuildAnimation",output:"generateAnimationsFunction",inputBlockIndex:0,outputBlockIndex:1,isVariable:!0},{input:"animation",output:"animation",inputBlockIndex:2,outputBlockIndex:0,isVariable:!0},{input:"easingFunction",output:"easingFunction",inputBlockIndex:0,outputBlockIndex:3,isVariable:!0},{input:"value_0",output:"value",inputBlockIndex:0,outputBlockIndex:1,isVariable:!0}],extraProcessor(r,e,n,o,t){return t.forEach(a=>{a.className==="FlowGraphJsonPointerParserBlock"?(a.config||(a.config={}),a.config.outputValue=!0):a.className==="FlowGraphInterpolationBlock"&&(a.config||(a.config={}),Object.keys(r.values||[]).forEach(l=>{var s;const i=(s=r.values)==null?void 0:s[l];if(l==="value"&&i){const c=i.type;c!==void 0&&(a.config.animationType=o.arrays.types[c].flowGraphType)}}))}),t}},"animation/start":{blocks:["FlowGraphPlayAnimationBlock","FlowGraphArrayIndexBlock","KHR_interactivity/FlowGraphGLTFDataProvider"],inputs:{values:{animation:{name:"index",gltfType:"number",toBlock:"FlowGraphArrayIndexBlock"},speed:{name:"speed",gltfType:"number"},startTime:{name:"from",gltfType:"number",dataTransformer:(r,e)=>[r[0]*e._animationTargetFps]},endTime:{name:"to",gltfType:"number",dataTransformer:(r,e)=>[r[0]*e._animationTargetFps]}}},outputs:{flows:{err:{name:"error"}}},interBlockConnectors:[{input:"animationGroup",output:"value",inputBlockIndex:0,outputBlockIndex:1,isVariable:!0},{input:"array",output:"animationGroups",inputBlockIndex:1,outputBlockIndex:2,isVariable:!0}],extraProcessor(r,e,n,o,t,a,l){const i=t[t.length-1];return i.config||(i.config={}),i.config.glTF=l,t}},"animation/stop":{blocks:["FlowGraphStopAnimationBlock","FlowGraphArrayIndexBlock","KHR_interactivity/FlowGraphGLTFDataProvider"],inputs:{values:{animation:{name:"index",gltfType:"number",toBlock:"FlowGraphArrayIndexBlock"}}},outputs:{flows:{err:{name:"error"}}},interBlockConnectors:[{input:"animationGroup",output:"value",inputBlockIndex:0,outputBlockIndex:1,isVariable:!0},{input:"array",output:"animationGroups",inputBlockIndex:1,outputBlockIndex:2,isVariable:!0}],extraProcessor(r,e,n,o,t,a,l){const i=t[t.length-1];return i.config||(i.config={}),i.config.glTF=l,t}},"animation/stopAt":{blocks:["FlowGraphStopAnimationBlock","FlowGraphArrayIndexBlock","KHR_interactivity/FlowGraphGLTFDataProvider"],configuration:{},inputs:{values:{animation:{name:"index",gltfType:"number",toBlock:"FlowGraphArrayIndexBlock"},stopTime:{name:"stopAtFrame",gltfType:"number",dataTransformer:(r,e)=>[r[0]*e._animationTargetFps]}}},outputs:{flows:{err:{name:"error"}}},interBlockConnectors:[{input:"animationGroup",output:"value",inputBlockIndex:0,outputBlockIndex:1,isVariable:!0},{input:"array",output:"animationGroups",inputBlockIndex:1,outputBlockIndex:2,isVariable:!0}],extraProcessor(r,e,n,o,t,a,l){const i=t[t.length-1];return i.config||(i.config={}),i.config.glTF=l,t}},"math/switch":{blocks:["FlowGraphDataSwitchBlock"],configuration:{cases:{name:"cases",isArray:!0,inOptions:!0,defaultValue:[]}},inputs:{values:{selection:{name:"case"}}},validation(r){var n;const e=(n=r.configuration)==null?void 0:n.cases;if(e&&e.value){if(!e.value.every(a=>typeof a=="number"&&/^-?\d+$/.test(a.toString())))return f.Warn("Switch cases should be integers. Using empty array instead."),e.value=[],{valid:!0};const t=new Set(e.value);e.value=Array.from(t)}return{valid:!0}},extraProcessor(r,e,n,o,t){const a=t[0];return a.dataInputs.forEach(l=>{l.name!=="default"&&l.name!=="case"&&(l.name="in_"+l.name)}),a.config||(a.config={}),a.config.treatCasesAsIntegers=!0,t}},"debug/log":{blocks:["FlowGraphConsoleLogBlock"],configuration:{message:{name:"messageTemplate",inOptions:!0}}}};function u(r,e=["a"],n){return{blocks:[r],inputs:{values:e.reduce((o,t)=>(o[t]={name:t},o),{})},outputs:{values:{value:{name:"value"}}},extraProcessor(o,t,a,l,i){var s;if(n){(s=i[0]).config||(s.config={}),i[0].config.preventIntegerFloatArithmetic=!0;let c=-1;Object.keys(o.values||{}).find(p=>{var k;return((k=o.values)==null?void 0:k[p].type)!==void 0?(c=o.values[p].type,!0):!1}),c!==-1&&(i[0].config.type=l.arrays.types[c].flowGraphType)}return i},validation(o){return n?L(o):{valid:!0}}}}function L(r){if(r.values){const e=Object.keys(r.values).map(o=>r.values[o].type).filter(o=>o!==void 0);if(!e.every(o=>o===e[0]))return{valid:!1,error:"All inputs must be of the same type"}}return{valid:!0}}export{g as F,y as R,v as a,h as b,K as c,z as d,tt as e,B as f,j as g,E as h,O as i,F as j,q as k,d as l,G as m,_ as n,Y as o,N as p,S as q,D as r,R as s};
