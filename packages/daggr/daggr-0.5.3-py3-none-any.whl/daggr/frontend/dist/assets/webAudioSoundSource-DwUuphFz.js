import{A as n}from"./abstractSoundSource-D25XFPoj.js";import{_ as r,b as u,c as _,d}from"./spatialWebAudio-BiZWmVK-.js";import"./webAudioBaseSubGraph-2o5xwuHA.js";import"./audioEngine-uesWbcoE.js";import"./index-BmJkaHuF.js";import"./index-C7ioxznG.js";class i extends n{constructor(e,s,t,o){super(e,t,o),this._stereo=null,this._audioContext=this.engine._audioContext,this._webAudioNode=s,this._subGraph=new i._SubGraph(this)}async _initAsync(e){e.outBus?this.outBus=e.outBus:e.outBusAutoDefault!==!1&&(await this.engine.isReadyPromise,this.outBus=this.engine.defaultMainBus),await this._subGraph.initAsync(e),r(e)&&this._initSpatialProperty(),this.engine._addNode(this)}get _inNode(){return this._webAudioNode}get _outNode(){return this._subGraph._outNode}get stereo(){return this._stereo??(this._stereo=new u(this._subGraph))}dispose(){super.dispose(),this._stereo=null,this._subGraph.dispose(),this.engine._removeNode(this)}getClassName(){return"_WebAudioSoundSource"}_connect(e){var t;return super._connect(e)?(e._inNode&&((t=this._outNode)==null||t.connect(e._inNode)),!0):!1}_disconnect(e){var t;return super._disconnect(e)?(e._inNode&&((t=this._outNode)==null||t.disconnect(e._inNode)),!0):!1}_createSpatialProperty(e,s){return new _(this._subGraph,e,s)}}i._SubGraph=class extends d{get _downstreamNodes(){return this._owner._downstreamNodes??null}get _upstreamNodes(){return this._owner._upstreamNodes??null}_onSubNodesChanged(){super._onSubNodesChanged(),this._owner._inNode.disconnect(),this._owner._subGraph._inNode&&this._owner._inNode.connect(this._owner._subGraph._inNode)}};export{i as _WebAudioSoundSource};
