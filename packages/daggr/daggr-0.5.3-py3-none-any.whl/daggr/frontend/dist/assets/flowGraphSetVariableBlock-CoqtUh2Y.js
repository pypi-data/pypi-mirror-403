import{f as p}from"./index-C7ioxznG.js";import{b as f}from"./KHR_interactivity-0REspvdU.js";import{R as u}from"./declarationMapper-4emcUw2B.js";import"./index-BmJkaHuF.js";import"./objectModelMapping-CY2JGqxk.js";class v extends f{constructor(a){if(super(a),!a.variable&&!a.variables)throw new Error("FlowGraphSetVariableBlock: variable/variables is not defined");if(a.variables&&a.variable)throw new Error("FlowGraphSetVariableBlock: variable and variables are both defined");if(a.variables)for(const i of a.variables)this.registerDataInput(i,u);else this.registerDataInput("value",u)}_execute(a,i){var r,e;if((r=this.config)!=null&&r.variables)for(const l of this.config.variables)this._saveVariable(a,l);else this._saveVariable(a,(e=this.config)==null?void 0:e.variable,"value");this.out._activateSignal(a)}_saveVariable(a,i,r){var o;const e=a._getGlobalContextVariable("currentlyRunningAnimationGroups",[]);for(const n of e){const s=a.assetsContext.animationGroups.find(t=>t.uniqueId==n);if(s){for(const t of s.targetedAnimations)if(t.target===a&&t.animation.targetProperty===i){s.stop();const b=e.indexOf(n);b>-1&&e.splice(b,1),a._setGlobalContextVariable("currentlyRunningAnimationGroups",e);break}}}const l=(o=this.getDataInput(r||i))==null?void 0:o.getValue(a);a.setVariable(i,l)}getClassName(){return"FlowGraphSetVariableBlock"}serialize(a){var i;super.serialize(a),a.config.variable=(i=this.config)==null?void 0:i.variable}}p("FlowGraphSetVariableBlock",v);export{v as FlowGraphSetVariableBlock};
