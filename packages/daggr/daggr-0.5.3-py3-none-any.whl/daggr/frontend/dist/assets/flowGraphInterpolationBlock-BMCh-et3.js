import{F as V}from"./KHR_interactivity-0REspvdU.js";import{g as k,i as I,f as F,R as p}from"./declarationMapper-4emcUw2B.js";import{aI as A,f as T}from"./index-C7ioxznG.js";import"./index-BmJkaHuF.js";import"./objectModelMapping-CY2JGqxk.js";class c extends V{constructor(t={}){super(t),this.keyFrames=[];const e=typeof(t==null?void 0:t.animationType)=="string"?k(t.animationType):I((t==null?void 0:t.animationType)??0),i=(t==null?void 0:t.keyFramesCount)??1,s=this.registerDataInput("duration_0",F,0),a=this.registerDataInput("value_0",e);this.keyFrames.push({duration:s,value:a});for(let n=1;n<i+1;n++){const o=this.registerDataInput(`duration_${n}`,F,n===i?t.duration:void 0),l=this.registerDataInput(`value_${n}`,e);this.keyFrames.push({duration:o,value:l})}this.initialValue=this.keyFrames[0].value,this.endValue=this.keyFrames[i].value,this.easingFunction=this.registerDataInput("easingFunction",p),this.animation=this.registerDataOutput("animation",p),this.propertyName=this.registerDataInput("propertyName",p,t==null?void 0:t.propertyName),this.customBuildAnimation=this.registerDataInput("customBuildAnimation",p)}_updateOutputs(t){const e=t._getGlobalContextVariable("interpolationAnimations",[]),i=this.propertyName.getValue(t),s=this.easingFunction.getValue(t),a=this._createAnimation(t,i,s);if(this.animation.setValue(a,t),Array.isArray(a))for(const n of a)e.push(n.uniqueId);else e.push(a.uniqueId);t._setGlobalContextVariable("interpolationAnimations",e)}_createAnimation(t,e,i){var h,y,d;const s=this.initialValue.richType,a=[],n=this.initialValue.getValue(t)||s.defaultValue;a.push({frame:0,value:n});const o=((h=this.config)==null?void 0:h.numberOfKeyFrames)??1;for(let r=1;r<o+1;r++){const m=(y=this.keyFrames[r].duration)==null?void 0:y.getValue(t);let u=(d=this.keyFrames[r].value)==null?void 0:d.getValue(t);r===o-1&&(u=u||s.defaultValue),m!==void 0&&u&&a.push({frame:m*60,value:u})}const l=this.customBuildAnimation.getValue(t);if(l)return l(null,null,t)(a,60,s.animationType,i);if(typeof e=="string"){const r=A.CreateAnimation(e,s.animationType,60,i);return r.setKeys(a),[r]}else return e.map(m=>{const u=A.CreateAnimation(m,s.animationType,60,i);return u.setKeys(a),u})}getClassName(){return"FlowGraphInterpolationBlock"}}T("FlowGraphInterpolationBlock",c);export{c as FlowGraphInterpolationBlock};
