import{bR as h,bQ as x}from"./index-C7ioxznG.js";import{e as y}from"./declarationMapper-4emcUw2B.js";import{A as I}from"./objectModelMapping-CY2JGqxk.js";import"./index-BmJkaHuF.js";const s="KHR_node_selectability";y("event/onSelect",s,{blocks:["FlowGraphMeshPickEventBlock","FlowGraphGetVariableBlock","FlowGraphIndexOfBlock","KHR_interactivity/FlowGraphGLTFDataProvider"],configuration:{stopPropagation:{name:"stopPropagation"},nodeIndex:{name:"variable",toBlock:"FlowGraphGetVariableBlock",dataTransformer(e){return"pickedMesh_"+e}}},outputs:{values:{selectedNodeIndex:{name:"index",toBlock:"FlowGraphIndexOfBlock"},controllerIndex:{name:"pointerId"},selectionPoint:{name:"pickedPoint"},selectionRayOrigin:{name:"pickOrigin"}},flows:{out:{name:"done"}}},interBlockConnectors:[{input:"asset",output:"value",inputBlockIndex:0,outputBlockIndex:1,isVariable:!0},{input:"array",output:"nodes",inputBlockIndex:2,outputBlockIndex:3,isVariable:!0},{input:"object",output:"pickedMesh",inputBlockIndex:2,outputBlockIndex:0,isVariable:!0}],extraProcessor(e,n,t,a,i,c,o){var u,p,f,b,m,k,_;const d=i[i.length-1];d.config=d.config||{},d.config.glTF=o;const r=(f=(p=(u=e.configuration)==null?void 0:u.nodeIndex)==null?void 0:p.value)==null?void 0:f[0];if(r===void 0||typeof r!="number")throw new Error("nodeIndex not found in configuration");const l="pickedMesh_"+r;return i[1].config.variable=l,c._userVariables[l]={className:"Mesh",id:(m=(b=o==null?void 0:o.nodes)==null?void 0:b[r]._babylonTransformNode)==null?void 0:m.id,uniqueId:(_=(k=o==null?void 0:o.nodes)==null?void 0:k[r]._babylonTransformNode)==null?void 0:_.uniqueId},i}});I("/nodes/{}/extensions/KHR_node_selectability/selectable",{get:e=>{const n=e._babylonTransformNode;return n&&n.isPickable!==void 0?n.isPickable:!0},set:(e,n)=>{var t;(t=n._primitiveBabylonMeshes)==null||t.forEach(a=>{a.isPickable=e})},getTarget:e=>e._babylonTransformNode,getPropertyName:[()=>"isPickable"],type:"boolean"});class B{constructor(n){this.name=s,this._loader=n,this.enabled=n.isExtensionUsed(s)}async onReady(){var n;(n=this._loader.gltf.nodes)==null||n.forEach(t=>{var a,i,c;(a=t.extensions)!=null&&a.KHR_node_selectability&&((i=t.extensions)==null?void 0:i.KHR_node_selectability.selectable)===!1&&((c=t._babylonTransformNode)==null||c.getChildMeshes().forEach(o=>{o.isPickable=!1}))})}dispose(){this._loader=null}}h(s);x(s,!0,e=>new B(e));export{B as KHR_node_selectability};
