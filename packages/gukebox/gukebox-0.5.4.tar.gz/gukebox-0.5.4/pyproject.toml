[project]
name = "gukebox"
version = "0.5.4"
description = "A Jukebox to play music on speakers using 'CD' with NFC tag"
authors = [{ name = "Gudsfile" }]
readme = "README.md"
license = { file = "LICENSE" }
requires-python = ">=3.8,<3.14"
dependencies = [
    "pydantic==2.5.3; python_version < '3.10'",
    "pydantic==2.10.6; python_version >= '3.10' and python_version < '3.13'",
    "pydantic==2.12.5; python_version >= '3.13'",
    "soco==0.30.14",
]
classifiers = [
    "Development Status :: 4 - Beta",
    "License :: OSI Approved :: MIT License",
    "Operating System :: OS Independent",
    "Programming Language :: Python :: 3 :: Only",
    "Programming Language :: Python :: 3.8",
    "Programming Language :: Python :: 3.9",
    "Programming Language :: Python :: 3.10",
    "Programming Language :: Python :: 3.11",
    "Programming Language :: Python :: 3.12",
    "Programming Language :: Python :: 3.13",
]
keywords = ["jukebox", "discstore", "music", "nfc"]

[project.urls]
Repository = "https://github.com/Gudsfile/jukebox"

[project.optional-dependencies]
api = [
    "fastapi==0.124.4",
    "uvicorn==0.33.0; python_version < '3.9'",
    "uvicorn==0.38.0; python_version >= '3.10'",
]
ui = [
    "gukebox[api]",
    "fastui==0.8.0; python_version >= '3.10'",
    "python-multipart==0.0.20; python_version >= '3.10'",
]
nfc = ["pyserial==3.5", "rpi-gpio==0.7.1", "spidev==3.8"]

[dependency-groups]
dev = [
    "pytest==7.4.4",
    "pytest-mock==3.11.1",
    "ruff==0.14.13",
    "ty==0.0.12",
]

[tool.ruff]
line-length = 120
indent-width = 4
target-version = "py313"
extend-exclude = ["pn532/"]

[tool.ruff.lint]
extend-select = [
    "SIM",
    "I",
]

[tool.ty.src]
exclude = ["pn532/"]

[tool.ty.rules]
# Ignoring missing-argument rule for now as it is a false positive for pydantic 2.5.3 (necessary for python <3.10):
# "No arguments provided for required parameters `__pydantic_extra__`, `__pydantic_fields_set__`, `__pydantic_private__`"
# CI/CD will treat this rule as an error for Python >= 3.10.
missing-argument = "warn"

[build-system]
requires = ["uv_build>=0.8.7,<0.10.0"]
build-backend = "uv_build"

[tool.uv.build-backend]
module-name = ["jukebox", "discstore", "pn532"]
module-root = ""

[project.scripts]
gukebox = "jukebox.app:main"
jukebox = "jukebox.app:main"
discstore = "discstore.app:main"
