{% if include_ai and ai_backend != "memory" %}
"""Scheduled jobs for AI service."""

from app.core.log import logger


async def sync_llm_catalog_job() -> None:
    """Scheduled job for syncing LLM catalog from public APIs.

    Runs every 5 minutes to keep the LLM catalog up-to-date with
    the latest models, pricing, and capabilities from vendors.
    """
    from sqlmodel import Session

    from app.core.db import engine
    from app.services.ai.etl import sync_llm_catalog

    try:
        with Session(engine) as session:
            result = await sync_llm_catalog(session, mode="chat")
            logger.info(
                f"LLM catalog sync complete: "
                f"{result.models_added} added, {result.models_updated} updated"
            )
    except Exception as e:
        logger.error(f"LLM catalog sync failed: {e}")
{% endif %}
