import{j as e,L as h,r as d,C as v,D,B as N,s as S,t as T}from"./vendor-tanstack-BcZfOOfy.js";import{al as p,ak as f,bm as w,ac as I,ad as R,bn as _,ae as z,af as E,ah as M,ag as P,ai as A,aj as L,q as j,I as k,N as F,E as Q,t as q,v as H,w as V,x as $,D as O,B as G,h as U,O as J,bo as K,bp as W,bq as x}from"./index-m48E4KcG.js";import{u as C,B as X}from"./use-delete-block-document-confirmation-dialog-Cq5nGhzr.js";import{D as Y}from"./data-table-rlbkLcrY.js";import{D as y}from"./delete-confirmation-dialog-DHkm2p8m.js";import{B as Z}from"./block-type-logo-Cbpfxded.js";import"./vendor-react-Bce9NwRC.js";import"./vendor-radix-BTiKGWfR.js";import"./vendor-recharts-BAN776s_.js";import"./vendor-forms-ClCIacbh.js";import"./vendor-date-wwuDAncJ.js";import"./dropdown-menu-0atiOSFo.js";import"./use-delete-confirmation-dialog-CUdii6Lo.js";import"./table-bBL6C0ZK.js";const ee=({blockDocument:a})=>{const{id:o,name:s,block_type:t,block_type_name:l}=a;return e.jsxs("div",{className:"flex gap-4 items-center",children:[t&&l&&e.jsx(Z,{size:"sm",logoUrl:t.logo_url,alt:`${l} logo`}),e.jsxs("div",{className:"flex flex-col",children:[s&&e.jsx(h,{to:"/blocks/block/$id",params:{id:o},children:e.jsx(p,{className:"font-semibold",children:s})}),l&&a.block_type?.slug&&e.jsx(h,{to:"/blocks/catalog/$slug",params:{slug:a.block_type.slug},children:e.jsx(p,{variant:"bodySmall",className:"text-muted-foreground",children:l})})]})]})},b=N(),se=({onDelete:a})=>[b.display({size:20,id:"select",header:({table:o})=>{let s=!1;return o.getIsAllRowsSelected()?s=!0:o.getIsSomePageRowsSelected()&&(s="indeterminate"),e.jsx(f,{checked:s,onCheckedChange:t=>o.toggleAllPageRowsSelected(!!t),"aria-label":"Select all"})},cell:({row:o})=>e.jsx(f,{checked:o.getIsSelected(),onCheckedChange:s=>o.toggleSelected(!!s),"aria-label":"Select row"}),enableSorting:!1,enableHiding:!1}),b.display({id:"block",header:"Block",cell:({row:o})=>e.jsx(ee,{blockDocument:o.original})}),b.display({id:"actions",cell:o=>{const s=o.row.original;return e.jsx("div",{className:"flex justify-end",children:e.jsx(X,{blockDocument:s,onDelete:()=>a(s)})})}})],oe=({blockDocuments:a,blockDocumentsCount:o,onPaginationChange:s,pagination:t,rowSelection:l,setRowSelection:i})=>{const[r,m]=C(),u=d.useCallback(c=>{let g=t;typeof c=="function"?g=c(t):g=c,s(g)},[t,s]),n=v({columns:se({onDelete:m}),data:a,defaultColumn:{maxSize:300},getCoreRowModel:D(),manualPagination:!0,onPaginationChange:u,rowCount:o,getRowId:c=>c.id,onRowSelectionChange:i,state:{pagination:t,rowSelection:l}});return e.jsxs(e.Fragment,{children:[e.jsx(Y,{table:n}),e.jsx(y,{...r})]})};function ae({selectedBlockTypesSlugs:a,onToggleBlockTypeSlug:o,onRemoveBlockTypeSlug:s}){return e.jsx(d.Suspense,{children:e.jsx(te,{selectedBlockTypesSlugs:a,onToggleBlockTypeSlug:o,onRemoveBlockTypeSlug:s})})}function te({selectedBlockTypesSlugs:a,onToggleBlockTypeSlug:o,onRemoveBlockTypeSlug:s}){const[t,l]=d.useState(""),i=d.useDeferredValue(t),{data:r}=S(w()),m=d.useMemo(()=>a.map(n=>r.find(c=>c.slug===n)).filter(Boolean),[r,a]),u=d.useMemo(()=>r.filter(n=>n.name.toLowerCase().includes(i.toLowerCase())),[r,i]);return e.jsxs(I,{children:[e.jsx(R,{selected:a.length>0,children:e.jsx("div",{className:"flex gap-1",children:a.length>0?m.map(n=>e.jsx(_,{tag:n.name,onRemove:()=>s(n.slug)},n.id)):"Select blocks"})}),e.jsxs(z,{children:[e.jsx(E,{value:t,onValueChange:l,placeholder:"Search for a block type..."}),e.jsx(M,{children:"No block type found"}),e.jsx(P,{children:e.jsx(A,{children:u.map(n=>e.jsx(L,{selected:a.includes(n.slug),onSelect:c=>{o(c),l("")},value:n.slug,children:n.name},n.id))})})]})]})}const le=({count:a,rowSelection:o,setRowSelection:s})=>{const[t,l]=C(),i=d.useMemo(()=>Object.keys(o),[o]);return i.length>0?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(p,{variant:"bodySmall",className:"text-muted-foreground",children:[i.length," selected"]}),e.jsx(j,{"aria-label":"Delete rows",size:"icon",variant:"secondary",onClick:()=>{l(i,{onSuccess:()=>s({})})},children:e.jsx(k,{id:"Trash2",className:"size-4"})})]}),e.jsx(y,{...t})]}):e.jsxs(p,{variant:"bodySmall",className:"text-muted-foreground",children:[a," ",F(a,"Block")]})},ne=()=>e.jsxs(Q,{children:[e.jsx(q,{id:"Box"}),e.jsx(H,{children:"Add a block to get started"}),e.jsx(V,{children:"Blocks securely store credentials and configuration to easily manage connections to external systems."}),e.jsxs($,{children:[e.jsx(h,{to:"/blocks/catalog",children:e.jsxs(j,{children:["Add Block ",e.jsx(k,{id:"Plus",className:"size-4 ml-2"})]})}),e.jsx(O,{id:"blocks-guide"})]})]}),ce=({allCount:a,blockDocuments:o=[],onSearch:s,search:t,blockTypeSlugsFilter:l,onToggleBlockTypeSlug:i,onRemoveBlockTypeSlug:r,pagination:m,onPaginationChange:u})=>{const[n,c]=d.useState({});return e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(G,{children:e.jsx(U,{className:"text-xl font-semibold",children:"Blocks"})}),e.jsx(j,{size:"icon",className:"size-7",variant:"outline",children:e.jsx(h,{to:"/blocks/catalog",children:e.jsx(k,{id:"Plus",className:"size-4"})})})]}),a===0?e.jsx(ne,{}):e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(le,{rowSelection:n,setRowSelection:c,count:a}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ae,{selectedBlockTypesSlugs:l,onToggleBlockTypeSlug:i,onRemoveBlockTypeSlug:r}),e.jsx("div",{className:"min-w-56",children:e.jsx(J,{"aria-label":"search blocks",placeholder:"Search blocks",value:t,onChange:g=>s(g.target.value)})})]})]}),e.jsx(oe,{blockDocuments:o,rowSelection:n,setRowSelection:c,blockDocumentsCount:a,pagination:m,onPaginationChange:u})]})]})};function ve(){const[a,o]=ie(),[s,t]=re(),[l,i]=de(),{data:r}=S(K()),{data:m}=T(W({sort:"NAME_ASC",include_secrets:!1,block_documents:{name:{like_:a},operator:"and_",is_anonymous:{eq_:!1}},block_types:{slug:{any_:s.length>0?s:void 0}},offset:l.pageIndex*l.pageSize,limit:l.pageSize})),u=c=>{const g=s.filter(B=>B!==c);t(g)},n=c=>{if(s.includes(c))return u(c);t([...s,c])};return e.jsx(ce,{allCount:r,blockDocuments:m,onSearch:o,search:a,blockTypeSlugsFilter:s,onRemoveBlockTypeSlug:u,onToggleBlockTypeSlug:n,pagination:l,onPaginationChange:i})}function ie(){const{blockName:a}=x.useSearch(),o=x.useNavigate(),s=d.useCallback(l=>{o({to:".",search:i=>({...i,blockName:l}),replace:!0})},[o]);return[d.useMemo(()=>a??"",[a]),s]}function re(){const{blockTypes:a=[]}=x.useSearch(),o=x.useNavigate(),s=d.useCallback(t=>{o({to:".",search:l=>({...l,blockTypes:t}),replace:!0})},[o]);return[a,s]}function de(){const a=x.useSearch(),o=x.useNavigate(),s=(a.page??1)-1,t=a.limit??10,l=d.useMemo(()=>({pageIndex:s,pageSize:t}),[s,t]),i=d.useCallback(r=>{o({to:".",search:m=>({...m,page:r.pageIndex+1,limit:r.pageSize}),replace:!0})},[o]);return[l,i]}export{ve as component};
//# sourceMappingURL=index-VH4TnZ4e.js.map
