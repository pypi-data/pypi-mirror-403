"""
Tests for {{project_name}} CLI.

Record a cassette (requires ANTHROPIC_API_KEY):
    NOOT_CACHE=record python -m pytest tests/ -v -s

Replay from cassette:
    NOOT_CACHE=replay python -m pytest tests/ -v -s
"""

from pathlib import Path

from noot import Flow

CLI_PATH = Path(__file__).parent.parent / "cli" / "{{project_name}}.py"


def test_greeting():
    """Test that the CLI greets the user by name."""
    with Flow.spawn(f"python {CLI_PATH}") as flow:
        print("\n=== Initial screen ===")
        print(flow.screen())

        flow.expect("What is your name")

        flow.step("Type 'Alice' and press Enter")
        print("\n=== After typing Alice ===")
        print(flow.screen())

        flow.expect("Hello, Alice")
        print("\n=== Final screen ===")
        print(flow.screen())
