# REM Environment Variables
# Copy this file to .env and update with your values
#
# Quick Start (Minimal Configuration):
# 1. Copy: cp .env.example .env
# 2. Set LLM API key: LLM__ANTHROPIC_API_KEY or LLM__OPENAI_API_KEY
# 3. Database is pre-configured for Docker Compose (port 5050)
# 4. Run: docker compose up -d
#
# Optional Features (Enable as needed):
# - Vision LLM: Set CONTENT__IMAGE_VLLM_SAMPLE_RATE > 0.0
# - CLIP Embeddings: Set CONTENT__JINA_API_KEY (free at jina.ai/embeddings)
# - Authentication: Set AUTH__ENABLED=true + OAuth credentials
# - Observability: Set OTEL__ENABLED=true / PHOENIX__ENABLED=true

# =============================================================================
# Development Settings
# =============================================================================
# Skip loading ~/.rem/config.yaml (use .env only for development)
# This prevents conflicts between user config and development .env
REM_SKIP_CONFIG_FILE=true

# =============================================================================
# API Server Settings
# =============================================================================
API__HOST=0.0.0.0
API__PORT=8000
API__RELOAD=true
API__LOG_LEVEL=info

# --- API Key Authentication ---
# Simple API key auth for programmatic access (independent of OAuth)
# When enabled, all /api/v1/* requests must include X-API-Key header
# Generate key: python -c "import secrets; print(secrets.token_urlsafe(32))"
API__API_KEY_ENABLED=false
API__API_KEY=

# =============================================================================
# LLM Provider Settings
# =============================================================================
LLM__DEFAULT_MODEL=openai:gpt-4.1
LLM__DEFAULT_TEMPERATURE=0.5
LLM__MAX_RETRIES=10

# Optional: Override models for specific tasks
# LLM__EVALUATOR_MODEL=gpt-4.1
# LLM__QUERY_AGENT_MODEL=gpt-4.1-mini

# API Keys (required for LLM providers)
LLM__OPENAI_API_KEY=
LLM__ANTHROPIC_API_KEY=

# =============================================================================
# Database Settings (PostgreSQL 18 with pgvector)
# =============================================================================
# Docker Compose uses port 5050, change to 5432 for CloudNativePG/RDS
POSTGRES__CONNECTION_STRING=postgresql://rem:rem@localhost:5050/rem
POSTGRES__POOL_MIN_SIZE=5
POSTGRES__POOL_MAX_SIZE=20
POSTGRES__POOL_TIMEOUT=30
POSTGRES__STATEMENT_TIMEOUT=30000

# =============================================================================
# Authentication Settings (OAuth 2.1 / OIDC)
# =============================================================================
AUTH__ENABLED=false
AUTH__SESSION_SECRET=

# --- Google OAuth ---
AUTH__GOOGLE__CLIENT_ID=
AUTH__GOOGLE__CLIENT_SECRET=
AUTH__GOOGLE__REDIRECT_URI=http://localhost:8000/api/auth/google/callback
# AUTH__GOOGLE__HOSTED_DOMAIN=example.com

# --- Microsoft Entra ID OAuth ---
AUTH__MICROSOFT__CLIENT_ID=
AUTH__MICROSOFT__CLIENT_SECRET=
AUTH__MICROSOFT__REDIRECT_URI=http://localhost:8000/api/auth/microsoft/callback
AUTH__MICROSOFT__TENANT=common

# =============================================================================
# Email Settings (Passwordless Login)
# =============================================================================
# Email login uses verification codes - no password required
# Supports Gmail SMTP with App Passwords by default
# Generate app password at: https://myaccount.google.com/apppasswords
EMAIL__ENABLED=false
EMAIL__SMTP_HOST=smtp.gmail.com
EMAIL__SMTP_PORT=587
EMAIL__SENDER_EMAIL=
EMAIL__SENDER_NAME=REM
EMAIL__APP_PASSWORD=
EMAIL__LOGIN_CODE_EXPIRY_MINUTES=10

# =============================================================================
# OpenTelemetry Settings
# =============================================================================
OTEL__ENABLED=false
OTEL__SERVICE_NAME=rem-api
OTEL__COLLECTOR_ENDPOINT=http://localhost:4318
OTEL__PROTOCOL=http
OTEL__EXPORT_TIMEOUT=10000

# =============================================================================
# Arize Phoenix Settings (LLM Observability)
# =============================================================================
PHOENIX__ENABLED=false
PHOENIX__API_KEY=
PHOENIX__COLLECTOR_ENDPOINT=http://localhost:6006/v1/traces
PHOENIX__PROJECT_NAME=rem

# =============================================================================
# Filesystem Settings
# =============================================================================
# REM_HOME is the base directory for local filesystem storage
# Defaults to ~/.rem if not set
# Local paths: $REM_HOME/fs/rem/v1/uploads/...
REM_HOME=~/.rem

# =============================================================================
# S3 Storage Settings
# =============================================================================
# For AWS S3 (production with IRSA)
S3__BUCKET_NAME=rem-io-staging
S3__REGION=us-east-1

# Path structure version and prefixes
S3__VERSION=v1
S3__UPLOADS_PREFIX=uploads
S3__PARSED_PREFIX=parsed

# Convention:
# Uploads: s3://{bucket}/{version}/uploads/user-123/2025/01/19/file.pdf
# Parsed:  s3://{bucket}/{version}/parsed/user-123/2025/01/19/file.pdf/content.md

# For MinIO (local development)
# S3__ENDPOINT_URL=http://localhost:9000
# S3__ACCESS_KEY_ID=minioadmin
# S3__SECRET_ACCESS_KEY=minioadmin
# S3__USE_SSL=false

# =============================================================================
# Content Processing Settings
# =============================================================================

# --- Document Chunking ---
CHUNKING__CHUNK_SIZE=1500
CHUNKING__OVERLAP=200
CHUNKING__MIN_CHUNK_SIZE=100
CHUNKING__MAX_CHUNK_SIZE=2500

# --- Vision LLM (Image Analysis) ---
# Expensive - tier-gated or sampled
CONTENT__IMAGE_VLLM_PROVIDER=anthropic
CONTENT__IMAGE_VLLM_MODEL=
CONTENT__IMAGE_VLLM_SAMPLE_RATE=0.0

# --- CLIP Embeddings (Image Search) ---
# Cheap - always-on when key provided (~$0.00008 per image)
CONTENT__CLIP_PROVIDER=jina
CONTENT__CLIP_MODEL=jina-clip-v2
CONTENT__JINA_API_KEY=

# =============================================================================
# SQS Queue Settings (File Processing)
# =============================================================================
# Queue URL from Pulumi output (manifests/infra/file-queue)
SQS__QUEUE_URL=https://sqs.us-east-1.amazonaws.com/ACCOUNT_ID/rem-file-processing
SQS__REGION=us-east-1
SQS__MAX_MESSAGES=10
SQS__WAIT_TIME_SECONDS=20
SQS__VISIBILITY_TIMEOUT=300

# =============================================================================
# MCP Server Settings
# =============================================================================
# MCP_SERVER_TEST=http://localhost:8000/api/v1/mcp
# MCP_SERVER_PROD=https://api.example.com/api/v1/mcp

# =============================================================================
# Application Settings
# =============================================================================
ENVIRONMENT=development
TEAM=rem
# DOMAIN=https://api.example.com
# ROOT_PATH=/rem
