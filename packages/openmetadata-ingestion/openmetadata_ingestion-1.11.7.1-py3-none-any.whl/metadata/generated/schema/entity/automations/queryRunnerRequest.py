# generated by datamodel-codegen:
#   filename:  entity/automations/queryRunnerRequest.json
#   timestamp: 2026-01-30T06:35:57+00:00

from __future__ import annotations

from typing import Optional

from pydantic import ConfigDict, Field
from typing_extensions import Annotated

from metadata.ingestion.models.custom_pydantic import BaseModel

from ...type import basic


class QueryRunnerRequest(BaseModel):
    model_config = ConfigDict(
        extra='forbid',
    )
    connectionType: Annotated[
        Optional[str],
        Field(
            None,
            description='Type of the connection to test such as Snowflake, MySQL, Looker, etc.',
        ),
    ]
    serviceName: Annotated[
        Optional[basic.EntityName],
        Field(None, description='Optional value that identifies this service name.'),
    ]
    query: Annotated[Optional[str], Field(None, description='Query to be executed.')]
    transpile: Annotated[
        Optional[bool],
        Field(
            None,
            description='Optional value to indicate if the query should be transpiled.',
        ),
    ]
    workflowName: Annotated[
        Optional[str],
        Field(
            None,
            description='Optional value of the workflow name responsible for running the test',
        ),
    ]
    userId: Annotated[
        Optional[basic.Uuid],
        Field(
            None,
            description='UUID of the user executing the query (extracted from JWT token in backend)',
        ),
    ]
    userConfigId: Annotated[
        Optional[basic.Uuid],
        Field(
            None,
            description="UUID of the user's QueryRunner config for this specific service (looked up by backend using userId + serviceName)",
        ),
    ]
    authType: Annotated[
        Optional[str],
        Field(
            None,
            description='Authentication type configured by admin in QueryRunnerConfig (e.g., Basic, ExternalOAuth, etc.). Used to determine which credential field to use from user config.',
        ),
    ]
    role: Annotated[
        Optional[str],
        Field(
            None,
            description='Optional role to use for query execution (selected by user in QueryRunner Studio). Service-specific (e.g., Snowflake role).',
        ),
    ]
    database: Annotated[
        Optional[str],
        Field(
            None,
            description='Optional database/dataset to use for query execution (selected by user in QueryRunner Studio). Service-specific name (e.g., Snowflake database).',
        ),
    ]
    databaseSchema: Annotated[
        Optional[str],
        Field(
            None,
            description="Optional database schema to use for query execution (selected by user in QueryRunner Studio). Service-specific name (e.g., Snowflake schema). Named 'databaseSchema' instead of 'schema' to avoid conflicts with Pydantic's BaseModel.schema() method.",
        ),
    ]
    maxResultSize: Annotated[
        Optional[int],
        Field(
            None,
            description="RUNTIME FIELD - Automatically injected by backend from admin QueryRunnerConfig.querySettings.maxResultSize. This is NOT user-configurable in the request. The backend fetches this value from the service's QueryRunnerConfig and injects it here for enforcement by the Python workflow. If query has LIMIT exceeding this value, an error is raised. If query has no LIMIT, one is automatically injected.",
            ge=1,
            le=1000,
        ),
    ]
