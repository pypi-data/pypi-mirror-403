# generated by datamodel-codegen:
#   filename:  tests/basic.json
#   timestamp: 2026-01-30T06:35:57+00:00

from __future__ import annotations

from enum import Enum
from typing import Any, List, Optional

from pydantic import ConfigDict, Field, RootModel
from typing_extensions import Annotated

from metadata.ingestion.models.custom_pydantic import BaseModel

from ..type import basic, entityReference


class Basic(RootModel[Any]):
    root: Annotated[
        Any,
        Field(
            description='This schema defines basic types that are used by other test schemas.',
            title='Basic',
        ),
    ]


class TestResultValue(BaseModel):
    name: Annotated[Optional[str], Field(None, description='name of the value')]
    value: Annotated[Optional[str], Field(None, description='test result value')]
    predictedValue: Annotated[Optional[str], Field(None, description='predicted value')]


class TestCaseStatus(Enum):
    Success = 'Success'
    Failed = 'Failed'
    Aborted = 'Aborted'
    Queued = 'Queued'


class TestSuiteExecutionFrequency(Enum):
    Hourly = 'Hourly'
    Daily = 'Daily'
    Weekly = 'Weekly'


class DimensionValue(BaseModel):
    model_config = ConfigDict(
        extra='forbid',
    )
    name: Annotated[
        str,
        Field(description="Name of the dimension (e.g., 'column', 'region', 'tier')"),
    ]
    value: Annotated[
        str,
        Field(description="Value for this dimension (e.g., 'address', 'US', 'gold')"),
    ]


class ColumnTestSummaryDefinition(BaseModel):
    success: Annotated[
        Optional[int], Field(None, description='Number of test cases that passed.')
    ]
    failed: Annotated[
        Optional[int], Field(None, description='Number of test cases that failed.')
    ]
    aborted: Annotated[
        Optional[int], Field(None, description='Number of test cases that aborted.')
    ]
    queued: Annotated[
        Optional[int],
        Field(None, description='Number of test cases that are queued for execution.'),
    ]
    total: Annotated[
        Optional[int], Field(None, description='Total number of test cases.')
    ]
    entityLink: Optional[basic.EntityLink] = None


class TestSummary(BaseModel):
    success: Annotated[
        Optional[int], Field(None, description='Number of test cases that passed.')
    ]
    failed: Annotated[
        Optional[int], Field(None, description='Number of test cases that failed.')
    ]
    aborted: Annotated[
        Optional[int], Field(None, description='Number of test cases that aborted.')
    ]
    queued: Annotated[
        Optional[int],
        Field(None, description='Number of test cases that are queued for execution.'),
    ]
    total: Annotated[
        Optional[int], Field(None, description='Total number of test cases.')
    ]
    columnTestSummary: Optional[List[ColumnTestSummaryDefinition]] = None


class TestCaseDimensionResult(BaseModel):
    model_config = ConfigDict(
        extra='forbid',
    )
    id: Annotated[
        basic.Uuid,
        Field(description='Unique identifier of this dimensional result instance'),
    ]
    testCaseResultId: Annotated[
        basic.Uuid,
        Field(
            description='Reference to the parent TestCaseResult execution that generated this dimensional result'
        ),
    ]
    testCase: Annotated[
        Optional[entityReference.EntityReference],
        Field(
            None,
            description='Reference to the test case for efficient querying of dimensional time series',
        ),
    ]
    timestamp: Annotated[
        basic.Timestamp,
        Field(
            description='Timestamp when the dimensional test result was captured (same as parent TestCaseResult)'
        ),
    ]
    dimensionValues: Annotated[
        List[DimensionValue],
        Field(
            description="Array of dimension name-value pairs for this result (e.g., [{'name': 'region', 'value': 'mumbai'}, {'name': 'product', 'value': 'laptop'}])"
        ),
    ]
    dimensionKey: Annotated[
        str,
        Field(
            description="Composite key for API filtering: 'region=mumbai' or 'region=mumbai,product=laptop'"
        ),
    ]
    testCaseStatus: Annotated[
        TestCaseStatus,
        Field(description='Status of the test for this dimension combination'),
    ]
    result: Annotated[
        Optional[str],
        Field(
            None,
            description='Details of test case results for this dimension combination',
        ),
    ]
    testResultValue: Annotated[
        Optional[List[TestResultValue]],
        Field(None, description='Test result values for this dimension combination'),
    ]
    passedRows: Annotated[
        Optional[int],
        Field(
            None,
            description='Number of rows that passed for this dimension combination',
        ),
    ]
    failedRows: Annotated[
        Optional[int],
        Field(
            None,
            description='Number of rows that failed for this dimension combination',
        ),
    ]
    passedRowsPercentage: Annotated[
        Optional[float],
        Field(
            None,
            description='Percentage of rows that passed for this dimension combination',
        ),
    ]
    failedRowsPercentage: Annotated[
        Optional[float],
        Field(
            None,
            description='Percentage of rows that failed for this dimension combination',
        ),
    ]
    impactScore: Annotated[
        Optional[float],
        Field(
            None,
            description='Impact score indicating the significance of this dimension for revealing data quality variations. Higher scores indicate dimensions with more significant quality issues considering both failure rate and data volume.',
            ge=0.0,
            le=1.0,
        ),
    ]


class TestCaseResult(BaseModel):
    id: Annotated[
        Optional[basic.Uuid],
        Field(None, description='Unique identifier of this failure instance'),
    ]
    testCaseFQN: Annotated[
        Optional[basic.FullyQualifiedEntityName],
        Field(None, description='Fully qualified name of the test case.'),
    ]
    timestamp: Annotated[
        basic.Timestamp, Field(description='Data one which test case result is taken.')
    ]
    testCaseStatus: Annotated[
        Optional[TestCaseStatus], Field(None, description='Status of Test Case run.')
    ]
    result: Annotated[
        Optional[str], Field(None, description='Details of test case results.')
    ]
    sampleData: Annotated[
        Optional[str],
        Field(
            None,
            description="sample data to capture rows/columns that didn't match the expressed testcase.",
        ),
    ]
    testResultValue: Optional[List[TestResultValue]] = None
    passedRows: Annotated[
        Optional[int], Field(None, description='Number of rows that passed.')
    ]
    failedRows: Annotated[
        Optional[int], Field(None, description='Number of rows that failed.')
    ]
    passedRowsPercentage: Annotated[
        Optional[float], Field(None, description='Percentage of rows that passed.')
    ]
    failedRowsPercentage: Annotated[
        Optional[float], Field(None, description='Percentage of rows that failed.')
    ]
    incidentId: Annotated[
        Optional[basic.Uuid],
        Field(
            None,
            description='Incident State ID associated with this result. This association happens when the result is created, and will stay there even when the incident is resolved.',
        ),
    ]
    maxBound: Annotated[
        Optional[float],
        Field(
            None,
            description='Upper bound limit for the test case result as defined in the test definition.',
        ),
    ]
    minBound: Annotated[
        Optional[float],
        Field(
            None,
            description='Lower bound limit for the test case result as defined in the test definition.',
        ),
    ]
    testCase: Annotated[
        Optional[entityReference.EntityReference],
        Field(None, description='Test case that this result is for.'),
    ]
    testDefinition: Annotated[
        Optional[entityReference.EntityReference],
        Field(None, description='Test definition that this result is for.'),
    ]
    dimensionResults: Annotated[
        Optional[List[TestCaseDimensionResult]],
        Field(
            None,
            description='List of dimensional test results. Only populated when the test case has dimensionColumns specified.',
        ),
    ]
