[build-system]
requires = ["setuptools>=61.0", "wheel"]
build-backend = "setuptools.build_meta"

[project]
name = "pytbox"
version = "0.6.6"
description = "A collection of Python integrations and utilities (Feishu, Dida365, VictoriaMetrics, ...)"
authors = [{ name = "mingming hou", email = "houm01@foxmail.com" }]
license = "MIT"
readme = "README.md"
requires-python = ">=3.8"

dependencies = [
    "requests>=2.0",
    "pydantic>=1.10",
    # 这个包 28M, 如果从官方源下载太慢了, 先禁用一下，等以后版本稳定了，同步到国内源了再取消注释
    # "onepassword-sdk>=0.3.1",
    "onepasswordconnectsdk>=1.0.0",
    "loguru>=0.7.3",
    "chinese_calendar>=1.10.0",
    "click>=8.0.0",                 # 添加 click 依赖
    "rich>=12.0.0",                 # 添加 rich 依赖
    "jinja2>=3.0.0",                # 模板渲染
    "toml>=0.10.0",                 # TOML 输出支持
    "ldap3>=2.9.1",                 # LDAP 支持
    "imap-tools>=1.11.0",
    "yagmail>=0.15.293",
    "pynetbox>=7.0.0",
    "pypinyin>=0.49.0",
]

[project.scripts]
pytbox = "pytbox.cli:main" # 添加命令行入口点

[project.optional-dependencies]
dev = ["pytest", "black", "ruff", "python-dotenv"]
cli = [
    "pyyaml>=6.0", # YAML 输出支持
]

[tool.setuptools]
include-package-data = true

[tool.setuptools.packages.find]
where = ["src"]

[tool.pytest.ini_options]
filterwarnings = [
    "ignore::DeprecationWarning:pyasn1.*",
    "ignore:tagMap is deprecated:DeprecationWarning",
    "ignore:typeMap is deprecated:DeprecationWarning",
]
# 显示日志输出
log_cli = true
log_cli_level = "INFO"
log_cli_format = "%(asctime)s [%(levelname)8s] %(name)s: %(message)s"
log_cli_date_format = "%Y-%m-%d %H:%M:%S"
