# NOTE: For this file to take effect, move it to:
#   <prefix>/etc/tenzir/plugin/compaction/tenzir.yaml

#tenzir:
#  plugins:
#    - compaction
#
#  operators:
#    drop_suricata_flow: where @name != "suricata.flow"
#    drop_suricata_alert: where @name != "suricata.alert"
#    uri_clean: drop http.hostname
#
#plugins:
#  compaction:
#    # Time-triggered compaction modifies events that reach a certain age threshold.
#    time:
#      interval: 1 day
#
#      rules:
#        - name: remove_flows
#          after: 7 days
#          pipeline: drop_suricata_flow
#          types:
#            - suricata.flow
#            - suricata.netflow
#        - name: remove_urls
#          after: 10 days
#          pipeline: uri_clean
#          types:
#            - zeek.http
#            - suricata.http
#
#    # Space-triggered compaction runs when the database size exceeds a given
#    # disk budget.
#    space:
#      interval: 1 hour
#      mode: weighted-age
#      # The executable used for checking the size of the database directory.
#      # See disk-monitor docs for more details. Omit for using the default.
#      scan-binary: ""
#      disk-budget-high: 10TiB
#      disk-budget-low:   8TiB
#
#      weights:
#        - weight: 0.001
#          pipeline: drop_suricata_flow
#          types: [suricata.flow]
#        - weight: 10
#          pipeline: drop_suricata_alert
#          types: [suricata.alert]
#