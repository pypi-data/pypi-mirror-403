openapi: '3.0.0'
servers:
  - url: 'https://www.lcdp.ovh/api/v1'
  - url: 'https://www.lecomptoirdespharmacies.fr/api/v1'
  - url: 'http://www.lcdp.localhost/api/v1'
  - url: 'http://localhost:7072/api/v1'
info:
  description: 'This is the REST API of LCDP products'
  version: '1.0.0'
  title: 'lcdp-monolith-service'
  termsOfService: 'https://www.lecomptoirdespharmacies.fr/mentions-legales'
  contact:
    email: 'contact@lecomptoirdespharmacies.fr'
  license:
    name: 'Apache 2.0'
    url: 'http://www.apache.org/licenses/LICENSE-2.0.html'
paths: {}
components:
  headers:
    Etag:
      description: |
        The RFC7232 ETag header field in a response provides the current entity-
        tag for the selected resource. An entity-tag is an opaque identifier for
        different versions of a resource over time, regardless whether multiple
        versions are valid at the same time. An entity-tag consists of an opaque
        quoted string, possibly prefixed by a weakness indicator.
      example: W/"xy", "5", "7da7a728-f910-11e6-942a-68f728c1ba70"
      required: false
      schema:
        type: string
    XScaUri:
      required: false
      description: |
        URI to redirect the user to for SCA enrollment.
        You should add a query parameter 'returnUrl' with UTF-8 encoded URL where user should be redirected after SCA enrollment.
      schema:
        type: string
        format: uri

  parameters:
    IfMatch:
      name: If-Match
      description: |
        The RFC7232 If-Match header field in a request provides the current known entity-
        tag for the selected resource. Request will be executed only if known entity-tag
        match current entity-tag in backend.
        If not, 412 (Precondition Failed) is returned.
        If you do not send this header, we consider that you do not care about concurrency
        and want to process the request even if entity-tag change.
      in: header
      example: W/"xy", "5", "7da7a728-f910-11e6-942a-68f728c1ba70"
      required: false
      schema:
        type: string

  schemas:
    # Schema for error response body
    RestError:
      type: object
      properties:
        code:
          type: string
          description: >
            Unique code to identify an error :
            * `CODE000` - Using outdated resource
            * `CODE001` - Invalid credentials
            * `CODE002` - Cannot renew token
            * `CODE003` - Invalid User CGV
            * `CODE004` - Resource already exists
            * `CODE005` - User account is disabled
            * `CODE006` - Invalid schedule
            * `CODE007` - Wrong Address according CHRONOPOST
            * `CODE008` - Invalid Mangopay Mandate
            * `CODE009` - Invalid Status
            * `CODE010` - Image dimension exceeded
            * `CODE011` - Empty User Address
            * `CODE012` - Empty User Legal Name
            * `CODE013` - Invalid quantities
            * `CODE014` - Invalid Meta-Order
            * `CODE015` - Can not release quantity greater than claimed
            * `CODE016` - Can not release a negative quantity of items
            * `CODE017` - Batch is forbidden for sale
            * `CODE018` - Trial already used
            * `CODE019` - Unable to generate session from disposableToken for admin users
            * `CODE020` - ETag do not match
            * `CODE021` - Missing informations for Offisante subscription
            * `CODE022` - Disabled feature
            * `CODE023` - Invalid Sca Enrollment status
            * `CODE024` - Image missing
            * `CODE025` - Invalid International Bank Account Number
            * `CODE026` - SubCart not found in cart
          enum:
            - CODE000
            - CODE001
            - CODE002
            - CODE003
            - CODE004
            - CODE005
            - CODE006
            - CODE007
            - CODE008
            - CODE009
            - CODE010
            - CODE011
            - CODE012
            - CODE013
            - CODE014
            - CODE015
            - CODE016
            - CODE017
            - CODE018
            - CODE019
            - CODE020
            - CODE021
            - CODE022
            - CODE023
            - CODE024
            - CODE025
            - CODE026
        message:
          type: string
          description: >
            Unique code to identify an error :
            * `MESSAGE000` - Using outdated resource
            * `MESSAGE001` - Invalid credentials
            * `MESSAGE002` - Cannot renew token
            * `MESSAGE003` - Invalid User CGV
            * `MESSAGE004` - Resource already exists
            * `MESSAGE005` - User account is disabled
            * `MESSAGE006` - Invalid schedule
            * `MESSAGE007` - Wrong Address according CHRONOPOST
            * `MESSAGE008` - Invalid Mangopay Mandate
            * `MESSAGE009` - Invalid Status
            * `MESSAGE010` - Image dimension exceeded
            * `MESSAGE011` - Empty User Address
            * `MESSAGE012` - Empty User Legal Name
            * `MESSAGE013` - Invalid quantities
            * `MESSAGE014` - Invalid Meta-Order
            * `MESSAGE015` - Can not release quantity greater than claimed
            * `MESSAGE016` - Can not release a negative quantity of items
            * `MESSAGE017` - Batch is forbidden for sale
            * `MESSAGE018` - Trial already used
            * `MESSAGE019` - Unable to generate session from disposableToken for admin users
            * `MESSAGE020` - ETag do not match
            * `MESSAGE021` - Missing informations for Offisante subscription
            * `MESSAGE022` - Disabled feature
            * `MESSAGE023` - Invalid Sca Enrollment status
            * `MESSAGE024` - Image missing
            * `MESSAGE024` - Invalid International Bank Account Number
            * `MESSAGE026` - SubCart not found in cart
          enum:
            - 'Using outdated resource'
            - 'Login failed'
            - 'Cannot renew token'
            - 'Invalid User CGV'
            - 'Resource already exists'
            - 'User account is disabled'
            - 'Invalid schedule'
            - 'Wrong Address according CHRONOPOST'
            - 'Invalid Mangopay Mandate'
            - 'Invalid Status'
            - 'Image dimension exceeded'
            - 'Empty User Address'
            - 'Empty User Legal Name'
            - 'Invalid quantities'
            - 'Invalid Meta-Order'
            - 'Can not release quantity greater than claimed'
            - 'Can not release a negative quantity of items'
            - 'Batch is forbidden for sale'
            - 'Trial already used'
            - 'Unable to generate session from disposableToken for admin users'
            - 'ETag do not match'
            - 'Missing informations for Offisante subscription'
            - 'Disabled feature'
            - 'Invalid Sca Enrollment status'
            - 'Image missing'
            - 'Invalid International Bank Account Number'
            - 'SubCart not found in cart'
          x-enum-varnames:
            - MESSAGE000
            - MESSAGE001
            - MESSAGE002
            - MESSAGE003
            - MESSAGE004
            - MESSAGE005
            - MESSAGE006
            - MESSAGE007
            - MESSAGE008
            - MESSAGE009
            - MESSAGE010
            - MESSAGE011
            - MESSAGE012
            - MESSAGE013
            - MESSAGE014
            - MESSAGE015
            - MESSAGE016
            - MESSAGE017
            - MESSAGE018
            - MESSAGE019
            - MESSAGE020
            - MESSAGE021
            - MESSAGE022
            - MESSAGE023
            - MESSAGE024
            - MESSAGE025
            - MESSAGE026
      required:
        - code
        - message

    HttpLink:
      description: A base type of objects representing links to resources.
      type: object
      properties:
        href:
          description: Any URL that is using http or https protocol
          type: string
          format: uri
      required:
        - href

    ImageVersions:
      type: object
      properties:
        xsmall:
          description: URL to S3 file (width 128px, height computed with original image aspect ratio)
          type: string
          format: uri
        small:
          description: URL to S3 file (width 256px, height computed with original image aspect ratio)
          type: string
          format: uri
        medium:
          description: URL to S3 file (width 512px, height computed with original image aspect ratio)
          type: string
          format: uri
        large:
          description: URL to S3 file (width 1024px, height computed with original image aspect ratio)
          type: string
          format: uri
        xlarge:
          description: URL to S3 file (width 2048px, height computed with original image aspect ratio)
          type: string
          format: uri
        original:
          description: URL to S3 file (Original size)
          type: string
          format: uri
      required:
        - original

    PaginatedObject:
      description: An object which is not complete (only a specific page is available)
      type: object
      properties:
        metadata:
          $ref: '#/components/schemas/PagingMetadata'
      required:
        - metadata

    PagingMetadata:
      description: All information about current and available pages
      type: object
      properties:
        page:
          description: Current page requested. Start at 0. May not be present if user do not request specific page.
          type: integer
          minimum: 0
        perPage:
          description: Number of item per page. 0 means that you only required metadata. May not be present if user do not request specific perPage.
          type: integer
          minimum: 0
        totalVisible:
          description: Total number of item visible by the client in the request
          type: integer
          minimum: 0
        totalFound:
          description: Total number of item found in database
          type: integer
          minimum: 0
      required:
        - totalVisible
        - totalFound

    Log:
      description: An object for ressource log
      type: object
      properties:
        id:
          description: Log unique identifier
          type: integer
          format: int64
        content:
          description: Log content
          type: string
        createdAt:
          type: string
          format: date-time
          description: Creation date of this log
      required:
        - id
        - content
        - createdAt

    Email:
      type: string
      maxLength: 70
      format: email
      description: An email in conformity with pattern

    Phone:
      type: string
      format: phone
      pattern: '^(?:(?:\+)33|0)[1-9](?:\d{2}){4}$'

    DataProvider:
      type: string
      enum: ['VIDAL', 'BCB', 'MEDIPIM', 'LCDP_CATALOG', 'USER']
