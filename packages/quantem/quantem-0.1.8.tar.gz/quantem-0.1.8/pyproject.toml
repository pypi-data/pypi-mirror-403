[build-system]
requires = ["hatchling"]
build-backend = "hatchling.build"

[tool.pytest.ini_options]
addopts = [
    "--import-mode=importlib",
]
testpaths = ["tests", "widget/tests"]

[tool.ruff.lint]
select = ["E4","E7","E9","F","I"]
exclude = ["*.ipynb"]

[tool.ruff.lint.per-file-ignores]
"__init__.py" = ["I001"]

[tool.ruff]
line-length = 99

[tool.uv]
config-settings = { editable_mode = "compat" }

[tool.uv.workspace]
members = ["widget"]

[tool.uv.sources]
"quantem.widget" = { workspace = true }

[project]
name = "quantem"
version = "0.1.8"
description = "quantitative electron microscopy analysis toolkit."
keywords = ["EM","TEM","STEM","4DSTEM"]
readme = "README.md"
license = "MIT"
requires-python = ">=3.11"
dependencies = [
  "colorspacious",
  "dill",
  "numpy>2",
  "matplotlib",
  "scipy",
  "tqdm",
  "zarr>3",
  "cmasher>=1.9.2",
  "rosettasciio>=0.8.0",
  "h5py>=3.13.0",
  "torch>=2.7.0",
  "scikit-image>=0.25.2",
  "torchvision>=0.22.1",
  "tensorboard>=2.19.0",
  "torchmetrics>=1.7.3",
  "optuna>=4.5.0",
  "hdf5plugin>=6.0.0",
  "torchinfo>=1.8.0",
]

[project.optional-dependencies]
widgets = [
    "quantem.widget",
]

[tool.hatch.build.targets.sdist]
# hatchling always includes:
# pyproject.toml, .gitignore, any README, any LICENSE, AUTHORS
only-include = [
    "/src",
    "/tests",
    "/CITATION.cff"
]

[dependency-groups]
test = [
    "pytest>=8.3.5",
    "pytest-cov>=7.0.0",
]
dev = [
    { include-group = "test" },
    "jupyterlab>=4.4.0",
    "packaging>=24.2",
    "pre-commit>=4.2.0",
    "ruff>=0.11.5",
    "tomli>=2.2.1",
]
