[project]
name = 'relationalai'
version = '0.13.4'
description = 'RelationalAI Library and CLI'
readme="docs/pypi/README.md"
authors = [
    { name="RelationalAI", email="support@relational.ai" },
]
requires-python = ">= 3.10"
dependencies = [
    "lqp==0.2.3",
    "snowflake-connector-python[secure-local-storage]",
    "snowflake-snowpark-python>=1.38.0",
    "typing-extensions",
    "rich",
    "nicegui==2.16.1",
    "numpy<2",
    "pandas",
    "colorama",
    "inquirerpy",
    "click==8.2.1",
    "gravis",
    "toml",
    "tomlkit",
    "requests",
    "pyarrow",
    "websockets",
    "aiohttp",
    "packaging",
    "opentelemetry-sdk",
    "opentelemetry-api",
    "opentelemetry-exporter-otlp-proto-http",
    "wcwidth",
    "cryptography",
    "pyjwt",
]
[project.optional-dependencies]
dev = [
    "jupyter",
    "pytest",
    "pytest-cov",
    "pytest-mock",
    "pytest-snapshot",
    "pytest-timeout",
    "hypothesis",
    "faker",
    "argcomplete",
    "watchdog",
    "hupper",
    "prompt_toolkit",
    "build",
    "ruff",
    "pexpect",
    "coverage",
    "pip-tools",
    "pandas-stubs",
    "logscope",
    "tablescope",
    "sqlite-utils",
    "sympy",
    "duckdb",
    "polars",
    "scipy"
]
ea = [
    "pysmt",
    "simple_ddl_parser",
    "dataclasses-json",
    "parameterized",
    "owlready2",
    "xmltodict"
]
legacy = [
    "rai-sdk>=0.7.5"
]

[project.scripts]
rai = "relationalai.tools.cli:cli"
rai-dev = "relationalai.tools.dev:cli"

[tool.ruff]
extend-exclude = ["*.ipynb"]
exclude = ["tests/early_access/unit/dsl/**", "tests/early_access/end2end/**", "src/relationalai/lqp/**"]

[build-system]
requires = ["hatchling"]
build-backend = "hatchling.build"

[tool.hatch.metadata]
allow-direct-references = true

# Note that the wheel is build _from_ the source dist, so it needs to be shaped the way the repo is shaped
[tool.hatch.build.targets.sdist]
only-include = ["src"]
[tool.hatch.build.targets.sdist.force-include]
"frontend/debugger/dist" = "frontend/debugger/dist"

[tool.hatch.build.targets.wheel]
packages = ["src/relationalai", "src/relationalai_test_util"]
# Everything I have read seems to indicate I should be able to do a regular
# include from the force-include in the sdist. But it does not work.
[tool.hatch.build.targets.wheel.force-include]
"frontend/debugger/dist" = "frontend/debugger/dist"

[tool.pytest.ini_options]
testpaths = ["tests"]
markers = [
    "azure: marks tests as requiring Azure/railib (deselect with '-m \"not azure\"')",
]
# Exclude Azure tests by default
addopts = "-m 'not azure'"

[tool.pyright]
include = ["src", "tests"]
exclude = ["**/node_modules", "**/__pycache__", "**/.*", "**/test_cases/*", "src/relationalai/metagen.py", "src/gentest",
    "src/raitoolkit", "**/early_access/unit/dsl/**", "**/early_access/end2end/dsl/**", "src/raitoolkit",
    "**/early_access/end2end/tests/**"]
useLibraryCodeForTypes = true
reportMissingImports = true
reportMissingTypeStubs = false
pythonVersion = "3.10"
venvPath = "."
venv = ".venv/3.11"
typeCheckingMode = "standard"
reportUnusedExpression = false

[tool.coverage.paths]
source = [
    "src/relationalai",
    ".venv/*/lib/python*/site-packages/relationalai",
    ".venv/*/Lib/site-packages/relationalai"
]
