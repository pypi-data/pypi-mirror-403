[project]
name = "idun-agent-engine"
version = "0.4.1"
description = "Python SDK and runtime to serve AI agents with FastAPI, LangGraph, and observability."
authors = [{ name = "Geoffrey HARRAZI", email = "geoffreyharrazi@gmail.com" }]
requires-python = ">=3.12,<3.14"
readme = "README.md"
license = "GPL-3.0-only"
keywords = [
    "agents",
    "langgraph",
    "fastapi",
    "sdk",
    "llm",
    "observability",
]
classifiers = [
    "License :: OSI Approved :: GNU General Public License v3 (GPLv3)",
    "Programming Language :: Python :: 3",
    "Programming Language :: Python :: 3 :: Only",
    "Programming Language :: Python :: 3.12",
    "Programming Language :: Python :: 3.13",
    "Framework :: FastAPI",
    "Intended Audience :: Developers",
    "Topic :: Software Development :: Libraries",
    "Typing :: Typed",



]

dependencies = [
    "tavily-python>=0.7.9,<0.8.0",
    "deepagents>=0.2.8,<1.0.0",
    "guardrails-ai>=0.7.2, <0.8.0",
    "fastapi>=0.115.0,<0.116.0",
    "uvicorn>=0.35.0,<0.36.0",
    "langgraph>=1.0.0,<2.0.0",
    "langgraph-checkpoint-sqlite>=3.0.0,<4.0.0",
    "langgraph-checkpoint-postgres>=3.0.0,<4.0.0",
    "streamlit>=1.47.1,<2.0.0",
    "httpx>=0.28.1,<0.29.0",
    "pydantic>=2.11.7,<3.0.0",
    "langchain-core>=1.0.0,<2.0.0",
    "langchain-google-vertexai>=2.0.27,<4.0.0",
    "google-adk>=1.19.0,<2.0.0",
    "ag-ui-protocol>=0.1.8,<0.2.0",
    "aiosqlite>=0.21.0,<0.22.0",
    "langfuse>=2.60.8,<4.0.0",
    "arize-phoenix-otel>=0.2.0,<1.0.0",
    "openinference-instrumentation-langchain>=0.1.13,<1.0.0",
    "langchain>=1.0.0,<2.0.0",
    "textual>=7.3.0,<7.4.0",
    # Pin <12: 12.x currently depends on placeholder jmespath==99.99.99 and fails in Docker
    "arize-phoenix>=11.22.0,<12.0.0",
    "idun-agent-schema>=0.3.8,<1.0.0",
    "langfuse-haystack>=2.3.0",
    "python-dotenv>=1.1.1",
    "click>=8.2.0",
    # Pin SQLAlchemy for Python 3.13 compatibility (required by Phoenix)
    "sqlalchemy>=2.0.36,<3.0.0",
    "ag-ui-langgraph>=0.0.20,<0.1.0",
    "copilotkit>=0.1.72,<0.2.0",
    "langchain-mcp-adapters>=0.2.0,<0.3.0",
    "ag-ui-adk>=0.3.4,<0.4.0",
    "opentelemetry-exporter-gcp-trace>=1.6.0,<2.0.0",
    "openinference-instrumentation-guardrails>=0.1.0,<1.0.0",
    "openinference-instrumentation-vertexai>=0.1.0,<1.0.0",
    "openinference-instrumentation-google-adk>=0.1.0,<1.0.0",
    "openinference-instrumentation-mcp>=1.0.0,<2.0.0",
    "google-cloud-logging>=3.10.0,<4.0.0",
    "opentelemetry-exporter-otlp-proto-http>=1.22.0,<2.0.0",
    "mcp>=1.0.0,<2.0.0",
    "psycopg-binary>=3.3.0,<4.0.0",
    "platformdirs>=4.0.0,<5.0.0",
    "posthog>=7.0.0,<8.0.0",
    "PyYAML>=6.0.0,<7.0.0",
]


[project.scripts]
idun = "idun_platform_cli.main:cli"


[project.urls]
Homepage = "https://github.com/geoffreyharrazi/idun-agent-platform"
Repository = "https://github.com/geoffreyharrazi/idun-agent-platform"
Documentation = "https://github.com/geoffreyharrazi/idun-agent-platform/tree/main/libs/idun_agent_engine"
Issues = "https://github.com/geoffreyharrazi/idun-agent-platform/issues"

[dependency-groups]
dev = [
    "ruff>=0.6.5,<0.13",
    "black>=24.8.0,<26",
    "pre-commit>=3.8.0,<5",
    "mypy>=1.10.0,<2",
    "pytest>=8.3.3,<9",
    "pytest-cov>=5.0.0,<7",
    "types-PyYAML>=6.0.12.20240808,<7",
    "pytest-asyncio>=1.2.0",
]

[tool.hatch.build.targets.sdist]
include = [
    "src/idun_agent_engine",
    "src/idun_agent_engine/py.typed",
    "src/idun_platform_cli",
]

[tool.hatch.build.targets.wheel]
include = [
  "src/idun_agent_engine",
  "src/idun_agent_engine/py.typed",
  "src/idun_platform_cli",
]

[tool.hatch.build.targets.wheel.sources]
"src/idun_agent_engine" = "idun_agent_engine"
"src/idun_platform_cli" = "idun_platform_cli"

[build-system]
requires = ["hatchling"]
build-backend = "hatchling.build"

[tool.black]
line-length = 88
target-version = ["py312", "py313"]
include = "\\.pyi?$"
exclude = '''
(
  /build/|
  /dist/|
  /.venv/|
  /.git/
)
'''

[tool.ruff]
target-version = "py312"
line-length = 88
extend-exclude = [
    "build",
    "dist",
    ".venv",
    "examples",
]

[tool.ruff.lint]
select = [
    "E",   # pycodestyle errors
    "F",   # pyflakes
    "W",   # pycodestyle warnings
    "I",   # isort (import sorting)
    "B",   # flake8-bugbear
    "UP",  # pyupgrade
    "N",   # pep8-naming
    "SIM", # flake8-simplify
    "D",   # pydocstyle (docstrings)
]
extend-ignore = [
    "E501",  # line length handled by black
]

[tool.ruff.lint.per-file-ignores]
"__init__.py" = ["F401"]  # Allow re-exporting in package __init__

[tool.ruff.lint.pydocstyle]
convention = "google"

[tool.mypy]
python_version = "3.12"
warn_return_any = true
warn_unused_ignores = true
ignore_missing_imports = true
strict_optional = true
no_implicit_optional = true
disallow_untyped_defs = false
check_untyped_defs = true
pretty = true
show_error_codes = true

[tool.pytest.ini_options]
addopts = "-ra -q --strict-markers --disable-warnings"
testpaths = [
    "tests",
]
pythonpath = [
    "src",
]

[tool.coverage.run]
branch = true
source = ["src"]

[tool.coverage.report]
show_missing = true
skip_covered = true
