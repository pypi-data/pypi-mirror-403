# SPDX-FileCopyrightText: 2025 GitHub
# SPDX-License-Identifier: MIT

seclab-taskflow-agent:
  version: 1
  filetype: toolbox

server_params:
  kind: streamable
  url: 'http://localhost:9999/mcp'
  # if you set a command/args/env we will also start the server on demand
  command: python
  args: ["-m", "seclab_taskflow_agent.mcp_servers.codeql.mcp_server"]
  env:
    CODEQL_DBS_BASE_PATH: "{{ env CODEQL_DBS_BASE_PATH }}"
    # prevent git repo operations on gh codeql executions
    GH_NO_UPDATE_NOTIFIER: "Disable"
    GH_NO_EXTENSION_UPDATE_NOTIFIER: "Disable"
    CODEQL_CLI: "{{ env CODEQL_CLI }}"
    LOG_DIR: "{{ env LOG_DIR }}"
server_prompt: |
  ## CodeQL Supported Programming Languages
  
  CodeQL supports the following languages, which you'll refer to by their
  CodeQL acronyms and which are detailed below:

    - actions: GitHub Actions workflows
    - cpp: The C and C++ programming language
    - csharp: The C# programming language
    - go: The Go programming language
    - java: The Java programming language (including Kotlin)
    - javascript: The JavaScript programming language (including TypeScript)
    - python: The Python programming language
    - ruby: The Ruby programming language
    - rust: The Rust programming language
    - swift: The Swift programming language

  When interacting with CodeQL databases, you will need to provide the
  appropriate language acronym for the type of project contained within the
  CodeQL database.

  For example, when interacting with a CodeQL database for a C based project
  you would reference its language as `cpp` for any CodeQL database
  interactions.

  If you are unable to determine the appropriate programming language acronym,
  halt your task and ask the user to clarify which programming language the
  CodeQL database in question was created for.

  ### CodeQL Database File URI
  
  The CodeQL database file URI scheme is defined as `file://path` and
  `file://path:region`.
  
  Examples of CodeQL database file URIs:
    
    - `file:///path/to/file:1:2:3:4`
    - `file:///path/to/file`

  File URIs optionally contain a region definition that looks like
  `start_line:start_column:end_line:end_column` which will limit the contents
  returned to the specified region. For example `file:///path/to/file:1:2:3:4`
  indicates a file region of `1:2:3:4` which would return the content of the
  file starting at line 1, column 1 and ending at line 3 column 4. These line
  and column indices are 1-based, meaning line and column values start at 1.

  If the region is ommitted the full contents of the file will be returned,
  for example `file:///path/to/file` returns the full contents of
  `/path/to/file`.

  If you want to fetch a specific region by their line numbers only, you can set
  the `start_column` and `end_column` values of a region to `0`. For example to
  retrieve lines 1-4 from a file at `/path/to/file` you can use a file URI
  with a region definition such as: `file:///path/to/file:1:0:4:0`.

  When unsure how to fetch a specific region, fall back to fetching the full file
  contents for a file by ommitting the region definition, for example
  `file:///path/to/file`
  
