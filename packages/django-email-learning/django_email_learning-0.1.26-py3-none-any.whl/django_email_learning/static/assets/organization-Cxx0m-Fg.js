import{g as b,a as _,r as x,u as S,j as e,s as R,c as k,b as z,R as C,B as f,T as m,a0 as E,n as w}from"./render-CcJq83Ld.js";import{L as I}from"./Layout-D7vcbkk2.js";import{R as T}from"./RequiredTextField-Bb6HLLm_.js";import{g as N,G as y}from"./utils-w7mD0LnI.js";import{A as v}from"./Alert-rWDWC83z.js";import{B as M}from"./Button-CN6ewz-p.js";import{b as F}from"./Dialog-CNsJRRbd.js";import"./Container-DAQjPzX-.js";function O(r){return b("MuiCardMedia",r)}_("MuiCardMedia",["root","media","img"]);const P=r=>{const{classes:o,isMediaComponent:i,isImageComponent:t}=r;return z({root:["root",i&&"media",t&&"img"]},O,o)},A=R("div",{name:"MuiCardMedia",slot:"Root",overridesResolver:(r,o)=>{const{ownerState:i}=r,{isMediaComponent:t,isImageComponent:l}=i;return[o.root,t&&o.media,l&&o.img]}})({display:"block",backgroundSize:"cover",backgroundRepeat:"no-repeat",backgroundPosition:"center",variants:[{props:{isMediaComponent:!0},style:{width:"100%"}},{props:{isImageComponent:!0},style:{objectFit:"cover"}}]}),U=["video","audio","picture","iframe","img"],D=["picture","img"],L=x.forwardRef(function(o,i){const t=S({props:o,name:"MuiCardMedia"}),{children:l,className:u,component:n="div",image:c,src:s,style:g,...d}=t,p=U.includes(n),h=!p&&c?{backgroundImage:`url("${c}")`,...g}:g,a={...t,component:n,isMediaComponent:p,isImageComponent:D.includes(n)},j=P(a);return e.jsx(A,{className:k(j.root,u),as:n,role:!p&&c?"img":void 0,ref:i,style:h,ownerState:a,src:p?c||s:void 0,...d,children:l})}),B=({course_title:r,course_slug:o,organization_id:i,endpoint:t,onCancle:l,onComplete:u})=>{const n=C.useRef(""),[c,s]=C.useState(""),[g,d]=C.useState(!1),p=()=>{const a=n.current.value;return a?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(a)?(s(""),!0):(s(localeMessages.email_invalid),!1):(s(localeMessages.email_required),!1)},h=()=>{p()&&(d(!0),fetch(t,{method:"POST",headers:{"Content-Type":"application/json","X-CSRFToken":N("csrftoken")},body:JSON.stringify({email:n.current.value,course_slug:o,organization_id:i})}).then(a=>{if(!a.ok)throw new Error("Network response was not ok");return a.json()}).then(a=>{d(!1),u()}).catch(a=>{d(!1),s(localeMessages.enrollment_failed)}))};return e.jsxs(f,{sx:{padding:4,minWidth:"400px"},children:[e.jsxs(m,{variant:"h3",children:[" ",localeMessages.enrol_for_course.replace("COURSE_NAME",r)]}),g?e.jsx(m,{variant:"body1",sx:{mt:2},children:e.jsx(E,{enableTrackSlot:!0,size:"30px"})}):e.jsxs(e.Fragment,{children:[c&&e.jsx(v,{severity:"error",sx:{mt:2},children:c}),e.jsx(T,{label:localeMessages.email,name:"email",type:"email",fullWidth:!0,margin:"normal",inputRef:n,onKeyDown:a=>{a.key==="Enter"&&h()}}),e.jsx("input",{type:"hidden",name:"course_slug",value:o}),e.jsxs(f,{sx:{mt:2,textAlign:"right"},children:[e.jsx(M,{variant:"outlined",sx:{mx:1},onClick:l,children:localeMessages.cancel}),e.jsx(M,{variant:"contained",color:"primary",type:"submit",onClick:h,children:localeMessages.submit})]})]})]})};function G(){const[r,o]=x.useState(!1),[i,t]=x.useState(null),[l,u]=x.useState([]);x.useEffect(()=>{for(let s of organization.courses)s.enrolled=!1;u(organization.courses)},[]);const n=s=>{t(e.jsx(B,{course_title:s.title,course_slug:s.slug,organization_id:organization.id,endpoint:enrollApiUrl,onCancle:()=>{o(!1),t(null)},onComplete:()=>c(s)})),o(!0)},c=s=>{o(!1),t(null);let g=l.map(d=>d.id===s.id?{...d,enrolled:!0}:d);u(g)};return e.jsxs(I,{children:[organization.logo_url&&e.jsx("img",{src:organization.logo_url,alt:`${organization.name} Logo`,style:{maxWidth:"200px",height:"auto"}}),e.jsx(m,{variant:"h1",children:organization.name}),e.jsx(m,{variant:"body1",dangerouslySetInnerHTML:{__html:organization.description}}),e.jsxs(f,{my:4,children:[e.jsxs(m,{variant:"h2",children:[localeMessages.courses,":"]}),organization.courses.length>0?e.jsx(y,{container:!0,columnSpacing:2,rowSpacing:6,alignItems:"stretch",children:l.map(s=>e.jsx(y,{size:{xs:12,md:6},display:"flex",children:e.jsxs(f,{p:2,border:1,borderRadius:2,sx:{height:"100%",width:"100%"},children:[e.jsx(L,{component:s.image?"img":"div",image:s.image,sx:{height:360,backgroundColor:"grey.300",objectFit:"cover"}}),e.jsx(m,{variant:"h3",sx:{pt:2},children:s.title}),e.jsx(M,{variant:"contained",color:"primary",rel:"noopener noreferrer",sx:{mt:1,mb:2},onClick:()=>n(s),disabled:s.enrolled,children:localeMessages.enroll_now}),e.jsx(m,{variant:"body2",dangerouslySetInnerHTML:{__html:s.description}}),s.enrolled&&e.jsx(v,{severity:"success",sx:{mt:2},children:localeMessages.enrollment_success})]},s.id)},s.id))}):e.jsx(m,{variant:"body2",children:localeMessages.no_courses_available})]}),e.jsx(F,{open:r,onClose:()=>o(!1),children:i})]})}w({children:e.jsx(G,{})});
//# sourceMappingURL=organization-Cxx0m-Fg.js.map
